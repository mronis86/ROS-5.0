(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const h of a)if(h.type==="childList")for(const d of h.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function n(a){const h={};return a.integrity&&(h.integrity=a.integrity),a.referrerPolicy&&(h.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?h.credentials="include":a.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(a){if(a.ep)return;a.ep=!0;const h=n(a);fetch(a.href,h)}})();function pu(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}function Xm(u){if(Object.prototype.hasOwnProperty.call(u,"__esModule"))return u;var r=u.default;if(typeof r=="function"){var n=function o(){var a=!1;try{a=this instanceof o}catch{}return a?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};n.prototype=r.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(u).forEach(function(o){var a=Object.getOwnPropertyDescriptor(u,o);Object.defineProperty(n,o,a.get?a:{enumerable:!0,get:function(){return u[o]}})}),n}var Uc={exports:{}},pi={},Fc={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ch;function Zm(){if(Ch)return Le;Ch=1;var u=Symbol.for("react.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),h=Symbol.for("react.provider"),d=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),w=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),_=Symbol.iterator;function T(C){return C===null||typeof C!="object"?null:(C=_&&C[_]||C["@@iterator"],typeof C=="function"?C:null)}var R={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,M={};function L(C,H,le){this.props=C,this.context=H,this.refs=M,this.updater=le||R}L.prototype.isReactComponent={},L.prototype.setState=function(C,H){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,H,"setState")},L.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function Q(){}Q.prototype=L.prototype;function K(C,H,le){this.props=C,this.context=H,this.refs=M,this.updater=le||R}var B=K.prototype=new Q;B.constructor=K,A(B,L.prototype),B.isPureReactComponent=!0;var $=Array.isArray,G=Object.prototype.hasOwnProperty,z={current:null},ne={key:!0,ref:!0,__self:!0,__source:!0};function ae(C,H,le){var me,$e={},Ue=null,Ke=null;if(H!=null)for(me in H.ref!==void 0&&(Ke=H.ref),H.key!==void 0&&(Ue=""+H.key),H)G.call(H,me)&&!ne.hasOwnProperty(me)&&($e[me]=H[me]);var ze=arguments.length-2;if(ze===1)$e.children=le;else if(1<ze){for(var Je=Array(ze),wt=0;wt<ze;wt++)Je[wt]=arguments[wt+2];$e.children=Je}if(C&&C.defaultProps)for(me in ze=C.defaultProps,ze)$e[me]===void 0&&($e[me]=ze[me]);return{$$typeof:u,type:C,key:Ue,ref:Ke,props:$e,_owner:z.current}}function O(C,H){return{$$typeof:u,type:C.type,key:H,ref:C.ref,props:C.props,_owner:C._owner}}function Z(C){return typeof C=="object"&&C!==null&&C.$$typeof===u}function q(C){var H={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(le){return H[le]})}var Y=/\/+/g;function ce(C,H){return typeof C=="object"&&C!==null&&C.key!=null?q(""+C.key):H.toString(36)}function ke(C,H,le,me,$e){var Ue=typeof C;(Ue==="undefined"||Ue==="boolean")&&(C=null);var Ke=!1;if(C===null)Ke=!0;else switch(Ue){case"string":case"number":Ke=!0;break;case"object":switch(C.$$typeof){case u:case r:Ke=!0}}if(Ke)return Ke=C,$e=$e(Ke),C=me===""?"."+ce(Ke,0):me,$($e)?(le="",C!=null&&(le=C.replace(Y,"$&/")+"/"),ke($e,H,le,"",function(wt){return wt})):$e!=null&&(Z($e)&&($e=O($e,le+(!$e.key||Ke&&Ke.key===$e.key?"":(""+$e.key).replace(Y,"$&/")+"/")+C)),H.push($e)),1;if(Ke=0,me=me===""?".":me+":",$(C))for(var ze=0;ze<C.length;ze++){Ue=C[ze];var Je=me+ce(Ue,ze);Ke+=ke(Ue,H,le,Je,$e)}else if(Je=T(C),typeof Je=="function")for(C=Je.call(C),ze=0;!(Ue=C.next()).done;)Ue=Ue.value,Je=me+ce(Ue,ze++),Ke+=ke(Ue,H,le,Je,$e);else if(Ue==="object")throw H=String(C),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.");return Ke}function De(C,H,le){if(C==null)return C;var me=[],$e=0;return ke(C,me,"","",function(Ue){return H.call(le,Ue,$e++)}),me}function et(C){if(C._status===-1){var H=C._result;H=H(),H.then(function(le){(C._status===0||C._status===-1)&&(C._status=1,C._result=le)},function(le){(C._status===0||C._status===-1)&&(C._status=2,C._result=le)}),C._status===-1&&(C._status=0,C._result=H)}if(C._status===1)return C._result.default;throw C._result}var Fe={current:null},ie={transition:null},pe={ReactCurrentDispatcher:Fe,ReactCurrentBatchConfig:ie,ReactCurrentOwner:z};function ue(){throw Error("act(...) is not supported in production builds of React.")}return Le.Children={map:De,forEach:function(C,H,le){De(C,function(){H.apply(this,arguments)},le)},count:function(C){var H=0;return De(C,function(){H++}),H},toArray:function(C){return De(C,function(H){return H})||[]},only:function(C){if(!Z(C))throw Error("React.Children.only expected to receive a single React element child.");return C}},Le.Component=L,Le.Fragment=n,Le.Profiler=a,Le.PureComponent=K,Le.StrictMode=o,Le.Suspense=v,Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pe,Le.act=ue,Le.cloneElement=function(C,H,le){if(C==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+C+".");var me=A({},C.props),$e=C.key,Ue=C.ref,Ke=C._owner;if(H!=null){if(H.ref!==void 0&&(Ue=H.ref,Ke=z.current),H.key!==void 0&&($e=""+H.key),C.type&&C.type.defaultProps)var ze=C.type.defaultProps;for(Je in H)G.call(H,Je)&&!ne.hasOwnProperty(Je)&&(me[Je]=H[Je]===void 0&&ze!==void 0?ze[Je]:H[Je])}var Je=arguments.length-2;if(Je===1)me.children=le;else if(1<Je){ze=Array(Je);for(var wt=0;wt<Je;wt++)ze[wt]=arguments[wt+2];me.children=ze}return{$$typeof:u,type:C.type,key:$e,ref:Ue,props:me,_owner:Ke}},Le.createContext=function(C){return C={$$typeof:d,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},C.Provider={$$typeof:h,_context:C},C.Consumer=C},Le.createElement=ae,Le.createFactory=function(C){var H=ae.bind(null,C);return H.type=C,H},Le.createRef=function(){return{current:null}},Le.forwardRef=function(C){return{$$typeof:g,render:C}},Le.isValidElement=Z,Le.lazy=function(C){return{$$typeof:S,_payload:{_status:-1,_result:C},_init:et}},Le.memo=function(C,H){return{$$typeof:w,type:C,compare:H===void 0?null:H}},Le.startTransition=function(C){var H=ie.transition;ie.transition={};try{C()}finally{ie.transition=H}},Le.unstable_act=ue,Le.useCallback=function(C,H){return Fe.current.useCallback(C,H)},Le.useContext=function(C){return Fe.current.useContext(C)},Le.useDebugValue=function(){},Le.useDeferredValue=function(C){return Fe.current.useDeferredValue(C)},Le.useEffect=function(C,H){return Fe.current.useEffect(C,H)},Le.useId=function(){return Fe.current.useId()},Le.useImperativeHandle=function(C,H,le){return Fe.current.useImperativeHandle(C,H,le)},Le.useInsertionEffect=function(C,H){return Fe.current.useInsertionEffect(C,H)},Le.useLayoutEffect=function(C,H){return Fe.current.useLayoutEffect(C,H)},Le.useMemo=function(C,H){return Fe.current.useMemo(C,H)},Le.useReducer=function(C,H,le){return Fe.current.useReducer(C,H,le)},Le.useRef=function(C){return Fe.current.useRef(C)},Le.useState=function(C){return Fe.current.useState(C)},Le.useSyncExternalStore=function(C,H,le){return Fe.current.useSyncExternalStore(C,H,le)},Le.useTransition=function(){return Fe.current.useTransition()},Le.version="18.3.1",Le}var Rh;function gu(){return Rh||(Rh=1,Fc.exports=Zm()),Fc.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oh;function ep(){if(Oh)return pi;Oh=1;var u=gu(),r=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h={key:!0,ref:!0,__self:!0,__source:!0};function d(g,v,w){var S,_={},T=null,R=null;w!==void 0&&(T=""+w),v.key!==void 0&&(T=""+v.key),v.ref!==void 0&&(R=v.ref);for(S in v)o.call(v,S)&&!h.hasOwnProperty(S)&&(_[S]=v[S]);if(g&&g.defaultProps)for(S in v=g.defaultProps,v)_[S]===void 0&&(_[S]=v[S]);return{$$typeof:r,type:g,key:T,ref:R,props:_,_owner:a.current}}return pi.Fragment=n,pi.jsx=d,pi.jsxs=d,pi}var Ih;function tp(){return Ih||(Ih=1,Uc.exports=ep()),Uc.exports}var i=tp(),k=gu();const Ja=pu(k);var Ua={},zc={exports:{}},Xt={},Vc={exports:{}},Wc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ph;function rp(){return Ph||(Ph=1,(function(u){function r(ie,pe){var ue=ie.length;ie.push(pe);e:for(;0<ue;){var C=ue-1>>>1,H=ie[C];if(0<a(H,pe))ie[C]=pe,ie[ue]=H,ue=C;else break e}}function n(ie){return ie.length===0?null:ie[0]}function o(ie){if(ie.length===0)return null;var pe=ie[0],ue=ie.pop();if(ue!==pe){ie[0]=ue;e:for(var C=0,H=ie.length,le=H>>>1;C<le;){var me=2*(C+1)-1,$e=ie[me],Ue=me+1,Ke=ie[Ue];if(0>a($e,ue))Ue<H&&0>a(Ke,$e)?(ie[C]=Ke,ie[Ue]=ue,C=Ue):(ie[C]=$e,ie[me]=ue,C=me);else if(Ue<H&&0>a(Ke,ue))ie[C]=Ke,ie[Ue]=ue,C=Ue;else break e}}return pe}function a(ie,pe){var ue=ie.sortIndex-pe.sortIndex;return ue!==0?ue:ie.id-pe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;u.unstable_now=function(){return h.now()}}else{var d=Date,g=d.now();u.unstable_now=function(){return d.now()-g}}var v=[],w=[],S=1,_=null,T=3,R=!1,A=!1,M=!1,L=typeof setTimeout=="function"?setTimeout:null,Q=typeof clearTimeout=="function"?clearTimeout:null,K=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function B(ie){for(var pe=n(w);pe!==null;){if(pe.callback===null)o(w);else if(pe.startTime<=ie)o(w),pe.sortIndex=pe.expirationTime,r(v,pe);else break;pe=n(w)}}function $(ie){if(M=!1,B(ie),!A)if(n(v)!==null)A=!0,et(G);else{var pe=n(w);pe!==null&&Fe($,pe.startTime-ie)}}function G(ie,pe){A=!1,M&&(M=!1,Q(ae),ae=-1),R=!0;var ue=T;try{for(B(pe),_=n(v);_!==null&&(!(_.expirationTime>pe)||ie&&!q());){var C=_.callback;if(typeof C=="function"){_.callback=null,T=_.priorityLevel;var H=C(_.expirationTime<=pe);pe=u.unstable_now(),typeof H=="function"?_.callback=H:_===n(v)&&o(v),B(pe)}else o(v);_=n(v)}if(_!==null)var le=!0;else{var me=n(w);me!==null&&Fe($,me.startTime-pe),le=!1}return le}finally{_=null,T=ue,R=!1}}var z=!1,ne=null,ae=-1,O=5,Z=-1;function q(){return!(u.unstable_now()-Z<O)}function Y(){if(ne!==null){var ie=u.unstable_now();Z=ie;var pe=!0;try{pe=ne(!0,ie)}finally{pe?ce():(z=!1,ne=null)}}else z=!1}var ce;if(typeof K=="function")ce=function(){K(Y)};else if(typeof MessageChannel<"u"){var ke=new MessageChannel,De=ke.port2;ke.port1.onmessage=Y,ce=function(){De.postMessage(null)}}else ce=function(){L(Y,0)};function et(ie){ne=ie,z||(z=!0,ce())}function Fe(ie,pe){ae=L(function(){ie(u.unstable_now())},pe)}u.unstable_IdlePriority=5,u.unstable_ImmediatePriority=1,u.unstable_LowPriority=4,u.unstable_NormalPriority=3,u.unstable_Profiling=null,u.unstable_UserBlockingPriority=2,u.unstable_cancelCallback=function(ie){ie.callback=null},u.unstable_continueExecution=function(){A||R||(A=!0,et(G))},u.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<ie?Math.floor(1e3/ie):5},u.unstable_getCurrentPriorityLevel=function(){return T},u.unstable_getFirstCallbackNode=function(){return n(v)},u.unstable_next=function(ie){switch(T){case 1:case 2:case 3:var pe=3;break;default:pe=T}var ue=T;T=pe;try{return ie()}finally{T=ue}},u.unstable_pauseExecution=function(){},u.unstable_requestPaint=function(){},u.unstable_runWithPriority=function(ie,pe){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ue=T;T=ie;try{return pe()}finally{T=ue}},u.unstable_scheduleCallback=function(ie,pe,ue){var C=u.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?C+ue:C):ue=C,ie){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=ue+H,ie={id:S++,callback:pe,priorityLevel:ie,startTime:ue,expirationTime:H,sortIndex:-1},ue>C?(ie.sortIndex=ue,r(w,ie),n(v)===null&&ie===n(w)&&(M?(Q(ae),ae=-1):M=!0,Fe($,ue-C))):(ie.sortIndex=H,r(v,ie),A||R||(A=!0,et(G))),ie},u.unstable_shouldYield=q,u.unstable_wrapCallback=function(ie){var pe=T;return function(){var ue=T;T=pe;try{return ie.apply(this,arguments)}finally{T=ue}}}})(Wc)),Wc}var Dh;function np(){return Dh||(Dh=1,Vc.exports=rp()),Vc.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ah;function sp(){if(Ah)return Xt;Ah=1;var u=gu(),r=np();function n(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function h(e,t){d(e,t),d(e+"Capture",t)}function d(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var g=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),v=Object.prototype.hasOwnProperty,w=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,S={},_={};function T(e){return v.call(_,e)?!0:v.call(S,e)?!1:w.test(e)?_[e]=!0:(S[e]=!0,!1)}function R(e,t,s,l){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return l?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function A(e,t,s,l){if(t===null||typeof t>"u"||R(e,t,s,l))return!0;if(l)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function M(e,t,s,l,f,m,x){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=l,this.attributeNamespace=f,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=m,this.removeEmptyString=x}var L={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){L[e]=new M(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];L[t]=new M(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){L[e]=new M(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){L[e]=new M(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){L[e]=new M(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){L[e]=new M(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){L[e]=new M(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){L[e]=new M(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){L[e]=new M(e,5,!1,e.toLowerCase(),null,!1,!1)});var Q=/[\-:]([a-z])/g;function K(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Q,K);L[t]=new M(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Q,K);L[t]=new M(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Q,K);L[t]=new M(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){L[e]=new M(e,1,!1,e.toLowerCase(),null,!1,!1)}),L.xlinkHref=new M("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){L[e]=new M(e,1,!1,e.toLowerCase(),null,!0,!0)});function B(e,t,s,l){var f=L.hasOwnProperty(t)?L[t]:null;(f!==null?f.type!==0:l||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(A(t,s,f,l)&&(s=null),l||f===null?T(t)&&(s===null?e.removeAttribute(t):e.setAttribute(t,""+s)):f.mustUseProperty?e[f.propertyName]=s===null?f.type===3?!1:"":s:(t=f.attributeName,l=f.attributeNamespace,s===null?e.removeAttribute(t):(f=f.type,s=f===3||f===4&&s===!0?"":""+s,l?e.setAttributeNS(l,t,s):e.setAttribute(t,s))))}var $=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,G=Symbol.for("react.element"),z=Symbol.for("react.portal"),ne=Symbol.for("react.fragment"),ae=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),Z=Symbol.for("react.provider"),q=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),ce=Symbol.for("react.suspense"),ke=Symbol.for("react.suspense_list"),De=Symbol.for("react.memo"),et=Symbol.for("react.lazy"),Fe=Symbol.for("react.offscreen"),ie=Symbol.iterator;function pe(e){return e===null||typeof e!="object"?null:(e=ie&&e[ie]||e["@@iterator"],typeof e=="function"?e:null)}var ue=Object.assign,C;function H(e){if(C===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);C=t&&t[1]||""}return`
`+C+e}var le=!1;function me(e,t){if(!e||le)return"";le=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(V){var l=V}Reflect.construct(e,[],t)}else{try{t.call()}catch(V){l=V}e.call(t.prototype)}else{try{throw Error()}catch(V){l=V}e()}}catch(V){if(V&&l&&typeof V.stack=="string"){for(var f=V.stack.split(`
`),m=l.stack.split(`
`),x=f.length-1,N=m.length-1;1<=x&&0<=N&&f[x]!==m[N];)N--;for(;1<=x&&0<=N;x--,N--)if(f[x]!==m[N]){if(x!==1||N!==1)do if(x--,N--,0>N||f[x]!==m[N]){var I=`
`+f[x].replace(" at new "," at ");return e.displayName&&I.includes("<anonymous>")&&(I=I.replace("<anonymous>",e.displayName)),I}while(1<=x&&0<=N);break}}}finally{le=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?H(e):""}function $e(e){switch(e.tag){case 5:return H(e.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return e=me(e.type,!1),e;case 11:return e=me(e.type.render,!1),e;case 1:return e=me(e.type,!0),e;default:return""}}function Ue(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ne:return"Fragment";case z:return"Portal";case O:return"Profiler";case ae:return"StrictMode";case ce:return"Suspense";case ke:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case q:return(e.displayName||"Context")+".Consumer";case Z:return(e._context.displayName||"Context")+".Provider";case Y:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case De:return t=e.displayName||null,t!==null?t:Ue(e.type)||"Memo";case et:t=e._payload,e=e._init;try{return Ue(e(t))}catch{}}return null}function Ke(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ue(t);case 8:return t===ae?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ze(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Je(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function wt(e){var t=Je(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),l=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var f=s.get,m=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return f.call(this)},set:function(x){l=""+x,m.call(this,x)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return l},setValue:function(x){l=""+x},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function $t(e){e._valueTracker||(e._valueTracker=wt(e))}function qn(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),l="";return e&&(l=Je(e)?e.checked?"true":"false":e.value),e=l,e!==s?(t.setValue(e),!0):!1}function yn(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Xr(e,t){var s=t.checked;return ue({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function Zt(e,t){var s=t.defaultValue==null?"":t.defaultValue,l=t.checked!=null?t.checked:t.defaultChecked;s=ze(t.value!=null?t.value:s),e._wrapperState={initialChecked:l,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function xn(e,t){t=t.checked,t!=null&&B(e,"checked",t,!1)}function bt(e,t){xn(e,t);var s=ze(t.value),l=t.type;if(s!=null)l==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Kn(e,t.type,s):t.hasOwnProperty("defaultValue")&&Kn(e,t.type,ze(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ir(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var l=t.type;if(!(l!=="submit"&&l!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function Kn(e,t,s){(t!=="number"||yn(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var Lr=Array.isArray;function Tt(e,t,s,l){if(e=e.options,t){t={};for(var f=0;f<s.length;f++)t["$"+s[f]]=!0;for(s=0;s<e.length;s++)f=t.hasOwnProperty("$"+e[s].value),e[s].selected!==f&&(e[s].selected=f),f&&l&&(e[s].defaultSelected=!0)}else{for(s=""+ze(s),t=null,f=0;f<e.length;f++){if(e[f].value===s){e[f].selected=!0,l&&(e[f].defaultSelected=!0);return}t!==null||e[f].disabled||(t=e[f])}t!==null&&(t.selected=!0)}}function wn(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(n(91));return ue({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ji(e,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error(n(92));if(Lr(s)){if(1<s.length)throw Error(n(93));s=s[0]}t=s}t==null&&(t=""),s=t}e._wrapperState={initialValue:ze(s)}}function Oo(e,t){var s=ze(t.value),l=ze(t.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),t.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),l!=null&&(e.defaultValue=""+l)}function Io(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Po(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jn(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Po(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var $r,Sr=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,l,f){MSApp.execUnsafeLocalFunction(function(){return e(t,s,l,f)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for($r=$r||document.createElement("div"),$r.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=$r.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function _r(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var pt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ar=["Webkit","ms","Moz","O"];Object.keys(pt).forEach(function(e){ar.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pt[t]=pt[e]})});function Re(e,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||pt.hasOwnProperty(e)&&pt[e]?(""+t).trim():t+"px"}function lr(e,t){e=e.style;for(var s in t)if(t.hasOwnProperty(s)){var l=s.indexOf("--")===0,f=Re(s,t[s],l);s==="float"&&(s="cssFloat"),l?e.setProperty(s,f):e[s]=f}}var Mr=ue({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zr(e,t){if(t){if(Mr[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(n(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(n(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(n(61))}if(t.style!=null&&typeof t.style!="object")throw Error(n(62))}}function Be(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ht=null;function Is(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var er=null,Ge=null,Mt=null;function Gn(e){if(e=ei(e)){if(typeof er!="function")throw Error(n(280));var t=e.stateNode;t&&(t=ea(t),er(e.stateNode,e.type,t))}}function Do(e){Ge?Mt?Mt.push(e):Mt=[e]:Ge=e}function Ao(){if(Ge){var e=Ge,t=Mt;if(Mt=Ge=null,Gn(e),t)for(e=0;e<t.length;e++)Gn(t[e])}}function Ti(e,t){return e(t)}function tl(){}var bn=!1;function rl(e,t,s){if(bn)return e(t,s);bn=!0;try{return Ti(e,t,s)}finally{bn=!1,(Ge!==null||Mt!==null)&&(tl(),Ao())}}function Qn(e,t){var s=e.stateNode;if(s===null)return null;var l=ea(s);if(l===null)return null;s=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(n(231,t,typeof s));return s}var ye=!1;if(g)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){ye=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch{ye=!1}function Qe(e,t,s,l,f,m,x,N,I){var V=Array.prototype.slice.call(arguments,3);try{t.apply(s,V)}catch(ee){this.onError(ee)}}var dt=!1,Er=null,St=!1,Lo=null,Ps={onError:function(e){dt=!0,Er=e}};function ju(e,t,s,l,f,m,x,N,I){dt=!1,Er=null,Qe.apply(Ps,arguments)}function Tu(e,t,s,l,f,m,x,N,I){if(ju.apply(this,arguments),dt){if(dt){var V=Er;dt=!1,Er=null}else throw Error(n(198));St||(St=!0,Lo=V)}}function Sn(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function Ur(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function $o(e){if(Sn(e)!==e)throw Error(n(188))}function en(e){var t=e.alternate;if(!t){if(t=Sn(e),t===null)throw Error(n(188));return t!==e?null:e}for(var s=e,l=t;;){var f=s.return;if(f===null)break;var m=f.alternate;if(m===null){if(l=f.return,l!==null){s=l;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===s)return $o(f),e;if(m===l)return $o(f),t;m=m.sibling}throw Error(n(188))}if(s.return!==l.return)s=f,l=m;else{for(var x=!1,N=f.child;N;){if(N===s){x=!0,s=f,l=m;break}if(N===l){x=!0,l=f,s=m;break}N=N.sibling}if(!x){for(N=m.child;N;){if(N===s){x=!0,s=m,l=f;break}if(N===l){x=!0,l=m,s=f;break}N=N.sibling}if(!x)throw Error(n(189))}}if(s.alternate!==l)throw Error(n(190))}if(s.tag!==3)throw Error(n(188));return s.stateNode.current===s?e:t}function Ot(e){return e=en(e),e!==null?Ci(e):null}function Ci(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ci(e);if(t!==null)return t;e=e.sibling}return null}var Ri=r.unstable_scheduleCallback,Yn=r.unstable_cancelCallback,tn=r.unstable_shouldYield,Ds=r.unstable_requestPaint,nt=r.unstable_now,Oi=r.unstable_getCurrentPriorityLevel,Mo=r.unstable_ImmediatePriority,As=r.unstable_UserBlockingPriority,Ls=r.unstable_NormalPriority,Ii=r.unstable_LowPriority,je=r.unstable_IdlePriority,_t=null,Ft=null;function Uo(e){if(Ft&&typeof Ft.onCommitFiberRoot=="function")try{Ft.onCommitFiberRoot(_t,e,void 0,(e.current.flags&128)===128)}catch{}}var Oe=Math.clz32?Math.clz32:sl,nl=Math.log,$s=Math.LN2;function sl(e){return e>>>=0,e===0?32:31-(nl(e)/$s|0)|0}var It=64,Xn=4194304;function _n(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function cr(e,t){var s=e.pendingLanes;if(s===0)return 0;var l=0,f=e.suspendedLanes,m=e.pingedLanes,x=s&268435455;if(x!==0){var N=x&~f;N!==0?l=_n(N):(m&=x,m!==0&&(l=_n(m)))}else x=s&~f,x!==0?l=_n(x):m!==0&&(l=_n(m));if(l===0)return 0;if(t!==0&&t!==l&&(t&f)===0&&(f=l&-l,m=t&-t,f>=m||f===16&&(m&4194240)!==0))return t;if((l&4)!==0&&(l|=s&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=l;0<t;)s=31-Oe(t),f=1<<s,l|=e[s],t&=~f;return l}function ur(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pi(e,t){for(var s=e.suspendedLanes,l=e.pingedLanes,f=e.expirationTimes,m=e.pendingLanes;0<m;){var x=31-Oe(m),N=1<<x,I=f[x];I===-1?((N&s)===0||(N&l)!==0)&&(f[x]=ur(N,t)):I<=t&&(e.expiredLanes|=N),m&=~N}}function Fr(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Fo(){var e=It;return It<<=1,(It&4194240)===0&&(It=64),e}function rn(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function Zn(e,t,s){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Oe(t),e[t]=s}function Di(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<s;){var f=31-Oe(s),m=1<<f;t[f]=0,l[f]=-1,e[f]=-1,s&=~m}}function zr(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var l=31-Oe(s),f=1<<l;f&t|e[l]&t&&(e[l]|=t),s&=~f}}var Ae=0;function es(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Ai,dr,Ms,ts,Li,zo=!1,En=[],hr=null,Vr=null,kr=null,rs=new Map,ns=new Map,tr=[],ol="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $i(e,t){switch(e){case"focusin":case"focusout":hr=null;break;case"dragenter":case"dragleave":Vr=null;break;case"mouseover":case"mouseout":kr=null;break;case"pointerover":case"pointerout":rs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ns.delete(t.pointerId)}}function ss(e,t,s,l,f,m){return e===null||e.nativeEvent!==m?(e={blockedOn:t,domEventName:s,eventSystemFlags:l,nativeEvent:m,targetContainers:[f]},t!==null&&(t=ei(t),t!==null&&dr(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,f!==null&&t.indexOf(f)===-1&&t.push(f),e)}function il(e,t,s,l,f){switch(t){case"focusin":return hr=ss(hr,e,t,s,l,f),!0;case"dragenter":return Vr=ss(Vr,e,t,s,l,f),!0;case"mouseover":return kr=ss(kr,e,t,s,l,f),!0;case"pointerover":var m=f.pointerId;return rs.set(m,ss(rs.get(m)||null,e,t,s,l,f)),!0;case"gotpointercapture":return m=f.pointerId,ns.set(m,ss(ns.get(m)||null,e,t,s,l,f)),!0}return!1}function os(e){var t=ms(e.target);if(t!==null){var s=Sn(t);if(s!==null){if(t=s.tag,t===13){if(t=Ur(s),t!==null){e.blockedOn=t,Li(e.priority,function(){Ms(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function kn(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=He(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var l=new s.constructor(s.type,s);Ht=l,s.target.dispatchEvent(l),Ht=null}else return t=ei(s),t!==null&&dr(t),e.blockedOn=s,!1;t.shift()}return!0}function Us(e,t,s){kn(e)&&s.delete(t)}function al(){zo=!1,hr!==null&&kn(hr)&&(hr=null),Vr!==null&&kn(Vr)&&(Vr=null),kr!==null&&kn(kr)&&(kr=null),rs.forEach(Us),ns.forEach(Us)}function is(e,t){e.blockedOn===t&&(e.blockedOn=null,zo||(zo=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,al)))}function Pe(e){function t(f){return is(f,e)}if(0<En.length){is(En[0],e);for(var s=1;s<En.length;s++){var l=En[s];l.blockedOn===e&&(l.blockedOn=null)}}for(hr!==null&&is(hr,e),Vr!==null&&is(Vr,e),kr!==null&&is(kr,e),rs.forEach(t),ns.forEach(t),s=0;s<tr.length;s++)l=tr[s],l.blockedOn===e&&(l.blockedOn=null);for(;0<tr.length&&(s=tr[0],s.blockedOn===null);)os(s),s.blockedOn===null&&tr.shift()}var st=$.ReactCurrentBatchConfig,as=!0;function Fs(e,t,s,l){var f=Ae,m=st.transition;st.transition=null;try{Ae=1,zs(e,t,s,l)}finally{Ae=f,st.transition=m}}function qt(e,t,s,l){var f=Ae,m=st.transition;st.transition=null;try{Ae=4,zs(e,t,s,l)}finally{Ae=f,st.transition=m}}function zs(e,t,s,l){if(as){var f=He(e,t,s,l);if(f===null)Cl(e,t,l,ls,s),$i(e,l);else if(il(f,e,t,s,l))l.stopPropagation();else if($i(e,l),t&4&&-1<ol.indexOf(e)){for(;f!==null;){var m=ei(f);if(m!==null&&Ai(m),m=He(e,t,s,l),m===null&&Cl(e,t,l,ls,s),m===f)break;f=m}f!==null&&l.stopPropagation()}else Cl(e,t,l,null,s)}}var ls=null;function He(e,t,s,l){if(ls=null,e=Is(l),e=ms(e),e!==null)if(t=Sn(e),t===null)e=null;else if(s=t.tag,s===13){if(e=Ur(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ls=e,null}function Mi(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Oi()){case Mo:return 1;case As:return 4;case Ls:case Ii:return 16;case je:return 536870912;default:return 16}default:return 16}}var Wr=null,Vo=null,cs=null;function Wo(){if(cs)return cs;var e,t=Vo,s=t.length,l,f="value"in Wr?Wr.value:Wr.textContent,m=f.length;for(e=0;e<s&&t[e]===f[e];e++);var x=s-e;for(l=1;l<=x&&t[s-l]===f[m-l];l++);return cs=f.slice(e,1<l?1-l:void 0)}function Vs(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Nr(){return!0}function Ui(){return!1}function zt(e){function t(s,l,f,m,x){this._reactName=s,this._targetInst=f,this.type=l,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var N in e)e.hasOwnProperty(N)&&(s=e[N],this[N]=s?s(m):m[N]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Nr:Ui,this.isPropagationStopped=Ui,this}return ue(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Nr)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Nr)},persist:function(){},isPersistent:Nr}),t}var Nn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jr=zt(Nn),us=ue({},Nn,{view:0,detail:0}),ll=zt(us),Ws,ds,jn,Bs=ue({},us,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ho,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==jn&&(jn&&e.type==="mousemove"?(Ws=e.screenX-jn.screenX,ds=e.screenY-jn.screenY):ds=Ws=0,jn=e),Ws)},movementY:function(e){return"movementY"in e?e.movementY:ds}}),Fi=zt(Bs),hs=ue({},Bs,{dataTransfer:0}),cl=zt(hs),ul=ue({},us,{relatedTarget:0}),Bo=zt(ul),dl=ue({},Nn,{animationName:0,elapsedTime:0,pseudoElement:0}),Hs=zt(dl),zi=ue({},Nn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Vi=zt(zi),hl=ue({},Nn,{data:0}),rr=zt(hl),fl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Wi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ml={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bi(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ml[e])?!!t[e]:!1}function Ho(){return Bi}var ot=ue({},us,{key:function(e){if(e.key){var t=fl[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Vs(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Wi[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ho,charCode:function(e){return e.type==="keypress"?Vs(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Vs(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Hi=zt(ot),fs=ue({},Bs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qi=zt(fs),pl=ue({},us,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ho}),gl=zt(pl),vl=ue({},Nn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ki=zt(vl),yl=ue({},Bs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),qo=zt(yl),fr=[9,13,27,32],c=g&&"CompositionEvent"in window,p=null;g&&"documentMode"in document&&(p=document.documentMode);var y=g&&"TextEvent"in window&&!p,b=g&&(!c||p&&8<p&&11>=p),E=" ",j=!1;function P(e,t){switch(e){case"keyup":return fr.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function W(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var J=!1;function be(e,t){switch(e){case"compositionend":return W(t);case"keypress":return t.which!==32?null:(j=!0,E);case"textInput":return e=t.data,e===E&&j?null:e;default:return null}}function we(e,t){if(J)return e==="compositionend"||!c&&P(e,t)?(e=Wo(),cs=Vo=Wr=null,J=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return b&&t.locale!=="ko"?null:t.data;default:return null}}var te={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function de(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!te[e.type]:t==="textarea"}function Ne(e,t,s,l){Do(l),t=Yi(t,"onChange"),0<t.length&&(s=new jr("onChange","change",null,s,l),e.push({event:s,listeners:t}))}var qe=null,Ye=null;function mr(e){Hu(e,0)}function nn(e){var t=Qs(e);if(qn(t))return e}function xl(e,t){if(e==="change")return t}var Ko=!1;if(g){var wl;if(g){var bl="oninput"in document;if(!bl){var Cu=document.createElement("div");Cu.setAttribute("oninput","return;"),bl=typeof Cu.oninput=="function"}wl=bl}else wl=!1;Ko=wl&&(!document.documentMode||9<document.documentMode)}function Ru(){qe&&(qe.detachEvent("onpropertychange",Ou),Ye=qe=null)}function Ou(e){if(e.propertyName==="value"&&nn(Ye)){var t=[];Ne(t,Ye,e,Is(e)),rl(mr,t)}}function em(e,t,s){e==="focusin"?(Ru(),qe=t,Ye=s,qe.attachEvent("onpropertychange",Ou)):e==="focusout"&&Ru()}function tm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return nn(Ye)}function rm(e,t){if(e==="click")return nn(t)}function nm(e,t){if(e==="input"||e==="change")return nn(t)}function sm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Tr=typeof Object.is=="function"?Object.is:sm;function Jo(e,t){if(Tr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),l=Object.keys(t);if(s.length!==l.length)return!1;for(l=0;l<s.length;l++){var f=s[l];if(!v.call(t,f)||!Tr(e[f],t[f]))return!1}return!0}function Iu(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pu(e,t){var s=Iu(e);e=0;for(var l;s;){if(s.nodeType===3){if(l=e+s.textContent.length,e<=t&&l>=t)return{node:s,offset:t-e};e=l}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Iu(s)}}function Du(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Du(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Au(){for(var e=window,t=yn();t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=yn(e.document)}return t}function Sl(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function om(e){var t=Au(),s=e.focusedElem,l=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&Du(s.ownerDocument.documentElement,s)){if(l!==null&&Sl(s)){if(t=l.start,e=l.end,e===void 0&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if(e=(t=s.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var f=s.textContent.length,m=Math.min(l.start,f);l=l.end===void 0?m:Math.min(l.end,f),!e.extend&&m>l&&(f=l,l=m,m=f),f=Pu(s,m);var x=Pu(s,l);f&&x&&(e.rangeCount!==1||e.anchorNode!==f.node||e.anchorOffset!==f.offset||e.focusNode!==x.node||e.focusOffset!==x.offset)&&(t=t.createRange(),t.setStart(f.node,f.offset),e.removeAllRanges(),m>l?(e.addRange(t),e.extend(x.node,x.offset)):(t.setEnd(x.node,x.offset),e.addRange(t)))}}for(t=[],e=s;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)e=t[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var im=g&&"documentMode"in document&&11>=document.documentMode,qs=null,_l=null,Go=null,El=!1;function Lu(e,t,s){var l=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;El||qs==null||qs!==yn(l)||(l=qs,"selectionStart"in l&&Sl(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Go&&Jo(Go,l)||(Go=l,l=Yi(_l,"onSelect"),0<l.length&&(t=new jr("onSelect","select",null,t,s),e.push({event:t,listeners:l}),t.target=qs)))}function Ji(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var Ks={animationend:Ji("Animation","AnimationEnd"),animationiteration:Ji("Animation","AnimationIteration"),animationstart:Ji("Animation","AnimationStart"),transitionend:Ji("Transition","TransitionEnd")},kl={},$u={};g&&($u=document.createElement("div").style,"AnimationEvent"in window||(delete Ks.animationend.animation,delete Ks.animationiteration.animation,delete Ks.animationstart.animation),"TransitionEvent"in window||delete Ks.transitionend.transition);function Gi(e){if(kl[e])return kl[e];if(!Ks[e])return e;var t=Ks[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in $u)return kl[e]=t[s];return e}var Mu=Gi("animationend"),Uu=Gi("animationiteration"),Fu=Gi("animationstart"),zu=Gi("transitionend"),Vu=new Map,Wu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tn(e,t){Vu.set(e,t),h(t,[e])}for(var Nl=0;Nl<Wu.length;Nl++){var jl=Wu[Nl],am=jl.toLowerCase(),lm=jl[0].toUpperCase()+jl.slice(1);Tn(am,"on"+lm)}Tn(Mu,"onAnimationEnd"),Tn(Uu,"onAnimationIteration"),Tn(Fu,"onAnimationStart"),Tn("dblclick","onDoubleClick"),Tn("focusin","onFocus"),Tn("focusout","onBlur"),Tn(zu,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),h("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),h("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),h("onBeforeInput",["compositionend","keypress","textInput","paste"]),h("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),h("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),h("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cm=new Set("cancel close invalid load scroll toggle".split(" ").concat(Qo));function Bu(e,t,s){var l=e.type||"unknown-event";e.currentTarget=s,Tu(l,t,void 0,e),e.currentTarget=null}function Hu(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var l=e[s],f=l.event;l=l.listeners;e:{var m=void 0;if(t)for(var x=l.length-1;0<=x;x--){var N=l[x],I=N.instance,V=N.currentTarget;if(N=N.listener,I!==m&&f.isPropagationStopped())break e;Bu(f,N,V),m=I}else for(x=0;x<l.length;x++){if(N=l[x],I=N.instance,V=N.currentTarget,N=N.listener,I!==m&&f.isPropagationStopped())break e;Bu(f,N,V),m=I}}}if(St)throw e=Lo,St=!1,Lo=null,e}function tt(e,t){var s=t[Al];s===void 0&&(s=t[Al]=new Set);var l=e+"__bubble";s.has(l)||(qu(t,e,2,!1),s.add(l))}function Tl(e,t,s){var l=0;t&&(l|=4),qu(s,e,l,t)}var Qi="_reactListening"+Math.random().toString(36).slice(2);function Yo(e){if(!e[Qi]){e[Qi]=!0,o.forEach(function(s){s!=="selectionchange"&&(cm.has(s)||Tl(s,!1,e),Tl(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Qi]||(t[Qi]=!0,Tl("selectionchange",!1,t))}}function qu(e,t,s,l){switch(Mi(t)){case 1:var f=Fs;break;case 4:f=qt;break;default:f=zs}s=f.bind(null,t,s,e),f=void 0,!ye||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(f=!0),l?f!==void 0?e.addEventListener(t,s,{capture:!0,passive:f}):e.addEventListener(t,s,!0):f!==void 0?e.addEventListener(t,s,{passive:f}):e.addEventListener(t,s,!1)}function Cl(e,t,s,l,f){var m=l;if((t&1)===0&&(t&2)===0&&l!==null)e:for(;;){if(l===null)return;var x=l.tag;if(x===3||x===4){var N=l.stateNode.containerInfo;if(N===f||N.nodeType===8&&N.parentNode===f)break;if(x===4)for(x=l.return;x!==null;){var I=x.tag;if((I===3||I===4)&&(I=x.stateNode.containerInfo,I===f||I.nodeType===8&&I.parentNode===f))return;x=x.return}for(;N!==null;){if(x=ms(N),x===null)return;if(I=x.tag,I===5||I===6){l=m=x;continue e}N=N.parentNode}}l=l.return}rl(function(){var V=m,ee=Is(s),re=[];e:{var X=Vu.get(e);if(X!==void 0){var he=jr,ge=e;switch(e){case"keypress":if(Vs(s)===0)break e;case"keydown":case"keyup":he=Hi;break;case"focusin":ge="focus",he=Bo;break;case"focusout":ge="blur",he=Bo;break;case"beforeblur":case"afterblur":he=Bo;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=Fi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=cl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=gl;break;case Mu:case Uu:case Fu:he=Hs;break;case zu:he=Ki;break;case"scroll":he=ll;break;case"wheel":he=qo;break;case"copy":case"cut":case"paste":he=Vi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=qi}var ve=(t&4)!==0,ht=!ve&&e==="scroll",U=ve?X!==null?X+"Capture":null:X;ve=[];for(var D=V,F;D!==null;){F=D;var se=F.stateNode;if(F.tag===5&&se!==null&&(F=se,U!==null&&(se=Qn(D,U),se!=null&&ve.push(Xo(D,se,F)))),ht)break;D=D.return}0<ve.length&&(X=new he(X,ge,null,s,ee),re.push({event:X,listeners:ve}))}}if((t&7)===0){e:{if(X=e==="mouseover"||e==="pointerover",he=e==="mouseout"||e==="pointerout",X&&s!==Ht&&(ge=s.relatedTarget||s.fromElement)&&(ms(ge)||ge[sn]))break e;if((he||X)&&(X=ee.window===ee?ee:(X=ee.ownerDocument)?X.defaultView||X.parentWindow:window,he?(ge=s.relatedTarget||s.toElement,he=V,ge=ge?ms(ge):null,ge!==null&&(ht=Sn(ge),ge!==ht||ge.tag!==5&&ge.tag!==6)&&(ge=null)):(he=null,ge=V),he!==ge)){if(ve=Fi,se="onMouseLeave",U="onMouseEnter",D="mouse",(e==="pointerout"||e==="pointerover")&&(ve=qi,se="onPointerLeave",U="onPointerEnter",D="pointer"),ht=he==null?X:Qs(he),F=ge==null?X:Qs(ge),X=new ve(se,D+"leave",he,s,ee),X.target=ht,X.relatedTarget=F,se=null,ms(ee)===V&&(ve=new ve(U,D+"enter",ge,s,ee),ve.target=F,ve.relatedTarget=ht,se=ve),ht=se,he&&ge)t:{for(ve=he,U=ge,D=0,F=ve;F;F=Js(F))D++;for(F=0,se=U;se;se=Js(se))F++;for(;0<D-F;)ve=Js(ve),D--;for(;0<F-D;)U=Js(U),F--;for(;D--;){if(ve===U||U!==null&&ve===U.alternate)break t;ve=Js(ve),U=Js(U)}ve=null}else ve=null;he!==null&&Ku(re,X,he,ve,!1),ge!==null&&ht!==null&&Ku(re,ht,ge,ve,!0)}}e:{if(X=V?Qs(V):window,he=X.nodeName&&X.nodeName.toLowerCase(),he==="select"||he==="input"&&X.type==="file")var xe=xl;else if(de(X))if(Ko)xe=nm;else{xe=tm;var _e=em}else(he=X.nodeName)&&he.toLowerCase()==="input"&&(X.type==="checkbox"||X.type==="radio")&&(xe=rm);if(xe&&(xe=xe(e,V))){Ne(re,xe,s,ee);break e}_e&&_e(e,X,V),e==="focusout"&&(_e=X._wrapperState)&&_e.controlled&&X.type==="number"&&Kn(X,"number",X.value)}switch(_e=V?Qs(V):window,e){case"focusin":(de(_e)||_e.contentEditable==="true")&&(qs=_e,_l=V,Go=null);break;case"focusout":Go=_l=qs=null;break;case"mousedown":El=!0;break;case"contextmenu":case"mouseup":case"dragend":El=!1,Lu(re,s,ee);break;case"selectionchange":if(im)break;case"keydown":case"keyup":Lu(re,s,ee)}var Ee;if(c)e:{switch(e){case"compositionstart":var Te="onCompositionStart";break e;case"compositionend":Te="onCompositionEnd";break e;case"compositionupdate":Te="onCompositionUpdate";break e}Te=void 0}else J?P(e,s)&&(Te="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(Te="onCompositionStart");Te&&(b&&s.locale!=="ko"&&(J||Te!=="onCompositionStart"?Te==="onCompositionEnd"&&J&&(Ee=Wo()):(Wr=ee,Vo="value"in Wr?Wr.value:Wr.textContent,J=!0)),_e=Yi(V,Te),0<_e.length&&(Te=new rr(Te,e,null,s,ee),re.push({event:Te,listeners:_e}),Ee?Te.data=Ee:(Ee=W(s),Ee!==null&&(Te.data=Ee)))),(Ee=y?be(e,s):we(e,s))&&(V=Yi(V,"onBeforeInput"),0<V.length&&(ee=new rr("onBeforeInput","beforeinput",null,s,ee),re.push({event:ee,listeners:V}),ee.data=Ee))}Hu(re,t)})}function Xo(e,t,s){return{instance:e,listener:t,currentTarget:s}}function Yi(e,t){for(var s=t+"Capture",l=[];e!==null;){var f=e,m=f.stateNode;f.tag===5&&m!==null&&(f=m,m=Qn(e,s),m!=null&&l.unshift(Xo(e,m,f)),m=Qn(e,t),m!=null&&l.push(Xo(e,m,f))),e=e.return}return l}function Js(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ku(e,t,s,l,f){for(var m=t._reactName,x=[];s!==null&&s!==l;){var N=s,I=N.alternate,V=N.stateNode;if(I!==null&&I===l)break;N.tag===5&&V!==null&&(N=V,f?(I=Qn(s,m),I!=null&&x.unshift(Xo(s,I,N))):f||(I=Qn(s,m),I!=null&&x.push(Xo(s,I,N)))),s=s.return}x.length!==0&&e.push({event:t,listeners:x})}var um=/\r\n?/g,dm=/\u0000|\uFFFD/g;function Ju(e){return(typeof e=="string"?e:""+e).replace(um,`
`).replace(dm,"")}function Xi(e,t,s){if(t=Ju(t),Ju(e)!==t&&s)throw Error(n(425))}function Zi(){}var Rl=null,Ol=null;function Il(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Pl=typeof setTimeout=="function"?setTimeout:void 0,hm=typeof clearTimeout=="function"?clearTimeout:void 0,Gu=typeof Promise=="function"?Promise:void 0,fm=typeof queueMicrotask=="function"?queueMicrotask:typeof Gu<"u"?function(e){return Gu.resolve(null).then(e).catch(mm)}:Pl;function mm(e){setTimeout(function(){throw e})}function Dl(e,t){var s=t,l=0;do{var f=s.nextSibling;if(e.removeChild(s),f&&f.nodeType===8)if(s=f.data,s==="/$"){if(l===0){e.removeChild(f),Pe(t);return}l--}else s!=="$"&&s!=="$?"&&s!=="$!"||l++;s=f}while(s);Pe(t)}function Cn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Qu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}var Gs=Math.random().toString(36).slice(2),Br="__reactFiber$"+Gs,Zo="__reactProps$"+Gs,sn="__reactContainer$"+Gs,Al="__reactEvents$"+Gs,pm="__reactListeners$"+Gs,gm="__reactHandles$"+Gs;function ms(e){var t=e[Br];if(t)return t;for(var s=e.parentNode;s;){if(t=s[sn]||s[Br]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=Qu(e);e!==null;){if(s=e[Br])return s;e=Qu(e)}return t}e=s,s=e.parentNode}return null}function ei(e){return e=e[Br]||e[sn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Qs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(n(33))}function ea(e){return e[Zo]||null}var Ll=[],Ys=-1;function Rn(e){return{current:e}}function rt(e){0>Ys||(e.current=Ll[Ys],Ll[Ys]=null,Ys--)}function Xe(e,t){Ys++,Ll[Ys]=e.current,e.current=t}var On={},Pt=Rn(On),Kt=Rn(!1),ps=On;function Xs(e,t){var s=e.type.contextTypes;if(!s)return On;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===t)return l.__reactInternalMemoizedMaskedChildContext;var f={},m;for(m in s)f[m]=t[m];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=f),f}function Jt(e){return e=e.childContextTypes,e!=null}function ta(){rt(Kt),rt(Pt)}function Yu(e,t,s){if(Pt.current!==On)throw Error(n(168));Xe(Pt,t),Xe(Kt,s)}function Xu(e,t,s){var l=e.stateNode;if(t=t.childContextTypes,typeof l.getChildContext!="function")return s;l=l.getChildContext();for(var f in l)if(!(f in t))throw Error(n(108,Ke(e)||"Unknown",f));return ue({},s,l)}function ra(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||On,ps=Pt.current,Xe(Pt,e),Xe(Kt,Kt.current),!0}function Zu(e,t,s){var l=e.stateNode;if(!l)throw Error(n(169));s?(e=Xu(e,t,ps),l.__reactInternalMemoizedMergedChildContext=e,rt(Kt),rt(Pt),Xe(Pt,e)):rt(Kt),Xe(Kt,s)}var on=null,na=!1,$l=!1;function ed(e){on===null?on=[e]:on.push(e)}function vm(e){na=!0,ed(e)}function In(){if(!$l&&on!==null){$l=!0;var e=0,t=Ae;try{var s=on;for(Ae=1;e<s.length;e++){var l=s[e];do l=l(!0);while(l!==null)}on=null,na=!1}catch(f){throw on!==null&&(on=on.slice(e+1)),Ri(Mo,In),f}finally{Ae=t,$l=!1}}return null}var Zs=[],eo=0,sa=null,oa=0,pr=[],gr=0,gs=null,an=1,ln="";function vs(e,t){Zs[eo++]=oa,Zs[eo++]=sa,sa=e,oa=t}function td(e,t,s){pr[gr++]=an,pr[gr++]=ln,pr[gr++]=gs,gs=e;var l=an;e=ln;var f=32-Oe(l)-1;l&=~(1<<f),s+=1;var m=32-Oe(t)+f;if(30<m){var x=f-f%5;m=(l&(1<<x)-1).toString(32),l>>=x,f-=x,an=1<<32-Oe(t)+f|s<<f|l,ln=m+e}else an=1<<m|s<<f|l,ln=e}function Ml(e){e.return!==null&&(vs(e,1),td(e,1,0))}function Ul(e){for(;e===sa;)sa=Zs[--eo],Zs[eo]=null,oa=Zs[--eo],Zs[eo]=null;for(;e===gs;)gs=pr[--gr],pr[gr]=null,ln=pr[--gr],pr[gr]=null,an=pr[--gr],pr[gr]=null}var nr=null,sr=null,it=!1,Cr=null;function rd(e,t){var s=wr(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)}function nd(e,t){switch(e.tag){case 5:var s=e.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,nr=e,sr=Cn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,nr=e,sr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=gs!==null?{id:an,overflow:ln}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=wr(18,null,null,0),s.stateNode=t,s.return=e,e.child=s,nr=e,sr=null,!0):!1;default:return!1}}function Fl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function zl(e){if(it){var t=sr;if(t){var s=t;if(!nd(e,t)){if(Fl(e))throw Error(n(418));t=Cn(s.nextSibling);var l=nr;t&&nd(e,t)?rd(l,s):(e.flags=e.flags&-4097|2,it=!1,nr=e)}}else{if(Fl(e))throw Error(n(418));e.flags=e.flags&-4097|2,it=!1,nr=e}}}function sd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;nr=e}function ia(e){if(e!==nr)return!1;if(!it)return sd(e),it=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Il(e.type,e.memoizedProps)),t&&(t=sr)){if(Fl(e))throw od(),Error(n(418));for(;t;)rd(e,t),t=Cn(t.nextSibling)}if(sd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(n(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(t===0){sr=Cn(e.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}e=e.nextSibling}sr=null}}else sr=nr?Cn(e.stateNode.nextSibling):null;return!0}function od(){for(var e=sr;e;)e=Cn(e.nextSibling)}function to(){sr=nr=null,it=!1}function Vl(e){Cr===null?Cr=[e]:Cr.push(e)}var ym=$.ReactCurrentBatchConfig;function ti(e,t,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(n(309));var l=s.stateNode}if(!l)throw Error(n(147,e));var f=l,m=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===m?t.ref:(t=function(x){var N=f.refs;x===null?delete N[m]:N[m]=x},t._stringRef=m,t)}if(typeof e!="string")throw Error(n(284));if(!s._owner)throw Error(n(290,e))}return e}function aa(e,t){throw e=Object.prototype.toString.call(t),Error(n(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function id(e){var t=e._init;return t(e._payload)}function ad(e){function t(U,D){if(e){var F=U.deletions;F===null?(U.deletions=[D],U.flags|=16):F.push(D)}}function s(U,D){if(!e)return null;for(;D!==null;)t(U,D),D=D.sibling;return null}function l(U,D){for(U=new Map;D!==null;)D.key!==null?U.set(D.key,D):U.set(D.index,D),D=D.sibling;return U}function f(U,D){return U=Fn(U,D),U.index=0,U.sibling=null,U}function m(U,D,F){return U.index=F,e?(F=U.alternate,F!==null?(F=F.index,F<D?(U.flags|=2,D):F):(U.flags|=2,D)):(U.flags|=1048576,D)}function x(U){return e&&U.alternate===null&&(U.flags|=2),U}function N(U,D,F,se){return D===null||D.tag!==6?(D=Pc(F,U.mode,se),D.return=U,D):(D=f(D,F),D.return=U,D)}function I(U,D,F,se){var xe=F.type;return xe===ne?ee(U,D,F.props.children,se,F.key):D!==null&&(D.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===et&&id(xe)===D.type)?(se=f(D,F.props),se.ref=ti(U,D,F),se.return=U,se):(se=Oa(F.type,F.key,F.props,null,U.mode,se),se.ref=ti(U,D,F),se.return=U,se)}function V(U,D,F,se){return D===null||D.tag!==4||D.stateNode.containerInfo!==F.containerInfo||D.stateNode.implementation!==F.implementation?(D=Dc(F,U.mode,se),D.return=U,D):(D=f(D,F.children||[]),D.return=U,D)}function ee(U,D,F,se,xe){return D===null||D.tag!==7?(D=ks(F,U.mode,se,xe),D.return=U,D):(D=f(D,F),D.return=U,D)}function re(U,D,F){if(typeof D=="string"&&D!==""||typeof D=="number")return D=Pc(""+D,U.mode,F),D.return=U,D;if(typeof D=="object"&&D!==null){switch(D.$$typeof){case G:return F=Oa(D.type,D.key,D.props,null,U.mode,F),F.ref=ti(U,null,D),F.return=U,F;case z:return D=Dc(D,U.mode,F),D.return=U,D;case et:var se=D._init;return re(U,se(D._payload),F)}if(Lr(D)||pe(D))return D=ks(D,U.mode,F,null),D.return=U,D;aa(U,D)}return null}function X(U,D,F,se){var xe=D!==null?D.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return xe!==null?null:N(U,D,""+F,se);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case G:return F.key===xe?I(U,D,F,se):null;case z:return F.key===xe?V(U,D,F,se):null;case et:return xe=F._init,X(U,D,xe(F._payload),se)}if(Lr(F)||pe(F))return xe!==null?null:ee(U,D,F,se,null);aa(U,F)}return null}function he(U,D,F,se,xe){if(typeof se=="string"&&se!==""||typeof se=="number")return U=U.get(F)||null,N(D,U,""+se,xe);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case G:return U=U.get(se.key===null?F:se.key)||null,I(D,U,se,xe);case z:return U=U.get(se.key===null?F:se.key)||null,V(D,U,se,xe);case et:var _e=se._init;return he(U,D,F,_e(se._payload),xe)}if(Lr(se)||pe(se))return U=U.get(F)||null,ee(D,U,se,xe,null);aa(D,se)}return null}function ge(U,D,F,se){for(var xe=null,_e=null,Ee=D,Te=D=0,Nt=null;Ee!==null&&Te<F.length;Te++){Ee.index>Te?(Nt=Ee,Ee=null):Nt=Ee.sibling;var We=X(U,Ee,F[Te],se);if(We===null){Ee===null&&(Ee=Nt);break}e&&Ee&&We.alternate===null&&t(U,Ee),D=m(We,D,Te),_e===null?xe=We:_e.sibling=We,_e=We,Ee=Nt}if(Te===F.length)return s(U,Ee),it&&vs(U,Te),xe;if(Ee===null){for(;Te<F.length;Te++)Ee=re(U,F[Te],se),Ee!==null&&(D=m(Ee,D,Te),_e===null?xe=Ee:_e.sibling=Ee,_e=Ee);return it&&vs(U,Te),xe}for(Ee=l(U,Ee);Te<F.length;Te++)Nt=he(Ee,U,Te,F[Te],se),Nt!==null&&(e&&Nt.alternate!==null&&Ee.delete(Nt.key===null?Te:Nt.key),D=m(Nt,D,Te),_e===null?xe=Nt:_e.sibling=Nt,_e=Nt);return e&&Ee.forEach(function(zn){return t(U,zn)}),it&&vs(U,Te),xe}function ve(U,D,F,se){var xe=pe(F);if(typeof xe!="function")throw Error(n(150));if(F=xe.call(F),F==null)throw Error(n(151));for(var _e=xe=null,Ee=D,Te=D=0,Nt=null,We=F.next();Ee!==null&&!We.done;Te++,We=F.next()){Ee.index>Te?(Nt=Ee,Ee=null):Nt=Ee.sibling;var zn=X(U,Ee,We.value,se);if(zn===null){Ee===null&&(Ee=Nt);break}e&&Ee&&zn.alternate===null&&t(U,Ee),D=m(zn,D,Te),_e===null?xe=zn:_e.sibling=zn,_e=zn,Ee=Nt}if(We.done)return s(U,Ee),it&&vs(U,Te),xe;if(Ee===null){for(;!We.done;Te++,We=F.next())We=re(U,We.value,se),We!==null&&(D=m(We,D,Te),_e===null?xe=We:_e.sibling=We,_e=We);return it&&vs(U,Te),xe}for(Ee=l(U,Ee);!We.done;Te++,We=F.next())We=he(Ee,U,Te,We.value,se),We!==null&&(e&&We.alternate!==null&&Ee.delete(We.key===null?Te:We.key),D=m(We,D,Te),_e===null?xe=We:_e.sibling=We,_e=We);return e&&Ee.forEach(function(Ym){return t(U,Ym)}),it&&vs(U,Te),xe}function ht(U,D,F,se){if(typeof F=="object"&&F!==null&&F.type===ne&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case G:e:{for(var xe=F.key,_e=D;_e!==null;){if(_e.key===xe){if(xe=F.type,xe===ne){if(_e.tag===7){s(U,_e.sibling),D=f(_e,F.props.children),D.return=U,U=D;break e}}else if(_e.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===et&&id(xe)===_e.type){s(U,_e.sibling),D=f(_e,F.props),D.ref=ti(U,_e,F),D.return=U,U=D;break e}s(U,_e);break}else t(U,_e);_e=_e.sibling}F.type===ne?(D=ks(F.props.children,U.mode,se,F.key),D.return=U,U=D):(se=Oa(F.type,F.key,F.props,null,U.mode,se),se.ref=ti(U,D,F),se.return=U,U=se)}return x(U);case z:e:{for(_e=F.key;D!==null;){if(D.key===_e)if(D.tag===4&&D.stateNode.containerInfo===F.containerInfo&&D.stateNode.implementation===F.implementation){s(U,D.sibling),D=f(D,F.children||[]),D.return=U,U=D;break e}else{s(U,D);break}else t(U,D);D=D.sibling}D=Dc(F,U.mode,se),D.return=U,U=D}return x(U);case et:return _e=F._init,ht(U,D,_e(F._payload),se)}if(Lr(F))return ge(U,D,F,se);if(pe(F))return ve(U,D,F,se);aa(U,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,D!==null&&D.tag===6?(s(U,D.sibling),D=f(D,F),D.return=U,U=D):(s(U,D),D=Pc(F,U.mode,se),D.return=U,U=D),x(U)):s(U,D)}return ht}var ro=ad(!0),ld=ad(!1),la=Rn(null),ca=null,no=null,Wl=null;function Bl(){Wl=no=ca=null}function Hl(e){var t=la.current;rt(la),e._currentValue=t}function ql(e,t,s){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===s)break;e=e.return}}function so(e,t){ca=e,Wl=no=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Gt=!0),e.firstContext=null)}function vr(e){var t=e._currentValue;if(Wl!==e)if(e={context:e,memoizedValue:t,next:null},no===null){if(ca===null)throw Error(n(308));no=e,ca.dependencies={lanes:0,firstContext:e}}else no=no.next=e;return t}var ys=null;function Kl(e){ys===null?ys=[e]:ys.push(e)}function cd(e,t,s,l){var f=t.interleaved;return f===null?(s.next=s,Kl(t)):(s.next=f.next,f.next=s),t.interleaved=s,cn(e,l)}function cn(e,t){e.lanes|=t;var s=e.alternate;for(s!==null&&(s.lanes|=t),s=e,e=e.return;e!==null;)e.childLanes|=t,s=e.alternate,s!==null&&(s.childLanes|=t),s=e,e=e.return;return s.tag===3?s.stateNode:null}var Pn=!1;function Jl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ud(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function un(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Dn(e,t,s){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(Ve&2)!==0){var f=l.pending;return f===null?t.next=t:(t.next=f.next,f.next=t),l.pending=t,cn(e,s)}return f=l.interleaved,f===null?(t.next=t,Kl(l)):(t.next=f.next,f.next=t),l.interleaved=t,cn(e,s)}function ua(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var l=t.lanes;l&=e.pendingLanes,s|=l,t.lanes=s,zr(e,s)}}function dd(e,t){var s=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,s===l)){var f=null,m=null;if(s=s.firstBaseUpdate,s!==null){do{var x={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};m===null?f=m=x:m=m.next=x,s=s.next}while(s!==null);m===null?f=m=t:m=m.next=t}else f=m=t;s={baseState:l.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:l.shared,effects:l.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function da(e,t,s,l){var f=e.updateQueue;Pn=!1;var m=f.firstBaseUpdate,x=f.lastBaseUpdate,N=f.shared.pending;if(N!==null){f.shared.pending=null;var I=N,V=I.next;I.next=null,x===null?m=V:x.next=V,x=I;var ee=e.alternate;ee!==null&&(ee=ee.updateQueue,N=ee.lastBaseUpdate,N!==x&&(N===null?ee.firstBaseUpdate=V:N.next=V,ee.lastBaseUpdate=I))}if(m!==null){var re=f.baseState;x=0,ee=V=I=null,N=m;do{var X=N.lane,he=N.eventTime;if((l&X)===X){ee!==null&&(ee=ee.next={eventTime:he,lane:0,tag:N.tag,payload:N.payload,callback:N.callback,next:null});e:{var ge=e,ve=N;switch(X=t,he=s,ve.tag){case 1:if(ge=ve.payload,typeof ge=="function"){re=ge.call(he,re,X);break e}re=ge;break e;case 3:ge.flags=ge.flags&-65537|128;case 0:if(ge=ve.payload,X=typeof ge=="function"?ge.call(he,re,X):ge,X==null)break e;re=ue({},re,X);break e;case 2:Pn=!0}}N.callback!==null&&N.lane!==0&&(e.flags|=64,X=f.effects,X===null?f.effects=[N]:X.push(N))}else he={eventTime:he,lane:X,tag:N.tag,payload:N.payload,callback:N.callback,next:null},ee===null?(V=ee=he,I=re):ee=ee.next=he,x|=X;if(N=N.next,N===null){if(N=f.shared.pending,N===null)break;X=N,N=X.next,X.next=null,f.lastBaseUpdate=X,f.shared.pending=null}}while(!0);if(ee===null&&(I=re),f.baseState=I,f.firstBaseUpdate=V,f.lastBaseUpdate=ee,t=f.shared.interleaved,t!==null){f=t;do x|=f.lane,f=f.next;while(f!==t)}else m===null&&(f.shared.lanes=0);bs|=x,e.lanes=x,e.memoizedState=re}}function hd(e,t,s){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var l=e[t],f=l.callback;if(f!==null){if(l.callback=null,l=s,typeof f!="function")throw Error(n(191,f));f.call(l)}}}var ri={},Hr=Rn(ri),ni=Rn(ri),si=Rn(ri);function xs(e){if(e===ri)throw Error(n(174));return e}function Gl(e,t){switch(Xe(si,t),Xe(ni,e),Xe(Hr,ri),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Jn(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Jn(t,e)}rt(Hr),Xe(Hr,t)}function oo(){rt(Hr),rt(ni),rt(si)}function fd(e){xs(si.current);var t=xs(Hr.current),s=Jn(t,e.type);t!==s&&(Xe(ni,e),Xe(Hr,s))}function Ql(e){ni.current===e&&(rt(Hr),rt(ni))}var at=Rn(0);function ha(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Yl=[];function Xl(){for(var e=0;e<Yl.length;e++)Yl[e]._workInProgressVersionPrimary=null;Yl.length=0}var fa=$.ReactCurrentDispatcher,Zl=$.ReactCurrentBatchConfig,ws=0,lt=null,gt=null,Et=null,ma=!1,oi=!1,ii=0,xm=0;function Dt(){throw Error(n(321))}function ec(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!Tr(e[s],t[s]))return!1;return!0}function tc(e,t,s,l,f,m){if(ws=m,lt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fa.current=e===null||e.memoizedState===null?_m:Em,e=s(l,f),oi){m=0;do{if(oi=!1,ii=0,25<=m)throw Error(n(301));m+=1,Et=gt=null,t.updateQueue=null,fa.current=km,e=s(l,f)}while(oi)}if(fa.current=va,t=gt!==null&&gt.next!==null,ws=0,Et=gt=lt=null,ma=!1,t)throw Error(n(300));return e}function rc(){var e=ii!==0;return ii=0,e}function qr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?lt.memoizedState=Et=e:Et=Et.next=e,Et}function yr(){if(gt===null){var e=lt.alternate;e=e!==null?e.memoizedState:null}else e=gt.next;var t=Et===null?lt.memoizedState:Et.next;if(t!==null)Et=t,gt=e;else{if(e===null)throw Error(n(310));gt=e,e={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},Et===null?lt.memoizedState=Et=e:Et=Et.next=e}return Et}function ai(e,t){return typeof t=="function"?t(e):t}function nc(e){var t=yr(),s=t.queue;if(s===null)throw Error(n(311));s.lastRenderedReducer=e;var l=gt,f=l.baseQueue,m=s.pending;if(m!==null){if(f!==null){var x=f.next;f.next=m.next,m.next=x}l.baseQueue=f=m,s.pending=null}if(f!==null){m=f.next,l=l.baseState;var N=x=null,I=null,V=m;do{var ee=V.lane;if((ws&ee)===ee)I!==null&&(I=I.next={lane:0,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null}),l=V.hasEagerState?V.eagerState:e(l,V.action);else{var re={lane:ee,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null};I===null?(N=I=re,x=l):I=I.next=re,lt.lanes|=ee,bs|=ee}V=V.next}while(V!==null&&V!==m);I===null?x=l:I.next=N,Tr(l,t.memoizedState)||(Gt=!0),t.memoizedState=l,t.baseState=x,t.baseQueue=I,s.lastRenderedState=l}if(e=s.interleaved,e!==null){f=e;do m=f.lane,lt.lanes|=m,bs|=m,f=f.next;while(f!==e)}else f===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function sc(e){var t=yr(),s=t.queue;if(s===null)throw Error(n(311));s.lastRenderedReducer=e;var l=s.dispatch,f=s.pending,m=t.memoizedState;if(f!==null){s.pending=null;var x=f=f.next;do m=e(m,x.action),x=x.next;while(x!==f);Tr(m,t.memoizedState)||(Gt=!0),t.memoizedState=m,t.baseQueue===null&&(t.baseState=m),s.lastRenderedState=m}return[m,l]}function md(){}function pd(e,t){var s=lt,l=yr(),f=t(),m=!Tr(l.memoizedState,f);if(m&&(l.memoizedState=f,Gt=!0),l=l.queue,oc(yd.bind(null,s,l,e),[e]),l.getSnapshot!==t||m||Et!==null&&Et.memoizedState.tag&1){if(s.flags|=2048,li(9,vd.bind(null,s,l,f,t),void 0,null),kt===null)throw Error(n(349));(ws&30)!==0||gd(s,t,f)}return f}function gd(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=lt.updateQueue,t===null?(t={lastEffect:null,stores:null},lt.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function vd(e,t,s,l){t.value=s,t.getSnapshot=l,xd(t)&&wd(e)}function yd(e,t,s){return s(function(){xd(t)&&wd(e)})}function xd(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!Tr(e,s)}catch{return!0}}function wd(e){var t=cn(e,1);t!==null&&Pr(t,e,1,-1)}function bd(e){var t=qr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:e},t.queue=e,e=e.dispatch=Sm.bind(null,lt,e),[t.memoizedState,e]}function li(e,t,s,l){return e={tag:e,create:t,destroy:s,deps:l,next:null},t=lt.updateQueue,t===null?(t={lastEffect:null,stores:null},lt.updateQueue=t,t.lastEffect=e.next=e):(s=t.lastEffect,s===null?t.lastEffect=e.next=e:(l=s.next,s.next=e,e.next=l,t.lastEffect=e)),e}function Sd(){return yr().memoizedState}function pa(e,t,s,l){var f=qr();lt.flags|=e,f.memoizedState=li(1|t,s,void 0,l===void 0?null:l)}function ga(e,t,s,l){var f=yr();l=l===void 0?null:l;var m=void 0;if(gt!==null){var x=gt.memoizedState;if(m=x.destroy,l!==null&&ec(l,x.deps)){f.memoizedState=li(t,s,m,l);return}}lt.flags|=e,f.memoizedState=li(1|t,s,m,l)}function _d(e,t){return pa(8390656,8,e,t)}function oc(e,t){return ga(2048,8,e,t)}function Ed(e,t){return ga(4,2,e,t)}function kd(e,t){return ga(4,4,e,t)}function Nd(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function jd(e,t,s){return s=s!=null?s.concat([e]):null,ga(4,4,Nd.bind(null,t,e),s)}function ic(){}function Td(e,t){var s=yr();t=t===void 0?null:t;var l=s.memoizedState;return l!==null&&t!==null&&ec(t,l[1])?l[0]:(s.memoizedState=[e,t],e)}function Cd(e,t){var s=yr();t=t===void 0?null:t;var l=s.memoizedState;return l!==null&&t!==null&&ec(t,l[1])?l[0]:(e=e(),s.memoizedState=[e,t],e)}function Rd(e,t,s){return(ws&21)===0?(e.baseState&&(e.baseState=!1,Gt=!0),e.memoizedState=s):(Tr(s,t)||(s=Fo(),lt.lanes|=s,bs|=s,e.baseState=!0),t)}function wm(e,t){var s=Ae;Ae=s!==0&&4>s?s:4,e(!0);var l=Zl.transition;Zl.transition={};try{e(!1),t()}finally{Ae=s,Zl.transition=l}}function Od(){return yr().memoizedState}function bm(e,t,s){var l=Mn(e);if(s={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null},Id(e))Pd(t,s);else if(s=cd(e,t,s,l),s!==null){var f=Wt();Pr(s,e,l,f),Dd(s,t,l)}}function Sm(e,t,s){var l=Mn(e),f={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null};if(Id(e))Pd(t,f);else{var m=e.alternate;if(e.lanes===0&&(m===null||m.lanes===0)&&(m=t.lastRenderedReducer,m!==null))try{var x=t.lastRenderedState,N=m(x,s);if(f.hasEagerState=!0,f.eagerState=N,Tr(N,x)){var I=t.interleaved;I===null?(f.next=f,Kl(t)):(f.next=I.next,I.next=f),t.interleaved=f;return}}catch{}finally{}s=cd(e,t,f,l),s!==null&&(f=Wt(),Pr(s,e,l,f),Dd(s,t,l))}}function Id(e){var t=e.alternate;return e===lt||t!==null&&t===lt}function Pd(e,t){oi=ma=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function Dd(e,t,s){if((s&4194240)!==0){var l=t.lanes;l&=e.pendingLanes,s|=l,t.lanes=s,zr(e,s)}}var va={readContext:vr,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useInsertionEffect:Dt,useLayoutEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useMutableSource:Dt,useSyncExternalStore:Dt,useId:Dt,unstable_isNewReconciler:!1},_m={readContext:vr,useCallback:function(e,t){return qr().memoizedState=[e,t===void 0?null:t],e},useContext:vr,useEffect:_d,useImperativeHandle:function(e,t,s){return s=s!=null?s.concat([e]):null,pa(4194308,4,Nd.bind(null,t,e),s)},useLayoutEffect:function(e,t){return pa(4194308,4,e,t)},useInsertionEffect:function(e,t){return pa(4,2,e,t)},useMemo:function(e,t){var s=qr();return t=t===void 0?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var l=qr();return t=s!==void 0?s(t):t,l.memoizedState=l.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},l.queue=e,e=e.dispatch=bm.bind(null,lt,e),[l.memoizedState,e]},useRef:function(e){var t=qr();return e={current:e},t.memoizedState=e},useState:bd,useDebugValue:ic,useDeferredValue:function(e){return qr().memoizedState=e},useTransition:function(){var e=bd(!1),t=e[0];return e=wm.bind(null,e[1]),qr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var l=lt,f=qr();if(it){if(s===void 0)throw Error(n(407));s=s()}else{if(s=t(),kt===null)throw Error(n(349));(ws&30)!==0||gd(l,t,s)}f.memoizedState=s;var m={value:s,getSnapshot:t};return f.queue=m,_d(yd.bind(null,l,m,e),[e]),l.flags|=2048,li(9,vd.bind(null,l,m,s,t),void 0,null),s},useId:function(){var e=qr(),t=kt.identifierPrefix;if(it){var s=ln,l=an;s=(l&~(1<<32-Oe(l)-1)).toString(32)+s,t=":"+t+"R"+s,s=ii++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=xm++,t=":"+t+"r"+s.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Em={readContext:vr,useCallback:Td,useContext:vr,useEffect:oc,useImperativeHandle:jd,useInsertionEffect:Ed,useLayoutEffect:kd,useMemo:Cd,useReducer:nc,useRef:Sd,useState:function(){return nc(ai)},useDebugValue:ic,useDeferredValue:function(e){var t=yr();return Rd(t,gt.memoizedState,e)},useTransition:function(){var e=nc(ai)[0],t=yr().memoizedState;return[e,t]},useMutableSource:md,useSyncExternalStore:pd,useId:Od,unstable_isNewReconciler:!1},km={readContext:vr,useCallback:Td,useContext:vr,useEffect:oc,useImperativeHandle:jd,useInsertionEffect:Ed,useLayoutEffect:kd,useMemo:Cd,useReducer:sc,useRef:Sd,useState:function(){return sc(ai)},useDebugValue:ic,useDeferredValue:function(e){var t=yr();return gt===null?t.memoizedState=e:Rd(t,gt.memoizedState,e)},useTransition:function(){var e=sc(ai)[0],t=yr().memoizedState;return[e,t]},useMutableSource:md,useSyncExternalStore:pd,useId:Od,unstable_isNewReconciler:!1};function Rr(e,t){if(e&&e.defaultProps){t=ue({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function ac(e,t,s,l){t=e.memoizedState,s=s(l,t),s=s==null?t:ue({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var ya={isMounted:function(e){return(e=e._reactInternals)?Sn(e)===e:!1},enqueueSetState:function(e,t,s){e=e._reactInternals;var l=Wt(),f=Mn(e),m=un(l,f);m.payload=t,s!=null&&(m.callback=s),t=Dn(e,m,f),t!==null&&(Pr(t,e,f,l),ua(t,e,f))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var l=Wt(),f=Mn(e),m=un(l,f);m.tag=1,m.payload=t,s!=null&&(m.callback=s),t=Dn(e,m,f),t!==null&&(Pr(t,e,f,l),ua(t,e,f))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=Wt(),l=Mn(e),f=un(s,l);f.tag=2,t!=null&&(f.callback=t),t=Dn(e,f,l),t!==null&&(Pr(t,e,l,s),ua(t,e,l))}};function Ad(e,t,s,l,f,m,x){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,m,x):t.prototype&&t.prototype.isPureReactComponent?!Jo(s,l)||!Jo(f,m):!0}function Ld(e,t,s){var l=!1,f=On,m=t.contextType;return typeof m=="object"&&m!==null?m=vr(m):(f=Jt(t)?ps:Pt.current,l=t.contextTypes,m=(l=l!=null)?Xs(e,f):On),t=new t(s,m),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ya,e.stateNode=t,t._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=f,e.__reactInternalMemoizedMaskedChildContext=m),t}function $d(e,t,s,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,l),t.state!==e&&ya.enqueueReplaceState(t,t.state,null)}function lc(e,t,s,l){var f=e.stateNode;f.props=s,f.state=e.memoizedState,f.refs={},Jl(e);var m=t.contextType;typeof m=="object"&&m!==null?f.context=vr(m):(m=Jt(t)?ps:Pt.current,f.context=Xs(e,m)),f.state=e.memoizedState,m=t.getDerivedStateFromProps,typeof m=="function"&&(ac(e,t,m,s),f.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(t=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),t!==f.state&&ya.enqueueReplaceState(f,f.state,null),da(e,s,f,l),f.state=e.memoizedState),typeof f.componentDidMount=="function"&&(e.flags|=4194308)}function io(e,t){try{var s="",l=t;do s+=$e(l),l=l.return;while(l);var f=s}catch(m){f=`
Error generating stack: `+m.message+`
`+m.stack}return{value:e,source:t,stack:f,digest:null}}function cc(e,t,s){return{value:e,source:null,stack:s??null,digest:t??null}}function uc(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var Nm=typeof WeakMap=="function"?WeakMap:Map;function Md(e,t,s){s=un(-1,s),s.tag=3,s.payload={element:null};var l=t.value;return s.callback=function(){ka||(ka=!0,kc=l),uc(e,t)},s}function Ud(e,t,s){s=un(-1,s),s.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var f=t.value;s.payload=function(){return l(f)},s.callback=function(){uc(e,t)}}var m=e.stateNode;return m!==null&&typeof m.componentDidCatch=="function"&&(s.callback=function(){uc(e,t),typeof l!="function"&&(Ln===null?Ln=new Set([this]):Ln.add(this));var x=t.stack;this.componentDidCatch(t.value,{componentStack:x!==null?x:""})}),s}function Fd(e,t,s){var l=e.pingCache;if(l===null){l=e.pingCache=new Nm;var f=new Set;l.set(t,f)}else f=l.get(t),f===void 0&&(f=new Set,l.set(t,f));f.has(s)||(f.add(s),e=Fm.bind(null,e,t,s),t.then(e,e))}function zd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Vd(e,t,s,l,f){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=un(-1,1),t.tag=2,Dn(s,t,1))),s.lanes|=1),e):(e.flags|=65536,e.lanes=f,e)}var jm=$.ReactCurrentOwner,Gt=!1;function Vt(e,t,s,l){t.child=e===null?ld(t,null,s,l):ro(t,e.child,s,l)}function Wd(e,t,s,l,f){s=s.render;var m=t.ref;return so(t,f),l=tc(e,t,s,l,m,f),s=rc(),e!==null&&!Gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~f,dn(e,t,f)):(it&&s&&Ml(t),t.flags|=1,Vt(e,t,l,f),t.child)}function Bd(e,t,s,l,f){if(e===null){var m=s.type;return typeof m=="function"&&!Ic(m)&&m.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=m,Hd(e,t,m,l,f)):(e=Oa(s.type,null,l,t,t.mode,f),e.ref=t.ref,e.return=t,t.child=e)}if(m=e.child,(e.lanes&f)===0){var x=m.memoizedProps;if(s=s.compare,s=s!==null?s:Jo,s(x,l)&&e.ref===t.ref)return dn(e,t,f)}return t.flags|=1,e=Fn(m,l),e.ref=t.ref,e.return=t,t.child=e}function Hd(e,t,s,l,f){if(e!==null){var m=e.memoizedProps;if(Jo(m,l)&&e.ref===t.ref)if(Gt=!1,t.pendingProps=l=m,(e.lanes&f)!==0)(e.flags&131072)!==0&&(Gt=!0);else return t.lanes=e.lanes,dn(e,t,f)}return dc(e,t,s,l,f)}function qd(e,t,s){var l=t.pendingProps,f=l.children,m=e!==null?e.memoizedState:null;if(l.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xe(lo,or),or|=s;else{if((s&1073741824)===0)return e=m!==null?m.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Xe(lo,or),or|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=m!==null?m.baseLanes:s,Xe(lo,or),or|=l}else m!==null?(l=m.baseLanes|s,t.memoizedState=null):l=s,Xe(lo,or),or|=l;return Vt(e,t,f,s),t.child}function Kd(e,t){var s=t.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function dc(e,t,s,l,f){var m=Jt(s)?ps:Pt.current;return m=Xs(t,m),so(t,f),s=tc(e,t,s,l,m,f),l=rc(),e!==null&&!Gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~f,dn(e,t,f)):(it&&l&&Ml(t),t.flags|=1,Vt(e,t,s,f),t.child)}function Jd(e,t,s,l,f){if(Jt(s)){var m=!0;ra(t)}else m=!1;if(so(t,f),t.stateNode===null)wa(e,t),Ld(t,s,l),lc(t,s,l,f),l=!0;else if(e===null){var x=t.stateNode,N=t.memoizedProps;x.props=N;var I=x.context,V=s.contextType;typeof V=="object"&&V!==null?V=vr(V):(V=Jt(s)?ps:Pt.current,V=Xs(t,V));var ee=s.getDerivedStateFromProps,re=typeof ee=="function"||typeof x.getSnapshotBeforeUpdate=="function";re||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(N!==l||I!==V)&&$d(t,x,l,V),Pn=!1;var X=t.memoizedState;x.state=X,da(t,l,x,f),I=t.memoizedState,N!==l||X!==I||Kt.current||Pn?(typeof ee=="function"&&(ac(t,s,ee,l),I=t.memoizedState),(N=Pn||Ad(t,s,N,l,X,I,V))?(re||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(t.flags|=4194308)):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=I),x.props=l,x.state=I,x.context=V,l=N):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{x=t.stateNode,ud(e,t),N=t.memoizedProps,V=t.type===t.elementType?N:Rr(t.type,N),x.props=V,re=t.pendingProps,X=x.context,I=s.contextType,typeof I=="object"&&I!==null?I=vr(I):(I=Jt(s)?ps:Pt.current,I=Xs(t,I));var he=s.getDerivedStateFromProps;(ee=typeof he=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(N!==re||X!==I)&&$d(t,x,l,I),Pn=!1,X=t.memoizedState,x.state=X,da(t,l,x,f);var ge=t.memoizedState;N!==re||X!==ge||Kt.current||Pn?(typeof he=="function"&&(ac(t,s,he,l),ge=t.memoizedState),(V=Pn||Ad(t,s,V,l,X,ge,I)||!1)?(ee||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(l,ge,I),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(l,ge,I)),typeof x.componentDidUpdate=="function"&&(t.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof x.componentDidUpdate!="function"||N===e.memoizedProps&&X===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||N===e.memoizedProps&&X===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=ge),x.props=l,x.state=ge,x.context=I,l=V):(typeof x.componentDidUpdate!="function"||N===e.memoizedProps&&X===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||N===e.memoizedProps&&X===e.memoizedState||(t.flags|=1024),l=!1)}return hc(e,t,s,l,m,f)}function hc(e,t,s,l,f,m){Kd(e,t);var x=(t.flags&128)!==0;if(!l&&!x)return f&&Zu(t,s,!1),dn(e,t,m);l=t.stateNode,jm.current=t;var N=x&&typeof s.getDerivedStateFromError!="function"?null:l.render();return t.flags|=1,e!==null&&x?(t.child=ro(t,e.child,null,m),t.child=ro(t,null,N,m)):Vt(e,t,N,m),t.memoizedState=l.state,f&&Zu(t,s,!0),t.child}function Gd(e){var t=e.stateNode;t.pendingContext?Yu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Yu(e,t.context,!1),Gl(e,t.containerInfo)}function Qd(e,t,s,l,f){return to(),Vl(f),t.flags|=256,Vt(e,t,s,l),t.child}var fc={dehydrated:null,treeContext:null,retryLane:0};function mc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Yd(e,t,s){var l=t.pendingProps,f=at.current,m=!1,x=(t.flags&128)!==0,N;if((N=x)||(N=e!==null&&e.memoizedState===null?!1:(f&2)!==0),N?(m=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(f|=1),Xe(at,f&1),e===null)return zl(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(x=l.children,e=l.fallback,m?(l=t.mode,m=t.child,x={mode:"hidden",children:x},(l&1)===0&&m!==null?(m.childLanes=0,m.pendingProps=x):m=Ia(x,l,0,null),e=ks(e,l,s,null),m.return=t,e.return=t,m.sibling=e,t.child=m,t.child.memoizedState=mc(s),t.memoizedState=fc,e):pc(t,x));if(f=e.memoizedState,f!==null&&(N=f.dehydrated,N!==null))return Tm(e,t,x,l,N,f,s);if(m){m=l.fallback,x=t.mode,f=e.child,N=f.sibling;var I={mode:"hidden",children:l.children};return(x&1)===0&&t.child!==f?(l=t.child,l.childLanes=0,l.pendingProps=I,t.deletions=null):(l=Fn(f,I),l.subtreeFlags=f.subtreeFlags&14680064),N!==null?m=Fn(N,m):(m=ks(m,x,s,null),m.flags|=2),m.return=t,l.return=t,l.sibling=m,t.child=l,l=m,m=t.child,x=e.child.memoizedState,x=x===null?mc(s):{baseLanes:x.baseLanes|s,cachePool:null,transitions:x.transitions},m.memoizedState=x,m.childLanes=e.childLanes&~s,t.memoizedState=fc,l}return m=e.child,e=m.sibling,l=Fn(m,{mode:"visible",children:l.children}),(t.mode&1)===0&&(l.lanes=s),l.return=t,l.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=l,t.memoizedState=null,l}function pc(e,t){return t=Ia({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function xa(e,t,s,l){return l!==null&&Vl(l),ro(t,e.child,null,s),e=pc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Tm(e,t,s,l,f,m,x){if(s)return t.flags&256?(t.flags&=-257,l=cc(Error(n(422))),xa(e,t,x,l)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(m=l.fallback,f=t.mode,l=Ia({mode:"visible",children:l.children},f,0,null),m=ks(m,f,x,null),m.flags|=2,l.return=t,m.return=t,l.sibling=m,t.child=l,(t.mode&1)!==0&&ro(t,e.child,null,x),t.child.memoizedState=mc(x),t.memoizedState=fc,m);if((t.mode&1)===0)return xa(e,t,x,null);if(f.data==="$!"){if(l=f.nextSibling&&f.nextSibling.dataset,l)var N=l.dgst;return l=N,m=Error(n(419)),l=cc(m,l,void 0),xa(e,t,x,l)}if(N=(x&e.childLanes)!==0,Gt||N){if(l=kt,l!==null){switch(x&-x){case 4:f=2;break;case 16:f=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:f=32;break;case 536870912:f=268435456;break;default:f=0}f=(f&(l.suspendedLanes|x))!==0?0:f,f!==0&&f!==m.retryLane&&(m.retryLane=f,cn(e,f),Pr(l,e,f,-1))}return Oc(),l=cc(Error(n(421))),xa(e,t,x,l)}return f.data==="$?"?(t.flags|=128,t.child=e.child,t=zm.bind(null,e),f._reactRetry=t,null):(e=m.treeContext,sr=Cn(f.nextSibling),nr=t,it=!0,Cr=null,e!==null&&(pr[gr++]=an,pr[gr++]=ln,pr[gr++]=gs,an=e.id,ln=e.overflow,gs=t),t=pc(t,l.children),t.flags|=4096,t)}function Xd(e,t,s){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),ql(e.return,t,s)}function gc(e,t,s,l,f){var m=e.memoizedState;m===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:s,tailMode:f}:(m.isBackwards=t,m.rendering=null,m.renderingStartTime=0,m.last=l,m.tail=s,m.tailMode=f)}function Zd(e,t,s){var l=t.pendingProps,f=l.revealOrder,m=l.tail;if(Vt(e,t,l.children,s),l=at.current,(l&2)!==0)l=l&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Xd(e,s,t);else if(e.tag===19)Xd(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(Xe(at,l),(t.mode&1)===0)t.memoizedState=null;else switch(f){case"forwards":for(s=t.child,f=null;s!==null;)e=s.alternate,e!==null&&ha(e)===null&&(f=s),s=s.sibling;s=f,s===null?(f=t.child,t.child=null):(f=s.sibling,s.sibling=null),gc(t,!1,f,s,m);break;case"backwards":for(s=null,f=t.child,t.child=null;f!==null;){if(e=f.alternate,e!==null&&ha(e)===null){t.child=f;break}e=f.sibling,f.sibling=s,s=f,f=e}gc(t,!0,s,null,m);break;case"together":gc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function wa(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function dn(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),bs|=t.lanes,(s&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(n(153));if(t.child!==null){for(e=t.child,s=Fn(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=Fn(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function Cm(e,t,s){switch(t.tag){case 3:Gd(t),to();break;case 5:fd(t);break;case 1:Jt(t.type)&&ra(t);break;case 4:Gl(t,t.stateNode.containerInfo);break;case 10:var l=t.type._context,f=t.memoizedProps.value;Xe(la,l._currentValue),l._currentValue=f;break;case 13:if(l=t.memoizedState,l!==null)return l.dehydrated!==null?(Xe(at,at.current&1),t.flags|=128,null):(s&t.child.childLanes)!==0?Yd(e,t,s):(Xe(at,at.current&1),e=dn(e,t,s),e!==null?e.sibling:null);Xe(at,at.current&1);break;case 19:if(l=(s&t.childLanes)!==0,(e.flags&128)!==0){if(l)return Zd(e,t,s);t.flags|=128}if(f=t.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),Xe(at,at.current),l)break;return null;case 22:case 23:return t.lanes=0,qd(e,t,s)}return dn(e,t,s)}var eh,vc,th,rh;eh=function(e,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}},vc=function(){},th=function(e,t,s,l){var f=e.memoizedProps;if(f!==l){e=t.stateNode,xs(Hr.current);var m=null;switch(s){case"input":f=Xr(e,f),l=Xr(e,l),m=[];break;case"select":f=ue({},f,{value:void 0}),l=ue({},l,{value:void 0}),m=[];break;case"textarea":f=wn(e,f),l=wn(e,l),m=[];break;default:typeof f.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=Zi)}Zr(s,l);var x;s=null;for(V in f)if(!l.hasOwnProperty(V)&&f.hasOwnProperty(V)&&f[V]!=null)if(V==="style"){var N=f[V];for(x in N)N.hasOwnProperty(x)&&(s||(s={}),s[x]="")}else V!=="dangerouslySetInnerHTML"&&V!=="children"&&V!=="suppressContentEditableWarning"&&V!=="suppressHydrationWarning"&&V!=="autoFocus"&&(a.hasOwnProperty(V)?m||(m=[]):(m=m||[]).push(V,null));for(V in l){var I=l[V];if(N=f?.[V],l.hasOwnProperty(V)&&I!==N&&(I!=null||N!=null))if(V==="style")if(N){for(x in N)!N.hasOwnProperty(x)||I&&I.hasOwnProperty(x)||(s||(s={}),s[x]="");for(x in I)I.hasOwnProperty(x)&&N[x]!==I[x]&&(s||(s={}),s[x]=I[x])}else s||(m||(m=[]),m.push(V,s)),s=I;else V==="dangerouslySetInnerHTML"?(I=I?I.__html:void 0,N=N?N.__html:void 0,I!=null&&N!==I&&(m=m||[]).push(V,I)):V==="children"?typeof I!="string"&&typeof I!="number"||(m=m||[]).push(V,""+I):V!=="suppressContentEditableWarning"&&V!=="suppressHydrationWarning"&&(a.hasOwnProperty(V)?(I!=null&&V==="onScroll"&&tt("scroll",e),m||N===I||(m=[])):(m=m||[]).push(V,I))}s&&(m=m||[]).push("style",s);var V=m;(t.updateQueue=V)&&(t.flags|=4)}},rh=function(e,t,s,l){s!==l&&(t.flags|=4)};function ci(e,t){if(!it)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function At(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,l=0;if(t)for(var f=e.child;f!==null;)s|=f.lanes|f.childLanes,l|=f.subtreeFlags&14680064,l|=f.flags&14680064,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)s|=f.lanes|f.childLanes,l|=f.subtreeFlags,l|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=l,e.childLanes=s,t}function Rm(e,t,s){var l=t.pendingProps;switch(Ul(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(t),null;case 1:return Jt(t.type)&&ta(),At(t),null;case 3:return l=t.stateNode,oo(),rt(Kt),rt(Pt),Xl(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(ia(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Cr!==null&&(Tc(Cr),Cr=null))),vc(e,t),At(t),null;case 5:Ql(t);var f=xs(si.current);if(s=t.type,e!==null&&t.stateNode!=null)th(e,t,s,l,f),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!l){if(t.stateNode===null)throw Error(n(166));return At(t),null}if(e=xs(Hr.current),ia(t)){l=t.stateNode,s=t.type;var m=t.memoizedProps;switch(l[Br]=t,l[Zo]=m,e=(t.mode&1)!==0,s){case"dialog":tt("cancel",l),tt("close",l);break;case"iframe":case"object":case"embed":tt("load",l);break;case"video":case"audio":for(f=0;f<Qo.length;f++)tt(Qo[f],l);break;case"source":tt("error",l);break;case"img":case"image":case"link":tt("error",l),tt("load",l);break;case"details":tt("toggle",l);break;case"input":Zt(l,m),tt("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!m.multiple},tt("invalid",l);break;case"textarea":ji(l,m),tt("invalid",l)}Zr(s,m),f=null;for(var x in m)if(m.hasOwnProperty(x)){var N=m[x];x==="children"?typeof N=="string"?l.textContent!==N&&(m.suppressHydrationWarning!==!0&&Xi(l.textContent,N,e),f=["children",N]):typeof N=="number"&&l.textContent!==""+N&&(m.suppressHydrationWarning!==!0&&Xi(l.textContent,N,e),f=["children",""+N]):a.hasOwnProperty(x)&&N!=null&&x==="onScroll"&&tt("scroll",l)}switch(s){case"input":$t(l),ir(l,m,!0);break;case"textarea":$t(l),Io(l);break;case"select":case"option":break;default:typeof m.onClick=="function"&&(l.onclick=Zi)}l=f,t.updateQueue=l,l!==null&&(t.flags|=4)}else{x=f.nodeType===9?f:f.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Po(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=x.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=x.createElement(s,{is:l.is}):(e=x.createElement(s),s==="select"&&(x=e,l.multiple?x.multiple=!0:l.size&&(x.size=l.size))):e=x.createElementNS(e,s),e[Br]=t,e[Zo]=l,eh(e,t,!1,!1),t.stateNode=e;e:{switch(x=Be(s,l),s){case"dialog":tt("cancel",e),tt("close",e),f=l;break;case"iframe":case"object":case"embed":tt("load",e),f=l;break;case"video":case"audio":for(f=0;f<Qo.length;f++)tt(Qo[f],e);f=l;break;case"source":tt("error",e),f=l;break;case"img":case"image":case"link":tt("error",e),tt("load",e),f=l;break;case"details":tt("toggle",e),f=l;break;case"input":Zt(e,l),f=Xr(e,l),tt("invalid",e);break;case"option":f=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},f=ue({},l,{value:void 0}),tt("invalid",e);break;case"textarea":ji(e,l),f=wn(e,l),tt("invalid",e);break;default:f=l}Zr(s,f),N=f;for(m in N)if(N.hasOwnProperty(m)){var I=N[m];m==="style"?lr(e,I):m==="dangerouslySetInnerHTML"?(I=I?I.__html:void 0,I!=null&&Sr(e,I)):m==="children"?typeof I=="string"?(s!=="textarea"||I!=="")&&_r(e,I):typeof I=="number"&&_r(e,""+I):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(a.hasOwnProperty(m)?I!=null&&m==="onScroll"&&tt("scroll",e):I!=null&&B(e,m,I,x))}switch(s){case"input":$t(e),ir(e,l,!1);break;case"textarea":$t(e),Io(e);break;case"option":l.value!=null&&e.setAttribute("value",""+ze(l.value));break;case"select":e.multiple=!!l.multiple,m=l.value,m!=null?Tt(e,!!l.multiple,m,!1):l.defaultValue!=null&&Tt(e,!!l.multiple,l.defaultValue,!0);break;default:typeof f.onClick=="function"&&(e.onclick=Zi)}switch(s){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return At(t),null;case 6:if(e&&t.stateNode!=null)rh(e,t,e.memoizedProps,l);else{if(typeof l!="string"&&t.stateNode===null)throw Error(n(166));if(s=xs(si.current),xs(Hr.current),ia(t)){if(l=t.stateNode,s=t.memoizedProps,l[Br]=t,(m=l.nodeValue!==s)&&(e=nr,e!==null))switch(e.tag){case 3:Xi(l.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Xi(l.nodeValue,s,(e.mode&1)!==0)}m&&(t.flags|=4)}else l=(s.nodeType===9?s:s.ownerDocument).createTextNode(l),l[Br]=t,t.stateNode=l}return At(t),null;case 13:if(rt(at),l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(it&&sr!==null&&(t.mode&1)!==0&&(t.flags&128)===0)od(),to(),t.flags|=98560,m=!1;else if(m=ia(t),l!==null&&l.dehydrated!==null){if(e===null){if(!m)throw Error(n(318));if(m=t.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[Br]=t}else to(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;At(t),m=!1}else Cr!==null&&(Tc(Cr),Cr=null),m=!0;if(!m)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=s,t):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(at.current&1)!==0?vt===0&&(vt=3):Oc())),t.updateQueue!==null&&(t.flags|=4),At(t),null);case 4:return oo(),vc(e,t),e===null&&Yo(t.stateNode.containerInfo),At(t),null;case 10:return Hl(t.type._context),At(t),null;case 17:return Jt(t.type)&&ta(),At(t),null;case 19:if(rt(at),m=t.memoizedState,m===null)return At(t),null;if(l=(t.flags&128)!==0,x=m.rendering,x===null)if(l)ci(m,!1);else{if(vt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(x=ha(e),x!==null){for(t.flags|=128,ci(m,!1),l=x.updateQueue,l!==null&&(t.updateQueue=l,t.flags|=4),t.subtreeFlags=0,l=s,s=t.child;s!==null;)m=s,e=l,m.flags&=14680066,x=m.alternate,x===null?(m.childLanes=0,m.lanes=e,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=x.childLanes,m.lanes=x.lanes,m.child=x.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=x.memoizedProps,m.memoizedState=x.memoizedState,m.updateQueue=x.updateQueue,m.type=x.type,e=x.dependencies,m.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Xe(at,at.current&1|2),t.child}e=e.sibling}m.tail!==null&&nt()>co&&(t.flags|=128,l=!0,ci(m,!1),t.lanes=4194304)}else{if(!l)if(e=ha(x),e!==null){if(t.flags|=128,l=!0,s=e.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),ci(m,!0),m.tail===null&&m.tailMode==="hidden"&&!x.alternate&&!it)return At(t),null}else 2*nt()-m.renderingStartTime>co&&s!==1073741824&&(t.flags|=128,l=!0,ci(m,!1),t.lanes=4194304);m.isBackwards?(x.sibling=t.child,t.child=x):(s=m.last,s!==null?s.sibling=x:t.child=x,m.last=x)}return m.tail!==null?(t=m.tail,m.rendering=t,m.tail=t.sibling,m.renderingStartTime=nt(),t.sibling=null,s=at.current,Xe(at,l?s&1|2:s&1),t):(At(t),null);case 22:case 23:return Rc(),l=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(t.flags|=8192),l&&(t.mode&1)!==0?(or&1073741824)!==0&&(At(t),t.subtreeFlags&6&&(t.flags|=8192)):At(t),null;case 24:return null;case 25:return null}throw Error(n(156,t.tag))}function Om(e,t){switch(Ul(t),t.tag){case 1:return Jt(t.type)&&ta(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return oo(),rt(Kt),rt(Pt),Xl(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return Ql(t),null;case 13:if(rt(at),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(n(340));to()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return rt(at),null;case 4:return oo(),null;case 10:return Hl(t.type._context),null;case 22:case 23:return Rc(),null;case 24:return null;default:return null}}var ba=!1,Lt=!1,Im=typeof WeakSet=="function"?WeakSet:Set,fe=null;function ao(e,t){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(l){ut(e,t,l)}else s.current=null}function yc(e,t,s){try{s()}catch(l){ut(e,t,l)}}var nh=!1;function Pm(e,t){if(Rl=as,e=Au(),Sl(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var l=s.getSelection&&s.getSelection();if(l&&l.rangeCount!==0){s=l.anchorNode;var f=l.anchorOffset,m=l.focusNode;l=l.focusOffset;try{s.nodeType,m.nodeType}catch{s=null;break e}var x=0,N=-1,I=-1,V=0,ee=0,re=e,X=null;t:for(;;){for(var he;re!==s||f!==0&&re.nodeType!==3||(N=x+f),re!==m||l!==0&&re.nodeType!==3||(I=x+l),re.nodeType===3&&(x+=re.nodeValue.length),(he=re.firstChild)!==null;)X=re,re=he;for(;;){if(re===e)break t;if(X===s&&++V===f&&(N=x),X===m&&++ee===l&&(I=x),(he=re.nextSibling)!==null)break;re=X,X=re.parentNode}re=he}s=N===-1||I===-1?null:{start:N,end:I}}else s=null}s=s||{start:0,end:0}}else s=null;for(Ol={focusedElem:e,selectionRange:s},as=!1,fe=t;fe!==null;)if(t=fe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,fe=e;else for(;fe!==null;){t=fe;try{var ge=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(ge!==null){var ve=ge.memoizedProps,ht=ge.memoizedState,U=t.stateNode,D=U.getSnapshotBeforeUpdate(t.elementType===t.type?ve:Rr(t.type,ve),ht);U.__reactInternalSnapshotBeforeUpdate=D}break;case 3:var F=t.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(se){ut(t,t.return,se)}if(e=t.sibling,e!==null){e.return=t.return,fe=e;break}fe=t.return}return ge=nh,nh=!1,ge}function ui(e,t,s){var l=t.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var f=l=l.next;do{if((f.tag&e)===e){var m=f.destroy;f.destroy=void 0,m!==void 0&&yc(t,s,m)}f=f.next}while(f!==l)}}function Sa(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&e)===e){var l=s.create;s.destroy=l()}s=s.next}while(s!==t)}}function xc(e){var t=e.ref;if(t!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof t=="function"?t(e):t.current=e}}function sh(e){var t=e.alternate;t!==null&&(e.alternate=null,sh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Br],delete t[Zo],delete t[Al],delete t[pm],delete t[gm])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function oh(e){return e.tag===5||e.tag===3||e.tag===4}function ih(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||oh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wc(e,t,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(e,s)):(t=s,t.appendChild(e)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=Zi));else if(l!==4&&(e=e.child,e!==null))for(wc(e,t,s),e=e.sibling;e!==null;)wc(e,t,s),e=e.sibling}function bc(e,t,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(bc(e,t,s),e=e.sibling;e!==null;)bc(e,t,s),e=e.sibling}var Ct=null,Or=!1;function An(e,t,s){for(s=s.child;s!==null;)ah(e,t,s),s=s.sibling}function ah(e,t,s){if(Ft&&typeof Ft.onCommitFiberUnmount=="function")try{Ft.onCommitFiberUnmount(_t,s)}catch{}switch(s.tag){case 5:Lt||ao(s,t);case 6:var l=Ct,f=Or;Ct=null,An(e,t,s),Ct=l,Or=f,Ct!==null&&(Or?(e=Ct,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):Ct.removeChild(s.stateNode));break;case 18:Ct!==null&&(Or?(e=Ct,s=s.stateNode,e.nodeType===8?Dl(e.parentNode,s):e.nodeType===1&&Dl(e,s),Pe(e)):Dl(Ct,s.stateNode));break;case 4:l=Ct,f=Or,Ct=s.stateNode.containerInfo,Or=!0,An(e,t,s),Ct=l,Or=f;break;case 0:case 11:case 14:case 15:if(!Lt&&(l=s.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){f=l=l.next;do{var m=f,x=m.destroy;m=m.tag,x!==void 0&&((m&2)!==0||(m&4)!==0)&&yc(s,t,x),f=f.next}while(f!==l)}An(e,t,s);break;case 1:if(!Lt&&(ao(s,t),l=s.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=s.memoizedProps,l.state=s.memoizedState,l.componentWillUnmount()}catch(N){ut(s,t,N)}An(e,t,s);break;case 21:An(e,t,s);break;case 22:s.mode&1?(Lt=(l=Lt)||s.memoizedState!==null,An(e,t,s),Lt=l):An(e,t,s);break;default:An(e,t,s)}}function lh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new Im),t.forEach(function(l){var f=Vm.bind(null,e,l);s.has(l)||(s.add(l),l.then(f,f))})}}function Ir(e,t){var s=t.deletions;if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];try{var m=e,x=t,N=x;e:for(;N!==null;){switch(N.tag){case 5:Ct=N.stateNode,Or=!1;break e;case 3:Ct=N.stateNode.containerInfo,Or=!0;break e;case 4:Ct=N.stateNode.containerInfo,Or=!0;break e}N=N.return}if(Ct===null)throw Error(n(160));ah(m,x,f),Ct=null,Or=!1;var I=f.alternate;I!==null&&(I.return=null),f.return=null}catch(V){ut(f,t,V)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ch(t,e),t=t.sibling}function ch(e,t){var s=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ir(t,e),Kr(e),l&4){try{ui(3,e,e.return),Sa(3,e)}catch(ve){ut(e,e.return,ve)}try{ui(5,e,e.return)}catch(ve){ut(e,e.return,ve)}}break;case 1:Ir(t,e),Kr(e),l&512&&s!==null&&ao(s,s.return);break;case 5:if(Ir(t,e),Kr(e),l&512&&s!==null&&ao(s,s.return),e.flags&32){var f=e.stateNode;try{_r(f,"")}catch(ve){ut(e,e.return,ve)}}if(l&4&&(f=e.stateNode,f!=null)){var m=e.memoizedProps,x=s!==null?s.memoizedProps:m,N=e.type,I=e.updateQueue;if(e.updateQueue=null,I!==null)try{N==="input"&&m.type==="radio"&&m.name!=null&&xn(f,m),Be(N,x);var V=Be(N,m);for(x=0;x<I.length;x+=2){var ee=I[x],re=I[x+1];ee==="style"?lr(f,re):ee==="dangerouslySetInnerHTML"?Sr(f,re):ee==="children"?_r(f,re):B(f,ee,re,V)}switch(N){case"input":bt(f,m);break;case"textarea":Oo(f,m);break;case"select":var X=f._wrapperState.wasMultiple;f._wrapperState.wasMultiple=!!m.multiple;var he=m.value;he!=null?Tt(f,!!m.multiple,he,!1):X!==!!m.multiple&&(m.defaultValue!=null?Tt(f,!!m.multiple,m.defaultValue,!0):Tt(f,!!m.multiple,m.multiple?[]:"",!1))}f[Zo]=m}catch(ve){ut(e,e.return,ve)}}break;case 6:if(Ir(t,e),Kr(e),l&4){if(e.stateNode===null)throw Error(n(162));f=e.stateNode,m=e.memoizedProps;try{f.nodeValue=m}catch(ve){ut(e,e.return,ve)}}break;case 3:if(Ir(t,e),Kr(e),l&4&&s!==null&&s.memoizedState.isDehydrated)try{Pe(t.containerInfo)}catch(ve){ut(e,e.return,ve)}break;case 4:Ir(t,e),Kr(e);break;case 13:Ir(t,e),Kr(e),f=e.child,f.flags&8192&&(m=f.memoizedState!==null,f.stateNode.isHidden=m,!m||f.alternate!==null&&f.alternate.memoizedState!==null||(Ec=nt())),l&4&&lh(e);break;case 22:if(ee=s!==null&&s.memoizedState!==null,e.mode&1?(Lt=(V=Lt)||ee,Ir(t,e),Lt=V):Ir(t,e),Kr(e),l&8192){if(V=e.memoizedState!==null,(e.stateNode.isHidden=V)&&!ee&&(e.mode&1)!==0)for(fe=e,ee=e.child;ee!==null;){for(re=fe=ee;fe!==null;){switch(X=fe,he=X.child,X.tag){case 0:case 11:case 14:case 15:ui(4,X,X.return);break;case 1:ao(X,X.return);var ge=X.stateNode;if(typeof ge.componentWillUnmount=="function"){l=X,s=X.return;try{t=l,ge.props=t.memoizedProps,ge.state=t.memoizedState,ge.componentWillUnmount()}catch(ve){ut(l,s,ve)}}break;case 5:ao(X,X.return);break;case 22:if(X.memoizedState!==null){hh(re);continue}}he!==null?(he.return=X,fe=he):hh(re)}ee=ee.sibling}e:for(ee=null,re=e;;){if(re.tag===5){if(ee===null){ee=re;try{f=re.stateNode,V?(m=f.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none"):(N=re.stateNode,I=re.memoizedProps.style,x=I!=null&&I.hasOwnProperty("display")?I.display:null,N.style.display=Re("display",x))}catch(ve){ut(e,e.return,ve)}}}else if(re.tag===6){if(ee===null)try{re.stateNode.nodeValue=V?"":re.memoizedProps}catch(ve){ut(e,e.return,ve)}}else if((re.tag!==22&&re.tag!==23||re.memoizedState===null||re===e)&&re.child!==null){re.child.return=re,re=re.child;continue}if(re===e)break e;for(;re.sibling===null;){if(re.return===null||re.return===e)break e;ee===re&&(ee=null),re=re.return}ee===re&&(ee=null),re.sibling.return=re.return,re=re.sibling}}break;case 19:Ir(t,e),Kr(e),l&4&&lh(e);break;case 21:break;default:Ir(t,e),Kr(e)}}function Kr(e){var t=e.flags;if(t&2){try{e:{for(var s=e.return;s!==null;){if(oh(s)){var l=s;break e}s=s.return}throw Error(n(160))}switch(l.tag){case 5:var f=l.stateNode;l.flags&32&&(_r(f,""),l.flags&=-33);var m=ih(e);bc(e,m,f);break;case 3:case 4:var x=l.stateNode.containerInfo,N=ih(e);wc(e,N,x);break;default:throw Error(n(161))}}catch(I){ut(e,e.return,I)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Dm(e,t,s){fe=e,uh(e)}function uh(e,t,s){for(var l=(e.mode&1)!==0;fe!==null;){var f=fe,m=f.child;if(f.tag===22&&l){var x=f.memoizedState!==null||ba;if(!x){var N=f.alternate,I=N!==null&&N.memoizedState!==null||Lt;N=ba;var V=Lt;if(ba=x,(Lt=I)&&!V)for(fe=f;fe!==null;)x=fe,I=x.child,x.tag===22&&x.memoizedState!==null?fh(f):I!==null?(I.return=x,fe=I):fh(f);for(;m!==null;)fe=m,uh(m),m=m.sibling;fe=f,ba=N,Lt=V}dh(e)}else(f.subtreeFlags&8772)!==0&&m!==null?(m.return=f,fe=m):dh(e)}}function dh(e){for(;fe!==null;){var t=fe;if((t.flags&8772)!==0){var s=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Lt||Sa(5,t);break;case 1:var l=t.stateNode;if(t.flags&4&&!Lt)if(s===null)l.componentDidMount();else{var f=t.elementType===t.type?s.memoizedProps:Rr(t.type,s.memoizedProps);l.componentDidUpdate(f,s.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var m=t.updateQueue;m!==null&&hd(t,m,l);break;case 3:var x=t.updateQueue;if(x!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}hd(t,x,s)}break;case 5:var N=t.stateNode;if(s===null&&t.flags&4){s=N;var I=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":I.autoFocus&&s.focus();break;case"img":I.src&&(s.src=I.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var V=t.alternate;if(V!==null){var ee=V.memoizedState;if(ee!==null){var re=ee.dehydrated;re!==null&&Pe(re)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Lt||t.flags&512&&xc(t)}catch(X){ut(t,t.return,X)}}if(t===e){fe=null;break}if(s=t.sibling,s!==null){s.return=t.return,fe=s;break}fe=t.return}}function hh(e){for(;fe!==null;){var t=fe;if(t===e){fe=null;break}var s=t.sibling;if(s!==null){s.return=t.return,fe=s;break}fe=t.return}}function fh(e){for(;fe!==null;){var t=fe;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{Sa(4,t)}catch(I){ut(t,s,I)}break;case 1:var l=t.stateNode;if(typeof l.componentDidMount=="function"){var f=t.return;try{l.componentDidMount()}catch(I){ut(t,f,I)}}var m=t.return;try{xc(t)}catch(I){ut(t,m,I)}break;case 5:var x=t.return;try{xc(t)}catch(I){ut(t,x,I)}}}catch(I){ut(t,t.return,I)}if(t===e){fe=null;break}var N=t.sibling;if(N!==null){N.return=t.return,fe=N;break}fe=t.return}}var Am=Math.ceil,_a=$.ReactCurrentDispatcher,Sc=$.ReactCurrentOwner,xr=$.ReactCurrentBatchConfig,Ve=0,kt=null,ft=null,Rt=0,or=0,lo=Rn(0),vt=0,di=null,bs=0,Ea=0,_c=0,hi=null,Qt=null,Ec=0,co=1/0,hn=null,ka=!1,kc=null,Ln=null,Na=!1,$n=null,ja=0,fi=0,Nc=null,Ta=-1,Ca=0;function Wt(){return(Ve&6)!==0?nt():Ta!==-1?Ta:Ta=nt()}function Mn(e){return(e.mode&1)===0?1:(Ve&2)!==0&&Rt!==0?Rt&-Rt:ym.transition!==null?(Ca===0&&(Ca=Fo()),Ca):(e=Ae,e!==0||(e=window.event,e=e===void 0?16:Mi(e.type)),e)}function Pr(e,t,s,l){if(50<fi)throw fi=0,Nc=null,Error(n(185));Zn(e,s,l),((Ve&2)===0||e!==kt)&&(e===kt&&((Ve&2)===0&&(Ea|=s),vt===4&&Un(e,Rt)),Yt(e,l),s===1&&Ve===0&&(t.mode&1)===0&&(co=nt()+500,na&&In()))}function Yt(e,t){var s=e.callbackNode;Pi(e,t);var l=cr(e,e===kt?Rt:0);if(l===0)s!==null&&Yn(s),e.callbackNode=null,e.callbackPriority=0;else if(t=l&-l,e.callbackPriority!==t){if(s!=null&&Yn(s),t===1)e.tag===0?vm(ph.bind(null,e)):ed(ph.bind(null,e)),fm(function(){(Ve&6)===0&&In()}),s=null;else{switch(es(l)){case 1:s=Mo;break;case 4:s=As;break;case 16:s=Ls;break;case 536870912:s=je;break;default:s=Ls}s=_h(s,mh.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function mh(e,t){if(Ta=-1,Ca=0,(Ve&6)!==0)throw Error(n(327));var s=e.callbackNode;if(uo()&&e.callbackNode!==s)return null;var l=cr(e,e===kt?Rt:0);if(l===0)return null;if((l&30)!==0||(l&e.expiredLanes)!==0||t)t=Ra(e,l);else{t=l;var f=Ve;Ve|=2;var m=vh();(kt!==e||Rt!==t)&&(hn=null,co=nt()+500,_s(e,t));do try{Mm();break}catch(N){gh(e,N)}while(!0);Bl(),_a.current=m,Ve=f,ft!==null?t=0:(kt=null,Rt=0,t=vt)}if(t!==0){if(t===2&&(f=Fr(e),f!==0&&(l=f,t=jc(e,f))),t===1)throw s=di,_s(e,0),Un(e,l),Yt(e,nt()),s;if(t===6)Un(e,l);else{if(f=e.current.alternate,(l&30)===0&&!Lm(f)&&(t=Ra(e,l),t===2&&(m=Fr(e),m!==0&&(l=m,t=jc(e,m))),t===1))throw s=di,_s(e,0),Un(e,l),Yt(e,nt()),s;switch(e.finishedWork=f,e.finishedLanes=l,t){case 0:case 1:throw Error(n(345));case 2:Es(e,Qt,hn);break;case 3:if(Un(e,l),(l&130023424)===l&&(t=Ec+500-nt(),10<t)){if(cr(e,0)!==0)break;if(f=e.suspendedLanes,(f&l)!==l){Wt(),e.pingedLanes|=e.suspendedLanes&f;break}e.timeoutHandle=Pl(Es.bind(null,e,Qt,hn),t);break}Es(e,Qt,hn);break;case 4:if(Un(e,l),(l&4194240)===l)break;for(t=e.eventTimes,f=-1;0<l;){var x=31-Oe(l);m=1<<x,x=t[x],x>f&&(f=x),l&=~m}if(l=f,l=nt()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*Am(l/1960))-l,10<l){e.timeoutHandle=Pl(Es.bind(null,e,Qt,hn),l);break}Es(e,Qt,hn);break;case 5:Es(e,Qt,hn);break;default:throw Error(n(329))}}}return Yt(e,nt()),e.callbackNode===s?mh.bind(null,e):null}function jc(e,t){var s=hi;return e.current.memoizedState.isDehydrated&&(_s(e,t).flags|=256),e=Ra(e,t),e!==2&&(t=Qt,Qt=s,t!==null&&Tc(t)),e}function Tc(e){Qt===null?Qt=e:Qt.push.apply(Qt,e)}function Lm(e){for(var t=e;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var l=0;l<s.length;l++){var f=s[l],m=f.getSnapshot;f=f.value;try{if(!Tr(m(),f))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Un(e,t){for(t&=~_c,t&=~Ea,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-Oe(t),l=1<<s;e[s]=-1,t&=~l}}function ph(e){if((Ve&6)!==0)throw Error(n(327));uo();var t=cr(e,0);if((t&1)===0)return Yt(e,nt()),null;var s=Ra(e,t);if(e.tag!==0&&s===2){var l=Fr(e);l!==0&&(t=l,s=jc(e,l))}if(s===1)throw s=di,_s(e,0),Un(e,t),Yt(e,nt()),s;if(s===6)throw Error(n(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Es(e,Qt,hn),Yt(e,nt()),null}function Cc(e,t){var s=Ve;Ve|=1;try{return e(t)}finally{Ve=s,Ve===0&&(co=nt()+500,na&&In())}}function Ss(e){$n!==null&&$n.tag===0&&(Ve&6)===0&&uo();var t=Ve;Ve|=1;var s=xr.transition,l=Ae;try{if(xr.transition=null,Ae=1,e)return e()}finally{Ae=l,xr.transition=s,Ve=t,(Ve&6)===0&&In()}}function Rc(){or=lo.current,rt(lo)}function _s(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,hm(s)),ft!==null)for(s=ft.return;s!==null;){var l=s;switch(Ul(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&ta();break;case 3:oo(),rt(Kt),rt(Pt),Xl();break;case 5:Ql(l);break;case 4:oo();break;case 13:rt(at);break;case 19:rt(at);break;case 10:Hl(l.type._context);break;case 22:case 23:Rc()}s=s.return}if(kt=e,ft=e=Fn(e.current,null),Rt=or=t,vt=0,di=null,_c=Ea=bs=0,Qt=hi=null,ys!==null){for(t=0;t<ys.length;t++)if(s=ys[t],l=s.interleaved,l!==null){s.interleaved=null;var f=l.next,m=s.pending;if(m!==null){var x=m.next;m.next=f,l.next=x}s.pending=l}ys=null}return e}function gh(e,t){do{var s=ft;try{if(Bl(),fa.current=va,ma){for(var l=lt.memoizedState;l!==null;){var f=l.queue;f!==null&&(f.pending=null),l=l.next}ma=!1}if(ws=0,Et=gt=lt=null,oi=!1,ii=0,Sc.current=null,s===null||s.return===null){vt=1,di=t,ft=null;break}e:{var m=e,x=s.return,N=s,I=t;if(t=Rt,N.flags|=32768,I!==null&&typeof I=="object"&&typeof I.then=="function"){var V=I,ee=N,re=ee.tag;if((ee.mode&1)===0&&(re===0||re===11||re===15)){var X=ee.alternate;X?(ee.updateQueue=X.updateQueue,ee.memoizedState=X.memoizedState,ee.lanes=X.lanes):(ee.updateQueue=null,ee.memoizedState=null)}var he=zd(x);if(he!==null){he.flags&=-257,Vd(he,x,N,m,t),he.mode&1&&Fd(m,V,t),t=he,I=V;var ge=t.updateQueue;if(ge===null){var ve=new Set;ve.add(I),t.updateQueue=ve}else ge.add(I);break e}else{if((t&1)===0){Fd(m,V,t),Oc();break e}I=Error(n(426))}}else if(it&&N.mode&1){var ht=zd(x);if(ht!==null){(ht.flags&65536)===0&&(ht.flags|=256),Vd(ht,x,N,m,t),Vl(io(I,N));break e}}m=I=io(I,N),vt!==4&&(vt=2),hi===null?hi=[m]:hi.push(m),m=x;do{switch(m.tag){case 3:m.flags|=65536,t&=-t,m.lanes|=t;var U=Md(m,I,t);dd(m,U);break e;case 1:N=I;var D=m.type,F=m.stateNode;if((m.flags&128)===0&&(typeof D.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(Ln===null||!Ln.has(F)))){m.flags|=65536,t&=-t,m.lanes|=t;var se=Ud(m,N,t);dd(m,se);break e}}m=m.return}while(m!==null)}xh(s)}catch(xe){t=xe,ft===s&&s!==null&&(ft=s=s.return);continue}break}while(!0)}function vh(){var e=_a.current;return _a.current=va,e===null?va:e}function Oc(){(vt===0||vt===3||vt===2)&&(vt=4),kt===null||(bs&268435455)===0&&(Ea&268435455)===0||Un(kt,Rt)}function Ra(e,t){var s=Ve;Ve|=2;var l=vh();(kt!==e||Rt!==t)&&(hn=null,_s(e,t));do try{$m();break}catch(f){gh(e,f)}while(!0);if(Bl(),Ve=s,_a.current=l,ft!==null)throw Error(n(261));return kt=null,Rt=0,vt}function $m(){for(;ft!==null;)yh(ft)}function Mm(){for(;ft!==null&&!tn();)yh(ft)}function yh(e){var t=Sh(e.alternate,e,or);e.memoizedProps=e.pendingProps,t===null?xh(e):ft=t,Sc.current=null}function xh(e){var t=e;do{var s=t.alternate;if(e=t.return,(t.flags&32768)===0){if(s=Rm(s,t,or),s!==null){ft=s;return}}else{if(s=Om(s,t),s!==null){s.flags&=32767,ft=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{vt=6,ft=null;return}}if(t=t.sibling,t!==null){ft=t;return}ft=t=e}while(t!==null);vt===0&&(vt=5)}function Es(e,t,s){var l=Ae,f=xr.transition;try{xr.transition=null,Ae=1,Um(e,t,s,l)}finally{xr.transition=f,Ae=l}return null}function Um(e,t,s,l){do uo();while($n!==null);if((Ve&6)!==0)throw Error(n(327));s=e.finishedWork;var f=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(n(177));e.callbackNode=null,e.callbackPriority=0;var m=s.lanes|s.childLanes;if(Di(e,m),e===kt&&(ft=kt=null,Rt=0),(s.subtreeFlags&2064)===0&&(s.flags&2064)===0||Na||(Na=!0,_h(Ls,function(){return uo(),null})),m=(s.flags&15990)!==0,(s.subtreeFlags&15990)!==0||m){m=xr.transition,xr.transition=null;var x=Ae;Ae=1;var N=Ve;Ve|=4,Sc.current=null,Pm(e,s),ch(s,e),om(Ol),as=!!Rl,Ol=Rl=null,e.current=s,Dm(s),Ds(),Ve=N,Ae=x,xr.transition=m}else e.current=s;if(Na&&(Na=!1,$n=e,ja=f),m=e.pendingLanes,m===0&&(Ln=null),Uo(s.stateNode),Yt(e,nt()),t!==null)for(l=e.onRecoverableError,s=0;s<t.length;s++)f=t[s],l(f.value,{componentStack:f.stack,digest:f.digest});if(ka)throw ka=!1,e=kc,kc=null,e;return(ja&1)!==0&&e.tag!==0&&uo(),m=e.pendingLanes,(m&1)!==0?e===Nc?fi++:(fi=0,Nc=e):fi=0,In(),null}function uo(){if($n!==null){var e=es(ja),t=xr.transition,s=Ae;try{if(xr.transition=null,Ae=16>e?16:e,$n===null)var l=!1;else{if(e=$n,$n=null,ja=0,(Ve&6)!==0)throw Error(n(331));var f=Ve;for(Ve|=4,fe=e.current;fe!==null;){var m=fe,x=m.child;if((fe.flags&16)!==0){var N=m.deletions;if(N!==null){for(var I=0;I<N.length;I++){var V=N[I];for(fe=V;fe!==null;){var ee=fe;switch(ee.tag){case 0:case 11:case 15:ui(8,ee,m)}var re=ee.child;if(re!==null)re.return=ee,fe=re;else for(;fe!==null;){ee=fe;var X=ee.sibling,he=ee.return;if(sh(ee),ee===V){fe=null;break}if(X!==null){X.return=he,fe=X;break}fe=he}}}var ge=m.alternate;if(ge!==null){var ve=ge.child;if(ve!==null){ge.child=null;do{var ht=ve.sibling;ve.sibling=null,ve=ht}while(ve!==null)}}fe=m}}if((m.subtreeFlags&2064)!==0&&x!==null)x.return=m,fe=x;else e:for(;fe!==null;){if(m=fe,(m.flags&2048)!==0)switch(m.tag){case 0:case 11:case 15:ui(9,m,m.return)}var U=m.sibling;if(U!==null){U.return=m.return,fe=U;break e}fe=m.return}}var D=e.current;for(fe=D;fe!==null;){x=fe;var F=x.child;if((x.subtreeFlags&2064)!==0&&F!==null)F.return=x,fe=F;else e:for(x=D;fe!==null;){if(N=fe,(N.flags&2048)!==0)try{switch(N.tag){case 0:case 11:case 15:Sa(9,N)}}catch(xe){ut(N,N.return,xe)}if(N===x){fe=null;break e}var se=N.sibling;if(se!==null){se.return=N.return,fe=se;break e}fe=N.return}}if(Ve=f,In(),Ft&&typeof Ft.onPostCommitFiberRoot=="function")try{Ft.onPostCommitFiberRoot(_t,e)}catch{}l=!0}return l}finally{Ae=s,xr.transition=t}}return!1}function wh(e,t,s){t=io(s,t),t=Md(e,t,1),e=Dn(e,t,1),t=Wt(),e!==null&&(Zn(e,1,t),Yt(e,t))}function ut(e,t,s){if(e.tag===3)wh(e,e,s);else for(;t!==null;){if(t.tag===3){wh(t,e,s);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Ln===null||!Ln.has(l))){e=io(s,e),e=Ud(t,e,1),t=Dn(t,e,1),e=Wt(),t!==null&&(Zn(t,1,e),Yt(t,e));break}}t=t.return}}function Fm(e,t,s){var l=e.pingCache;l!==null&&l.delete(t),t=Wt(),e.pingedLanes|=e.suspendedLanes&s,kt===e&&(Rt&s)===s&&(vt===4||vt===3&&(Rt&130023424)===Rt&&500>nt()-Ec?_s(e,0):_c|=s),Yt(e,t)}function bh(e,t){t===0&&((e.mode&1)===0?t=1:(t=Xn,Xn<<=1,(Xn&130023424)===0&&(Xn=4194304)));var s=Wt();e=cn(e,t),e!==null&&(Zn(e,t,s),Yt(e,s))}function zm(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),bh(e,s)}function Vm(e,t){var s=0;switch(e.tag){case 13:var l=e.stateNode,f=e.memoizedState;f!==null&&(s=f.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(n(314))}l!==null&&l.delete(t),bh(e,s)}var Sh;Sh=function(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps||Kt.current)Gt=!0;else{if((e.lanes&s)===0&&(t.flags&128)===0)return Gt=!1,Cm(e,t,s);Gt=(e.flags&131072)!==0}else Gt=!1,it&&(t.flags&1048576)!==0&&td(t,oa,t.index);switch(t.lanes=0,t.tag){case 2:var l=t.type;wa(e,t),e=t.pendingProps;var f=Xs(t,Pt.current);so(t,s),f=tc(null,t,l,e,f,s);var m=rc();return t.flags|=1,typeof f=="object"&&f!==null&&typeof f.render=="function"&&f.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Jt(l)?(m=!0,ra(t)):m=!1,t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,Jl(t),f.updater=ya,t.stateNode=f,f._reactInternals=t,lc(t,l,e,s),t=hc(null,t,l,!0,m,s)):(t.tag=0,it&&m&&Ml(t),Vt(null,t,f,s),t=t.child),t;case 16:l=t.elementType;e:{switch(wa(e,t),e=t.pendingProps,f=l._init,l=f(l._payload),t.type=l,f=t.tag=Bm(l),e=Rr(l,e),f){case 0:t=dc(null,t,l,e,s);break e;case 1:t=Jd(null,t,l,e,s);break e;case 11:t=Wd(null,t,l,e,s);break e;case 14:t=Bd(null,t,l,Rr(l.type,e),s);break e}throw Error(n(306,l,""))}return t;case 0:return l=t.type,f=t.pendingProps,f=t.elementType===l?f:Rr(l,f),dc(e,t,l,f,s);case 1:return l=t.type,f=t.pendingProps,f=t.elementType===l?f:Rr(l,f),Jd(e,t,l,f,s);case 3:e:{if(Gd(t),e===null)throw Error(n(387));l=t.pendingProps,m=t.memoizedState,f=m.element,ud(e,t),da(t,l,null,s);var x=t.memoizedState;if(l=x.element,m.isDehydrated)if(m={element:l,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},t.updateQueue.baseState=m,t.memoizedState=m,t.flags&256){f=io(Error(n(423)),t),t=Qd(e,t,l,s,f);break e}else if(l!==f){f=io(Error(n(424)),t),t=Qd(e,t,l,s,f);break e}else for(sr=Cn(t.stateNode.containerInfo.firstChild),nr=t,it=!0,Cr=null,s=ld(t,null,l,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(to(),l===f){t=dn(e,t,s);break e}Vt(e,t,l,s)}t=t.child}return t;case 5:return fd(t),e===null&&zl(t),l=t.type,f=t.pendingProps,m=e!==null?e.memoizedProps:null,x=f.children,Il(l,f)?x=null:m!==null&&Il(l,m)&&(t.flags|=32),Kd(e,t),Vt(e,t,x,s),t.child;case 6:return e===null&&zl(t),null;case 13:return Yd(e,t,s);case 4:return Gl(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=ro(t,null,l,s):Vt(e,t,l,s),t.child;case 11:return l=t.type,f=t.pendingProps,f=t.elementType===l?f:Rr(l,f),Wd(e,t,l,f,s);case 7:return Vt(e,t,t.pendingProps,s),t.child;case 8:return Vt(e,t,t.pendingProps.children,s),t.child;case 12:return Vt(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(l=t.type._context,f=t.pendingProps,m=t.memoizedProps,x=f.value,Xe(la,l._currentValue),l._currentValue=x,m!==null)if(Tr(m.value,x)){if(m.children===f.children&&!Kt.current){t=dn(e,t,s);break e}}else for(m=t.child,m!==null&&(m.return=t);m!==null;){var N=m.dependencies;if(N!==null){x=m.child;for(var I=N.firstContext;I!==null;){if(I.context===l){if(m.tag===1){I=un(-1,s&-s),I.tag=2;var V=m.updateQueue;if(V!==null){V=V.shared;var ee=V.pending;ee===null?I.next=I:(I.next=ee.next,ee.next=I),V.pending=I}}m.lanes|=s,I=m.alternate,I!==null&&(I.lanes|=s),ql(m.return,s,t),N.lanes|=s;break}I=I.next}}else if(m.tag===10)x=m.type===t.type?null:m.child;else if(m.tag===18){if(x=m.return,x===null)throw Error(n(341));x.lanes|=s,N=x.alternate,N!==null&&(N.lanes|=s),ql(x,s,t),x=m.sibling}else x=m.child;if(x!==null)x.return=m;else for(x=m;x!==null;){if(x===t){x=null;break}if(m=x.sibling,m!==null){m.return=x.return,x=m;break}x=x.return}m=x}Vt(e,t,f.children,s),t=t.child}return t;case 9:return f=t.type,l=t.pendingProps.children,so(t,s),f=vr(f),l=l(f),t.flags|=1,Vt(e,t,l,s),t.child;case 14:return l=t.type,f=Rr(l,t.pendingProps),f=Rr(l.type,f),Bd(e,t,l,f,s);case 15:return Hd(e,t,t.type,t.pendingProps,s);case 17:return l=t.type,f=t.pendingProps,f=t.elementType===l?f:Rr(l,f),wa(e,t),t.tag=1,Jt(l)?(e=!0,ra(t)):e=!1,so(t,s),Ld(t,l,f),lc(t,l,f,s),hc(null,t,l,!0,e,s);case 19:return Zd(e,t,s);case 22:return qd(e,t,s)}throw Error(n(156,t.tag))};function _h(e,t){return Ri(e,t)}function Wm(e,t,s,l){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wr(e,t,s,l){return new Wm(e,t,s,l)}function Ic(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Bm(e){if(typeof e=="function")return Ic(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Y)return 11;if(e===De)return 14}return 2}function Fn(e,t){var s=e.alternate;return s===null?(s=wr(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Oa(e,t,s,l,f,m){var x=2;if(l=e,typeof e=="function")Ic(e)&&(x=1);else if(typeof e=="string")x=5;else e:switch(e){case ne:return ks(s.children,f,m,t);case ae:x=8,f|=8;break;case O:return e=wr(12,s,t,f|2),e.elementType=O,e.lanes=m,e;case ce:return e=wr(13,s,t,f),e.elementType=ce,e.lanes=m,e;case ke:return e=wr(19,s,t,f),e.elementType=ke,e.lanes=m,e;case Fe:return Ia(s,f,m,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Z:x=10;break e;case q:x=9;break e;case Y:x=11;break e;case De:x=14;break e;case et:x=16,l=null;break e}throw Error(n(130,e==null?e:typeof e,""))}return t=wr(x,s,t,f),t.elementType=e,t.type=l,t.lanes=m,t}function ks(e,t,s,l){return e=wr(7,e,l,t),e.lanes=s,e}function Ia(e,t,s,l){return e=wr(22,e,l,t),e.elementType=Fe,e.lanes=s,e.stateNode={isHidden:!1},e}function Pc(e,t,s){return e=wr(6,e,null,t),e.lanes=s,e}function Dc(e,t,s){return t=wr(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Hm(e,t,s,l,f){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rn(0),this.expirationTimes=rn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rn(0),this.identifierPrefix=l,this.onRecoverableError=f,this.mutableSourceEagerHydrationData=null}function Ac(e,t,s,l,f,m,x,N,I){return e=new Hm(e,t,s,N,I),t===1?(t=1,m===!0&&(t|=8)):t=0,m=wr(3,null,null,t),e.current=m,m.stateNode=e,m.memoizedState={element:l,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jl(m),e}function qm(e,t,s){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:l==null?null:""+l,children:e,containerInfo:t,implementation:s}}function Eh(e){if(!e)return On;e=e._reactInternals;e:{if(Sn(e)!==e||e.tag!==1)throw Error(n(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Jt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(n(171))}if(e.tag===1){var s=e.type;if(Jt(s))return Xu(e,s,t)}return t}function kh(e,t,s,l,f,m,x,N,I){return e=Ac(s,l,!0,e,f,m,x,N,I),e.context=Eh(null),s=e.current,l=Wt(),f=Mn(s),m=un(l,f),m.callback=t??null,Dn(s,m,f),e.current.lanes=f,Zn(e,f,l),Yt(e,l),e}function Pa(e,t,s,l){var f=t.current,m=Wt(),x=Mn(f);return s=Eh(s),t.context===null?t.context=s:t.pendingContext=s,t=un(m,x),t.payload={element:e},l=l===void 0?null:l,l!==null&&(t.callback=l),e=Dn(f,t,x),e!==null&&(Pr(e,f,x,m),ua(e,f,x)),x}function Da(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Nh(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function Lc(e,t){Nh(e,t),(e=e.alternate)&&Nh(e,t)}function Km(){return null}var jh=typeof reportError=="function"?reportError:function(e){console.error(e)};function $c(e){this._internalRoot=e}Aa.prototype.render=$c.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(n(409));Pa(e,t,null,null)},Aa.prototype.unmount=$c.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ss(function(){Pa(null,e,null,null)}),t[sn]=null}};function Aa(e){this._internalRoot=e}Aa.prototype.unstable_scheduleHydration=function(e){if(e){var t=ts();e={blockedOn:null,target:e,priority:t};for(var s=0;s<tr.length&&t!==0&&t<tr[s].priority;s++);tr.splice(s,0,e),s===0&&os(e)}};function Mc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function La(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Th(){}function Jm(e,t,s,l,f){if(f){if(typeof l=="function"){var m=l;l=function(){var V=Da(x);m.call(V)}}var x=kh(t,l,e,0,null,!1,!1,"",Th);return e._reactRootContainer=x,e[sn]=x.current,Yo(e.nodeType===8?e.parentNode:e),Ss(),x}for(;f=e.lastChild;)e.removeChild(f);if(typeof l=="function"){var N=l;l=function(){var V=Da(I);N.call(V)}}var I=Ac(e,0,!1,null,null,!1,!1,"",Th);return e._reactRootContainer=I,e[sn]=I.current,Yo(e.nodeType===8?e.parentNode:e),Ss(function(){Pa(t,I,s,l)}),I}function $a(e,t,s,l,f){var m=s._reactRootContainer;if(m){var x=m;if(typeof f=="function"){var N=f;f=function(){var I=Da(x);N.call(I)}}Pa(t,x,e,f)}else x=Jm(s,t,e,f,l);return Da(x)}Ai=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=_n(t.pendingLanes);s!==0&&(zr(t,s|1),Yt(t,nt()),(Ve&6)===0&&(co=nt()+500,In()))}break;case 13:Ss(function(){var l=cn(e,1);if(l!==null){var f=Wt();Pr(l,e,1,f)}}),Lc(e,1)}},dr=function(e){if(e.tag===13){var t=cn(e,134217728);if(t!==null){var s=Wt();Pr(t,e,134217728,s)}Lc(e,134217728)}},Ms=function(e){if(e.tag===13){var t=Mn(e),s=cn(e,t);if(s!==null){var l=Wt();Pr(s,e,t,l)}Lc(e,t)}},ts=function(){return Ae},Li=function(e,t){var s=Ae;try{return Ae=e,t()}finally{Ae=s}},er=function(e,t,s){switch(t){case"input":if(bt(e,s),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var l=s[t];if(l!==e&&l.form===e.form){var f=ea(l);if(!f)throw Error(n(90));qn(l),bt(l,f)}}}break;case"textarea":Oo(e,s);break;case"select":t=s.value,t!=null&&Tt(e,!!s.multiple,t,!1)}},Ti=Cc,tl=Ss;var Gm={usingClientEntryPoint:!1,Events:[ei,Qs,ea,Do,Ao,Cc]},mi={findFiberByHostInstance:ms,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Qm={bundleType:mi.bundleType,version:mi.version,rendererPackageName:mi.rendererPackageName,rendererConfig:mi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ot(e),e===null?null:e.stateNode},findFiberByHostInstance:mi.findFiberByHostInstance||Km,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ma=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ma.isDisabled&&Ma.supportsFiber)try{_t=Ma.inject(Qm),Ft=Ma}catch{}}return Xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gm,Xt.createPortal=function(e,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mc(t))throw Error(n(200));return qm(e,t,null,s)},Xt.createRoot=function(e,t){if(!Mc(e))throw Error(n(299));var s=!1,l="",f=jh;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onRecoverableError!==void 0&&(f=t.onRecoverableError)),t=Ac(e,1,!1,null,null,s,!1,l,f),e[sn]=t.current,Yo(e.nodeType===8?e.parentNode:e),new $c(t)},Xt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(n(188)):(e=Object.keys(e).join(","),Error(n(268,e)));return e=Ot(t),e=e===null?null:e.stateNode,e},Xt.flushSync=function(e){return Ss(e)},Xt.hydrate=function(e,t,s){if(!La(t))throw Error(n(200));return $a(null,e,t,!0,s)},Xt.hydrateRoot=function(e,t,s){if(!Mc(e))throw Error(n(405));var l=s!=null&&s.hydratedSources||null,f=!1,m="",x=jh;if(s!=null&&(s.unstable_strictMode===!0&&(f=!0),s.identifierPrefix!==void 0&&(m=s.identifierPrefix),s.onRecoverableError!==void 0&&(x=s.onRecoverableError)),t=kh(t,null,e,1,s??null,f,!1,m,x),e[sn]=t.current,Yo(e),l)for(e=0;e<l.length;e++)s=l[e],f=s._getVersion,f=f(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,f]:t.mutableSourceEagerHydrationData.push(s,f);return new Aa(t)},Xt.render=function(e,t,s){if(!La(t))throw Error(n(200));return $a(null,e,t,!1,s)},Xt.unmountComponentAtNode=function(e){if(!La(e))throw Error(n(40));return e._reactRootContainer?(Ss(function(){$a(null,null,e,!1,function(){e._reactRootContainer=null,e[sn]=null})}),!0):!1},Xt.unstable_batchedUpdates=Cc,Xt.unstable_renderSubtreeIntoContainer=function(e,t,s,l){if(!La(s))throw Error(n(200));if(e==null||e._reactInternals===void 0)throw Error(n(38));return $a(e,t,s,!1,l)},Xt.version="18.3.1-next-f1338f8080-20240426",Xt}var Lh;function op(){if(Lh)return zc.exports;Lh=1;function u(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u)}catch(r){console.error(r)}}return u(),zc.exports=sp(),zc.exports}var $h;function ip(){if($h)return Ua;$h=1;var u=op();return Ua.createRoot=u.createRoot,Ua.hydrateRoot=u.hydrateRoot,Ua}var ap=ip();const lp=pu(ap);/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Mh="popstate";function cp(u={}){function r(o,a){let{pathname:h,search:d,hash:g}=o.location;return tu("",{pathname:h,search:d,hash:g},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(o,a){return typeof a=="string"?a:bi(a)}return dp(r,n,null,u)}function ct(u,r){if(u===!1||u===null||typeof u>"u")throw new Error(r)}function Qr(u,r){if(!u){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function up(){return Math.random().toString(36).substring(2,10)}function Uh(u,r){return{usr:u.state,key:u.key,idx:r}}function tu(u,r,n=null,o){return{pathname:typeof u=="string"?u:u.pathname,search:"",hash:"",...typeof r=="string"?No(r):r,state:n,key:r&&r.key||o||up()}}function bi({pathname:u="/",search:r="",hash:n=""}){return r&&r!=="?"&&(u+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(u+=n.charAt(0)==="#"?n:"#"+n),u}function No(u){let r={};if(u){let n=u.indexOf("#");n>=0&&(r.hash=u.substring(n),u=u.substring(0,n));let o=u.indexOf("?");o>=0&&(r.search=u.substring(o),u=u.substring(0,o)),u&&(r.pathname=u)}return r}function dp(u,r,n,o={}){let{window:a=document.defaultView,v5Compat:h=!1}=o,d=a.history,g="POP",v=null,w=S();w==null&&(w=0,d.replaceState({...d.state,idx:w},""));function S(){return(d.state||{idx:null}).idx}function _(){g="POP";let L=S(),Q=L==null?null:L-w;w=L,v&&v({action:g,location:M.location,delta:Q})}function T(L,Q){g="PUSH";let K=tu(M.location,L,Q);w=S()+1;let B=Uh(K,w),$=M.createHref(K);try{d.pushState(B,"",$)}catch(G){if(G instanceof DOMException&&G.name==="DataCloneError")throw G;a.location.assign($)}h&&v&&v({action:g,location:M.location,delta:1})}function R(L,Q){g="REPLACE";let K=tu(M.location,L,Q);w=S();let B=Uh(K,w),$=M.createHref(K);d.replaceState(B,"",$),h&&v&&v({action:g,location:M.location,delta:0})}function A(L){return hp(L)}let M={get action(){return g},get location(){return u(a,d)},listen(L){if(v)throw new Error("A history only accepts one active listener");return a.addEventListener(Mh,_),v=L,()=>{a.removeEventListener(Mh,_),v=null}},createHref(L){return r(a,L)},createURL:A,encodeLocation(L){let Q=A(L);return{pathname:Q.pathname,search:Q.search,hash:Q.hash}},push:T,replace:R,go(L){return d.go(L)}};return M}function hp(u,r=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),ct(n,"No window.location.(origin|href) available to create URL");let o=typeof u=="string"?u:bi(u);return o=o.replace(/ $/,"%20"),!r&&o.startsWith("//")&&(o=n+o),new URL(o,n)}function pf(u,r,n="/"){return fp(u,r,n,!1)}function fp(u,r,n,o){let a=typeof r=="string"?No(r):r,h=gn(a.pathname||"/",n);if(h==null)return null;let d=gf(u);mp(d);let g=null;for(let v=0;g==null&&v<d.length;++v){let w=kp(h);g=_p(d[v],w,o)}return g}function gf(u,r=[],n=[],o="",a=!1){let h=(d,g,v=a,w)=>{let S={relativePath:w===void 0?d.path||"":w,caseSensitive:d.caseSensitive===!0,childrenIndex:g,route:d};if(S.relativePath.startsWith("/")){if(!S.relativePath.startsWith(o)&&v)return;ct(S.relativePath.startsWith(o),`Absolute route path "${S.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),S.relativePath=S.relativePath.slice(o.length)}let _=pn([o,S.relativePath]),T=n.concat(S);d.children&&d.children.length>0&&(ct(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${_}".`),gf(d.children,r,T,_,v)),!(d.path==null&&!d.index)&&r.push({path:_,score:bp(_,d.index),routesMeta:T})};return u.forEach((d,g)=>{if(d.path===""||!d.path?.includes("?"))h(d,g);else for(let v of vf(d.path))h(d,g,!0,v)}),r}function vf(u){let r=u.split("/");if(r.length===0)return[];let[n,...o]=r,a=n.endsWith("?"),h=n.replace(/\?$/,"");if(o.length===0)return a?[h,""]:[h];let d=vf(o.join("/")),g=[];return g.push(...d.map(v=>v===""?h:[h,v].join("/"))),a&&g.push(...d),g.map(v=>u.startsWith("/")&&v===""?"/":v)}function mp(u){u.sort((r,n)=>r.score!==n.score?n.score-r.score:Sp(r.routesMeta.map(o=>o.childrenIndex),n.routesMeta.map(o=>o.childrenIndex)))}var pp=/^:[\w-]+$/,gp=3,vp=2,yp=1,xp=10,wp=-2,Fh=u=>u==="*";function bp(u,r){let n=u.split("/"),o=n.length;return n.some(Fh)&&(o+=wp),r&&(o+=vp),n.filter(a=>!Fh(a)).reduce((a,h)=>a+(pp.test(h)?gp:h===""?yp:xp),o)}function Sp(u,r){return u.length===r.length&&u.slice(0,-1).every((o,a)=>o===r[a])?u[u.length-1]-r[r.length-1]:0}function _p(u,r,n=!1){let{routesMeta:o}=u,a={},h="/",d=[];for(let g=0;g<o.length;++g){let v=o[g],w=g===o.length-1,S=h==="/"?r:r.slice(h.length)||"/",_=Ga({path:v.relativePath,caseSensitive:v.caseSensitive,end:w},S),T=v.route;if(!_&&w&&n&&!o[o.length-1].route.index&&(_=Ga({path:v.relativePath,caseSensitive:v.caseSensitive,end:!1},S)),!_)return null;Object.assign(a,_.params),d.push({params:a,pathname:pn([h,_.pathname]),pathnameBase:Cp(pn([h,_.pathnameBase])),route:T}),_.pathnameBase!=="/"&&(h=pn([h,_.pathnameBase]))}return d}function Ga(u,r){typeof u=="string"&&(u={path:u,caseSensitive:!1,end:!0});let[n,o]=Ep(u.path,u.caseSensitive,u.end),a=r.match(n);if(!a)return null;let h=a[0],d=h.replace(/(.)\/+$/,"$1"),g=a.slice(1);return{params:o.reduce((w,{paramName:S,isOptional:_},T)=>{if(S==="*"){let A=g[T]||"";d=h.slice(0,h.length-A.length).replace(/(.)\/+$/,"$1")}const R=g[T];return _&&!R?w[S]=void 0:w[S]=(R||"").replace(/%2F/g,"/"),w},{}),pathname:h,pathnameBase:d,pattern:u}}function Ep(u,r=!1,n=!0){Qr(u==="*"||!u.endsWith("*")||u.endsWith("/*"),`Route path "${u}" will be treated as if it were "${u.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${u.replace(/\*$/,"/*")}".`);let o=[],a="^"+u.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,g,v)=>(o.push({paramName:g,isOptional:v!=null}),v?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return u.endsWith("*")?(o.push({paramName:"*"}),a+=u==="*"||u==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":u!==""&&u!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,r?void 0:"i"),o]}function kp(u){try{return u.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return Qr(!1,`The URL path "${u}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),u}}function gn(u,r){if(r==="/")return u;if(!u.toLowerCase().startsWith(r.toLowerCase()))return null;let n=r.endsWith("/")?r.length-1:r.length,o=u.charAt(n);return o&&o!=="/"?null:u.slice(n)||"/"}function Np(u,r="/"){let{pathname:n,search:o="",hash:a=""}=typeof u=="string"?No(u):u;return{pathname:n?n.startsWith("/")?n:jp(n,r):r,search:Rp(o),hash:Op(a)}}function jp(u,r){let n=r.replace(/\/+$/,"").split("/");return u.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Bc(u,r,n,o){return`Cannot include a '${u}' character in a manually specified \`to.${r}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Tp(u){return u.filter((r,n)=>n===0||r.route.path&&r.route.path.length>0)}function yf(u){let r=Tp(u);return r.map((n,o)=>o===r.length-1?n.pathname:n.pathnameBase)}function xf(u,r,n,o=!1){let a;typeof u=="string"?a=No(u):(a={...u},ct(!a.pathname||!a.pathname.includes("?"),Bc("?","pathname","search",a)),ct(!a.pathname||!a.pathname.includes("#"),Bc("#","pathname","hash",a)),ct(!a.search||!a.search.includes("#"),Bc("#","search","hash",a)));let h=u===""||a.pathname==="",d=h?"/":a.pathname,g;if(d==null)g=n;else{let _=r.length-1;if(!o&&d.startsWith("..")){let T=d.split("/");for(;T[0]==="..";)T.shift(),_-=1;a.pathname=T.join("/")}g=_>=0?r[_]:"/"}let v=Np(a,g),w=d&&d!=="/"&&d.endsWith("/"),S=(h||d===".")&&n.endsWith("/");return!v.pathname.endsWith("/")&&(w||S)&&(v.pathname+="/"),v}var pn=u=>u.join("/").replace(/\/\/+/g,"/"),Cp=u=>u.replace(/\/+$/,"").replace(/^\/*/,"/"),Rp=u=>!u||u==="?"?"":u.startsWith("?")?u:"?"+u,Op=u=>!u||u==="#"?"":u.startsWith("#")?u:"#"+u;function Ip(u){return u!=null&&typeof u.status=="number"&&typeof u.statusText=="string"&&typeof u.internal=="boolean"&&"data"in u}var wf=["POST","PUT","PATCH","DELETE"];new Set(wf);var Pp=["GET",...wf];new Set(Pp);var jo=k.createContext(null);jo.displayName="DataRouter";var Xa=k.createContext(null);Xa.displayName="DataRouterState";k.createContext(!1);var bf=k.createContext({isTransitioning:!1});bf.displayName="ViewTransition";var Dp=k.createContext(new Map);Dp.displayName="Fetchers";var Ap=k.createContext(null);Ap.displayName="Await";var Yr=k.createContext(null);Yr.displayName="Navigation";var _i=k.createContext(null);_i.displayName="Location";var vn=k.createContext({outlet:null,matches:[],isDataRoute:!1});vn.displayName="Route";var vu=k.createContext(null);vu.displayName="RouteError";function Lp(u,{relative:r}={}){ct(Ei(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:o}=k.useContext(Yr),{hash:a,pathname:h,search:d}=ki(u,{relative:r}),g=h;return n!=="/"&&(g=h==="/"?n:pn([n,h])),o.createHref({pathname:g,search:d,hash:a})}function Ei(){return k.useContext(_i)!=null}function br(){return ct(Ei(),"useLocation() may be used only in the context of a <Router> component."),k.useContext(_i).location}var Sf="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function _f(u){k.useContext(Yr).static||k.useLayoutEffect(u)}function To(){let{isDataRoute:u}=k.useContext(vn);return u?Gp():$p()}function $p(){ct(Ei(),"useNavigate() may be used only in the context of a <Router> component.");let u=k.useContext(jo),{basename:r,navigator:n}=k.useContext(Yr),{matches:o}=k.useContext(vn),{pathname:a}=br(),h=JSON.stringify(yf(o)),d=k.useRef(!1);return _f(()=>{d.current=!0}),k.useCallback((v,w={})=>{if(Qr(d.current,Sf),!d.current)return;if(typeof v=="number"){n.go(v);return}let S=xf(v,JSON.parse(h),a,w.relative==="path");u==null&&r!=="/"&&(S.pathname=S.pathname==="/"?r:pn([r,S.pathname])),(w.replace?n.replace:n.push)(S,w.state,w)},[r,n,h,a,u])}k.createContext(null);function ki(u,{relative:r}={}){let{matches:n}=k.useContext(vn),{pathname:o}=br(),a=JSON.stringify(yf(n));return k.useMemo(()=>xf(u,JSON.parse(a),o,r==="path"),[u,a,o,r])}function Mp(u,r){return Ef(u,r)}function Ef(u,r,n,o,a){ct(Ei(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:h}=k.useContext(Yr),{matches:d}=k.useContext(vn),g=d[d.length-1],v=g?g.params:{},w=g?g.pathname:"/",S=g?g.pathnameBase:"/",_=g&&g.route;{let K=_&&_.path||"";kf(w,!_||K.endsWith("*")||K.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${w}" (under <Route path="${K}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${K}"> to <Route path="${K==="/"?"*":`${K}/*`}">.`)}let T=br(),R;if(r){let K=typeof r=="string"?No(r):r;ct(S==="/"||K.pathname?.startsWith(S),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${S}" but pathname "${K.pathname}" was given in the \`location\` prop.`),R=K}else R=T;let A=R.pathname||"/",M=A;if(S!=="/"){let K=S.replace(/^\//,"").split("/");M="/"+A.replace(/^\//,"").split("/").slice(K.length).join("/")}let L=pf(u,{pathname:M});Qr(_||L!=null,`No routes matched location "${R.pathname}${R.search}${R.hash}" `),Qr(L==null||L[L.length-1].route.element!==void 0||L[L.length-1].route.Component!==void 0||L[L.length-1].route.lazy!==void 0,`Matched leaf route at location "${R.pathname}${R.search}${R.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Q=Wp(L&&L.map(K=>Object.assign({},K,{params:Object.assign({},v,K.params),pathname:pn([S,h.encodeLocation?h.encodeLocation(K.pathname).pathname:K.pathname]),pathnameBase:K.pathnameBase==="/"?S:pn([S,h.encodeLocation?h.encodeLocation(K.pathnameBase).pathname:K.pathnameBase])})),d,n,o,a);return r&&Q?k.createElement(_i.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...R},navigationType:"POP"}},Q):Q}function Up(){let u=Jp(),r=Ip(u)?`${u.status} ${u.statusText}`:u instanceof Error?u.message:JSON.stringify(u),n=u instanceof Error?u.stack:null,o="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:o},h={padding:"2px 4px",backgroundColor:o},d=null;return console.error("Error handled by React Router default ErrorBoundary:",u),d=k.createElement(k.Fragment,null,k.createElement("p",null," Hey developer "),k.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",k.createElement("code",{style:h},"ErrorBoundary")," or"," ",k.createElement("code",{style:h},"errorElement")," prop on your route.")),k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},r),n?k.createElement("pre",{style:a},n):null,d)}var Fp=k.createElement(Up,null),zp=class extends k.Component{constructor(u){super(u),this.state={location:u.location,revalidation:u.revalidation,error:u.error}}static getDerivedStateFromError(u){return{error:u}}static getDerivedStateFromProps(u,r){return r.location!==u.location||r.revalidation!=="idle"&&u.revalidation==="idle"?{error:u.error,location:u.location,revalidation:u.revalidation}:{error:u.error!==void 0?u.error:r.error,location:r.location,revalidation:u.revalidation||r.revalidation}}componentDidCatch(u,r){this.props.unstable_onError?this.props.unstable_onError(u,r):console.error("React Router caught the following error during render",u)}render(){return this.state.error!==void 0?k.createElement(vn.Provider,{value:this.props.routeContext},k.createElement(vu.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Vp({routeContext:u,match:r,children:n}){let o=k.useContext(jo);return o&&o.static&&o.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=r.route.id),k.createElement(vn.Provider,{value:u},n)}function Wp(u,r=[],n=null,o=null,a=null){if(u==null){if(!n)return null;if(n.errors)u=n.matches;else if(r.length===0&&!n.initialized&&n.matches.length>0)u=n.matches;else return null}let h=u,d=n?.errors;if(d!=null){let w=h.findIndex(S=>S.route.id&&d?.[S.route.id]!==void 0);ct(w>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),h=h.slice(0,Math.min(h.length,w+1))}let g=!1,v=-1;if(n)for(let w=0;w<h.length;w++){let S=h[w];if((S.route.HydrateFallback||S.route.hydrateFallbackElement)&&(v=w),S.route.id){let{loaderData:_,errors:T}=n,R=S.route.loader&&!_.hasOwnProperty(S.route.id)&&(!T||T[S.route.id]===void 0);if(S.route.lazy||R){g=!0,v>=0?h=h.slice(0,v+1):h=[h[0]];break}}}return h.reduceRight((w,S,_)=>{let T,R=!1,A=null,M=null;n&&(T=d&&S.route.id?d[S.route.id]:void 0,A=S.route.errorElement||Fp,g&&(v<0&&_===0?(kf("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),R=!0,M=null):v===_&&(R=!0,M=S.route.hydrateFallbackElement||null)));let L=r.concat(h.slice(0,_+1)),Q=()=>{let K;return T?K=A:R?K=M:S.route.Component?K=k.createElement(S.route.Component,null):S.route.element?K=S.route.element:K=w,k.createElement(Vp,{match:S,routeContext:{outlet:w,matches:L,isDataRoute:n!=null},children:K})};return n&&(S.route.ErrorBoundary||S.route.errorElement||_===0)?k.createElement(zp,{location:n.location,revalidation:n.revalidation,component:A,error:T,children:Q(),routeContext:{outlet:null,matches:L,isDataRoute:!0},unstable_onError:o}):Q()},null)}function yu(u){return`${u} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Bp(u){let r=k.useContext(jo);return ct(r,yu(u)),r}function Hp(u){let r=k.useContext(Xa);return ct(r,yu(u)),r}function qp(u){let r=k.useContext(vn);return ct(r,yu(u)),r}function xu(u){let r=qp(u),n=r.matches[r.matches.length-1];return ct(n.route.id,`${u} can only be used on routes that contain a unique "id"`),n.route.id}function Kp(){return xu("useRouteId")}function Jp(){let u=k.useContext(vu),r=Hp("useRouteError"),n=xu("useRouteError");return u!==void 0?u:r.errors?.[n]}function Gp(){let{router:u}=Bp("useNavigate"),r=xu("useNavigate"),n=k.useRef(!1);return _f(()=>{n.current=!0}),k.useCallback(async(a,h={})=>{Qr(n.current,Sf),n.current&&(typeof a=="number"?u.navigate(a):await u.navigate(a,{fromRouteId:r,...h}))},[u,r])}var zh={};function kf(u,r,n){!r&&!zh[u]&&(zh[u]=!0,Qr(!1,n))}k.memo(Qp);function Qp({routes:u,future:r,state:n,unstable_onError:o}){return Ef(u,void 0,n,o,r)}function So(u){ct(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Yp({basename:u="/",children:r=null,location:n,navigationType:o="POP",navigator:a,static:h=!1}){ct(!Ei(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=u.replace(/^\/*/,"/"),g=k.useMemo(()=>({basename:d,navigator:a,static:h,future:{}}),[d,a,h]);typeof n=="string"&&(n=No(n));let{pathname:v="/",search:w="",hash:S="",state:_=null,key:T="default"}=n,R=k.useMemo(()=>{let A=gn(v,d);return A==null?null:{location:{pathname:A,search:w,hash:S,state:_,key:T},navigationType:o}},[d,v,w,S,_,T,o]);return Qr(R!=null,`<Router basename="${d}"> is not able to match the URL "${v}${w}${S}" because it does not start with the basename, so the <Router> won't render anything.`),R==null?null:k.createElement(Yr.Provider,{value:g},k.createElement(_i.Provider,{children:r,value:R}))}function Xp({children:u,location:r}){return Mp(ru(u),r)}function ru(u,r=[]){let n=[];return k.Children.forEach(u,(o,a)=>{if(!k.isValidElement(o))return;let h=[...r,a];if(o.type===k.Fragment){n.push.apply(n,ru(o.props.children,h));return}ct(o.type===So,`[${typeof o.type=="string"?o.type:o.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ct(!o.props.index||!o.props.children,"An index route cannot have child routes.");let d={id:o.props.id||h.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,hydrateFallbackElement:o.props.hydrateFallbackElement,HydrateFallback:o.props.HydrateFallback,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.hasErrorBoundary===!0||o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(d.children=ru(o.props.children,h)),n.push(d)}),n}var qa="get",Ka="application/x-www-form-urlencoded";function Za(u){return u!=null&&typeof u.tagName=="string"}function Zp(u){return Za(u)&&u.tagName.toLowerCase()==="button"}function eg(u){return Za(u)&&u.tagName.toLowerCase()==="form"}function tg(u){return Za(u)&&u.tagName.toLowerCase()==="input"}function rg(u){return!!(u.metaKey||u.altKey||u.ctrlKey||u.shiftKey)}function ng(u,r){return u.button===0&&(!r||r==="_self")&&!rg(u)}var Fa=null;function sg(){if(Fa===null)try{new FormData(document.createElement("form"),0),Fa=!1}catch{Fa=!0}return Fa}var og=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Hc(u){return u!=null&&!og.has(u)?(Qr(!1,`"${u}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ka}"`),null):u}function ig(u,r){let n,o,a,h,d;if(eg(u)){let g=u.getAttribute("action");o=g?gn(g,r):null,n=u.getAttribute("method")||qa,a=Hc(u.getAttribute("enctype"))||Ka,h=new FormData(u)}else if(Zp(u)||tg(u)&&(u.type==="submit"||u.type==="image")){let g=u.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let v=u.getAttribute("formaction")||g.getAttribute("action");if(o=v?gn(v,r):null,n=u.getAttribute("formmethod")||g.getAttribute("method")||qa,a=Hc(u.getAttribute("formenctype"))||Hc(g.getAttribute("enctype"))||Ka,h=new FormData(g,u),!sg()){let{name:w,type:S,value:_}=u;if(S==="image"){let T=w?`${w}.`:"";h.append(`${T}x`,"0"),h.append(`${T}y`,"0")}else w&&h.append(w,_)}}else{if(Za(u))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=qa,o=null,a=Ka,d=u}return h&&a==="text/plain"&&(d=h,h=void 0),{action:o,method:n.toLowerCase(),encType:a,formData:h,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function wu(u,r){if(u===!1||u===null||typeof u>"u")throw new Error(r)}function ag(u,r,n){let o=typeof u=="string"?new URL(u,typeof window>"u"?"server://singlefetch/":window.location.origin):u;return o.pathname==="/"?o.pathname=`_root.${n}`:r&&gn(o.pathname,r)==="/"?o.pathname=`${r.replace(/\/$/,"")}/_root.${n}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${n}`,o}async function lg(u,r){if(u.id in r)return r[u.id];try{let n=await import(u.module);return r[u.id]=n,n}catch(n){return console.error(`Error loading route module \`${u.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function cg(u){return u==null?!1:u.href==null?u.rel==="preload"&&typeof u.imageSrcSet=="string"&&typeof u.imageSizes=="string":typeof u.rel=="string"&&typeof u.href=="string"}async function ug(u,r,n){let o=await Promise.all(u.map(async a=>{let h=r.routes[a.route.id];if(h){let d=await lg(h,n);return d.links?d.links():[]}return[]}));return mg(o.flat(1).filter(cg).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Vh(u,r,n,o,a,h){let d=(v,w)=>n[w]?v.route.id!==n[w].route.id:!0,g=(v,w)=>n[w].pathname!==v.pathname||n[w].route.path?.endsWith("*")&&n[w].params["*"]!==v.params["*"];return h==="assets"?r.filter((v,w)=>d(v,w)||g(v,w)):h==="data"?r.filter((v,w)=>{let S=o.routes[v.route.id];if(!S||!S.hasLoader)return!1;if(d(v,w)||g(v,w))return!0;if(v.route.shouldRevalidate){let _=v.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(u,window.origin),nextParams:v.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function dg(u,r,{includeHydrateFallback:n}={}){return hg(u.map(o=>{let a=r.routes[o.route.id];if(!a)return[];let h=[a.module];return a.clientActionModule&&(h=h.concat(a.clientActionModule)),a.clientLoaderModule&&(h=h.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(h=h.concat(a.hydrateFallbackModule)),a.imports&&(h=h.concat(a.imports)),h}).flat(1))}function hg(u){return[...new Set(u)]}function fg(u){let r={},n=Object.keys(u).sort();for(let o of n)r[o]=u[o];return r}function mg(u,r){let n=new Set;return new Set(r),u.reduce((o,a)=>{let h=JSON.stringify(fg(a));return n.has(h)||(n.add(h),o.push({key:h,link:a})),o},[])}function Nf(){let u=k.useContext(jo);return wu(u,"You must render this element inside a <DataRouterContext.Provider> element"),u}function pg(){let u=k.useContext(Xa);return wu(u,"You must render this element inside a <DataRouterStateContext.Provider> element"),u}var bu=k.createContext(void 0);bu.displayName="FrameworkContext";function jf(){let u=k.useContext(bu);return wu(u,"You must render this element inside a <HydratedRouter> element"),u}function gg(u,r){let n=k.useContext(bu),[o,a]=k.useState(!1),[h,d]=k.useState(!1),{onFocus:g,onBlur:v,onMouseEnter:w,onMouseLeave:S,onTouchStart:_}=r,T=k.useRef(null);k.useEffect(()=>{if(u==="render"&&d(!0),u==="viewport"){let M=Q=>{Q.forEach(K=>{d(K.isIntersecting)})},L=new IntersectionObserver(M,{threshold:.5});return T.current&&L.observe(T.current),()=>{L.disconnect()}}},[u]),k.useEffect(()=>{if(o){let M=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(M)}}},[o]);let R=()=>{a(!0)},A=()=>{a(!1),d(!1)};return n?u!=="intent"?[h,T,{}]:[h,T,{onFocus:gi(g,R),onBlur:gi(v,A),onMouseEnter:gi(w,R),onMouseLeave:gi(S,A),onTouchStart:gi(_,R)}]:[!1,T,{}]}function gi(u,r){return n=>{u&&u(n),n.defaultPrevented||r(n)}}function vg({page:u,...r}){let{router:n}=Nf(),o=k.useMemo(()=>pf(n.routes,u,n.basename),[n.routes,u,n.basename]);return o?k.createElement(xg,{page:u,matches:o,...r}):null}function yg(u){let{manifest:r,routeModules:n}=jf(),[o,a]=k.useState([]);return k.useEffect(()=>{let h=!1;return ug(u,r,n).then(d=>{h||a(d)}),()=>{h=!0}},[u,r,n]),o}function xg({page:u,matches:r,...n}){let o=br(),{manifest:a,routeModules:h}=jf(),{basename:d}=Nf(),{loaderData:g,matches:v}=pg(),w=k.useMemo(()=>Vh(u,r,v,a,o,"data"),[u,r,v,a,o]),S=k.useMemo(()=>Vh(u,r,v,a,o,"assets"),[u,r,v,a,o]),_=k.useMemo(()=>{if(u===o.pathname+o.search+o.hash)return[];let A=new Set,M=!1;if(r.forEach(Q=>{let K=a.routes[Q.route.id];!K||!K.hasLoader||(!w.some(B=>B.route.id===Q.route.id)&&Q.route.id in g&&h[Q.route.id]?.shouldRevalidate||K.hasClientLoader?M=!0:A.add(Q.route.id))}),A.size===0)return[];let L=ag(u,d,"data");return M&&A.size>0&&L.searchParams.set("_routes",r.filter(Q=>A.has(Q.route.id)).map(Q=>Q.route.id).join(",")),[L.pathname+L.search]},[d,g,o,a,w,r,u,h]),T=k.useMemo(()=>dg(S,a),[S,a]),R=yg(S);return k.createElement(k.Fragment,null,_.map(A=>k.createElement("link",{key:A,rel:"prefetch",as:"fetch",href:A,...n})),T.map(A=>k.createElement("link",{key:A,rel:"modulepreload",href:A,...n})),R.map(({key:A,link:M})=>k.createElement("link",{key:A,nonce:n.nonce,...M})))}function wg(...u){return r=>{u.forEach(n=>{typeof n=="function"?n(r):n!=null&&(n.current=r)})}}var Tf=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Tf&&(window.__reactRouterVersion="7.8.2")}catch{}function bg({basename:u,children:r,window:n}){let o=k.useRef();o.current==null&&(o.current=cp({window:n,v5Compat:!0}));let a=o.current,[h,d]=k.useState({action:a.action,location:a.location}),g=k.useCallback(v=>{k.startTransition(()=>d(v))},[d]);return k.useLayoutEffect(()=>a.listen(g),[a,g]),k.createElement(Yp,{basename:u,children:r,location:h.location,navigationType:h.action,navigator:a})}var Cf=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Rf=k.forwardRef(function({onClick:r,discover:n="render",prefetch:o="none",relative:a,reloadDocument:h,replace:d,state:g,target:v,to:w,preventScrollReset:S,viewTransition:_,...T},R){let{basename:A}=k.useContext(Yr),M=typeof w=="string"&&Cf.test(w),L,Q=!1;if(typeof w=="string"&&M&&(L=w,Tf))try{let O=new URL(window.location.href),Z=w.startsWith("//")?new URL(O.protocol+w):new URL(w),q=gn(Z.pathname,A);Z.origin===O.origin&&q!=null?w=q+Z.search+Z.hash:Q=!0}catch{Qr(!1,`<Link to="${w}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let K=Lp(w,{relative:a}),[B,$,G]=gg(o,T),z=kg(w,{replace:d,state:g,target:v,preventScrollReset:S,relative:a,viewTransition:_});function ne(O){r&&r(O),O.defaultPrevented||z(O)}let ae=k.createElement("a",{...T,...G,href:L||K,onClick:Q||h?r:ne,ref:wg(R,$),target:v,"data-discover":!M&&n==="render"?"true":void 0});return B&&!M?k.createElement(k.Fragment,null,ae,k.createElement(vg,{page:K})):ae});Rf.displayName="Link";var Sg=k.forwardRef(function({"aria-current":r="page",caseSensitive:n=!1,className:o="",end:a=!1,style:h,to:d,viewTransition:g,children:v,...w},S){let _=ki(d,{relative:w.relative}),T=br(),R=k.useContext(Xa),{navigator:A,basename:M}=k.useContext(Yr),L=R!=null&&Rg(_)&&g===!0,Q=A.encodeLocation?A.encodeLocation(_).pathname:_.pathname,K=T.pathname,B=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;n||(K=K.toLowerCase(),B=B?B.toLowerCase():null,Q=Q.toLowerCase()),B&&M&&(B=gn(B,M)||B);const $=Q!=="/"&&Q.endsWith("/")?Q.length-1:Q.length;let G=K===Q||!a&&K.startsWith(Q)&&K.charAt($)==="/",z=B!=null&&(B===Q||!a&&B.startsWith(Q)&&B.charAt(Q.length)==="/"),ne={isActive:G,isPending:z,isTransitioning:L},ae=G?r:void 0,O;typeof o=="function"?O=o(ne):O=[o,G?"active":null,z?"pending":null,L?"transitioning":null].filter(Boolean).join(" ");let Z=typeof h=="function"?h(ne):h;return k.createElement(Rf,{...w,"aria-current":ae,className:O,ref:S,style:Z,to:d,viewTransition:g},typeof v=="function"?v(ne):v)});Sg.displayName="NavLink";var _g=k.forwardRef(({discover:u="render",fetcherKey:r,navigate:n,reloadDocument:o,replace:a,state:h,method:d=qa,action:g,onSubmit:v,relative:w,preventScrollReset:S,viewTransition:_,...T},R)=>{let A=Tg(),M=Cg(g,{relative:w}),L=d.toLowerCase()==="get"?"get":"post",Q=typeof g=="string"&&Cf.test(g),K=B=>{if(v&&v(B),B.defaultPrevented)return;B.preventDefault();let $=B.nativeEvent.submitter,G=$?.getAttribute("formmethod")||d;A($||B.currentTarget,{fetcherKey:r,method:G,navigate:n,replace:a,state:h,relative:w,preventScrollReset:S,viewTransition:_})};return k.createElement("form",{ref:R,method:L,action:M,onSubmit:o?v:K,...T,"data-discover":!Q&&u==="render"?"true":void 0})});_g.displayName="Form";function Eg(u){return`${u} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Of(u){let r=k.useContext(jo);return ct(r,Eg(u)),r}function kg(u,{target:r,replace:n,state:o,preventScrollReset:a,relative:h,viewTransition:d}={}){let g=To(),v=br(),w=ki(u,{relative:h});return k.useCallback(S=>{if(ng(S,r)){S.preventDefault();let _=n!==void 0?n:bi(v)===bi(w);g(u,{replace:_,state:o,preventScrollReset:a,relative:h,viewTransition:d})}},[v,g,w,n,o,r,u,a,h,d])}var Ng=0,jg=()=>`__${String(++Ng)}__`;function Tg(){let{router:u}=Of("useSubmit"),{basename:r}=k.useContext(Yr),n=Kp();return k.useCallback(async(o,a={})=>{let{action:h,method:d,encType:g,formData:v,body:w}=ig(o,r);if(a.navigate===!1){let S=a.fetcherKey||jg();await u.fetch(S,n,a.action||h,{preventScrollReset:a.preventScrollReset,formData:v,body:w,formMethod:a.method||d,formEncType:a.encType||g,flushSync:a.flushSync})}else await u.navigate(a.action||h,{preventScrollReset:a.preventScrollReset,formData:v,body:w,formMethod:a.method||d,formEncType:a.encType||g,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[u,r,n])}function Cg(u,{relative:r}={}){let{basename:n}=k.useContext(Yr),o=k.useContext(vn);ct(o,"useFormAction must be used inside a RouteContext");let[a]=o.matches.slice(-1),h={...ki(u||".",{relative:r})},d=br();if(u==null){h.search=d.search;let g=new URLSearchParams(h.search),v=g.getAll("index");if(v.some(S=>S==="")){g.delete("index"),v.filter(_=>_).forEach(_=>g.append("index",_));let S=g.toString();h.search=S?`?${S}`:""}}return(!u||u===".")&&a.route.index&&(h.search=h.search?h.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(h.pathname=h.pathname==="/"?n:pn([n,h.pathname])),bi(h)}function Rg(u,{relative:r}={}){let n=k.useContext(bf);ct(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=Of("useViewTransitionState"),a=ki(u,{relative:r});if(!n.isTransitioning)return!1;let h=gn(n.currentLocation.pathname,o)||n.currentLocation.pathname,d=gn(n.nextLocation.pathname,o)||n.nextLocation.pathname;return Ga(a.pathname,d)!=null||Ga(a.pathname,h)!=null}const Og="modulepreload",Ig=function(u){return"/"+u},Wh={},Co=function(r,n,o){let a=Promise.resolve();if(n&&n.length>0){let w=function(S){return Promise.all(S.map(_=>Promise.resolve(_).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};var d=w;document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),v=g?.nonce||g?.getAttribute("nonce");a=w(n.map(S=>{if(S=Ig(S),S in Wh)return;Wh[S]=!0;const _=S.endsWith(".css"),T=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${S}"]${T}`))return;const R=document.createElement("link");if(R.rel=_?"stylesheet":Og,_||(R.as="script"),R.crossOrigin="",R.href=S,v&&R.setAttribute("nonce",v),document.head.appendChild(R),_)return new Promise((A,M)=>{R.addEventListener("load",A),R.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${S}`)))})}))}function h(g){const v=new Event("vite:preloadError",{cancelable:!0});if(v.payload=g,window.dispatchEvent(v),!v.defaultPrevented)throw g}return a.then(g=>{for(const v of g||[])v.status==="rejected"&&h(v.reason);return r().catch(h)})},Pg=u=>{let r;return u?r=u:typeof fetch>"u"?r=(...n)=>Co(async()=>{const{default:o}=await Promise.resolve().then(()=>Ro);return{default:o}},[]).then(({default:o})=>o(...n)):r=fetch,(...n)=>r(...n)};class Su extends Error{constructor(r,n="FunctionsError",o){super(r),this.name=n,this.context=o}}class Dg extends Su{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class Bh extends Su{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class Hh extends Su{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var nu;(function(u){u.Any="any",u.ApNortheast1="ap-northeast-1",u.ApNortheast2="ap-northeast-2",u.ApSouth1="ap-south-1",u.ApSoutheast1="ap-southeast-1",u.ApSoutheast2="ap-southeast-2",u.CaCentral1="ca-central-1",u.EuCentral1="eu-central-1",u.EuWest1="eu-west-1",u.EuWest2="eu-west-2",u.EuWest3="eu-west-3",u.SaEast1="sa-east-1",u.UsEast1="us-east-1",u.UsWest1="us-west-1",u.UsWest2="us-west-2"})(nu||(nu={}));var Ag=function(u,r,n,o){function a(h){return h instanceof n?h:new n(function(d){d(h)})}return new(n||(n=Promise))(function(h,d){function g(S){try{w(o.next(S))}catch(_){d(_)}}function v(S){try{w(o.throw(S))}catch(_){d(_)}}function w(S){S.done?h(S.value):a(S.value).then(g,v)}w((o=o.apply(u,r||[])).next())})};class Lg{constructor(r,{headers:n={},customFetch:o,region:a=nu.Any}={}){this.url=r,this.headers=n,this.region=a,this.fetch=Pg(o)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,n={}){var o;return Ag(this,void 0,void 0,function*(){try{const{headers:a,method:h,body:d}=n;let g={},{region:v}=n;v||(v=this.region);const w=new URL(`${this.url}/${r}`);v&&v!=="any"&&(g["x-region"]=v,w.searchParams.set("forceFunctionRegion",v));let S;d&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(g["Content-Type"]="application/octet-stream",S=d):typeof d=="string"?(g["Content-Type"]="text/plain",S=d):typeof FormData<"u"&&d instanceof FormData?S=d:(g["Content-Type"]="application/json",S=JSON.stringify(d)));const _=yield this.fetch(w.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},g),this.headers),a),body:S}).catch(M=>{throw new Dg(M)}),T=_.headers.get("x-relay-error");if(T&&T==="true")throw new Bh(_);if(!_.ok)throw new Hh(_);let R=((o=_.headers.get("Content-Type"))!==null&&o!==void 0?o:"text/plain").split(";")[0].trim(),A;return R==="application/json"?A=yield _.json():R==="application/octet-stream"?A=yield _.blob():R==="text/event-stream"?A=_:R==="multipart/form-data"?A=yield _.formData():A=yield _.text(),{data:A,error:null,response:_}}catch(a){return{data:null,error:a,response:a instanceof Hh||a instanceof Bh?a.context:void 0}}})}}var jt={},ho={},fo={},mo={},po={},go={},$g=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ko=$g();const Mg=ko.fetch,If=ko.fetch.bind(ko),Pf=ko.Headers,Ug=ko.Request,Fg=ko.Response,Ro=Object.freeze(Object.defineProperty({__proto__:null,Headers:Pf,Request:Ug,Response:Fg,default:If,fetch:Mg},Symbol.toStringTag,{value:"Module"})),zg=Xm(Ro);var za={},qh;function Df(){if(qh)return za;qh=1,Object.defineProperty(za,"__esModule",{value:!0});class u extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return za.default=u,za}var Kh;function Af(){if(Kh)return go;Kh=1;var u=go&&go.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(go,"__esModule",{value:!0});const r=u(zg),n=u(Df());class o{constructor(h){var d,g;this.shouldThrowOnError=!1,this.method=h.method,this.url=h.url,this.headers=new Headers(h.headers),this.schema=h.schema,this.body=h.body,this.shouldThrowOnError=(d=h.shouldThrowOnError)!==null&&d!==void 0?d:!1,this.signal=h.signal,this.isMaybeSingle=(g=h.isMaybeSingle)!==null&&g!==void 0?g:!1,h.fetch?this.fetch=h.fetch:typeof fetch>"u"?this.fetch=r.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(h,d){return this.headers=new Headers(this.headers),this.headers.set(h,d),this}then(h,d){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const g=this.fetch;let v=g(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async w=>{var S,_,T,R;let A=null,M=null,L=null,Q=w.status,K=w.statusText;if(w.ok){if(this.method!=="HEAD"){const z=await w.text();z===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((S=this.headers.get("Accept"))===null||S===void 0)&&S.includes("application/vnd.pgrst.plan+text"))?M=z:M=JSON.parse(z))}const $=(_=this.headers.get("Prefer"))===null||_===void 0?void 0:_.match(/count=(exact|planned|estimated)/),G=(T=w.headers.get("content-range"))===null||T===void 0?void 0:T.split("/");$&&G&&G.length>1&&(L=parseInt(G[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(M)&&(M.length>1?(A={code:"PGRST116",details:`Results contain ${M.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},M=null,L=null,Q=406,K="Not Acceptable"):M.length===1?M=M[0]:M=null)}else{const $=await w.text();try{A=JSON.parse($),Array.isArray(A)&&w.status===404&&(M=[],A=null,Q=200,K="OK")}catch{w.status===404&&$===""?(Q=204,K="No Content"):A={message:$}}if(A&&this.isMaybeSingle&&(!((R=A?.details)===null||R===void 0)&&R.includes("0 rows"))&&(A=null,Q=200,K="OK"),A&&this.shouldThrowOnError)throw new n.default(A)}return{error:A,data:M,count:L,status:Q,statusText:K}});return this.shouldThrowOnError||(v=v.catch(w=>{var S,_,T;return{error:{message:`${(S=w?.name)!==null&&S!==void 0?S:"FetchError"}: ${w?.message}`,details:`${(_=w?.stack)!==null&&_!==void 0?_:""}`,hint:"",code:`${(T=w?.code)!==null&&T!==void 0?T:""}`},data:null,count:null,status:0,statusText:""}})),v.then(h,d)}returns(){return this}overrideTypes(){return this}}return go.default=o,go}var Jh;function Lf(){if(Jh)return po;Jh=1;var u=po&&po.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(po,"__esModule",{value:!0});const r=u(Af());class n extends r.default{select(a){let h=!1;const d=(a??"*").split("").map(g=>/\s/.test(g)&&!h?"":(g==='"'&&(h=!h),g)).join("");return this.url.searchParams.set("select",d),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:h=!0,nullsFirst:d,foreignTable:g,referencedTable:v=g}={}){const w=v?`${v}.order`:"order",S=this.url.searchParams.get(w);return this.url.searchParams.set(w,`${S?`${S},`:""}${a}.${h?"asc":"desc"}${d===void 0?"":d?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:h,referencedTable:d=h}={}){const g=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(g,`${a}`),this}range(a,h,{foreignTable:d,referencedTable:g=d}={}){const v=typeof g>"u"?"offset":`${g}.offset`,w=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(v,`${a}`),this.url.searchParams.set(w,`${h-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:h=!1,settings:d=!1,buffers:g=!1,wal:v=!1,format:w="text"}={}){var S;const _=[a?"analyze":null,h?"verbose":null,d?"settings":null,g?"buffers":null,v?"wal":null].filter(Boolean).join("|"),T=(S=this.headers.get("Accept"))!==null&&S!==void 0?S:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${w}; for="${T}"; options=${_};`),w==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return po.default=n,po}var Gh;function _u(){if(Gh)return mo;Gh=1;var u=mo&&mo.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(mo,"__esModule",{value:!0});const r=u(Lf());class n extends r.default{eq(a,h){return this.url.searchParams.append(a,`eq.${h}`),this}neq(a,h){return this.url.searchParams.append(a,`neq.${h}`),this}gt(a,h){return this.url.searchParams.append(a,`gt.${h}`),this}gte(a,h){return this.url.searchParams.append(a,`gte.${h}`),this}lt(a,h){return this.url.searchParams.append(a,`lt.${h}`),this}lte(a,h){return this.url.searchParams.append(a,`lte.${h}`),this}like(a,h){return this.url.searchParams.append(a,`like.${h}`),this}likeAllOf(a,h){return this.url.searchParams.append(a,`like(all).{${h.join(",")}}`),this}likeAnyOf(a,h){return this.url.searchParams.append(a,`like(any).{${h.join(",")}}`),this}ilike(a,h){return this.url.searchParams.append(a,`ilike.${h}`),this}ilikeAllOf(a,h){return this.url.searchParams.append(a,`ilike(all).{${h.join(",")}}`),this}ilikeAnyOf(a,h){return this.url.searchParams.append(a,`ilike(any).{${h.join(",")}}`),this}is(a,h){return this.url.searchParams.append(a,`is.${h}`),this}in(a,h){const d=Array.from(new Set(h)).map(g=>typeof g=="string"&&new RegExp("[,()]").test(g)?`"${g}"`:`${g}`).join(",");return this.url.searchParams.append(a,`in.(${d})`),this}contains(a,h){return typeof h=="string"?this.url.searchParams.append(a,`cs.${h}`):Array.isArray(h)?this.url.searchParams.append(a,`cs.{${h.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(h)}`),this}containedBy(a,h){return typeof h=="string"?this.url.searchParams.append(a,`cd.${h}`):Array.isArray(h)?this.url.searchParams.append(a,`cd.{${h.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(h)}`),this}rangeGt(a,h){return this.url.searchParams.append(a,`sr.${h}`),this}rangeGte(a,h){return this.url.searchParams.append(a,`nxl.${h}`),this}rangeLt(a,h){return this.url.searchParams.append(a,`sl.${h}`),this}rangeLte(a,h){return this.url.searchParams.append(a,`nxr.${h}`),this}rangeAdjacent(a,h){return this.url.searchParams.append(a,`adj.${h}`),this}overlaps(a,h){return typeof h=="string"?this.url.searchParams.append(a,`ov.${h}`):this.url.searchParams.append(a,`ov.{${h.join(",")}}`),this}textSearch(a,h,{config:d,type:g}={}){let v="";g==="plain"?v="pl":g==="phrase"?v="ph":g==="websearch"&&(v="w");const w=d===void 0?"":`(${d})`;return this.url.searchParams.append(a,`${v}fts${w}.${h}`),this}match(a){return Object.entries(a).forEach(([h,d])=>{this.url.searchParams.append(h,`eq.${d}`)}),this}not(a,h,d){return this.url.searchParams.append(a,`not.${h}.${d}`),this}or(a,{foreignTable:h,referencedTable:d=h}={}){const g=d?`${d}.or`:"or";return this.url.searchParams.append(g,`(${a})`),this}filter(a,h,d){return this.url.searchParams.append(a,`${h}.${d}`),this}}return mo.default=n,mo}var Qh;function $f(){if(Qh)return fo;Qh=1;var u=fo&&fo.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(fo,"__esModule",{value:!0});const r=u(_u());class n{constructor(a,{headers:h={},schema:d,fetch:g}){this.url=a,this.headers=new Headers(h),this.schema=d,this.fetch=g}select(a,{head:h=!1,count:d}={}){const g=h?"HEAD":"GET";let v=!1;const w=(a??"*").split("").map(S=>/\s/.test(S)&&!v?"":(S==='"'&&(v=!v),S)).join("");return this.url.searchParams.set("select",w),d&&this.headers.append("Prefer",`count=${d}`),new r.default({method:g,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:h,defaultToNull:d=!0}={}){var g;const v="POST";if(h&&this.headers.append("Prefer",`count=${h}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const w=a.reduce((S,_)=>S.concat(Object.keys(_)),[]);if(w.length>0){const S=[...new Set(w)].map(_=>`"${_}"`);this.url.searchParams.set("columns",S.join(","))}}return new r.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}upsert(a,{onConflict:h,ignoreDuplicates:d=!1,count:g,defaultToNull:v=!0}={}){var w;const S="POST";if(this.headers.append("Prefer",`resolution=${d?"ignore":"merge"}-duplicates`),h!==void 0&&this.url.searchParams.set("on_conflict",h),g&&this.headers.append("Prefer",`count=${g}`),v||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const _=a.reduce((T,R)=>T.concat(Object.keys(R)),[]);if(_.length>0){const T=[...new Set(_)].map(R=>`"${R}"`);this.url.searchParams.set("columns",T.join(","))}}return new r.default({method:S,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(w=this.fetch)!==null&&w!==void 0?w:fetch})}update(a,{count:h}={}){var d;const g="PATCH";return h&&this.headers.append("Prefer",`count=${h}`),new r.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}delete({count:a}={}){var h;const d="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new r.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}}return fo.default=n,fo}var Yh;function Vg(){if(Yh)return ho;Yh=1;var u=ho&&ho.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ho,"__esModule",{value:!0});const r=u($f()),n=u(_u());class o{constructor(h,{headers:d={},schema:g,fetch:v}={}){this.url=h,this.headers=new Headers(d),this.schemaName=g,this.fetch=v}from(h){const d=new URL(`${this.url}/${h}`);return new r.default(d,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(h){return new o(this.url,{headers:this.headers,schema:h,fetch:this.fetch})}rpc(h,d={},{head:g=!1,get:v=!1,count:w}={}){var S;let _;const T=new URL(`${this.url}/rpc/${h}`);let R;g||v?(_=g?"HEAD":"GET",Object.entries(d).filter(([M,L])=>L!==void 0).map(([M,L])=>[M,Array.isArray(L)?`{${L.join(",")}}`:`${L}`]).forEach(([M,L])=>{T.searchParams.append(M,L)})):(_="POST",R=d);const A=new Headers(this.headers);return w&&A.set("Prefer",`count=${w}`),new n.default({method:_,url:T,headers:A,schema:this.schemaName,body:R,fetch:(S=this.fetch)!==null&&S!==void 0?S:fetch})}}return ho.default=o,ho}var Xh;function Wg(){if(Xh)return jt;Xh=1;var u=jt&&jt.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(jt,"__esModule",{value:!0}),jt.PostgrestError=jt.PostgrestBuilder=jt.PostgrestTransformBuilder=jt.PostgrestFilterBuilder=jt.PostgrestQueryBuilder=jt.PostgrestClient=void 0;const r=u(Vg());jt.PostgrestClient=r.default;const n=u($f());jt.PostgrestQueryBuilder=n.default;const o=u(_u());jt.PostgrestFilterBuilder=o.default;const a=u(Lf());jt.PostgrestTransformBuilder=a.default;const h=u(Af());jt.PostgrestBuilder=h.default;const d=u(Df());return jt.PostgrestError=d.default,jt.default={PostgrestClient:r.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:o.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:h.default,PostgrestError:d.default},jt}var Bg=Wg();const Hg=pu(Bg),{PostgrestClient:qg,PostgrestQueryBuilder:Yv,PostgrestFilterBuilder:Xv,PostgrestTransformBuilder:Zv,PostgrestBuilder:ey,PostgrestError:ty}=Hg;class Kg{static detectEnvironment(){var r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((r=navigator.userAgent)===null||r===void 0)&&r.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const n=parseInt(process.versions.node.split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const r=this.detectEnvironment();if(r.constructor)return r.constructor;let n=r.error||"WebSocket not supported in this environment.";throw r.workaround&&(n+=`

Suggested solution: ${r.workaround}`),new Error(n)}static createWebSocket(r,n){const o=this.getWebSocketConstructor();return new o(r,n)}static isWebSocketSupported(){try{const r=this.detectEnvironment();return r.type==="native"||r.type==="ws"}catch{return!1}}}const Jg="2.15.4",Gg=`realtime-js/${Jg}`,Qg="1.0.0",su=1e4,Yg=1e3,Xg=100;var yi;(function(u){u[u.connecting=0]="connecting",u[u.open=1]="open",u[u.closing=2]="closing",u[u.closed=3]="closed"})(yi||(yi={}));var yt;(function(u){u.closed="closed",u.errored="errored",u.joined="joined",u.joining="joining",u.leaving="leaving"})(yt||(yt={}));var Ar;(function(u){u.close="phx_close",u.error="phx_error",u.join="phx_join",u.reply="phx_reply",u.leave="phx_leave",u.access_token="access_token"})(Ar||(Ar={}));var ou;(function(u){u.websocket="websocket"})(ou||(ou={}));var Cs;(function(u){u.Connecting="connecting",u.Open="open",u.Closing="closing",u.Closed="closed"})(Cs||(Cs={}));class Zg{constructor(){this.HEADER_LENGTH=1}decode(r,n){return r.constructor===ArrayBuffer?n(this._binaryDecode(r)):n(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const n=new DataView(r),o=new TextDecoder;return this._decodeBroadcast(r,n,o)}_decodeBroadcast(r,n,o){const a=n.getUint8(1),h=n.getUint8(2);let d=this.HEADER_LENGTH+2;const g=o.decode(r.slice(d,d+a));d=d+a;const v=o.decode(r.slice(d,d+h));d=d+h;const w=JSON.parse(o.decode(r.slice(d,r.byteLength)));return{ref:null,topic:g,event:v,payload:w}}}class Mf{constructor(r,n){this.callback=r,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ze;(function(u){u.abstime="abstime",u.bool="bool",u.date="date",u.daterange="daterange",u.float4="float4",u.float8="float8",u.int2="int2",u.int4="int4",u.int4range="int4range",u.int8="int8",u.int8range="int8range",u.json="json",u.jsonb="jsonb",u.money="money",u.numeric="numeric",u.oid="oid",u.reltime="reltime",u.text="text",u.time="time",u.timestamp="timestamp",u.timestamptz="timestamptz",u.timetz="timetz",u.tsrange="tsrange",u.tstzrange="tstzrange"})(Ze||(Ze={}));const Zh=(u,r,n={})=>{var o;const a=(o=n.skipTypes)!==null&&o!==void 0?o:[];return Object.keys(r).reduce((h,d)=>(h[d]=e0(d,u,r,a),h),{})},e0=(u,r,n,o)=>{const a=r.find(g=>g.name===u),h=a?.type,d=n[u];return h&&!o.includes(h)?Uf(h,d):iu(d)},Uf=(u,r)=>{if(u.charAt(0)==="_"){const n=u.slice(1,u.length);return s0(r,n)}switch(u){case Ze.bool:return t0(r);case Ze.float4:case Ze.float8:case Ze.int2:case Ze.int4:case Ze.int8:case Ze.numeric:case Ze.oid:return r0(r);case Ze.json:case Ze.jsonb:return n0(r);case Ze.timestamp:return o0(r);case Ze.abstime:case Ze.date:case Ze.daterange:case Ze.int4range:case Ze.int8range:case Ze.money:case Ze.reltime:case Ze.text:case Ze.time:case Ze.timestamptz:case Ze.timetz:case Ze.tsrange:case Ze.tstzrange:return iu(r);default:return iu(r)}},iu=u=>u,t0=u=>{switch(u){case"t":return!0;case"f":return!1;default:return u}},r0=u=>{if(typeof u=="string"){const r=parseFloat(u);if(!Number.isNaN(r))return r}return u},n0=u=>{if(typeof u=="string")try{return JSON.parse(u)}catch(r){return console.log(`JSON parse error: ${r}`),u}return u},s0=(u,r)=>{if(typeof u!="string")return u;const n=u.length-1,o=u[n];if(u[0]==="{"&&o==="}"){let h;const d=u.slice(1,n);try{h=JSON.parse("["+d+"]")}catch{h=d?d.split(","):[]}return h.map(g=>Uf(r,g))}return u},o0=u=>typeof u=="string"?u.replace(" ","T"):u,Ff=u=>{let r=u;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")+"/api/broadcast"};class qc{constructor(r,n,o={},a=su){this.channel=r,this.event=n,this.payload=o,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,n){var o;return this._hasReceived(r)&&n((o=this.receivedResp)===null||o===void 0?void 0:o.response),this.recHooks.push({status:r,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:n}){this.recHooks.filter(o=>o.status===r).forEach(o=>o.callback(n))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var ef;(function(u){u.SYNC="sync",u.JOIN="join",u.LEAVE="leave"})(ef||(ef={}));class xi{constructor(r,n){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const o=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(o.state,{},a=>{const{onJoin:h,onLeave:d,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=xi.syncState(this.state,a,h,d),this.pendingDiffs.forEach(v=>{this.state=xi.syncDiff(this.state,v,h,d)}),this.pendingDiffs=[],g()}),this.channel._on(o.diff,{},a=>{const{onJoin:h,onLeave:d,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=xi.syncDiff(this.state,a,h,d),g())}),this.onJoin((a,h,d)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:h,newPresences:d})}),this.onLeave((a,h,d)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:h,leftPresences:d})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,n,o,a){const h=this.cloneDeep(r),d=this.transformState(n),g={},v={};return this.map(h,(w,S)=>{d[w]||(v[w]=S)}),this.map(d,(w,S)=>{const _=h[w];if(_){const T=S.map(L=>L.presence_ref),R=_.map(L=>L.presence_ref),A=S.filter(L=>R.indexOf(L.presence_ref)<0),M=_.filter(L=>T.indexOf(L.presence_ref)<0);A.length>0&&(g[w]=A),M.length>0&&(v[w]=M)}else g[w]=S}),this.syncDiff(h,{joins:g,leaves:v},o,a)}static syncDiff(r,n,o,a){const{joins:h,leaves:d}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return o||(o=()=>{}),a||(a=()=>{}),this.map(h,(g,v)=>{var w;const S=(w=r[g])!==null&&w!==void 0?w:[];if(r[g]=this.cloneDeep(v),S.length>0){const _=r[g].map(R=>R.presence_ref),T=S.filter(R=>_.indexOf(R.presence_ref)<0);r[g].unshift(...T)}o(g,S,v)}),this.map(d,(g,v)=>{let w=r[g];if(!w)return;const S=v.map(_=>_.presence_ref);w=w.filter(_=>S.indexOf(_.presence_ref)<0),r[g]=w,a(g,w,v),w.length===0&&delete r[g]}),r}static map(r,n){return Object.getOwnPropertyNames(r).map(o=>n(o,r[o]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((n,o)=>{const a=r[o];return"metas"in a?n[o]=a.metas.map(h=>(h.presence_ref=h.phx_ref,delete h.phx_ref,delete h.phx_ref_prev,h)):n[o]=a,n},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var tf;(function(u){u.ALL="*",u.INSERT="INSERT",u.UPDATE="UPDATE",u.DELETE="DELETE"})(tf||(tf={}));var wi;(function(u){u.BROADCAST="broadcast",u.PRESENCE="presence",u.POSTGRES_CHANGES="postgres_changes",u.SYSTEM="system"})(wi||(wi={}));var mn;(function(u){u.SUBSCRIBED="SUBSCRIBED",u.TIMED_OUT="TIMED_OUT",u.CLOSED="CLOSED",u.CHANNEL_ERROR="CHANNEL_ERROR"})(mn||(mn={}));class Eu{constructor(r,n={config:{}},o){this.topic=r,this.params=n,this.socket=o,this.bindings={},this.state=yt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new qc(this,Ar.join,this.params,this.timeout),this.rejoinTimer=new Mf(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=yt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=yt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=yt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=yt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=yt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ar.reply,{},(a,h)=>{this._trigger(this._replyEventName(h),a)}),this.presence=new xi(this),this.broadcastEndpointURL=Ff(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(r,n=this.timeout){var o,a,h;if(this.socket.isConnected()||this.socket.connect(),this.state==yt.closed){const{config:{broadcast:d,presence:g,private:v}}=this.params,w=(a=(o=this.bindings.postgres_changes)===null||o===void 0?void 0:o.map(R=>R.filter))!==null&&a!==void 0?a:[],S=!!this.bindings[wi.PRESENCE]&&this.bindings[wi.PRESENCE].length>0||((h=this.params.config.presence)===null||h===void 0?void 0:h.enabled)===!0,_={},T={broadcast:d,presence:Object.assign(Object.assign({},g),{enabled:S}),postgres_changes:w,private:v};this.socket.accessTokenValue&&(_.access_token=this.socket.accessTokenValue),this._onError(R=>r?.(mn.CHANNEL_ERROR,R)),this._onClose(()=>r?.(mn.CLOSED)),this.updateJoinPayload(Object.assign({config:T},_)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:R})=>{var A;if(this.socket.setAuth(),R===void 0){r?.(mn.SUBSCRIBED);return}else{const M=this.bindings.postgres_changes,L=(A=M?.length)!==null&&A!==void 0?A:0,Q=[];for(let K=0;K<L;K++){const B=M[K],{filter:{event:$,schema:G,table:z,filter:ne}}=B,ae=R&&R[K];if(ae&&ae.event===$&&ae.schema===G&&ae.table===z&&ae.filter===ne)Q.push(Object.assign(Object.assign({},B),{id:ae.id}));else{this.unsubscribe(),this.state=yt.errored,r?.(mn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=Q,r&&r(mn.SUBSCRIBED);return}}).receive("error",R=>{this.state=yt.errored,r?.(mn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(R).join(", ")||"error")))}).receive("timeout",()=>{r?.(mn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,n={}){return await this.send({type:"presence",event:"track",payload:r},n.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,n,o){return this.state===yt.joined&&r===wi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(r,n,o)}async send(r,n={}){var o,a;if(!this._canPush()&&r.type==="broadcast"){const{event:h,payload:d}=r,v={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:h,payload:d,private:this.private}]})};try{const w=await this._fetchWithTimeout(this.broadcastEndpointURL,v,(o=n.timeout)!==null&&o!==void 0?o:this.timeout);return await((a=w.body)===null||a===void 0?void 0:a.cancel()),w.ok?"ok":"error"}catch(w){return w.name==="AbortError"?"timed out":"error"}}else return new Promise(h=>{var d,g,v;const w=this._push(r.type,r,n.timeout||this.timeout);r.type==="broadcast"&&!(!((v=(g=(d=this.params)===null||d===void 0?void 0:d.config)===null||g===void 0?void 0:g.broadcast)===null||v===void 0)&&v.ack)&&h("ok"),w.receive("ok",()=>h("ok")),w.receive("error",()=>h("error")),w.receive("timeout",()=>h("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=yt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ar.close,"leave",this._joinRef())};this.joinPush.destroy();let o=null;return new Promise(a=>{o=new qc(this,Ar.leave,{},r),o.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),o.send(),this._canPush()||o.trigger("ok",{})}).finally(()=>{o?.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=yt.closed,this.bindings={}}async _fetchWithTimeout(r,n,o){const a=new AbortController,h=setTimeout(()=>a.abort(),o),d=await this.socket.fetch(r,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(h),d}_push(r,n,o=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new qc(this,r,n,o);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(r){if(r.startTimeout(),this.pushBuffer.push(r),this.pushBuffer.length>Xg){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(r,n,o){return n}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,n,o){var a,h;const d=r.toLocaleLowerCase(),{close:g,error:v,leave:w,join:S}=Ar;if(o&&[g,v,w,S].indexOf(d)>=0&&o!==this._joinRef())return;let T=this._onMessage(d,n,o);if(n&&!T)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(d)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(R=>{var A,M,L;return((A=R.filter)===null||A===void 0?void 0:A.event)==="*"||((L=(M=R.filter)===null||M===void 0?void 0:M.event)===null||L===void 0?void 0:L.toLocaleLowerCase())===d}).map(R=>R.callback(T,o)):(h=this.bindings[d])===null||h===void 0||h.filter(R=>{var A,M,L,Q,K,B;if(["broadcast","presence","postgres_changes"].includes(d))if("id"in R){const $=R.id,G=(A=R.filter)===null||A===void 0?void 0:A.event;return $&&((M=n.ids)===null||M===void 0?void 0:M.includes($))&&(G==="*"||G?.toLocaleLowerCase()===((L=n.data)===null||L===void 0?void 0:L.type.toLocaleLowerCase()))}else{const $=(K=(Q=R?.filter)===null||Q===void 0?void 0:Q.event)===null||K===void 0?void 0:K.toLocaleLowerCase();return $==="*"||$===((B=n?.event)===null||B===void 0?void 0:B.toLocaleLowerCase())}else return R.type.toLocaleLowerCase()===d}).map(R=>{if(typeof T=="object"&&"ids"in T){const A=T.data,{schema:M,table:L,commit_timestamp:Q,type:K,errors:B}=A;T=Object.assign(Object.assign({},{schema:M,table:L,commit_timestamp:Q,eventType:K,new:{},old:{},errors:B}),this._getPayloadRecords(A))}R.callback(T,o)})}_isClosed(){return this.state===yt.closed}_isJoined(){return this.state===yt.joined}_isJoining(){return this.state===yt.joining}_isLeaving(){return this.state===yt.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,n,o){const a=r.toLocaleLowerCase(),h={type:a,filter:n,callback:o};return this.bindings[a]?this.bindings[a].push(h):this.bindings[a]=[h],this}_off(r,n){const o=r.toLocaleLowerCase();return this.bindings[o]&&(this.bindings[o]=this.bindings[o].filter(a=>{var h;return!(((h=a.type)===null||h===void 0?void 0:h.toLocaleLowerCase())===o&&Eu.isEqual(a.filter,n))})),this}static isEqual(r,n){if(Object.keys(r).length!==Object.keys(n).length)return!1;for(const o in r)if(r[o]!==n[o])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(Ar.close,{},r)}_onError(r){this._on(Ar.error,{},n=>r(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=yt.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const n={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(n.new=Zh(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(n.old=Zh(r.columns,r.old_record)),n}}const Kc=()=>{},Va={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},i0=[1e3,2e3,5e3,1e4],a0=1e4,l0=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class c0{constructor(r,n){var o;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=su,this.transport=null,this.heartbeatIntervalMs=Va.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Kc,this.ref=0,this.reconnectTimer=null,this.logger=Kc,this.conn=null,this.sendBuffer=[],this.serializer=new Zg,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let h;return a?h=a:typeof fetch>"u"?h=(...d)=>Co(async()=>{const{default:g}=await Promise.resolve().then(()=>Ro);return{default:g}},void 0).then(({default:g})=>g(...d)).catch(g=>{throw new Error(`Failed to load @supabase/node-fetch: ${g.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):h=fetch,(...d)=>h(...d)},!(!((o=n?.params)===null||o===void 0)&&o.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${r}/${ou.websocket}`,this.httpEndpoint=Ff(r),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Kg.createWebSocket(this.endpointURL())}catch(r){this._setConnectionState("disconnected");const n=r.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Qg}))}disconnect(r,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const o=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(o),this._setConnectionState("disconnected")},r?this.conn.close(r,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(r){const n=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const r=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,n,o){this.logger(r,n,o)}connectionState(){switch(this.conn&&this.conn.readyState){case yi.connecting:return Cs.Connecting;case yi.open:return Cs.Open;case yi.closing:return Cs.Closing;default:return Cs.Closed}}isConnected(){return this.connectionState()===Cs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(r,n={config:{}}){const o=`realtime:${r}`,a=this.getChannels().find(h=>h.topic===o);if(a)return a;{const h=new Eu(`realtime:${r}`,n,this);return this.channels.push(h),h}}push(r){const{topic:n,event:o,payload:a,ref:h}=r,d=()=>{this.encode(r,g=>{var v;(v=this.conn)===null||v===void 0||v.send(g)})};this.log("push",`${n} ${o} (${h})`,a),this.isConnected()?d():this.sendBuffer.push(d)}async setAuth(r=null){this._authPromise=this._performAuth(r);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var r;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(r=this.conn)===null||r===void 0||r.close(Yg,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Va.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let n=this.channels.find(o=>o.topic===r&&(o._isJoined()||o._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${r}"`),n.unsubscribe())}_remove(r){this.channels=this.channels.filter(n=>n.topic!==r.topic)}_onConnMessage(r){this.decode(r.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(w){this.log("error","error in heartbeat callback",w)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:o,event:a,payload:h,ref:d}=n,g=d?`(${d})`:"",v=h.status||"";this.log("receive",`${v} ${o} ${a} ${g}`.trim(),h),this.channels.filter(w=>w._isMember(o)).forEach(w=>w._trigger(a,h,d)),this._triggerStateCallbacks("message",n)})}_clearTimer(r){var n;r==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):r==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(r=>r.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(r){var n;this._setConnectionState("disconnected"),this.log("transport","close",r),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",r)}_onConnError(r){this._setConnectionState("disconnected"),this.log("transport",`${r}`),this._triggerChanError(),this._triggerStateCallbacks("error",r)}_triggerChanError(){this.channels.forEach(r=>r._trigger(Ar.error))}_appendParams(r,n){if(Object.keys(n).length===0)return r;const o=r.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${r}${o}${a}`}_workerObjectUrl(r){let n;if(r)n=r;else{const o=new Blob([l0],{type:"application/javascript"});n=URL.createObjectURL(o)}return n}_setConnectionState(r,n=!1){this._connectionState=r,r==="connecting"?this._wasManualDisconnect=!1:r==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(r=null){let n;r?n=r:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(o=>{const a={access_token:n,version:Gg};n&&o.updateJoinPayload(a),o.joinedOnce&&o._isJoined()&&o._push(Ar.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(r="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${r}`,n)})}_triggerStateCallbacks(r,n){try{this.stateChangeCallbacks[r].forEach(o=>{try{o(n)}catch(a){this.log("error",`error in ${r} callback`,a)}})}catch(o){this.log("error",`error triggering ${r} callbacks`,o)}}_setupReconnectionTimer(){this.reconnectTimer=new Mf(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Va.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(r){var n,o,a,h,d,g,v,w,S;if(this.transport=(n=r?.transport)!==null&&n!==void 0?n:null,this.timeout=(o=r?.timeout)!==null&&o!==void 0?o:su,this.heartbeatIntervalMs=(a=r?.heartbeatIntervalMs)!==null&&a!==void 0?a:Va.HEARTBEAT_INTERVAL,this.worker=(h=r?.worker)!==null&&h!==void 0?h:!1,this.accessToken=(d=r?.accessToken)!==null&&d!==void 0?d:null,this.heartbeatCallback=(g=r?.heartbeatCallback)!==null&&g!==void 0?g:Kc,r?.params&&(this.params=r.params),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(v=r?.reconnectAfterMs)!==null&&v!==void 0?v:(_=>i0[_-1]||a0),this.encode=(w=r?.encode)!==null&&w!==void 0?w:((_,T)=>T(JSON.stringify(_))),this.decode=(S=r?.decode)!==null&&S!==void 0?S:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=r?.workerUrl}}}class ku extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function xt(u){return typeof u=="object"&&u!==null&&"__isStorageError"in u}class u0 extends ku{constructor(r,n,o){super(r),this.name="StorageApiError",this.status=n,this.statusCode=o}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class au extends ku{constructor(r,n){super(r),this.name="StorageUnknownError",this.originalError=n}}var d0=function(u,r,n,o){function a(h){return h instanceof n?h:new n(function(d){d(h)})}return new(n||(n=Promise))(function(h,d){function g(S){try{w(o.next(S))}catch(_){d(_)}}function v(S){try{w(o.throw(S))}catch(_){d(_)}}function w(S){S.done?h(S.value):a(S.value).then(g,v)}w((o=o.apply(u,r||[])).next())})};const zf=u=>{let r;return u?r=u:typeof fetch>"u"?r=(...n)=>Co(async()=>{const{default:o}=await Promise.resolve().then(()=>Ro);return{default:o}},void 0).then(({default:o})=>o(...n)):r=fetch,(...n)=>r(...n)},h0=()=>d0(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Co(()=>Promise.resolve().then(()=>Ro),void 0)).Response:Response}),lu=u=>{if(Array.isArray(u))return u.map(n=>lu(n));if(typeof u=="function"||u!==Object(u))return u;const r={};return Object.entries(u).forEach(([n,o])=>{const a=n.replace(/([-_][a-z])/gi,h=>h.toUpperCase().replace(/[-_]/g,""));r[a]=lu(o)}),r},f0=u=>{if(typeof u!="object"||u===null)return!1;const r=Object.getPrototypeOf(u);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in u)&&!(Symbol.iterator in u)};var Rs=function(u,r,n,o){function a(h){return h instanceof n?h:new n(function(d){d(h)})}return new(n||(n=Promise))(function(h,d){function g(S){try{w(o.next(S))}catch(_){d(_)}}function v(S){try{w(o.throw(S))}catch(_){d(_)}}function w(S){S.done?h(S.value):a(S.value).then(g,v)}w((o=o.apply(u,r||[])).next())})};const Jc=u=>u.msg||u.message||u.error_description||u.error||JSON.stringify(u),m0=(u,r,n)=>Rs(void 0,void 0,void 0,function*(){const o=yield h0();u instanceof o&&!n?.noResolveJson?u.json().then(a=>{const h=u.status||500,d=a?.statusCode||h+"";r(new u0(Jc(a),h,d))}).catch(a=>{r(new au(Jc(a),a))}):r(new au(Jc(u),u))}),p0=(u,r,n,o)=>{const a={method:u,headers:r?.headers||{}};return u==="GET"||!o?a:(f0(o)?(a.headers=Object.assign({"Content-Type":"application/json"},r?.headers),a.body=JSON.stringify(o)):a.body=o,r?.duplex&&(a.duplex=r.duplex),Object.assign(Object.assign({},a),n))};function Ni(u,r,n,o,a,h){return Rs(this,void 0,void 0,function*(){return new Promise((d,g)=>{u(n,p0(r,o,a,h)).then(v=>{if(!v.ok)throw v;return o?.noResolveJson?v:v.json()}).then(v=>d(v)).catch(v=>m0(v,g,o))})})}function Qa(u,r,n,o){return Rs(this,void 0,void 0,function*(){return Ni(u,"GET",r,n,o)})}function Gr(u,r,n,o,a){return Rs(this,void 0,void 0,function*(){return Ni(u,"POST",r,o,a,n)})}function cu(u,r,n,o,a){return Rs(this,void 0,void 0,function*(){return Ni(u,"PUT",r,o,a,n)})}function g0(u,r,n,o){return Rs(this,void 0,void 0,function*(){return Ni(u,"HEAD",r,Object.assign(Object.assign({},n),{noResolveJson:!0}),o)})}function Vf(u,r,n,o,a){return Rs(this,void 0,void 0,function*(){return Ni(u,"DELETE",r,o,a,n)})}var Bt=function(u,r,n,o){function a(h){return h instanceof n?h:new n(function(d){d(h)})}return new(n||(n=Promise))(function(h,d){function g(S){try{w(o.next(S))}catch(_){d(_)}}function v(S){try{w(o.throw(S))}catch(_){d(_)}}function w(S){S.done?h(S.value):a(S.value).then(g,v)}w((o=o.apply(u,r||[])).next())})};const v0={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},rf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class y0{constructor(r,n={},o,a){this.url=r,this.headers=n,this.bucketId=o,this.fetch=zf(a)}uploadOrUpdate(r,n,o,a){return Bt(this,void 0,void 0,function*(){try{let h;const d=Object.assign(Object.assign({},rf),a);let g=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(d.upsert)});const v=d.metadata;typeof Blob<"u"&&o instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),v&&h.append("metadata",this.encodeMetadata(v)),h.append("",o)):typeof FormData<"u"&&o instanceof FormData?(h=o,h.append("cacheControl",d.cacheControl),v&&h.append("metadata",this.encodeMetadata(v))):(h=o,g["cache-control"]=`max-age=${d.cacheControl}`,g["content-type"]=d.contentType,v&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(v)))),a?.headers&&(g=Object.assign(Object.assign({},g),a.headers));const w=this._removeEmptyFolders(n),S=this._getFinalPath(w),_=yield(r=="PUT"?cu:Gr)(this.fetch,`${this.url}/object/${S}`,h,Object.assign({headers:g},d?.duplex?{duplex:d.duplex}:{}));return{data:{path:w,id:_.Id,fullPath:_.Key},error:null}}catch(h){if(xt(h))return{data:null,error:h};throw h}})}upload(r,n,o){return Bt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,n,o)})}uploadToSignedUrl(r,n,o,a){return Bt(this,void 0,void 0,function*(){const h=this._removeEmptyFolders(r),d=this._getFinalPath(h),g=new URL(this.url+`/object/upload/sign/${d}`);g.searchParams.set("token",n);try{let v;const w=Object.assign({upsert:rf.upsert},a),S=Object.assign(Object.assign({},this.headers),{"x-upsert":String(w.upsert)});typeof Blob<"u"&&o instanceof Blob?(v=new FormData,v.append("cacheControl",w.cacheControl),v.append("",o)):typeof FormData<"u"&&o instanceof FormData?(v=o,v.append("cacheControl",w.cacheControl)):(v=o,S["cache-control"]=`max-age=${w.cacheControl}`,S["content-type"]=w.contentType);const _=yield cu(this.fetch,g.toString(),v,{headers:S});return{data:{path:h,fullPath:_.Key},error:null}}catch(v){if(xt(v))return{data:null,error:v};throw v}})}createSignedUploadUrl(r,n){return Bt(this,void 0,void 0,function*(){try{let o=this._getFinalPath(r);const a=Object.assign({},this.headers);n?.upsert&&(a["x-upsert"]="true");const h=yield Gr(this.fetch,`${this.url}/object/upload/sign/${o}`,{},{headers:a}),d=new URL(this.url+h.url),g=d.searchParams.get("token");if(!g)throw new ku("No token returned by API");return{data:{signedUrl:d.toString(),path:r,token:g},error:null}}catch(o){if(xt(o))return{data:null,error:o};throw o}})}update(r,n,o){return Bt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,n,o)})}move(r,n,o){return Bt(this,void 0,void 0,function*(){try{return{data:yield Gr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:n,destinationBucket:o?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(xt(a))return{data:null,error:a};throw a}})}copy(r,n,o){return Bt(this,void 0,void 0,function*(){try{return{data:{path:(yield Gr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:n,destinationBucket:o?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(xt(a))return{data:null,error:a};throw a}})}createSignedUrl(r,n,o){return Bt(this,void 0,void 0,function*(){try{let a=this._getFinalPath(r),h=yield Gr(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},o?.transform?{transform:o.transform}:{}),{headers:this.headers});const d=o?.download?`&download=${o.download===!0?"":o.download}`:"";return h={signedUrl:encodeURI(`${this.url}${h.signedURL}${d}`)},{data:h,error:null}}catch(a){if(xt(a))return{data:null,error:a};throw a}})}createSignedUrls(r,n,o){return Bt(this,void 0,void 0,function*(){try{const a=yield Gr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:r},{headers:this.headers}),h=o?.download?`&download=${o.download===!0?"":o.download}`:"";return{data:a.map(d=>Object.assign(Object.assign({},d),{signedUrl:d.signedURL?encodeURI(`${this.url}${d.signedURL}${h}`):null})),error:null}}catch(a){if(xt(a))return{data:null,error:a};throw a}})}download(r,n){return Bt(this,void 0,void 0,function*(){const a=typeof n?.transform<"u"?"render/image/authenticated":"object",h=this.transformOptsToQueryString(n?.transform||{}),d=h?`?${h}`:"";try{const g=this._getFinalPath(r);return{data:yield(yield Qa(this.fetch,`${this.url}/${a}/${g}${d}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(g){if(xt(g))return{data:null,error:g};throw g}})}info(r){return Bt(this,void 0,void 0,function*(){const n=this._getFinalPath(r);try{const o=yield Qa(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:lu(o),error:null}}catch(o){if(xt(o))return{data:null,error:o};throw o}})}exists(r){return Bt(this,void 0,void 0,function*(){const n=this._getFinalPath(r);try{return yield g0(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(o){if(xt(o)&&o instanceof au){const a=o.originalError;if([400,404].includes(a?.status))return{data:!1,error:o}}throw o}})}getPublicUrl(r,n){const o=this._getFinalPath(r),a=[],h=n?.download?`download=${n.download===!0?"":n.download}`:"";h!==""&&a.push(h);const g=typeof n?.transform<"u"?"render/image":"object",v=this.transformOptsToQueryString(n?.transform||{});v!==""&&a.push(v);let w=a.join("&");return w!==""&&(w=`?${w}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${o}${w}`)}}}remove(r){return Bt(this,void 0,void 0,function*(){try{return{data:yield Vf(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(n){if(xt(n))return{data:null,error:n};throw n}})}list(r,n,o){return Bt(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},v0),n),{prefix:r||""});return{data:yield Gr(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},o),error:null}}catch(a){if(xt(a))return{data:null,error:a};throw a}})}listV2(r,n){return Bt(this,void 0,void 0,function*(){try{const o=Object.assign({},r);return{data:yield Gr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,o,{headers:this.headers},n),error:null}}catch(o){if(xt(o))return{data:null,error:o};throw o}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const n=[];return r.width&&n.push(`width=${r.width}`),r.height&&n.push(`height=${r.height}`),r.resize&&n.push(`resize=${r.resize}`),r.format&&n.push(`format=${r.format}`),r.quality&&n.push(`quality=${r.quality}`),n.join("&")}}const x0="2.11.1",w0={"X-Client-Info":`storage-js/${x0}`};var vo=function(u,r,n,o){function a(h){return h instanceof n?h:new n(function(d){d(h)})}return new(n||(n=Promise))(function(h,d){function g(S){try{w(o.next(S))}catch(_){d(_)}}function v(S){try{w(o.throw(S))}catch(_){d(_)}}function w(S){S.done?h(S.value):a(S.value).then(g,v)}w((o=o.apply(u,r||[])).next())})};class b0{constructor(r,n={},o,a){const h=new URL(r);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(h.hostname)&&!h.hostname.includes("storage.supabase.")&&(h.hostname=h.hostname.replace("supabase.","storage.supabase.")),this.url=h.href,this.headers=Object.assign(Object.assign({},w0),n),this.fetch=zf(o)}listBuckets(){return vo(this,void 0,void 0,function*(){try{return{data:yield Qa(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(xt(r))return{data:null,error:r};throw r}})}getBucket(r){return vo(this,void 0,void 0,function*(){try{return{data:yield Qa(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(n){if(xt(n))return{data:null,error:n};throw n}})}createBucket(r,n={public:!1}){return vo(this,void 0,void 0,function*(){try{return{data:yield Gr(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(o){if(xt(o))return{data:null,error:o};throw o}})}updateBucket(r,n){return vo(this,void 0,void 0,function*(){try{return{data:yield cu(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(o){if(xt(o))return{data:null,error:o};throw o}})}emptyBucket(r){return vo(this,void 0,void 0,function*(){try{return{data:yield Gr(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(xt(n))return{data:null,error:n};throw n}})}deleteBucket(r){return vo(this,void 0,void 0,function*(){try{return{data:yield Vf(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(n){if(xt(n))return{data:null,error:n};throw n}})}}class S0 extends b0{constructor(r,n={},o,a){super(r,n,o,a)}from(r){return new y0(this.url,this.headers,r,this.fetch)}}const _0="2.57.0";let vi="";typeof Deno<"u"?vi="deno":typeof document<"u"?vi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?vi="react-native":vi="node";const E0={"X-Client-Info":`supabase-js-${vi}/${_0}`},k0={headers:E0},N0={schema:"public"},j0={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},T0={};var C0=function(u,r,n,o){function a(h){return h instanceof n?h:new n(function(d){d(h)})}return new(n||(n=Promise))(function(h,d){function g(S){try{w(o.next(S))}catch(_){d(_)}}function v(S){try{w(o.throw(S))}catch(_){d(_)}}function w(S){S.done?h(S.value):a(S.value).then(g,v)}w((o=o.apply(u,r||[])).next())})};const R0=u=>{let r;return u?r=u:typeof fetch>"u"?r=If:r=fetch,(...n)=>r(...n)},O0=()=>typeof Headers>"u"?Pf:Headers,I0=(u,r,n)=>{const o=R0(n),a=O0();return(h,d)=>C0(void 0,void 0,void 0,function*(){var g;const v=(g=yield r())!==null&&g!==void 0?g:u;let w=new a(d?.headers);return w.has("apikey")||w.set("apikey",u),w.has("Authorization")||w.set("Authorization",`Bearer ${v}`),o(h,Object.assign(Object.assign({},d),{headers:w}))})};var P0=function(u,r,n,o){function a(h){return h instanceof n?h:new n(function(d){d(h)})}return new(n||(n=Promise))(function(h,d){function g(S){try{w(o.next(S))}catch(_){d(_)}}function v(S){try{w(o.throw(S))}catch(_){d(_)}}function w(S){S.done?h(S.value):a(S.value).then(g,v)}w((o=o.apply(u,r||[])).next())})};function D0(u){return u.endsWith("/")?u:u+"/"}function A0(u,r){var n,o;const{db:a,auth:h,realtime:d,global:g}=u,{db:v,auth:w,realtime:S,global:_}=r,T={db:Object.assign(Object.assign({},v),a),auth:Object.assign(Object.assign({},w),h),realtime:Object.assign(Object.assign({},S),d),storage:{},global:Object.assign(Object.assign(Object.assign({},_),g),{headers:Object.assign(Object.assign({},(n=_?.headers)!==null&&n!==void 0?n:{}),(o=g?.headers)!==null&&o!==void 0?o:{})}),accessToken:()=>P0(this,void 0,void 0,function*(){return""})};return u.accessToken?T.accessToken=u.accessToken:delete T.accessToken,T}const Wf="2.71.1",_o=30*1e3,uu=3,Gc=uu*_o,L0="http://localhost:9999",$0="supabase.auth.token",M0={"X-Client-Info":`gotrue-js/${Wf}`},du="X-Supabase-Api-Version",Bf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},U0=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,F0=600*1e3;class Nu extends Error{constructor(r,n,o){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=o}}function Ie(u){return typeof u=="object"&&u!==null&&"__isAuthError"in u}class z0 extends Nu{constructor(r,n,o){super(r,n,o),this.name="AuthApiError",this.status=n,this.code=o}}function V0(u){return Ie(u)&&u.name==="AuthApiError"}class Hf extends Nu{constructor(r,n){super(r),this.name="AuthUnknownError",this.originalError=n}}class Hn extends Nu{constructor(r,n,o,a){super(r,o,a),this.name=n,this.status=o}}class Wn extends Hn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function W0(u){return Ie(u)&&u.name==="AuthSessionMissingError"}class Wa extends Hn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ba extends Hn{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class Ha extends Hn{constructor(r,n=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function B0(u){return Ie(u)&&u.name==="AuthImplicitGrantRedirectError"}class nf extends Hn{constructor(r,n=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class hu extends Hn{constructor(r,n){super(r,"AuthRetryableFetchError",n,void 0)}}function Qc(u){return Ie(u)&&u.name==="AuthRetryableFetchError"}class sf extends Hn{constructor(r,n,o){super(r,"AuthWeakPasswordError",n,"weak_password"),this.reasons=o}}class fu extends Hn{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ya="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),of=` 	
\r=`.split(""),H0=(()=>{const u=new Array(128);for(let r=0;r<u.length;r+=1)u[r]=-1;for(let r=0;r<of.length;r+=1)u[of[r].charCodeAt(0)]=-2;for(let r=0;r<Ya.length;r+=1)u[Ya[r].charCodeAt(0)]=r;return u})();function af(u,r,n){if(u!==null)for(r.queue=r.queue<<8|u,r.queuedBits+=8;r.queuedBits>=6;){const o=r.queue>>r.queuedBits-6&63;n(Ya[o]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const o=r.queue>>r.queuedBits-6&63;n(Ya[o]),r.queuedBits-=6}}function qf(u,r,n){const o=H0[u];if(o>-1)for(r.queue=r.queue<<6|o,r.queuedBits+=6;r.queuedBits>=8;)n(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(o===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(u)}"`)}}function lf(u){const r=[],n=d=>{r.push(String.fromCodePoint(d))},o={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},h=d=>{J0(d,o,n)};for(let d=0;d<u.length;d+=1)qf(u.charCodeAt(d),a,h);return r.join("")}function q0(u,r){if(u<=127){r(u);return}else if(u<=2047){r(192|u>>6),r(128|u&63);return}else if(u<=65535){r(224|u>>12),r(128|u>>6&63),r(128|u&63);return}else if(u<=1114111){r(240|u>>18),r(128|u>>12&63),r(128|u>>6&63),r(128|u&63);return}throw new Error(`Unrecognized Unicode codepoint: ${u.toString(16)}`)}function K0(u,r){for(let n=0;n<u.length;n+=1){let o=u.charCodeAt(n);if(o>55295&&o<=56319){const a=(o-55296)*1024&65535;o=(u.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}q0(o,r)}}function J0(u,r,n){if(r.utf8seq===0){if(u<=127){n(u);return}for(let o=1;o<6;o+=1)if((u>>7-o&1)===0){r.utf8seq=o;break}if(r.utf8seq===2)r.codepoint=u&31;else if(r.utf8seq===3)r.codepoint=u&15;else if(r.utf8seq===4)r.codepoint=u&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(u<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|u&63,r.utf8seq-=1,r.utf8seq===0&&n(r.codepoint)}}function G0(u){const r=[],n={queue:0,queuedBits:0},o=a=>{r.push(a)};for(let a=0;a<u.length;a+=1)qf(u.charCodeAt(a),n,o);return new Uint8Array(r)}function Q0(u){const r=[];return K0(u,n=>r.push(n)),new Uint8Array(r)}function Y0(u){const r=[],n={queue:0,queuedBits:0},o=a=>{r.push(a)};return u.forEach(a=>af(a,n,o)),af(null,n,o),r.join("")}function X0(u){return Math.round(Date.now()/1e3)+u}function Z0(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(u){const r=Math.random()*16|0;return(u=="x"?r:r&3|8).toString(16)})}const Dr=()=>typeof window<"u"&&typeof document<"u",Ns={tested:!1,writable:!1},Kf=()=>{if(!Dr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ns.tested)return Ns.writable;const u=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(u,u),globalThis.localStorage.removeItem(u),Ns.tested=!0,Ns.writable=!0}catch{Ns.tested=!0,Ns.writable=!1}return Ns.writable};function ev(u){const r={},n=new URL(u);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,h)=>{r[h]=a})}catch{}return n.searchParams.forEach((o,a)=>{r[a]=o}),r}const Jf=u=>{let r;return u?r=u:typeof fetch>"u"?r=(...n)=>Co(async()=>{const{default:o}=await Promise.resolve().then(()=>Ro);return{default:o}},void 0).then(({default:o})=>o(...n)):r=fetch,(...n)=>r(...n)},tv=u=>typeof u=="object"&&u!==null&&"status"in u&&"ok"in u&&"json"in u&&typeof u.json=="function",Eo=async(u,r,n)=>{await u.setItem(r,JSON.stringify(n))},js=async(u,r)=>{const n=await u.getItem(r);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Vn=async(u,r)=>{await u.removeItem(r)};class el{constructor(){this.promise=new el.promiseConstructor((r,n)=>{this.resolve=r,this.reject=n})}}el.promiseConstructor=Promise;function Yc(u){const r=u.split(".");if(r.length!==3)throw new fu("Invalid JWT structure");for(let o=0;o<r.length;o++)if(!U0.test(r[o]))throw new fu("JWT not in base64url format");return{header:JSON.parse(lf(r[0])),payload:JSON.parse(lf(r[1])),signature:G0(r[2]),raw:{header:r[0],payload:r[1]}}}async function rv(u){return await new Promise(r=>{setTimeout(()=>r(null),u)})}function nv(u,r){return new Promise((o,a)=>{(async()=>{for(let h=0;h<1/0;h++)try{const d=await u(h);if(!r(h,null,d)){o(d);return}}catch(d){if(!r(h,d)){a(d);return}}})()})}function sv(u){return("0"+u.toString(16)).substr(-2)}function ov(){const r=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",o=n.length;let a="";for(let h=0;h<56;h++)a+=n.charAt(Math.floor(Math.random()*o));return a}return crypto.getRandomValues(r),Array.from(r,sv).join("")}async function iv(u){const n=new TextEncoder().encode(u),o=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(o);return Array.from(a).map(h=>String.fromCharCode(h)).join("")}async function av(u){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),u;const n=await iv(u);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function yo(u,r,n=!1){const o=ov();let a=o;n&&(a+="/PASSWORD_RECOVERY"),await Eo(u,`${r}-code-verifier`,a);const h=await av(o);return[h,o===h?"plain":"s256"]}const lv=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function cv(u){const r=u.headers.get(du);if(!r||!r.match(lv))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function uv(u){if(!u)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(u<=r)throw new Error("JWT has expired")}function dv(u){switch(u){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const hv=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xo(u){if(!hv.test(u))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xc(){const u={};return new Proxy(u,{get:(r,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const o=n.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(r,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(r,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function cf(u){return JSON.parse(JSON.stringify(u))}var fv=function(u,r){var n={};for(var o in u)Object.prototype.hasOwnProperty.call(u,o)&&r.indexOf(o)<0&&(n[o]=u[o]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(u);a<o.length;a++)r.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(u,o[a])&&(n[o[a]]=u[o[a]]);return n};const Ts=u=>u.msg||u.message||u.error_description||u.error||JSON.stringify(u),mv=[502,503,504];async function uf(u){var r;if(!tv(u))throw new hu(Ts(u),0);if(mv.includes(u.status))throw new hu(Ts(u),u.status);let n;try{n=await u.json()}catch(h){throw new Hf(Ts(h),h)}let o;const a=cv(u);if(a&&a.getTime()>=Bf["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?o=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(o=n.error_code),o){if(o==="weak_password")throw new sf(Ts(n),u.status,((r=n.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(o==="session_not_found")throw new Wn}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((h,d)=>h&&typeof d=="string",!0))throw new sf(Ts(n),u.status,n.weak_password.reasons);throw new z0(Ts(n),u.status||500,o)}const pv=(u,r,n,o)=>{const a={method:u,headers:r?.headers||{}};return u==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r?.headers),a.body=JSON.stringify(o),Object.assign(Object.assign({},a),n))};async function Me(u,r,n,o){var a;const h=Object.assign({},o?.headers);h[du]||(h[du]=Bf["2024-01-01"].name),o?.jwt&&(h.Authorization=`Bearer ${o.jwt}`);const d=(a=o?.query)!==null&&a!==void 0?a:{};o?.redirectTo&&(d.redirect_to=o.redirectTo);const g=Object.keys(d).length?"?"+new URLSearchParams(d).toString():"",v=await gv(u,r,n+g,{headers:h,noResolveJson:o?.noResolveJson},{},o?.body);return o?.xform?o?.xform(v):{data:Object.assign({},v),error:null}}async function gv(u,r,n,o,a,h){const d=pv(r,o,a,h);let g;try{g=await u(n,Object.assign({},d))}catch(v){throw console.error(v),new hu(Ts(v),0)}if(g.ok||await uf(g),o?.noResolveJson)return g;try{return await g.json()}catch(v){await uf(v)}}function fn(u){var r;let n=null;wv(u)&&(n=Object.assign({},u),u.expires_at||(n.expires_at=X0(u.expires_in)));const o=(r=u.user)!==null&&r!==void 0?r:u;return{data:{session:n,user:o},error:null}}function df(u){const r=fn(u);return!r.error&&u.weak_password&&typeof u.weak_password=="object"&&Array.isArray(u.weak_password.reasons)&&u.weak_password.reasons.length&&u.weak_password.message&&typeof u.weak_password.message=="string"&&u.weak_password.reasons.reduce((n,o)=>n&&typeof o=="string",!0)&&(r.data.weak_password=u.weak_password),r}function Bn(u){var r;return{data:{user:(r=u.user)!==null&&r!==void 0?r:u},error:null}}function vv(u){return{data:u,error:null}}function yv(u){const{action_link:r,email_otp:n,hashed_token:o,redirect_to:a,verification_type:h}=u,d=fv(u,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:r,email_otp:n,hashed_token:o,redirect_to:a,verification_type:h},v=Object.assign({},d);return{data:{properties:g,user:v},error:null}}function xv(u){return u}function wv(u){return u.access_token&&u.refresh_token&&u.expires_in}const Zc=["global","local","others"];var bv=function(u,r){var n={};for(var o in u)Object.prototype.hasOwnProperty.call(u,o)&&r.indexOf(o)<0&&(n[o]=u[o]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(u);a<o.length;a++)r.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(u,o[a])&&(n[o[a]]=u[o[a]]);return n};class Sv{constructor({url:r="",headers:n={},fetch:o}){this.url=r,this.headers=n,this.fetch=Jf(o),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,n=Zc[0]){if(Zc.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Zc.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(o){if(Ie(o))return{data:null,error:o};throw o}}async inviteUserByEmail(r,n={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Bn})}catch(o){if(Ie(o))return{data:{user:null},error:o};throw o}}async generateLink(r){try{const{options:n}=r,o=bv(r,["options"]),a=Object.assign(Object.assign({},o),n);return"newEmail"in o&&(a.new_email=o?.newEmail,delete a.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:yv,redirectTo:n?.redirectTo})}catch(n){if(Ie(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(r){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:Bn})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async listUsers(r){var n,o,a,h,d,g,v;try{const w={nextPage:null,lastPage:0,total:0},S=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(n=r?.page)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:"",per_page:(h=(a=r?.perPage)===null||a===void 0?void 0:a.toString())!==null&&h!==void 0?h:""},xform:xv});if(S.error)throw S.error;const _=await S.json(),T=(d=S.headers.get("x-total-count"))!==null&&d!==void 0?d:0,R=(v=(g=S.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&v!==void 0?v:[];return R.length>0&&(R.forEach(A=>{const M=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),L=JSON.parse(A.split(";")[1].split("=")[1]);w[`${L}Page`]=M}),w.total=parseInt(T)),{data:Object.assign(Object.assign({},_),w),error:null}}catch(w){if(Ie(w))return{data:{users:[]},error:w};throw w}}async getUserById(r){xo(r);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:Bn})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async updateUserById(r,n){xo(r);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:n,headers:this.headers,xform:Bn})}catch(o){if(Ie(o))return{data:{user:null},error:o};throw o}}async deleteUser(r,n=!1){xo(r);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:n},xform:Bn})}catch(o){if(Ie(o))return{data:{user:null},error:o};throw o}}async _listFactors(r){xo(r.userId);try{const{data:n,error:o}=await Me(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:o}}catch(n){if(Ie(n))return{data:null,error:n};throw n}}async _deleteFactor(r){xo(r.userId),xo(r.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(n){if(Ie(n))return{data:null,error:n};throw n}}}function hf(u={}){return{getItem:r=>u[r]||null,setItem:(r,n)=>{u[r]=n},removeItem:r=>{delete u[r]}}}function _v(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const wo={debug:!!(globalThis&&Kf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Gf extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class Ev extends Gf{}async function kv(u,r,n){wo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",u,r);const o=new globalThis.AbortController;return r>0&&setTimeout(()=>{o.abort(),wo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",u)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(u,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:o.signal},async a=>{if(a){wo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",u,a.name);try{return await n()}finally{wo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",u,a.name)}}else{if(r===0)throw wo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",u),new Ev(`Acquiring an exclusive Navigator LockManager lock "${u}" immediately failed`);if(wo.debug)try{const h=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(h,null,"  "))}catch(h){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",h)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}_v();const Nv={url:L0,storageKey:$0,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:M0,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ff(u,r,n){return await n()}const bo={};class Si{constructor(r){var n,o;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Si.nextInstanceID,Si.nextInstanceID+=1,this.instanceID>0&&Dr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Nv),r);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Sv({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Jf(a.fetch),this.lock=a.lock||ff,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Dr()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=kv:this.lock=ff,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Kf()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=hf(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=hf(this.memoryStorage)),Dr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(h){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",h)}(o=this.broadcastChannel)===null||o===void 0||o.addEventListener("message",async h=>{this._debug("received broadcast notification from other tab or client",h),await this._notifyAllSubscribers(h.data.event,h.data.session,!1)})}this.initialize()}get jwks(){var r,n;return(n=(r=bo[this.storageKey])===null||r===void 0?void 0:r.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(r){bo[this.storageKey]=Object.assign(Object.assign({},bo[this.storageKey]),{jwks:r})}get jwks_cached_at(){var r,n;return(n=(r=bo[this.storageKey])===null||r===void 0?void 0:r.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(r){bo[this.storageKey]=Object.assign(Object.assign({},bo[this.storageKey]),{cachedAt:r})}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Wf}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const n=ev(window.location.href);let o="none";if(this._isImplicitGrantCallback(n)?o="implicit":await this._isPKCECallback(n)&&(o="pkce"),Dr()&&this.detectSessionInUrl&&o!=="none"){const{data:a,error:h}=await this._getSessionFromURL(n,o);if(h){if(this._debug("#_initialize()","error detecting session from URL",h),B0(h)){const v=(r=h.details)===null||r===void 0?void 0:r.code;if(v==="identity_already_exists"||v==="identity_not_found"||v==="single_identity_not_deletable")return{error:h}}return await this._removeSession(),{error:h}}const{session:d,redirectType:g}=a;return this._debug("#_initialize()","detected session in URL",d,"redirect type",g),await this._saveSession(d),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",d):await this._notifyAllSubscribers("SIGNED_IN",d)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Ie(n)?{error:n}:{error:new Hf("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var n,o,a;try{const h=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(o=(n=r?.options)===null||n===void 0?void 0:n.data)!==null&&o!==void 0?o:{},gotrue_meta_security:{captcha_token:(a=r?.options)===null||a===void 0?void 0:a.captchaToken}},xform:fn}),{data:d,error:g}=h;if(g||!d)return{data:{user:null,session:null},error:g};const v=d.session,w=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:w,session:v},error:null}}catch(h){if(Ie(h))return{data:{user:null,session:null},error:h};throw h}}async signUp(r){var n,o,a;try{let h;if("email"in r){const{email:S,password:_,options:T}=r;let R=null,A=null;this.flowType==="pkce"&&([R,A]=await yo(this.storage,this.storageKey)),h=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:T?.emailRedirectTo,body:{email:S,password:_,data:(n=T?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:T?.captchaToken},code_challenge:R,code_challenge_method:A},xform:fn})}else if("phone"in r){const{phone:S,password:_,options:T}=r;h=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:S,password:_,data:(o=T?.data)!==null&&o!==void 0?o:{},channel:(a=T?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:T?.captchaToken}},xform:fn})}else throw new Ba("You must provide either an email or phone number and a password");const{data:d,error:g}=h;if(g||!d)return{data:{user:null,session:null},error:g};const v=d.session,w=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:w,session:v},error:null}}catch(h){if(Ie(h))return{data:{user:null,session:null},error:h};throw h}}async signInWithPassword(r){try{let n;if("email"in r){const{email:h,password:d,options:g}=r;n=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:h,password:d,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:df})}else if("phone"in r){const{phone:h,password:d,options:g}=r;n=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:h,password:d,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:df})}else throw new Ba("You must provide either an email or phone number and a password");const{data:o,error:a}=n;return a?{data:{user:null,session:null},error:a}:!o||!o.session||!o.user?{data:{user:null,session:null},error:new Wa}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign({user:o.user,session:o.session},o.weak_password?{weakPassword:o.weak_password}:null),error:a})}catch(n){if(Ie(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(r){var n,o,a,h;return await this._handleProviderSignIn(r.provider,{redirectTo:(n=r.options)===null||n===void 0?void 0:n.redirectTo,scopes:(o=r.options)===null||o===void 0?void 0:o.scopes,queryParams:(a=r.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(h=r.options)===null||h===void 0?void 0:h.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:n}=r;if(n==="solana")return await this.signInWithSolana(r);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(r){var n,o,a,h,d,g,v,w,S,_,T,R;let A,M;if("message"in r)A=r.message,M=r.signature;else{const{chain:L,wallet:Q,statement:K,options:B}=r;let $;if(Dr())if(typeof Q=="object")$=Q;else{const z=window;if("solana"in z&&typeof z.solana=="object"&&("signIn"in z.solana&&typeof z.solana.signIn=="function"||"signMessage"in z.solana&&typeof z.solana.signMessage=="function"))$=z.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof Q!="object"||!B?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");$=Q}const G=new URL((n=B?.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in $&&$.signIn){const z=await $.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},B?.signInWithSolana),{version:"1",domain:G.host,uri:G.href}),K?{statement:K}:null));let ne;if(Array.isArray(z)&&z[0]&&typeof z[0]=="object")ne=z[0];else if(z&&typeof z=="object"&&"signedMessage"in z&&"signature"in z)ne=z;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in ne&&"signature"in ne&&(typeof ne.signedMessage=="string"||ne.signedMessage instanceof Uint8Array)&&ne.signature instanceof Uint8Array)A=typeof ne.signedMessage=="string"?ne.signedMessage:new TextDecoder().decode(ne.signedMessage),M=ne.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in $)||typeof $.signMessage!="function"||!("publicKey"in $)||typeof $!="object"||!$.publicKey||!("toBase58"in $.publicKey)||typeof $.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");A=[`${G.host} wants you to sign in with your Solana account:`,$.publicKey.toBase58(),...K?["",K,""]:[""],"Version: 1",`URI: ${G.href}`,`Issued At: ${(a=(o=B?.signInWithSolana)===null||o===void 0?void 0:o.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((h=B?.signInWithSolana)===null||h===void 0)&&h.notBefore?[`Not Before: ${B.signInWithSolana.notBefore}`]:[],...!((d=B?.signInWithSolana)===null||d===void 0)&&d.expirationTime?[`Expiration Time: ${B.signInWithSolana.expirationTime}`]:[],...!((g=B?.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${B.signInWithSolana.chainId}`]:[],...!((v=B?.signInWithSolana)===null||v===void 0)&&v.nonce?[`Nonce: ${B.signInWithSolana.nonce}`]:[],...!((w=B?.signInWithSolana)===null||w===void 0)&&w.requestId?[`Request ID: ${B.signInWithSolana.requestId}`]:[],...!((_=(S=B?.signInWithSolana)===null||S===void 0?void 0:S.resources)===null||_===void 0)&&_.length?["Resources",...B.signInWithSolana.resources.map(ne=>`- ${ne}`)]:[]].join(`
`);const z=await $.signMessage(new TextEncoder().encode(A),"utf8");if(!z||!(z instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");M=z}}try{const{data:L,error:Q}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:A,signature:Y0(M)},!((T=r.options)===null||T===void 0)&&T.captchaToken?{gotrue_meta_security:{captcha_token:(R=r.options)===null||R===void 0?void 0:R.captchaToken}}:null),xform:fn});if(Q)throw Q;return!L||!L.session||!L.user?{data:{user:null,session:null},error:new Wa}:(L.session&&(await this._saveSession(L.session),await this._notifyAllSubscribers("SIGNED_IN",L.session)),{data:Object.assign({},L),error:Q})}catch(L){if(Ie(L))return{data:{user:null,session:null},error:L};throw L}}async _exchangeCodeForSession(r){const n=await js(this.storage,`${this.storageKey}-code-verifier`),[o,a]=(n??"").split("/");try{const{data:h,error:d}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:o},xform:fn});if(await Vn(this.storage,`${this.storageKey}-code-verifier`),d)throw d;return!h||!h.session||!h.user?{data:{user:null,session:null,redirectType:null},error:new Wa}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),{data:Object.assign(Object.assign({},h),{redirectType:a??null}),error:d})}catch(h){if(Ie(h))return{data:{user:null,session:null,redirectType:null},error:h};throw h}}async signInWithIdToken(r){try{const{options:n,provider:o,token:a,access_token:h,nonce:d}=r,g=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:o,id_token:a,access_token:h,nonce:d,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:fn}),{data:v,error:w}=g;return w?{data:{user:null,session:null},error:w}:!v||!v.session||!v.user?{data:{user:null,session:null},error:new Wa}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:v,error:w})}catch(n){if(Ie(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(r){var n,o,a,h,d;try{if("email"in r){const{email:g,options:v}=r;let w=null,S=null;this.flowType==="pkce"&&([w,S]=await yo(this.storage,this.storageKey));const{error:_}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(n=v?.data)!==null&&n!==void 0?n:{},create_user:(o=v?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:w,code_challenge_method:S},redirectTo:v?.emailRedirectTo});return{data:{user:null,session:null},error:_}}if("phone"in r){const{phone:g,options:v}=r,{data:w,error:S}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(a=v?.data)!==null&&a!==void 0?a:{},create_user:(h=v?.shouldCreateUser)!==null&&h!==void 0?h:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},channel:(d=v?.channel)!==null&&d!==void 0?d:"sms"}});return{data:{user:null,session:null,messageId:w?.message_id},error:S}}throw new Ba("You must provide either an email or phone number.")}catch(g){if(Ie(g))return{data:{user:null,session:null},error:g};throw g}}async verifyOtp(r){var n,o;try{let a,h;"options"in r&&(a=(n=r.options)===null||n===void 0?void 0:n.redirectTo,h=(o=r.options)===null||o===void 0?void 0:o.captchaToken);const{data:d,error:g}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:h}}),redirectTo:a,xform:fn});if(g)throw g;if(!d)throw new Error("An error occurred on token verification.");const v=d.session,w=d.user;return v?.access_token&&(await this._saveSession(v),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",v)),{data:{user:w,session:v},error:null}}catch(a){if(Ie(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(r){var n,o,a;try{let h=null,d=null;return this.flowType==="pkce"&&([h,d]=await yo(this.storage,this.storageKey)),await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(o=(n=r.options)===null||n===void 0?void 0:n.redirectTo)!==null&&o!==void 0?o:void 0}),!((a=r?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:h,code_challenge_method:d}),headers:this.headers,xform:vv})}catch(h){if(Ie(h))return{data:null,error:h};throw h}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:n},error:o}=r;if(o)throw o;if(!n)throw new Wn;const{error:a}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(r){if(Ie(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const n=`${this.url}/resend`;if("email"in r){const{email:o,type:a,options:h}=r,{error:d}=await Me(this.fetch,"POST",n,{headers:this.headers,body:{email:o,type:a,gotrue_meta_security:{captcha_token:h?.captchaToken}},redirectTo:h?.emailRedirectTo});return{data:{user:null,session:null},error:d}}else if("phone"in r){const{phone:o,type:a,options:h}=r,{data:d,error:g}=await Me(this.fetch,"POST",n,{headers:this.headers,body:{phone:o,type:a,gotrue_meta_security:{captcha_token:h?.captchaToken}}});return{data:{user:null,session:null,messageId:d?.message_id},error:g}}throw new Ba("You must provide either an email or phone number and a type")}catch(n){if(Ie(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(r,n){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const o=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await o,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const o=n();for(this.pendingInLock.push((async()=>{try{await o}catch{}})()),await o;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await o}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await r(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const n=await js(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?r=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const o=r.expires_at?r.expires_at*1e3-Date.now()<Gc:!1;if(this._debug("#__loadSession()",`session has${o?"":" not"} expired`,"expires_at",r.expires_at),!o){if(this.userStorage){const d=await js(this.userStorage,this.storageKey+"-user");d?.user?r.user=d.user:r.user=Xc()}if(this.storage.isServer&&r.user){let d=this.suppressGetSessionWarning;r=new Proxy(r,{get:(v,w,S)=>(!d&&w==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),d=!0,this.suppressGetSessionWarning=!0),Reflect.get(v,w,S))})}return{data:{session:r},error:null}}const{session:a,error:h}=await this._callRefreshToken(r.refresh_token);return h?{data:{session:null},error:h}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:Bn}):await this._useSession(async n=>{var o,a,h;const{data:d,error:g}=n;if(g)throw g;return!(!((o=d.session)===null||o===void 0)&&o.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Wn}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(h=(a=d.session)===null||a===void 0?void 0:a.access_token)!==null&&h!==void 0?h:void 0,xform:Bn})})}catch(n){if(Ie(n))return W0(n)&&(await this._removeSession(),await Vn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(r,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,n))}async _updateUser(r,n={}){try{return await this._useSession(async o=>{const{data:a,error:h}=o;if(h)throw h;if(!a.session)throw new Wn;const d=a.session;let g=null,v=null;this.flowType==="pkce"&&r.email!=null&&([g,v]=await yo(this.storage,this.storageKey));const{data:w,error:S}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:g,code_challenge_method:v}),jwt:d.access_token,xform:Bn});if(S)throw S;return d.user=w.user,await this._saveSession(d),await this._notifyAllSubscribers("USER_UPDATED",d),{data:{user:d.user},error:null}})}catch(o){if(Ie(o))return{data:{user:null},error:o};throw o}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new Wn;const n=Date.now()/1e3;let o=n,a=!0,h=null;const{payload:d}=Yc(r.access_token);if(d.exp&&(o=d.exp,a=o<=n),a){const{session:g,error:v}=await this._callRefreshToken(r.refresh_token);if(v)return{data:{user:null,session:null},error:v};if(!g)return{data:{user:null,session:null},error:null};h=g}else{const{data:g,error:v}=await this._getUser(r.access_token);if(v)throw v;h={access_token:r.access_token,refresh_token:r.refresh_token,user:g.user,token_type:"bearer",expires_in:o-n,expires_at:o},await this._saveSession(h),await this._notifyAllSubscribers("SIGNED_IN",h)}return{data:{user:h.user,session:h},error:null}}catch(n){if(Ie(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async n=>{var o;if(!r){const{data:d,error:g}=n;if(g)throw g;r=(o=d.session)!==null&&o!==void 0?o:void 0}if(!r?.refresh_token)throw new Wn;const{session:a,error:h}=await this._callRefreshToken(r.refresh_token);return h?{data:{user:null,session:null},error:h}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Ie(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(r,n){try{if(!Dr())throw new Ha("No browser detected.");if(r.error||r.error_description||r.error_code)throw new Ha(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new nf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ha("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new nf("No code detected.");const{data:K,error:B}=await this._exchangeCodeForSession(r.code);if(B)throw B;const $=new URL(window.location.href);return $.searchParams.delete("code"),window.history.replaceState(window.history.state,"",$.toString()),{data:{session:K.session,redirectType:null},error:null}}const{provider_token:o,provider_refresh_token:a,access_token:h,refresh_token:d,expires_in:g,expires_at:v,token_type:w}=r;if(!h||!g||!d||!w)throw new Ha("No session defined in URL");const S=Math.round(Date.now()/1e3),_=parseInt(g);let T=S+_;v&&(T=parseInt(v));const R=T-S;R*1e3<=_o&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${R}s, should have been closer to ${_}s`);const A=T-_;S-A>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",A,T,S):S-A<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",A,T,S);const{data:M,error:L}=await this._getUser(h);if(L)throw L;const Q={provider_token:o,provider_refresh_token:a,access_token:h,expires_in:_,expires_at:T,refresh_token:d,token_type:w,user:M.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:Q,redirectType:r.type},error:null}}catch(o){if(Ie(o))return{data:{session:null,redirectType:null},error:o};throw o}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const n=await js(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&n)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async n=>{var o;const{data:a,error:h}=n;if(h)return{error:h};const d=(o=a.session)===null||o===void 0?void 0:o.access_token;if(d){const{error:g}=await this.admin.signOut(d,r);if(g&&!(V0(g)&&(g.status===404||g.status===401||g.status===403)))return{error:g}}return r!=="others"&&(await this._removeSession(),await Vn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const n=Z0(),o={id:n,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,o),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:o}}}async _emitInitialSession(r){return await this._useSession(async n=>{var o,a;try{const{data:{session:h},error:d}=n;if(d)throw d;await((o=this.stateChangeEmitters.get(r))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",h)),this._debug("INITIAL_SESSION","callback id",r,"session",h)}catch(h){await((a=this.stateChangeEmitters.get(r))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",h),console.error(h)}})}async resetPasswordForEmail(r,n={}){let o=null,a=null;this.flowType==="pkce"&&([o,a]=await yo(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:o,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(h){if(Ie(h))return{data:null,error:h};throw h}}async getUserIdentities(){var r;try{const{data:n,error:o}=await this.getUser();if(o)throw o;return{data:{identities:(r=n.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(n){if(Ie(n))return{data:null,error:n};throw n}}async linkIdentity(r){var n;try{const{data:o,error:a}=await this._useSession(async h=>{var d,g,v,w,S;const{data:_,error:T}=h;if(T)throw T;const R=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(d=r.options)===null||d===void 0?void 0:d.redirectTo,scopes:(g=r.options)===null||g===void 0?void 0:g.scopes,queryParams:(v=r.options)===null||v===void 0?void 0:v.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",R,{headers:this.headers,jwt:(S=(w=_.session)===null||w===void 0?void 0:w.access_token)!==null&&S!==void 0?S:void 0})});if(a)throw a;return Dr()&&!(!((n=r.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(o?.url),{data:{provider:r.provider,url:o?.url},error:null}}catch(o){if(Ie(o))return{data:{provider:r.provider,url:null},error:o};throw o}}async unlinkIdentity(r){try{return await this._useSession(async n=>{var o,a;const{data:h,error:d}=n;if(d)throw d;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(a=(o=h.session)===null||o===void 0?void 0:o.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(Ie(n))return{data:null,error:n};throw n}}async _refreshAccessToken(r){const n=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(n,"begin");try{const o=Date.now();return await nv(async a=>(a>0&&await rv(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:fn})),(a,h)=>{const d=200*Math.pow(2,a);return h&&Qc(h)&&Date.now()+d-o<_o})}catch(o){if(this._debug(n,"error",o),Ie(o))return{data:{session:null,user:null},error:o};throw o}finally{this._debug(n,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,n){const o=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",n,"url",o),Dr()&&!n.skipBrowserRedirect&&window.location.assign(o),{data:{provider:r,url:o},error:null}}async _recoverAndRefresh(){var r,n;const o="#_recoverAndRefresh()";this._debug(o,"begin");try{const a=await js(this.storage,this.storageKey);if(a&&this.userStorage){let d=await js(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!d&&(d={user:a.user},await Eo(this.userStorage,this.storageKey+"-user",d)),a.user=(r=d?.user)!==null&&r!==void 0?r:Xc()}else if(a&&!a.user&&!a.user){const d=await js(this.storage,this.storageKey+"-user");d&&d?.user?(a.user=d.user,await Vn(this.storage,this.storageKey+"-user"),await Eo(this.storage,this.storageKey,a)):a.user=Xc()}if(this._debug(o,"session from storage",a),!this._isValidSession(a)){this._debug(o,"session is not valid"),a!==null&&await this._removeSession();return}const h=((n=a.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Gc;if(this._debug(o,`session has${h?"":" not"} expired with margin of ${Gc}s`),h){if(this.autoRefreshToken&&a.refresh_token){const{error:d}=await this._callRefreshToken(a.refresh_token);d&&(console.error(d),Qc(d)||(this._debug(o,"refresh failed with a non-retryable error, removing the session",d),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:d,error:g}=await this._getUser(a.access_token);!g&&d?.user?(a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(o,"could not get user data, skipping SIGNED_IN notification")}catch(d){console.error("Error getting user data:",d),this._debug(o,"error getting user data, skipping SIGNED_IN notification",d)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(o,"error",a),console.error(a);return}finally{this._debug(o,"end")}}async _callRefreshToken(r){var n,o;if(!r)throw new Wn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new el;const{data:h,error:d}=await this._refreshAccessToken(r);if(d)throw d;if(!h.session)throw new Wn;await this._saveSession(h.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",h.session);const g={session:h.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(h){if(this._debug(a,"error",h),Ie(h)){const d={session:null,error:h};return Qc(h)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(d),d}throw(o=this.refreshingDeferred)===null||o===void 0||o.reject(h),h}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(r,n,o=!0){const a=`#_notifyAllSubscribers(${r})`;this._debug(a,"begin",n,`broadcast = ${o}`);try{this.broadcastChannel&&o&&this.broadcastChannel.postMessage({event:r,session:n});const h=[],d=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(r,n)}catch(v){h.push(v)}});if(await Promise.all(d),h.length>0){for(let g=0;g<h.length;g+=1)console.error(h[g]);throw h[0]}}finally{this._debug(a,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0;const n=Object.assign({},r),o=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!o&&n.user&&await Eo(this.userStorage,this.storageKey+"-user",{user:n.user});const a=Object.assign({},n);delete a.user;const h=cf(a);await Eo(this.storage,this.storageKey,h)}else{const a=cf(n);await Eo(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Vn(this.storage,this.storageKey),await Vn(this.storage,this.storageKey+"-code-verifier"),await Vn(this.storage,this.storageKey+"-user"),this.userStorage&&await Vn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&Dr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",r)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),_o);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async n=>{const{data:{session:o}}=n;if(!o||!o.refresh_token||!o.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((o.expires_at*1e3-r)/_o);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${_o}ms, refresh threshold is ${uu} ticks`),a<=uu&&await this._callRefreshToken(o.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof Gf)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Dr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const n=`#_onVisibilityChanged(${r})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,n,o){const a=[`provider=${encodeURIComponent(n)}`];if(o?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(o.redirectTo)}`),o?.scopes&&a.push(`scopes=${encodeURIComponent(o.scopes)}`),this.flowType==="pkce"){const[h,d]=await yo(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(h)}`,code_challenge_method:`${encodeURIComponent(d)}`});a.push(g.toString())}if(o?.queryParams){const h=new URLSearchParams(o.queryParams);a.push(h.toString())}return o?.skipBrowserRedirect&&a.push(`skip_http_redirect=${o.skipBrowserRedirect}`),`${r}?${a.join("&")}`}async _unenroll(r){try{return await this._useSession(async n=>{var o;const{data:a,error:h}=n;return h?{data:null,error:h}:await Me(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(o=a?.session)===null||o===void 0?void 0:o.access_token})})}catch(n){if(Ie(n))return{data:null,error:n};throw n}}async _enroll(r){try{return await this._useSession(async n=>{var o,a;const{data:h,error:d}=n;if(d)return{data:null,error:d};const g=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:v,error:w}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(o=h?.session)===null||o===void 0?void 0:o.access_token});return w?{data:null,error:w}:(r.factorType==="totp"&&(!((a=v?.totp)===null||a===void 0)&&a.qr_code)&&(v.totp.qr_code=`data:image/svg+xml;utf-8,${v.totp.qr_code}`),{data:v,error:null})})}catch(n){if(Ie(n))return{data:null,error:n};throw n}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var o;const{data:a,error:h}=n;if(h)return{data:null,error:h};const{data:d,error:g}=await Me(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(o=a?.session)===null||o===void 0?void 0:o.access_token});return g?{data:null,error:g}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:g})})}catch(n){if(Ie(n))return{data:null,error:n};throw n}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var o;const{data:a,error:h}=n;return h?{data:null,error:h}:await Me(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(o=a?.session)===null||o===void 0?void 0:o.access_token})})}catch(n){if(Ie(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(r){const{data:n,error:o}=await this._challenge({factorId:r.factorId});return o?{data:null,error:o}:await this._verify({factorId:r.factorId,challengeId:n.id,code:r.code})}async _listFactors(){const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const o=r?.factors||[],a=o.filter(d=>d.factor_type==="totp"&&d.status==="verified"),h=o.filter(d=>d.factor_type==="phone"&&d.status==="verified");return{data:{all:o,totp:a,phone:h},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var n,o;const{data:{session:a},error:h}=r;if(h)return{data:null,error:h};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=Yc(a.access_token);let g=null;d.aal&&(g=d.aal);let v=g;((o=(n=a.user.factors)===null||n===void 0?void 0:n.filter(_=>_.status==="verified"))!==null&&o!==void 0?o:[]).length>0&&(v="aal2");const S=d.amr||[];return{data:{currentLevel:g,nextLevel:v,currentAuthenticationMethods:S},error:null}}))}async fetchJwk(r,n={keys:[]}){let o=n.keys.find(g=>g.kid===r);if(o)return o;const a=Date.now();if(o=this.jwks.keys.find(g=>g.kid===r),o&&this.jwks_cached_at+F0>a)return o;const{data:h,error:d}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(d)throw d;return!h.keys||h.keys.length===0||(this.jwks=h,this.jwks_cached_at=a,o=h.keys.find(g=>g.kid===r),!o)?null:o}async getClaims(r,n={}){try{let o=r;if(!o){const{data:R,error:A}=await this.getSession();if(A||!R.session)return{data:null,error:A};o=R.session.access_token}const{header:a,payload:h,signature:d,raw:{header:g,payload:v}}=Yc(o);n?.allowExpired||uv(h.exp);const w=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,n?.keys?{keys:n.keys}:n?.jwks);if(!w){const{error:R}=await this.getUser(o);if(R)throw R;return{data:{claims:h,header:a,signature:d},error:null}}const S=dv(a.alg),_=await crypto.subtle.importKey("jwk",w,S,!0,["verify"]);if(!await crypto.subtle.verify(S,_,d,Q0(`${g}.${v}`)))throw new fu("Invalid JWT signature");return{data:{claims:h,header:a,signature:d},error:null}}catch(o){if(Ie(o))return{data:null,error:o};throw o}}}Si.nextInstanceID=0;const jv=Si;class Tv extends jv{constructor(r){super(r)}}var Cv=function(u,r,n,o){function a(h){return h instanceof n?h:new n(function(d){d(h)})}return new(n||(n=Promise))(function(h,d){function g(S){try{w(o.next(S))}catch(_){d(_)}}function v(S){try{w(o.throw(S))}catch(_){d(_)}}function w(S){S.done?h(S.value):a(S.value).then(g,v)}w((o=o.apply(u,r||[])).next())})};class Rv{constructor(r,n,o){var a,h,d;if(this.supabaseUrl=r,this.supabaseKey=n,!r)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const g=D0(r),v=new URL(g);this.realtimeUrl=new URL("realtime/v1",v),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",v),this.storageUrl=new URL("storage/v1",v),this.functionsUrl=new URL("functions/v1",v);const w=`sb-${v.hostname.split(".")[0]}-auth-token`,S={db:N0,realtime:T0,auth:Object.assign(Object.assign({},j0),{storageKey:w}),global:k0},_=A0(o??{},S);this.storageKey=(a=_.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(h=_.global.headers)!==null&&h!==void 0?h:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(T,R)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(R)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((d=_.auth)!==null&&d!==void 0?d:{},this.headers,_.global.fetch),this.fetch=I0(n,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.rest=new qg(new URL("rest/v1",v).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),this.storage=new S0(this.storageUrl.href,this.headers,this.fetch,o?.storage),_.accessToken||this._listenForAuthEvents()}get functions(){return new Lg(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,n={},o={}){return this.rest.rpc(r,n,o)}channel(r,n={config:{}}){return this.realtime.channel(r,n)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,n;return Cv(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:o}=yield this.auth.getSession();return(n=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:n,detectSessionInUrl:o,storage:a,userStorage:h,storageKey:d,flowType:g,lock:v,debug:w},S,_){const T={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Tv({url:this.authUrl.href,headers:Object.assign(Object.assign({},T),S),storageKey:d,autoRefreshToken:r,persistSession:n,detectSessionInUrl:o,storage:a,userStorage:h,flowType:g,lock:v,debug:w,fetch:_,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new c0(this.realtimeUrl.href,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,o)=>{this._handleTokenChanged(n,"CLIENT",o?.access_token)})}_handleTokenChanged(r,n,o){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==o?this.changedAccessToken=o:r==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Ov=(u,r,n)=>new Rv(u,r,n);function Iv(){if(typeof window<"u"||typeof process>"u")return!1;const u=process.version;if(u==null)return!1;const r=u.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}Iv()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Pv="https://huqijhevmtgardkyeowa.supabase.co",Qf="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh1cWlqaGV2bXRnYXJka3llb3dhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcyNDgyNTQsImV4cCI6MjA3MjgyNDI1NH0.1G81Zif1YWQwISEGJw4XMzY89Rlvh6Jda1-j-roPZBk",oe=Ov(Pv,Qf),Ce=Qf!=="YOUR_SUPABASE_ANON_KEY",Dv=Object.freeze(Object.defineProperty({__proto__:null,isSupabaseConfigured:Ce,supabase:oe},Symbol.toStringTag,{value:"Module"})),Yf=k.createContext(void 0),Os=()=>{const u=k.useContext(Yf);if(u===void 0)throw new Error("useAuth must be used within an AuthProvider");return u},Av=({children:u})=>{const[r,n]=k.useState(null),[o,a]=k.useState(null),[h,d]=k.useState(!0);k.useEffect(()=>{oe.auth.getSession().then(({data:{session:R}})=>{a(R),n(R?.user??null),d(!1)});const{data:{subscription:T}}=oe.auth.onAuthStateChange((R,A)=>{a(A),n(A?.user??null),d(!1)});return()=>T.unsubscribe()},[]);const _={user:r,session:o,loading:h,signUp:async(T,R,A)=>{try{const{data:M,error:L}=await oe.auth.signUp({email:T,password:R,options:{data:{full_name:A}}});if(L)return{error:L};if(M.user){const{error:Q}=await oe.from("user_profiles").insert([{user_id:M.user.id,full_name:A,role:"VIEWER"}]);Q&&console.error("Error creating user profile:",Q)}return{error:null}}catch(M){return{error:M}}},signIn:async(T,R)=>{const{error:A}=await oe.auth.signInWithPassword({email:T,password:R});return{error:A}},signOut:async()=>{Object.keys(localStorage).forEach(A=>{A.startsWith("user_role_")&&localStorage.removeItem(A)});const{error:R}=await oe.auth.signOut();R&&console.error("Sign out error:",R)},updateProfile:async T=>{if(!r)return{error:new Error("No user logged in")};const{error:R}=await oe.from("user_profiles").update(T).eq("user_id",r.id);return{error:R}}};return i.jsx(Yf.Provider,{value:_,children:u})},Lv=({isOpen:u,onClose:r,onSuccess:n})=>{const[o,a]=k.useState(!1),[h,d]=k.useState(""),[g,v]=k.useState(""),[w,S]=k.useState(""),[_,T]=k.useState(!1),[R,A]=k.useState(null),{signUp:M,signIn:L}=Os(),Q=async $=>{$.preventDefault(),T(!0),A(null);try{let G;o?G=await M(h,g,w):G=await L(h,g),G.error?A(G.error.message||"An error occurred"):(n(),r())}catch{A("An unexpected error occurred")}finally{T(!1)}},K=()=>{d(""),v(""),S(""),A(null)},B=()=>{a(!o),K()};return u?i.jsxs("div",{className:"bg-slate-800 p-8 rounded-xl shadow-2xl max-w-md w-full border border-slate-700",children:[i.jsx("div",{className:"mb-6",children:i.jsx("h2",{className:"text-2xl font-bold text-white text-center",children:o?"Create Account":"Sign In"})}),i.jsxs("form",{onSubmit:Q,className:"space-y-4",children:[o&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Full Name"}),i.jsx("input",{type:"text",value:w,onChange:$=>S($.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",placeholder:"Enter your full name",required:o})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Email"}),i.jsx("input",{type:"email",value:h,onChange:$=>d($.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",placeholder:"Enter your email",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Password"}),i.jsx("input",{type:"password",value:g,onChange:$=>v($.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",placeholder:"Enter your password",required:!0,minLength:6})]}),R&&i.jsx("div",{className:"bg-red-900 border border-red-700 text-red-200 px-3 py-2 rounded text-sm",children:R}),i.jsx("button",{type:"submit",disabled:_,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors",children:_?"Loading...":o?"Create Account":"Sign In"})]}),i.jsx("div",{className:"mt-4 text-center",children:i.jsx("button",{onClick:B,className:"text-blue-400 hover:text-blue-300 text-sm",children:o?"Already have an account? Sign in":"Don't have an account? Sign up"})}),!o&&i.jsx("div",{className:"mt-3 text-center",children:i.jsx("button",{onClick:()=>{a(!0),K()},className:"text-green-400 hover:text-green-300 text-sm",children:"Create a new account"})}),o&&i.jsx("div",{className:"mt-4 p-3 bg-blue-900 rounded-lg",children:i.jsxs("p",{className:"text-blue-200 text-sm",children:[i.jsx("strong",{children:"Note:"})," After signing up, you'll be able to access the app immediately."]})})]}):null},$v=({onClose:u})=>{const{user:r,signOut:n,updateProfile:o}=Os(),[a,h]=k.useState(null),[d,g]=k.useState(!0),[v,w]=k.useState(!1),[S,_]=k.useState(""),[T,R]=k.useState("VIEWER"),[A,M]=k.useState(!1),L=[{value:"VIEWER",label:"Viewer (Read Only)"},{value:"OPERATOR",label:"Operator (Limited Edit)"},{value:"EDITOR",label:"Editor (Full Access)"}];k.useEffect(()=>{r&&Q()},[r]);const Q=async()=>{if(r)try{const{data:$,error:G}=await oe.from("user_profiles").select("*").eq("user_id",r.id).single();if(G){console.log("No profile found in database, using user metadata:",G);const z={id:r.id,full_name:r.user_metadata?.full_name||r.email||"Unknown",role:r.user_metadata?.role||"VIEWER",email:r.email||"",created_at:r.created_at||new Date().toISOString()};h(z),_(z.full_name),R(z.role)}else h($),_($.full_name||""),R($.role||"VIEWER")}catch($){console.error("Error fetching profile:",$);const G={id:r.id,full_name:r.user_metadata?.full_name||r.email||"Unknown",role:r.user_metadata?.role||"VIEWER",email:r.email||"",created_at:r.created_at||new Date().toISOString()};h(G),_(G.full_name),R(G.role)}finally{g(!1)}},K=async()=>{if(r){M(!0);try{const{error:$}=await o({full_name:S,role:T});if($)console.error("Error updating profile:",$),alert("Error updating profile");else{h(z=>z?{...z,full_name:S,role:T}:null),w(!1);const G=new URLSearchParams(window.location.search).get("eventId")||window.location.pathname.includes("/run-of-show")?"current":null;G&&localStorage.setItem(`user_role_${G}_${r.id}`,T),u&&u()}}catch($){console.error("Error updating profile:",$),alert("Error updating profile")}finally{M(!1)}}},B=async()=>{confirm("Are you sure you want to sign out?")&&await n()};return d?i.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),"Loading..."]}):a?i.jsxs("div",{className:"bg-slate-800 p-4 rounded-lg shadow-2xl w-80 border border-slate-700",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-bold text-white",children:"Profile"}),u&&i.jsx("button",{onClick:u,className:"text-slate-400 hover:text-white transition-colors",children:""})]}),v?i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Full Name"}),i.jsx("input",{type:"text",value:S,onChange:$=>_($.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-sm",placeholder:"Enter your full name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Role"}),i.jsx("select",{value:T,onChange:$=>R($.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-sm",children:L.map($=>i.jsx("option",{value:$.value,children:$.label},$.value))})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:K,disabled:A,className:"flex-1 px-3 py-2 bg-green-600 hover:bg-green-500 disabled:bg-slate-600 text-white text-sm rounded transition-colors",children:A?"Saving...":"Save"}),i.jsx("button",{onClick:()=>w(!1),className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded transition-colors",children:"Cancel"})]})]}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center text-white font-medium",children:(a.full_name||"U").charAt(0).toUpperCase()}),i.jsxs("div",{children:[i.jsx("div",{className:"text-white font-medium",children:a.full_name}),i.jsx("div",{className:"text-slate-400 text-sm",children:a.role}),i.jsx("div",{className:"text-slate-500 text-xs",children:r?.email})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>w(!0),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Edit Profile"}),i.jsx("button",{onClick:B,className:"px-3 py-2 bg-red-600 hover:bg-red-500 text-white text-sm rounded transition-colors",title:"Sign out",children:"Sign Out"})]})]})]}):i.jsx("div",{className:"text-slate-300",children:"Profile not found"})},mu=()=>{const{user:u,signOut:r}=Os(),[n,o]=k.useState(!1);return i.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-slate-800 border-b border-slate-700 px-6 py-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"flex items-center gap-4",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:i.jsx("span",{className:"text-white font-bold text-lg",children:"R"})}),i.jsx("h1",{className:"text-xl font-bold text-white",children:"Run of Show"})]})}),u?i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("p",{className:"text-white font-semibold text-base",children:u.user_metadata?.full_name||u.email}),i.jsx("p",{className:"text-slate-300 text-xs",children:u.email})]}),i.jsx("button",{onClick:()=>{confirm("Are you sure you want to sign out?")&&r()},className:"px-3 py-1.5 bg-red-600 hover:bg-red-500 text-white text-sm rounded-md transition-colors",title:"Sign out",children:"Sign Out"})]}):i.jsx("div",{className:"flex items-center gap-4",children:i.jsx("div",{className:"text-slate-400 text-sm",children:"Please sign in to continue"})}),n&&i.jsx("div",{className:"absolute top-16 right-6 z-50",children:i.jsx($v,{onClose:()=>o(!1)})})]})})},Mv=({children:u})=>{const{user:r,loading:n}=Os(),[o,a]=Ja.useState(!1);return Ja.useEffect(()=>{!n&&!r?a(!0):r&&a(!1)},[r,n]),n?i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 pt-16",children:[i.jsx(mu,{}),i.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-80px)]",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),i.jsx("p",{className:"text-slate-300",children:"Loading..."})]})})]}):r?i.jsx(i.Fragment,{children:u}):i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 pt-16",children:[i.jsx(mu,{}),i.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-80px)]",children:i.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[i.jsxs("div",{className:"mb-8",children:[i.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[i.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center",children:i.jsx("span",{className:"text-white font-bold text-2xl",children:"R"})}),i.jsx("h1",{className:"text-4xl font-bold text-white",children:"Run of Show"})]}),i.jsx("p",{className:"text-slate-300 text-lg",children:"Please sign in to access the Run of Show application."})]}),i.jsx(Lv,{isOpen:o,onClose:()=>{},onSuccess:()=>{a(!1)}}),i.jsx("div",{className:"mt-4 text-center",children:i.jsx("button",{onClick:()=>a(!0),className:"text-blue-400 hover:text-blue-300 text-sm underline",children:"Already have an account? Sign in here"})})]})})]})},eu=[{value:"Great Hall",label:"Great Hall",color:"bg-blue-600"},{value:"Briefing Center",label:"Briefing Center",color:"bg-green-600"},{value:"Lee Anderson",label:"Lee Anderson",color:"bg-purple-600"},{value:"Virtual Show",label:"Virtual Show",color:"bg-orange-600"},{value:"Off Site",label:"Off Site",color:"bg-red-600"}],mf=[1,2,3,4,5];class Se{static async saveCalendarEvent(r){try{console.log(" Saving calendar event to Supabase:",r);const{data:n,error:o}=await oe.from("calendar_events").insert([r]).select().single();return o?(console.error("Error saving calendar event:",o),this.saveCalendarToLocalStorage(r)):(console.log(" Calendar event saved to Supabase:",n),n)}catch(n){return console.error("Error saving calendar event:",n),this.saveCalendarToLocalStorage(r)}}static async getCalendarEvents(){try{console.log(" Loading calendar events from Supabase...");const{data:r,error:n}=await oe.from("calendar_events").select("*").order("date",{ascending:!1});return n?(console.error("Error fetching calendar events:",n),this.getCalendarFromLocalStorage()):(console.log(" Calendar events loaded from Supabase:",r?.length||0),r||[])}catch(r){return console.error("Error fetching calendar events:",r),this.getCalendarFromLocalStorage()}}static async getCalendarEvent(r){try{const{data:n,error:o}=await oe.from("calendar_events").select("*").eq("id",r).single();return o?(console.error("Error fetching calendar event:",o),this.getCalendarFromLocalStorageById(r)):n}catch(n){return console.error("Error fetching calendar event:",n),this.getCalendarFromLocalStorageById(r)}}static async deleteCalendarEvent(r){try{const{error:n}=await oe.from("calendar_events").delete().eq("id",r);return n?(console.error("Error deleting calendar event:",n),this.deleteCalendarFromLocalStorage(r)):!0}catch(n){return console.error("Error deleting calendar event:",n),this.deleteCalendarFromLocalStorage(r)}}static async logChange(r,n,o,a,h,d,g,v,w,S,_,T,R,A){try{console.log("Calling log_change with parameters:",{p_event_id:r,p_user_id:n,p_user_name:o,p_user_role:a,p_action:h,p_table_name:d,p_record_id:g,p_field_name:v,p_row_number:T,p_cue_number:R});const M={p_event_id:r,p_user_id:n,p_user_name:o,p_user_role:a,p_action:h,p_table_name:d,p_record_id:g||null,p_field_name:v||null,p_old_value:w?JSON.stringify(w):null,p_new_value:S?JSON.stringify(S):null,p_description:_||null,p_metadata:A||{},p_row_number:T||null,p_cue_number:R||null};console.log("Calling log_change with cleaned parameters:",M);const{data:L,error:Q}=await oe.rpc("log_change",M);return Q?(console.error(" Error logging change:",Q),console.error(" Parameters that caused error:",M),null):(console.log(" Change logged:",{action:h,tableName:d,recordId:g,changeId:L}),L)}catch(M){return console.error("Error logging change:",M),null}}static async logFieldChanges(r,n,o,a,h,d,g,v){try{for(const w of g)await this.logChange(r,n,o,a,"UPDATE",h,d,w.fieldName,w.oldValue,w.newValue,v)}catch(w){console.error("Error logging field changes:",w)}}static async getChangeLog(r,n=50,o=0){try{const{data:a,error:h}=await oe.rpc("get_change_log",{p_event_id:r,p_limit:n,p_offset:o});return h?(console.error(" Error fetching change log:",h),[]):a||[]}catch(a){return console.error("Error fetching change log:",a),[]}}static async getRecordChangeLog(r,n,o,a=20){try{const{data:h,error:d}=await oe.rpc("get_record_change_log",{p_event_id:r,p_table_name:n,p_record_id:o,p_limit:a});return d?(console.error(" Error fetching record change log:",d),[]):h||[]}catch(h){return console.error("Error fetching record change log:",h),[]}}static async getChangeLogSummary(r){try{const{data:n,error:o}=await oe.rpc("get_change_log_summary",{p_event_id:r});return o?(console.error(" Error fetching change log summary:",o),null):n?.[0]||null}catch(n){return console.error("Error fetching change log summary:",n),null}}static async cleanupOldChangeLogs(){try{const{data:r,error:n}=await oe.rpc("cleanup_old_change_logs");return n?(console.error(" Error cleaning up old change logs:",n),0):(console.log(" Cleaned up old change logs:",r),r||0)}catch(r){return console.error("Error cleaning up old change logs:",r),0}}static async saveRunOfShowData(r,n){try{console.log(" Saving run of show data to Supabase:",{eventId:r.event_id,scheduleItemsCount:r.schedule_items?.length||0,customColumnsCount:r.custom_columns?.length||0,settingsKeys:Object.keys(r.settings||{}),userInfo:n?`${n.userName} (${n.userRole})`:"No user info"});const o={...r,last_modified_by:n?.userId,last_modified_by_name:n?.userName,last_modified_by_role:n?.userRole,updated_at:new Date().toISOString()},{data:a,error:h}=await oe.from("run_of_show_data").select("*").eq("event_id",r.event_id).single();let d;if(a&&!h){console.log(" Updating existing record for event:",r.event_id);const{data:g,error:v}=await oe.from("run_of_show_data").update({event_name:o.event_name,event_date:o.event_date,schedule_items:o.schedule_items,custom_columns:o.custom_columns,settings:o.settings,last_modified_by:o.last_modified_by,last_modified_by_name:o.last_modified_by_name,last_modified_by_role:o.last_modified_by_role,updated_at:o.updated_at}).eq("event_id",r.event_id).select().single();if(v)throw console.error(" Error updating run of show data:",v),v;d=g}else{console.log(" Inserting new record for event:",r.event_id);const{data:g,error:v}=await oe.from("run_of_show_data").insert([o]).select().single();if(v)throw console.error(" Error inserting run of show data:",v),v;d=g}return console.log(" Run of show data saved to Supabase successfully"),d}catch(o){console.error(" Error saving run of show data:",o),console.error(" Error details:",o.message,o.details,o.hint);const a={...r,last_modified_by:n?.userId,last_modified_by_name:n?.userName,last_modified_by_role:n?.userRole,updated_at:new Date().toISOString()};return this.saveRunOfShowToLocalStorage(a)}}static async getRunOfShowData(r){try{console.log(" Loading run of show data from Supabase for event:",r);const{data:n,error:o}=await oe.from("run_of_show_data").select("*").eq("event_id",r).single();return o?(console.error("Error fetching run of show data:",o),this.getRunOfShowFromLocalStorageById(r)):(console.log(" Run of show data loaded from Supabase:",n?"Found":"Not found"),n)}catch(n){return console.error("Error fetching run of show data:",n),this.getRunOfShowFromLocalStorageById(r)}}static async deleteRunOfShowData(r){try{const{error:n}=await oe.from("run_of_show_data").delete().eq("event_id",r);return n?(console.error("Error deleting run of show data:",n),this.deleteRunOfShowFromLocalStorage(r)):!0}catch(n){return console.error("Error deleting run of show data:",n),this.deleteRunOfShowFromLocalStorage(r)}}static saveCalendarToLocalStorage(r){const n=this.getCalendarFromLocalStorage(),o={...r,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return n.unshift(o),localStorage.setItem("calendar_events",JSON.stringify(n)),console.log(" Calendar event saved to localStorage"),o}static getCalendarFromLocalStorage(){try{const r=localStorage.getItem("calendar_events"),n=r?JSON.parse(r):[];return console.log(" Calendar events loaded from localStorage:",n.length),n}catch(r){return console.error("Error reading from localStorage:",r),[]}}static getCalendarFromLocalStorageById(r){return this.getCalendarFromLocalStorage().find(o=>o.id===r)||null}static deleteCalendarFromLocalStorage(r){try{const o=this.getCalendarFromLocalStorage().filter(a=>a.id!==r);return localStorage.setItem("calendar_events",JSON.stringify(o)),!0}catch(n){return console.error("Error deleting from localStorage:",n),!1}}static saveRunOfShowToLocalStorage(r){const n=this.getAllRunOfShowFromLocalStorage(),o={...r,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()},a=n.findIndex(h=>h.event_id===r.event_id);return a>=0?n[a]=o:n.push(o),localStorage.setItem("run_of_show_data",JSON.stringify(n)),console.log(" Run of show data saved to localStorage"),o}static getAllRunOfShowFromLocalStorage(){try{const r=localStorage.getItem("run_of_show_data");return r?JSON.parse(r):[]}catch(r){return console.error("Error reading run of show data from localStorage:",r),[]}}static getRunOfShowFromLocalStorageById(r){return this.getAllRunOfShowFromLocalStorage().find(o=>o.event_id===r)||null}static deleteRunOfShowFromLocalStorage(r){try{const o=this.getAllRunOfShowFromLocalStorage().filter(a=>a.event_id!==r);return localStorage.setItem("run_of_show_data",JSON.stringify(o)),!0}catch(n){return console.error("Error deleting run of show data from localStorage:",n),!1}}static async saveUserSession(r,n,o,a){try{console.log(" Saving authenticated user session:",{eventId:r,userId:n,username:o,role:a});const{data:h,error:d}=await oe.rpc("get_or_create_user_session",{p_user_id:n,p_event_id:r,p_user_role:a});return d?(console.error(" Supabase error saving user session:",d),console.error(" Error details:",d.message,d.details,d.hint),this.saveUserSessionToLocalStorage(r,o,a)):(console.log(" Authenticated user session saved to Supabase:",h),!0)}catch(h){return console.error("Error saving user session:",h),this.saveUserSessionToLocalStorage(r,o,a)}}static async getCurrentUserSession(r){try{const{data:n,error:o}=await oe.from("user_sessions").select("id, event_id, user_role").eq("user_id",r).order("created_at",{ascending:!1}).limit(1);return o?(console.error(" Error getting current user session:",o),this.getCurrentUserSessionFromLocalStorage()):n?.[0]||null}catch(n){return console.error("Error getting current user session:",n),this.getCurrentUserSessionFromLocalStorage()}}static async updateUserActivity(r){try{const{error:n}=await oe.rpc("update_user_activity",{p_user_id:r});n&&console.error(" Error updating user activity:",n)}catch(n){console.error("Error updating user activity:",n)}}static async cleanupInactiveSessions(){try{const{data:r,error:n}=await oe.rpc("cleanup_inactive_sessions");n?console.error(" Error cleaning up inactive sessions:",n):console.log(" Cleaned up inactive sessions:",r)}catch(r){console.error("Error cleaning up inactive sessions:",r)}}static saveUserSessionToLocalStorage(r,n,o){try{const a={event_id:r,username:n,role:o,session_started_at:new Date().toISOString(),last_activity_at:new Date().toISOString(),is_active:!0};return localStorage.setItem(`current_user_session_${n}`,JSON.stringify(a)),localStorage.setItem(`user_role_${r}_${n}`,o),console.log(" User session saved to localStorage"),!0}catch(a){return console.error("Error saving user session to localStorage:",a),!1}}static getCurrentUserSessionFromLocalStorage(){try{const r=Object.keys(localStorage);let n=null,o=0;for(const a of r)if(a.startsWith("current_user_session_")){const h=JSON.parse(localStorage.getItem(a)||"{}");if(h.is_active&&h.last_activity_at){const d=new Date(h.last_activity_at).getTime();d>o&&(o=d,n=h)}}return n}catch(r){return console.error("Error getting current user session from localStorage:",r),null}}static async loadCue(r,n,o,a,h,d,g){try{const{data:v,error:w}=await oe.rpc("load_cue_for_event",{p_event_id:r,p_item_id:n.toString(),p_user_id:o,p_duration_seconds:a,p_row_is:h||null,p_cue_is:d||null,p_timer_id:g||null});return w?(console.error(" Error loading CUE in Supabase:",w),console.error(" Error details:",w.message,w.details,w.hint),console.error(" Error code:",w.code),(w.code==="PGRST204"||w.message.includes("Could not find"))&&console.warn(" Timer functions do not exist. Please run the optimized-timer-schema.sql migration script first."),!1):(console.log(" CUE loaded in Supabase:",v),v)}catch(v){return console.error(" Error loading CUE:",v),!1}}static async startTimer(r,n,o,a,h,d,g,v){try{const{data:w,error:S}=await oe.rpc("start_timer_for_event",{p_event_id:r,p_item_id:n.toString(),p_user_id:o,p_row_is:d||null,p_cue_is:g||null,p_timer_id:v||null});return S?(console.error(" Error starting timer in Supabase:",S),console.error(" Error details:",S.message,S.details,S.hint),console.error(" Error code:",S.code),!1):(console.log(" Timer started in Supabase (UPSERT):",w),!0)}catch(w){return console.error("Error starting timer:",w),!1}}static async stopTimer(r,n,o){try{const{data:a,error:h}=await oe.from("active_timers").update({is_running:!1,is_active:!1,timer_state:"stopped"}).eq("event_id",r).select();return h?(console.error(" Error stopping timer in Supabase:",h),!1):(console.log(" Timer stopped in Supabase:",a),!0)}catch(a){return console.error("Error stopping timer:",a),!1}}static async updateTimerDuration(r,n,o){try{console.log(` Updating timer duration for event ${r}, item ${n} to ${o}s`);const{data:a,error:h}=await oe.from("active_timers").update({duration_seconds:o}).eq("event_id",r).eq("item_id",n);return h?(console.error(" Error updating timer duration in Supabase:",h),!1):(console.log(" Timer duration updated in Supabase:",a),!0)}catch(a){return console.error("Error updating timer duration:",a),!1}}static async stopAllTimersForEvent(r,n){try{const{data:o,error:a}=await oe.rpc("stop_timer_for_event",{p_event_id:r});return a?(console.error(" Error stopping all timers in Supabase:",a),!1):(console.log(" All timers stopped in Supabase"),!0)}catch(o){return console.error("Error stopping all timers:",o),!1}}static async getActiveTimer(r){try{const{data:n,error:o}=await oe.rpc("get_active_timer_for_event",{p_event_id:r});return o?(console.error(" Error getting active timer from Supabase:",o),null):n?.[0]||null}catch(n){return console.error("Error getting active timer:",n),null}}static subscribeToTimerChanges(r,n){return oe.channel("active_timers_changes").on("postgres_changes",{event:"*",schema:"public",table:"active_timers",filter:`event_id=eq.${r}`},n).subscribe()}static async hasActiveSubCueTimer(r){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping has active sub-cue timer check"),{data:!1,error:null};const{data:n,error:o}=await oe.rpc("has_active_sub_cue_timer_for_event",{p_event_id:r});return o?(console.error(" Error checking active sub-cue timer:",o),{data:!1,error:o}):{data:n||!1,error:null}}catch(n){return console.error(" Error checking active sub-cue timer:",n),{data:!1,error:n}}}static async getActiveSubCueTimer(r){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping get active sub-cue timer"),{data:null,error:null};const{data:n,error:o}=await oe.rpc("get_active_sub_cue_timers_for_event",{p_event_id:r});return o?(console.error(" Error getting active sub-cue timer:",o),{data:null,error:o}):{data:n?.[0]||null,error:null}}catch(n){return console.error(" Error getting active sub-cue timer:",n),{data:null,error:n}}}static async getActiveSubCueTimers(r){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping get active sub-cue timers"),{data:null,error:null};const{data:n,error:o}=await oe.rpc("get_active_sub_cue_timers_for_event",{p_event_id:r});return o?(console.error(" Error getting active sub-cue timers:",o),{data:null,error:o}):{data:n,error:null}}catch(n){return console.error(" Error getting active sub-cue timers:",n),{data:null,error:n}}}static async startSubCueTimer(r,n,o,a,h,d,g){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping start sub-cue timer"),{data:null,error:null};console.log(" Calling start_sub_cue_timer_for_event with params:",{p_event_id:r,p_item_id:n.toString(),p_user_id:o,p_duration_seconds:a,p_row_is:h,p_cue_is:d,p_timer_id:g}),console.log(" About to call RPC function...");const{data:v,error:w}=await oe.rpc("start_sub_cue_timer_for_event",{p_event_id:r,p_item_id:n.toString(),p_user_id:o,p_duration_seconds:a,p_row_is:h||null,p_cue_is:d||null,p_timer_id:g||null});return console.log(" RPC response:",{data:v,error:w}),w?(console.error(" Error starting sub-cue timer:",w),console.error(" Error details:",JSON.stringify(w,null,2)),{data:null,error:w}):{data:v,error:null}}catch(v){return console.error(" Error starting sub-cue timer:",v),{data:null,error:v}}}static async expireCompletedSubCueTimers(){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping expire completed sub-cue timers"),{data:0,error:null};const{data:r,error:n}=await oe.rpc("expire_completed_sub_cue_timers");return n?(console.error(" Error expiring completed sub-cue timers:",n),{data:0,error:n}):{data:r||0,error:null}}catch(r){return console.error(" Error expiring completed sub-cue timers:",r),{data:0,error:r}}}static async stopSubCueTimer(r,n){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping stop sub-cue timer"),{data:null,error:null};const{data:o,error:a}=await oe.rpc("stop_sub_cue_timer_for_event",{p_event_id:r,p_item_id:null});return a?(console.error(" Error stopping sub-cue timer:",a),console.error(" Error details:",JSON.stringify(a,null,2)),{data:null,error:a}):{data:o,error:null}}catch(o){return console.error(" Error stopping sub-cue timer:",o),{data:null,error:o}}}static async getActiveSecondaryTimer(r){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping get active secondary timer"),{data:null,error:null};const{data:n,error:o}=await oe.rpc("get_active_secondary_timer_for_event",{p_event_id:r});return o?(console.error(" Error getting active secondary timer:",o),{data:null,error:o}):{data:n&&n.length>0?n[0]:null,error:null}}catch(n){return console.error(" Error getting active secondary timer:",n),{data:null,error:n}}}static async startSecondaryTimer(r,n,o,a){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping start secondary timer"),{data:null,error:null};const{data:h,error:d}=await oe.rpc("start_secondary_timer_for_event",{p_event_id:r,p_item_id:n,p_user_id:o,p_duration_seconds:a});return d?(console.error(" Error starting secondary timer:",d),{data:null,error:d}):{data:h,error:null}}catch(h){return console.error(" Error starting secondary timer:",h),{data:null,error:h}}}static async stopSecondaryTimer(r){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping stop secondary timer"),{data:null,error:null};const{data:n,error:o}=await oe.rpc("stop_secondary_timer_for_event",{p_event_id:r});return o?(console.error(" Error stopping secondary timer:",o),{data:null,error:o}):{data:n,error:null}}catch(n){return console.error(" Error stopping secondary timer:",n),{data:null,error:n}}}static async updateSecondaryTimerRemaining(r,n){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping update secondary timer remaining"),{data:null,error:null};const{data:o,error:a}=await oe.rpc("update_secondary_timer_remaining",{p_event_id:r,p_remaining_seconds:n});return a?(console.error(" Error updating secondary timer remaining:",a),{data:null,error:a}):{data:o,error:null}}catch(o){return console.error(" Error updating secondary timer remaining:",o),{data:null,error:o}}}static async updateSubCueTimerRemaining(r,n,o){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping update sub-cue timer remaining"),!1;const{error:a}=await oe.from("sub_cue_timers").update({remaining_seconds:o,updated_at:new Date().toISOString()}).eq("event_id",r).eq("item_id",n.toString()).eq("is_active",!0);return a?(console.error(" Error updating sub-cue timer remaining time:",a),!1):!0}catch(a){return console.error("Error updating sub-cue timer remaining time:",a),!1}}static async clearAllActiveTimersForEvent(r){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping clear all active timers"),!1;console.log(" Clearing all active timers for event:",r);const{error:n}=await oe.from("active_timers").delete().eq("event_id",r);return n?(console.error(" Error clearing all active timers:",n),!1):(console.log(" All active timers cleared for event:",r),!0)}catch(n){return console.error(" Error clearing all active timers:",n),!1}}static async getCompletedCues(r){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping get completed cues"),null;const{data:n,error:o}=await oe.rpc("get_completed_cues_for_event",{p_event_id:r});if(o)throw o;return n}catch(n){return console.error(" Error getting completed cues:",n),null}}static async markCueCompleted(r,n,o,a,h,d){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping mark cue completed"),!1;console.log(" Calling mark_cue_completed RPC with:",{p_event_id:r,p_item_id:n,p_user_id:a});const{data:g,error:v}=await oe.from("completed_cues").insert({event_id:r,item_id:n,user_id:a,cue_id:o,user_name:h,user_role:d,completed_at:new Date().toISOString()});if(v)throw console.error(" Insert error:",v),console.error(" Error details:",v.message,v.details,v.hint),v;return console.log(" Cue marked as completed successfully:",{eventId:r,itemId:n,data:g}),!0}catch(g){return console.error(" Error marking cue as completed:",g),!1}}static async unmarkCueCompleted(r,n){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping unmark cue completed"),!1;const{data:o,error:a}=await oe.rpc("unmark_cue_completed",{p_event_id:r,p_item_id:n});if(a)throw a;return console.log(" Cue unmarked as completed:",{eventId:r,itemId:n}),!0}catch(o){return console.error(" Error unmarking cue as completed:",o),!1}}static async clearCompletedCues(r){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping clear completed cues"),!1;const{data:n,error:o}=await oe.rpc("clear_completed_cues_for_event",{p_event_id:r});if(o)throw o;return console.log(" Cleared all completed cues for event:",r),!0}catch(n){return console.error(" Error clearing completed cues:",n),!1}}static subscribeToTableChanges(r,n,o){try{if(!Ce||!oe)return console.error(" Supabase client not initialized"),null;const a=o?`event_id=eq.${o}`:void 0;return oe.channel(`${r}_changes`).on("postgres_changes",{event:"*",schema:"public",table:r,filter:a},n).subscribe()}catch(a){return console.error(` Error setting up ${r} subscription:`,a),null}}static async updateLastLoadedCue(r,n,o){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping update last loaded CUE"),{data:null,error:null};const{data:a,error:h}=await oe.rpc("update_last_loaded_cue",{p_event_id:r,p_cue_id:n,p_state:o});return h?(console.error(" Error updating last loaded CUE:",h),{data:null,error:h}):{data:a,error:null}}catch(a){return console.error(" Error updating last loaded CUE:",a),{data:null,error:a}}}static async getLastLoadedCue(r){try{if(!Ce||!oe)return console.warn(" Supabase client not initialized, skipping get last loaded CUE"),{data:null,error:null};const{data:n,error:o}=await oe.rpc("get_last_loaded_cue",{p_event_id:r});return o?(console.error(" Error getting last loaded CUE:",o),{data:null,error:o}):{data:n,error:null}}catch(n){return console.error(" Error getting last loaded CUE:",n),{data:null,error:n}}}static async saveTimerMessage(r){try{console.log(" Saving timer message to Supabase:",r);const{data:n,error:o}=await oe.from("timer_messages").insert([r]).select().single();return o?(console.error("Error saving timer message:",o),this.saveTimerMessageToLocalStorage(r)):(console.log(" Timer message saved to Supabase:",n),n)}catch(n){return console.error(" Error saving timer message:",n),this.saveTimerMessageToLocalStorage(r)}}static async getTimerMessage(r){try{const{data:n,error:o}=await oe.rpc("get_latest_timer_message",{p_event_id:r});return o?(console.error("Error loading timer message:",o),this.getTimerMessageFromLocalStorage(r)):n?.[0]||null}catch(n){return console.error(" Error loading timer message:",n),this.getTimerMessageFromLocalStorage(r)}}static async updateTimerMessage(r,n){try{const{error:o}=await oe.from("timer_messages").update(n).eq("id",r);return o?(console.error("Error updating timer message:",o),this.updateTimerMessageInLocalStorage(r,n)):!0}catch(o){return console.error(" Error updating timer message:",o),this.updateTimerMessageInLocalStorage(r,n)}}static async disableTimerMessage(r){return this.updateTimerMessage(r,{enabled:!1})}static async getTimerMessagesForEvent(r){try{const{data:n,error:o}=await oe.from("timer_messages").select("*").eq("event_id",r).order("created_at",{ascending:!1});return o?(console.error("Error loading timer messages:",o),this.getTimerMessagesFromLocalStorage().filter(a=>a.event_id===r)):n||[]}catch(n){return console.error(" Error loading timer messages:",n),this.getTimerMessagesFromLocalStorage().filter(o=>o.event_id===r)}}static saveTimerMessageToLocalStorage(r){const n=this.getTimerMessagesFromLocalStorage(),o={...r,id:`local_${Date.now()}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return n.push(o),localStorage.setItem("timer_messages",JSON.stringify(n)),o}static getTimerMessagesFromLocalStorage(){try{const r=localStorage.getItem("timer_messages");return r?JSON.parse(r):[]}catch(r){return console.error("Error loading timer messages from localStorage:",r),[]}}static getTimerMessageFromLocalStorage(r){return this.getTimerMessagesFromLocalStorage().find(o=>o.event_id===r&&o.enabled)||null}static updateTimerMessageInLocalStorage(r,n){try{const o=this.getTimerMessagesFromLocalStorage(),a=o.findIndex(h=>h.id===r);return a!==-1?(o[a]={...o[a],...n,updated_at:new Date().toISOString()},localStorage.setItem("timer_messages",JSON.stringify(o)),!0):!1}catch(o){return console.error("Error updating timer message in localStorage:",o),!1}}}const Xf=({isOpen:u,onClose:r,onRoleSelected:n,eventId:o})=>{const{user:a}=Os(),[h,d]=k.useState("VIEWER"),[g,v]=k.useState(!1);k.useEffect(()=>{if(u&&a?.id&&o){const _=localStorage.getItem(`user_role_${o}_${a.id}`);_&&["VIEWER","EDITOR","OPERATOR"].includes(_)&&d(_)}},[u,a?.id,o]);const w=[{value:"VIEWER",label:"Viewer (Read Only)",description:"Can view but cannot edit any content",icon:""},{value:"OPERATOR",label:"Operator (Limited Edit)",description:"Can control timers and view data",icon:""},{value:"EDITOR",label:"Editor (Full Access)",description:"Can edit all content and settings",icon:""}],S=async()=>{if(!(!a||!o)){v(!0);try{await Se.saveUserSession(o,a.id,a.user_metadata?.full_name||a.email||"Unknown",h)?(n(h),r()):alert("Failed to save user session. Please try again.")}catch(_){console.error("Error saving user session:",_),alert("Error saving user session. Please try again.")}finally{v(!1)}}};return u?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[9999] p-4",children:i.jsxs("div",{className:"bg-slate-800 p-8 rounded-xl shadow-2xl max-w-2xl w-full",children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Select Your Role"}),i.jsxs("p",{className:"text-slate-300 text-lg",children:["Welcome, ",a?.user_metadata?.full_name||a?.email,"! Please select your role for this session."]})]}),i.jsx("div",{className:"space-y-4 mb-8",children:w.map(_=>i.jsxs("label",{className:`flex items-start gap-4 cursor-pointer p-4 rounded-lg border-2 transition-colors ${h===_.value?"border-blue-500 bg-blue-900/20":"border-slate-600 hover:border-blue-400"}`,children:[i.jsx("input",{type:"radio",name:"role",value:_.value,checked:h===_.value,onChange:T=>d(T.target.value),className:"w-5 h-5 text-blue-600 mt-1"}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"text-2xl",children:_.icon}),i.jsx("span",{className:"text-white font-bold text-lg",children:_.label})]}),i.jsx("p",{className:"text-slate-300 text-sm",children:_.description})]})]},_.value))}),i.jsxs("div",{className:"flex gap-4",children:[i.jsx("button",{onClick:S,disabled:g,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors",children:g?"Loading...":"Continue with Selected Role"}),i.jsx("button",{onClick:r,className:"px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]}),i.jsx("div",{className:"mt-4 p-3 bg-blue-900 rounded-lg",children:i.jsxs("p",{className:"text-blue-200 text-sm",children:[i.jsx("strong",{children:"Note:"})," You can change your role later from your profile menu."]})})]})}):null},Uv=()=>{const u=To(),{user:r}=Os(),[n,o]=k.useState([]),[a,h]=k.useState("upcoming"),[d,g]=k.useState(!1),[v,w]=k.useState("all"),[S,_]=k.useState("all"),[T,R]=k.useState({name:"",date:"",location:"Great Hall",numberOfDays:1}),[A,M]=k.useState(!1),[L,Q]=k.useState(null);k.useEffect(()=>{K()},[]);const K=async()=>{try{console.log(" Loading events from Supabase...");const q=await Se.getCalendarEvents();if(q&&q.length>0){const Y=q.map(ce=>({id:ce.id||Date.now().toString(),name:ce.name,date:ce.date,location:ce.schedule_data?.location||"Great Hall",numberOfDays:ce.schedule_data?.numberOfDays||1,created_at:ce.created_at||new Date().toISOString(),updated_at:ce.updated_at||new Date().toISOString()}));o(Y),console.log(" Loaded events from Supabase:",Y.length)}else{console.log(" No events found in Supabase, trying localStorage...");const Y=localStorage.getItem("events");if(Y)try{const ce=JSON.parse(Y);o(ce),console.log("Loaded events from localStorage:",ce.length)}catch(ce){console.error("Error loading events from localStorage:",ce)}}}catch(q){console.error("Error loading events from Supabase:",q);const Y=localStorage.getItem("events");if(Y)try{const ce=JSON.parse(Y);o(ce)}catch(ce){console.error("Error loading events from localStorage:",ce)}}};k.useEffect(()=>{localStorage.setItem("events",JSON.stringify(n))},[n]);const B=async()=>{if(!T.name||!T.date||!T.location){alert("Please fill in all fields");return}const Y={id:`event-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:T.name,date:T.date,location:T.location,numberOfDays:T.numberOfDays,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};g(!1),R({name:"",date:"",location:"Great Hall",numberOfDays:1}),o(ce=>[...ce,Y]);try{const ce={name:Y.name,date:Y.date,schedule_data:{location:Y.location,numberOfDays:Y.numberOfDays,eventId:Y.id}};await Se.saveCalendarEvent(ce),console.log("Calendar event saved to Supabase with ID:",Y.id),await Se.saveRunOfShowData({event_id:Y.id,event_name:Y.name,event_date:Y.date,schedule_items:[],custom_columns:[],settings:{eventName:Y.name,masterStartTime:"",lastSaved:new Date().toISOString()}},{userId:r?.id||"unknown",userName:r?.user_metadata?.full_name||r?.email||"Unknown User",userRole:"EDITOR"}),console.log("Run of Show data created in Supabase with ID:",Y.id)}catch(ce){console.error("Error auto-saving event to Supabase:",ce)}},$=async q=>{if(window.confirm("Are you sure you want to delete this event?")){o(Y=>Y.filter(ce=>ce.id!==q));try{const Y=n.find(ce=>ce.id===q);if(Y){await Se.deleteRunOfShowData(q),console.log("Run of Show data deleted from Supabase automatically");const ke=(await Se.getCalendarEvents()).find(De=>De.schedule_data?.eventId===q||De.name===Y.name);ke?.id&&(await Se.deleteCalendarEvent(ke.id),console.log("Calendar event deleted from Supabase automatically"))}}catch(Y){console.error("Error auto-deleting event from Supabase:",Y)}}},G=q=>{Q(q),M(!0)},z=async q=>{if(L&&r?.id){try{const Y=r.user_metadata?.full_name||r.email||"Unknown";await Se.saveUserSession(L.id,r.id,Y,q),console.log(" Role saved to Supabase from EventListPage:",q)}catch(Y){console.error(" Failed to save role to Supabase from EventListPage:",Y)}u("/run-of-show",{state:{event:L,userRole:q}}),M(!1),Q(null)}},ne=q=>{const Y=eu.find(ce=>ce.value===q);return Y?Y.color:"bg-gray-600"},ae=q=>new Date(q).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),Z=(()=>{const q=new Date;return n.filter(Y=>{const ce=new Date(Y.date),ke=a==="upcoming"?ce>=q:ce<q,De=v==="all"||Y.location===v,et=S==="all"||Y.numberOfDays.toString()===S;return ke&&De&&et}).sort((Y,ce)=>{const ke=new Date(Y.date),De=new Date(ce.date);return a==="upcoming"?ke.getTime()-De.getTime():De.getTime()-ke.getTime()})})();return i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 text-slate-200 pt-16",children:[i.jsxs("div",{className:"text-center py-8",children:[i.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:" Event List Calendar"}),i.jsx("p",{className:"text-xl text-slate-400 mb-4",children:"Manage your events and schedules"}),r&&i.jsx("div",{className:"text-center mb-6",children:i.jsxs("p",{className:"text-white font-medium text-lg",children:["Welcome back, ",r.user_metadata?.full_name||r.email,"!"]})})]}),i.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[i.jsx("div",{className:"flex justify-center mb-8",children:i.jsxs("div",{className:"bg-slate-800 rounded-lg p-1 flex",children:[i.jsx("button",{onClick:()=>h("upcoming"),className:`px-6 py-3 rounded-md font-semibold transition-colors ${a==="upcoming"?"bg-green-600 text-white":"text-slate-400 hover:text-white"}`,children:" Upcoming Events"}),i.jsx("button",{onClick:()=>h("past"),className:`px-6 py-3 rounded-md font-semibold transition-colors ${a==="past"?"bg-orange-600 text-white":"text-slate-400 hover:text-white"}`,children:" Past Events"})]})}),i.jsx("div",{className:"flex justify-center mb-6",children:i.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 flex gap-4 items-center",children:[i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("span",{className:"text-white font-semibold",children:"Filter by:"})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-slate-300",children:"Location:"}),i.jsxs("select",{value:v,onChange:q=>w(q.target.value),className:"px-3 py-1 bg-slate-700 border border-slate-600 rounded text-white text-sm",children:[i.jsx("option",{value:"all",children:"All Locations"}),eu.map(q=>i.jsx("option",{value:q.value,children:q.label},q.value))]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-slate-300",children:"Days:"}),i.jsxs("select",{value:S,onChange:q=>_(q.target.value),className:"px-3 py-1 bg-slate-700 border border-slate-600 rounded text-white text-sm",children:[i.jsx("option",{value:"all",children:"All Durations"}),mf.map(q=>i.jsxs("option",{value:q.toString(),children:[q," day",q>1?"s":""]},q))]})]})]})}),i.jsx("div",{className:"flex justify-center mb-8",children:i.jsx("button",{onClick:()=>g(!0),className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors",children:"+ Add New Event"})}),i.jsx("div",{className:"bg-slate-800 rounded-xl p-6 shadow-2xl",children:i.jsx("div",{className:"bg-slate-800 rounded-lg overflow-hidden border border-slate-600",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-slate-700",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Event Name"}),i.jsx("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Date"}),i.jsx("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Location"}),i.jsx("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Duration"}),i.jsx("th",{className:"px-4 py-3 text-center text-slate-300 font-semibold",children:"Actions"})]})}),i.jsx("tbody",{children:Z.length===0?i.jsx("tr",{children:i.jsxs("td",{colSpan:5,className:"px-4 py-12 text-center",children:[i.jsx("div",{className:"text-6xl mb-4",children:a==="upcoming"?"":""}),i.jsxs("h3",{className:"text-2xl font-bold text-white mb-2",children:["No ",a," events"]}),i.jsx("p",{className:"text-slate-400",children:a==="upcoming"?"Add your first upcoming event to get started!":"Past events will appear here once you have some."})]})}):Z.map(q=>i.jsxs("tr",{className:"border-b border-slate-600",children:[i.jsx("td",{className:"px-4 py-3 text-white font-medium border-r border-slate-600",children:q.name}),i.jsx("td",{className:"px-4 py-3 text-slate-300 border-r border-slate-600",children:ae(q.date)}),i.jsx("td",{className:"px-4 py-3 border-r border-slate-600",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-3 h-3 rounded-full ${ne(q.location)}`}),i.jsx("span",{className:"text-slate-300",children:q.location})]})}),i.jsxs("td",{className:"px-4 py-3 text-slate-300 border-r border-slate-600",children:[q.numberOfDays," day",q.numberOfDays>1?"s":""]}),i.jsx("td",{className:"px-4 py-3",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{onClick:()=>G(q),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm font-medium rounded transition-colors",children:"Launch"}),i.jsx("button",{onClick:()=>$(q.id),className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white text-sm font-medium rounded transition-colors",children:"Delete"})]})})]},q.id))})]})})})})]}),d&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 max-w-sm w-full",children:[i.jsxs("h2",{className:"text-lg font-bold text-white mb-4",children:[i.jsx("span",{style:{filter:"brightness(0) invert(1)"},children:""})," Add New Event"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Event Name"}),i.jsx("input",{type:"text",value:T.name,onChange:q=>R(Y=>({...Y,name:q.target.value})),placeholder:"Enter event name",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Date"}),i.jsx("input",{type:"date",value:T.date,onChange:q=>R(Y=>({...Y,date:q.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",style:{colorScheme:"dark"}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Location"}),i.jsx("select",{value:T.location,onChange:q=>R(Y=>({...Y,location:q.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:eu.map(q=>i.jsx("option",{value:q.value,children:q.label},q.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Duration"}),i.jsx("select",{value:T.numberOfDays,onChange:q=>R(Y=>({...Y,numberOfDays:parseInt(q.target.value)})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:mf.map(q=>i.jsxs("option",{value:q,children:[q," day",q>1?"s":""]},q))})]})]}),i.jsxs("div",{className:"flex gap-2 mt-4",children:[i.jsx("button",{onClick:()=>{g(!1),R({name:"",date:"",location:"Great Hall",numberOfDays:1})},className:"flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded text-sm font-medium",children:"Cancel"}),i.jsx("button",{onClick:B,className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded text-sm font-medium",children:"Add Event"})]})]})}),i.jsx(Xf,{isOpen:A,onClose:()=>{M(!1),Q(null)},onRoleSelected:z,eventId:L?.id||""})]})};class Fv{constructor(){this.localChanges=[],this.syncTimer=null,this.SYNC_DELAY=5e3,this.MAX_BATCH_SIZE=10,this.MAX_SYNC_ATTEMPTS=3,this.loadLocalChanges(),this.startSyncTimer()}addChange(r){const n={...r,id:`change_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date,synced:!1};this.localChanges.push(n),this.saveLocalChanges(),console.log(" Change added to local buffer:",n.description),this.localChanges.filter(o=>!o.synced).length>=this.MAX_BATCH_SIZE&&this.syncChanges()}getLocalChanges(){return[...this.localChanges]}getUnsyncedChanges(){return this.localChanges.filter(r=>!r.synced)}getChangesCount(){const r=this.localChanges.length,n=this.localChanges.filter(o=>!o.synced).length;return{total:r,unsynced:n}}reloadLocalChanges(){this.loadLocalChanges(),console.log(" Reloaded local changes:",this.localChanges.length)}startSyncTimer(){this.syncTimer&&clearInterval(this.syncTimer),this.syncTimer=setInterval(()=>{const r=this.getUnsyncedChanges();r.length>0&&(console.log(` Auto-syncing ${r.length} changes...`),this.syncChanges())},this.SYNC_DELAY)}stopSyncTimer(){this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null)}async syncChanges(){const r=this.getUnsyncedChanges();if(r.length===0)return!0;console.log(` Syncing ${r.length} changes to Supabase...`);try{const n=this.groupChangesByEvent(r);for(const[o,a]of n)await this.syncEventChanges(o,a);return this.localChanges=this.localChanges.map(o=>({...o,synced:!0})),this.saveLocalChanges(),console.log(" All changes synced successfully"),!0}catch(n){return console.error(" Error syncing changes:",n),!1}}groupChangesByEvent(r){const n=new Map;for(const o of r)n.has(o.eventId)||n.set(o.eventId,[]),n.get(o.eventId).push(o);return n}async syncEventChanges(r,n){console.log(` Syncing ${n.length} changes for event ${r}`);const o={event_id:r,changes:n.map(h=>({id:h.id,timestamp:h.timestamp.toISOString(),user_id:h.userId,user_name:h.userName,user_role:h.userRole,action:h.action,description:h.description,details:h.details,row_number:h.rowNumber,cue_number:h.cueNumber,segment_name:h.segmentName})),created_at:new Date().toISOString(),synced:!0},{error:a}=await oe.from("change_log_batches").insert([o]);if(a)throw new Error(`Failed to sync batch: ${a.message}`);for(const h of n)await Se.logChange(h.eventId,h.userId,h.userName,h.userRole,h.action,"schedule_items",h.details?.itemId,h.details?.fieldName,h.details?.oldValue,h.details?.newValue,h.description,h.rowNumber,h.cueNumber,h.details)}loadLocalChanges(){try{const r=localStorage.getItem("runofshow_local_changes");if(r){const n=JSON.parse(r);this.localChanges=n.map(o=>({...o,timestamp:new Date(o.timestamp)})),console.log(` Loaded ${this.localChanges.length} local changes from localStorage`)}else console.log(" No local changes found in localStorage"),this.localChanges=[]}catch(r){console.error("Error loading local changes:",r),this.localChanges=[]}}saveLocalChanges(){try{localStorage.setItem("runofshow_local_changes",JSON.stringify(this.localChanges))}catch(r){console.error("Error saving local changes:",r)}}clearLocalChanges(){this.localChanges=[],this.saveLocalChanges(),console.log(" Local changes cleared")}async clearMasterChangeLog(r){try{console.log(" Clearing master change log for event:",r);let n=0,o=[];const{data:{user:a},error:h}=await oe.auth.getUser();if(console.log(" Authenticated user:",a?.id,a?.email),h||!a)return console.error(" Authentication error:",h),{success:!1,error:"Not authenticated",deletedCount:0};console.log(" Attempting to delete from change_log_batches table...");try{const{data:S,error:_}=await oe.from("change_log_batches").select("id").eq("event_id",r);if(_)console.log(" Cannot access change_log_batches table:",_.message),o.push(`change_log_batches: ${_.message}`);else if(console.log(` Found ${S?.length||0} batches to delete`),S&&S.length>0){const{data:T,error:R}=await oe.from("change_log_batches").delete().eq("event_id",r).select("id");if(R)console.error(" Error deleting from change_log_batches:",R),o.push(`change_log_batches delete: ${R.message}`);else{const A=T?.length||0;console.log(` Deleted ${A} batch records`),n+=A}}}catch(S){console.log(" change_log_batches table not accessible:",S),o.push(`change_log_batches: ${S.message}`)}console.log(" Deleting from change_log table...");const{data:d,error:g}=await oe.from("change_log").select("id").eq("event_id",r);if(g)console.error(" Error checking change_log records:",g),o.push(`change_log check: ${g.message}`);else if(console.log(` Found ${d?.length||0} log records to delete`),d&&d.length>0){const{data:S,error:_}=await oe.from("change_log").delete().eq("event_id",r).select("id");if(_)console.error(" Error deleting from change_log:",_),o.push(`change_log delete: ${_.message}`);else{const T=S?.length||0;console.log(` Deleted ${T} log records`),n+=T}}const v=o.length===0||n>0,w=o.length>0?o.join("; "):void 0;return console.log(v?` Master change log cleared: ${n} total records deleted`:` Master change log clearing failed: ${w}`),{success:v,error:w,deletedCount:n}}catch(n){return console.error(" Unexpected error clearing master change log:",n),{success:!1,error:n.message||"Unexpected error",deletedCount:0}}}async getMasterChangeLog(r,n=100){try{console.log(" Fetching master change log from Supabase for event:",r);const{data:o,error:a}=await oe.from("change_log_batches").select("*").eq("event_id",r).order("created_at",{ascending:!1}).limit(n);if(a){console.error(" Error fetching change batches:",a),console.log(" Falling back to regular change_log table...");const{data:g,error:v}=await oe.from("change_log").select("*").eq("event_id",r).order("created_at",{ascending:!1}).limit(n);return v?(console.error(" Error fetching regular change log:",v),[]):(console.log(" Loaded regular change log:",g?.length||0,"changes"),g||[])}console.log(" Loaded change batches:",o?.length||0,"batches");const h=[];for(const g of o||[])if(g.changes&&Array.isArray(g.changes))for(const v of g.changes)h.push({...v,batch_id:g.id,batch_created_at:g.created_at});console.log(" Flattened changes from batches:",h.length,"changes");const d=h.sort((g,v)=>new Date(v.timestamp).getTime()-new Date(g.timestamp).getTime()).slice(0,n);return console.log(" Final sorted changes:",d.length,"changes"),d}catch(o){return console.error(" Error getting master change log:",o),[]}}exportChangesAsJSON(){return JSON.stringify(this.localChanges,null,2)}exportChangesAsCSV(){if(this.localChanges.length===0)return"No changes to export";const r=["Timestamp","User","Role","Action","Description","Row","Cue","Segment","Synced"],n=this.localChanges.map(o=>[o.timestamp.toISOString(),o.userName,o.userRole,o.action,o.description,o.rowNumber||"",o.cueNumber||"",o.segmentName||"",o.synced?"Yes":"No"]);return[r,...n].map(o=>o.join(",")).join(`
`)}}const mt=new Fv;window.addEventListener("beforeunload",()=>{mt.stopSyncTimer()});class zv{constructor(r){this.activeTimers=new Map,this.checkInterval=null,this.syncCallbacks=new Map,this.isRunning=!1,this.config={checkInterval:3e4,maxDriftThreshold:5,forceSyncInterval:3e4,minTimerDuration:0,...r}}startMonitoring(r,n,o,a){if(console.log(` DriftDetector: Starting monitoring for timer ${r}`,{startedAt:n.toISOString(),duration:o,minDuration:this.config.minTimerDuration}),o<this.config.minTimerDuration){console.log(` DriftDetector: Skipping timer ${r} - duration too short (${o}s < ${this.config.minTimerDuration}s)`);return}const h={itemId:r,startedAt:n,duration:o,lastSyncAt:new Date,localElapsed:0,serverElapsed:0};this.activeTimers.set(r,h),this.syncCallbacks.set(r,a),this.isRunning||this.startMonitoringLoop()}stopMonitoring(r){console.log(` DriftDetector: Stopping monitoring for timer ${r}`),this.activeTimers.delete(r),this.syncCallbacks.delete(r),this.activeTimers.size===0&&this.isRunning&&this.stopMonitoringLoop()}updateLocalElapsed(r,n){const o=this.activeTimers.get(r);o&&(o.localElapsed=n)}async forceSync(r,n){const o=this.activeTimers.get(r);if(o)try{const a=await n(),h=Math.abs(a-o.localElapsed);console.log(` DriftDetector: Force sync for timer ${r}`,{localElapsed:o.localElapsed,serverElapsed:a,drift:h.toFixed(2)}),o.serverElapsed=a,o.lastSyncAt=new Date;const d=this.syncCallbacks.get(r);d&&d(a)}catch(a){console.error(` DriftDetector: Error during force sync for timer ${r}:`,a)}}startMonitoringLoop(){this.isRunning||(console.log(" DriftDetector: Starting monitoring loop"),this.isRunning=!0,this.checkInterval=setInterval(()=>{this.checkAllTimers()},this.config.checkInterval))}stopMonitoringLoop(){this.isRunning&&(console.log(" DriftDetector: Stopping monitoring loop"),this.isRunning=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null))}async checkAllTimers(){const r=new Date,n=[];for(const[o,a]of this.activeTimers)n.push(this.checkTimerDrift(o,a,r));await Promise.all(n)}async checkTimerDrift(r,n,o){try{const a=o.getTime()-n.lastSyncAt.getTime();if(a>=this.config.forceSyncInterval){console.log(` DriftDetector: Force sync needed for timer ${r} (${a}ms since last sync)`);return}const d=Math.floor((o.getTime()-n.startedAt.getTime())/1e3),g=Math.abs(d-n.localElapsed);g>this.config.maxDriftThreshold&&console.log(` DriftDetector: Significant drift detected for timer ${r}`,{localElapsed:n.localElapsed,expectedElapsed:d,drift:g.toFixed(2),threshold:this.config.maxDriftThreshold})}catch(a){console.error(` DriftDetector: Error checking drift for timer ${r}:`,a)}}getConfig(){return{...this.config}}updateConfig(r){this.config={...this.config,...r},console.log(" DriftDetector: Configuration updated",this.config)}getStatus(){const r=new Date;return Array.from(this.activeTimers.entries()).map(([n,o])=>{const a=Math.abs(o.serverElapsed-o.localElapsed),h=r.getTime()-o.lastSyncAt.getTime();return{itemId:n,drift:a,timeSinceLastSync:h}})}getStatusForTimer(r){const n=this.activeTimers.get(r);if(!n)return{itemId:r,drift:0,timeSinceLastSync:0};const o=new Date,a=Math.abs(n.serverElapsed-n.localElapsed),h=o.getTime()-n.lastSyncAt.getTime();return{itemId:r,drift:a,timeSinceLastSync:h}}destroy(){console.log(" DriftDetector: Destroying drift detector"),this.stopMonitoringLoop(),this.activeTimers.clear(),this.syncCallbacks.clear()}}const Jr=new zv,Zf=({itemId:u,className:r=""})=>{const[n,o]=k.useState(null);if(k.useEffect(()=>{console.log(` DriftStatusIndicator: Starting for itemId ${u}`);const v=()=>{const S=Jr.getStatusForTimer(u);console.log(` DriftStatusIndicator: Status for itemId ${u}:`,S),S?(console.log(` DriftStatusIndicator: Found status for itemId ${u}:`,S),o({drift:S.drift,timeSinceLastSync:S.timeSinceLastSync})):(console.log(` DriftStatusIndicator: No status found for itemId ${u}`),o(null))};v();const w=setInterval(v,5e3);return()=>clearInterval(w)},[u]),!n)return console.log(` DriftStatusIndicator: No drift info for itemId ${u}, showing blue dot (starting up)`),i.jsx("div",{className:`drift-status ${r}`,children:i.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500",title:`Drift detection starting up for timer ${u}`})});const{drift:a,timeSinceLastSync:h}=n,d=a>5,g=h>6e4;return i.jsx("div",{className:`drift-status ${r}`,children:i.jsx("div",{className:`w-2 h-2 rounded-full ${d?"bg-red-500":g?"bg-yellow-500":"bg-green-500"}`,title:`Drift: ${a.toFixed(1)}s, Last sync: ${Math.round(h/1e3)}s ago`})})},Vv=({isOpen:u,onClose:r,event:n,schedule:o,activeItemId:a,activeTimers:h,onLoadCue:d,onStartTimer:g,onStopTimer:v,onResetTimer:w})=>{const[S,_]=k.useState({isConnected:!1,serverPort:57121}),[T,R]=k.useState([]),[A,M]=k.useState(""),[L,Q]=k.useState(""),[K,B]=k.useState(!0),[$,G]=k.useState(null),z=k.useRef(null),ne=()=>{z.current?.scrollIntoView({behavior:"smooth"})};k.useEffect(()=>{ne()},[T]);const ae=(C,H)=>{if(console.log(" Handling OSC response:",C,H),C==="/cue/loaded"&&H.length>=1){const le=H[0];console.log(" Cue loaded, finding item for cue ID:",le);const me=O(le);me&&d?(console.log(" Found item for cue, calling onLoadCue:",me.id),d(me.id.toString())):console.log(" Could not find item for cue ID:",le)}else if(C==="/timer/started")console.log(" Generic timer started - controlling currently loaded cue"),g&&g("generic");else if(C==="/timer/stopped")console.log(" Generic timer stopped - controlling currently loaded cue"),v&&v("generic");else if(C==="/timer/reset")console.log(" Generic timer reset - using resetAllStates"),w&&w("generic");else if(C==="/subtimer/started"&&H.length>=1){const le=H[0];console.log(" Sub-timer started, finding item for sub-timer ID:",le);const me=Z(le);me&&g?(console.log(" Found item for sub-timer, calling onStartTimer:",me.id),g(me.id.toString())):console.log(" Could not find item for sub-timer ID:",le)}else if(C==="/subtimer/stopped"&&H.length>=1){const le=H[0];console.log(" Sub-timer stopped, finding item for sub-timer ID:",le);const me=Z(le);me&&v?(console.log(" Found item for sub-timer, calling onStopTimer:",me.id),v(me.id.toString())):console.log(" Could not find item for sub-timer ID:",le)}},O=C=>o.length?o.find(H=>{const le=H.customFields?.cue||"";return le===C||le===`CUE ${C}`||le===`CUE${C}`}):null,Z=C=>o.length?o.find(H=>H.isIndented&&(H.timerId===C||H.id.toString()===C)):null;k.useEffect(()=>u?((()=>{try{const H=new WebSocket("ws://localhost:57121/osc");H.onopen=()=>{console.log(" OSC WebSocket connected"),_(le=>({...le,isConnected:!0,error:void 0})),q({address:"/system/connected",args:[],direction:"outgoing"})},H.onmessage=le=>{try{console.log(" OSC WebSocket message received:",le.data);const me=JSON.parse(le.data);me.type==="connected"?console.log(" OSC Server:",me.message):me.type==="osc_response"?(console.log(" OSC Response:",me.address,me.args),q({address:me.address,args:me.args,direction:"incoming"}),ae(me.address,me.args)):me.type==="pong"&&(console.log(" Pong received"),q({address:"/pong",args:["server","alive"],direction:"incoming"}))}catch(me){console.error(" Error parsing WebSocket message:",me)}},H.onerror=le=>{console.error(" WebSocket error:",le),_(me=>({...me,isConnected:!1,error:"OSC server not running - start osc-websocket-server.js"}))},H.onclose=()=>{console.log(" OSC WebSocket disconnected"),_(le=>({...le,isConnected:!1,error:"Connection closed"}))},G(H),setTimeout(()=>{H.readyState===WebSocket.OPEN?(console.log(" Sending ping to OSC server..."),H.send(JSON.stringify({type:"osc",address:"/ping",args:[]}))):console.log(" WebSocket not ready for ping")},1e3)}catch(H){console.error(" Failed to initialize OSC WebSocket:",H),_(le=>({...le,isConnected:!1,error:"Failed to create WebSocket connection"}))}})(),()=>{$&&$.readyState===WebSocket.OPEN&&$.close()}):void 0,[u]);const q=C=>{if(!K)return;const H={...C,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date};R(le=>[...le.slice(-99),H])},Y=(C,H=[])=>{if(!$||!S.isConnected){console.log(" OSC server not connected - cannot send message"),alert("OSC server not connected");return}try{const le={type:"osc",address:C,args:H};console.log(" Sending OSC message:",le),$.send(JSON.stringify(le)),q({address:C,args:H,direction:"outgoing"})}catch(le){console.error(" Error sending OSC message:",le),alert("Failed to send OSC message")}},ce=()=>{if(!A.trim()){alert("Please enter a cue name");return}const C=A.trim();Y(`/cue/${C}/load`,[])},ke=()=>{a?(console.log(" Generic start - controlling currently loaded item:",a),Y("/timer/start",[])):alert("No cue is currently loaded. Please load a cue first.")},De=()=>{const C=Object.keys(h);if(C.length>0){const H=parseInt(C[0]);console.log(" Generic stop - controlling currently running timer:",H),Y("/timer/stop",[])}else alert("No timer is currently running.")},et=()=>{console.log(" Generic reset - using resetAllStates (same as Reset button)"),Y("/timer/reset",[])},Fe=()=>{if(!L.trim()){alert("Please enter a sub-timer ID");return}Y(`/subtimer/${L.trim()}/start`,[])},ie=()=>{if(!L.trim()){alert("Please enter a sub-timer ID");return}Y(`/subtimer/${L.trim()}/stop`,[])},pe=()=>{R([])},ue=C=>C.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3});return u?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-white",children:"OSC Control Panel"}),i.jsx("button",{onClick:r,className:"text-slate-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"flex-1 overflow-hidden",children:[i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full",children:[i.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Connection Status"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-3 h-3 rounded-full ${S.isConnected?"bg-green-500":"bg-red-500"}`}),i.jsx("span",{className:"text-sm",children:S.isConnected?"Connected":"Disconnected"})]}),i.jsxs("div",{className:"text-sm text-slate-400",children:["Server: 127.0.0.1:",S.serverPort]}),i.jsxs("div",{className:"border-t border-slate-600 pt-3",children:[i.jsx("div",{className:"text-sm font-medium text-slate-300 mb-2",children:"Current State:"}),i.jsxs("div",{className:"text-xs text-slate-400 space-y-1",children:[i.jsxs("div",{children:["Loaded Cue: ",a?`Item ${a}`:"None"]}),i.jsxs("div",{children:["Running Timers: ",Object.keys(h).length]}),Object.keys(h).length>0&&i.jsxs("div",{className:"text-green-400",children:["Active: ",Object.keys(h).map(C=>`Item ${C}`).join(", ")]})]})]}),S.error&&i.jsxs("div",{className:"text-sm text-red-400",children:["Error: ",S.error]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{$&&$.readyState===WebSocket.OPEN&&$.send(JSON.stringify({type:"osc",address:"/ping",args:[]}))},className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Test Connection"}),!S.isConnected&&i.jsx("button",{onClick:()=>{$&&$.close(),_(C=>({...C,error:void 0}))},className:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white text-sm rounded transition-colors",children:"Retry"})]})]})]}),i.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Cue & Timer Controls"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Cue Name (to load)"}),i.jsx("input",{type:"text",value:A,onChange:C=>M(C.target.value),placeholder:"Enter cue name (1, 1.1, 1A, etc.)",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Sub-Timer ID (for indented items)"}),i.jsx("input",{type:"text",value:L,onChange:C=>Q(C.target.value),placeholder:"Enter sub-timer ID",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Main Cue Controls"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{onClick:ce,className:"px-3 py-2 bg-purple-600 hover:bg-purple-500 text-white text-sm rounded transition-colors",children:"Load Cue"}),i.jsx("button",{onClick:ke,className:"px-3 py-2 bg-green-600 hover:bg-green-500 text-white text-sm rounded transition-colors",children:"Start (Generic)"}),i.jsx("button",{onClick:De,className:"px-3 py-2 bg-red-600 hover:bg-red-500 text-white text-sm rounded transition-colors",children:"Stop (Generic)"}),i.jsx("button",{onClick:et,className:"px-3 py-2 bg-yellow-600 hover:bg-yellow-500 text-white text-sm rounded transition-colors",children:"Reset (Generic)"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Sub-Timer Controls"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{onClick:Fe,className:"px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Start Sub-Timer"}),i.jsx("button",{onClick:ie,className:"px-3 py-2 bg-orange-600 hover:bg-orange-500 text-white text-sm rounded transition-colors",children:"Stop Sub-Timer"})]})]})]})]}),i.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Message Log"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:K,onChange:C=>B(C.target.checked),className:"rounded"}),i.jsx("label",{className:"text-sm text-slate-300",children:"Enable Logging"})]}),i.jsxs("div",{className:"text-sm text-slate-400",children:["Messages: ",T.length]}),i.jsxs("div",{className:"text-xs text-slate-500 space-y-1",children:[i.jsx("div",{children:i.jsx("strong",{children:"OSC Message Examples:"})}),i.jsx("div",{className:"font-semibold text-slate-400",children:"Main Cue Commands:"}),i.jsx("div",{children:"/cue/1/load"}),i.jsx("div",{children:"/cue/1.1/load"}),i.jsx("div",{children:"/cue/1A/load"}),i.jsx("div",{className:"font-semibold text-slate-400 mt-2",children:"Generic Timer Commands:"}),i.jsx("div",{children:"/timer/start"}),i.jsx("div",{children:"/timer/stop"}),i.jsx("div",{children:"/timer/reset"}),i.jsx("div",{className:"font-semibold text-slate-400 mt-2",children:"Sub-Timer Commands:"}),i.jsx("div",{children:"/subtimer/SUB1/start"}),i.jsx("div",{children:"/subtimer/SUB1/stop"})]})]})]})]}),i.jsxs("div",{className:"mt-6 bg-slate-700 rounded-lg p-4 flex-1 min-h-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-white",children:"OSC Message Log"}),i.jsx("button",{onClick:pe,className:"px-3 py-1 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded transition-colors",children:"Clear Messages"})]}),i.jsxs("div",{className:"bg-slate-900 rounded-lg p-4 h-64 overflow-y-auto font-mono text-sm",children:[T.length===0?i.jsx("div",{className:"text-slate-500 text-center py-8",children:S.isConnected?"No messages yet. Send OSC commands to see messages.":i.jsxs("div",{children:[i.jsx("div",{className:"text-red-400 mb-2",children:" OSC Server Not Connected"}),S.error?.includes("Node.js environment")?i.jsxs("div",{children:[i.jsx("div",{className:"text-sm text-yellow-400 mb-2",children:"OSC requires local Node.js server"}),i.jsx("div",{className:"text-sm",children:"For online deployment, OSC is not available."}),i.jsx("div",{className:"text-sm",children:"For local use with OSC:"}),i.jsx("div",{className:"text-xs font-mono bg-slate-800 p-2 rounded mt-2",children:"start-both-servers.bat"}),i.jsx("div",{className:"text-xs mt-1",children:"Or: start-websocket-osc-server.bat"})]}):i.jsxs("div",{children:[i.jsx("div",{className:"text-sm",children:"Start the OSC server using:"}),i.jsx("div",{className:"text-xs font-mono bg-slate-800 p-2 rounded mt-2",children:"node osc-server.js"}),i.jsx("div",{className:"text-xs mt-2",children:"Or use the batch file: start-osc-server.bat"})]})]})}):T.map(C=>i.jsxs("div",{className:`flex items-start gap-3 py-1 ${C.direction==="incoming"?"text-green-400":"text-blue-400"}`,children:[i.jsx("span",{className:"text-slate-500 text-xs w-20 flex-shrink-0",children:ue(C.timestamp)}),i.jsx("span",{className:"text-slate-500 text-xs w-20 flex-shrink-0",children:C.direction==="incoming"?"":""}),i.jsx("span",{className:"text-yellow-400 flex-shrink-0",children:C.address}),C.args.length>0&&i.jsx("span",{className:"text-slate-300",children:JSON.stringify(C.args)})]},C.id)),i.jsx("div",{ref:z})]})]})]})]})}):null},Wv=()=>{const u=br(),r=To();let n=u.state?.event,o=u.state?.userRole;const{user:a,loading:h}=Os(),[d,g]=k.useState("VIEWER"),[v,w]=k.useState(!1),[S,_]=k.useState(!1),[T,R]=k.useState([]),[A,M]=k.useState([]),[L,Q]=k.useState(!1),[K,B]=k.useState(new Map),$=k.useRef(new Map),G=k.useRef(new Set),z=(c,p,y)=>{if(d!=="EDITOR"||!a||!n?.id){console.log(" Not logging change - missing requirements:",{role:d,user:!!a,event:!!n?.id});return}let b=p,E,j;y?.itemId&&(E=O.findIndex(J=>J.id===y.itemId)+1,j=O.find(J=>J.id===y.itemId)?.customFields?.cue||"CUE",b=`ROW ${E} - ${ur(j)}: ${p}`),mt.addChange({eventId:n.id,userId:a.id,userName:a.user_metadata?.full_name||a.email||"Unknown",userRole:d,action:c,description:b,details:y,rowNumber:E,cueNumber:j,segmentName:y?.itemName||y?.segmentName});const P=mt.getLocalChanges();R(P.slice(0,100)),console.log(" Change logged to buffer:",b)},ne=(c,p,y,b)=>{if(d!=="EDITOR"){console.log(" Not logging change - user role is not EDITOR:",d);return}const E=b?.fieldName?.includes("Name")||b?.fieldName?.includes("segmentName")||b?.fieldName?.includes("cue")||b?.fieldName?.includes("custom"),j=E?`text_${b?.itemId}_${b?.fieldName}`:c,P=$.current.get(j);P&&(clearTimeout(P),$.current.delete(j)),B(we=>{const te=new Map(we);for(const[de,Ne]of te.entries())Ne.originalKey===j&&te.delete(de);return te});let W=y,J={...b};if(b?.itemId){const we=O.findIndex(Ne=>Ne.id===b.itemId)+1,de=O.find(Ne=>Ne.id===b.itemId)?.customFields?.cue||"CUE";W=`ROW ${we} - ${ur(de)}: ${y}`,J={...b,rowNumber:we,cueNumber:de}}if(E)B(we=>{const te=new Map(we);for(const[Ne,qe]of te.entries())qe.originalKey===j&&te.delete(Ne);const de=`${j}_${Date.now()}`;return te.set(de,{action:p,description:W,details:J,timestamp:new Date,user:a?.user_metadata?.full_name||a?.email||"Unknown User",originalKey:j}),console.log(" Updated text field pending change:",de,"for baseKey:",j),console.log(" Total pending changes:",te.size),console.log(" Pending change details:",{action:p,description:W,baseKey:j,uniqueKey:de}),te});else{const we=`${j}_${Date.now()}`;B(te=>{const de=new Map(te.set(we,{action:p,description:W,details:J,timestamp:new Date,user:a?.user_metadata?.full_name||a?.email||"Unknown User",originalKey:j}));return console.log(" Added pending change:",we,"for baseKey:",j),console.log(" Total pending changes:",de.size),console.log(" Pending change details:",{action:p,description:W,baseKey:j,uniqueKey:we}),de})}const be=setTimeout(async()=>{console.log(" TIMEOUT FIRED for baseKey:",j),B(we=>{let te=null,de=null;console.log(" TIMEOUT: Looking for baseKey:",j),console.log(" TIMEOUT: Available pending changes:",Array.from(we.entries()).map(([qe,Ye])=>({key:qe,originalKey:Ye.originalKey})));for(const[qe,Ye]of we.entries())if(Ye.originalKey===j){te=Ye,de=qe,console.log(" TIMEOUT: Found match - key:",qe,"originalKey:",Ye.originalKey);break}console.log(" TIMEOUT: Found pending change:",te?"YES":"NO"),console.log(" TIMEOUT: Change key:",de),console.log(" TIMEOUT: Has change key in prev:",we.has(de||""));const Ne=`${j}-${te?.timestamp?.getTime()||Date.now()}`;if(console.log(" TIMEOUT: Change ID:",Ne),console.log(" TIMEOUT: Already processed:",G.current.has(Ne)),te&&de&&we.has(de)&&a&&n?.id&&!G.current.has(Ne)){console.log(" TIMEOUT: Processing change..."),G.current.add(Ne);const qe={eventId:n.id,userId:a.id,userName:a.user_metadata?.full_name||a.email||"Unknown",userRole:d,action:te?.action||"unknown",description:te?.description||"unknown",details:te?.details||{},rowNumber:te?.details?.rowNumber,cueNumber:te?.details?.cueNumber,segmentName:te?.details?.itemName||te?.details?.segmentName};console.log(" Adding change to service:",qe),mt.addChange(qe);const Ye=mt.getLocalChanges();console.log(" Local changes after adding to service:",Ye.length),console.log(" Latest change:",Ye[Ye.length-1]),console.log(" Current changeLog state length:",T.length),R(Ye.slice(0,100)),console.log(" Set changeLog to:",Ye.slice(0,100).length,"changes"),console.log(" Debounced change logged to change log service:",te?.description||"unknown"),console.log(" Removed pending change from queue:",de),console.log(" Auto-syncing changes after timeout..."),Us().then(()=>{console.log(" Auto-sync completed after timeout")}).catch(nn=>{console.error(" Auto-sync failed after timeout:",nn)}),$.current.delete(j);const mr=new Map(we);return mr.delete(de),console.log(" Pending changes after removal:",mr.size),console.log(" Remaining pending keys:",Array.from(mr.keys())),mr}else{$.current.delete(j),G.current.has(Ne)?console.log(" Prevented duplicate processing of change:",Ne):console.log(" Pending change already processed or removed:",j);const qe=Date.now(),Ye=new Map(we);let mr=0;for(const[nn,xl]of Ye.entries()){const Ko=qe-xl.timestamp.getTime();Ko>15e3&&(console.log(" Removing stale pending change:",nn,"age:",Ko+"ms"),Ye.delete(nn),mr++)}return mr>0?(console.log(" Removed",mr,"stale pending changes"),Ye):we}})},5e3);$.current.set(j,be),console.log(" Set timeout for baseKey:",j,"in",5e3,"ms"),console.log(" Total active timeouts:",$.current.size)},ae=async()=>{console.log(" Finalizing all pending changes...");const c=Array.from(K.entries());if(c.length===0){console.log(" No pending changes to finalize");return}$.current.forEach(b=>{clearTimeout(b)}),$.current.clear(),console.log(` Processing ${c.length} pending changes immediately...`);const p=new Set;for(const[b,E]of c)if(E&&a&&n?.id){const j=`${E.originalKey||b}-${E.timestamp.getTime()}`;if(G.current.has(j)){console.log(" Skipping already processed change:",j);continue}G.current.add(j),p.add(j);let P=E.description,W,J;E.details?.itemId&&(W=O.findIndex(we=>we.id===E.details.itemId)+1,J=O.find(we=>we.id===E.details.itemId)?.customFields?.cue||"CUE",P=`ROW ${W} - ${ur(J)}: ${E.description}`),mt.addChange({eventId:n.id,userId:a.id,userName:a.user_metadata?.full_name||a.email||"Unknown",userRole:d,action:E.action,description:P,details:E.details,rowNumber:W,cueNumber:J,segmentName:E.details?.itemName||E.details?.segmentName}),console.log(" Processed pending change immediately:",P)}B(new Map);const y=mt.getLocalChanges();R(y.slice(0,100)),console.log(` All ${p.size} pending changes processed immediately`),console.log(" Auto-syncing changes after manual finalization...");try{await Us(),console.log(" Auto-sync completed after manual finalization")}catch(b){console.error(" Auto-sync failed after manual finalization:",b)}setTimeout(()=>{p.forEach(b=>{G.current.delete(b)}),console.log(" Cleaned up processed change tracking for",p.size,"changes")},6e4)};if(k.useEffect(()=>()=>{$.current.forEach(c=>clearTimeout(c))},[]),k.useEffect(()=>{const c=setInterval(()=>{B(p=>{const y=Date.now(),b=new Map(p);let E=0;for(const[j,P]of b.entries()){const W=y-P.timestamp.getTime();W>2e4&&(console.log(" Periodic cleanup: Removing stale pending change:",j,"age:",W+"ms"),b.delete(j),E++)}return E>0&&console.log(" Periodic cleanup: Removed",E,"stale pending changes"),b})},5e3);return()=>clearInterval(c)},[]),k.useEffect(()=>{const c=mt.getChangesCount().unsynced;Ai(c)},[T,K]),!n){const c=localStorage.getItem("events");if(c){const p=JSON.parse(c);n=p[p.length-1]}}console.log("Event from location.state:",u.state?.event),console.log("Final event data:",n);const[O,Z]=k.useState([]),[q,Y]=k.useState([]),[ce,ke]=k.useState(n?.name||""),[De,et]=k.useState(""),[Fe,ie]=k.useState({}),[pe,ue]=k.useState(1),[C,H]=k.useState(!1),[le,me]=k.useState(!1),[$e,Ue]=k.useState(null),[Ke,ze]=k.useState(!1),[Je,wt]=k.useState(!1),[$t,qn]=k.useState(null),[yn,Xr]=k.useState(!1),[Zt,xn]=k.useState(null),[bt,ir]=k.useState([]),[Kn,Lr]=k.useState(!1),[Tt,wn]=k.useState(null),[ji,Oo]=k.useState(!1),[Io,Po]=k.useState(null),[Jn,$r]=k.useState(!1),[Sr,_r]=k.useState(null),[pt,ar]=k.useState([]),[Re,lr]=k.useState({}),[Mr,Zr]=k.useState({}),[Be,Ht]=k.useState({}),[Is,er]=k.useState({}),[Ge,Mt]=k.useState(null),[Gn,Do]=k.useState(null),[Ao,Ti]=k.useState(!1),[tl,bn]=k.useState(null),[rl,Qn]=k.useState(null),[ye,Ut]=k.useState(null),[Qe,dt]=k.useState({}),[Er,St]=k.useState({}),[Lo,Ps]=k.useState(new Set),[ju,Tu]=k.useState(null),[Sn,Ur]=k.useState({}),[$o,en]=k.useState(!1),[Ot,Ci]=k.useState(null),[Ri,Yn]=k.useState(!1),[tn,Ds]=k.useState(""),[nt,Oi]=k.useState(!1),[Mo,As]=k.useState(!1),[Ls,Ii]=k.useState(!1),[je,_t]=k.useState({start:!0,programType:!0,duration:!0,segmentName:!0,shotType:!0,pptQA:!0,notes:!0,assets:!0,participants:!0,speakers:!0,public:!0,custom:!0}),[Ft,Uo]=k.useState({}),[Oe,nl]=k.useState({start:128,programType:224,duration:224,segmentName:320,shotType:192,pptQA:192,notes:384,assets:192,participants:256,speakers:384,public:128}),[$s,sl]=k.useState({}),[It,Xn]=k.useState(!1);k.useEffect(()=>{const c=localStorage.getItem(`followEnabled_${n?.id}`);c!==null&&Xn(c==="true")},[n?.id]),k.useEffect(()=>{localStorage.setItem(`followEnabled_${n?.id}`,It.toString())},[It,n?.id]),k.useEffect(()=>{if(It&&ye){const c=localStorage.getItem(`scrollPosition_${n?.id}`);if(c){const p=parseInt(c);setTimeout(()=>{window.scrollTo({top:p,behavior:"smooth"})},100)}}},[ye,It,n?.id]);const[_n,cr]=k.useState(new Set),ur=c=>c?c.includes("CUE ")?c:c.replace(/^CUE(\d+)$/,"CUE $1"):"CUE",[Pi,Fr]=k.useState(new Set),[Fo,rn]=k.useState(null),[Zn,Di]=k.useState(!1),[zr,Ae]=k.useState(!1),[es,Ai]=k.useState(0),[dr,Ms]=k.useState(null),[ts,Li]=k.useState(0);k.useEffect(()=>{if(h){console.log(" Authentication still loading, waiting...");return}a&&n?.id?(async()=>{try{const p=await Se.getCurrentUserSession(a.id);if(p&&p.event_id===n.id&&p.user_role)return g(p.user_role),console.log(" Loaded role from Supabase:",p.user_role),!0}catch(p){console.log(" Failed to load role from Supabase:",p)}return!1})().then(p=>{if(!p){if(o&&["VIEWER","EDITOR","OPERATOR"].includes(o)){g(o),Se.saveUserSession(n.id,a.id,a.user_metadata?.full_name||a.email||"Unknown",o),console.log(" Using role from navigation state (no Supabase data):",o);return}console.log(" No role found, redirecting to event list"),r("/events")}}):!a&&n?.id&&(console.log(" No user authenticated, defaulting to VIEWER role"),g("VIEWER"))},[a,n?.id,h,o,r]),k.useEffect(()=>{if(n?.id){console.log(" Loading change log data for event:",n.id),mt.reloadLocalChanges();const c=mt.getLocalChanges();R(c.slice(0,100)),console.log(" Loaded local changes:",c.length),kn(),ns(),ol(),tr(),$i();const p=setInterval(()=>{const y=mt.getLocalChanges();R(y.slice(0,100))},2e3);return()=>clearInterval(p)}},[n?.id]);const[zo,En]=k.useState(!1),[hr,Vr]=k.useState(null),[kr,rs]=k.useState(!1);k.useEffect(()=>{n?.id&&O.length>0&&!kr&&(console.log(" Schedule loaded, checking for running timers for event:",n.id),ss(),rs(!0))},[n?.id,O.length,kr]),k.useEffect(()=>{if(!n?.id)return;const c=async()=>{try{const{data:y,error:b}=await oe.from("completed_cues").select("*").eq("event_id",n.id);if(!b&&y){const E={};y.forEach(j=>{j.item_id&&(E[j.item_id]=!0)}),er(E),console.log(" Synced completed cues:",E)}}catch(y){console.warn(" Error syncing completed cues:",y)}};c();const p=setInterval(c,2e3);return()=>clearInterval(p)},[n?.id]),k.useEffect(()=>{if(!n?.id)return;const c=async()=>{try{await tr()}catch(y){console.warn(" Error syncing sub-cue timers:",y)}};c();const p=setInterval(c,1e3);return()=>clearInterval(p)},[n?.id]),k.useEffect(()=>{if(!n?.id||!a?.id)return;const c=async()=>{try{const{data:y,error:b}=await oe.from("active_timers").select("*").eq("event_id",n.id).order("updated_at",{ascending:!1}).limit(1);if(b){console.warn(" Top text sync error:",b);return}const E=y?.[0];if(E&&E.user_id===a.id)return;if(E){const j=E.timer_state||"unknown",P=parseInt(E.item_id),W=E.is_active,J=E.started_at;let be=j;if((j==="unknown"||!j)&&(W&&J?be="running":W?be="loaded":be="stopped"),be==="running"){Ut(P),Ur(de=>({...de,[P]:!0})),lr(de=>({...de,[P]:!0}));const we=O.findIndex(de=>de.id===P),te=new Set;if(we!==-1)for(let de=we+1;de<O.length&&O[de].isIndented;de++)te.add(O[de].id);Fr(te),rn(P)}else if(be==="loaded"){Ut(P),Ur(de=>({...de,[P]:!0})),lr({});const we=O.findIndex(de=>de.id===P),te=new Set;if(we!==-1)for(let de=we+1;de<O.length&&O[de].isIndented;de++)te.add(O[de].id);Fr(te),rn(P)}else be==="stopped"&&(Ut(null),Ur({}),lr({}),Fr(new Set),rn(null))}else Ut(null),Ur({}),lr({}),Fr(new Set),rn(null)}catch(y){console.warn(" Top text sync error:",y)}};c();const p=setInterval(c,2e3);return()=>clearInterval(p)},[n?.id,a?.id,O]),k.useEffect(()=>()=>{console.log(" Cleaning up drift detector on component unmount"),Jr.destroy()},[]);const ns=async()=>{if(n?.id)try{console.log(" Loading completed cues from Supabase for event:",n.id);const c=await Se.getCompletedCues(n.id);if(c&&c.length>0){console.log(" Found completed cues:",c);const p={};c.forEach(y=>{if(y.item_id){if(ye&&y.item_id===ye){console.log(" Skipping currently loaded cue from completed cues:",y.item_id);return}p[y.item_id]=!0}}),er(p),console.log(" Set completedCues state:",p)}else console.log(" No completed cues found")}catch(c){console.error(" Error loading completed cues from Supabase:",c),console.log(" This means the completed_cues table or functions need to be created first"),console.log(" Please run the create-completed-cues-table.sql script in your Supabase SQL Editor")}};k.useCallback(()=>n?.id?(console.log(" Starting countdown sync for Browser B"),setInterval(async()=>{try{const p=await Se.getActiveTimer(n.id);p&&p.timer_state==="running"&&p.started_at&&p.elapsed_seconds!==void 0&&p.duration_seconds!==void 0&&dt(y=>({...y,[p.item_id]:{elapsed:p.elapsed_seconds,total:p.duration_seconds,startedAt:new Date(p.started_at)}}))}catch(p){console.warn(" Failed to sync countdown from server:",p)}},1e3)):void 0,[n?.id]),k.useEffect(()=>{if(!n?.id||!a?.id)return;console.log(" Starting countdown sync for Browser B");const c=setInterval(async()=>{try{const p=await Se.getActiveTimer(n.id);if(p){if(p.user_id===a.id){console.log(" Skipping countdown sync - timer started by current user");return}if(console.log(" Browser B: Syncing timer from server:",{itemId:p.item_id,state:p.timer_state,elapsed:p.elapsed_seconds,total:p.duration_seconds,startedAt:p.started_at,userId:p.user_id,currentUserId:a.id}),dt(y=>{const b=y[p.item_id];return p.timer_state==="running"&&p.started_at?{...y,[p.item_id]:{elapsed:p.elapsed_seconds,total:p.duration_seconds,startedAt:new Date(p.started_at)}}:{...y,[p.item_id]:{elapsed:0,total:p.duration_seconds,startedAt:null}}}),p.timer_state==="running"&&p.started_at){const y=new Date(p.started_at),b=p.duration_seconds;console.log(` Browser B: Starting drift detection for timer ${p.item_id} with duration ${b}s`),Jr.startMonitoring(p.item_id,y,b,E=>{console.log(` Browser B DriftDetector: Syncing timer ${p.item_id} with server elapsed: ${E}s`),Ps(j=>{const P=new Set([...j,p.item_id]);return console.log(` Browser B DriftDetector: Marking timer ${p.item_id} as server-synced. Server-synced timers:`,Array.from(P)),P}),dt(j=>{const P={...j,[p.item_id]:{...j[p.item_id],elapsed:E}};return console.log(` Browser B DriftDetector: Updated timer ${p.item_id} progress to elapsed: ${E}s`),P})})}}else console.log(" No active timer, clearing timer progress"),dt({})}catch(p){console.warn(" Failed to sync countdown from server:",p)}},1e3);return()=>{console.log(" Cleaning up countdown sync"),clearInterval(c)}},[n?.id,a?.id]);const tr=async()=>{if(n?.id){console.log(" Polling for sub-cue timer...");try{const{data:c}=await Se.hasActiveSubCueTimer(n.id);if(!c){console.log(" No active sub-cue timer found, clearing local state"),Object.keys(Be).forEach(b=>{Be[parseInt(b)]&&clearInterval(Be[parseInt(b)])}),Ht({}),St({}),Mt(null);return}const{data:p,error:y}=await Se.getActiveSubCueTimer(n.id);if(console.log(" Sub-cue timer data from Supabase:",p),y){console.error(" Error loading sub-cue timer:",y);return}if(p&&p.is_active&&p.is_running){if(console.log(" Sub-cue timer loaded:",p.item_id,"Duration:",p.duration_seconds,"s","Active:",p.is_active,"Running:",p.is_running),a&&p.user_id===a.id){console.log(" Skipping sub-cue sync - change made by current user");return}Di(!0),Object.keys(Be).forEach(J=>{Be[parseInt(J)]&&clearInterval(Be[parseInt(J)])});const b=parseInt(p.item_id),E=new Date(p.started_at),P=Math.floor((new Date().getTime()-E.getTime())/1e3)+2;St(J=>({...J,[b]:{elapsed:Math.max(0,P),total:p.duration_seconds,startedAt:E}})),console.log(" Browser B: Not starting local timer, will update via 2-second sync"),console.log(" Set sub-cue timer state");const W=Math.max(0,p.duration_seconds-P);console.log(" Browser B timing debug:",{startedAt:E.toISOString(),elapsed:P,duration:p.duration_seconds,remaining:W,fix:"Browser B uses database elapsed time, no local timer"}),Mt({itemId:b,remaining:W,duration:p.duration_seconds,isActive:!0,startedAt:E,timerState:"running"}),console.log(" Set secondaryTimer state for top UI"),setTimeout(()=>{Di(!1)},100)}else p&&(!p.is_active||!p.is_running)?(console.log(" Sub-cue timer found but not active or not running, clearing local state"),Object.keys(Be).forEach(b=>{Be[parseInt(b)]&&clearInterval(Be[parseInt(b)])}),Ht({}),St({}),Mt(null)):(console.log(" No sub-cue timer found, clearing local state"),Object.keys(Be).forEach(b=>{Be[parseInt(b)]&&clearInterval(Be[parseInt(b)])}),Ht({}),St({}),Mt(null))}catch(c){console.error(" Error loading sub-cue timer:",c),Object.keys(Be).forEach(p=>{Be[parseInt(p)]&&clearInterval(Be[parseInt(p)])}),Ht({}),St({})}}},ol=async()=>{if(n?.id)try{const{data:c,error:p}=await Se.getActiveSubCueTimers(n.id);if(p){console.error(" Error loading sub-cue timers:",p);return}c&&c.length>0&&(console.log(" Loaded sub-cue timers from Supabase:",c),console.log(" Setting up sub-cue timer states..."),c.forEach(y=>{const b=y.item_id,E=y.duration_seconds||0;if(console.log(` Setting up sub-cue timer for item ${b}:`,{elapsed:y.elapsed_seconds||0,total:E,startedAt:y.started_at?new Date(y.started_at):null,timer_state:y.timer_state}),St(j=>({...j,[b]:{elapsed:y.elapsed_seconds||0,total:E,startedAt:y.started_at?new Date(y.started_at):null}})),y.timer_state==="running"){console.log(` Starting local timer interval for sub-cue item ${b}`);const j=setInterval(()=>{St(P=>{if(P[b]&&P[b].startedAt){const W=P[b].startedAt,J=W instanceof Date?W.getTime():new Date(W).getTime(),be=Math.floor((Date.now()-J)/1e3);return{...P,[b]:{...P[b],elapsed:be}}}return P})},100);Ht(P=>(console.log(` Setting sub-cue timer state for item ${b}`),{...P,[b]:j}))}else console.log(` Sub-cue timer for item ${b} is not running, state: ${y.timer_state}`)}))}catch(c){console.error(" Error loading sub-cue timers:",c)}},$i=async()=>{if(n?.id){console.log(" Testing database connection...");try{const{data:c,error:p}=await Se.getLastLoadedCue(n.id);p?(console.error(" Database test failed:",p),console.log(" This means the SQL migration needs to be run first"),console.log(" Please run the migrate-timer-states.sql script in your Supabase SQL Editor")):(console.log(" Database connection test passed"),console.log(" Test data received:",c))}catch(c){console.error(" Database connection test error:",c)}}},ss=async()=>{if(!n?.id){console.log(" No event ID for checking running timers");return}console.log(" Checking for running timers for event:",n.id);try{console.log(" Using fallback timer detection..."),Vr({cueName:"Timer Detected",remainingTime:"Check Console"}),En(!0),console.log(" Fallback timer popup shown")}catch(c){console.error(" Error checking running timers:",c)}},il=async()=>{if(console.log(" Master sync: Getting active timer from database..."),!n?.id){console.warn(" No event selected for sync");return}try{const c=await Se.getActiveTimer(n.id);if(!c){console.log(" No active timer found in database");return}console.log(" Found active timer in database:",c);const p=new Date,y=Math.floor(p.getTime()/1e3),b=new Date(c.started_at),E=Math.floor(b.getTime()/1e3),j=c.duration_seconds||0,P=c.is_running;if(console.log(" Timer calculation:",{currentTime:y,startTimeSeconds:E,durationSeconds:j,isRunning:P,currentTimeFormatted:p.toISOString(),startTimeFormatted:b.toISOString()}),Ut(c.item_id),P){const W=y-E,J=j-W;if(console.log(" Time calculation for running timer:",{elapsedSeconds:W,remainingSeconds:J,isOverdue:J<0}),dt(be=>({...be,[c.item_id]:{elapsed:W,total:j,startedAt:b}})),J!==0){J>0?console.log(` Timer synced: ${J} seconds remaining - starting countdown`):console.log(` Timer synced: ${Math.abs(J)} seconds overdue - starting count up`),Re[c.item_id]&&clearInterval(Mr[c.item_id]);const be=setInterval(()=>{dt(we=>{const te=we[c.item_id];if(!te)return we;const de=te.elapsed+1,Ne=te.total-de;return Ne>0?console.log(` Timer countdown: ${Ne} seconds remaining`):console.log(Ne===0?" Timer just expired":` Timer count up: ${Math.abs(Ne)} seconds overdue`),{...we,[c.item_id]:{...te,elapsed:de}}})},1e3);Zr(we=>({...we,[c.item_id]:be}))}else console.log(" Timer just expired")}else console.log(" Timer is loaded but not running - setting duration only"),dt(W=>({...W,[c.item_id]:{elapsed:0,total:j,startedAt:null}})),console.log(` Timer synced: Set loaded duration to ${j} seconds`)}catch(c){console.error(" Error during master sync:",c)}},os=async()=>{if(!(!n?.id||!a?.id))try{console.log(" Backing up schedule data..."),await Se.saveRunOfShowData({event_id:n.id,event_name:n.name,event_date:n.date,schedule_items:O,custom_columns:q,settings:{}}),console.log(" Schedule data backed up")}catch(c){console.error(" Error backing up schedule data:",c)}},kn=async()=>{if(!n?.id){console.log(" No event ID for loading master change log");return}try{console.log(" Loading master change log for event:",n.id);const c=await mt.getMasterChangeLog(n.id,100);M(c),console.log(" Loaded master change log:",c.length,"changes"),c.length===0&&console.log(" No master changes found - this might be normal for new events")}catch(c){console.error(" Error loading master change log:",c),M([])}},Us=async()=>{try{await mt.syncChanges()?(console.log(" Manual sync completed"),kn()):console.log(" Manual sync failed")}catch(c){console.error("Error during manual sync:",c)}},al=async()=>{if(prompt("Enter password to clear all change logs:")!=="1615"){alert("Incorrect password. Change logs not cleared.");return}if(confirm(` WARNING: This will permanently delete ALL change logs (local and master) for this event. This action cannot be undone.

Are you sure you want to continue?`))try{if(mt.clearLocalChanges(),R([]),console.log(" Local changes cleared"),n?.id){console.log(" Attempting to clear master change log for event:",n.id);const{data:{user:y},error:b}=await oe.auth.getUser();if(console.log(" Current user:",y?.id,y?.email),b){console.error(" Auth error:",b),alert(" Authentication error. Please refresh and try again.");return}const E=await mt.clearMasterChangeLog(n.id);if(E.success){M([]),console.log(" Master change log cleared successfully"),console.log(" Verifying master change log is cleared...");const j=await mt.getMasterChangeLog(n.id);console.log(" Master change log after clearing:",j.length,"records"),M(j),j.length===0?alert(` All change logs cleared successfully!

- Local changes:  Cleared
- Master changes:  Cleared (${E.deletedCount} records deleted)`):alert(` Partial success:

- Local changes:  Cleared
- Master changes:  ${E.deletedCount} deleted, but ${j.length} remain

Some records may be protected by RLS policies.`)}else console.log(" Failed to clear master change log:",E.error),alert(` Partial success:

- Local changes:  Cleared
- Master changes:  Failed

Error: ${E.error}

This might be due to database permissions. Check the console for details.`)}else alert(" Error: No event ID found. Cannot clear master change log.")}catch(y){console.error("Error clearing change logs:",y),alert(" Error clearing change logs. Check the console for details.")}};k.useEffect(()=>{if(!zr||Object.keys(Re).length===0){Ae(!1);return}const c=parseInt(Object.keys(Re)[0]),p=O.find(y=>y.id===c);if(p)try{const y=new Date,b=O.findIndex(j=>j.id===p.id),E=qo(b);if(E){const[j,P]=E.split(" "),[W,J]=j.split(":").map(Number);let be=W;P==="PM"&&W!==12&&(be+=12),P==="AM"&&W===12&&(be=0);const we=new Date,te=new Date(we.getFullYear(),we.getMonth(),we.getDate(),be,J),de=y.getTime()-te.getTime(),Ne=Math.round(de/(1e3*60));Li(Math.abs(Ne)),Ne<-1?(Ms("early"),Ae(!0)):Ne>1?(Ms("late"),Ae(!0)):(Ms("on-time"),Ae(!0)),setTimeout(()=>{Ae(!1)},2e4)}}catch(y){console.error("Error calculating time status:",y),Ae(!1)}},[Re,O,zr]);const is=()=>{if(!It)return;const c=document.querySelector(`[data-item-id="${ye}"]`);if(c){const p=c.getBoundingClientRect(),y=window.pageYOffset||document.documentElement.scrollTop,b=p.top+y,E=document.querySelector("#main-scroll-container .h-24");let j=100;E&&(j=E.getBoundingClientRect().height+20);const W=b-j-230;window.scrollTo({top:Math.max(0,W),behavior:"smooth"}),localStorage.setItem(`scrollPosition_${n?.id}`,W.toString())}},[Pe,st]=k.useState({cue:"",day:1,programType:"PreShow/End",shotType:"",segmentName:"",durationHours:0,durationMinutes:0,durationSeconds:0,notes:"",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!1,timerId:"",isPublic:!1,isIndented:!1,customFields:{}});k.useEffect(()=>{st(c=>({...c,day:pe}))},[pe]);const as=["PreShow/End","Podium Transition","Panel Transition","Sub Cue","No Transition","Video","Panel+Remote","Remote Only","Break","TBD","KILLED"],Fs={"PreShow/End":"#8B5CF6","Podium Transition":"#8B4513","Panel Transition":"#696969","Sub Cue":"#F3F4F6","No Transition":"#059669",Video:"#F59E0B","Panel+Remote":"#3B82F6","Remote Only":"#60A5FA",Break:"#EC4899",TBD:"#6B7280",KILLED:"#DC2626"},qt=(c,p,y,b,E)=>{let j=6.5;if(c&&c.trim()!==""){const P=document.createElement("div");P.style.position="absolute",P.style.visibility="hidden",P.style.width="22rem",P.style.padding="0.75rem",P.style.fontSize="1rem",P.style.lineHeight="1.5",P.style.fontFamily="system-ui, -apple-system, sans-serif",P.style.whiteSpace="pre-wrap",P.style.wordWrap="break-word",P.innerHTML=c,document.body.appendChild(P);const W=P.scrollHeight;document.body.removeChild(P);const we=W/16+3;j=Math.max(j,we)}if(y&&y.trim()!=="")try{const P=JSON.parse(y);if(Array.isArray(P)&&P.length>0){const W=P.filter(J=>J.fullName&&J.fullName.trim()!=="");if(W.length>0){const we=4+W.length*1.5;j=Math.max(j,we)}}}catch{if(y.includes(`
`)){const J=4+y.split(`
`).filter(be=>be.trim()!=="").length*1.5;j=Math.max(j,J)}}if(p&&p.trim()!=="")try{const P=JSON.parse(p);if(Array.isArray(P)&&P.length>0){const W=P.filter(J=>J.fullName&&J.fullName.trim()!=="");if(W.length>0){const we=4+W.length*1.5;j=Math.max(j,we)}}}catch{if(p.includes(`
`)){const J=4+p.split(`
`).filter(be=>be.trim()!=="").length*1.5;j=Math.max(j,J)}}return b&&E&&E.length>0&&E.forEach(P=>{const W=b[P.name];if(W&&W.trim()!==""){const J=W.split(`
`),Ne=3+Math.max(2,J.length)*1.6+1;j=Math.max(j,Ne)}}),`${j}rem`},zs=c=>{if(!c||c.trim()==="")return"4.5rem";const p=document.createElement("div");p.style.position="absolute",p.style.visibility="hidden",p.style.width="20rem",p.style.padding="0.5rem",p.style.fontSize="1rem",p.style.lineHeight="1.4",p.style.fontFamily="system-ui, -apple-system, sans-serif",p.style.whiteSpace="pre-wrap",p.style.wordWrap="break-word",p.innerHTML=c,document.body.appendChild(p);const y=p.scrollHeight;document.body.removeChild(p);const b=y/16,E=2.5,j=4.5,P=b+E;return`${Math.max(j,P)}rem`},ls=c=>{if(!c||c.trim()==="")return"3.5rem";let p=1;try{const j=JSON.parse(c);if(Array.isArray(j)){const P=j.filter(W=>W.fullName&&W.fullName.trim()!=="");p=Math.max(1,P.length)}}catch{p=Math.max(1,c.split(`
`).filter(P=>P.trim()!=="").length)}const E=3+(p-1)*1.5;return`${Math.max(3.5,E)}rem`},He=(c,p)=>{const y=document.getElementById("notes-editor");if(y){y.focus();try{switch(c){case"bold":document.execCommand("bold",!1);break;case"italic":document.execCommand("italic",!1);break;case"underline":document.execCommand("underline",!1);break;case"color":p&&document.execCommand("foreColor",!1,p);break;case"highlight":p&&p!=="none"?document.execCommand("backColor",!1,p):document.execCommand("removeFormat",!1);break;case"fontSize":p&&document.execCommand("fontSize",!1,p);break;case"bullet":document.execCommand("insertUnorderedList",!1);break;case"list":document.execCommand("insertOrderedList",!1);break;case"left":document.execCommand("justifyLeft",!1);break;case"center":document.execCommand("justifyCenter",!1);break;case"right":document.execCommand("justifyRight",!1);break;case"undo":document.execCommand("undo",!1);break;case"redo":document.execCommand("redo",!1);break}}catch{console.warn("Formatting command not supported:",c)}}},Mi=()=>{const c=document.getElementById("notes-editor");if(c&&$t!==null){const p=c.innerHTML;if($t===-1)st(y=>({...y,notes:p}));else{const y=O.find(E=>E.id===$t)?.notes||"",b=O.find(E=>E.id===$t);Z(E=>E.map(j=>j.id===$t?{...j,notes:p}:j)),b&&z("FIELD_UPDATE",`Updated notes for "${b.segmentName}"`,{changeType:"FIELD_CHANGE",itemId:b.id,itemName:b.segmentName,fieldName:"notes",oldValue:y,newValue:p,details:{fieldType:"text",characterChange:p.length-y.length}})}wt(!1),qn(null)}},Wr=()=>{if(Zt!==null){const c=JSON.stringify(bt);if(Zt===-1)st(p=>({...p,speakersText:c}));else{const p=O.find(b=>b.id===Zt)?.speakersText||"",y=O.find(b=>b.id===Zt);Z(b=>b.map(E=>E.id===Zt?{...E,speakersText:c}:E)),y&&z("FIELD_UPDATE",`Updated speakers for "${y.segmentName}"`,{changeType:"FIELD_CHANGE",itemId:y.id,itemName:y.segmentName,fieldName:"speakers",oldValue:p,newValue:c,details:{fieldType:"speakers",speakerCount:bt.length,characterChange:c.length-p.length}})}Xr(!1),xn(null)}},Vo=()=>{if(Tt!==null){const c=document.getElementById("assets-list");if(c){const p=c.querySelectorAll(".asset-item"),y=[];p.forEach(E=>{const j=E.querySelector(".asset-name"),P=E.querySelector(".asset-link");if(j&&P){const W=j.value.trim(),J=P.value.trim();W&&y.push(J?`${W}|${J}`:W)}});const b=y.join("||");if(Tt===-1)st(E=>({...E,assets:b}));else{const E=O.find(P=>P.id===Tt)?.assets||"",j=O.find(P=>P.id===Tt);Z(P=>P.map(W=>W.id===Tt?{...W,assets:b}:W)),j&&z("FIELD_UPDATE",`Updated assets for "${j.segmentName}"`,{changeType:"FIELD_CHANGE",itemId:j.id,itemName:j.segmentName,fieldName:"assets",oldValue:E,newValue:b,details:{fieldType:"assets",assetCount:y.length,characterChange:b.length-E.length}})}Lr(!1),wn(null)}}},cs=()=>{const c=document.getElementById("assets-list");if(c){const p=document.createElement("div");p.className="asset-item p-3 bg-slate-700 rounded-lg space-y-3",p.innerHTML=`
        <div class="flex gap-3 items-center">
          <input type="text" class="asset-name flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Asset name..." />
          <button type="button" class="toggle-link px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded transition-colors text-sm">
            + Link
          </button>
          <button type="button" class="remove-asset px-3 py-2 bg-red-600 hover:bg-red-500 text-white rounded transition-colors">Remove</button>
        </div>
        <div class="asset-link-container hidden">
          <input type="url" class="asset-link w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Enter asset URL..." />
        </div>
      `;const y=p.querySelector(".toggle-link"),b=p.querySelector(".asset-link-container"),E=p.querySelector(".asset-link");y?.addEventListener("click",()=>{b?.classList.contains("hidden")?(b.classList.remove("hidden"),y.textContent=" Link",y.classList.remove("bg-blue-600","hover:bg-blue-500"),y.classList.add("bg-slate-600","hover:bg-slate-500"),E?.focus()):(b?.classList.add("hidden"),y.textContent="+ Link",y.classList.remove("bg-slate-600","hover:bg-slate-500"),y.classList.add("bg-blue-600","hover:bg-blue-500"),E&&(E.value=""))}),p.querySelector(".remove-asset")?.addEventListener("click",()=>{p.remove()}),c.appendChild(p)}},Wo=()=>{if(pt.length>=7)return;const c=pt.map(b=>b.slot),p=[1,2,3,4,5,6,7].find(b=>!c.includes(b))||1,y={id:`speaker_${Date.now()}`,slot:p,location:"Podium",fullName:"",title:"",org:"",photoLink:""};ar(b=>[...b,y].sort((E,j)=>E.slot-j.slot))},Vs=c=>{ar(p=>p.filter(y=>y.id!==c))},Nr=(c,p,y)=>{ar(b=>b.map(E=>E.id===c?{...E,[p]:y}:E).sort((E,j)=>E.slot-j.slot))},Ui=()=>{if(Sr!==null){const c=JSON.stringify(pt);Sr===-1?st(p=>({...p,speakers:c})):Z(p=>p.map(y=>y.id===Sr?{...y,speakers:c}:y)),$r(!1),_r(null)}},zt=()=>{if(bt.length>=7)return;const c=bt.map(b=>b.slot),p=[1,2,3,4,5,6,7].find(b=>!c.includes(b))||1,y={id:Date.now().toString(),fullName:"",location:"Podium",slot:p,title:"",org:"",photoLink:""};ir(b=>[...b,y])},Nn=c=>{ir(p=>p.filter(y=>y.id!==c))},jr=(c,p,y)=>{ir(b=>b.map(E=>E.id===c?{...E,[p]:y}:E))},us=(c,p)=>{if(bt.some(b=>b.id!==c&&b.slot===p)){const b=bt.find(E=>E.id!==c&&E.slot===p);if(b){const E=bt.find(j=>j.id===c);E&&jr(b.id,"slot",E.slot)}}jr(c,"slot",p)},ll=(c,p)=>{const y=pt.find(E=>E.id===c);if(!y)return;const b=pt.find(E=>E.id!==c&&E.slot===p);if(b){const E=pt.map(j=>j.id===c?{...j,slot:p}:j.id===b.id?{...j,slot:y.slot}:j);ar(E)}else Nr(c,"slot",p)},Ws=c=>{if(!c)return"Click to add participants...";try{const p=JSON.parse(c);return!Array.isArray(p)||p.length===0?"Click to add participants...":p.sort((y,b)=>y.slot-b.slot).map(y=>`${y.location==="Podium"?"P":y.location==="Seat"?"S":"V"}${y.slot} - ${y.fullName||"Unnamed"}`).join(`
`)}catch{return"Click to add participants..."}},ds=c=>{if(!c)return"Click to add speakers...";try{const p=JSON.parse(c);return!Array.isArray(p)||p.length===0?"Click to add speakers...":p.sort((y,b)=>y.slot-b.slot).filter(y=>y.fullName&&y.fullName.trim()!=="").map(y=>`${y.location==="Podium"?"P":y.location==="Seat"?"S":"V"}${y.slot} - ${y.fullName||"Unnamed"}`).join(`
`)}catch{return"Click to add speakers..."}},jn=["Podium","2-Shot","3-Shot","4-Shot","5-Shot","6-Shot","7-Shot","Ted-Talk"],Bs=c=>{if(isNaN(c)||c===void 0||c===null)return console.warn(" formatTime received invalid value:",c),"00:00:00";const p=c<0,y=Math.abs(c),b=Math.floor(y/3600),E=Math.floor(y%3600/60),j=Math.floor(y%60);return`${p?"-":""}${b.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}:${j.toString().padStart(2,"0")}`},Fi=c=>{if(isNaN(c)||c===void 0||c===null)return console.warn(" formatSubCueTime received invalid value:",c),"00:00";const p=c<0,y=Math.abs(c),b=Math.floor(y/3600),E=Math.floor(y%3600/60),j=Math.floor(y%60),P=p?"-":"";return b===0?`${P}${E.toString().padStart(2,"0")}:${j.toString().padStart(2,"0")}`:`${P}${b.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}:${j.toString().padStart(2,"0")}`},hs=c=>{const p=O.find(b=>b.id===c);if(!p||!p.isIndented)return!1;const y=O.findIndex(b=>b.id===c);if(y===-1)return!1;for(let b=y-1;b>=0;b--){const E=O[b];if(!E.isIndented)return Re[E.id]!==void 0}return!1},cl=()=>{const c=Object.keys(Re);if(c.length>0){const y=parseInt(c[0]);if(Qe[y]){const b=Qe[y];return b.total-b.elapsed}}const p=Object.keys(Be);if(p.length>0){const y=parseInt(p[0]);if(Er[y]){const b=Er[y];return b.total-b.elapsed}}if(ye&&Qe[ye]){const y=Qe[ye];return y.total-y.elapsed}return 0},ul=()=>{const c=Object.keys(Re);if(c.length>0){const y=parseInt(c[0]);if(Qe[y]){const b=Qe[y],E=b.total-b.elapsed;return E<0?0:b.total>0?E/b.total*100:0}}const p=Object.keys(Be);if(p.length>0){const y=parseInt(p[0]);if(Er[y]){const b=Er[y],E=b.total-b.elapsed;return b.total>0?E/b.total*100:0}}if(ye&&Qe[ye]){const y=Qe[ye],b=y.total-y.elapsed;return y.total>0?b/y.total*100:0}return 0},Bo=()=>{const c=Object.keys(Re);if(c.length>0){const y=parseInt(c[0]);if(Qe[y]){const b=Qe[y],E=b.total-b.elapsed;return E<0?"bg-red-500":E>120?"#10b981":E>30?"#f59e0b":"#ef4444"}}const p=Object.keys(Be);if(p.length>0){const y=parseInt(p[0]);if(Er[y]){const b=Er[y],E=b.total-b.elapsed;return E>120?"#10b981":E>30?"#f59e0b":"#ef4444"}}if(ye&&Qe[ye]){const y=Qe[ye],b=y.total-y.elapsed;return b>120?"#10b981":b>30?"#f59e0b":"#ef4444"}return"transparent"},dl=()=>{const c=Object.keys(Re);if(c.length>0){const p=parseInt(c[0]);if(Qe[p]){const y=Qe[p],b=y.total-y.elapsed;return b>120?"#10b981":b>30?"#f59e0b":"#ef4444"}}if(ye&&Qe[ye]){const p=Qe[ye],y=p.total-p.elapsed;return y>120?"#10b981":y>30?"#f59e0b":"#ef4444"}return"#ffffff"},Hs=async c=>{if(!ye||!a||!n?.id)return;const p=O.find(P=>P.id===ye);if(!p)return;const y=Math.max(0,p.durationHours*3600+p.durationMinutes*60+p.durationSeconds+c),b=Math.floor(y/3600),E=Math.floor(y%3600/60),j=y%60;Z(P=>P.map(W=>W.id===ye?{...W,durationHours:b,durationMinutes:E,durationSeconds:j}:W)),Qe[ye]&&(console.log(" Updating timer duration for item:",ye,"new duration:",y),dt(P=>({...P,[ye]:{...P[ye],total:y}})),Re[ye]?(console.log(" Timer duration updated locally for running timer"),await Se.updateTimerDuration(n.id,ye,y)?console.log(" Timer duration updated on server - Browser B will see the change"):console.warn(" Failed to update timer duration on server"),await os(),console.log(" Time adjustment completed locally and on server")):console.log(" Timer duration updated locally for loaded timer"))},zi=async c=>{if(console.log(" loadCue function STARTED with itemId:",c),console.log(" loadCue function STARTED with itemId:",c),console.log(" loadCue function STARTED with itemId:",c),!a||!n?.id){console.log(" Missing user or event ID:",{user:!!a,eventId:n?.id});return}Object.keys(Re).forEach(async j=>{if(Re[parseInt(j)]){clearInterval(Mr[parseInt(j)]),er(W=>({...W,[parseInt(j)]:!0}));const P=O.find(W=>W.id===parseInt(j));console.log(" About to mark cue as completed:",{eventId:n.id,itemId:parseInt(j),userId:a.id,cueId:P?.customFields?.cue||"CUE"});try{const W=await Se.markCueCompleted(n.id,parseInt(j),P?.customFields?.cue||"CUE",a.id,a.user_metadata?.full_name||a.email||"Unknown User",d);console.log(" Mark completed result:",W)}catch(W){console.error(" Error marking cue as completed:",W)}}}),lr({}),console.log(" Stopping all timers in Supabase for event:",n.id,"user:",a.id);const p=await Se.stopAllTimersForEvent(n.id,a.id);if(console.log(" Stop all timers result:",p),ye&&ye!==c){cr(W=>new Set([...W,ye])),er(W=>({...W,[ye]:!0}));const j=O.find(W=>W.id===ye);console.log(" About to mark active cue as completed:",{eventId:n.id,itemId:ye,userId:a.id,cueId:j?.customFields?.cue||"CUE"});try{const W=await Se.markCueCompleted(n.id,ye,j?.customFields?.cue||"CUE",a.id,a.user_metadata?.full_name||a.email||"Unknown User",d);console.log(" Mark active completed result:",W)}catch(W){console.error(" Error marking active cue as completed:",W)}const P=O.findIndex(W=>W.id===ye);if(P!==-1)for(let W=P+1;W<O.length&&O[W].isIndented;W++)er(J=>({...J,[O[W].id]:!0})),cr(J=>new Set([...J,O[W].id])),await Se.markCueCompleted(n.id,O[W].id,O[W].customFields?.cue||"CUE",a.id,a.user_metadata?.full_name||a.email||"Unknown User",d)}er(j=>{const P={...j};delete P[c];const W=O.findIndex(J=>J.id===c);if(W!==-1)for(let J=W+1;J<O.length&&O[J].isIndented;J++)delete P[O[J].id];return P}),cr(j=>{const P=new Set(j);P.delete(c);const W=O.findIndex(J=>J.id===c);if(W!==-1)for(let J=W+1;J<O.length&&O[J].isIndented;J++)P.delete(O[J].id);return P});const y=O.find(j=>j.id===c);if(y){console.log(" Item found:",y),console.log(" Item ID type:",typeof y.id,"Value:",y.id),console.log(" Item duration values:",{durationHours:y.durationHours,durationMinutes:y.durationMinutes,durationSeconds:y.durationSeconds});const j=y.durationHours*3600+y.durationMinutes*60+y.durationSeconds;console.log(" Calculated total seconds:",j);const P=typeof c=="string"?parseInt(c):c;console.log(" Numeric item ID:",P),console.log(" Optimistic UI update - showing loaded state immediately"),dt(te=>({...te,[c]:{elapsed:0,total:j,startedAt:null}})),Ut(c),Ur(te=>({...te,[c]:!0}));const J=O.findIndex(te=>te.id===c)+1,be=ur(y.customFields.cue),we=y.timerId;console.log(" Loading CUE in Supabase:",{eventId:n.id,itemId:P,userId:a.id,totalSeconds:j,rowNumber:J,cueDisplay:be,timerId:we}),console.log(" About to call DatabaseService.loadCue..."),console.log(" DatabaseService object:",typeof Se),console.log(" DatabaseService.loadCue function:",typeof Se.loadCue),console.log(" Testing Supabase configuration...");try{const{isSupabaseConfigured:te}=await Co(async()=>{const{isSupabaseConfigured:de}=await Promise.resolve().then(()=>Dv);return{isSupabaseConfigured:de}},void 0);console.log(" Supabase configured:",te)}catch(te){console.error(" Error importing Supabase config:",te)}try{console.log(" Calling DatabaseService.loadCue now...");const te=await Se.loadCue(n.id,P,a.id,j,J,be,we);console.log(" Load CUE result:",te),te?console.log(" Load CUE succeeded!"):console.error(" Load CUE failed - check database connection and functions")}catch(te){console.error(" Load CUE error:",te),console.error(" Error stack:",te.stack)}console.log(" Finished loadCue database call"),rn(P);try{await Se.updateLastLoadedCue(n.id,P,"loaded"),console.log(" Last loaded CUE saved")}catch(te){console.log(" Could not save last loaded CUE (migration may not be run):",te)}await os(),console.log(" Load CUE action completed locally")}const b=O.findIndex(j=>j.id===c),E=new Set;if(b!==-1)for(let j=b+1;j<O.length&&O[j].isIndented;j++)E.add(O[j].id);Fr(E)},Vi=async()=>{if(Object.keys(Re).forEach(c=>{Re[parseInt(c)]&&clearInterval(Mr[parseInt(c)])}),Object.keys(Be).forEach(c=>{Be[parseInt(c)]&&clearInterval(Be[parseInt(c)])}),n?.id)try{await Se.clearCompletedCues(n.id),console.log(" Cleared completed cues from database"),await Se.clearAllActiveTimersForEvent(n.id),console.log(" Cleared all active timers from Supabase")}catch(c){console.warn(" Failed to clear database:",c)}lr({}),Ht({}),dt({}),St({}),er({}),Ut(null),cr(new Set),Fr(new Set)},hl=()=>{en(!1),Ot&&!Ot.closed&&Ot.close();const c=Object.keys(Re),p=c.length>0?O.find(E=>Re[E.id]):O.find(E=>E.id===ye),y={isRunning:c.length>0,elapsedTime:p&&Qe[p.id]?Qe[p.id].elapsed:0,totalDuration:p?p.durationHours*3600+p.durationMinutes*60+p.durationSeconds:0,eventId:n?.id,mainTimer:p?{cue:p.customFields.cue||"CUE",segmentName:p.segmentName||""}:null,secondaryTimer:Ge?{itemId:Ge.itemId,remaining:Ge.remaining,duration:Ge.duration,cue:O.find(E=>E.id===Ge.itemId)?.customFields.cue||"CUE",segmentName:O.find(E=>E.id===Ge.itemId)?.segmentName||""}:null},b=window.open("/fullscreen-timer","fullScreenTimer","width=1920,height=1080,fullscreen=yes,menubar=no,toolbar=no,location=no,status=no,scrollbars=no,resizable=yes");b&&(Ci(b),b.addEventListener("load",()=>{b.postMessage({type:"TIMER_UPDATE",...y},"*")}))};k.useEffect(()=>{const c=()=>{Qn(null),bn(null),en(!1)};return document.addEventListener("click",c),()=>document.removeEventListener("click",c)},[]),k.useEffect(()=>{if(Je&&$t!==null){const c=document.getElementById("notes-editor");if(c)if($t===-1)c.innerHTML=Pe.notes||"";else{const p=O.find(y=>y.id===$t);c.innerHTML=p?.notes||""}}},[Je,$t,O,Pe.notes]),k.useEffect(()=>{if(yn&&Zt!==null)if(Zt===-1)if(Pe.speakersText)try{const c=JSON.parse(Pe.speakersText);ir(Array.isArray(c)?c:[])}catch{ir([])}else ir([]);else{const c=O.find(p=>p.id===Zt);if(c?.speakersText)try{const p=JSON.parse(c.speakersText);ir(Array.isArray(p)?p:[])}catch{ir([])}else ir([])}},[yn,Zt,O,Pe.speakersText]),k.useEffect(()=>{if(Kn&&Tt!==null){const c=document.getElementById("assets-list");if(c){c.innerHTML="";let p="";Tt===-1?p=Pe.assets||"":p=O.find(b=>b.id===Tt)?.assets||"",p&&p.split("||").forEach(b=>{if(b.trim()){const[E,j]=b.split("|"),P=j&&j.trim()!=="",W=document.createElement("div");W.className="asset-item p-3 bg-slate-700 rounded-lg space-y-3",W.innerHTML=`
                <div class="flex gap-3 items-center">
                  <input type="text" class="asset-name flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Asset name..." value="${E||""}" />
                  <button type="button" class="toggle-link px-3 py-2 text-white rounded transition-colors text-sm ${P?"bg-slate-600 hover:bg-slate-500":"bg-blue-600 hover:bg-blue-500"}">
                    ${P?" Link":"+ Link"}
                  </button>
                  <button type="button" class="remove-asset px-3 py-2 bg-red-600 hover:bg-red-500 text-white rounded transition-colors">Remove</button>
                </div>
                <div class="asset-link-container ${P?"":"hidden"}">
                  <input type="url" class="asset-link w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Enter asset URL..." value="${j||""}" />
                </div>
              `;const J=W.querySelector(".toggle-link"),be=W.querySelector(".asset-link-container"),we=W.querySelector(".asset-link");J?.addEventListener("click",()=>{be?.classList.contains("hidden")?(be.classList.remove("hidden"),J.textContent=" Link",J.classList.remove("bg-blue-600","hover:bg-blue-500"),J.classList.add("bg-slate-600","hover:bg-slate-500"),we?.focus()):(be?.classList.add("hidden"),J.textContent="+ Link",J.classList.remove("bg-slate-600","hover:bg-slate-500"),J.classList.add("bg-blue-600","hover:bg-blue-500"),we&&(we.value=""))}),W.querySelector(".remove-asset")?.addEventListener("click",()=>{W.remove()}),c.appendChild(W)}}),c.children.length===0&&cs()}}},[Kn,Tt,O,Pe.assets]),k.useEffect(()=>{if(Jn&&Sr!==null)if(Sr===-1)if(Pe.speakers)try{const c=JSON.parse(Pe.speakers);ar(Array.isArray(c)?c:[])}catch{ar([])}else ar([]);else{const c=O.find(p=>p.id===Sr);if(c?.speakers)try{const p=JSON.parse(c.speakers);ar(Array.isArray(p)?p:[])}catch{ar([])}else ar([])}},[Jn,Sr,O,Pe.speakers]);const rr=Ja.useCallback(fl(async()=>{if(n?.id)try{const c={event_id:n.id,event_name:n.name,event_date:n.date,schedule_items:O,custom_columns:q,settings:{eventName:ce,masterStartTime:De,dayStartTimes:Fe,lastSaved:new Date().toISOString()}};console.log(" Auto-saving to Supabase:",{eventId:n.id,scheduleItemsCount:O.length,customColumnsCount:q.length,eventName:ce,masterStartTime:De,sampleScheduleItem:O[0]?{id:O[0].id,segmentName:O[0].segmentName,speakersText:O[0].speakersText?"Has speakers data":"No speakers data",speakers:O[0].speakers?"Has speakers data":"No speakers data"}:"No schedule items"});const p=await Se.saveRunOfShowData(c,{userId:a?.id||"unknown",userName:a?.user_metadata?.full_name||a?.email||"Unknown User",userRole:d});console.log(" Auto-saved to Supabase successfully")}catch(c){console.error(" Error auto-saving to Supabase:",c)}},1e3),[n?.id,n?.name,n?.date,O,q,ce,De,Fe]);function fl(c,p){let y;return((...b)=>{clearTimeout(y),y=setTimeout(()=>c(...b),p)})}const Wi=k.useCallback(async()=>{if(n?.id)try{console.log(" Loading from Supabase for event:",n.id);const c=await Se.getRunOfShowData(n.id);if(console.log(" Debug - Raw data from Supabase:",c),console.log(" Debug - schedule_items:",c?.schedule_items),console.log(" Debug - custom_columns:",c?.custom_columns),console.log(" Debug - settings:",c?.settings),c)console.log(" Data loaded from Supabase:",{scheduleItemsCount:c.schedule_items?.length||0,customColumnsCount:c.custom_columns?.length||0,eventName:c.settings?.eventName,masterStartTime:c.settings?.masterStartTime,sampleScheduleItem:c.schedule_items?.[0]?{id:c.schedule_items[0].id,segmentName:c.schedule_items[0].segmentName,speakersText:c.schedule_items[0].speakersText?"Has speakers data":"No speakers data",speakers:c.schedule_items[0].speakers?"Has speakers data":"No speakers data"}:"No schedule items"}),Z(c.schedule_items||[]),Y(c.custom_columns||[]),c.settings?.eventName&&ke(c.settings.eventName),c.settings?.masterStartTime&&et(c.settings.masterStartTime),c.settings?.dayStartTimes&&ie(c.settings.dayStartTimes),console.log(" Run of Show data loaded from Supabase successfully");else{console.log(" No data found in Supabase, falling back to localStorage for event:",n.id);const p=localStorage.getItem(`runOfShowSchedule_${n.id}`),y=localStorage.getItem(`customColumns_${n.id}`),b=localStorage.getItem(`eventName_${n.id}`),E=localStorage.getItem(`masterStartTime_${n.id}`),j=localStorage.getItem(`dayStartTimes_${n.id}`);if(p){const W=JSON.parse(p).map(J=>({...J,day:J.day||1}));Z(W),console.log(" Loaded schedule from localStorage:",W.length,"items")}y&&(Y(JSON.parse(y)),console.log(" Loaded custom columns from localStorage")),b&&(ke(b),console.log(" Loaded event name from localStorage")),E&&(et(E),console.log(" Loaded master start time from localStorage")),j&&(ie(JSON.parse(j)),console.log(" Loaded day start times from localStorage"))}}catch(c){console.error(" Error loading run of show data from Supabase:",c),console.log(" Falling back to localStorage due to error");const p=localStorage.getItem(`runOfShowSchedule_${n.id}`);if(p){const b=JSON.parse(p).map(E=>({...E,day:E.day||1}));Z(b),console.log(" Loaded schedule from localStorage after error:",b.length,"items")}}},[n?.id]);k.useEffect(()=>{n?.id&&Wi()},[n?.id,Wi]),k.useEffect(()=>{n?.id&&(localStorage.setItem(`runOfShowSchedule_${n.id}`,JSON.stringify(O)),window.dispatchEvent(new CustomEvent("scheduleUpdated",{detail:{eventId:n.id,schedule:O}})),console.log(" Schedule saved and event dispatched for event:",n.id),rr())},[O,n?.id,rr]),k.useEffect(()=>{n?.id&&(localStorage.setItem(`customColumns_${n.id}`,JSON.stringify(q)),rr())},[q,n?.id,rr]),k.useEffect(()=>{n?.id&&(localStorage.setItem(`eventName_${n.id}`,ce),rr())},[ce,n?.id,rr]),k.useEffect(()=>{n?.id&&(localStorage.setItem(`masterStartTime_${n.id}`,De),rr())},[De,n?.id,rr]),k.useEffect(()=>{n?.id&&(localStorage.setItem(`dayStartTimes_${n.id}`,JSON.stringify(Fe)),rr())},[Fe,n?.id,rr]),k.useEffect(()=>{if(Ot&&!Ot.closed){const c=Object.keys(Re),p=c.length>0?O.find(b=>Re[b.id]):O.find(b=>b.id===ye),y={type:"TIMER_UPDATE",isRunning:c.length>0,elapsedTime:p&&Qe[p.id]?Qe[p.id].elapsed:0,totalDuration:p&&Qe[p.id]?Qe[p.id].total:p?p.durationHours*3600+p.durationMinutes*60+p.durationSeconds:0,eventId:n?.id,itemId:p?.id,mainTimer:p?{cue:p.customFields.cue||"CUE",segmentName:p.segmentName||""}:null,secondaryTimer:Ge?{itemId:Ge.itemId,remaining:Ge.remaining,duration:Ge.duration,cue:O.find(b=>b.id===Ge.itemId)?.customFields.cue||"CUE",segmentName:O.find(b=>b.id===Ge.itemId)?.segmentName||""}:null};Ot.postMessage(y,"*")}},[Re,Qe,ye,O,De,ce,Ot,Ge]);const ml=c=>{const p=()=>{const E="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let j="";for(let P=0;P<5;P++)j+=E.charAt(Math.floor(Math.random()*E.length));return j},y={...c,id:Date.now(),timerId:p(),isIndented:c.isIndented||!1,customFields:{cue:c.cue?`CUE${c.cue}`:"CUE"}};$e!==null?(Z(E=>{const j=[...E];return j.splice($e+1,0,y),j}),Ue(null)):Z(E=>[...E,y]);const b=$e!==null?$e+2:O.length+1;z("ADD_ITEM",`Added new schedule item: "${y.segmentName}"`,{changeType:"ADD",itemId:y.id,itemName:y.segmentName,rowNumber:b,cueNumber:y.customFields.cue,details:{day:y.day,programType:y.programType,shotType:y.shotType,position:`Row ${b}`,durationHours:y.durationHours,durationMinutes:y.durationMinutes,totalDurationMinutes:y.durationHours*60+y.durationMinutes,speakers:y.speakers||"None",speakersText:y.speakersText||"None",notes:y.notes||"",assets:y.assets||"None",hasPPT:y.hasPPT,hasQA:y.hasQA,timerId:y.timerId,isPublic:y.isPublic,isIndented:y.isIndented}}),H(!1),st({cue:"",day:pe,programType:"PreShow/End",shotType:"",segmentName:"",durationHours:0,durationMinutes:0,durationSeconds:0,notes:"",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!1,timerId:"",isPublic:!1,isIndented:!1,customFields:{}})},Bi=c=>{const p={name:c,id:Date.now().toString()};Y(y=>[...y,p]),Z(y=>y.map(b=>({...b,customFields:{...b.customFields,[c]:""}}))),z("COLUMN_ADD",`Added custom column "${c}"`,{changeType:"COLUMN_ADD",columnName:c,details:{columnType:"text",affectedItems:O.length,defaultValue:""}}),ze(!1)},Ho=c=>{const p=q.find(y=>y.id===c);p&&(Y(y=>y.filter(b=>b.id!==c)),Z(y=>y.map(b=>{const{[p.name]:E,...j}=b.customFields;return{...b,customFields:j}})),z("COLUMN_REMOVE",`Removed custom column "${p.name}"`,{changeType:"COLUMN_REMOVE",columnName:p.name,details:{affectedItems:O.length,columnId:p.id}}))},ot=(c,p)=>{c.preventDefault(),c.stopPropagation();const y=c.clientX,b=Oe[p]||256;document.body.style.cursor="col-resize",document.body.style.userSelect="none";const E=P=>{const W=P.clientX-y,J=Math.max(100,b+W);nl(be=>({...be,[p]:J}))},j=()=>{document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",j)};document.addEventListener("mousemove",E),document.addEventListener("mouseup",j)},Hi=(c,p)=>{c.preventDefault(),c.stopPropagation();const y=c.clientX,b=$s[p]||256;document.body.style.cursor="col-resize",document.body.style.userSelect="none";const E=P=>{const W=P.clientX-y,J=Math.max(100,b+W);sl(be=>({...be,[p]:J}))},j=()=>{document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",j)};document.addEventListener("mousemove",E),document.addEventListener("mouseup",j)},fs=async c=>{if(!(!a||!n?.id))if(Re[c]){clearInterval(Mr[c]);const p=`${c}_drift`;Re[p]&&clearInterval(Mr[p]),lr(b=>{const E={...b};return delete E[c],delete E[p],E}),Zr(b=>{const E={...b};return delete E[c],delete E[p],E}),Jr.stopMonitoring(c),Ps(b=>{const E=new Set(b);return E.delete(c),E}),er(b=>({...b,[c]:!0})),cr(b=>new Set([...b,c]));try{const b=O.find(E=>E.id===c);await Se.markCueCompleted(n.id,c,b?.customFields?.cue||"CUE",a.id,a.user_metadata?.full_name||a.email||"Unknown User",d)}catch(b){console.warn(" Failed to mark cue as completed in database:",b),console.log(" This means the completed_cues table needs to be created first")}const y=O.findIndex(b=>b.id===c);if(y!==-1)for(let b=y+1;b<O.length&&O[b].isIndented;b++)er(E=>({...E,[O[b].id]:!0})),cr(E=>new Set([...E,O[b].id])),await Se.markCueCompleted(n.id,O[b].id,O[b].customFields?.cue||"CUE",a.id,a.user_metadata?.full_name||a.email||"Unknown User",d);Ur(b=>{const E={...b};return delete E[c],E}),ye===c&&Ut(null),dt(b=>{const E={...b};return delete E[c],E}),console.log(" Stopping timer in Supabase for item:",c),await Se.stopTimer(n.id,c,a.id),console.log(" Timer stopped in Supabase");try{await Se.updateLastLoadedCue(n.id,c,"stopped"),console.log(" Last loaded CUE saved as stopped")}catch(b){console.log(" Could not save last loaded CUE as stopped (migration may not be run):",b)}await os()}else{if(Object.keys(Re).length>0)return;const p=O.find(y=>y.id===c);if(p){const y=p.durationHours*3600+p.durationMinutes*60+p.durationSeconds;console.log(" Optimistic UI update - showing running state immediately");const b=new Date;dt(te=>({...te,[c]:{elapsed:0,total:y,startedAt:b}}));const E=setInterval(()=>{dt(te=>{if(te[c]){if(Lo.has(c)&&Re[c]&&te[c]?.startedAt)return console.log(` Timer ${c}: Skipping local update - using server-synced time (Browser A)`),te;const de=Date.now(),Ne=te[c].startedAt;let qe;Ne instanceof Date?qe=Ne.getTime():typeof Ne=="string"?qe=new Date(Ne).getTime():(console.warn(" startedAt is not a Date or string:",Ne),qe=de);const Ye=Math.floor((de-qe)/1e3),mr=y-Ye;return Jr.updateLocalElapsed(c,Ye),Ye<=10&&console.log(` Timer ${c}: Elapsed=${Ye}s, Remaining=${mr}s, Start=${new Date(qe).toISOString()}, Now=${new Date(de).toISOString()}`),{...te,[c]:{...te[c],elapsed:Ye}}}return te})},100);Zr(te=>({...te,[c]:E})),lr(te=>({...te,[c]:!0})),console.log(` Starting drift detection for timer ${c} with duration ${y}s`),console.log(" Drift detector config:",Jr.getConfig()),Jr.startMonitoring(c,b,y,te=>{console.log(` DriftDetector: Syncing timer ${c} with server elapsed: ${te}s`),Ps(de=>{const Ne=new Set([...de,c]);return console.log(` DriftDetector: Marking timer ${c} as server-synced. Server-synced timers:`,Array.from(Ne)),Ne}),dt(de=>{const Ne={...de,[c]:{...de[c],elapsed:te}};return console.log(` DriftDetector: Updated timer ${c} progress to elapsed: ${te}s`),Ne})});const j=Jr.getStatus();console.log(" Drift detector status after starting:",j),console.log(` Timer ${c} will run locally until first drift sync`);const W=O.findIndex(te=>te.id===c)+1,J=ur(p.customFields.cue),be=p.timerId;console.log(" Starting timer in Supabase for item:",c,"at:",b.toISOString(),"row:",W,"cue:",J,"timerId:",be);try{const te=await Se.startTimer(n.id,c,a.id,y,b,W,J,be);console.log(" Timer started in Supabase:",te),te||console.error(" Start timer failed - check database connection and functions")}catch(te){console.error(" Start timer error:",te)}try{await Se.updateLastLoadedCue(n.id,c,"running"),console.log(" Last loaded CUE saved as running")}catch(te){console.log(" Could not save last loaded CUE as running (migration may not be run):",te)}const we=setInterval(async()=>{try{console.log(` DriftDetector: Starting periodic sync for timer ${c}`),await Jr.forceSync(c,async()=>{const de=(await Se.getActiveTimer(n.id))?.elapsed_seconds||0;return console.log(` DriftDetector: Server returned elapsed: ${de}s for timer ${c}`),de}),console.log(` DriftDetector: Periodic sync completed for timer ${c}`)}catch(te){console.warn(` DriftDetector: Failed to sync timer ${c}:`,te)}},3e4);Zr(te=>({...te,[`${c}_drift`]:we})),console.log(" Timer started locally with drift detection enabled"),await os(),cr(te=>{const de=new Set(te);de.delete(c);const Ne=O.findIndex(qe=>qe.id===c);if(Ne!==-1)for(let qe=Ne+1;qe<O.length&&O[qe].isIndented;qe++)de.delete(O[qe].id);return de})}}},qi=async c=>{if(!(!a||!n?.id)){if(console.log(" Reset timer for item:",c),Re[c]){clearInterval(Mr[c]);const p=`${c}_drift`;Mr[p]&&clearInterval(Mr[p]),lr(y=>{const b={...y};return delete b[c],delete b[p],b}),Zr(y=>{const b={...y};return delete b[c],delete b[p],b}),Jr.stopMonitoring(c),Ps(y=>{const b=new Set(y);return b.delete(c),b}),dt(y=>{const b={...y};return delete b[c],b});try{await Se.stopTimer(n.id,c,a.id),console.log(" Timer reset in Supabase")}catch(y){console.error(" Error resetting timer in database:",y)}}Ur(p=>{const y={...p};return delete y[c],y}),ye===c&&Ut(null),console.log(" Timer reset completed for item:",c)}},pl=async c=>{if(!a||!n?.id)return;const p=O.find(y=>y.id===c);if(p&&p.isIndented){const y=p.durationHours*3600+p.durationMinutes*60+p.durationSeconds;console.log(" Starting secondary timer for item:",c,"Duration:",y,"s"),St(E=>({...E,[c]:{elapsed:0,total:y,startedAt:new Date}}));const b=setInterval(()=>{St(E=>{const j=E[c];if(!j)return E;const P=Math.floor((Date.now()-(j.startedAt?.getTime()||Date.now()))/1e3);return Math.max(0,j.total-P),{...E,[c]:{...j,elapsed:P}}}),Mt(E=>{if(!E)return null;if(Zn)return E;const j=E.startedAt?.getTime()||Date.now(),P=Math.floor((Date.now()-j)/1e3),W=Math.max(0,E.duration-P);if(W===0){console.log(" Sub-cue timer reached 0 - holding for a beat");const J=n?.id;console.log(" Current event ID for database call:",J),setTimeout(()=>{console.log(" Sub-cue timer auto-stopping after hold - clearing local state"),Gn&&(clearInterval(Gn),Do(null)),Object.keys(Be).forEach(be=>{Be[parseInt(be)]&&clearInterval(Be[parseInt(be)])}),Ht({}),St({}),Mt(null),setTimeout(async()=>{try{if(J){console.log(" Clearing sub-cue timer from database after 3s delay with event ID:",J);const be=await Se.stopSubCueTimer(J);console.log(" Database stop result:",be),console.log(" Sub-cue timer stopped in database (is_active = false)")}else console.error(" No event ID available for database call")}catch(be){console.error(" Error stopping sub-cue timer in database:",be),console.error(" Error details:",be)}},3e3)},1e3)}return{...E,remaining:W}})},1e3);Ht(E=>({...E,[c]:b})),Mt({itemId:c,remaining:y,duration:y,isActive:!0,startedAt:new Date,timerState:"running"});try{console.log(" User ID:",a.id,"Event ID:",n.id);const E=O.find(J=>J.id===c),j=O.findIndex(J=>J.id===c)+1,P=E?ur(E.customFields.cue):`CUE ${c}`,W=E?.timerId||`SUB${c}`;try{console.log(" Starting sub-cue timer for item:",c,"(will auto-stop any existing timers)");const J=await Se.startSubCueTimer(n.id,c,a.id,y,j,P,W);console.log(" Secondary timer started in Supabase for item:",c,"Result:",J),J?.error&&console.error(" Secondary timer database error:",J.error)}catch(J){console.error(" Secondary timer call failed:",J)}try{console.log(" Sub-cue timer started locally"),console.log(" Secondary timer action broadcasted")}catch(J){console.error(" Error broadcasting secondary timer action:",J)}await tr()}catch(E){console.error(" Error starting secondary timer:",E),clearInterval(b),Ht(j=>{const P={...j};return delete P[c],P}),St(j=>{const P={...j};return delete P[c],P})}}},gl=async()=>{if(n?.id){console.log(" Stopping secondary timer..."),Mt(null),Gn&&(clearInterval(Gn),Do(null)),Object.keys(Be).forEach(c=>{Be[parseInt(c)]&&clearInterval(Be[parseInt(c)])}),Ht({}),St({}),console.log(" Local secondary timer state cleared");try{console.log(" Stopping sub-cue timer in database with event ID:",n.id);const c=await Se.stopSubCueTimer(n.id);console.log(" Database stop result:",c),console.log(" Secondary timer stopped in database (is_active = false)");try{console.log(" Broadcasting STOP_SECONDARY_TIMER action..."),console.log(" Sub-cue timer stopped locally"),console.log(" Secondary timer stop action broadcasted successfully")}catch(p){console.error(" Error broadcasting secondary timer stop action:",p)}}catch(c){console.error(" Error stopping sub-cue timer in database:",c),console.error(" Error details:",c)}try{await tr()}catch(c){console.error(" Error loading updated timer from Supabase:",c)}}},vl=c=>{if(window.confirm("Delete this schedule item?")){const p=O.find(y=>y.id===c);if(Z(y=>y.filter(b=>b.id!==c)),bn(null),p){const y=O.findIndex(b=>b.id===c)+1;z("REMOVE_ITEM",`Deleted schedule item: "${p.segmentName}"`,{changeType:"DELETE",itemId:p.id,itemName:p.segmentName,rowNumber:y,cueNumber:p.customFields.cue,details:{day:p.day,programType:p.programType,shotType:p.shotType,position:`Row ${y}`,durationHours:p.durationHours,durationMinutes:p.durationMinutes,totalDurationMinutes:p.durationHours*60+p.durationMinutes,speakers:p.speakers||"None",speakersText:p.speakersText||"None",notes:p.notes||"",assets:p.assets||"None",hasPPT:p.hasPPT,hasQA:p.hasQA,timerId:p.timerId,isPublic:p.isPublic,isIndented:p.isIndented}})}}},Ki=(c,p)=>{const y=O.findIndex(W=>W.id===c);if(y===-1)return;const b=p==="up"?y-1:y+1;if(b<0||b>=O.length)return;const E=O[y],j=y+1,P=b+1;Z(W=>{const J=[...W];return[J[y],J[b]]=[J[b],J[y]],J}),E&&z("MOVE_ITEM",`Moved "${E.segmentName}" from row ${j} to row ${P}`,{changeType:"MOVE",itemId:E.id,itemName:E.segmentName,details:{fromRow:j,toRow:P,direction:p}}),bn(null)},yl=(c,p)=>{const y=O.findIndex(W=>W.id===c);if(y===-1)return;const b=p-1;if(b<0||b>=O.length||b===y)return;const E=O[y],j=y+1,P=p;Z(W=>{const J=[...W],be=J[y];return J.splice(y,1),J.splice(b,0,be),J}),E&&z("MOVE_ITEM",`Moved "${E.segmentName}" from row ${j} to row ${P}`,{changeType:"MOVE",itemId:E.id,itemName:E.segmentName,details:{fromRow:j,toRow:P,direction:"specific"}}),bn(null)},qo=c=>{const p=O[c];if(!p||p.isIndented)return"";const y=p.day||1,b=Fe[y]||De;if(!b)return"";let E=0;for(let de=0;de<c;de++){const Ne=O[de];(Ne.day||1)===y&&!Ne.isIndented&&(E+=(Ne.durationHours||0)*3600+(Ne.durationMinutes||0)*60+(Ne.durationSeconds||0))}const[j,P]=b.split(":").map(Number),J=j*3600+P*60+E,be=Math.floor(J/3600)%24,we=Math.floor(J%3600/60),te=new Date;return te.setHours(be,we,0,0),te.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},fr=()=>O.filter(c=>(c.day||1)===pe);return k.useEffect(()=>{const c=()=>{const p=window.pageYOffset||document.documentElement.scrollTop;Ti(p>100)};return window.addEventListener("scroll",c),()=>window.removeEventListener("scroll",c)},[]),k.useEffect(()=>{const c=document.getElementById("main-scroll-container");if(!c)return;let p=!1;const y=(P,W)=>{p||(p=!0,W.scrollLeft=P.scrollLeft,requestAnimationFrame(()=>{p=!1}))},b=()=>{const P=document.querySelector(".sticky-header-scroll-container");P&&y(c,P)},E=()=>{const P=document.querySelector(".sticky-header-scroll-container");P&&y(P,c)};c.addEventListener("scroll",b);const j=new MutationObserver(()=>{const P=document.querySelector(".sticky-header-scroll-container");P&&P.addEventListener("scroll",E)});return j.observe(document.body,{childList:!0,subtree:!0}),()=>{c.removeEventListener("scroll",b),j.disconnect()}},[]),k.useEffect(()=>{ye!==null&&setTimeout(()=>{is()},100)},[ye,It]),k.useEffect(()=>{if(It&&Object.keys(Re).length>0){const c=parseInt(Object.keys(Re)[0]),p=document.querySelector(`[data-item-id="${c}"]`);p&&setTimeout(()=>{const y=document.querySelector("#main-scroll-container .h-24");let b=100;if(y){const P=y.getBoundingClientRect(),W=document.querySelector("#main-scroll-container")?.getBoundingClientRect();W&&(b=P.bottom-W.top-120)}const E=p.getBoundingClientRect(),j=document.querySelector("#main-scroll-container")?.getBoundingClientRect();if(j){const P=E.top-j.top-b;window.scrollTo({top:P,behavior:"smooth"})}},100)}},[Re,It]),n?i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 text-slate-200",children:[i.jsx(Xf,{isOpen:v,onClose:()=>w(!1),onRoleSelected:c=>{if(g(c),n?.id&&a?.id)try{const p=a.user_metadata?.full_name||a.email||"Unknown";Se.saveUserSession(n.id,a.id,p,c),console.log(" Role saved to Supabase from RunOfShowPage:",c)}catch(p){console.error(" Failed to save role to Supabase from RunOfShowPage:",p)}w(!1)},eventId:n?.id||""}),zo&&hr&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-slate-800 rounded-lg p-6 max-w-md w-full mx-4 border-2 border-orange-500",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-orange-400 text-2xl font-bold mb-4",children:" Timer Running"}),i.jsx("div",{className:"text-white text-lg mb-2",children:i.jsx("strong",{children:hr.cueName})}),i.jsxs("div",{className:"text-orange-300 text-xl font-mono mb-6",children:[hr.remainingTime," remaining"]}),i.jsxs("div",{className:"flex gap-3 justify-center",children:[i.jsx("button",{onClick:()=>En(!1),className:"px-6 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded transition-colors",children:"Dismiss"}),i.jsx("button",{onClick:()=>{En(!1),il()},className:"px-6 py-2 bg-orange-600 hover:bg-orange-500 text-white rounded transition-colors",children:"Sync Timer"})]})]})})}),S&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:"Change Log"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>Q(!1),className:`px-3 py-1 rounded text-sm transition-colors ${L?"bg-slate-600 text-slate-300 hover:bg-slate-500":"bg-blue-600 text-white"}`,children:["Local (",T.length,")"]}),i.jsxs("button",{onClick:()=>Q(!0),className:`px-3 py-1 rounded text-sm transition-colors ${L?"bg-blue-600 text-white":"bg-slate-600 text-slate-300 hover:bg-slate-500"}`,children:["Master (",A.length,")"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[!L&&i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:Us,className:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white text-sm rounded transition-colors",title:"Sync changes to Supabase",children:" Sync"}),i.jsx("button",{onClick:()=>{mt.reloadLocalChanges();const c=mt.getLocalChanges();R(c.slice(0,100)),console.log(" Manually reloaded local changes:",c.length)},className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",title:"Reload local changes",children:" Reload"})]}),L&&i.jsx("button",{onClick:kn,className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",title:"Reload master change log",children:" Reload"}),i.jsx("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-white text-2xl",children:""})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:L?A.length===0?i.jsx("p",{className:"text-gray-400 text-center py-8",children:"No master changes found"}):i.jsx("div",{className:"space-y-3",children:A.map(c=>i.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`text-white text-xs px-2 py-1 rounded ${c.action==="ADD_ITEM"?"bg-green-600":c.action==="REMOVE_ITEM"?"bg-red-600":c.action==="FIELD_UPDATE"?"bg-blue-600":c.action==="MOVE_ITEM"?"bg-yellow-600":c.action==="COLUMN_ADD"?"bg-purple-600":c.action==="COLUMN_REMOVE"?"bg-orange-600":"bg-blue-600"}`,children:c.action}),i.jsxs("span",{className:"text-gray-300 text-sm",children:["by ",c.user_name]}),i.jsxs("span",{className:"text-gray-500 text-xs",children:["(",c.user_role,")"]}),c.row_number&&i.jsxs("span",{className:"text-gray-400 text-xs bg-slate-600 px-2 py-1 rounded",children:["ROW ",c.row_number]}),c.cue_number&&c.cue_number!=="CUE"&&i.jsx("span",{className:"text-gray-400 text-xs bg-slate-600 px-2 py-1 rounded",children:ur(c.cue_number)})]}),i.jsx("div",{className:"text-gray-400 text-xs",children:new Date(c.timestamp||c.change_timestamp).toLocaleString()})]}),c.details&&i.jsxs("div",{className:"space-y-1 text-sm",children:[c.details.fieldName&&i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Field:"})," ",c.details.fieldName]}),c.details.oldValue!==void 0&&c.details.newValue!==void 0&&i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Changed from:"}),i.jsxs("span",{className:"text-red-300 ml-1",children:['"',c.details.oldValue,'"']}),i.jsx("span",{className:"text-slate-400 mx-1",children:""}),i.jsxs("span",{className:"text-green-300",children:['"',c.details.newValue,'"']})]}),c.batch_id&&i.jsxs("div",{className:"text-gray-500 text-xs mt-2 pt-2 border-t border-slate-600",children:["Batch: ",c.batch_id.slice(0,8),"... | Synced: ",new Date(c.batch_created_at).toLocaleString()]})]})]},c.id))}):T.length===0&&K.size===0?i.jsx("p",{className:"text-gray-400 text-center py-8",children:"No local changes recorded yet"}):i.jsxs("div",{className:"space-y-3",children:[T.map(c=>i.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`text-white text-xs px-2 py-1 rounded ${c.action==="ADD_ITEM"?"bg-green-600":c.action==="REMOVE_ITEM"?"bg-red-600":c.action==="FIELD_UPDATE"?"bg-blue-600":c.action==="MOVE_ITEM"?"bg-yellow-600":c.action==="COLUMN_ADD"?"bg-purple-600":c.action==="COLUMN_REMOVE"?"bg-orange-600":c.action==="AUTO_SAVE"?"bg-gray-600":"bg-blue-600"}`,children:c.action}),c.details?.processedBy&&i.jsx("span",{className:`text-white text-xs px-2 py-1 rounded ${c.details.processedBy==="TIMEOUT"?"bg-orange-600":c.details.processedBy==="SAVE_BUTTON"?"bg-purple-600":"bg-gray-600"}`,children:c.details.processedBy}),i.jsxs("span",{className:"text-gray-300 text-sm",children:["by ",c.userName]}),c.details?.itemId&&i.jsxs("span",{className:"text-gray-400 text-xs",children:["Item #",c.details.itemId]})]}),i.jsx("div",{className:"text-gray-400 text-xs",children:c.timestamp.toLocaleString()})]}),c.details&&i.jsxs("div",{className:"space-y-1 text-sm",children:[(c.details?.rowNumber||c.details?.cueNumber)&&i.jsx("div",{className:"text-gray-300",children:i.jsxs("strong",{children:["Row ",c.details?.rowNumber||"?"," | ",c.details?.cueNumber||"CUE"]})}),c.action==="ADD_ITEM"&&c.details.details&&i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Program Type:"})," ",c.details.details.programType]}),i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Shot Type:"})," ",c.details.details.shotType]}),i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Duration:"})," ",c.details.details.durationHours,"h ",c.details.details.durationMinutes,"m"]}),i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Speakers:"})," ",c.details.details.speakers]}),c.details.details.notes&&i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Notes:"})," ",c.details.details.notes]}),i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Position:"})," ",c.details.details.position]})]}),c.action==="REMOVE_ITEM"&&c.details.details&&i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Program Type:"})," ",c.details.details.programType]}),i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Shot Type:"})," ",c.details.details.shotType]}),i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Duration:"})," ",c.details.details.durationHours,"h ",c.details.details.durationMinutes,"m"]}),i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Speakers:"})," ",c.details.details.speakers]}),c.details.details.notes&&i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Notes:"})," ",c.details.details.notes]})]}),c.action!=="ADD_ITEM"&&c.action!=="REMOVE_ITEM"&&c.details.fieldName&&i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Field:"})," ",c.details.fieldName]}),c.action!=="ADD_ITEM"&&c.action!=="REMOVE_ITEM"&&c.details.fieldName==="speakers"&&c.details.details&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Speaker Count:"})," ",c.details.details.speakerCount||0]}),c.details.newValue&&i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Speakers:"}),i.jsx("div",{className:"mt-1 text-sm text-blue-300",children:(()=>{try{const p=JSON.parse(c.details.newValue);if(Array.isArray(p))return p.sort((y,b)=>y.slot-b.slot).map(y=>`${y.slot}. ${y.fullName||y.name||"Unknown"} (${y.location||"Unknown"})`).join(", ")}catch{return"Unable to parse speakers"}return"No speakers"})()})]})]}),c.action!=="ADD_ITEM"&&c.action!=="REMOVE_ITEM"&&c.details.fieldName==="assets"&&c.details.details&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Asset Count:"})," ",c.details.details.assetCount||0]}),c.details.newValue&&i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Assets:"}),i.jsx("div",{className:"mt-1 text-sm text-blue-300",children:c.details.newValue.split("||").filter(y=>y.trim()).map(y=>{if(y.includes("|")){const[b,E]=y.split("|");return`${b}${E?` (${E})`:""}`}return y}).join(", ")})]})]}),c.action==="MOVE_ITEM"&&c.details.details&&i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Moved from Row:"})," ",c.details.details.fromRow||"Unknown"]}),i.jsxs("div",{className:"text-gray-300",children:[i.jsx("strong",{children:"Moved to Row:"})," ",c.details.details.toRow||"Unknown"]})]}),c.action!=="ADD_ITEM"&&c.action!=="REMOVE_ITEM"&&c.action!=="MOVE_ITEM"&&c.details.fieldName!=="speakers"&&c.details.fieldName!=="assets"&&c.details.oldValue!==void 0&&c.details.newValue!==void 0&&i.jsx("div",{className:"text-gray-300",children:c.details.fieldName==="durationHours"||c.details.fieldName==="durationMinutes"||c.details.fieldName==="durationSeconds"?i.jsx("span",{className:"text-green-300",children:c.details.newValue}):i.jsxs(i.Fragment,{children:[i.jsx("strong",{children:"Changed from:"}),i.jsxs("span",{className:"text-red-300 ml-1",children:['"',c.details.oldValue,'"']}),i.jsx("span",{className:"text-gray-400 mx-1",children:""}),i.jsxs("span",{className:"text-green-300",children:['"',c.details.newValue,'"']})]})})]})]},c.id)),Array.from(K.entries()).map(([c,p])=>{const y=Date.now()-p.timestamp.getTime(),b=Math.max(0,1e4-y),E=Math.ceil(b/1e3);return i.jsxs("div",{className:"bg-slate-600 rounded-lg p-4 border-2 border-yellow-500 animate-pulse",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:"bg-yellow-600 text-white text-xs px-2 py-1 rounded",children:["PENDING [",p.originalKey||"NO_KEY","]"]}),i.jsxs("span",{className:"text-slate-300 text-sm",children:["by ",p.user]}),i.jsxs("span",{className:"text-yellow-300 text-xs",children:[" Will confirm in ",E,"s"]})]}),i.jsx("div",{className:"text-slate-400 text-xs",children:p.timestamp.toLocaleString()})]}),p.details&&i.jsxs("div",{className:"space-y-1 text-sm",children:[(p.details?.rowNumber||p.details?.cueNumber)&&i.jsx("div",{className:"text-slate-300",children:i.jsxs("strong",{children:["Row ",p.details?.rowNumber||"?"," | ",p.details?.cueNumber||"CUE"]})}),p.details.fieldName&&i.jsxs("div",{className:"text-slate-300",children:[i.jsx("strong",{children:"Field:"})," ",p.details.fieldName]}),p.details.oldValue!==void 0&&p.details.newValue!==void 0&&i.jsxs("div",{className:"text-slate-300",children:[i.jsx("strong",{children:"Will change from:"}),i.jsxs("span",{className:"text-red-300 ml-1",children:['"',p.details.oldValue,'"']}),i.jsx("span",{className:"text-slate-400 mx-1",children:""}),i.jsxs("span",{className:"text-green-300",children:['"',p.details.newValue,'"']})]})]})]},c)})]})}),i.jsx("div",{className:"mt-4 pt-4 border-t border-slate-600",children:i.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-400",children:[i.jsxs("div",{children:[i.jsxs("span",{children:["Total changes: ",T.length," (",K.size," pending)"]}),K.size>0&&i.jsx("span",{className:"ml-2 text-yellow-400",children:" Changes will be confirmed after 10s of inactivity"})]}),i.jsxs("div",{className:"flex gap-2",children:[K.size>0&&i.jsxs("button",{className:"px-3 py-1 bg-yellow-600 text-white rounded transition-colors animate-pulse cursor-not-allowed",disabled:!0,title:"Changes are pending and will auto-save after 5 seconds",children:[" Changes Pending (",K.size,")"]}),i.jsx("button",{onClick:al,className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",title:"Clear all change logs (password protected)",children:" Clear All Logs"})]})]})})]})}),i.jsx("style",{children:`
          select {
            border: 2px solid #64748b !important;
            border-radius: 6px !important;
          }
          select:focus {
            border-color: #3b82f6 !important;
            outline: none !important;
          }
          select option {
            background-color: #1e293b !important;
            color: #ffffff !important;
            border-bottom: 1px solid #475569 !important;
            padding: 8px 12px !important;
            margin: 0 !important;
          }
          select option:hover {
            background-color: #334155 !important;
          }
          select option:checked {
            background-color: #3b82f6 !important;
          }
        `}),i.jsx("div",{className:"fixed top-16 left-0 right-0 z-40 bg-slate-900 shadow-lg border-b border-slate-600",style:{height:Ao?"240px":"150px"},children:i.jsxs("div",{className:"py-2 pt-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2 px-8",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{onClick:()=>r("/"),className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:" Back to Events"}),i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:c=>{c.stopPropagation(),en(!$o)},className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",title:"Menu",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),$o&&i.jsx("div",{className:"absolute top-full left-0 mt-1 w-48 bg-slate-800 border border-slate-600 rounded-lg shadow-lg z-50",children:i.jsxs("div",{className:"py-1",children:[i.jsxs("button",{onClick:hl,className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Full Timer"]}),i.jsxs("button",{onClick:()=>{en(!1);const c=`/reports?eventId=${n?.id}&eventName=${encodeURIComponent(n?.name||"")}`;window.open(c,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Reports and Printing"]}),i.jsxs("button",{onClick:()=>{en(!1);const c=`/graphics-links?eventId=${n?.id}&eventName=${encodeURIComponent(n?.name||"")}`;window.open(c,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Graphic Links"]}),i.jsxs("button",{onClick:()=>{en(!1),console.log("=== TEST JSON DOWNLOAD ==="),console.log("Event:",n),console.log("Schedule length:",O.length),console.log("Full schedule:",O),console.log("Master start time:",De);const c=O.filter(j=>j.isPublic===!0);console.log("Public items found:",c);const p={event:n?.name||"Current Event",generated:new Date().toISOString(),schedule:c.map(j=>{const P=O.findIndex(J=>J.id===j.id),W=qo(P);return console.log(`Item ${j.segmentName}: index=${P}, startTime=${W}`),{segmentName:j.segmentName||"Untitled Segment",startTime:W||"No Start Time"}})};console.log("Final JSON data:",p);const y=JSON.stringify(p,null,2),b=new Blob([y],{type:"application/json;charset=utf-8;"}),E=URL.createObjectURL(b);window.open(E,"_blank"),console.log("=== END TEST JSON DOWNLOAD ===")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Test JSON Download"]}),i.jsxs("button",{onClick:()=>{en(!1),Ii(!0)},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"OSC Control"]})]})})]})]}),i.jsxs("div",{className:"flex items-center gap-6",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-white font-semibold",children:"Event Name:"}),i.jsx("div",{className:"px-4 py-2 bg-slate-700 border-2 border-slate-600 rounded-lg text-white w-64",children:ce||"No Event Name"}),n?.numberOfDays&&n.numberOfDays>1&&i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"text-white font-semibold",children:"Working Day:"}),i.jsx("select",{value:pe,onChange:c=>ue(parseInt(c.target.value)),className:"px-4 py-2 bg-slate-700 border-2 border-slate-600 rounded-lg text-white focus:border-blue-500 focus:outline-none w-32",children:Array.from({length:n.numberOfDays},(c,p)=>i.jsxs("option",{value:p+1,children:["Day ",p+1]},p+1))})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-white font-semibold",children:"Start Time:"}),i.jsx("input",{type:"time",value:n?.numberOfDays&&n.numberOfDays>1?Fe[pe]||"":De,onChange:c=>{if(d==="VIEWER"||d==="OPERATOR"){alert("Only EDITORs can change start time. Please change your role to EDITOR.");return}n?.numberOfDays&&n.numberOfDays>1?ie(p=>({...p,[pe]:c.target.value})):et(c.target.value)},disabled:d==="VIEWER"||d==="OPERATOR",className:"px-4 py-2 border-2 rounded-lg focus:outline-none w-48 transition-colors bg-slate-700 border-slate-600 text-white focus:border-blue-500",style:{colorScheme:"dark"},title:d==="VIEWER"||d==="OPERATOR"?"Only EDITORs can change start time":`Set ${n?.numberOfDays&&n.numberOfDays>1?`Day ${pe}`:"master"} start time`})]})]}),i.jsxs("div",{className:"flex items-center gap-6",children:[i.jsx("div",{className:"text-center",children:Object.keys(Re).length>0?i.jsxs("div",{className:"text-lg text-green-400 font-bold",children:["RUNNING - ",ur(O.find(c=>Re[c.id])?.customFields.cue),Ge&&i.jsxs("div",{className:"text-lg text-orange-400 mt-0.5 font-bold",children:[ur(O.find(c=>c.id===Ge.itemId)?.customFields.cue)," - ",Fi(Ge.remaining)]})]}):ye&&Qe[ye]?i.jsxs("div",{className:"text-lg text-yellow-400 font-bold",children:["LOADED - ",ur(O.find(c=>c.id===ye)?.customFields.cue)]}):i.jsx("div",{className:"text-lg text-slate-300 font-bold",children:"No CUE Selected"})}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"text-3xl font-mono bg-slate-800 px-6 py-3 rounded-lg border border-slate-600",style:{color:dl()},children:Bs(cl())}),ye&&i.jsx("div",{className:"absolute bottom-1 right-1",children:i.jsx(Zf,{itemId:ye,className:"flex-shrink-0"})})]})]})]}),i.jsx("div",{className:"px-8 mb-2",children:i.jsx("div",{className:"w-full h-2 bg-slate-700 rounded-full overflow-hidden border border-slate-600 relative",children:i.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${ul()}%`,background:Bo()}})})}),i.jsx("div",{className:"px-8 pb-2",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"text-sm text-slate-300",children:["Role: ",i.jsx("span",{className:"font-semibold text-white",children:d})]}),i.jsx("button",{onClick:()=>w(!0),className:"px-3 py-1 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded transition-colors",title:"Change your role",children:"Change Role"})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>As(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm font-medium rounded transition-colors",title:"Open Filter View",children:"Filter View"}),i.jsx("button",{onClick:()=>Ae(!zr),className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${zr?"bg-green-600 hover:bg-green-500":"bg-slate-600 hover:bg-slate-500"}`,title:zr?"Disable Time Toast":"Enable Time Toast",children:" Time Toast"}),i.jsx("button",{onClick:()=>Xn(!It),className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${It?"bg-purple-600 hover:bg-purple-500 ring-4 ring-inset ring-green-400":"bg-purple-600 hover:bg-purple-500"}`,title:It?"Disable auto-scroll to active row":"Enable auto-scroll to active row",children:" Follow"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-white text-sm font-medium",children:"Duration:"}),i.jsx("button",{onClick:async()=>{if(d==="VIEWER"||d==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await Hs(-300)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${d==="VIEWER"||d==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-700 hover:bg-red-600"}`,disabled:d==="VIEWER"||d==="EDITOR",title:d==="VIEWER"||d==="EDITOR"?"Only OPERATORs can adjust timer duration":"Subtract 5 minutes",children:"-5"}),i.jsx("button",{onClick:async()=>{if(d==="VIEWER"||d==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await Hs(-60)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${d==="VIEWER"||d==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-600 hover:bg-red-500"}`,disabled:d==="VIEWER"||d==="EDITOR",title:d==="VIEWER"||d==="EDITOR"?"Only OPERATORs can adjust timer duration":"Subtract 1 minute",children:"-1"}),i.jsx("button",{onClick:async()=>{if(d==="VIEWER"||d==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await Hs(60)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${d==="VIEWER"||d==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500"}`,disabled:d==="VIEWER"||d==="EDITOR",title:d==="VIEWER"||d==="EDITOR"?"Only OPERATORs can adjust timer duration":"Add 1 minute",children:"+1"}),i.jsx("button",{onClick:async()=>{if(d==="VIEWER"||d==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await Hs(300)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${d==="VIEWER"||d==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-700 hover:bg-blue-600"}`,disabled:d==="VIEWER"||d==="EDITOR",title:d==="VIEWER"||d==="EDITOR"?"Only OPERATORs can adjust timer duration":"Add 5 minutes",children:"+5"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>{if(d==="VIEWER"||d==="EDITOR"){alert("Only OPERATORs can send messages. Please change your role to OPERATOR.");return}Yn(!0)},className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${d==="VIEWER"||d==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":nt?"bg-purple-600 hover:bg-purple-500 ring-4 ring-inset ring-green-500":"bg-purple-600 hover:bg-purple-500"}`,disabled:d==="VIEWER"||d==="EDITOR",title:d==="VIEWER"||d==="EDITOR"?"Only OPERATORs can send messages":"Send Messages to Full Screen Timer",children:"Messages"}),nt&&i.jsx("button",{onClick:async()=>{if(d==="VIEWER"||d==="EDITOR"){alert("Only OPERATORs can control messages. Please change your role to OPERATOR.");return}try{if(n?.id){const p=(await Se.getTimerMessagesForEvent(n.id)).find(y=>y.enabled);p&&(await Se.disableTimerMessage(p.id),console.log(" Message disabled in Supabase via Turn Off button"))}}catch(c){console.error(" Error disabling message in Supabase:",c)}Oi(!1),Ds(""),Ot&&!Ot.closed&&Ot.postMessage({type:"MESSAGE_UPDATE",message:"",enabled:!1},"*")},className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${d==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500 animate-pulse"}`,disabled:d==="VIEWER",title:d==="VIEWER"?"Viewers cannot control messages":"Turn Off Message",children:"Click to Turn Off"})]})]})]})}),i.jsx("div",{className:`px-8 transition-all duration-500 ease-in-out overflow-hidden ${Ao?"max-h-80 opacity-100 -mb-6":"max-h-0 opacity-0 mb-0"}`,children:i.jsx("div",{className:"bg-slate-800 rounded-xl p-4 shadow-2xl",style:{transform:"scale(0.75)",transformOrigin:"top center",width:"127.67%",marginLeft:"-13.83%"},children:i.jsxs("div",{className:"flex border-2 border-slate-600 rounded-lg overflow-hidden bg-slate-900",children:[i.jsx("div",{className:"w-12 flex-shrink-0 bg-slate-900 border-r-2 border-slate-600",children:i.jsx("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:i.jsx("span",{className:"text-white font-bold text-xs",children:"#"})})}),i.jsx("div",{className:"w-40 flex-shrink-0 bg-slate-900",style:{borderRight:"6px solid #475569"},children:i.jsx("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:i.jsxs("span",{className:"text-white font-bold text-lg flex items-center gap-1",children:["CUE",d==="VIEWER"&&i.jsx("span",{className:"text-yellow-400",title:"Viewers cannot edit CUE",children:""})]})})}),i.jsx("div",{className:"flex-1 overflow-x-auto sticky-header-scroll-container",style:{scrollbarWidth:"thin"},children:i.jsx("div",{className:"min-w-max",children:i.jsxs("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex",children:[je.start&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.start},children:[i.jsx("span",{className:"text-white font-bold",children:"Start"}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"start")})]}),je.programType&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.programType},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Program Type",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"programType")})]}),je.duration&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.duration},children:[i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-white font-bold flex items-center justify-center gap-1",children:["Duration",d==="VIEWER"&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"text-xs text-slate-400",children:"HH MM SS"})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"duration")})]}),je.segmentName&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.segmentName},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Segment Name",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"segmentName")})]}),je.shotType&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.shotType},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Shot Type",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"shotType")})]}),je.pptQA&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.pptQA},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["PPT/Q&A",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"pptQA")})]}),je.notes&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.notes},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Notes",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"notes")})]}),je.assets&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.assets},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Assets",d==="VIEWER"&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for VIEWERs",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"assets")})]}),je.participants&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.participants},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Participants",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"participants")})]}),je.speakers&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.speakers},children:[i.jsx("span",{className:"text-white font-bold",children:"Speakers"}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"speakers")})]}),je.public&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.public},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Public",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"public")})]}),q.map(c=>Ft[c.id]!==!1&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center relative flex-shrink-0",style:{width:$s[c.id]||256},children:[i.jsx("span",{className:"text-white font-bold",children:c.name}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:p=>Hi(p,c.id)})]},c.id))]})})}),i.jsx("div",{className:"w-32 flex-shrink-0 bg-slate-900",style:{borderLeft:"6px solid #475569"},children:i.jsx("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:i.jsxs("span",{className:"text-white font-bold text-base flex items-center gap-1",children:["Timer",(d==="VIEWER"||d==="EDITOR")&&i.jsx("span",{className:"text-yellow-400",title:"Only OPERATORs can control timers",children:""})]})})})]})})})]})}),i.jsx("div",{className:"max-w-[95%] mx-auto px-6",style:{paddingTop:"250px"},children:i.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 shadow-2xl",style:{transform:"scale(0.75)",transformOrigin:"top center",width:"133.33%",marginLeft:"-16.67%"},children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Schedule",n?.numberOfDays&&n.numberOfDays>1?` - Day ${pe}`:""]}),a&&i.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[i.jsxs("button",{onClick:()=>_(!0),className:"text-xs bg-purple-600 hover:bg-purple-500 text-white px-2 py-1 rounded transition-colors",title:"View change history",children:[" Change Log (",T.length+K.size,")",mt.getChangesCount().unsynced>0&&i.jsxs("span",{className:"ml-1 text-yellow-400",children:["(",mt.getChangesCount().unsynced," unsynced)"]})]}),es>0&&i.jsx("button",{onClick:async()=>{await ae()},className:"text-xs bg-yellow-600 hover:bg-yellow-500 text-white px-2 py-1 rounded transition-colors animate-pulse",title:`${es} unsynced change${es!==1?"s":""} - Click to sync`,children:es}),K.size>0&&i.jsxs("button",{className:"text-xs bg-yellow-600 text-white px-2 py-1 rounded transition-colors animate-pulse cursor-not-allowed",title:"Changes are pending and will auto-save after 5 seconds",disabled:!0,children:[" Changes Pending (",K.size,")"]})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>{if(d==="VIEWER"){alert("Viewers cannot add items. Please change your role to EDITOR or OPERATOR.");return}H(!0),st({cue:"",day:pe,programType:"PreShow/End",shotType:"",segmentName:"",durationHours:0,durationMinutes:0,durationSeconds:0,notes:"",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!1,timerId:"",isPublic:!1,isIndented:!1,customFields:{}})},className:`px-4 py-2 font-medium rounded text-sm transition-colors ${d==="VIEWER"||d==="OPERATOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,disabled:d==="VIEWER"||d==="OPERATOR",title:d==="VIEWER"||d==="OPERATOR"?"Only EDITORs can add items":"Add new item",children:"+ Item"}),i.jsx("button",{onClick:()=>{if(d==="VIEWER"){alert("Viewers cannot add columns. Please change your role to EDITOR or OPERATOR.");return}ze(!0)},className:`px-4 py-2 font-medium rounded text-sm transition-colors ${d==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,disabled:d==="VIEWER",title:d==="VIEWER"?"Viewers cannot add columns":"Add custom column",children:"+ Column"}),i.jsx("button",{onClick:async()=>{if(d==="VIEWER"){alert("Viewers cannot reset the schedule. Please change your role to EDITOR or OPERATOR.");return}await Vi()},className:`px-4 py-2 font-medium rounded text-sm transition-colors ${d==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-600 hover:bg-red-700 text-white"}`,disabled:d==="VIEWER",title:d==="VIEWER"?"Viewers cannot reset the schedule":"Reset all states",children:"Reset"})]})]}),i.jsxs("div",{className:"flex border-2 border-slate-600 rounded-lg overflow-hidden bg-slate-900",children:[i.jsxs("div",{className:"w-12 flex-shrink-0 bg-slate-900 border-r-2 border-slate-600",children:[i.jsx("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:i.jsx("span",{className:"text-white font-bold text-xs",children:"#"})}),fr().length===0?i.jsx("div",{className:"h-24 flex items-center justify-center text-slate-500",children:"-"}):fr().map((c,p)=>i.jsx("div",{className:`border-b-2 border-slate-600 flex items-center justify-center gap-1 ${Re[c.id]?"bg-green-900 border-green-500":ye===c.id?"bg-blue-900 border-blue-500":Pi.has(c.id)?"bg-amber-800 border-amber-600":Is[c.id]||_n.has(c.id)?"bg-gray-900 border-gray-700 opacity-40":p%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:qt(c.notes,c.speakersText,c.speakers,c.customFields,q)},children:i.jsxs("div",{className:"flex flex-col items-center gap-1",children:[i.jsx("button",{onClick:()=>{if(d==="VIEWER"){alert("Viewers cannot jump to rows. Please change your role to EDITOR or OPERATOR.");return}const y=prompt(`Move to row (1-${fr().length}):`,(p+1).toString());y&&!isNaN(Number(y))&&yl(c.id,Number(y))},className:`w-5 h-5 text-white rounded flex items-center justify-center text-xs font-bold transition-colors ${d==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-purple-600 hover:bg-purple-500"}`,disabled:d==="VIEWER",title:d==="VIEWER"?"Viewers cannot jump to rows":"Jump to Row",children:"#"}),i.jsx("span",{className:"text-white font-bold text-lg",children:p+1}),i.jsx("button",{onClick:()=>{if(d==="VIEWER"){alert("Viewers cannot add rows. Please change your role to EDITOR or OPERATOR.");return}Ue(p),H(!0)},className:`w-5 h-5 text-white rounded flex items-center justify-center text-xs font-bold transition-colors ${d==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500"}`,disabled:d==="VIEWER",title:d==="VIEWER"?"Viewers cannot add rows":`Insert row after row ${p+1}`,children:"+"})]})},`${c.id}-${c.notes?.length||0}-${c.speakers?.length||0}`))]}),i.jsxs("div",{className:"w-40 flex-shrink-0 bg-slate-900",style:{borderRight:"6px solid #475569"},children:[i.jsx("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:i.jsxs("span",{className:"text-white font-bold text-lg flex items-center gap-1",children:["CUE",d==="VIEWER"&&i.jsx("span",{className:"text-yellow-400",title:"Viewers cannot edit CUE",children:""})]})}),fr().length===0?i.jsx("div",{className:"h-24 flex items-center justify-center text-slate-500",children:"No items"}):fr().map((c,p)=>i.jsxs("div",{className:`border-b-2 border-slate-600 flex flex-col items-center justify-center gap-1 ${p%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:qt(c.notes,c.speakersText,c.speakers,c.customFields,q)},children:[i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:`flex items-center px-1 py-1 border border-slate-600 border-r-0 rounded-l text-white text-lg font-medium min-w-[40px] ${Fo===c.id?"bg-purple-600":"bg-slate-600"}`,children:"CUE"}),i.jsx("input",{type:"text",value:c.customFields.cue?c.customFields.cue.replace(/^CUE\s*/,""):"",onChange:y=>{if(d==="VIEWER"){alert("Viewers cannot edit cue names. Please change your role to EDITOR or OPERATOR.");return}const b=c.customFields.cue||"CUE ",E=y.target.value?`CUE ${y.target.value}`:"CUE ";Z(j=>j.map(P=>P.id===c.id?{...P,customFields:{...P.customFields,cue:E}}:P)),ne(`cue_${c.id}`,"FIELD_UPDATE",`Updated cue for "${c.segmentName}" from "${b}" to "${E}"`,{changeType:"FIELD_CHANGE",itemId:c.id,itemName:c.segmentName,fieldName:"cue",oldValue:b,newValue:E,details:{fieldType:"text",characterChange:E.length-b.length}})},disabled:d==="VIEWER",className:"w-14 px-1 py-1 border border-slate-600 rounded-r text-center text-lg transition-colors bg-slate-700 text-white focus:outline-none focus:border-blue-500",title:d==="VIEWER"?"Viewers cannot edit cue names":"Edit cue number",maxLength:4})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>{if(d==="VIEWER"){alert("Viewers cannot indent/unindent items. Please change your role to EDITOR or OPERATOR.");return}const y=c.isIndented;Z(b=>b.map(E=>E.id===c.id?{...E,isIndented:!E.isIndented}:E)),z("FIELD_UPDATE",`Updated indentation for "${c.segmentName}" from ${y} to ${!y}`,{changeType:"FIELD_CHANGE",itemId:c.id,itemName:c.segmentName,fieldName:"isIndented",oldValue:y,newValue:!y,details:{fieldType:"boolean",booleanChange:!0}})},className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${d==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500"}`,disabled:d==="VIEWER",title:d==="VIEWER"?"Viewers cannot indent/unindent items":c.isIndented?"Unindent (group with row above)":"Indent (group with row above)",children:c.isIndented?"":""}),i.jsx("button",{onClick:()=>{if(d==="VIEWER"){alert("Viewers cannot move items. Please change your role to EDITOR or OPERATOR.");return}Ki(c.id,"up")},disabled:p===0||d==="VIEWER",className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${d==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500 disabled:opacity-30 disabled:cursor-not-allowed"}`,title:d==="VIEWER"?"Viewers cannot move items":"Move Up",children:""}),i.jsx("button",{onClick:()=>{if(d==="VIEWER"){alert("Viewers cannot move items. Please change your role to EDITOR or OPERATOR.");return}Ki(c.id,"down")},disabled:p===fr().length-1||d==="VIEWER",className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${d==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500 disabled:opacity-30 disabled:cursor-not-allowed"}`,title:d==="VIEWER"?"Viewers cannot move items":"Move Down",children:""}),i.jsx("button",{onClick:()=>{if(d==="VIEWER"){alert("Viewers cannot delete items. Please change your role to EDITOR or OPERATOR.");return}vl(c.id)},className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${d==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-600 hover:bg-red-500"}`,disabled:d==="VIEWER",title:d==="VIEWER"?"Viewers cannot delete items":"Delete",children:""})]})]},`${c.id}-${c.notes?.length||0}-${c.speakers?.length||0}`))]}),i.jsx("div",{id:"main-scroll-container",className:"flex-1 overflow-x-auto",style:{scrollbarWidth:"thin"},children:i.jsxs("div",{className:"min-w-max",children:[i.jsxs("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex",children:[je.start&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.start},children:[i.jsx("span",{className:"text-white font-bold",children:"Start"}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"start")})]}),je.programType&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.programType},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Program Type",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"programType")})]}),je.duration&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.duration},children:[i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-white font-bold flex items-center justify-center gap-1",children:["Duration",d==="VIEWER"&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"text-xs text-slate-400",children:"HH MM SS"})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"duration")})]}),je.segmentName&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.segmentName},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Segment Name",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"segmentName")})]}),je.shotType&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.shotType},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Shot Type",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"shotType")})]}),je.pptQA&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.pptQA},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["PPT/Q&A",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"pptQA")})]}),je.notes&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.notes},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Notes",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"notes")})]}),je.assets&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.assets},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Assets",d==="VIEWER"&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for VIEWERs",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"assets")})]}),je.participants&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.participants},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Participants",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"participants")})]}),je.speakers&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.speakers},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Speakers",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"speakers")})]}),je.public&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:Oe.public},children:[i.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Public",(d==="VIEWER"||d==="OPERATOR")&&i.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:c=>ot(c,"public")})]}),q.map(c=>Ft[c.id]!==!1&&i.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center relative flex-shrink-0",style:{width:$s[c.id]||256},children:[i.jsx("span",{className:"text-white font-bold",children:c.name}),i.jsx("button",{onClick:()=>{window.confirm(`Are you sure you want to remove the "${c.name}" column? This will delete all data in this column.`)&&Ho(c.id)},className:"absolute top-1 right-1 w-6 h-6 bg-red-600 hover:bg-red-700 text-white rounded-md text-base font-bold flex items-center justify-center transition-colors shadow-md hover:shadow-lg",title:`Remove "${c.name}" column`,children:""}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:p=>Hi(p,c.id)})]},c.id))]}),fr().length===0?i.jsxs("div",{className:"h-24 flex items-center justify-center text-slate-500 text-xl",children:["No schedule items for Day ",pe,'. Click "Add Schedule Item" to start!']}):fr().map((c,p)=>i.jsxs("div",{"data-item-id":c.id,className:`border-b-2 border-slate-600 flex ${Re[c.id]?"bg-green-950":ye===c.id?"bg-blue-950":Pi.has(c.id)?"bg-amber-950 border-amber-600":Is[c.id]||_n.has(c.id)?"bg-gray-900 opacity-40":Fo===c.id?"bg-purple-950 border-purple-400":p%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:qt(c.notes,c.speakersText,c.speakers,c.customFields,q)},children:[je.start&&i.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:Oe.start},children:i.jsx("span",{className:"text-white font-mono text-base font-bold",children:c.isIndented?"":qo(p)})}),je.programType&&i.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:Oe.programType},children:i.jsx("select",{value:c.programType,onChange:y=>{if(d==="VIEWER"||d==="OPERATOR"){alert("Only EDITORs can edit program type. Please change your role to EDITOR.");return}const b=c.programType;Z(E=>E.map(j=>j.id===c.id?{...j,programType:y.target.value}:j)),ne(`programType_${c.id}`,"FIELD_UPDATE",`Updated program type for "${c.segmentName}" from "${b}" to "${y.target.value}"`,{changeType:"FIELD_CHANGE",itemId:c.id,itemName:c.segmentName,fieldName:"programType",oldValue:b,newValue:y.target.value,details:{fieldType:"select",optionChange:!0}})},disabled:d==="VIEWER"||d==="OPERATOR",className:"w-full px-3 py-2 border-2 rounded text-base transition-colors bg-slate-700 border-slate-500 text-white",style:{backgroundColor:Fs[c.programType]||"#374151",color:c.programType==="Sub Cue"?"#000000":"#ffffff",opacity:1},title:d==="VIEWER"||d==="OPERATOR"?"Only EDITORs can edit program type":"Select program type",children:as.map(y=>i.jsx("option",{value:y,style:{backgroundColor:Fs[y]||"#374151",color:y==="Sub Cue"?"#000000":"#ffffff"},children:y},y))})}),je.duration&&i.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:Oe.duration},children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"number",min:"0",max:"23",value:c.durationHours,onChange:y=>{if(d==="VIEWER"){alert("Only EDITORs and OPERATORs can edit duration. Please change your role to EDITOR or OPERATOR.");return}const b=c.durationHours,E=parseInt(y.target.value)||0;Z(j=>j.map(P=>P.id===c.id?{...P,durationHours:E}:P)),ne(`durationHours_${c.id}`,"FIELD_UPDATE",`Updated duration hours for "${c.segmentName}" from ${b} to ${E}`,{changeType:"FIELD_CHANGE",itemId:c.id,itemName:c.segmentName,fieldName:"durationHours",oldValue:b,newValue:E,details:{fieldType:"number",timeChange:E-b}})},disabled:d==="VIEWER",className:"w-14 px-2 py-2 border border-slate-600 rounded text-center text-lg font-mono font-bold transition-colors bg-slate-700 text-white",style:{opacity:1},title:d==="VIEWER"?"Only EDITORs and OPERATORs can edit duration":"Edit hours"}),i.jsx("span",{className:"text-slate-400 text-xl font-bold",children:":"}),i.jsx("input",{type:"number",min:"0",max:"59",value:c.durationMinutes,onChange:y=>{if(d==="VIEWER"){alert("Only EDITORs and OPERATORs can edit duration. Please change your role to EDITOR or OPERATOR.");return}const b=c.durationMinutes,E=parseInt(y.target.value)||0;Z(j=>j.map(P=>P.id===c.id?{...P,durationMinutes:E}:P)),ne(`durationMinutes_${c.id}`,"FIELD_UPDATE",`Updated duration minutes for "${c.segmentName}" from ${b} to ${E}`,{changeType:"FIELD_CHANGE",itemId:c.id,itemName:c.segmentName,fieldName:"durationMinutes",oldValue:b,newValue:E,details:{fieldType:"number",timeChange:E-b}})},disabled:d==="VIEWER",className:"w-14 px-2 py-2 border border-slate-600 rounded text-center text-lg font-mono font-bold transition-colors bg-slate-700 text-white",style:{opacity:1},title:d==="VIEWER"?"Only EDITORs and OPERATORs can edit duration":"Edit minutes"}),i.jsx("span",{className:"text-slate-400 text-xl font-bold",children:":"}),i.jsx("input",{type:"number",min:"0",max:"59",value:c.durationSeconds,onChange:y=>{if(d==="VIEWER"){alert("Only EDITORs and OPERATORs can edit duration. Please change your role to EDITOR or OPERATOR.");return}const b=c.durationSeconds,E=parseInt(y.target.value)||0;Z(j=>j.map(P=>P.id===c.id?{...P,durationSeconds:E}:P)),ne(`durationSeconds_${c.id}`,"FIELD_UPDATE",`Updated duration seconds for "${c.segmentName}" from ${b} to ${E}`,{changeType:"FIELD_CHANGE",itemId:c.id,itemName:c.segmentName,fieldName:"durationSeconds",oldValue:b,newValue:E,details:{fieldType:"number",timeChange:E-b}})},disabled:d==="VIEWER",className:"w-14 px-2 py-2 border border-slate-600 rounded text-center text-lg font-mono font-bold transition-colors bg-slate-700 text-white",style:{opacity:1},title:d==="VIEWER"?"Only EDITORs and OPERATORs can edit duration":"Edit seconds"})]})}),je.segmentName&&i.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:Oe.segmentName},children:i.jsx("input",{type:"text",value:c.segmentName,onChange:y=>{if(d==="VIEWER"||d==="OPERATOR"){alert("Only EDITORs can edit segment names. Please change your role to EDITOR.");return}const b=c.segmentName;Z(E=>E.map(j=>j.id===c.id?{...j,segmentName:y.target.value}:j)),ne(`segmentName_${c.id}`,"FIELD_UPDATE",`Updated segment name for "${b}" to "${y.target.value}"`,{changeType:"FIELD_CHANGE",itemId:c.id,itemName:y.target.value,fieldName:"segmentName",oldValue:b,newValue:y.target.value,details:{fieldType:"text",characterChange:y.target.value.length-b.length}})},disabled:d==="VIEWER"||d==="OPERATOR",className:"w-full px-3 py-2 border border-slate-600 rounded text-base transition-colors bg-slate-700 text-white",placeholder:d==="VIEWER"||d==="OPERATOR"?"Only EDITORs can edit":"Enter segment name",title:d==="VIEWER"||d==="OPERATOR"?"Only EDITORs can edit segment names":"Edit segment name"})}),je.shotType&&i.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:Oe.shotType},children:i.jsxs("select",{value:c.shotType,onChange:y=>{if(d==="VIEWER"||d==="OPERATOR"){alert("Only EDITORs can edit shot type. Please change your role to EDITOR.");return}const b=c.shotType;Z(E=>E.map(j=>j.id===c.id?{...j,shotType:y.target.value}:j)),ne(`shotType_${c.id}`,"FIELD_UPDATE",`Updated shot type for "${c.segmentName}" from "${b}" to "${y.target.value}"`,{changeType:"FIELD_CHANGE",itemId:c.id,itemName:c.segmentName,fieldName:"shotType",oldValue:b,newValue:y.target.value,details:{fieldType:"select",optionChange:!0}})},disabled:d==="VIEWER"||d==="OPERATOR",className:"w-full px-3 py-2 border border-slate-600 rounded text-base transition-colors bg-slate-700 text-white",style:{opacity:1},title:d==="VIEWER"||d==="OPERATOR"?"Only EDITORs can edit shot type":"Select shot type",children:[i.jsx("option",{value:"",children:"Select Shot Type"}),jn.map(y=>i.jsx("option",{value:y,children:y},y))]})}),je.pptQA&&i.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:Oe.pptQA},children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("label",{className:"flex items-center gap-1",children:[i.jsx("input",{type:"checkbox",checked:c.hasPPT,onChange:y=>{if(d==="VIEWER"||d==="OPERATOR"){alert("Only EDITORs can edit PPT settings. Please change your role to EDITOR.");return}const b=c.hasPPT;Z(E=>E.map(j=>j.id===c.id?{...j,hasPPT:y.target.checked}:j)),ne(`hasPPT_${c.id}`,"FIELD_UPDATE",`Updated PPT status for "${c.segmentName}" from ${b?"TRUE":"FALSE"} to ${y.target.checked?"TRUE":"FALSE"}`,{changeType:"FIELD_CHANGE",itemId:c.id,itemName:c.segmentName,fieldName:"hasPPT",oldValue:b?"TRUE":"FALSE",newValue:y.target.checked?"TRUE":"FALSE",details:{fieldType:"checkbox",booleanChange:!0}})},className:`w-6 h-6 rounded border-2 transition-colors ${d==="VIEWER"||d==="OPERATOR"?"border-slate-400 bg-slate-700 cursor-not-allowed":"border-slate-400 bg-slate-700 hover:border-blue-400 focus:ring-2 focus:ring-blue-500"}`,style:{opacity:1,filter:"none",WebkitFilter:"none"},title:d==="VIEWER"||d==="OPERATOR"?"Only EDITORs can edit PPT settings":"Toggle PPT"}),i.jsx("span",{className:"text-base font-medium text-white",children:"PPT"})]}),i.jsxs("label",{className:"flex items-center gap-1",children:[i.jsx("input",{type:"checkbox",checked:c.hasQA,onChange:y=>{if(d==="VIEWER"||d==="OPERATOR"){alert("Only EDITORs can edit Q&A settings. Please change your role to EDITOR.");return}const b=c.hasQA;Z(E=>E.map(j=>j.id===c.id?{...j,hasQA:y.target.checked}:j)),ne(`hasQA_${c.id}`,"FIELD_UPDATE",`Updated Q&A status for "${c.segmentName}" from ${b?"TRUE":"FALSE"} to ${y.target.checked?"TRUE":"FALSE"}`,{changeType:"FIELD_CHANGE",itemId:c.id,itemName:c.segmentName,fieldName:"hasQA",oldValue:b?"TRUE":"FALSE",newValue:y.target.checked?"TRUE":"FALSE",details:{fieldType:"checkbox",booleanChange:!0}})},className:`w-6 h-6 rounded border-2 transition-colors ${d==="VIEWER"||d==="OPERATOR"?"border-slate-400 bg-slate-700 cursor-not-allowed":"border-slate-400 bg-slate-700 hover:border-blue-400 focus:ring-2 focus:ring-blue-500"}`,style:{opacity:1,filter:"none",WebkitFilter:"none"},title:d==="VIEWER"||d==="OPERATOR"?"Only EDITORs can edit Q&A settings":"Toggle Q&A"}),i.jsx("span",{className:"text-base font-medium text-white",children:"Q&A"})]})]})}),je.notes&&i.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:Oe.notes,height:qt(c.notes,c.speakersText,c.speakers,c.customFields,q)},children:i.jsx("div",{onClick:()=>{if(d==="VIEWER"||d==="OPERATOR"){if(d==="OPERATOR"&&c.notes){alert(`Notes (View Only):

${c.notes.replace(/<[^>]*>/g,"")}`);return}alert("Only EDITORs can edit notes. Please change your role to EDITOR.");return}qn(c.id),wt(!0)},className:"w-full px-3 py-2 border border-slate-600 rounded text-white text-base transition-colors flex items-start justify-center bg-slate-700 cursor-pointer hover:bg-slate-600",style:{height:zs(c.notes),minHeight:zs(c.notes),wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden",paddingBottom:"1rem"},title:d==="VIEWER"?"Viewers cannot edit notes":d==="OPERATOR"?"Click to view notes (read-only)":"Click to edit notes",children:c.notes?i.jsx("div",{className:"text-left w-full",dangerouslySetInnerHTML:{__html:c.notes}}):i.jsx("span",{className:"text-slate-400",children:"Click to edit notes..."})})}),je.assets&&i.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:Oe.assets},children:i.jsx("div",{onClick:()=>{if(d==="VIEWER"||d==="OPERATOR"){if(d==="OPERATOR"&&c.assets){Po(c.id),Oo(!0);return}alert("Only EDITORs can edit assets. Please change your role to EDITOR.");return}wn(c.id),Lr(!0)},className:"w-full px-3 py-2 border border-slate-600 rounded text-white text-base transition-colors flex items-center justify-center bg-slate-700 cursor-pointer hover:bg-slate-600",title:d==="VIEWER"?"Viewers cannot edit assets":d==="OPERATOR"?"Click to view assets (read-only)":"Click to edit assets",children:c.assets?i.jsx("div",{className:"text-center",children:i.jsxs("div",{className:"text-sm font-medium",children:[c.assets.split("||").length," Asset",c.assets.split("||").length!==1?"s":""]})}):i.jsx("span",{className:"text-slate-400",children:"Click to add assets..."})})}),je.participants&&i.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-start justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:Oe.participants,height:qt(c.notes,c.speakersText,c.speakers,c.customFields,q)},children:i.jsx("div",{onClick:()=>{if(d==="VIEWER"||d==="OPERATOR"){if(d==="OPERATOR"&&c.speakers){alert(`Participants (View Only):

${Ws(c.speakers)}`);return}alert("Only EDITORs can edit participants. Please change your role to EDITOR.");return}_r(c.id),$r(!0)},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-base cursor-pointer hover:bg-slate-600",style:{height:`calc(${qt(c.notes,c.speakersText,c.speakers,c.customFields,q)} - 2rem)`,maxHeight:`calc(${qt(c.notes,c.speakersText,c.speakers,c.customFields,q)} - 2rem)`,overflow:"hidden",lineHeight:"1.6",wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"pre-wrap"},title:d==="VIEWER"?"Viewers cannot edit participants":d==="OPERATOR"?"Click to view participants (read-only)":"Click to edit participants",children:Ws(c.speakers||"")||"Click to add participants..."})}),je.speakers&&i.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:Oe.speakers,height:qt(c.notes,c.speakersText,c.speakers,c.customFields,q)},children:i.jsx("div",{onClick:()=>{if(d==="VIEWER"||d==="OPERATOR"){if(d==="OPERATOR"&&c.speakersText){alert(`Speakers (View Only):

${ds(c.speakersText)}`);return}alert("Only EDITORs can edit speakers. Please change your role to EDITOR.");return}xn(c.id),Xr(!0)},className:"w-full px-3 py-2 border border-slate-600 rounded text-white text-base transition-colors flex items-start justify-start bg-slate-700 cursor-pointer hover:bg-slate-600",style:{height:ls(c.speakersText),minHeight:ls(c.speakersText),wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden",paddingBottom:"1rem",lineHeight:"1.6",whiteSpace:"pre-wrap"},title:d==="VIEWER"?"Viewers cannot edit speakers":d==="OPERATOR"?"Click to view speakers (read-only)":"Click to edit speakers",children:i.jsx("div",{className:"text-left w-full",children:ds(c.speakersText||"")||"Click to add speakers..."})})}),je.public&&i.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:Oe.public},children:i.jsx("input",{type:"checkbox",checked:c.isPublic||!1,onChange:y=>{if(d==="VIEWER"||d==="OPERATOR"){alert("Only EDITORs can change public status. Please change your role to EDITOR.");return}const b=c.isPublic;Z(E=>E.map(j=>j.id===c.id?{...j,isPublic:y.target.checked}:j)),z("FIELD_UPDATE",`Updated Public status for "${c.segmentName}" from ${b} to ${y.target.checked}`,{changeType:"FIELD_CHANGE",itemId:c.id,itemName:c.segmentName,fieldName:"isPublic",oldValue:b,newValue:y.target.checked,details:{fieldType:"checkbox",booleanChange:!0}})},className:`w-5 h-5 rounded border-2 focus:ring-2 transition-colors ${d==="VIEWER"||d==="OPERATOR"?"border-slate-500 bg-slate-700 text-blue-600 cursor-not-allowed":"border-slate-500 bg-slate-700 text-blue-600 focus:ring-blue-500"}`,style:{opacity:1,filter:"none",WebkitFilter:"none"},title:d==="VIEWER"||d==="OPERATOR"?"Only EDITORs can change public status":"Toggle public visibility"})}),q.map(y=>Ft[y.id]!==!1&&i.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:$s[y.id]||256,height:qt(c.notes,c.speakersText,c.speakers,c.customFields,q)},children:i.jsx("textarea",{value:c.customFields[y.name]||"",onChange:b=>{const E=c.customFields[y.name]||"";Z(j=>j.map(P=>P.id===c.id?{...P,customFields:{...P.customFields,[y.name]:b.target.value}}:P)),ne(`custom_${y.name}_${c.id}`,"FIELD_UPDATE",`Updated custom field "${y.name}" for "${c.segmentName}" from "${E}" to "${b.target.value}"`,{changeType:"FIELD_CHANGE",itemId:c.id,itemName:c.segmentName,fieldName:`custom_${y.name}`,oldValue:E,newValue:b.target.value,details:{fieldType:"custom_field",columnName:y.name,characterChange:b.target.value.length-E.length}})},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-base resize-none",style:{height:`calc(${qt(c.notes,c.speakersText,c.speakers,c.customFields,q)} - 2rem)`,maxHeight:`calc(${qt(c.notes,c.speakersText,c.speakers,c.customFields,q)} - 2rem)`,overflow:"hidden",lineHeight:"1.6",wordWrap:"break-word",overflowWrap:"break-word"},rows:Math.max(2,(c.customFields[y.name]||"").split(`
`).length),placeholder:`${y.name}...`})},y.id))]},`${c.id}-${c.notes?.length||0}-${c.speakers?.length||0}`))]})}),i.jsxs("div",{className:"w-32 flex-shrink-0 bg-slate-900",style:{borderLeft:"6px solid #475569"},children:[i.jsx("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:i.jsxs("span",{className:"text-white font-bold text-base flex items-center gap-1",children:["Timer",(d==="VIEWER"||d==="EDITOR")&&i.jsx("span",{className:"text-yellow-400",title:"Only OPERATORs can control timers",children:""})]})}),fr().length===0?i.jsx("div",{className:"h-24 flex items-center justify-center text-slate-500",children:"-"}):fr().map((c,p)=>i.jsx("div",{className:`border-b-2 border-slate-600 flex flex-col items-center justify-center gap-1 ${p%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:qt(c.notes,c.speakersText,c.speakers,c.customFields,q)},children:i.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-1",children:[i.jsx("div",{className:"text-sm font-mono text-slate-300",children:c.timerId||"TIMER"}),i.jsx("div",{className:"flex flex-col gap-1",children:c.isIndented?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{if(d==="VIEWER"||d==="EDITOR"){alert("Only OPERATORs can start secondary timers. Please change your role to OPERATOR.");return}pl(c.id)},disabled:Ge?.itemId===c.id||d==="VIEWER"||d==="EDITOR"||!hs(c.id),className:`px-3 py-1 rounded text-sm font-bold transition-colors ${d==="VIEWER"||d==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":hs(c.id)?Ge?.itemId===c.id?"bg-orange-600 text-white cursor-default":"bg-orange-500 hover:bg-orange-400 text-white":"bg-gray-500 text-gray-300 cursor-not-allowed"}`,title:d==="VIEWER"||d==="EDITOR"?"Only OPERATORs can start secondary timers":hs(c.id)?"Start secondary timer":"Start the CUE above first before starting secondary timer",children:Ge?.itemId===c.id?"PLAYING":"PLAY"}),i.jsx("button",{onClick:()=>{if(d==="VIEWER"||d==="EDITOR"){alert("Only OPERATORs can stop secondary timers. Please change your role to OPERATOR.");return}gl()},disabled:Ge?.itemId!==c.id||d==="VIEWER"||d==="EDITOR"||!hs(c.id),className:`px-3 py-1 rounded text-sm font-bold transition-colors ${d==="VIEWER"||d==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":hs(c.id)?Ge?.itemId===c.id?"bg-red-600 hover:bg-red-500 text-white":"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-gray-500 text-gray-300 cursor-not-allowed"}`,title:d==="VIEWER"||d==="EDITOR"?"Only OPERATORs can stop secondary timers":"Stop secondary timer",children:"STOP"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:async()=>{if(d==="VIEWER"){alert("Viewers cannot load cues. Please change your role to EDITOR or OPERATOR.");return}if(console.log(" Button clicked, currentUserRole:",d),console.log(" Button clicked, item.id:",c.id),d==="EDITOR"){alert("Editors cannot load cues. Please change your role to OPERATOR.");return}console.log(" Button clicked, calling loadCue with item.id:",c.id),await zi(c.id)},disabled:ye===c.id||d==="VIEWER"||d==="EDITOR",className:`px-3 py-1 rounded text-sm font-bold transition-colors ${d==="VIEWER"||d==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":ye===c.id?"bg-blue-600 text-white cursor-default":"bg-slate-600 hover:bg-slate-500 text-white"}`,title:d==="VIEWER"?"Viewers cannot load cues":d==="EDITOR"?"Editors cannot load cues":"Load this cue",children:ye===c.id?"LOADED":"LOAD"}),i.jsx("button",{onClick:async()=>{if(d==="VIEWER"||d==="EDITOR"){alert("Only OPERATORs can start/stop timers. Please change your role to OPERATOR.");return}await fs(c.id)},disabled:ye!==c.id||(Re[c.id]?!1:Object.keys(Re).length>0)||d==="VIEWER"||d==="EDITOR",className:`px-3 py-1 rounded text-sm font-bold transition-colors ${d==="VIEWER"||d==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":Re[c.id]?"bg-red-600 hover:bg-red-500 text-white":ye===c.id&&Object.keys(Re).length===0?"bg-green-600 hover:bg-green-500 text-white":"bg-slate-600 text-slate-400 cursor-not-allowed"}`,title:d==="VIEWER"||d==="EDITOR"?"Only OPERATORs can start/stop timers":Re[c.id]?"Stop timer":"Start timer",children:Re[c.id]?"STOP":"START"})]})})]})},`${c.id}-${c.notes?.length||0}-${c.speakers?.length||0}`))]})]})]})}),C&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-slate-800 rounded-lg max-w-lg w-full max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-600",children:[i.jsx("h2",{className:"text-lg font-bold text-white",children:"Add Schedule Item"}),i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:Pe.isPublic,onChange:c=>st(p=>({...p,isPublic:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-slate-300 text-sm",children:"Public"})]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Cue"}),i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex items-center px-2 py-2 bg-slate-600 border border-slate-600 border-r-0 rounded-l text-white text-sm font-medium min-w-[40px]",children:"CUE"}),i.jsx("input",{type:"text",value:Pe.cue,onChange:c=>st(p=>({...p,cue:c.target.value})),className:"flex-1 px-3 py-2 bg-slate-700 border border-slate-600 rounded-r text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm",placeholder:"1, 1.1, 1A, etc."})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Program Type"}),i.jsx("select",{value:Pe.programType,onChange:c=>st(p=>({...p,programType:c.target.value})),className:"w-full px-3 py-2 bg-slate-700 border-2 border-slate-500 rounded text-white focus:outline-none focus:border-blue-500 text-sm",style:{backgroundColor:Fs[Pe.programType]||"#374151",color:Pe.programType==="Sub Cue"?"#000000":"#ffffff"},children:as.map(c=>i.jsx("option",{value:c,style:{backgroundColor:Fs[c]||"#374151",color:c==="Sub Cue"?"#000000":"#ffffff"},children:c},c))})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Segment Name"}),i.jsx("input",{type:"text",value:Pe.segmentName,onChange:c=>st(p=>({...p,segmentName:c.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm",placeholder:"Enter segment name"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Shot Type"}),i.jsxs("select",{value:Pe.shotType,onChange:c=>st(p=>({...p,shotType:c.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"Select Shot Type"}),jn.map(c=>i.jsx("option",{value:c,children:c},c))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Duration"}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{type:"number",value:Pe.durationHours,onChange:c=>st(p=>({...p,durationHours:parseInt(c.target.value)||0})),className:"w-12 px-2 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm text-center",min:"0",placeholder:"H"}),i.jsx("span",{className:"text-slate-400 self-center text-sm",children:":"}),i.jsx("input",{type:"number",value:Pe.durationMinutes,onChange:c=>st(p=>({...p,durationMinutes:parseInt(c.target.value)||0})),className:"w-12 px-2 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm text-center",min:"0",max:"59",placeholder:"M"}),i.jsx("span",{className:"text-slate-400 self-center text-sm",children:":"}),i.jsx("input",{type:"number",value:Pe.durationSeconds,onChange:c=>st(p=>({...p,durationSeconds:parseInt(c.target.value)||0})),className:"w-12 px-2 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm text-center",min:"0",max:"59",placeholder:"S"})]})]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:Pe.hasPPT,onChange:c=>st(p=>({...p,hasPPT:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-slate-300 text-sm",children:"Has PPT"})]}),i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:Pe.hasQA,onChange:c=>st(p=>({...p,hasQA:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-slate-300 text-sm",children:"Has QA"})]})]})]}),i.jsxs("div",{className:"mt-3",children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Notes"}),i.jsx("div",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm cursor-pointer hover:bg-slate-600 transition-colors min-h-[60px] flex items-center",onClick:()=>{qn(-1),wt(!0)},children:Pe.notes?i.jsx("div",{className:"text-sm",dangerouslySetInnerHTML:{__html:Pe.notes}}):i.jsx("span",{className:"text-slate-400",children:"Click to edit notes with rich formatting..."})})]}),i.jsxs("div",{className:"mt-3",children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Assets"}),i.jsx("div",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm cursor-pointer hover:bg-slate-600 transition-colors min-h-[60px] flex items-center",onClick:()=>{wn(-1),Lr(!0)},children:Pe.assets?i.jsx("div",{className:"text-sm",dangerouslySetInnerHTML:{__html:Pe.assets.replace(/\|\|/g,"<br>")}}):i.jsx("span",{className:"text-slate-400",children:"Click to edit assets with advanced management..."})})]}),i.jsxs("div",{className:"mt-3",children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Speakers"}),i.jsx("div",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm cursor-pointer hover:bg-slate-600 transition-colors min-h-[60px] flex items-start justify-start",onClick:()=>{xn(-1),Xr(!0)},style:{wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.6",whiteSpace:"pre-wrap"},children:Pe.speakersText?i.jsx("div",{className:"text-sm text-left w-full",children:ds(Pe.speakersText)}):i.jsx("span",{className:"text-slate-400",children:"Click to add speakers..."})})]}),i.jsxs("div",{className:"mt-3",children:[i.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Participants"}),i.jsx("div",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm cursor-pointer hover:bg-slate-600 transition-colors min-h-[60px] flex items-center",onClick:()=>{_r(-1),$r(!0)},children:Pe.speakers?i.jsx("div",{className:"text-sm",children:(()=>{try{const c=JSON.parse(Pe.speakers);return Array.isArray(c)?c.map((p,y)=>`${p.fullName||p.name||"Unknown"}${y<c.length-1?", ":""}`).join(""):Pe.speakers}catch{return Pe.speakers}})()}):i.jsx("span",{className:"text-slate-400",children:"Click to edit participants with photos and advanced management..."})})]})]}),i.jsx("div",{className:"p-4 border-t border-slate-600",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>ml(Pe),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded transition-colors text-sm",children:"Add Item"}),i.jsx("button",{onClick:()=>H(!1),className:"flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors text-sm",children:"Cancel"})]})})]})}),Ke&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-slate-800 rounded-xl p-8 max-w-md w-full",children:[i.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Add Custom Column"}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-slate-300 font-semibold mb-2",children:"Column Name"}),i.jsx("input",{type:"text",placeholder:"Enter column name",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",onKeyPress:c=>{if(c.key==="Enter"){const p=c.target;p.value.trim()&&(Bi(p.value.trim()),p.value="")}}})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>{const c=document.querySelector('input[placeholder="Enter column name"]');c?.value.trim()&&(Bi(c.value.trim()),c.value="")},className:"flex-1 px-4 py-3 bg-purple-600 hover:bg-purple-500 text-white font-semibold rounded-lg transition-colors",children:"Add Column"}),i.jsx("button",{onClick:()=>ze(!1),className:"flex-1 px-4 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})]})}),Je&&$t!==null&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-5xl w-full max-h-[90vh] flex flex-col",children:[i.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Edit Notes"}),i.jsxs("div",{className:"mb-4 bg-slate-700 rounded-lg overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 border-b border-slate-600",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-white text-sm font-semibold",children:"Format:"}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>He("undo"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Undo",children:""}),i.jsx("button",{onClick:()=>He("redo"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Redo",children:""}),i.jsx("div",{className:"w-px h-6 bg-slate-500 mx-1"}),i.jsx("button",{onClick:()=>He("bold"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded font-bold flex items-center justify-center",title:"Bold",children:"B"}),i.jsx("button",{onClick:()=>He("italic"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded italic flex items-center justify-center",title:"Italic",children:"I"}),i.jsx("button",{onClick:()=>He("underline"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded underline flex items-center justify-center",title:"Underline",children:"U"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-white text-sm font-semibold",children:"Size:"}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>He("fontSize","1"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Small",children:"S"}),i.jsx("button",{onClick:()=>He("fontSize","3"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded flex items-center justify-center",title:"Normal",children:"N"}),i.jsx("button",{onClick:()=>He("fontSize","5"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-base rounded flex items-center justify-center",title:"Large",children:"L"}),i.jsx("button",{onClick:()=>He("fontSize","7"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-lg rounded flex items-center justify-center",title:"X-Large",children:"XL"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-white text-sm font-semibold",children:"Align:"}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>He("left"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Left Align",children:""}),i.jsx("button",{onClick:()=>He("center"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Center Align",children:""}),i.jsx("button",{onClick:()=>He("right"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Right Align",children:""})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-white text-sm font-semibold",children:"Lists:"}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>He("bullet"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded flex items-center justify-center",title:"Bullet List",children:""}),i.jsx("button",{onClick:()=>He("list"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded flex items-center justify-center",title:"Numbered List",children:"1."})]})]})]}),i.jsxs("div",{className:"flex items-center justify-center gap-6 p-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-white text-sm font-semibold",children:"Text Color:"}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>He("color","#ffffff"),className:"w-6 h-6 bg-white border border-slate-400 rounded",title:"White"}),i.jsx("button",{onClick:()=>He("color","#ef4444"),className:"w-6 h-6 bg-red-500 rounded",title:"Red"}),i.jsx("button",{onClick:()=>He("color","#3b82f6"),className:"w-6 h-6 bg-blue-500 rounded",title:"Blue"}),i.jsx("button",{onClick:()=>He("color","#22c55e"),className:"w-6 h-6 bg-green-500 rounded",title:"Green"}),i.jsx("button",{onClick:()=>He("color","#f97316"),className:"w-6 h-6 bg-orange-500 rounded",title:"Orange"}),i.jsx("button",{onClick:()=>He("color","#a855f7"),className:"w-6 h-6 bg-purple-500 rounded",title:"Purple"}),i.jsx("button",{onClick:()=>He("color","#000000"),className:"w-6 h-6 bg-black border border-slate-400 rounded",title:"Black"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-white text-sm font-semibold",children:"Highlight:"}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>He("highlight","transparent"),className:"w-6 h-6 bg-slate-600 border border-slate-400 rounded flex items-center justify-center text-white text-xs",title:"No Highlight",children:""}),i.jsx("button",{onClick:()=>He("highlight","#fbbf24"),className:"w-6 h-6 bg-yellow-400 rounded",title:"Yellow"}),i.jsx("button",{onClick:()=>He("highlight","#60a5fa"),className:"w-6 h-6 bg-blue-400 rounded",title:"Light Blue"}),i.jsx("button",{onClick:()=>He("highlight","#4ade80"),className:"w-6 h-6 bg-green-400 rounded",title:"Light Green"}),i.jsx("button",{onClick:()=>He("highlight","#f472b6"),className:"w-6 h-6 bg-pink-400 rounded",title:"Pink"}),i.jsx("button",{onClick:()=>He("highlight","#fb923c"),className:"w-6 h-6 bg-orange-400 rounded",title:"Orange"})]})]})]})]}),i.jsxs("div",{className:"flex-1 min-h-[400px] mb-6",children:[i.jsx("label",{className:"block text-white text-sm mb-2",children:"Notes:"}),i.jsx("div",{id:"notes-editor",contentEditable:!0,className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white text-base focus:outline-none focus:border-blue-500 overflow-auto",style:{height:"400px",lineHeight:"1.5",fontFamily:"system-ui, -apple-system, sans-serif"},"data-placeholder":"Start typing your notes here...",onInput:c=>{}})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:Mi,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"}),i.jsx("button",{onClick:()=>{wt(!1),qn(null)},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})]})}),yn&&Zt!==null&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-5xl w-full max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-700",children:[i.jsxs("h2",{className:"text-xl font-bold text-white",children:["Edit Speakers (",bt.length,"/7)"]}),i.jsx("button",{onClick:()=>{Xr(!1),xn(null)},className:"text-slate-400 hover:text-white text-xl",children:""})]}),i.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[i.jsx("div",{className:"mb-6",children:i.jsxs("button",{onClick:zt,disabled:bt.length>=7,className:"px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors",children:["+ Add Speaker ",bt.length<7&&`(${7-bt.length} slots remaining)`]})}),i.jsxs("div",{className:"space-y-4 mb-6",children:[bt.sort((c,p)=>c.slot-p.slot).map(c=>i.jsxs("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Speaker ",c.slot]}),i.jsx("button",{onClick:()=>Nn(c.id),className:"w-8 h-8 bg-red-600 hover:bg-red-500 text-white rounded flex items-center justify-center transition-colors",title:"Remove Speaker",children:""})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Slot Number"}),i.jsx("select",{value:c.slot,onChange:p=>us(c.id,parseInt(p.target.value)),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[1,2,3,4,5,6,7].map(p=>{const y=bt.some(b=>b.id!==c.id&&b.slot===p);return i.jsxs("option",{value:p,className:y?"bg-yellow-600 text-white":"bg-slate-600 text-white",children:[p," ",y?"(Used)":""]},p)})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Location"}),i.jsxs("select",{value:c.location,onChange:p=>jr(c.id,"location",p.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[i.jsx("option",{value:"Podium",children:"Podium"}),i.jsx("option",{value:"Seat",children:"Seat"}),i.jsx("option",{value:"Virtual",children:"Virtual"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Full Name"}),i.jsx("input",{type:"text",value:c.fullName,onChange:p=>jr(c.id,"fullName",p.target.value),placeholder:"Enter full name",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Title"}),i.jsx("input",{type:"text",value:c.title,onChange:p=>jr(c.id,"title",p.target.value),placeholder:"Enter title",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Organization"}),i.jsx("input",{type:"text",value:c.org,onChange:p=>jr(c.id,"org",p.target.value),placeholder:"Enter organization",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Photo Link"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"url",value:c.photoLink,onChange:p=>jr(c.id,"photoLink",p.target.value),placeholder:"Enter photo URL",className:"flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"}),c.photoLink&&i.jsx("div",{className:"flex-shrink-0",children:i.jsx("img",{src:c.photoLink,alt:c.fullName,className:"w-12 h-12 rounded object-cover border-2 border-slate-500 -mt-2.5",onError:p=>{p.currentTarget.style.display="none"}})})]})]})]})]},c.id)),bt.length===0&&i.jsx("div",{className:"text-center py-8 text-slate-400",children:'No speakers added yet. Click "Add Speaker" to get started.'})]})]}),i.jsx("div",{className:"border-t border-slate-700 p-6",children:i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:Wr,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"}),i.jsx("button",{onClick:()=>{Xr(!1),xn(null)},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})})]})}),Kn&&Tt!==null&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Edit Assets"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h3",{className:"text-lg font-semibold text-white",children:"Assets List"}),i.jsx("button",{onClick:cs,className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:"+ Add Asset"})]}),i.jsx("div",{id:"assets-list",className:"space-y-3"})]}),i.jsxs("div",{className:"flex gap-3 mt-6",children:[i.jsx("button",{onClick:Vo,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"}),i.jsx("button",{onClick:()=>{Lr(!1),wn(null)},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})]})}),ji&&Io!==null&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:"Assets List"}),i.jsx("button",{onClick:()=>{Oo(!1),Po(null)},className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:"Close"})]}),i.jsx("div",{className:"space-y-4",children:(()=>{const c=O.find(y=>y.id===Io);if(!c||!c.assets)return i.jsx("div",{className:"text-center py-8",children:i.jsx("p",{className:"text-slate-400 text-lg",children:"No assets available for this item."})});let p=[];if(c.assets.includes("||"))p=c.assets.split("||").filter(b=>b.trim()).map(b=>{if(b.includes("|")){const[E,j]=b.split("|").map(P=>P.trim());return{name:E||"Unnamed Asset",url:j||""}}else return{name:b.trim(),url:""}});else if(c.assets.includes("|")){const[y,b]=c.assets.split("|").map(E=>E.trim());p=[{name:y||"Unnamed Asset",url:b||""}]}else try{const y=JSON.parse(c.assets);Array.isArray(y)?p=y.map(b=>({name:b.name||"Unnamed Asset",url:b.link||b.url||""})):p=[{name:y.name||"Unnamed Asset",url:y.link||y.url||""}]}catch{p=[{name:c.assets.trim(),url:""}]}return p.length===0?i.jsx("div",{className:"text-center py-8",children:i.jsx("p",{className:"text-slate-400 text-lg",children:"No assets available for this item."})}):i.jsx("div",{className:"space-y-4",children:i.jsx("div",{className:"max-h-96 overflow-y-auto space-y-3 pr-2",children:p.map((y,b)=>i.jsx("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-white font-semibold text-lg",children:y.name}),y.url&&i.jsx("div",{children:i.jsx("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline break-all text-sm",children:y.url})})]})},b))})})})()})]})}),Jn&&Sr!==null&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-5xl w-full max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-700",children:[i.jsxs("h2",{className:"text-xl font-bold text-white",children:["Edit Participants (",pt.length,"/7)"]}),i.jsx("button",{onClick:()=>{$r(!1),_r(null)},className:"text-slate-400 hover:text-white text-xl",children:""})]}),i.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[i.jsx("div",{className:"mb-6",children:i.jsxs("button",{onClick:Wo,disabled:pt.length>=7,className:"px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors",children:["+ Add Speaker ",pt.length<7&&`(${7-pt.length} slots remaining)`]})}),i.jsxs("div",{className:"space-y-4",children:[pt.sort((c,p)=>c.slot-p.slot).map(c=>i.jsxs("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Speaker ",c.slot]}),i.jsx("button",{onClick:()=>Vs(c.id),className:"w-8 h-8 bg-red-600 hover:bg-red-500 text-white rounded flex items-center justify-center transition-colors",title:"Remove Speaker",children:""})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Slot Number"}),i.jsx("select",{value:c.slot,onChange:p=>ll(c.id,parseInt(p.target.value)),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[1,2,3,4,5,6,7].map(p=>{const y=pt.some(b=>b.id!==c.id&&b.slot===p);return i.jsxs("option",{value:p,className:y?"bg-yellow-600 text-white":"bg-slate-600 text-white",children:[p," ",y?"(Used)":""]},p)})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Location"}),i.jsxs("select",{value:c.location,onChange:p=>Nr(c.id,"location",p.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[i.jsx("option",{value:"Podium",children:"Podium"}),i.jsx("option",{value:"Seat",children:"Seat"}),i.jsx("option",{value:"Virtual",children:"Virtual"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Full Name"}),i.jsx("input",{type:"text",value:c.fullName,onChange:p=>Nr(c.id,"fullName",p.target.value),placeholder:"Enter full name",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Title"}),i.jsx("input",{type:"text",value:c.title,onChange:p=>Nr(c.id,"title",p.target.value),placeholder:"Enter title/position",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Organization"}),i.jsx("input",{type:"text",value:c.org,onChange:p=>Nr(c.id,"org",p.target.value),placeholder:"Enter organization",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Speaker Photo Link"}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"url",value:c.photoLink,onChange:p=>Nr(c.id,"photoLink",p.target.value),placeholder:"Enter photo URL",className:"flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"}),c.photoLink&&i.jsx("div",{className:"flex-shrink-0",children:i.jsx("img",{src:c.photoLink,alt:c.fullName,className:"w-12 h-12 rounded object-cover border-2 border-slate-500 -mt-2.5",onError:p=>{p.target.style.display="none"}})})]})]})]})]},c.id)),pt.length===0&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"text-slate-400 text-lg mb-4",children:"No speakers added yet"}),i.jsx("button",{onClick:Wo,className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Add Your First Speaker"})]})]})]}),i.jsx("div",{className:"border-t border-slate-700 p-6",children:i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:Ui,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"}),i.jsx("button",{onClick:()=>{$r(!1),_r(null)},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})})]})}),Ri&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 max-w-md w-full",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h3",{className:"text-xl font-bold text-white",children:"Send Message to Full Screen Timer"}),i.jsx("button",{onClick:()=>Yn(!1),className:"text-slate-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Quick Presets"}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:["Break in 5 minutes","Technical difficulties","Starting soon","Please wait","Break time","Resuming shortly","Stall / Stretch Time","Wrap Up Please"].map(c=>i.jsx("button",{onClick:()=>Ds(c),className:"px-3 py-2 bg-slate-700 hover:bg-slate-600 border border-slate-600 rounded text-white text-sm transition-colors text-left",children:c},c))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Custom Message"}),i.jsx("textarea",{value:tn,onChange:c=>Ds(c.target.value),placeholder:"Enter custom message to display on full screen timer...",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm h-24 resize-none"})]}),tn&&i.jsx("div",{className:"p-3 bg-slate-700 rounded-lg",children:i.jsxs("div",{className:"text-slate-300 text-sm",children:[i.jsx("strong",{children:"Message Preview:"})," ",tn]})})]}),i.jsxs("div",{className:"flex gap-3 mt-6",children:[i.jsx("button",{onClick:async()=>{if(!(!tn.trim()||!n?.id))try{const p=(await Se.getTimerMessagesForEvent(n.id)).filter(E=>E.enabled);for(const E of p)await Se.disableTimerMessage(E.id),console.log(" Disabled existing message:",E.id);const y={event_id:n.id,message:tn.trim(),enabled:!0,sent_by:a?.id,sent_by_name:a?.user_metadata?.full_name||a?.email||"Unknown User",sent_by_role:d||"VIEWER",message_type:"general",priority:2},b=await Se.saveTimerMessage(y);if(!b){console.error(" Failed to save message to Supabase"),alert("Failed to save message. Please try again.");return}console.log(" New message created in Supabase:",b),Oi(!0),Ot&&!Ot.closed&&Ot.postMessage({type:"MESSAGE_UPDATE",message:tn,enabled:!0},"*"),Ds(""),Yn(!1)}catch(c){console.error(" Error saving message:",c),alert("Error saving message. Please try again.")}},className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded transition-colors",disabled:!tn.trim()||!n?.id,children:"Send & Activate Message"}),i.jsx("button",{onClick:()=>Yn(!1),className:"flex-1 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors",children:"Cancel"})]})]})}),Mo&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-slate-800 rounded-lg max-w-md w-full max-h-[80vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-600",children:[i.jsx("h2",{className:"text-lg font-bold text-white",children:"Filter Columns"}),i.jsx("button",{onClick:()=>As(!1),className:"text-slate-400 hover:text-white text-xl",children:""})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Select which columns to display in the schedule:"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:je.start,onChange:c=>_t(p=>({...p,start:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-white",children:"Start Time"})]}),i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:je.programType,onChange:c=>_t(p=>({...p,programType:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-white",children:"Program Type"})]}),i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:je.duration,onChange:c=>_t(p=>({...p,duration:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-white",children:"Duration"})]}),i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:je.segmentName,onChange:c=>_t(p=>({...p,segmentName:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-white",children:"Segment Name"})]}),i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:je.shotType,onChange:c=>_t(p=>({...p,shotType:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-white",children:"Shot Type"})]}),i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:je.pptQA,onChange:c=>_t(p=>({...p,pptQA:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-white",children:"PPT/Q&A"})]}),i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:je.notes,onChange:c=>_t(p=>({...p,notes:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-white",children:"Notes"})]}),i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:je.assets,onChange:c=>_t(p=>({...p,assets:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-white",children:"Assets"})]}),i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:je.participants,onChange:c=>_t(p=>({...p,participants:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-white",children:"Participants"})]}),i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:je.speakers,onChange:c=>_t(p=>({...p,speakers:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-white",children:"Speakers"})]}),i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:je.public,onChange:c=>_t(p=>({...p,public:c.target.checked})),className:"rounded"}),i.jsx("span",{className:"text-white",children:"Public"})]}),q.map((c,p)=>i.jsxs("label",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:Ft[c.id]!==!1,onChange:y=>Uo(b=>({...b,[c.id]:y.target.checked})),className:"rounded"}),i.jsxs("span",{className:"text-white",children:[c.name,i.jsx("span",{className:"text-slate-400 text-xs ml-2",children:"(Custom)"})]})]},c.id))]})]})}),i.jsx("div",{className:"p-4 border-t border-slate-600",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{_t({start:!0,programType:!0,duration:!0,segmentName:!0,shotType:!0,pptQA:!0,notes:!0,assets:!0,participants:!0,speakers:!0,public:!0,custom:!0});const c={};q.forEach(p=>{c[p.id]=!0}),Uo(c)},className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors text-sm",children:"Show All"}),i.jsx("button",{onClick:()=>{_t({start:!1,programType:!1,duration:!1,segmentName:!1,shotType:!1,pptQA:!1,notes:!1,assets:!1,participants:!1,speakers:!1,public:!1,custom:!1});const c={};q.forEach(p=>{c[p.id]=!1}),Uo(c)},className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors text-sm",children:"Hide All"}),i.jsx("button",{onClick:()=>As(!1),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded transition-colors text-sm",children:"Apply Filters"})]})})]})}),zr&&i.jsx("div",{className:"fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50",children:i.jsxs("div",{className:`px-6 py-4 rounded-lg shadow-lg border-2 flex items-center gap-3 ${dr==="early"?"bg-yellow-600 border-yellow-500 text-yellow-100":dr==="late"?"bg-red-600 border-red-500 text-red-100":"bg-green-600 border-green-500 text-green-100"}`,children:[i.jsx("div",{className:"text-3xl flex-shrink-0",children:dr==="early"?"":dr==="late"?"":""}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-bold text-lg mb-1",children:dr==="early"?"EARLY":dr==="late"?"RUNNING LATE":"ON TIME"}),i.jsxs("div",{className:"text-base font-medium",children:[i.jsx("span",{className:"text-2xl font-bold",children:ts>=60?`${Math.floor(ts/60)}h ${ts%60}m`:`${ts}m`}),dr==="early"?` before ${Object.keys(Re).length>0&&O.find(c=>c.id===parseInt(Object.keys(Re)[0]))?.customFields.cue||"CUE"} start`:dr==="late"?` after ${Object.keys(Re).length>0&&O.find(c=>c.id===parseInt(Object.keys(Re)[0]))?.customFields.cue||"CUE"} start`:" - Timing is on track"]})]}),i.jsx("button",{onClick:()=>Ae(!1),className:"ml-4 text-xl hover:opacity-70 transition-opacity",children:""})]})}),i.jsx(Vv,{isOpen:Ls,onClose:()=>Ii(!1),event:n,schedule:O,activeItemId:ye,activeTimers:Re,onLoadCue:async c=>{const p=parseInt(c);isNaN(p)||await zi(p)},onStartTimer:async c=>{if(c==="generic")ye?(console.log(" Generic start - controlling currently loaded item:",ye),await fs(ye)):console.log(" No item currently loaded for generic start");else{const p=parseInt(c);isNaN(p)||await fs(p)}},onStopTimer:async c=>{if(c==="generic"){const p=Object.keys(Re);if(p.length>0){const y=parseInt(p[0]);console.log(" Generic stop - controlling currently running timer:",y),await fs(y)}else console.log(" No timer currently running for generic stop")}else{const p=parseInt(c);isNaN(p)||await fs(p)}},onResetTimer:async c=>{if(c==="generic")console.log(" Generic reset - using resetAllStates (same as Reset button)"),await Vi();else{const p=parseInt(c);isNaN(p)||await qi(p)}}})]}):i.jsx("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"No Event Selected"}),i.jsx("button",{onClick:()=>r("/"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded",children:"Back to Event List"})]})})},Bv=({isRunning:u=!1,elapsedTime:r=0,totalDuration:n=0,onClose:o,message:a="",messageEnabled:h=!1,itemId:d,eventId:g,mainTimer:v=null,secondaryTimer:w=null})=>{const[S,_]=k.useState({elapsed:r,total:n}),[T,R]=k.useState(new Date),[A,M]=k.useState(!1),[L,Q]=k.useState(null),[K,B]=k.useState(!1);k.useEffect(()=>{_({elapsed:r,total:n})},[r,n]),k.useEffect(()=>{const O=setInterval(()=>{R(new Date)},1e3);return()=>clearInterval(O)},[]),k.useEffect(()=>{const O=()=>{M(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",O),()=>document.removeEventListener("fullscreenchange",O)},[]),k.useEffect(()=>{if(!g)return;const O=async()=>{B(!0);try{const q=await Se.getTimerMessage(g);Q(q),console.log(" Loaded timer message from Supabase:",q)}catch(q){console.error(" Error loading timer message:",q)}finally{B(!1)}};O();const Z=setInterval(O,5e3);return()=>clearInterval(Z)},[g]);const $=O=>{const Z=O<0,q=Math.abs(O),Y=Math.floor(q/3600),ce=Math.floor(q%3600/60),ke=Math.floor(q%60),De=Z?"-":"";return Y===0?`${De}${ce.toString().padStart(2,"0")}:${ke.toString().padStart(2,"0")}`:`${De}${Y.toString().padStart(2,"0")}:${ce.toString().padStart(2,"0")}:${ke.toString().padStart(2,"0")}`},G=O=>O.toLocaleTimeString("en-US",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}),z=()=>{const O=S;return O.total-O.elapsed},ne=()=>{const O=S,Z=O.total-O.elapsed;return O.total>0?Z/O.total*100:0},ae=()=>{const O=S,Z=O.total-O.elapsed;return Z>120?"#10b981":Z>30?"#f59e0b":"#ef4444"};return i.jsxs("div",{className:"fixed inset-0 bg-black text-white overflow-hidden flex flex-col items-center justify-center",style:{padding:0,margin:0},children:[i.jsxs("div",{className:"absolute top-10 left-10 text-3xl font-mono text-white",children:[i.jsx("div",{className:"text-slate-400 text-lg mb-1",children:"CURRENT TIME"}),i.jsx("div",{className:"text-white",children:G(T)})]}),i.jsxs("div",{className:"absolute top-10 right-10 text-3xl font-mono text-white",children:[i.jsx("div",{className:"text-slate-400 text-lg mb-1",children:"CURRENT CUE"}),i.jsxs("div",{className:"text-white flex items-center gap-3",children:[i.jsx("span",{children:v?`${v.cue}${v.segmentName?` - ${v.segmentName}`:""}`:"No CUE"}),d&&i.jsx(Zf,{itemId:d,className:"flex-shrink-0"})]})]}),!A&&i.jsx("button",{onClick:()=>{document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()},className:"absolute top-10 left-1/2 transform -translate-x-1/2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-bold text-lg transition-colors z-50",children:"FULL SCREEN"}),(h&&a||L&&L.enabled)&&i.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:i.jsx("div",{className:"font-bold text-white bg-black bg-opacity-50 rounded-lg border-4 border-white text-center flex items-center justify-center",style:{width:"80vw",height:"50vh",lineHeight:"1.1",whiteSpace:"pre-line",overflow:"hidden",paddingBottom:"20px"},children:(()=>{const O=L?.message||a,Z=O.split(" ");let q;if(Z.length<=3)q=O;else if(Z.length<=6){const ke=Math.ceil(Z.length/2);q=Z.slice(0,ke).join(" ")+`
`+Z.slice(ke).join(" ")}else if(Z.length<=10){const ke=Math.ceil(Z.length/3);q=Z.slice(0,ke).join(" ")+`
`+Z.slice(ke,ke*2).join(" ")+`
`+Z.slice(ke*2).join(" ")}else{const ke=Math.ceil(Z.length/4);q=Z.slice(0,ke).join(" ")+`
`+Z.slice(ke,ke*2).join(" ")+`
`+Z.slice(ke*2,ke*3).join(" ")+`
`+Z.slice(ke*3).join(" ")}let Y;const ce=/[gjpqy]/.test(O.toLowerCase());return Z.length<=3?Y=ce?"clamp(3rem, 12vw, 16rem)":"clamp(3.5rem, 13.5vw, 18rem)":Z.length<=6?Y=ce?"clamp(1.9rem, 8vw, 12rem)":"clamp(2.25rem, 9vw, 13.5rem)":Z.length<=10?Y=ce?"clamp(1.4rem, 6vw, 9rem)":"clamp(1.6rem, 7vw, 10.5rem)":Y=ce?"clamp(0.9rem, 4vw, 6rem)":"clamp(1.1rem, 5vw, 7rem)",i.jsx("div",{style:{fontSize:Y},children:q})})()})}),w&&i.jsxs("div",{className:`absolute animate-in fade-in duration-500 ${h&&a||L&&L.enabled?"bottom-20 right-1/3 transform translate-x-1/2 flex flex-col items-center":"inset-0 flex flex-col items-center justify-center"}`,style:{marginTop:h&&a||L&&L.enabled?"0":"-80px"},children:[i.jsxs("div",{className:`text-orange-400 font-bold animate-in slide-in-from-top duration-500 ${h&&a||L&&L.enabled?"text-lg md:text-xl lg:text-2xl mb-2":"text-xl md:text-2xl lg:text-3xl mb-4"}`,style:{lineHeight:"1.2"},children:[w.cue,w.segmentName&&` - ${w.segmentName}`]}),i.jsx("div",{className:`text-orange-400 font-mono font-bold animate-in zoom-in duration-500 ${(()=>{const O=Math.floor(w.remaining/3600);return h&&a||L&&L.enabled?"text-3xl md:text-4xl lg:text-5xl":O===0?"text-[15rem] md:text-[16.875rem] lg:text-[22.5rem]":"text-[12rem] md:text-[13.5rem] lg:text-[18rem]"})()}`,style:{lineHeight:"1"},children:(()=>{const O=Math.floor(w.remaining/3600),Z=Math.floor(w.remaining%3600/60),q=w.remaining%60;return O===0?`${Z.toString().padStart(2,"0")}:${q.toString().padStart(2,"0")}`:`${O.toString().padStart(2,"0")}:${Z.toString().padStart(2,"0")}:${q.toString().padStart(2,"0")}`})()})]}),!(h&&a||w)&&i.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center",children:[z()<0&&i.jsx("div",{className:"mb-[-50px]",children:i.jsx("div",{className:"font-bold text-red-500 text-5xl",children:"OVER TIME"})}),i.jsx("div",{className:"text-center",children:i.jsx("div",{className:`font-mono font-bold ${(()=>{const O=z();return Math.floor(Math.abs(O)/3600)===0?"text-[15rem] md:text-[16.875rem] lg:text-[22.5rem]":"text-[12rem] md:text-[13.5rem] lg:text-[18rem]"})()}`,style:{color:ae()},children:$(z())})}),i.jsx("div",{className:"w-full max-w-5xl mt-0",children:i.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-8",children:i.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${ne()}%`,background:ae()}})})})]}),(h&&a||w)&&i.jsxs("div",{className:`text-center transition-all duration-500 ease-in-out absolute bottom-20 ${h&&a&&w?"left-1/3 transform -translate-x-1/2":"left-1/2 transform -translate-x-1/2"}`,children:[z()<0&&i.jsx("div",{className:"mb-2",children:i.jsx("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"})}),i.jsx("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:ae()},children:$(z())})]}),(h&&a||w)&&i.jsx("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:i.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:i.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${ne()}%`,background:ae()}})})})]})},Hv=()=>{const u=br();To();const r=u.state||{},[n,o]=k.useState(r.isRunning||!1),[a,h]=k.useState(r.elapsedTime||0),[d,g]=k.useState(r.totalDuration||0),[v,w]=k.useState(""),[S,_]=k.useState(!1),[T,R]=k.useState(null),[A,M]=k.useState(r.itemId||null),[L,Q]=k.useState(r.eventId||null),[K,B]=k.useState(r.mainTimer||null),[$,G]=k.useState(r.secondaryTimer||null);k.useEffect(()=>{const ne=ae=>{switch(ae.key){case"Escape":window.close();break;case" ":ae.preventDefault(),o(!n);break;case"r":case"R":(ae.ctrlKey||ae.metaKey)&&(ae.preventDefault(),h(0),o(!1));break;case"+":case"=":(ae.ctrlKey||ae.metaKey)&&ae.preventDefault();break;case"-":(ae.ctrlKey||ae.metaKey)&&ae.preventDefault();break}};return window.addEventListener("keydown",ne),()=>window.removeEventListener("keydown",ne)},[n]);const z=async()=>{if(L&&(S||T))try{const ae=(await Se.getTimerMessagesForEvent(L)).find(O=>O.enabled);ae&&(await Se.disableTimerMessage(ae.id),console.log(" Message disabled in Supabase on close"))}catch(ne){console.error(" Error clearing message on close:",ne)}window.close()};return k.useEffect(()=>{if(!L)return;const ne=async()=>{try{const O=await Se.getTimerMessage(L);R(O),console.log(" Loaded timer message from Supabase:",O)}catch(O){console.error(" Error loading timer message:",O)}};ne();const ae=setInterval(ne,5e3);return()=>clearInterval(ae)},[L]),k.useEffect(()=>{const ne=ae=>{if(ae.data.type==="TIMER_UPDATE"){const{isRunning:O,elapsedTime:Z,totalDuration:q,eventId:Y,itemId:ce,mainTimer:ke,secondaryTimer:De}=ae.data;O!==void 0&&o(O),Z!==void 0&&h(Z),q!==void 0&&g(q),Y!==void 0&&Q(Y),ce!==void 0&&M(ce),ke!==void 0&&B(ke),De!==void 0&&G(De)}else if(ae.data.type==="MESSAGE_UPDATE"){const{message:O,enabled:Z}=ae.data;O!==void 0&&w(O),Z!==void 0&&_(Z)}};return window.addEventListener("message",ne),()=>window.removeEventListener("message",ne)},[]),i.jsx(Bv,{isRunning:n,elapsedTime:a,totalDuration:d,onClose:z,message:v,messageEnabled:S,itemId:A,eventId:L,supabaseMessage:T,mainTimer:K,secondaryTimer:$})},qv=()=>{const u=br(),r=To(),n=new URLSearchParams(u.search),o=n.get("eventId"),a=n.get("eventName"),h=u.state?.event||{id:o||"",name:a||"Current Event",date:"",location:"",schedule:[]},[d,g]=k.useState(()=>{console.log("=== GRAPHICS LINKS PAGE INITIALIZATION ==="),console.log("Event from location.state:",u.state?.event),console.log("Event from URL params:",{eventId:o,eventName:a}),console.log("Final event object:",h);let _=null;if(h?.id){console.log("Trying to get schedule with event ID:",h.id);const R=`runOfShowSchedule_${h.id}`;if(console.log("Looking for schedule key:",R),_=localStorage.getItem(R),console.log("Schedule found with event ID:",_),!_&&o){console.log("Trying with URL eventId:",o);const A=`runOfShowSchedule_${o}`;console.log("Looking for URL schedule key:",A),_=localStorage.getItem(A),console.log("Schedule found with URL eventId:",_)}}if(!_){console.log("No schedule found with event ID, trying to find any schedule...");const R=Object.keys(localStorage);console.log("All localStorage keys:",R);const A=R.filter(M=>M.startsWith("runOfShowSchedule_"));if(console.log("All schedule keys found:",A),A.length>0){const M=A[0];console.log("Using first schedule key:",M),_=localStorage.getItem(M),console.log("Schedule from first key:",_)}}if(!_){console.log("Still no schedule, trying most recent...");const A=Object.keys(localStorage).filter(M=>M.startsWith("runOfShowSchedule_"));if(console.log("All schedule keys:",A),A.length>0){const M=A[A.length-1];console.log("Using latest key:",M),_=localStorage.getItem(M),console.log("Schedule from latest key:",_)}}console.log("Final savedSchedule:",_);const T=_?JSON.parse(_):[];return console.log("Final parsed schedule:",T),console.log("=== END INITIALIZATION ==="),T});k.useEffect(()=>{const _=()=>{console.log(" localStorage changed, updating schedule...");let R=null;if(h?.id){const A=`runOfShowSchedule_${h.id}`;R=localStorage.getItem(A)}if(!R&&o){const A=`runOfShowSchedule_${o}`;R=localStorage.getItem(A)}if(!R){const M=Object.keys(localStorage).filter(L=>L.startsWith("runOfShowSchedule_"));if(M.length>0){const L=M[M.length-1];R=localStorage.getItem(L)}}if(R)try{const A=JSON.parse(R);console.log(" Updated schedule from localStorage:",A),g(A)}catch(A){console.log("Error parsing updated schedule:",A)}};window.addEventListener("storage",_),window.addEventListener("scheduleUpdated",_);const T=setInterval(()=>{console.log(" Polling for schedule changes..."),_()},2e3);return()=>{window.removeEventListener("storage",_),window.removeEventListener("scheduleUpdated",_),clearInterval(T)}},[h?.id,o]);const v=()=>{console.log("=== GRAPHICS LINKS JSON GENERATION ==="),console.log("Using schedule from state:",d);let _="";const R=Object.keys(localStorage).filter($=>$.startsWith("masterStartTime_"));if(console.log("Master time keys found:",R),R.length>0){const $=R[R.length-1],G=localStorage.getItem($);console.log("Master time data from key",$,":",G),G&&(_=G)}console.log("Final masterStartTime:",_);const A=$=>{if(!_)return"";let G=0;for(let O=0;O<$;O++){const Z=d[O];G+=Z.durationHours*60+Z.durationMinutes}const[z,ne]=_.split(":").map(Number),ae=new Date;return ae.setHours(z,ne+G,0,0),ae.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})};console.log("=== FINAL DATA SUMMARY ==="),console.log("Schedule from state:",d),console.log("Final masterStartTime:",_),console.log("=== END FINAL DATA SUMMARY ===");const M=d.filter($=>$.isPublic===!0).map($=>{const G=d.findIndex(ne=>ne.id===$.id),z=A(G);return{segmentName:$.segmentName||"Untitled Segment",startTime:z||"No Start Time"}});console.log("Public items found:",M);const L={event:h?.name||"Current Event",generated:new Date().toISOString(),schedule:M},Q=JSON.stringify(L,null,2),K=new Blob([Q],{type:"application/json;charset=utf-8;"}),B=URL.createObjectURL(K);window.open(B,"_blank")},w=()=>{console.log("=== GENERATING LOWER THIRDS JSON ==="),console.log("Event ID from URL:",o),console.log("Event object:",h),console.log("Using schedule from state:",d),console.log("Schedule length:",d.length),console.log("First few items:",d.slice(0,3)),d.length===0&&(console.log(" NO SCHEDULE DATA FOUND!"),console.log("Available localStorage keys:",Object.keys(localStorage)),console.log("Looking for keys with event ID:",o));const T=Object.keys(localStorage).filter(K=>K.startsWith("masterStartTime_"));if(T.length>0){const K=T[T.length-1];localStorage.getItem(K)}const R={speaker1:[],speaker2:[],speaker3:[],speaker4:[],speaker5:[],speaker6:[],speaker7:[]};d.forEach((K,B)=>{if(console.log("Processing item:",K.segmentName,"Speakers:",K.speakersText),K.speakersText&&K.speakersText.trim())try{const $=JSON.parse(K.speakersText);console.log("Parsed speakers array:",$);const G=$.sort((z,ne)=>z.slot-ne.slot);console.log("Sorted speakers by slot:",G),G.forEach(z=>{const ne=z.slot,ae=`speaker${ne}`;if(ne>=1&&ne<=7){const O={row:B+1,cue:K.customFields.cue||"",program:K.programType||"",name:z.fullName||"",titleOrg:z.title&&z.org?`${z.title}
${z.org}`:z.title||z.org||"",photo:z.photoLink||""};console.log(`Adding to ${ae} (slot ${ne} in row ${B+1}):`,O),R[ae].push(O)}else console.log(`Speaker slot ${ne} (${z.fullName}) is outside range 1-7, skipping`)})}catch($){console.log("Error parsing speakers JSON:",$),console.log("Raw speakers data:",K.speakersText)}else console.log("No speakers found in row:",K.segmentName)}),console.log("Speaker sections:",R);const A={event:h?.name||"Current Event",generated:new Date().toISOString(),lowerThirds:R},M=JSON.stringify(A,null,2),L=new Blob([M],{type:"application/json;charset=utf-8;"}),Q=URL.createObjectURL(L);window.open(Q,"_blank"),console.log("=== END GENERATING LOWER THIRDS JSON ===")},S=()=>{let _="";const R=Object.keys(localStorage).filter($=>$.startsWith("masterStartTime_"));if(R.length>0){const $=R[R.length-1],G=localStorage.getItem($);G&&(_=G)}const A=$=>{if(!_)return"";let G=0;for(let O=0;O<$;O++){const Z=d[O];G+=Z.durationHours*60+Z.durationMinutes}const[z,ne]=_.split(":").map(Number),ae=new Date;return ae.setHours(z,ne+G,0,0),ae.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},M=d.filter($=>$.isPublic).map($=>({type:$.segmentName||"Segment",text:$.segmentName||"Custom Graphic",duration:`${$.durationHours.toString().padStart(2,"0")}:${$.durationMinutes.toString().padStart(2,"0")}:${$.durationSeconds.toString().padStart(2,"0")}`,cue:$.customFields.cue||"CUE##",startTime:A(d.findIndex(G=>G.id===$.id)),notes:$.notes||""})),L={event:h?.name||"Current Event",generated:new Date().toISOString(),customGraphics:M.length>0?M:[{type:"Title",text:"Welcome to Event",duration:"00:00:10",cue:"CUE01",startTime:"00:00:00",notes:"Opening title"},{type:"Break",text:"Commercial Break",duration:"00:02:00",cue:"CUE02",startTime:"00:15:00",notes:"Commercial break"}]},Q=JSON.stringify(L,null,2),K=new Blob([Q],{type:"application/json;charset=utf-8;"}),B=URL.createObjectURL(K);window.open(B,"_blank")};return i.jsxs("div",{className:"min-h-screen bg-slate-900 text-white pt-16",children:[i.jsx("div",{className:"bg-slate-800 border-b border-slate-700",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex items-center justify-between h-16",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("button",{onClick:()=>r("/run-of-show",{state:{event:h}}),className:"text-slate-300 hover:text-white transition-colors mr-6",children:" Back to Run of Show"}),i.jsx("h1",{className:"text-xl font-semibold",children:"Graphics Links"})]}),i.jsx("div",{className:"text-slate-400",children:h?.name||"Event"})]})})}),i.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:i.jsxs("div",{className:"bg-slate-800 rounded-xl p-8 shadow-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:"Generate JSON Files"}),i.jsx("button",{onClick:()=>{console.log(" Manual refresh triggered");let _=null;if(h?.id){const T=`runOfShowSchedule_${h.id}`;_=localStorage.getItem(T)}if(!_&&o){const T=`runOfShowSchedule_${o}`;_=localStorage.getItem(T)}if(!_){const R=Object.keys(localStorage).filter(A=>A.startsWith("runOfShowSchedule_"));if(R.length>0){const A=R[R.length-1];_=localStorage.getItem(A)}}if(_)try{const T=JSON.parse(_);console.log(" Manually refreshed schedule:",T),g(T),alert("Schedule data refreshed!")}catch(T){console.log("Error parsing refreshed schedule:",T),alert("Error refreshing schedule data")}else alert("No schedule data found")},className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:" Refresh Data"})]}),i.jsx("p",{className:"text-slate-300 mb-8",children:`Click the buttons below to generate .json files that VMIX can use as data sources for graphics systems. Use "Refresh Data" if changes don't appear automatically.`}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"bg-slate-700 rounded-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Lower Thirds JSON"}),i.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Generate a .json file for lower third graphics with speaker information."}),i.jsx("button",{onClick:w,className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:"Click to Generate"})]}),i.jsxs("div",{className:"bg-slate-700 rounded-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Schedule JSON"}),i.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Generate a .json file with Segment Name and Start Time, sorted by time."}),i.jsx("button",{onClick:v,className:"w-full px-4 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors",children:"Click to Generate"})]}),i.jsxs("div",{className:"bg-slate-700 rounded-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Custom Graphics JSON"}),i.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Generate a .json file for custom graphics and overlays."}),i.jsx("button",{onClick:S,className:"w-full px-4 py-3 bg-purple-600 hover:bg-purple-500 text-white font-medium rounded-lg transition-colors",children:"Click to Generate"})]})]}),i.jsxs("div",{className:"mt-8 p-4 bg-slate-600 rounded-lg",children:[i.jsx("h4",{className:"text-white font-semibold mb-2",children:"VMIX Data Source Information"}),i.jsx("p",{className:"text-slate-300 text-sm",children:'These .json files are designed for VMIX and will include only items marked as "Public":'}),i.jsxs("ul",{className:"text-slate-300 text-sm mt-2 ml-4 list-disc",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Schedule JSON:"})," Segment Name, Start Time (sorted by time)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Lower Thirds JSON:"})," Name, Title, Organization, Segment, CUE"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Custom Graphics JSON:"})," Type, Text, Duration, CUE, Start Time, Notes"]})]}),i.jsx("div",{className:"mt-4 p-3 bg-blue-900 rounded-lg",children:i.jsxs("p",{className:"text-blue-200 text-sm",children:[i.jsx("strong",{children:"VMIX Setup:"})," Save the .json files to your server, then add the URLs in VMIX Data Sources  JSON/XML"]})})]})]})})]})},Kv=()=>{const u=br(),r=To(),n=new URLSearchParams(u.search),o=n.get("eventId"),a=n.get("eventName"),h=u.state?.event||{id:o||"",name:a||"Current Event",date:"",location:"",schedule:[]},[d,g]=k.useState([]),[v,w]=k.useState(""),[S,_]=k.useState("showfile"),[T,R]=k.useState(1);k.useEffect(()=>{console.log("=== REPORTS PAGE INITIALIZATION ==="),console.log("Event:",h);let B=null;if(h?.id){const z=`runOfShowSchedule_${h.id}`;B=localStorage.getItem(z)}if(!B&&o){const z=`runOfShowSchedule_${o}`;B=localStorage.getItem(z)}if(!B){const ne=Object.keys(localStorage).filter(ae=>ae.startsWith("runOfShowSchedule_"));if(ne.length>0){const ae=ne[ne.length-1];B=localStorage.getItem(ae)}}if(B)try{const z=JSON.parse(B);g(z),console.log("Schedule loaded:",z)}catch(z){console.log("Error parsing schedule:",z)}const G=Object.keys(localStorage).filter(z=>z.startsWith("masterStartTime_"));if(G.length>0){const z=G[G.length-1],ne=localStorage.getItem(z);ne&&w(ne)}},[h?.id,o]);const A=B=>{if(!v)return"";let $=0;for(let ae=0;ae<B;ae++){const O=d[ae];$+=O.durationHours*60+O.durationMinutes}const[G,z]=v.split(":").map(Number),ne=new Date;return ne.setHours(G,z+$,0,0),ne.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},M=B=>({"PreShow/End":"#8B5CF6","Podium Transition":"#FFFFFF","Panel Transition":"#FFFFFF","Sub Cue":"#F3F4F6","No Transition":"#059669",Video:"#F59E0B","Panel+Remote":"#3B82F6","Remote Only":"#60A5FA",Break:"#EC4899",TBD:"#6B7280",Podium:"#FFFFFF",Panel:"#FFFFFF"})[B]||"#D3D3D3",L=()=>{const B=S==="showfile",$=d.filter(G=>G.day===T);if(B){let G=`
        <!DOCTYPE html>
        <html>
        <head>
          <title>Run of Show Show File - ${h?.name||"Event"}</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 0; 
              padding: 15px;
              font-size: 11px;
              line-height: 1.3;
              background: white;
            }
            .header { 
              text-align: center; 
              margin-bottom: 15px; 
            }
            .header h1 { 
              font-size: 16px; 
              margin: 0; 
              color: #000;
              font-weight: bold;
            }
            .header h2 { 
              font-size: 12px; 
              margin: 3px 0 0 0; 
              color: #333; 
              font-weight: normal;
            }
            .event-info { 
              background: #f5f5f5; 
              padding: 8px; 
              margin-bottom: 12px; 
              font-size: 10px;
              border: 1px solid #ddd;
            }
            .section { 
              margin-bottom: 8px; 
              border: 1px solid #000;
              page-break-inside: avoid;
            }
            .section-header { 
              padding: 6px 8px; 
              font-weight: bold; 
              font-size: 11px;
              color: white;
              background: #366092;
              border-bottom: 1px solid #000;
            }
            .section-content { 
              padding: 0; 
              background: white;
            }
            .modal-table { 
              width: 100%;
              border-collapse: collapse;
              border: 2px solid #000;
              background: white;
            }
            .modal-table td { 
              border: 1px solid #000; 
              padding: 6px 8px; 
              background: white;
              vertical-align: top;
            }
            .modal-table .header-cell { 
              background: #d9d9d9; 
              font-weight: bold; 
              text-align: center;
              font-size: 10px;
              width: 70px;
              min-width: 70px;
            }
            .modal-table .segment-cell { 
              min-width: 180px;
              max-width: 250px;
              word-wrap: break-word;
              font-size: 11px;
            }
            .modal-table .notes-cell { 
              background: #f0f0f0; 
              min-height: 35px;
              min-width: 200px;
              font-size: 10px;
            }
            .modal-table .participants-cell { 
              background: #f0f0f0; 
              min-height: 60px;
              min-width: 250px;
            }
            .modal-table .start-time-cell { 
              background: #e7f3ff; 
              font-weight: bold;
              font-size: 12px;
            }
            .simple-table { 
              width: 100%;
              border-collapse: collapse;
              border: 1px solid #000;
              background: white;
            }
            .simple-table td { 
              border: 1px solid #000; 
              padding: 8px; 
              background: white;
              vertical-align: top;
              font-size: 11px;
            }
        .simple-table .header-cell { 
          background: #d9d9d9; 
          font-weight: bold; 
          text-align: center;
          font-size: 10px;
        }
        .stacked-header {
          width: 250px;
        }
        .stacked-cell {
          width: 250px;
          max-width: 250px;
          vertical-align: top;
          padding: 8px;
        }
        .stacked-item {
          margin-bottom: 8px;
          padding-bottom: 6px;
          border-bottom: 1px solid #e0e0e0;
          display: flex;
          flex-direction: column;
        }
        .stacked-item:last-child {
          border-bottom: none;
          margin-bottom: 0;
          padding-bottom: 0;
        }
        .stacked-label {
          font-weight: bold;
          font-size: 9px;
          color: #333;
          margin-bottom: 3px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        .stacked-value {
          font-size: 10px;
          line-height: 1.3;
          word-wrap: break-word;
          color: #000;
          padding-left: 4px;
        }
        .slot-cell {
          width: 120px;
          height: 100px;
          vertical-align: top;
        }
        .slot-container {
          height: 100px;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          padding: 4px;
        }
        .slot-name {
          font-weight: bold;
          font-size: 10px;
          line-height: 1.2;
        }
        .slot-title {
          font-size: 9px;
          line-height: 1.1;
          color: #666;
        }
        .slot-org {
          font-size: 9px;
          line-height: 1.1;
          color: #666;
        }
        .slot-photo {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        .slot-photo-img {
          width: 30px;
          height: 30px;
          object-fit: cover;
          border-radius: 3px;
          border: 1px solid #ccc;
        }
        .notes-header-row {
          background: #e0e0e0;
        }
        .notes-header-cell {
          padding: 6px 8px;
          font-size: 10px;
          font-weight: bold;
          text-align: center;
          border-top: 2px solid #ddd;
          background: #e0e0e0;
        }
        .notes-content-row {
          background: #f9f9f9;
        }
        .notes-content-cell {
          padding: 8px;
          font-size: 10px;
          line-height: 1.3;
          background: #f9f9f9;
        }
            .modal-cell .field-label { 
              font-weight: bold; 
              font-size: 11px; 
              color: #333; 
              margin-bottom: 4px;
            }
            .modal-cell .field-value { 
              font-size: 12px; 
              color: #000;
              line-height: 1.3;
            }
            .speaker-item { 
              display: flex; 
              align-items: center; 
              margin-bottom: 6px;
              padding: 6px;
              background: white;
              border: 1px solid #ddd;
              border-radius: 4px;
              box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            }
            .speaker-photo { 
              width: 40px; 
              height: 40px; 
              border-radius: 4px; 
              object-fit: cover; 
              border: 2px solid #007acc;
              margin-right: 10px;
              flex-shrink: 0;
            }
            .speaker-info { 
              flex: 1;
            }
            .speaker-badges { 
              display: flex; 
              gap: 4px;
              margin-bottom: 3px;
            }
            .speaker-name { 
              font-weight: bold; 
              font-size: 11px; 
              color: #000;
              margin-bottom: 2px;
            }
            .slot-badge { 
              background: #007acc; 
              color: white; 
              padding: 2px 6px; 
              border-radius: 6px; 
              font-size: 8px; 
              font-weight: bold;
            }
            .location-badge { 
              background: #28a745; 
              color: white; 
              padding: 2px 6px; 
              border-radius: 6px; 
              font-size: 8px; 
              font-weight: bold;
            }
            .speaker-title { 
              color: #666; 
              font-size: 10px;
              margin-bottom: 1px;
            }
            .speaker-org { 
              color: #888; 
              font-size: 9px;
            }
            .footer { 
              margin-top: 40px; 
              text-align: center; 
              color: #666; 
              font-size: 12px;
              border-top: 1px solid #ddd;
              padding-top: 20px;
            }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
              @page { 
                size: A4; 
                margin: 0.5in; 
              }
              .section { 
                page-break-inside: avoid;
              }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>RUN OF SHOW SHOW FILE</h1>
            <h2>${h?.name||"Event"}${h?.numberOfDays&&h.numberOfDays>1?` - Day ${T}`:""}</h2>
          </div>
          
      `;return $.forEach((z,ne)=>{const ae=A(ne);`${z.durationHours.toString().padStart(2,"0")}${z.durationMinutes.toString().padStart(2,"0")}${z.durationSeconds.toString().padStart(2,"0")}`,M(z.programType||"");let O=[];if(z.speakers)try{O=JSON.parse(z.speakers)}catch{O=[{fullName:z.speakers,title:"",org:"",photoLink:""}]}let Z="";z.hasPPT&&z.hasQA?Z="PPT + Q&A":z.hasPPT?Z="PPT":z.hasQA?Z="Q&A":Z="None",G+=`
          <div class="section">
            <div class="section-content">
              <table class="simple-table">
                <tr>
                  <td class="header-cell">CUE</td>
                  <td class="header-cell">START TIME</td>
                  <td class="header-cell stacked-header">SEGMENT INFO</td>
                  <td class="header-cell">SLOT 1</td>
                  <td class="header-cell">SLOT 2</td>
                  <td class="header-cell">SLOT 3</td>
                  <td class="header-cell">SLOT 4</td>
                  <td class="header-cell">SLOT 5</td>
                  <td class="header-cell">SLOT 6</td>
                  <td class="header-cell">SLOT 7</td>
                </tr>
                <tr>
                  <td>${z.customFields.cue||`CUE ${ne+1}`}</td>
                  <td>${ae}</td>
                  <td class="stacked-cell">
                    <div class="stacked-item">
                      <div class="stacked-label">SEGMENT:</div>
                      <div class="stacked-value">${z.segmentName||"Untitled Segment"}</div>
                    </div>
                    <div class="stacked-item">
                      <div class="stacked-label">SHOT:</div>
                      <div class="stacked-value">${z.shotType||"Not specified"}</div>
                    </div>
                    <div class="stacked-item">
                      <div class="stacked-label">PPT/Q&A:</div>
                      <div class="stacked-value">${Z}</div>
                    </div>
                  </td>
        `;const q=["","","","","","",""];O.length>0&&O.forEach(Y=>{const ce=Y.fullName||Y.name||"Unknown",ke=Y.title||"",De=Y.org||"",et=Y.slot||1,Fe=Y.location||"Podium",ie=Y.photoLink||"";let ue=`
              <div class="slot-container">
                <div class="slot-name">${Fe==="Podium"?"P":Fe==="Seat"?"S":"V"}${et} - ${ce}</div>
                <div class="slot-title">${ke}</div>
                <div class="slot-org">${De}</div>
                <div class="slot-photo">${ie?`<img src="${ie}" alt="${ce}" class="slot-photo-img" />`:""}</div>
              </div>
            `;const C=Math.min(et-1,6);C>=0&&C<7&&(q[C]=ue)});for(let Y=0;Y<7;Y++)G+=`<td class="slot-cell">${q[Y]||""}</td>`;G+=`
                </tr>
                <tr class="notes-header-row">
                  <td colspan="10" class="notes-header-cell">NOTES</td>
                </tr>
                <tr class="notes-content-row">
                  <td colspan="10" class="notes-content-cell">${z.notes||"None"}</td>
                </tr>
              </table>
            </div>
          </div>
        `}),G+=`
          <div class="footer">
            <p>Generated: ${new Date().toLocaleString()} | Run of Show Application</p>
          </div>
        </body>
        </html>
      `,G}else{let G=`
        <!DOCTYPE html>
        <html>
        <head>
          <title>Run of Show Report - ${h?.name||"Event"}</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 20px; 
              font-size: 14px;
            }
            .header { 
              text-align: center; 
              margin-bottom: 30px; 
            }
            .header h1 { 
              font-size: 24px; 
              margin: 0; 
            }
            .header h2 { 
              font-size: 18px; 
              margin: 5px 0 0 0; 
              color: #666; 
            }
            .event-info { 
              background: #f5f5f5; 
              padding: 15px; 
              border-radius: 5px; 
              margin-bottom: 20px; 
              font-size: 12px;
            }
            table { 
              width: 100%; 
              border-collapse: collapse; 
              margin-top: 20px; 
            }
            th, td { 
              border: 1px solid #ddd; 
              padding: 8px; 
              text-align: left; 
              font-size: 12px;
            }
            th { 
              background-color: #f2f2f2; 
              font-weight: bold; 
            }
            tr { 
              -webkit-print-color-adjust: exact !important;
              color-adjust: exact !important;
              print-color-adjust: exact !important;
            }
            .footer { 
              margin-top: 30px; 
              text-align: center; 
              color: #666; 
              font-size: 12px;
            }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
              @page { 
                size: A4; 
                margin: 0.5in; 
              }
              tr { 
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>RUN OF SHOW REPORT</h1>
            <h2>${h?.name||"Event"}${h?.numberOfDays&&h.numberOfDays>1?` - Day ${T}`:""}</h2>
            <h3>ROS CONDENSED</h3>
          </div>
          
          <div class="event-info">
            <p><strong>Event:</strong> ${h?.name||"Current Event"} | 
               <strong>Date:</strong> ${h?.date||"Not specified"} | 
               <strong>Location:</strong> ${h?.location||"Not specified"} | 
               <strong>Start Time:</strong> ${v||"Not set"} | 
               <strong>Total Items:</strong> ${d.length}</p>
          </div>
          
          <table>
            <thead>
              <tr>
                <th>CUE</th>
                <th>START</th>
                <th>DURATION</th>
                <th>SEGMENT</th>
                <th>SHOT TYPE</th>
                <th>PPT/Q&A</th>
                <th>PARTICIPANTS</th>
              </tr>
            </thead>
            <tbody>
      `;return $.forEach((z,ne)=>{const ae=A(ne),O=`${z.durationHours.toString().padStart(2,"0")}:${z.durationMinutes.toString().padStart(2,"0")}:${z.durationSeconds.toString().padStart(2,"0")}`,Z=M(z.programType||"");let q="";if(z.speakers)try{q=JSON.parse(z.speakers).map(ke=>ke.fullName||ke.name||ke).join(", ")}catch{q=z.speakers}let Y="";z.hasPPT&&z.hasQA?Y="PPT + Q&A":z.hasPPT?Y="PPT":z.hasQA?Y="Q&A":Y="",G+=`
          <tr style="background-color: ${Z};">
            <td>${z.cue||""}</td>
            <td>${ae}</td>
            <td>${O}</td>
            <td>${z.segmentName||"Untitled Segment"}</td>
            <td>${z.shotType||""}</td>
            <td>${Y}</td>
            <td>${q}</td>
          </tr>
        `}),G+=`
            </tbody>
          </table>
          
          <div class="footer">
            <p>Generated: ${new Date().toLocaleString()} | Run of Show Application</p>
          </div>
        </body>
        </html>
      `,G}},Q=()=>{const B=L(),$=window.open("","_blank");$&&($.document.write(B),$.document.close(),$.focus(),$.print())},K=()=>{const B=L(),$=new Blob([B],{type:"text/html"}),G=URL.createObjectURL($),z=document.createElement("a");z.href=G,z.download=`run-of-show-${S==="showfile"?"show-file":"condensed"}${h?.numberOfDays&&h.numberOfDays>1?`-day-${T}`:""}-${h?.name?.replace(/\s+/g,"-")||"event"}-${new Date().toISOString().split("T")[0]}.html`,document.body.appendChild(z),z.click(),document.body.removeChild(z),URL.revokeObjectURL(G)};return i.jsxs("div",{className:"min-h-screen bg-slate-900 text-white pt-16",children:[i.jsx("div",{className:"bg-slate-800 border-b border-slate-700",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex items-center justify-between h-16",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("button",{onClick:()=>r("/run-of-show",{state:{event:h}}),className:"text-slate-300 hover:text-white transition-colors mr-6",children:" Back to Run of Show"}),i.jsx("h1",{className:"text-xl font-semibold",children:"Reports and Printing"})]}),i.jsx("div",{className:"text-slate-400",children:h?.name||"Event"})]})})}),i.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:i.jsxs("div",{className:"bg-slate-800 rounded-xl p-8 shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Generate Reports"}),i.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 mb-8",children:[i.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Report Options"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Report Type"}),i.jsxs("select",{value:S,onChange:B=>_(B.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"showfile",children:"Run Of Show Show File"}),i.jsx("option",{value:"condensed",children:"ROS CONDENSED"})]})]}),h?.numberOfDays&&h.numberOfDays>1&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Select Day"}),i.jsx("select",{value:T,onChange:B=>R(parseInt(B.target.value)),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:Array.from({length:h.numberOfDays},(B,$)=>i.jsxs("option",{value:$+1,children:["Day ",$+1]},$+1))})]}),i.jsxs("div",{className:"text-slate-400 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Run Of Show Show File:"})," Section-based format with all details and speaker photos"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"ROS CONDENSED:"})," Table format with all information"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Color Coding:"})," Sections colored by program type"]})]})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-4",children:[i.jsxs("button",{onClick:Q,className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Report"]}),i.jsxs("button",{onClick:K,className:"px-6 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download Report"]})]}),i.jsxs("div",{className:"mt-8",children:[i.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Report Preview"}),i.jsx("div",{className:"bg-slate-700 rounded-lg p-4 max-h-96 overflow-y-auto",children:i.jsxs("div",{className:"text-slate-300 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Event:"})," ",h?.name||"Current Event"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Total Items:"})," ",d.length,h?.numberOfDays&&h.numberOfDays>1?` | <strong>Day ${T} Items:</strong> ${d.filter(B=>B.day===T).length}`:""]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Master Start Time:"})," ",v||"Not set"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Report Type:"})," ",S==="showfile"?"Run Of Show Show File":"ROS CONDENSED"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Format:"})," ",S==="showfile"?"Section-based with speaker photos":"Table format"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Color Coding:"})," Sections colored by program type"]})]})})]})]})})]})};function Jv(){const r=br().pathname==="/fullscreen-timer";return i.jsx("div",{className:"App",children:i.jsxs(Mv,{children:[!r&&i.jsx(mu,{})," ",i.jsxs(Xp,{children:[i.jsx(So,{path:"/",element:i.jsx(Uv,{})}),i.jsx(So,{path:"/run-of-show",element:i.jsx(Wv,{})}),i.jsx(So,{path:"/fullscreen-timer",element:i.jsx(Hv,{})}),i.jsx(So,{path:"/graphics-links",element:i.jsx(qv,{})}),i.jsx(So,{path:"/reports",element:i.jsx(Kv,{})})]})]})})}function Gv(){return i.jsx(Av,{children:i.jsx(bg,{children:i.jsx(Jv,{})})})}const Qv=lp.createRoot(document.getElementById("root"));Qv.render(i.jsx(Ja.StrictMode,{children:i.jsx(Gv,{})}));
