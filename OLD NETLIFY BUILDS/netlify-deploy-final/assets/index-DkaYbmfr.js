(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();function ah(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function wy(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var r=t.default;if(typeof r=="function"){var e=function n(){var s=!1;try{s=this instanceof n}catch{}return s?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};e.prototype=r.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),e}var cf={exports:{}},Hl={},uf={exports:{}},Ct={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kg;function by(){if(kg)return Ct;kg=1;var t=Symbol.for("react.element"),r=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function w(A){return A===null||typeof A!="object"?null:(A=v&&A[v]||A["@@iterator"],typeof A=="function"?A:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,b={};function y(A,N,B){this.props=A,this.context=N,this.refs=b,this.updater=B||_}y.prototype.isReactComponent={},y.prototype.setState=function(A,N){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,N,"setState")},y.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function L(){}L.prototype=y.prototype;function G(A,N,B){this.props=A,this.context=N,this.refs=b,this.updater=B||_}var j=G.prototype=new L;j.constructor=G,k(j,y.prototype),j.isPureReactComponent=!0;var F=Array.isArray,ue=Object.prototype.hasOwnProperty,D={current:null},V={key:!0,ref:!0,__self:!0,__source:!0};function ee(A,N,B){var q,ne={},pe=null,te=null;if(N!=null)for(q in N.ref!==void 0&&(te=N.ref),N.key!==void 0&&(pe=""+N.key),N)ue.call(N,q)&&!V.hasOwnProperty(q)&&(ne[q]=N[q]);var fe=arguments.length-2;if(fe===1)ne.children=B;else if(1<fe){for(var I=Array(fe),le=0;le<fe;le++)I[le]=arguments[le+2];ne.children=I}if(A&&A.defaultProps)for(q in fe=A.defaultProps,fe)ne[q]===void 0&&(ne[q]=fe[q]);return{$$typeof:t,type:A,key:pe,ref:te,props:ne,_owner:D.current}}function T(A,N){return{$$typeof:t,type:A.type,key:N,ref:A.ref,props:A.props,_owner:A._owner}}function O(A){return typeof A=="object"&&A!==null&&A.$$typeof===t}function H(A){var N={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(B){return N[B]})}var U=/\/+/g;function X(A,N){return typeof A=="object"&&A!==null&&A.key!=null?H(""+A.key):N.toString(36)}function ve(A,N,B,q,ne){var pe=typeof A;(pe==="undefined"||pe==="boolean")&&(A=null);var te=!1;if(A===null)te=!0;else switch(pe){case"string":case"number":te=!0;break;case"object":switch(A.$$typeof){case t:case r:te=!0}}if(te)return te=A,ne=ne(te),A=q===""?"."+X(te,0):q,F(ne)?(B="",A!=null&&(B=A.replace(U,"$&/")+"/"),ve(ne,N,B,"",function(le){return le})):ne!=null&&(O(ne)&&(ne=T(ne,B+(!ne.key||te&&te.key===ne.key?"":(""+ne.key).replace(U,"$&/")+"/")+A)),N.push(ne)),1;if(te=0,q=q===""?".":q+":",F(A))for(var fe=0;fe<A.length;fe++){pe=A[fe];var I=q+X(pe,fe);te+=ve(pe,N,B,I,ne)}else if(I=w(A),typeof I=="function")for(A=I.call(A),fe=0;!(pe=A.next()).done;)pe=pe.value,I=q+X(pe,fe++),te+=ve(pe,N,B,I,ne);else if(pe==="object")throw N=String(A),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.");return te}function we(A,N,B){if(A==null)return A;var q=[],ne=0;return ve(A,q,"","",function(pe){return N.call(B,pe,ne++)}),q}function Ne(A){if(A._status===-1){var N=A._result;N=N(),N.then(function(B){(A._status===0||A._status===-1)&&(A._status=1,A._result=B)},function(B){(A._status===0||A._status===-1)&&(A._status=2,A._result=B)}),A._status===-1&&(A._status=0,A._result=N)}if(A._status===1)return A._result.default;throw A._result}var he={current:null},ae={transition:null},K={ReactCurrentDispatcher:he,ReactCurrentBatchConfig:ae,ReactCurrentOwner:D};function oe(){throw Error("act(...) is not supported in production builds of React.")}return Ct.Children={map:we,forEach:function(A,N,B){we(A,function(){N.apply(this,arguments)},B)},count:function(A){var N=0;return we(A,function(){N++}),N},toArray:function(A){return we(A,function(N){return N})||[]},only:function(A){if(!O(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},Ct.Component=y,Ct.Fragment=e,Ct.Profiler=s,Ct.PureComponent=G,Ct.StrictMode=n,Ct.Suspense=f,Ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K,Ct.act=oe,Ct.cloneElement=function(A,N,B){if(A==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+A+".");var q=k({},A.props),ne=A.key,pe=A.ref,te=A._owner;if(N!=null){if(N.ref!==void 0&&(pe=N.ref,te=D.current),N.key!==void 0&&(ne=""+N.key),A.type&&A.type.defaultProps)var fe=A.type.defaultProps;for(I in N)ue.call(N,I)&&!V.hasOwnProperty(I)&&(q[I]=N[I]===void 0&&fe!==void 0?fe[I]:N[I])}var I=arguments.length-2;if(I===1)q.children=B;else if(1<I){fe=Array(I);for(var le=0;le<I;le++)fe[le]=arguments[le+2];q.children=fe}return{$$typeof:t,type:A.type,key:ne,ref:pe,props:q,_owner:te}},Ct.createContext=function(A){return A={$$typeof:l,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},A.Provider={$$typeof:o,_context:A},A.Consumer=A},Ct.createElement=ee,Ct.createFactory=function(A){var N=ee.bind(null,A);return N.type=A,N},Ct.createRef=function(){return{current:null}},Ct.forwardRef=function(A){return{$$typeof:u,render:A}},Ct.isValidElement=O,Ct.lazy=function(A){return{$$typeof:p,_payload:{_status:-1,_result:A},_init:Ne}},Ct.memo=function(A,N){return{$$typeof:m,type:A,compare:N===void 0?null:N}},Ct.startTransition=function(A){var N=ae.transition;ae.transition={};try{A()}finally{ae.transition=N}},Ct.unstable_act=oe,Ct.useCallback=function(A,N){return he.current.useCallback(A,N)},Ct.useContext=function(A){return he.current.useContext(A)},Ct.useDebugValue=function(){},Ct.useDeferredValue=function(A){return he.current.useDeferredValue(A)},Ct.useEffect=function(A,N){return he.current.useEffect(A,N)},Ct.useId=function(){return he.current.useId()},Ct.useImperativeHandle=function(A,N,B){return he.current.useImperativeHandle(A,N,B)},Ct.useInsertionEffect=function(A,N){return he.current.useInsertionEffect(A,N)},Ct.useLayoutEffect=function(A,N){return he.current.useLayoutEffect(A,N)},Ct.useMemo=function(A,N){return he.current.useMemo(A,N)},Ct.useReducer=function(A,N,B){return he.current.useReducer(A,N,B)},Ct.useRef=function(A){return he.current.useRef(A)},Ct.useState=function(A){return he.current.useState(A)},Ct.useSyncExternalStore=function(A,N,B){return he.current.useSyncExternalStore(A,N,B)},Ct.useTransition=function(){return he.current.useTransition()},Ct.version="18.3.1",Ct}var Tg;function ih(){return Tg||(Tg=1,uf.exports=by()),uf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ng;function _y(){if(Ng)return Hl;Ng=1;var t=ih(),r=Symbol.for("react.element"),e=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(u,f,m){var p,v={},w=null,_=null;m!==void 0&&(w=""+m),f.key!==void 0&&(w=""+f.key),f.ref!==void 0&&(_=f.ref);for(p in f)n.call(f,p)&&!o.hasOwnProperty(p)&&(v[p]=f[p]);if(u&&u.defaultProps)for(p in f=u.defaultProps,f)v[p]===void 0&&(v[p]=f[p]);return{$$typeof:r,type:u,key:w,ref:_,props:v,_owner:s.current}}return Hl.Fragment=e,Hl.jsx=l,Hl.jsxs=l,Hl}var Cg;function Sy(){return Cg||(Cg=1,cf.exports=_y()),cf.exports}var c=Sy(),R=ih();const ad=ah(R);var $u={},df={exports:{}},jn={},ff={exports:{}},hf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jg;function Ey(){return jg||(jg=1,(function(t){function r(ae,K){var oe=ae.length;ae.push(K);e:for(;0<oe;){var A=oe-1>>>1,N=ae[A];if(0<s(N,K))ae[A]=K,ae[oe]=N,oe=A;else break e}}function e(ae){return ae.length===0?null:ae[0]}function n(ae){if(ae.length===0)return null;var K=ae[0],oe=ae.pop();if(oe!==K){ae[0]=oe;e:for(var A=0,N=ae.length,B=N>>>1;A<B;){var q=2*(A+1)-1,ne=ae[q],pe=q+1,te=ae[pe];if(0>s(ne,oe))pe<N&&0>s(te,ne)?(ae[A]=te,ae[pe]=oe,A=pe):(ae[A]=ne,ae[q]=oe,A=q);else if(pe<N&&0>s(te,oe))ae[A]=te,ae[pe]=oe,A=pe;else break e}}return K}function s(ae,K){var oe=ae.sortIndex-K.sortIndex;return oe!==0?oe:ae.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var f=[],m=[],p=1,v=null,w=3,_=!1,k=!1,b=!1,y=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(ae){for(var K=e(m);K!==null;){if(K.callback===null)n(m);else if(K.startTime<=ae)n(m),K.sortIndex=K.expirationTime,r(f,K);else break;K=e(m)}}function F(ae){if(b=!1,j(ae),!k)if(e(f)!==null)k=!0,Ne(ue);else{var K=e(m);K!==null&&he(F,K.startTime-ae)}}function ue(ae,K){k=!1,b&&(b=!1,L(ee),ee=-1),_=!0;var oe=w;try{for(j(K),v=e(f);v!==null&&(!(v.expirationTime>K)||ae&&!H());){var A=v.callback;if(typeof A=="function"){v.callback=null,w=v.priorityLevel;var N=A(v.expirationTime<=K);K=t.unstable_now(),typeof N=="function"?v.callback=N:v===e(f)&&n(f),j(K)}else n(f);v=e(f)}if(v!==null)var B=!0;else{var q=e(m);q!==null&&he(F,q.startTime-K),B=!1}return B}finally{v=null,w=oe,_=!1}}var D=!1,V=null,ee=-1,T=5,O=-1;function H(){return!(t.unstable_now()-O<T)}function U(){if(V!==null){var ae=t.unstable_now();O=ae;var K=!0;try{K=V(!0,ae)}finally{K?X():(D=!1,V=null)}}else D=!1}var X;if(typeof G=="function")X=function(){G(U)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,we=ve.port2;ve.port1.onmessage=U,X=function(){we.postMessage(null)}}else X=function(){y(U,0)};function Ne(ae){V=ae,D||(D=!0,X())}function he(ae,K){ee=y(function(){ae(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ae){ae.callback=null},t.unstable_continueExecution=function(){k||_||(k=!0,Ne(ue))},t.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<ae?Math.floor(1e3/ae):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_getFirstCallbackNode=function(){return e(f)},t.unstable_next=function(ae){switch(w){case 1:case 2:case 3:var K=3;break;default:K=w}var oe=w;w=K;try{return ae()}finally{w=oe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ae,K){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var oe=w;w=ae;try{return K()}finally{w=oe}},t.unstable_scheduleCallback=function(ae,K,oe){var A=t.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?A+oe:A):oe=A,ae){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=oe+N,ae={id:p++,callback:K,priorityLevel:ae,startTime:oe,expirationTime:N,sortIndex:-1},oe>A?(ae.sortIndex=oe,r(m,ae),e(f)===null&&ae===e(m)&&(b?(L(ee),ee=-1):b=!0,he(F,oe-A))):(ae.sortIndex=N,r(f,ae),k||_||(k=!0,Ne(ue))),ae},t.unstable_shouldYield=H,t.unstable_wrapCallback=function(ae){var K=w;return function(){var oe=w;w=K;try{return ae.apply(this,arguments)}finally{w=oe}}}})(hf)),hf}var Ag;function ky(){return Ag||(Ag=1,ff.exports=Ey()),ff.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rg;function Ty(){if(Rg)return jn;Rg=1;var t=ih(),r=ky();function e(a){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)i+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function o(a,i){l(a,i),l(a+"Capture",i)}function l(a,i){for(s[a]=i,a=0;a<i.length;a++)n.add(i[a])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},v={};function w(a){return f.call(v,a)?!0:f.call(p,a)?!1:m.test(a)?v[a]=!0:(p[a]=!0,!1)}function _(a,i,d,g){if(d!==null&&d.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return g?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function k(a,i,d,g){if(i===null||typeof i>"u"||_(a,i,d,g))return!0;if(g)return!1;if(d!==null)switch(d.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function b(a,i,d,g,x,S,M){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=g,this.attributeNamespace=x,this.mustUseProperty=d,this.propertyName=a,this.type=i,this.sanitizeURL=S,this.removeEmptyString=M}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){y[a]=new b(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var i=a[0];y[i]=new b(i,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){y[a]=new b(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){y[a]=new b(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){y[a]=new b(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){y[a]=new b(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){y[a]=new b(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){y[a]=new b(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){y[a]=new b(a,5,!1,a.toLowerCase(),null,!1,!1)});var L=/[\-:]([a-z])/g;function G(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var i=a.replace(L,G);y[i]=new b(i,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var i=a.replace(L,G);y[i]=new b(i,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var i=a.replace(L,G);y[i]=new b(i,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){y[a]=new b(a,1,!1,a.toLowerCase(),null,!1,!1)}),y.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){y[a]=new b(a,1,!1,a.toLowerCase(),null,!0,!0)});function j(a,i,d,g){var x=y.hasOwnProperty(i)?y[i]:null;(x!==null?x.type!==0:g||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(k(i,d,x,g)&&(d=null),g||x===null?w(i)&&(d===null?a.removeAttribute(i):a.setAttribute(i,""+d)):x.mustUseProperty?a[x.propertyName]=d===null?x.type===3?!1:"":d:(i=x.attributeName,g=x.attributeNamespace,d===null?a.removeAttribute(i):(x=x.type,d=x===3||x===4&&d===!0?"":""+d,g?a.setAttributeNS(g,i,d):a.setAttribute(i,d))))}var F=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ue=Symbol.for("react.element"),D=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),ee=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),H=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),X=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),we=Symbol.for("react.memo"),Ne=Symbol.for("react.lazy"),he=Symbol.for("react.offscreen"),ae=Symbol.iterator;function K(a){return a===null||typeof a!="object"?null:(a=ae&&a[ae]||a["@@iterator"],typeof a=="function"?a:null)}var oe=Object.assign,A;function N(a){if(A===void 0)try{throw Error()}catch(d){var i=d.stack.trim().match(/\n( *(at )?)/);A=i&&i[1]||""}return`
`+A+a}var B=!1;function q(a,i){if(!a||B)return"";B=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(je){var g=je}Reflect.construct(a,[],i)}else{try{i.call()}catch(je){g=je}a.call(i.prototype)}else{try{throw Error()}catch(je){g=je}a()}}catch(je){if(je&&g&&typeof je.stack=="string"){for(var x=je.stack.split(`
`),S=g.stack.split(`
`),M=x.length-1,de=S.length-1;1<=M&&0<=de&&x[M]!==S[de];)de--;for(;1<=M&&0<=de;M--,de--)if(x[M]!==S[de]){if(M!==1||de!==1)do if(M--,de--,0>de||x[M]!==S[de]){var ge=`
`+x[M].replace(" at new "," at ");return a.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",a.displayName)),ge}while(1<=M&&0<=de);break}}}finally{B=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?N(a):""}function ne(a){switch(a.tag){case 5:return N(a.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return a=q(a.type,!1),a;case 11:return a=q(a.type.render,!1),a;case 1:return a=q(a.type,!0),a;default:return""}}function pe(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case V:return"Fragment";case D:return"Portal";case T:return"Profiler";case ee:return"StrictMode";case X:return"Suspense";case ve:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case H:return(a.displayName||"Context")+".Consumer";case O:return(a._context.displayName||"Context")+".Provider";case U:var i=a.render;return a=a.displayName,a||(a=i.displayName||i.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case we:return i=a.displayName||null,i!==null?i:pe(a.type)||"Memo";case Ne:i=a._payload,a=a._init;try{return pe(a(i))}catch{}}return null}function te(a){var i=a.type;switch(a.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=i.render,a=a.displayName||a.name||"",i.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pe(i);case 8:return i===ee?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function fe(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function I(a){var i=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function le(a){var i=I(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,i),g=""+a[i];if(!a.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var x=d.get,S=d.set;return Object.defineProperty(a,i,{configurable:!0,get:function(){return x.call(this)},set:function(M){g=""+M,S.call(this,M)}}),Object.defineProperty(a,i,{enumerable:d.enumerable}),{getValue:function(){return g},setValue:function(M){g=""+M},stopTracking:function(){a._valueTracker=null,delete a[i]}}}}function se(a){a._valueTracker||(a._valueTracker=le(a))}function z(a){if(!a)return!1;var i=a._valueTracker;if(!i)return!0;var d=i.getValue(),g="";return a&&(g=I(a)?a.checked?"true":"false":a.value),a=g,a!==d?(i.setValue(a),!0):!1}function Ie(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Fe(a,i){var d=i.checked;return oe({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function Ye(a,i){var d=i.defaultValue==null?"":i.defaultValue,g=i.checked!=null?i.checked:i.defaultChecked;d=fe(i.value!=null?i.value:d),a._wrapperState={initialChecked:g,initialValue:d,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function tt(a,i){i=i.checked,i!=null&&j(a,"checked",i,!1)}function Ve(a,i){tt(a,i);var d=fe(i.value),g=i.type;if(d!=null)g==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(g==="submit"||g==="reset"){a.removeAttribute("value");return}i.hasOwnProperty("value")?Le(a,i.type,d):i.hasOwnProperty("defaultValue")&&Le(a,i.type,fe(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(a.defaultChecked=!!i.defaultChecked)}function Ee(a,i,d){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var g=i.type;if(!(g!=="submit"&&g!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+a._wrapperState.initialValue,d||i===a.value||(a.value=i),a.defaultValue=i}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function Le(a,i,d){(i!=="number"||Ie(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var Me=Array.isArray;function rt(a,i,d,g){if(a=a.options,i){i={};for(var x=0;x<d.length;x++)i["$"+d[x]]=!0;for(d=0;d<a.length;d++)x=i.hasOwnProperty("$"+a[d].value),a[d].selected!==x&&(a[d].selected=x),x&&g&&(a[d].defaultSelected=!0)}else{for(d=""+fe(d),i=null,x=0;x<a.length;x++){if(a[x].value===d){a[x].selected=!0,g&&(a[x].defaultSelected=!0);return}i!==null||a[x].disabled||(i=a[x])}i!==null&&(i.selected=!0)}}function Nt(a,i){if(i.dangerouslySetInnerHTML!=null)throw Error(e(91));return oe({},i,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function wt(a,i){var d=i.value;if(d==null){if(d=i.children,i=i.defaultValue,d!=null){if(i!=null)throw Error(e(92));if(Me(d)){if(1<d.length)throw Error(e(93));d=d[0]}i=d}i==null&&(i=""),d=i}a._wrapperState={initialValue:fe(d)}}function ft(a,i){var d=fe(i.value),g=fe(i.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),i.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),g!=null&&(a.defaultValue=""+g)}function Wt(a){var i=a.textContent;i===a._wrapperState.initialValue&&i!==""&&i!==null&&(a.value=i)}function Dt(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ft(a,i){return a==null||a==="http://www.w3.org/1999/xhtml"?Dt(i):a==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var xt,Et=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,d,g,x){MSApp.execUnsafeLocalFunction(function(){return a(i,d,g,x)})}:a})(function(a,i){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=i;else{for(xt=xt||document.createElement("div"),xt.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=xt.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;i.firstChild;)a.appendChild(i.firstChild)}});function Ze(a,i){if(i){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=i;return}}a.textContent=i}var bt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ur=["Webkit","ms","Moz","O"];Object.keys(bt).forEach(function(a){ur.forEach(function(i){i=i+a.charAt(0).toUpperCase()+a.substring(1),bt[i]=bt[a]})});function kt(a,i,d){return i==null||typeof i=="boolean"||i===""?"":d||typeof i!="number"||i===0||bt.hasOwnProperty(a)&&bt[a]?(""+i).trim():i+"px"}function dr(a,i){a=a.style;for(var d in i)if(i.hasOwnProperty(d)){var g=d.indexOf("--")===0,x=kt(d,i[d],g);d==="float"&&(d="cssFloat"),g?a.setProperty(d,x):a[d]=x}}var $r=oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Es(a,i){if(i){if($r[a]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(e(137,a));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(e(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(e(61))}if(i.style!=null&&typeof i.style!="object")throw Error(e(62))}}function wr(a,i){if(a.indexOf("-")===-1)return typeof i.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ur=null;function dt(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var ln=null,wn=null,Rn=null;function At(a){if(a=jl(a)){if(typeof ln!="function")throw Error(e(280));var i=a.stateNode;i&&(i=eu(i),ln(a.stateNode,a.type,i))}}function cn(a){wn?Rn?Rn.push(a):Rn=[a]:wn=a}function si(){if(wn){var a=wn,i=Rn;if(Rn=wn=null,At(a),i)for(a=0;a<i.length;a++)At(i[a])}}function bn(a,i){return a(i)}function Mt(){}var _n=!1;function Ws(a,i,d){if(_n)return a(i,d);_n=!0;try{return bn(a,i,d)}finally{_n=!1,(wn!==null||Rn!==null)&&(Mt(),si())}}function ks(a,i){var d=a.stateNode;if(d===null)return null;var g=eu(d);if(g===null)return null;d=g[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(a=a.type,g=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!g;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(e(231,i,typeof d));return d}var xa=!1;if(u)try{var is={};Object.defineProperty(is,"passive",{get:function(){xa=!0}}),window.addEventListener("test",is,is),window.removeEventListener("test",is,is)}catch{xa=!1}function Ac(a,i,d,g,x,S,M,de,ge){var je=Array.prototype.slice.call(arguments,3);try{i.apply(d,je)}catch(Be){this.onError(Be)}}var Vn=!1,ai=null,W=!1,J=null,Z={onError:function(a){Vn=!0,ai=a}};function Y(a,i,d,g,x,S,M,de,ge){Vn=!1,ai=null,Ac.apply(Z,arguments)}function re(a,i,d,g,x,S,M,de,ge){if(Y.apply(this,arguments),Vn){if(Vn){var je=ai;Vn=!1,ai=null}else throw Error(e(198));W||(W=!0,J=je)}}function ie(a){var i=a,d=a;if(a.alternate)for(;i.return;)i=i.return;else{a=i;do i=a,(i.flags&4098)!==0&&(d=i.return),a=i.return;while(a)}return i.tag===3?d:null}function ye(a){if(a.tag===13){var i=a.memoizedState;if(i===null&&(a=a.alternate,a!==null&&(i=a.memoizedState)),i!==null)return i.dehydrated}return null}function Re(a){if(ie(a)!==a)throw Error(e(188))}function _e(a){var i=a.alternate;if(!i){if(i=ie(a),i===null)throw Error(e(188));return i!==a?null:a}for(var d=a,g=i;;){var x=d.return;if(x===null)break;var S=x.alternate;if(S===null){if(g=x.return,g!==null){d=g;continue}break}if(x.child===S.child){for(S=x.child;S;){if(S===d)return Re(x),a;if(S===g)return Re(x),i;S=S.sibling}throw Error(e(188))}if(d.return!==g.return)d=x,g=S;else{for(var M=!1,de=x.child;de;){if(de===d){M=!0,d=x,g=S;break}if(de===g){M=!0,g=x,d=S;break}de=de.sibling}if(!M){for(de=S.child;de;){if(de===d){M=!0,d=S,g=x;break}if(de===g){M=!0,g=S,d=x;break}de=de.sibling}if(!M)throw Error(e(189))}}if(d.alternate!==g)throw Error(e(190))}if(d.tag!==3)throw Error(e(188));return d.stateNode.current===d?a:i}function ke(a){return a=_e(a),a!==null?Te(a):null}function Te(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var i=Te(a);if(i!==null)return i;a=a.sibling}return null}var He=r.unstable_scheduleCallback,Ke=r.unstable_cancelCallback,Qe=r.unstable_shouldYield,$e=r.unstable_requestPaint,Pe=r.unstable_now,mt=r.unstable_getCurrentPriorityLevel,Bt=r.unstable_ImmediatePriority,Gt=r.unstable_UserBlockingPriority,tr=r.unstable_NormalPriority,Wn=r.unstable_LowPriority,Kr=r.unstable_IdlePriority,un=null,fr=null;function va(a){if(fr&&typeof fr.onCommitFiberRoot=="function")try{fr.onCommitFiberRoot(un,a,void 0,(a.current.flags&128)===128)}catch{}}var rr=Math.clz32?Math.clz32:Rc,sl=Math.log,jd=Math.LN2;function Rc(a){return a>>>=0,a===0?32:31-(sl(a)/jd|0)|0}var qi=64,ii=4194304;function Ts(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ya(a,i){var d=a.pendingLanes;if(d===0)return 0;var g=0,x=a.suspendedLanes,S=a.pingedLanes,M=d&268435455;if(M!==0){var de=M&~x;de!==0?g=Ts(de):(S&=M,S!==0&&(g=Ts(S)))}else M=d&~x,M!==0?g=Ts(M):S!==0&&(g=Ts(S));if(g===0)return 0;if(i!==0&&i!==g&&(i&x)===0&&(x=g&-g,S=i&-i,x>=S||x===16&&(S&4194240)!==0))return i;if((g&4)!==0&&(g|=d&16),i=a.entangledLanes,i!==0)for(a=a.entanglements,i&=g;0<i;)d=31-rr(i),x=1<<d,g|=a[d],i&=~x;return g}function Ad(a,i){switch(a){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ic(a,i){for(var d=a.suspendedLanes,g=a.pingedLanes,x=a.expirationTimes,S=a.pendingLanes;0<S;){var M=31-rr(S),de=1<<M,ge=x[M];ge===-1?((de&d)===0||(de&g)!==0)&&(x[M]=Ad(de,i)):ge<=i&&(a.expiredLanes|=de),S&=~de}}function Ji(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function al(){var a=qi;return qi<<=1,(qi&4194240)===0&&(qi=64),a}function Oc(a){for(var i=[],d=0;31>d;d++)i.push(a);return i}function Hs(a,i,d){a.pendingLanes|=i,i!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,i=31-rr(i),a[i]=d}function Rd(a,i){var d=a.pendingLanes&~i;a.pendingLanes=i,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=i,a.mutableReadLanes&=i,a.entangledLanes&=i,i=a.entanglements;var g=a.eventTimes;for(a=a.expirationTimes;0<d;){var x=31-rr(d),S=1<<x;i[x]=0,g[x]=-1,a[x]=-1,d&=~S}}function wa(a,i){var d=a.entangledLanes|=i;for(a=a.entanglements;d;){var g=31-rr(d),x=1<<g;x&i|a[g]&i&&(a[g]|=i),d&=~x}}var Tt=0;function il(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Ns,ol,Yi,Dc,pt,Xr=!1,zs=[],Hn=null,vt=null,Cs=null,js=new Map,oi=new Map,gr=[],Fc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ll(a,i){switch(a){case"focusin":case"focusout":Hn=null;break;case"dragenter":case"dragleave":vt=null;break;case"mouseover":case"mouseout":Cs=null;break;case"pointerover":case"pointerout":js.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":oi.delete(i.pointerId)}}function In(a,i,d,g,x,S){return a===null||a.nativeEvent!==S?(a={blockedOn:i,domEventName:d,eventSystemFlags:g,nativeEvent:S,targetContainers:[x]},i!==null&&(i=jl(i),i!==null&&ol(i)),a):(a.eventSystemFlags|=g,i=a.targetContainers,x!==null&&i.indexOf(x)===-1&&i.push(x),a)}function zn(a,i,d,g,x){switch(i){case"focusin":return Hn=In(Hn,a,i,d,g,x),!0;case"dragenter":return vt=In(vt,a,i,d,g,x),!0;case"mouseover":return Cs=In(Cs,a,i,d,g,x),!0;case"pointerover":var S=x.pointerId;return js.set(S,In(js.get(S)||null,a,i,d,g,x)),!0;case"gotpointercapture":return S=x.pointerId,oi.set(S,In(oi.get(S)||null,a,i,d,g,x)),!0}return!1}function cl(a){var i=xi(a.target);if(i!==null){var d=ie(i);if(d!==null){if(i=d.tag,i===13){if(i=ye(d),i!==null){a.blockedOn=i,pt(a.priority,function(){Yi(d)});return}}else if(i===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function os(a){if(a.blockedOn!==null)return!1;for(var i=a.targetContainers;0<i.length;){var d=Gn(a.domEventName,a.eventSystemFlags,i[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var g=new d.constructor(d.type,d);Ur=g,d.target.dispatchEvent(g),Ur=null}else return i=jl(d),i!==null&&ol(i),a.blockedOn=d,!1;i.shift()}return!0}function ul(a,i,d){os(a)&&d.delete(i)}function li(){Xr=!1,Hn!==null&&os(Hn)&&(Hn=null),vt!==null&&os(vt)&&(vt=null),Cs!==null&&os(Cs)&&(Cs=null),js.forEach(ul),oi.forEach(ul)}function ci(a,i){a.blockedOn===i&&(a.blockedOn=null,Xr||(Xr=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,li)))}function ba(a){function i(x){return ci(x,a)}if(0<zs.length){ci(zs[0],a);for(var d=1;d<zs.length;d++){var g=zs[d];g.blockedOn===a&&(g.blockedOn=null)}}for(Hn!==null&&ci(Hn,a),vt!==null&&ci(vt,a),Cs!==null&&ci(Cs,a),js.forEach(i),oi.forEach(i),d=0;d<gr.length;d++)g=gr[d],g.blockedOn===a&&(g.blockedOn=null);for(;0<gr.length&&(d=gr[0],d.blockedOn===null);)cl(d),d.blockedOn===null&&gr.shift()}var _a=F.ReactCurrentBatchConfig,ls=!0;function Sa(a,i,d,g){var x=Tt,S=_a.transition;_a.transition=null;try{Tt=1,Ea(a,i,d,g)}finally{Tt=x,_a.transition=S}}function Id(a,i,d,g){var x=Tt,S=_a.transition;_a.transition=null;try{Tt=4,Ea(a,i,d,g)}finally{Tt=x,_a.transition=S}}function Ea(a,i,d,g){if(ls){var x=Gn(a,i,d,g);if(x===null)zt(a,i,g,Qi,d),ll(a,g);else if(zn(x,a,i,d,g))g.stopPropagation();else if(ll(a,g),i&4&&-1<Fc.indexOf(a)){for(;x!==null;){var S=jl(x);if(S!==null&&Ns(S),S=Gn(a,i,d,g),S===null&&zt(a,i,g,Qi,d),S===x)break;x=S}x!==null&&g.stopPropagation()}else zt(a,i,g,null,d)}}var Qi=null;function Gn(a,i,d,g){if(Qi=null,a=dt(g),a=xi(a),a!==null)if(i=ie(a),i===null)a=null;else if(d=i.tag,d===13){if(a=ye(i),a!==null)return a;a=null}else if(d===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;a=null}else i!==a&&(a=null);return Qi=a,null}function Zi(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mt()){case Bt:return 1;case Gt:return 4;case tr:case Wn:return 16;case Kr:return 536870912;default:return 16}default:return 16}}var On=null,dl=null,eo=null;function fl(){if(eo)return eo;var a,i=dl,d=i.length,g,x="value"in On?On.value:On.textContent,S=x.length;for(a=0;a<d&&i[a]===x[a];a++);var M=d-a;for(g=1;g<=M&&i[d-g]===x[S-g];g++);return eo=x.slice(a,1<g?1-g:void 0)}function Gs(a){var i=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&i===13&&(a=13)):a=i,a===10&&(a=13),32<=a||a===13?a:0}function cs(){return!0}function Ks(){return!1}function Rr(a){function i(d,g,x,S,M){this._reactName=d,this._targetInst=x,this.type=g,this.nativeEvent=S,this.target=M,this.currentTarget=null;for(var de in a)a.hasOwnProperty(de)&&(d=a[de],this[de]=d?d(S):S[de]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?cs:Ks,this.isPropagationStopped=Ks,this}return oe(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=cs)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=cs)},persist:function(){},isPersistent:cs}),i}var ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ta=Rr(ka),ui=oe({},ka,{view:0,detail:0}),to=Rr(ui),As,Xt,br,Xs=oe({},ui,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fi,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==br&&(br&&a.type==="mousemove"?(As=a.screenX-br.screenX,Xt=a.screenY-br.screenY):Xt=As=0,br=a),As)},movementY:function(a){return"movementY"in a?a.movementY:Xt}}),hl=Rr(Xs),Br=oe({},Xs,{dataTransfer:0}),Od=Rr(Br),ml=oe({},ui,{relatedTarget:0}),di=Rr(ml),Dd=oe({},ka,{animationName:0,elapsedTime:0,pseudoElement:0}),Pc=Rr(Dd),Fd=oe({},ka,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Pd=Rr(Fd),ro=oe({},ka,{data:0}),Lc=Rr(ro),Ld={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Md={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$d={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function no(a){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(a):(a=$d[a])?!!i[a]:!1}function fi(){return no}var gl=oe({},ui,{key:function(a){if(a.key){var i=Ld[a.key]||a.key;if(i!=="Unidentified")return i}return a.type==="keypress"?(a=Gs(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Md[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fi,charCode:function(a){return a.type==="keypress"?Gs(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Gs(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Ud=Rr(gl),Bd=oe({},Xs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$t=Rr(Bd),_r=oe({},ui,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fi}),Mc=Rr(_r),so=oe({},ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),Sn=Rr(so),$c=oe({},Xs,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Vd=Rr($c),Ht=[9,13,27,32],pl=u&&"CompositionEvent"in window,hi=null;u&&"documentMode"in document&&(hi=document.documentMode);var Wd=u&&"TextEvent"in window&&!hi,xl=u&&(!pl||hi&&8<hi&&11>=hi),vl=" ",Uc=!1;function qs(a,i){switch(a){case"keyup":return Ht.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bc(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Na=!1;function Hd(a,i){switch(a){case"compositionend":return Bc(i);case"keypress":return i.which!==32?null:(Uc=!0,vl);case"textInput":return a=i.data,a===vl&&Uc?null:a;default:return null}}function Js(a,i){if(Na)return a==="compositionend"||!pl&&qs(a,i)?(a=fl(),eo=dl=On=null,Na=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return xl&&i.locale!=="ko"?null:i.data;default:return null}}var zd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vc(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i==="input"?!!zd[a.type]:i==="textarea"}function yl(a,i,d,g){cn(g),i=dn(i,"onChange"),0<i.length&&(d=new Ta("onChange","change",null,d,g),a.push({event:d,listeners:i}))}var Ys=null,Ca=null;function Gd(a){Xe(a,0)}function ao(a){var i=mo(a);if(z(i))return a}function mi(a,i){if(a==="change")return i}var Wc=!1;if(u){var wl;if(u){var bl="oninput"in document;if(!bl){var Hc=document.createElement("div");Hc.setAttribute("oninput","return;"),bl=typeof Hc.oninput=="function"}wl=bl}else wl=!1;Wc=wl&&(!document.documentMode||9<document.documentMode)}function gi(){Ys&&(Ys.detachEvent("onpropertychange",zc),Ca=Ys=null)}function zc(a){if(a.propertyName==="value"&&ao(Ca)){var i=[];yl(i,Ca,a,dt(a)),Ws(Gd,i)}}function Kd(a,i,d){a==="focusin"?(gi(),Ys=i,Ca=d,Ys.attachEvent("onpropertychange",zc)):a==="focusout"&&gi()}function Xd(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return ao(Ca)}function qd(a,i){if(a==="click")return ao(i)}function Kn(a,i){if(a==="input"||a==="change")return ao(i)}function Jd(a,i){return a===i&&(a!==0||1/a===1/i)||a!==a&&i!==i}var Dn=typeof Object.is=="function"?Object.is:Jd;function ja(a,i){if(Dn(a,i))return!0;if(typeof a!="object"||a===null||typeof i!="object"||i===null)return!1;var d=Object.keys(a),g=Object.keys(i);if(d.length!==g.length)return!1;for(g=0;g<d.length;g++){var x=d[g];if(!f.call(i,x)||!Dn(a[x],i[x]))return!1}return!0}function io(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Gc(a,i){var d=io(a);a=0;for(var g;d;){if(d.nodeType===3){if(g=a+d.textContent.length,a<=i&&g>=i)return{node:d,offset:i-a};a=g}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=io(d)}}function Kc(a,i){return a&&i?a===i?!0:a&&a.nodeType===3?!1:i&&i.nodeType===3?Kc(a,i.parentNode):"contains"in a?a.contains(i):a.compareDocumentPosition?!!(a.compareDocumentPosition(i)&16):!1:!1}function Xc(){for(var a=window,i=Ie();i instanceof a.HTMLIFrameElement;){try{var d=typeof i.contentWindow.location.href=="string"}catch{d=!1}if(d)a=i.contentWindow;else break;i=Ie(a.document)}return i}function _l(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i&&(i==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||i==="textarea"||a.contentEditable==="true")}function Yd(a){var i=Xc(),d=a.focusedElem,g=a.selectionRange;if(i!==d&&d&&d.ownerDocument&&Kc(d.ownerDocument.documentElement,d)){if(g!==null&&_l(d)){if(i=g.start,a=g.end,a===void 0&&(a=i),"selectionStart"in d)d.selectionStart=i,d.selectionEnd=Math.min(a,d.value.length);else if(a=(i=d.ownerDocument||document)&&i.defaultView||window,a.getSelection){a=a.getSelection();var x=d.textContent.length,S=Math.min(g.start,x);g=g.end===void 0?S:Math.min(g.end,x),!a.extend&&S>g&&(x=g,g=S,S=x),x=Gc(d,S);var M=Gc(d,g);x&&M&&(a.rangeCount!==1||a.anchorNode!==x.node||a.anchorOffset!==x.offset||a.focusNode!==M.node||a.focusOffset!==M.offset)&&(i=i.createRange(),i.setStart(x.node,x.offset),a.removeAllRanges(),S>g?(a.addRange(i),a.extend(M.node,M.offset)):(i.setEnd(M.node,M.offset),a.addRange(i)))}}for(i=[],a=d;a=a.parentNode;)a.nodeType===1&&i.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<i.length;d++)a=i[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var Qd=u&&"documentMode"in document&&11>=document.documentMode,Qs=null,Sl=null,Kt=null,oo=!1;function qc(a,i,d){var g=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;oo||Qs==null||Qs!==Ie(g)||(g=Qs,"selectionStart"in g&&_l(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Kt&&ja(Kt,g)||(Kt=g,g=dn(Sl,"onSelect"),0<g.length&&(i=new Ta("onSelect","select",null,i,d),a.push({event:i,listeners:g}),i.target=Qs)))}function lo(a,i){var d={};return d[a.toLowerCase()]=i.toLowerCase(),d["Webkit"+a]="webkit"+i,d["Moz"+a]="moz"+i,d}var Aa={animationend:lo("Animation","AnimationEnd"),animationiteration:lo("Animation","AnimationIteration"),animationstart:lo("Animation","AnimationStart"),transitionend:lo("Transition","TransitionEnd")},El={},Jc={};u&&(Jc=document.createElement("div").style,"AnimationEvent"in window||(delete Aa.animationend.animation,delete Aa.animationiteration.animation,delete Aa.animationstart.animation),"TransitionEvent"in window||delete Aa.transitionend.transition);function co(a){if(El[a])return El[a];if(!Aa[a])return a;var i=Aa[a],d;for(d in i)if(i.hasOwnProperty(d)&&d in Jc)return El[a]=i[d];return a}var Yc=co("animationend"),kl=co("animationiteration"),Qc=co("animationstart"),uo=co("transitionend"),Fn=new Map,h="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function E(a,i){Fn.set(a,i),o(i,[a])}for(var C=0;C<h.length;C++){var P=h[C],Q=P.toLowerCase(),ce=P[0].toUpperCase()+P.slice(1);E(Q,"on"+ce)}E(Yc,"onAnimationEnd"),E(kl,"onAnimationIteration"),E(Qc,"onAnimationStart"),E("dblclick","onDoubleClick"),E("focusin","onFocus"),E("focusout","onBlur"),E(uo,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var me="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ce=new Set("cancel close invalid load scroll toggle".split(" ").concat(me));function Ae(a,i,d){var g=a.type||"unknown-event";a.currentTarget=d,re(g,i,void 0,a),a.currentTarget=null}function Xe(a,i){i=(i&4)!==0;for(var d=0;d<a.length;d++){var g=a[d],x=g.event;g=g.listeners;e:{var S=void 0;if(i)for(var M=g.length-1;0<=M;M--){var de=g[M],ge=de.instance,je=de.currentTarget;if(de=de.listener,ge!==S&&x.isPropagationStopped())break e;Ae(x,de,je),S=ge}else for(M=0;M<g.length;M++){if(de=g[M],ge=de.instance,je=de.currentTarget,de=de.listener,ge!==S&&x.isPropagationStopped())break e;Ae(x,de,je),S=ge}}}if(W)throw a=J,W=!1,J=null,a}function We(a,i){var d=i[s0];d===void 0&&(d=i[s0]=new Set);var g=a+"__bubble";d.has(g)||(Vt(i,a,2,!1),d.add(g))}function De(a,i,d){var g=0;i&&(g|=4),Vt(d,a,g,i)}var Je="_reactListening"+Math.random().toString(36).slice(2);function ot(a){if(!a[Je]){a[Je]=!0,n.forEach(function(d){d!=="selectionchange"&&(Ce.has(d)||De(d,!1,a),De(d,!0,a))});var i=a.nodeType===9?a:a.ownerDocument;i===null||i[Je]||(i[Je]=!0,De("selectionchange",!1,i))}}function Vt(a,i,d,g){switch(Zi(i)){case 1:var x=Sa;break;case 4:x=Id;break;default:x=Ea}d=x.bind(null,i,d,a),x=void 0,!xa||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(x=!0),g?x!==void 0?a.addEventListener(i,d,{capture:!0,passive:x}):a.addEventListener(i,d,!0):x!==void 0?a.addEventListener(i,d,{passive:x}):a.addEventListener(i,d,!1)}function zt(a,i,d,g,x){var S=g;if((i&1)===0&&(i&2)===0&&g!==null)e:for(;;){if(g===null)return;var M=g.tag;if(M===3||M===4){var de=g.stateNode.containerInfo;if(de===x||de.nodeType===8&&de.parentNode===x)break;if(M===4)for(M=g.return;M!==null;){var ge=M.tag;if((ge===3||ge===4)&&(ge=M.stateNode.containerInfo,ge===x||ge.nodeType===8&&ge.parentNode===x))return;M=M.return}for(;de!==null;){if(M=xi(de),M===null)return;if(ge=M.tag,ge===5||ge===6){g=S=M;continue e}de=de.parentNode}}g=g.return}Ws(function(){var je=S,Be=dt(d),ze=[];e:{var Ue=Fn.get(a);if(Ue!==void 0){var et=Ta,st=a;switch(a){case"keypress":if(Gs(d)===0)break e;case"keydown":case"keyup":et=Ud;break;case"focusin":st="focus",et=di;break;case"focusout":st="blur",et=di;break;case"beforeblur":case"afterblur":et=di;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":et=hl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":et=Od;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":et=Mc;break;case Yc:case kl:case Qc:et=Pc;break;case uo:et=Sn;break;case"scroll":et=to;break;case"wheel":et=Vd;break;case"copy":case"cut":case"paste":et=Pd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":et=$t}var at=(i&4)!==0,hr=!at&&a==="scroll",be=at?Ue!==null?Ue+"Capture":null:Ue;at=[];for(var xe=je,Se;xe!==null;){Se=xe;var Ge=Se.stateNode;if(Se.tag===5&&Ge!==null&&(Se=Ge,be!==null&&(Ge=ks(xe,be),Ge!=null&&at.push(Ir(xe,Ge,Se)))),hr)break;xe=xe.return}0<at.length&&(Ue=new et(Ue,st,null,d,Be),ze.push({event:Ue,listeners:at}))}}if((i&7)===0){e:{if(Ue=a==="mouseover"||a==="pointerover",et=a==="mouseout"||a==="pointerout",Ue&&d!==Ur&&(st=d.relatedTarget||d.fromElement)&&(xi(st)||st[Zs]))break e;if((et||Ue)&&(Ue=Be.window===Be?Be:(Ue=Be.ownerDocument)?Ue.defaultView||Ue.parentWindow:window,et?(st=d.relatedTarget||d.toElement,et=je,st=st?xi(st):null,st!==null&&(hr=ie(st),st!==hr||st.tag!==5&&st.tag!==6)&&(st=null)):(et=null,st=je),et!==st)){if(at=hl,Ge="onMouseLeave",be="onMouseEnter",xe="mouse",(a==="pointerout"||a==="pointerover")&&(at=$t,Ge="onPointerLeave",be="onPointerEnter",xe="pointer"),hr=et==null?Ue:mo(et),Se=st==null?Ue:mo(st),Ue=new at(Ge,xe+"leave",et,d,Be),Ue.target=hr,Ue.relatedTarget=Se,Ge=null,xi(Be)===je&&(at=new at(be,xe+"enter",st,d,Be),at.target=Se,at.relatedTarget=hr,Ge=at),hr=Ge,et&&st)t:{for(at=et,be=st,xe=0,Se=at;Se;Se=Rs(Se))xe++;for(Se=0,Ge=be;Ge;Ge=Rs(Ge))Se++;for(;0<xe-Se;)at=Rs(at),xe--;for(;0<Se-xe;)be=Rs(be),Se--;for(;xe--;){if(at===be||be!==null&&at===be.alternate)break t;at=Rs(at),be=Rs(be)}at=null}else at=null;et!==null&&pi(ze,Ue,et,at,!1),st!==null&&hr!==null&&pi(ze,hr,st,at,!0)}}e:{if(Ue=je?mo(je):window,et=Ue.nodeName&&Ue.nodeName.toLowerCase(),et==="select"||et==="input"&&Ue.type==="file")var it=mi;else if(Vc(Ue))if(Wc)it=Kn;else{it=Xd;var ct=Kd}else(et=Ue.nodeName)&&et.toLowerCase()==="input"&&(Ue.type==="checkbox"||Ue.type==="radio")&&(it=qd);if(it&&(it=it(a,je))){yl(ze,it,d,Be);break e}ct&&ct(a,Ue,je),a==="focusout"&&(ct=Ue._wrapperState)&&ct.controlled&&Ue.type==="number"&&Le(Ue,"number",Ue.value)}switch(ct=je?mo(je):window,a){case"focusin":(Vc(ct)||ct.contentEditable==="true")&&(Qs=ct,Sl=je,Kt=null);break;case"focusout":Kt=Sl=Qs=null;break;case"mousedown":oo=!0;break;case"contextmenu":case"mouseup":case"dragend":oo=!1,qc(ze,d,Be);break;case"selectionchange":if(Qd)break;case"keydown":case"keyup":qc(ze,d,Be)}var ut;if(pl)e:{switch(a){case"compositionstart":var gt="onCompositionStart";break e;case"compositionend":gt="onCompositionEnd";break e;case"compositionupdate":gt="onCompositionUpdate";break e}gt=void 0}else Na?qs(a,d)&&(gt="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(gt="onCompositionStart");gt&&(xl&&d.locale!=="ko"&&(Na||gt!=="onCompositionStart"?gt==="onCompositionEnd"&&Na&&(ut=fl()):(On=Be,dl="value"in On?On.value:On.textContent,Na=!0)),ct=dn(je,gt),0<ct.length&&(gt=new Lc(gt,a,null,d,Be),ze.push({event:gt,listeners:ct}),ut?gt.data=ut:(ut=Bc(d),ut!==null&&(gt.data=ut)))),(ut=Wd?Hd(a,d):Js(a,d))&&(je=dn(je,"onBeforeInput"),0<je.length&&(Be=new Lc("onBeforeInput","beforeinput",null,d,Be),ze.push({event:Be,listeners:je}),Be.data=ut))}Xe(ze,i)})}function Ir(a,i,d){return{instance:a,listener:i,currentTarget:d}}function dn(a,i){for(var d=i+"Capture",g=[];a!==null;){var x=a,S=x.stateNode;x.tag===5&&S!==null&&(x=S,S=ks(a,d),S!=null&&g.unshift(Ir(a,S,x)),S=ks(a,i),S!=null&&g.push(Ir(a,S,x))),a=a.return}return g}function Rs(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function pi(a,i,d,g,x){for(var S=i._reactName,M=[];d!==null&&d!==g;){var de=d,ge=de.alternate,je=de.stateNode;if(ge!==null&&ge===g)break;de.tag===5&&je!==null&&(de=je,x?(ge=ks(d,S),ge!=null&&M.unshift(Ir(d,ge,de))):x||(ge=ks(d,S),ge!=null&&M.push(Ir(d,ge,de)))),d=d.return}M.length!==0&&a.push({event:i,listeners:M})}var Zd=/\r\n?/g,e0=/\u0000|\uFFFD/g;function Zc(a){return(typeof a=="string"?a:""+a).replace(Zd,`
`).replace(e0,"")}function Ra(a,i,d){if(i=Zc(i),Zc(a)!==i&&d)throw Error(e(425))}function fo(){}var Tl=null,Nl=null;function t0(a,i){return a==="textarea"||a==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var r0=typeof setTimeout=="function"?setTimeout:void 0,D1=typeof clearTimeout=="function"?clearTimeout:void 0,zh=typeof Promise=="function"?Promise:void 0,F1=typeof queueMicrotask=="function"?queueMicrotask:typeof zh<"u"?function(a){return zh.resolve(null).then(a).catch(P1)}:r0;function P1(a){setTimeout(function(){throw a})}function n0(a,i){var d=i,g=0;do{var x=d.nextSibling;if(a.removeChild(d),x&&x.nodeType===8)if(d=x.data,d==="/$"){if(g===0){a.removeChild(x),ba(i);return}g--}else d!=="$"&&d!=="$?"&&d!=="$!"||g++;d=x}while(d);ba(i)}function Ia(a){for(;a!=null;a=a.nextSibling){var i=a.nodeType;if(i===1||i===3)break;if(i===8){if(i=a.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return a}function Gh(a){a=a.previousSibling;for(var i=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(i===0)return a;i--}else d==="/$"&&i++}a=a.previousSibling}return null}var ho=Math.random().toString(36).slice(2),Is="__reactFiber$"+ho,Cl="__reactProps$"+ho,Zs="__reactContainer$"+ho,s0="__reactEvents$"+ho,L1="__reactListeners$"+ho,M1="__reactHandles$"+ho;function xi(a){var i=a[Is];if(i)return i;for(var d=a.parentNode;d;){if(i=d[Zs]||d[Is]){if(d=i.alternate,i.child!==null||d!==null&&d.child!==null)for(a=Gh(a);a!==null;){if(d=a[Is])return d;a=Gh(a)}return i}a=d,d=a.parentNode}return null}function jl(a){return a=a[Is]||a[Zs],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function mo(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(e(33))}function eu(a){return a[Cl]||null}var a0=[],go=-1;function Oa(a){return{current:a}}function Qt(a){0>go||(a.current=a0[go],a0[go]=null,go--)}function qt(a,i){go++,a0[go]=a.current,a.current=i}var Da={},qr=Oa(Da),En=Oa(!1),vi=Da;function po(a,i){var d=a.type.contextTypes;if(!d)return Da;var g=a.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===i)return g.__reactInternalMemoizedMaskedChildContext;var x={},S;for(S in d)x[S]=i[S];return g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=i,a.__reactInternalMemoizedMaskedChildContext=x),x}function kn(a){return a=a.childContextTypes,a!=null}function tu(){Qt(En),Qt(qr)}function Kh(a,i,d){if(qr.current!==Da)throw Error(e(168));qt(qr,i),qt(En,d)}function Xh(a,i,d){var g=a.stateNode;if(i=i.childContextTypes,typeof g.getChildContext!="function")return d;g=g.getChildContext();for(var x in g)if(!(x in i))throw Error(e(108,te(a)||"Unknown",x));return oe({},d,g)}function ru(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Da,vi=qr.current,qt(qr,a),qt(En,En.current),!0}function qh(a,i,d){var g=a.stateNode;if(!g)throw Error(e(169));d?(a=Xh(a,i,vi),g.__reactInternalMemoizedMergedChildContext=a,Qt(En),Qt(qr),qt(qr,a)):Qt(En),qt(En,d)}var ea=null,nu=!1,i0=!1;function Jh(a){ea===null?ea=[a]:ea.push(a)}function $1(a){nu=!0,Jh(a)}function Fa(){if(!i0&&ea!==null){i0=!0;var a=0,i=Tt;try{var d=ea;for(Tt=1;a<d.length;a++){var g=d[a];do g=g(!0);while(g!==null)}ea=null,nu=!1}catch(x){throw ea!==null&&(ea=ea.slice(a+1)),He(Bt,Fa),x}finally{Tt=i,i0=!1}}return null}var xo=[],vo=0,su=null,au=0,Xn=[],qn=0,yi=null,ta=1,ra="";function wi(a,i){xo[vo++]=au,xo[vo++]=su,su=a,au=i}function Yh(a,i,d){Xn[qn++]=ta,Xn[qn++]=ra,Xn[qn++]=yi,yi=a;var g=ta;a=ra;var x=32-rr(g)-1;g&=~(1<<x),d+=1;var S=32-rr(i)+x;if(30<S){var M=x-x%5;S=(g&(1<<M)-1).toString(32),g>>=M,x-=M,ta=1<<32-rr(i)+x|d<<x|g,ra=S+a}else ta=1<<S|d<<x|g,ra=a}function o0(a){a.return!==null&&(wi(a,1),Yh(a,1,0))}function l0(a){for(;a===su;)su=xo[--vo],xo[vo]=null,au=xo[--vo],xo[vo]=null;for(;a===yi;)yi=Xn[--qn],Xn[qn]=null,ra=Xn[--qn],Xn[qn]=null,ta=Xn[--qn],Xn[qn]=null}var Pn=null,Ln=null,Zt=!1,us=null;function Qh(a,i){var d=Zn(5,null,null,0);d.elementType="DELETED",d.stateNode=i,d.return=a,i=a.deletions,i===null?(a.deletions=[d],a.flags|=16):i.push(d)}function Zh(a,i){switch(a.tag){case 5:var d=a.type;return i=i.nodeType!==1||d.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(a.stateNode=i,Pn=a,Ln=Ia(i.firstChild),!0):!1;case 6:return i=a.pendingProps===""||i.nodeType!==3?null:i,i!==null?(a.stateNode=i,Pn=a,Ln=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(d=yi!==null?{id:ta,overflow:ra}:null,a.memoizedState={dehydrated:i,treeContext:d,retryLane:1073741824},d=Zn(18,null,null,0),d.stateNode=i,d.return=a,a.child=d,Pn=a,Ln=null,!0):!1;default:return!1}}function c0(a){return(a.mode&1)!==0&&(a.flags&128)===0}function u0(a){if(Zt){var i=Ln;if(i){var d=i;if(!Zh(a,i)){if(c0(a))throw Error(e(418));i=Ia(d.nextSibling);var g=Pn;i&&Zh(a,i)?Qh(g,d):(a.flags=a.flags&-4097|2,Zt=!1,Pn=a)}}else{if(c0(a))throw Error(e(418));a.flags=a.flags&-4097|2,Zt=!1,Pn=a}}}function em(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Pn=a}function iu(a){if(a!==Pn)return!1;if(!Zt)return em(a),Zt=!0,!1;var i;if((i=a.tag!==3)&&!(i=a.tag!==5)&&(i=a.type,i=i!=="head"&&i!=="body"&&!t0(a.type,a.memoizedProps)),i&&(i=Ln)){if(c0(a))throw tm(),Error(e(418));for(;i;)Qh(a,i),i=Ia(i.nextSibling)}if(em(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(e(317));e:{for(a=a.nextSibling,i=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(i===0){Ln=Ia(a.nextSibling);break e}i--}else d!=="$"&&d!=="$!"&&d!=="$?"||i++}a=a.nextSibling}Ln=null}}else Ln=Pn?Ia(a.stateNode.nextSibling):null;return!0}function tm(){for(var a=Ln;a;)a=Ia(a.nextSibling)}function yo(){Ln=Pn=null,Zt=!1}function d0(a){us===null?us=[a]:us.push(a)}var U1=F.ReactCurrentBatchConfig;function Al(a,i,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(e(309));var g=d.stateNode}if(!g)throw Error(e(147,a));var x=g,S=""+a;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===S?i.ref:(i=function(M){var de=x.refs;M===null?delete de[S]:de[S]=M},i._stringRef=S,i)}if(typeof a!="string")throw Error(e(284));if(!d._owner)throw Error(e(290,a))}return a}function ou(a,i){throw a=Object.prototype.toString.call(i),Error(e(31,a==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":a))}function rm(a){var i=a._init;return i(a._payload)}function nm(a){function i(be,xe){if(a){var Se=be.deletions;Se===null?(be.deletions=[xe],be.flags|=16):Se.push(xe)}}function d(be,xe){if(!a)return null;for(;xe!==null;)i(be,xe),xe=xe.sibling;return null}function g(be,xe){for(be=new Map;xe!==null;)xe.key!==null?be.set(xe.key,xe):be.set(xe.index,xe),xe=xe.sibling;return be}function x(be,xe){return be=Wa(be,xe),be.index=0,be.sibling=null,be}function S(be,xe,Se){return be.index=Se,a?(Se=be.alternate,Se!==null?(Se=Se.index,Se<xe?(be.flags|=2,xe):Se):(be.flags|=2,xe)):(be.flags|=1048576,xe)}function M(be){return a&&be.alternate===null&&(be.flags|=2),be}function de(be,xe,Se,Ge){return xe===null||xe.tag!==6?(xe=rf(Se,be.mode,Ge),xe.return=be,xe):(xe=x(xe,Se),xe.return=be,xe)}function ge(be,xe,Se,Ge){var it=Se.type;return it===V?Be(be,xe,Se.props.children,Ge,Se.key):xe!==null&&(xe.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===Ne&&rm(it)===xe.type)?(Ge=x(xe,Se.props),Ge.ref=Al(be,xe,Se),Ge.return=be,Ge):(Ge=Ru(Se.type,Se.key,Se.props,null,be.mode,Ge),Ge.ref=Al(be,xe,Se),Ge.return=be,Ge)}function je(be,xe,Se,Ge){return xe===null||xe.tag!==4||xe.stateNode.containerInfo!==Se.containerInfo||xe.stateNode.implementation!==Se.implementation?(xe=nf(Se,be.mode,Ge),xe.return=be,xe):(xe=x(xe,Se.children||[]),xe.return=be,xe)}function Be(be,xe,Se,Ge,it){return xe===null||xe.tag!==7?(xe=Ci(Se,be.mode,Ge,it),xe.return=be,xe):(xe=x(xe,Se),xe.return=be,xe)}function ze(be,xe,Se){if(typeof xe=="string"&&xe!==""||typeof xe=="number")return xe=rf(""+xe,be.mode,Se),xe.return=be,xe;if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case ue:return Se=Ru(xe.type,xe.key,xe.props,null,be.mode,Se),Se.ref=Al(be,null,xe),Se.return=be,Se;case D:return xe=nf(xe,be.mode,Se),xe.return=be,xe;case Ne:var Ge=xe._init;return ze(be,Ge(xe._payload),Se)}if(Me(xe)||K(xe))return xe=Ci(xe,be.mode,Se,null),xe.return=be,xe;ou(be,xe)}return null}function Ue(be,xe,Se,Ge){var it=xe!==null?xe.key:null;if(typeof Se=="string"&&Se!==""||typeof Se=="number")return it!==null?null:de(be,xe,""+Se,Ge);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case ue:return Se.key===it?ge(be,xe,Se,Ge):null;case D:return Se.key===it?je(be,xe,Se,Ge):null;case Ne:return it=Se._init,Ue(be,xe,it(Se._payload),Ge)}if(Me(Se)||K(Se))return it!==null?null:Be(be,xe,Se,Ge,null);ou(be,Se)}return null}function et(be,xe,Se,Ge,it){if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number")return be=be.get(Se)||null,de(xe,be,""+Ge,it);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case ue:return be=be.get(Ge.key===null?Se:Ge.key)||null,ge(xe,be,Ge,it);case D:return be=be.get(Ge.key===null?Se:Ge.key)||null,je(xe,be,Ge,it);case Ne:var ct=Ge._init;return et(be,xe,Se,ct(Ge._payload),it)}if(Me(Ge)||K(Ge))return be=be.get(Se)||null,Be(xe,be,Ge,it,null);ou(xe,Ge)}return null}function st(be,xe,Se,Ge){for(var it=null,ct=null,ut=xe,gt=xe=0,Fr=null;ut!==null&&gt<Se.length;gt++){ut.index>gt?(Fr=ut,ut=null):Fr=ut.sibling;var Ut=Ue(be,ut,Se[gt],Ge);if(Ut===null){ut===null&&(ut=Fr);break}a&&ut&&Ut.alternate===null&&i(be,ut),xe=S(Ut,xe,gt),ct===null?it=Ut:ct.sibling=Ut,ct=Ut,ut=Fr}if(gt===Se.length)return d(be,ut),Zt&&wi(be,gt),it;if(ut===null){for(;gt<Se.length;gt++)ut=ze(be,Se[gt],Ge),ut!==null&&(xe=S(ut,xe,gt),ct===null?it=ut:ct.sibling=ut,ct=ut);return Zt&&wi(be,gt),it}for(ut=g(be,ut);gt<Se.length;gt++)Fr=et(ut,be,gt,Se[gt],Ge),Fr!==null&&(a&&Fr.alternate!==null&&ut.delete(Fr.key===null?gt:Fr.key),xe=S(Fr,xe,gt),ct===null?it=Fr:ct.sibling=Fr,ct=Fr);return a&&ut.forEach(function(Ha){return i(be,Ha)}),Zt&&wi(be,gt),it}function at(be,xe,Se,Ge){var it=K(Se);if(typeof it!="function")throw Error(e(150));if(Se=it.call(Se),Se==null)throw Error(e(151));for(var ct=it=null,ut=xe,gt=xe=0,Fr=null,Ut=Se.next();ut!==null&&!Ut.done;gt++,Ut=Se.next()){ut.index>gt?(Fr=ut,ut=null):Fr=ut.sibling;var Ha=Ue(be,ut,Ut.value,Ge);if(Ha===null){ut===null&&(ut=Fr);break}a&&ut&&Ha.alternate===null&&i(be,ut),xe=S(Ha,xe,gt),ct===null?it=Ha:ct.sibling=Ha,ct=Ha,ut=Fr}if(Ut.done)return d(be,ut),Zt&&wi(be,gt),it;if(ut===null){for(;!Ut.done;gt++,Ut=Se.next())Ut=ze(be,Ut.value,Ge),Ut!==null&&(xe=S(Ut,xe,gt),ct===null?it=Ut:ct.sibling=Ut,ct=Ut);return Zt&&wi(be,gt),it}for(ut=g(be,ut);!Ut.done;gt++,Ut=Se.next())Ut=et(ut,be,gt,Ut.value,Ge),Ut!==null&&(a&&Ut.alternate!==null&&ut.delete(Ut.key===null?gt:Ut.key),xe=S(Ut,xe,gt),ct===null?it=Ut:ct.sibling=Ut,ct=Ut);return a&&ut.forEach(function(yy){return i(be,yy)}),Zt&&wi(be,gt),it}function hr(be,xe,Se,Ge){if(typeof Se=="object"&&Se!==null&&Se.type===V&&Se.key===null&&(Se=Se.props.children),typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case ue:e:{for(var it=Se.key,ct=xe;ct!==null;){if(ct.key===it){if(it=Se.type,it===V){if(ct.tag===7){d(be,ct.sibling),xe=x(ct,Se.props.children),xe.return=be,be=xe;break e}}else if(ct.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===Ne&&rm(it)===ct.type){d(be,ct.sibling),xe=x(ct,Se.props),xe.ref=Al(be,ct,Se),xe.return=be,be=xe;break e}d(be,ct);break}else i(be,ct);ct=ct.sibling}Se.type===V?(xe=Ci(Se.props.children,be.mode,Ge,Se.key),xe.return=be,be=xe):(Ge=Ru(Se.type,Se.key,Se.props,null,be.mode,Ge),Ge.ref=Al(be,xe,Se),Ge.return=be,be=Ge)}return M(be);case D:e:{for(ct=Se.key;xe!==null;){if(xe.key===ct)if(xe.tag===4&&xe.stateNode.containerInfo===Se.containerInfo&&xe.stateNode.implementation===Se.implementation){d(be,xe.sibling),xe=x(xe,Se.children||[]),xe.return=be,be=xe;break e}else{d(be,xe);break}else i(be,xe);xe=xe.sibling}xe=nf(Se,be.mode,Ge),xe.return=be,be=xe}return M(be);case Ne:return ct=Se._init,hr(be,xe,ct(Se._payload),Ge)}if(Me(Se))return st(be,xe,Se,Ge);if(K(Se))return at(be,xe,Se,Ge);ou(be,Se)}return typeof Se=="string"&&Se!==""||typeof Se=="number"?(Se=""+Se,xe!==null&&xe.tag===6?(d(be,xe.sibling),xe=x(xe,Se),xe.return=be,be=xe):(d(be,xe),xe=rf(Se,be.mode,Ge),xe.return=be,be=xe),M(be)):d(be,xe)}return hr}var wo=nm(!0),sm=nm(!1),lu=Oa(null),cu=null,bo=null,f0=null;function h0(){f0=bo=cu=null}function m0(a){var i=lu.current;Qt(lu),a._currentValue=i}function g0(a,i,d){for(;a!==null;){var g=a.alternate;if((a.childLanes&i)!==i?(a.childLanes|=i,g!==null&&(g.childLanes|=i)):g!==null&&(g.childLanes&i)!==i&&(g.childLanes|=i),a===d)break;a=a.return}}function _o(a,i){cu=a,f0=bo=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&i)!==0&&(Tn=!0),a.firstContext=null)}function Jn(a){var i=a._currentValue;if(f0!==a)if(a={context:a,memoizedValue:i,next:null},bo===null){if(cu===null)throw Error(e(308));bo=a,cu.dependencies={lanes:0,firstContext:a}}else bo=bo.next=a;return i}var bi=null;function p0(a){bi===null?bi=[a]:bi.push(a)}function am(a,i,d,g){var x=i.interleaved;return x===null?(d.next=d,p0(i)):(d.next=x.next,x.next=d),i.interleaved=d,na(a,g)}function na(a,i){a.lanes|=i;var d=a.alternate;for(d!==null&&(d.lanes|=i),d=a,a=a.return;a!==null;)a.childLanes|=i,d=a.alternate,d!==null&&(d.childLanes|=i),d=a,a=a.return;return d.tag===3?d.stateNode:null}var Pa=!1;function x0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function im(a,i){a=a.updateQueue,i.updateQueue===a&&(i.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function sa(a,i){return{eventTime:a,lane:i,tag:0,payload:null,callback:null,next:null}}function La(a,i,d){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,(Pt&2)!==0){var x=g.pending;return x===null?i.next=i:(i.next=x.next,x.next=i),g.pending=i,na(a,d)}return x=g.interleaved,x===null?(i.next=i,p0(g)):(i.next=x.next,x.next=i),g.interleaved=i,na(a,d)}function uu(a,i,d){if(i=i.updateQueue,i!==null&&(i=i.shared,(d&4194240)!==0)){var g=i.lanes;g&=a.pendingLanes,d|=g,i.lanes=d,wa(a,d)}}function om(a,i){var d=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,d===g)){var x=null,S=null;if(d=d.firstBaseUpdate,d!==null){do{var M={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};S===null?x=S=M:S=S.next=M,d=d.next}while(d!==null);S===null?x=S=i:S=S.next=i}else x=S=i;d={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:S,shared:g.shared,effects:g.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=i:a.next=i,d.lastBaseUpdate=i}function du(a,i,d,g){var x=a.updateQueue;Pa=!1;var S=x.firstBaseUpdate,M=x.lastBaseUpdate,de=x.shared.pending;if(de!==null){x.shared.pending=null;var ge=de,je=ge.next;ge.next=null,M===null?S=je:M.next=je,M=ge;var Be=a.alternate;Be!==null&&(Be=Be.updateQueue,de=Be.lastBaseUpdate,de!==M&&(de===null?Be.firstBaseUpdate=je:de.next=je,Be.lastBaseUpdate=ge))}if(S!==null){var ze=x.baseState;M=0,Be=je=ge=null,de=S;do{var Ue=de.lane,et=de.eventTime;if((g&Ue)===Ue){Be!==null&&(Be=Be.next={eventTime:et,lane:0,tag:de.tag,payload:de.payload,callback:de.callback,next:null});e:{var st=a,at=de;switch(Ue=i,et=d,at.tag){case 1:if(st=at.payload,typeof st=="function"){ze=st.call(et,ze,Ue);break e}ze=st;break e;case 3:st.flags=st.flags&-65537|128;case 0:if(st=at.payload,Ue=typeof st=="function"?st.call(et,ze,Ue):st,Ue==null)break e;ze=oe({},ze,Ue);break e;case 2:Pa=!0}}de.callback!==null&&de.lane!==0&&(a.flags|=64,Ue=x.effects,Ue===null?x.effects=[de]:Ue.push(de))}else et={eventTime:et,lane:Ue,tag:de.tag,payload:de.payload,callback:de.callback,next:null},Be===null?(je=Be=et,ge=ze):Be=Be.next=et,M|=Ue;if(de=de.next,de===null){if(de=x.shared.pending,de===null)break;Ue=de,de=Ue.next,Ue.next=null,x.lastBaseUpdate=Ue,x.shared.pending=null}}while(!0);if(Be===null&&(ge=ze),x.baseState=ge,x.firstBaseUpdate=je,x.lastBaseUpdate=Be,i=x.shared.interleaved,i!==null){x=i;do M|=x.lane,x=x.next;while(x!==i)}else S===null&&(x.shared.lanes=0);Ei|=M,a.lanes=M,a.memoizedState=ze}}function lm(a,i,d){if(a=i.effects,i.effects=null,a!==null)for(i=0;i<a.length;i++){var g=a[i],x=g.callback;if(x!==null){if(g.callback=null,g=d,typeof x!="function")throw Error(e(191,x));x.call(g)}}}var Rl={},Os=Oa(Rl),Il=Oa(Rl),Ol=Oa(Rl);function _i(a){if(a===Rl)throw Error(e(174));return a}function v0(a,i){switch(qt(Ol,i),qt(Il,a),qt(Os,Rl),a=i.nodeType,a){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Ft(null,"");break;default:a=a===8?i.parentNode:i,i=a.namespaceURI||null,a=a.tagName,i=Ft(i,a)}Qt(Os),qt(Os,i)}function So(){Qt(Os),Qt(Il),Qt(Ol)}function cm(a){_i(Ol.current);var i=_i(Os.current),d=Ft(i,a.type);i!==d&&(qt(Il,a),qt(Os,d))}function y0(a){Il.current===a&&(Qt(Os),Qt(Il))}var nr=Oa(0);function fu(a){for(var i=a;i!==null;){if(i.tag===13){var d=i.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var w0=[];function b0(){for(var a=0;a<w0.length;a++)w0[a]._workInProgressVersionPrimary=null;w0.length=0}var hu=F.ReactCurrentDispatcher,_0=F.ReactCurrentBatchConfig,Si=0,sr=null,Sr=null,Or=null,mu=!1,Dl=!1,Fl=0,B1=0;function Jr(){throw Error(e(321))}function S0(a,i){if(i===null)return!1;for(var d=0;d<i.length&&d<a.length;d++)if(!Dn(a[d],i[d]))return!1;return!0}function E0(a,i,d,g,x,S){if(Si=S,sr=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,hu.current=a===null||a.memoizedState===null?z1:G1,a=d(g,x),Dl){S=0;do{if(Dl=!1,Fl=0,25<=S)throw Error(e(301));S+=1,Or=Sr=null,i.updateQueue=null,hu.current=K1,a=d(g,x)}while(Dl)}if(hu.current=xu,i=Sr!==null&&Sr.next!==null,Si=0,Or=Sr=sr=null,mu=!1,i)throw Error(e(300));return a}function k0(){var a=Fl!==0;return Fl=0,a}function Ds(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Or===null?sr.memoizedState=Or=a:Or=Or.next=a,Or}function Yn(){if(Sr===null){var a=sr.alternate;a=a!==null?a.memoizedState:null}else a=Sr.next;var i=Or===null?sr.memoizedState:Or.next;if(i!==null)Or=i,Sr=a;else{if(a===null)throw Error(e(310));Sr=a,a={memoizedState:Sr.memoizedState,baseState:Sr.baseState,baseQueue:Sr.baseQueue,queue:Sr.queue,next:null},Or===null?sr.memoizedState=Or=a:Or=Or.next=a}return Or}function Pl(a,i){return typeof i=="function"?i(a):i}function T0(a){var i=Yn(),d=i.queue;if(d===null)throw Error(e(311));d.lastRenderedReducer=a;var g=Sr,x=g.baseQueue,S=d.pending;if(S!==null){if(x!==null){var M=x.next;x.next=S.next,S.next=M}g.baseQueue=x=S,d.pending=null}if(x!==null){S=x.next,g=g.baseState;var de=M=null,ge=null,je=S;do{var Be=je.lane;if((Si&Be)===Be)ge!==null&&(ge=ge.next={lane:0,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null}),g=je.hasEagerState?je.eagerState:a(g,je.action);else{var ze={lane:Be,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null};ge===null?(de=ge=ze,M=g):ge=ge.next=ze,sr.lanes|=Be,Ei|=Be}je=je.next}while(je!==null&&je!==S);ge===null?M=g:ge.next=de,Dn(g,i.memoizedState)||(Tn=!0),i.memoizedState=g,i.baseState=M,i.baseQueue=ge,d.lastRenderedState=g}if(a=d.interleaved,a!==null){x=a;do S=x.lane,sr.lanes|=S,Ei|=S,x=x.next;while(x!==a)}else x===null&&(d.lanes=0);return[i.memoizedState,d.dispatch]}function N0(a){var i=Yn(),d=i.queue;if(d===null)throw Error(e(311));d.lastRenderedReducer=a;var g=d.dispatch,x=d.pending,S=i.memoizedState;if(x!==null){d.pending=null;var M=x=x.next;do S=a(S,M.action),M=M.next;while(M!==x);Dn(S,i.memoizedState)||(Tn=!0),i.memoizedState=S,i.baseQueue===null&&(i.baseState=S),d.lastRenderedState=S}return[S,g]}function um(){}function dm(a,i){var d=sr,g=Yn(),x=i(),S=!Dn(g.memoizedState,x);if(S&&(g.memoizedState=x,Tn=!0),g=g.queue,C0(mm.bind(null,d,g,a),[a]),g.getSnapshot!==i||S||Or!==null&&Or.memoizedState.tag&1){if(d.flags|=2048,Ll(9,hm.bind(null,d,g,x,i),void 0,null),Dr===null)throw Error(e(349));(Si&30)!==0||fm(d,i,x)}return x}function fm(a,i,d){a.flags|=16384,a={getSnapshot:i,value:d},i=sr.updateQueue,i===null?(i={lastEffect:null,stores:null},sr.updateQueue=i,i.stores=[a]):(d=i.stores,d===null?i.stores=[a]:d.push(a))}function hm(a,i,d,g){i.value=d,i.getSnapshot=g,gm(i)&&pm(a)}function mm(a,i,d){return d(function(){gm(i)&&pm(a)})}function gm(a){var i=a.getSnapshot;a=a.value;try{var d=i();return!Dn(a,d)}catch{return!0}}function pm(a){var i=na(a,1);i!==null&&ms(i,a,1,-1)}function xm(a){var i=Ds();return typeof a=="function"&&(a=a()),i.memoizedState=i.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pl,lastRenderedState:a},i.queue=a,a=a.dispatch=H1.bind(null,sr,a),[i.memoizedState,a]}function Ll(a,i,d,g){return a={tag:a,create:i,destroy:d,deps:g,next:null},i=sr.updateQueue,i===null?(i={lastEffect:null,stores:null},sr.updateQueue=i,i.lastEffect=a.next=a):(d=i.lastEffect,d===null?i.lastEffect=a.next=a:(g=d.next,d.next=a,a.next=g,i.lastEffect=a)),a}function vm(){return Yn().memoizedState}function gu(a,i,d,g){var x=Ds();sr.flags|=a,x.memoizedState=Ll(1|i,d,void 0,g===void 0?null:g)}function pu(a,i,d,g){var x=Yn();g=g===void 0?null:g;var S=void 0;if(Sr!==null){var M=Sr.memoizedState;if(S=M.destroy,g!==null&&S0(g,M.deps)){x.memoizedState=Ll(i,d,S,g);return}}sr.flags|=a,x.memoizedState=Ll(1|i,d,S,g)}function ym(a,i){return gu(8390656,8,a,i)}function C0(a,i){return pu(2048,8,a,i)}function wm(a,i){return pu(4,2,a,i)}function bm(a,i){return pu(4,4,a,i)}function _m(a,i){if(typeof i=="function")return a=a(),i(a),function(){i(null)};if(i!=null)return a=a(),i.current=a,function(){i.current=null}}function Sm(a,i,d){return d=d!=null?d.concat([a]):null,pu(4,4,_m.bind(null,i,a),d)}function j0(){}function Em(a,i){var d=Yn();i=i===void 0?null:i;var g=d.memoizedState;return g!==null&&i!==null&&S0(i,g[1])?g[0]:(d.memoizedState=[a,i],a)}function km(a,i){var d=Yn();i=i===void 0?null:i;var g=d.memoizedState;return g!==null&&i!==null&&S0(i,g[1])?g[0]:(a=a(),d.memoizedState=[a,i],a)}function Tm(a,i,d){return(Si&21)===0?(a.baseState&&(a.baseState=!1,Tn=!0),a.memoizedState=d):(Dn(d,i)||(d=al(),sr.lanes|=d,Ei|=d,a.baseState=!0),i)}function V1(a,i){var d=Tt;Tt=d!==0&&4>d?d:4,a(!0);var g=_0.transition;_0.transition={};try{a(!1),i()}finally{Tt=d,_0.transition=g}}function Nm(){return Yn().memoizedState}function W1(a,i,d){var g=Ba(a);if(d={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null},Cm(a))jm(i,d);else if(d=am(a,i,d,g),d!==null){var x=hn();ms(d,a,g,x),Am(d,i,g)}}function H1(a,i,d){var g=Ba(a),x={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null};if(Cm(a))jm(i,x);else{var S=a.alternate;if(a.lanes===0&&(S===null||S.lanes===0)&&(S=i.lastRenderedReducer,S!==null))try{var M=i.lastRenderedState,de=S(M,d);if(x.hasEagerState=!0,x.eagerState=de,Dn(de,M)){var ge=i.interleaved;ge===null?(x.next=x,p0(i)):(x.next=ge.next,ge.next=x),i.interleaved=x;return}}catch{}finally{}d=am(a,i,x,g),d!==null&&(x=hn(),ms(d,a,g,x),Am(d,i,g))}}function Cm(a){var i=a.alternate;return a===sr||i!==null&&i===sr}function jm(a,i){Dl=mu=!0;var d=a.pending;d===null?i.next=i:(i.next=d.next,d.next=i),a.pending=i}function Am(a,i,d){if((d&4194240)!==0){var g=i.lanes;g&=a.pendingLanes,d|=g,i.lanes=d,wa(a,d)}}var xu={readContext:Jn,useCallback:Jr,useContext:Jr,useEffect:Jr,useImperativeHandle:Jr,useInsertionEffect:Jr,useLayoutEffect:Jr,useMemo:Jr,useReducer:Jr,useRef:Jr,useState:Jr,useDebugValue:Jr,useDeferredValue:Jr,useTransition:Jr,useMutableSource:Jr,useSyncExternalStore:Jr,useId:Jr,unstable_isNewReconciler:!1},z1={readContext:Jn,useCallback:function(a,i){return Ds().memoizedState=[a,i===void 0?null:i],a},useContext:Jn,useEffect:ym,useImperativeHandle:function(a,i,d){return d=d!=null?d.concat([a]):null,gu(4194308,4,_m.bind(null,i,a),d)},useLayoutEffect:function(a,i){return gu(4194308,4,a,i)},useInsertionEffect:function(a,i){return gu(4,2,a,i)},useMemo:function(a,i){var d=Ds();return i=i===void 0?null:i,a=a(),d.memoizedState=[a,i],a},useReducer:function(a,i,d){var g=Ds();return i=d!==void 0?d(i):i,g.memoizedState=g.baseState=i,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:i},g.queue=a,a=a.dispatch=W1.bind(null,sr,a),[g.memoizedState,a]},useRef:function(a){var i=Ds();return a={current:a},i.memoizedState=a},useState:xm,useDebugValue:j0,useDeferredValue:function(a){return Ds().memoizedState=a},useTransition:function(){var a=xm(!1),i=a[0];return a=V1.bind(null,a[1]),Ds().memoizedState=a,[i,a]},useMutableSource:function(){},useSyncExternalStore:function(a,i,d){var g=sr,x=Ds();if(Zt){if(d===void 0)throw Error(e(407));d=d()}else{if(d=i(),Dr===null)throw Error(e(349));(Si&30)!==0||fm(g,i,d)}x.memoizedState=d;var S={value:d,getSnapshot:i};return x.queue=S,ym(mm.bind(null,g,S,a),[a]),g.flags|=2048,Ll(9,hm.bind(null,g,S,d,i),void 0,null),d},useId:function(){var a=Ds(),i=Dr.identifierPrefix;if(Zt){var d=ra,g=ta;d=(g&~(1<<32-rr(g)-1)).toString(32)+d,i=":"+i+"R"+d,d=Fl++,0<d&&(i+="H"+d.toString(32)),i+=":"}else d=B1++,i=":"+i+"r"+d.toString(32)+":";return a.memoizedState=i},unstable_isNewReconciler:!1},G1={readContext:Jn,useCallback:Em,useContext:Jn,useEffect:C0,useImperativeHandle:Sm,useInsertionEffect:wm,useLayoutEffect:bm,useMemo:km,useReducer:T0,useRef:vm,useState:function(){return T0(Pl)},useDebugValue:j0,useDeferredValue:function(a){var i=Yn();return Tm(i,Sr.memoizedState,a)},useTransition:function(){var a=T0(Pl)[0],i=Yn().memoizedState;return[a,i]},useMutableSource:um,useSyncExternalStore:dm,useId:Nm,unstable_isNewReconciler:!1},K1={readContext:Jn,useCallback:Em,useContext:Jn,useEffect:C0,useImperativeHandle:Sm,useInsertionEffect:wm,useLayoutEffect:bm,useMemo:km,useReducer:N0,useRef:vm,useState:function(){return N0(Pl)},useDebugValue:j0,useDeferredValue:function(a){var i=Yn();return Sr===null?i.memoizedState=a:Tm(i,Sr.memoizedState,a)},useTransition:function(){var a=N0(Pl)[0],i=Yn().memoizedState;return[a,i]},useMutableSource:um,useSyncExternalStore:dm,useId:Nm,unstable_isNewReconciler:!1};function ds(a,i){if(a&&a.defaultProps){i=oe({},i),a=a.defaultProps;for(var d in a)i[d]===void 0&&(i[d]=a[d]);return i}return i}function A0(a,i,d,g){i=a.memoizedState,d=d(g,i),d=d==null?i:oe({},i,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var vu={isMounted:function(a){return(a=a._reactInternals)?ie(a)===a:!1},enqueueSetState:function(a,i,d){a=a._reactInternals;var g=hn(),x=Ba(a),S=sa(g,x);S.payload=i,d!=null&&(S.callback=d),i=La(a,S,x),i!==null&&(ms(i,a,x,g),uu(i,a,x))},enqueueReplaceState:function(a,i,d){a=a._reactInternals;var g=hn(),x=Ba(a),S=sa(g,x);S.tag=1,S.payload=i,d!=null&&(S.callback=d),i=La(a,S,x),i!==null&&(ms(i,a,x,g),uu(i,a,x))},enqueueForceUpdate:function(a,i){a=a._reactInternals;var d=hn(),g=Ba(a),x=sa(d,g);x.tag=2,i!=null&&(x.callback=i),i=La(a,x,g),i!==null&&(ms(i,a,g,d),uu(i,a,g))}};function Rm(a,i,d,g,x,S,M){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,S,M):i.prototype&&i.prototype.isPureReactComponent?!ja(d,g)||!ja(x,S):!0}function Im(a,i,d){var g=!1,x=Da,S=i.contextType;return typeof S=="object"&&S!==null?S=Jn(S):(x=kn(i)?vi:qr.current,g=i.contextTypes,S=(g=g!=null)?po(a,x):Da),i=new i(d,S),a.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=vu,a.stateNode=i,i._reactInternals=a,g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=x,a.__reactInternalMemoizedMaskedChildContext=S),i}function Om(a,i,d,g){a=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(d,g),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(d,g),i.state!==a&&vu.enqueueReplaceState(i,i.state,null)}function R0(a,i,d,g){var x=a.stateNode;x.props=d,x.state=a.memoizedState,x.refs={},x0(a);var S=i.contextType;typeof S=="object"&&S!==null?x.context=Jn(S):(S=kn(i)?vi:qr.current,x.context=po(a,S)),x.state=a.memoizedState,S=i.getDerivedStateFromProps,typeof S=="function"&&(A0(a,i,S,d),x.state=a.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(i=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),i!==x.state&&vu.enqueueReplaceState(x,x.state,null),du(a,d,x,g),x.state=a.memoizedState),typeof x.componentDidMount=="function"&&(a.flags|=4194308)}function Eo(a,i){try{var d="",g=i;do d+=ne(g),g=g.return;while(g);var x=d}catch(S){x=`
Error generating stack: `+S.message+`
`+S.stack}return{value:a,source:i,stack:x,digest:null}}function I0(a,i,d){return{value:a,source:null,stack:d??null,digest:i??null}}function O0(a,i){try{console.error(i.value)}catch(d){setTimeout(function(){throw d})}}var X1=typeof WeakMap=="function"?WeakMap:Map;function Dm(a,i,d){d=sa(-1,d),d.tag=3,d.payload={element:null};var g=i.value;return d.callback=function(){ku||(ku=!0,X0=g),O0(a,i)},d}function Fm(a,i,d){d=sa(-1,d),d.tag=3;var g=a.type.getDerivedStateFromError;if(typeof g=="function"){var x=i.value;d.payload=function(){return g(x)},d.callback=function(){O0(a,i)}}var S=a.stateNode;return S!==null&&typeof S.componentDidCatch=="function"&&(d.callback=function(){O0(a,i),typeof g!="function"&&($a===null?$a=new Set([this]):$a.add(this));var M=i.stack;this.componentDidCatch(i.value,{componentStack:M!==null?M:""})}),d}function Pm(a,i,d){var g=a.pingCache;if(g===null){g=a.pingCache=new X1;var x=new Set;g.set(i,x)}else x=g.get(i),x===void 0&&(x=new Set,g.set(i,x));x.has(d)||(x.add(d),a=ly.bind(null,a,i,d),i.then(a,a))}function Lm(a){do{var i;if((i=a.tag===13)&&(i=a.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return a;a=a.return}while(a!==null);return null}function Mm(a,i,d,g,x){return(a.mode&1)===0?(a===i?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(i=sa(-1,1),i.tag=2,La(d,i,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=x,a)}var q1=F.ReactCurrentOwner,Tn=!1;function fn(a,i,d,g){i.child=a===null?sm(i,null,d,g):wo(i,a.child,d,g)}function $m(a,i,d,g,x){d=d.render;var S=i.ref;return _o(i,x),g=E0(a,i,d,g,S,x),d=k0(),a!==null&&!Tn?(i.updateQueue=a.updateQueue,i.flags&=-2053,a.lanes&=~x,aa(a,i,x)):(Zt&&d&&o0(i),i.flags|=1,fn(a,i,g,x),i.child)}function Um(a,i,d,g,x){if(a===null){var S=d.type;return typeof S=="function"&&!tf(S)&&S.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(i.tag=15,i.type=S,Bm(a,i,S,g,x)):(a=Ru(d.type,null,g,i,i.mode,x),a.ref=i.ref,a.return=i,i.child=a)}if(S=a.child,(a.lanes&x)===0){var M=S.memoizedProps;if(d=d.compare,d=d!==null?d:ja,d(M,g)&&a.ref===i.ref)return aa(a,i,x)}return i.flags|=1,a=Wa(S,g),a.ref=i.ref,a.return=i,i.child=a}function Bm(a,i,d,g,x){if(a!==null){var S=a.memoizedProps;if(ja(S,g)&&a.ref===i.ref)if(Tn=!1,i.pendingProps=g=S,(a.lanes&x)!==0)(a.flags&131072)!==0&&(Tn=!0);else return i.lanes=a.lanes,aa(a,i,x)}return D0(a,i,d,g,x)}function Vm(a,i,d){var g=i.pendingProps,x=g.children,S=a!==null?a.memoizedState:null;if(g.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},qt(To,Mn),Mn|=d;else{if((d&1073741824)===0)return a=S!==null?S.baseLanes|d:d,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:a,cachePool:null,transitions:null},i.updateQueue=null,qt(To,Mn),Mn|=a,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=S!==null?S.baseLanes:d,qt(To,Mn),Mn|=g}else S!==null?(g=S.baseLanes|d,i.memoizedState=null):g=d,qt(To,Mn),Mn|=g;return fn(a,i,x,d),i.child}function Wm(a,i){var d=i.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(i.flags|=512,i.flags|=2097152)}function D0(a,i,d,g,x){var S=kn(d)?vi:qr.current;return S=po(i,S),_o(i,x),d=E0(a,i,d,g,S,x),g=k0(),a!==null&&!Tn?(i.updateQueue=a.updateQueue,i.flags&=-2053,a.lanes&=~x,aa(a,i,x)):(Zt&&g&&o0(i),i.flags|=1,fn(a,i,d,x),i.child)}function Hm(a,i,d,g,x){if(kn(d)){var S=!0;ru(i)}else S=!1;if(_o(i,x),i.stateNode===null)wu(a,i),Im(i,d,g),R0(i,d,g,x),g=!0;else if(a===null){var M=i.stateNode,de=i.memoizedProps;M.props=de;var ge=M.context,je=d.contextType;typeof je=="object"&&je!==null?je=Jn(je):(je=kn(d)?vi:qr.current,je=po(i,je));var Be=d.getDerivedStateFromProps,ze=typeof Be=="function"||typeof M.getSnapshotBeforeUpdate=="function";ze||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(de!==g||ge!==je)&&Om(i,M,g,je),Pa=!1;var Ue=i.memoizedState;M.state=Ue,du(i,g,M,x),ge=i.memoizedState,de!==g||Ue!==ge||En.current||Pa?(typeof Be=="function"&&(A0(i,d,Be,g),ge=i.memoizedState),(de=Pa||Rm(i,d,de,g,Ue,ge,je))?(ze||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(i.flags|=4194308)):(typeof M.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=g,i.memoizedState=ge),M.props=g,M.state=ge,M.context=je,g=de):(typeof M.componentDidMount=="function"&&(i.flags|=4194308),g=!1)}else{M=i.stateNode,im(a,i),de=i.memoizedProps,je=i.type===i.elementType?de:ds(i.type,de),M.props=je,ze=i.pendingProps,Ue=M.context,ge=d.contextType,typeof ge=="object"&&ge!==null?ge=Jn(ge):(ge=kn(d)?vi:qr.current,ge=po(i,ge));var et=d.getDerivedStateFromProps;(Be=typeof et=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(de!==ze||Ue!==ge)&&Om(i,M,g,ge),Pa=!1,Ue=i.memoizedState,M.state=Ue,du(i,g,M,x);var st=i.memoizedState;de!==ze||Ue!==st||En.current||Pa?(typeof et=="function"&&(A0(i,d,et,g),st=i.memoizedState),(je=Pa||Rm(i,d,je,g,Ue,st,ge)||!1)?(Be||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(g,st,ge),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(g,st,ge)),typeof M.componentDidUpdate=="function"&&(i.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof M.componentDidUpdate!="function"||de===a.memoizedProps&&Ue===a.memoizedState||(i.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||de===a.memoizedProps&&Ue===a.memoizedState||(i.flags|=1024),i.memoizedProps=g,i.memoizedState=st),M.props=g,M.state=st,M.context=ge,g=je):(typeof M.componentDidUpdate!="function"||de===a.memoizedProps&&Ue===a.memoizedState||(i.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||de===a.memoizedProps&&Ue===a.memoizedState||(i.flags|=1024),g=!1)}return F0(a,i,d,g,S,x)}function F0(a,i,d,g,x,S){Wm(a,i);var M=(i.flags&128)!==0;if(!g&&!M)return x&&qh(i,d,!1),aa(a,i,S);g=i.stateNode,q1.current=i;var de=M&&typeof d.getDerivedStateFromError!="function"?null:g.render();return i.flags|=1,a!==null&&M?(i.child=wo(i,a.child,null,S),i.child=wo(i,null,de,S)):fn(a,i,de,S),i.memoizedState=g.state,x&&qh(i,d,!0),i.child}function zm(a){var i=a.stateNode;i.pendingContext?Kh(a,i.pendingContext,i.pendingContext!==i.context):i.context&&Kh(a,i.context,!1),v0(a,i.containerInfo)}function Gm(a,i,d,g,x){return yo(),d0(x),i.flags|=256,fn(a,i,d,g),i.child}var P0={dehydrated:null,treeContext:null,retryLane:0};function L0(a){return{baseLanes:a,cachePool:null,transitions:null}}function Km(a,i,d){var g=i.pendingProps,x=nr.current,S=!1,M=(i.flags&128)!==0,de;if((de=M)||(de=a!==null&&a.memoizedState===null?!1:(x&2)!==0),de?(S=!0,i.flags&=-129):(a===null||a.memoizedState!==null)&&(x|=1),qt(nr,x&1),a===null)return u0(i),a=i.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((i.mode&1)===0?i.lanes=1:a.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(M=g.children,a=g.fallback,S?(g=i.mode,S=i.child,M={mode:"hidden",children:M},(g&1)===0&&S!==null?(S.childLanes=0,S.pendingProps=M):S=Iu(M,g,0,null),a=Ci(a,g,d,null),S.return=i,a.return=i,S.sibling=a,i.child=S,i.child.memoizedState=L0(d),i.memoizedState=P0,a):M0(i,M));if(x=a.memoizedState,x!==null&&(de=x.dehydrated,de!==null))return J1(a,i,M,g,de,x,d);if(S){S=g.fallback,M=i.mode,x=a.child,de=x.sibling;var ge={mode:"hidden",children:g.children};return(M&1)===0&&i.child!==x?(g=i.child,g.childLanes=0,g.pendingProps=ge,i.deletions=null):(g=Wa(x,ge),g.subtreeFlags=x.subtreeFlags&14680064),de!==null?S=Wa(de,S):(S=Ci(S,M,d,null),S.flags|=2),S.return=i,g.return=i,g.sibling=S,i.child=g,g=S,S=i.child,M=a.child.memoizedState,M=M===null?L0(d):{baseLanes:M.baseLanes|d,cachePool:null,transitions:M.transitions},S.memoizedState=M,S.childLanes=a.childLanes&~d,i.memoizedState=P0,g}return S=a.child,a=S.sibling,g=Wa(S,{mode:"visible",children:g.children}),(i.mode&1)===0&&(g.lanes=d),g.return=i,g.sibling=null,a!==null&&(d=i.deletions,d===null?(i.deletions=[a],i.flags|=16):d.push(a)),i.child=g,i.memoizedState=null,g}function M0(a,i){return i=Iu({mode:"visible",children:i},a.mode,0,null),i.return=a,a.child=i}function yu(a,i,d,g){return g!==null&&d0(g),wo(i,a.child,null,d),a=M0(i,i.pendingProps.children),a.flags|=2,i.memoizedState=null,a}function J1(a,i,d,g,x,S,M){if(d)return i.flags&256?(i.flags&=-257,g=I0(Error(e(422))),yu(a,i,M,g)):i.memoizedState!==null?(i.child=a.child,i.flags|=128,null):(S=g.fallback,x=i.mode,g=Iu({mode:"visible",children:g.children},x,0,null),S=Ci(S,x,M,null),S.flags|=2,g.return=i,S.return=i,g.sibling=S,i.child=g,(i.mode&1)!==0&&wo(i,a.child,null,M),i.child.memoizedState=L0(M),i.memoizedState=P0,S);if((i.mode&1)===0)return yu(a,i,M,null);if(x.data==="$!"){if(g=x.nextSibling&&x.nextSibling.dataset,g)var de=g.dgst;return g=de,S=Error(e(419)),g=I0(S,g,void 0),yu(a,i,M,g)}if(de=(M&a.childLanes)!==0,Tn||de){if(g=Dr,g!==null){switch(M&-M){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}x=(x&(g.suspendedLanes|M))!==0?0:x,x!==0&&x!==S.retryLane&&(S.retryLane=x,na(a,x),ms(g,a,x,-1))}return ef(),g=I0(Error(e(421))),yu(a,i,M,g)}return x.data==="$?"?(i.flags|=128,i.child=a.child,i=cy.bind(null,a),x._reactRetry=i,null):(a=S.treeContext,Ln=Ia(x.nextSibling),Pn=i,Zt=!0,us=null,a!==null&&(Xn[qn++]=ta,Xn[qn++]=ra,Xn[qn++]=yi,ta=a.id,ra=a.overflow,yi=i),i=M0(i,g.children),i.flags|=4096,i)}function Xm(a,i,d){a.lanes|=i;var g=a.alternate;g!==null&&(g.lanes|=i),g0(a.return,i,d)}function $0(a,i,d,g,x){var S=a.memoizedState;S===null?a.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:g,tail:d,tailMode:x}:(S.isBackwards=i,S.rendering=null,S.renderingStartTime=0,S.last=g,S.tail=d,S.tailMode=x)}function qm(a,i,d){var g=i.pendingProps,x=g.revealOrder,S=g.tail;if(fn(a,i,g.children,d),g=nr.current,(g&2)!==0)g=g&1|2,i.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=i.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Xm(a,d,i);else if(a.tag===19)Xm(a,d,i);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}if(qt(nr,g),(i.mode&1)===0)i.memoizedState=null;else switch(x){case"forwards":for(d=i.child,x=null;d!==null;)a=d.alternate,a!==null&&fu(a)===null&&(x=d),d=d.sibling;d=x,d===null?(x=i.child,i.child=null):(x=d.sibling,d.sibling=null),$0(i,!1,x,d,S);break;case"backwards":for(d=null,x=i.child,i.child=null;x!==null;){if(a=x.alternate,a!==null&&fu(a)===null){i.child=x;break}a=x.sibling,x.sibling=d,d=x,x=a}$0(i,!0,d,null,S);break;case"together":$0(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function wu(a,i){(i.mode&1)===0&&a!==null&&(a.alternate=null,i.alternate=null,i.flags|=2)}function aa(a,i,d){if(a!==null&&(i.dependencies=a.dependencies),Ei|=i.lanes,(d&i.childLanes)===0)return null;if(a!==null&&i.child!==a.child)throw Error(e(153));if(i.child!==null){for(a=i.child,d=Wa(a,a.pendingProps),i.child=d,d.return=i;a.sibling!==null;)a=a.sibling,d=d.sibling=Wa(a,a.pendingProps),d.return=i;d.sibling=null}return i.child}function Y1(a,i,d){switch(i.tag){case 3:zm(i),yo();break;case 5:cm(i);break;case 1:kn(i.type)&&ru(i);break;case 4:v0(i,i.stateNode.containerInfo);break;case 10:var g=i.type._context,x=i.memoizedProps.value;qt(lu,g._currentValue),g._currentValue=x;break;case 13:if(g=i.memoizedState,g!==null)return g.dehydrated!==null?(qt(nr,nr.current&1),i.flags|=128,null):(d&i.child.childLanes)!==0?Km(a,i,d):(qt(nr,nr.current&1),a=aa(a,i,d),a!==null?a.sibling:null);qt(nr,nr.current&1);break;case 19:if(g=(d&i.childLanes)!==0,(a.flags&128)!==0){if(g)return qm(a,i,d);i.flags|=128}if(x=i.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),qt(nr,nr.current),g)break;return null;case 22:case 23:return i.lanes=0,Vm(a,i,d)}return aa(a,i,d)}var Jm,U0,Ym,Qm;Jm=function(a,i){for(var d=i.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===i)break;for(;d.sibling===null;){if(d.return===null||d.return===i)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},U0=function(){},Ym=function(a,i,d,g){var x=a.memoizedProps;if(x!==g){a=i.stateNode,_i(Os.current);var S=null;switch(d){case"input":x=Fe(a,x),g=Fe(a,g),S=[];break;case"select":x=oe({},x,{value:void 0}),g=oe({},g,{value:void 0}),S=[];break;case"textarea":x=Nt(a,x),g=Nt(a,g),S=[];break;default:typeof x.onClick!="function"&&typeof g.onClick=="function"&&(a.onclick=fo)}Es(d,g);var M;d=null;for(je in x)if(!g.hasOwnProperty(je)&&x.hasOwnProperty(je)&&x[je]!=null)if(je==="style"){var de=x[je];for(M in de)de.hasOwnProperty(M)&&(d||(d={}),d[M]="")}else je!=="dangerouslySetInnerHTML"&&je!=="children"&&je!=="suppressContentEditableWarning"&&je!=="suppressHydrationWarning"&&je!=="autoFocus"&&(s.hasOwnProperty(je)?S||(S=[]):(S=S||[]).push(je,null));for(je in g){var ge=g[je];if(de=x?.[je],g.hasOwnProperty(je)&&ge!==de&&(ge!=null||de!=null))if(je==="style")if(de){for(M in de)!de.hasOwnProperty(M)||ge&&ge.hasOwnProperty(M)||(d||(d={}),d[M]="");for(M in ge)ge.hasOwnProperty(M)&&de[M]!==ge[M]&&(d||(d={}),d[M]=ge[M])}else d||(S||(S=[]),S.push(je,d)),d=ge;else je==="dangerouslySetInnerHTML"?(ge=ge?ge.__html:void 0,de=de?de.__html:void 0,ge!=null&&de!==ge&&(S=S||[]).push(je,ge)):je==="children"?typeof ge!="string"&&typeof ge!="number"||(S=S||[]).push(je,""+ge):je!=="suppressContentEditableWarning"&&je!=="suppressHydrationWarning"&&(s.hasOwnProperty(je)?(ge!=null&&je==="onScroll"&&We("scroll",a),S||de===ge||(S=[])):(S=S||[]).push(je,ge))}d&&(S=S||[]).push("style",d);var je=S;(i.updateQueue=je)&&(i.flags|=4)}},Qm=function(a,i,d,g){d!==g&&(i.flags|=4)};function Ml(a,i){if(!Zt)switch(a.tailMode){case"hidden":i=a.tail;for(var d=null;i!==null;)i.alternate!==null&&(d=i),i=i.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?i||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function Yr(a){var i=a.alternate!==null&&a.alternate.child===a.child,d=0,g=0;if(i)for(var x=a.child;x!==null;)d|=x.lanes|x.childLanes,g|=x.subtreeFlags&14680064,g|=x.flags&14680064,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)d|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=g,a.childLanes=d,i}function Q1(a,i,d){var g=i.pendingProps;switch(l0(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yr(i),null;case 1:return kn(i.type)&&tu(),Yr(i),null;case 3:return g=i.stateNode,So(),Qt(En),Qt(qr),b0(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(a===null||a.child===null)&&(iu(i)?i.flags|=4:a===null||a.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,us!==null&&(Y0(us),us=null))),U0(a,i),Yr(i),null;case 5:y0(i);var x=_i(Ol.current);if(d=i.type,a!==null&&i.stateNode!=null)Ym(a,i,d,g,x),a.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!g){if(i.stateNode===null)throw Error(e(166));return Yr(i),null}if(a=_i(Os.current),iu(i)){g=i.stateNode,d=i.type;var S=i.memoizedProps;switch(g[Is]=i,g[Cl]=S,a=(i.mode&1)!==0,d){case"dialog":We("cancel",g),We("close",g);break;case"iframe":case"object":case"embed":We("load",g);break;case"video":case"audio":for(x=0;x<me.length;x++)We(me[x],g);break;case"source":We("error",g);break;case"img":case"image":case"link":We("error",g),We("load",g);break;case"details":We("toggle",g);break;case"input":Ye(g,S),We("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!S.multiple},We("invalid",g);break;case"textarea":wt(g,S),We("invalid",g)}Es(d,S),x=null;for(var M in S)if(S.hasOwnProperty(M)){var de=S[M];M==="children"?typeof de=="string"?g.textContent!==de&&(S.suppressHydrationWarning!==!0&&Ra(g.textContent,de,a),x=["children",de]):typeof de=="number"&&g.textContent!==""+de&&(S.suppressHydrationWarning!==!0&&Ra(g.textContent,de,a),x=["children",""+de]):s.hasOwnProperty(M)&&de!=null&&M==="onScroll"&&We("scroll",g)}switch(d){case"input":se(g),Ee(g,S,!0);break;case"textarea":se(g),Wt(g);break;case"select":case"option":break;default:typeof S.onClick=="function"&&(g.onclick=fo)}g=x,i.updateQueue=g,g!==null&&(i.flags|=4)}else{M=x.nodeType===9?x:x.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Dt(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=M.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof g.is=="string"?a=M.createElement(d,{is:g.is}):(a=M.createElement(d),d==="select"&&(M=a,g.multiple?M.multiple=!0:g.size&&(M.size=g.size))):a=M.createElementNS(a,d),a[Is]=i,a[Cl]=g,Jm(a,i,!1,!1),i.stateNode=a;e:{switch(M=wr(d,g),d){case"dialog":We("cancel",a),We("close",a),x=g;break;case"iframe":case"object":case"embed":We("load",a),x=g;break;case"video":case"audio":for(x=0;x<me.length;x++)We(me[x],a);x=g;break;case"source":We("error",a),x=g;break;case"img":case"image":case"link":We("error",a),We("load",a),x=g;break;case"details":We("toggle",a),x=g;break;case"input":Ye(a,g),x=Fe(a,g),We("invalid",a);break;case"option":x=g;break;case"select":a._wrapperState={wasMultiple:!!g.multiple},x=oe({},g,{value:void 0}),We("invalid",a);break;case"textarea":wt(a,g),x=Nt(a,g),We("invalid",a);break;default:x=g}Es(d,x),de=x;for(S in de)if(de.hasOwnProperty(S)){var ge=de[S];S==="style"?dr(a,ge):S==="dangerouslySetInnerHTML"?(ge=ge?ge.__html:void 0,ge!=null&&Et(a,ge)):S==="children"?typeof ge=="string"?(d!=="textarea"||ge!=="")&&Ze(a,ge):typeof ge=="number"&&Ze(a,""+ge):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(s.hasOwnProperty(S)?ge!=null&&S==="onScroll"&&We("scroll",a):ge!=null&&j(a,S,ge,M))}switch(d){case"input":se(a),Ee(a,g,!1);break;case"textarea":se(a),Wt(a);break;case"option":g.value!=null&&a.setAttribute("value",""+fe(g.value));break;case"select":a.multiple=!!g.multiple,S=g.value,S!=null?rt(a,!!g.multiple,S,!1):g.defaultValue!=null&&rt(a,!!g.multiple,g.defaultValue,!0);break;default:typeof x.onClick=="function"&&(a.onclick=fo)}switch(d){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Yr(i),null;case 6:if(a&&i.stateNode!=null)Qm(a,i,a.memoizedProps,g);else{if(typeof g!="string"&&i.stateNode===null)throw Error(e(166));if(d=_i(Ol.current),_i(Os.current),iu(i)){if(g=i.stateNode,d=i.memoizedProps,g[Is]=i,(S=g.nodeValue!==d)&&(a=Pn,a!==null))switch(a.tag){case 3:Ra(g.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Ra(g.nodeValue,d,(a.mode&1)!==0)}S&&(i.flags|=4)}else g=(d.nodeType===9?d:d.ownerDocument).createTextNode(g),g[Is]=i,i.stateNode=g}return Yr(i),null;case 13:if(Qt(nr),g=i.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Zt&&Ln!==null&&(i.mode&1)!==0&&(i.flags&128)===0)tm(),yo(),i.flags|=98560,S=!1;else if(S=iu(i),g!==null&&g.dehydrated!==null){if(a===null){if(!S)throw Error(e(318));if(S=i.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(e(317));S[Is]=i}else yo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Yr(i),S=!1}else us!==null&&(Y0(us),us=null),S=!0;if(!S)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=d,i):(g=g!==null,g!==(a!==null&&a.memoizedState!==null)&&g&&(i.child.flags|=8192,(i.mode&1)!==0&&(a===null||(nr.current&1)!==0?Er===0&&(Er=3):ef())),i.updateQueue!==null&&(i.flags|=4),Yr(i),null);case 4:return So(),U0(a,i),a===null&&ot(i.stateNode.containerInfo),Yr(i),null;case 10:return m0(i.type._context),Yr(i),null;case 17:return kn(i.type)&&tu(),Yr(i),null;case 19:if(Qt(nr),S=i.memoizedState,S===null)return Yr(i),null;if(g=(i.flags&128)!==0,M=S.rendering,M===null)if(g)Ml(S,!1);else{if(Er!==0||a!==null&&(a.flags&128)!==0)for(a=i.child;a!==null;){if(M=fu(a),M!==null){for(i.flags|=128,Ml(S,!1),g=M.updateQueue,g!==null&&(i.updateQueue=g,i.flags|=4),i.subtreeFlags=0,g=d,d=i.child;d!==null;)S=d,a=g,S.flags&=14680066,M=S.alternate,M===null?(S.childLanes=0,S.lanes=a,S.child=null,S.subtreeFlags=0,S.memoizedProps=null,S.memoizedState=null,S.updateQueue=null,S.dependencies=null,S.stateNode=null):(S.childLanes=M.childLanes,S.lanes=M.lanes,S.child=M.child,S.subtreeFlags=0,S.deletions=null,S.memoizedProps=M.memoizedProps,S.memoizedState=M.memoizedState,S.updateQueue=M.updateQueue,S.type=M.type,a=M.dependencies,S.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return qt(nr,nr.current&1|2),i.child}a=a.sibling}S.tail!==null&&Pe()>No&&(i.flags|=128,g=!0,Ml(S,!1),i.lanes=4194304)}else{if(!g)if(a=fu(M),a!==null){if(i.flags|=128,g=!0,d=a.updateQueue,d!==null&&(i.updateQueue=d,i.flags|=4),Ml(S,!0),S.tail===null&&S.tailMode==="hidden"&&!M.alternate&&!Zt)return Yr(i),null}else 2*Pe()-S.renderingStartTime>No&&d!==1073741824&&(i.flags|=128,g=!0,Ml(S,!1),i.lanes=4194304);S.isBackwards?(M.sibling=i.child,i.child=M):(d=S.last,d!==null?d.sibling=M:i.child=M,S.last=M)}return S.tail!==null?(i=S.tail,S.rendering=i,S.tail=i.sibling,S.renderingStartTime=Pe(),i.sibling=null,d=nr.current,qt(nr,g?d&1|2:d&1),i):(Yr(i),null);case 22:case 23:return Z0(),g=i.memoizedState!==null,a!==null&&a.memoizedState!==null!==g&&(i.flags|=8192),g&&(i.mode&1)!==0?(Mn&1073741824)!==0&&(Yr(i),i.subtreeFlags&6&&(i.flags|=8192)):Yr(i),null;case 24:return null;case 25:return null}throw Error(e(156,i.tag))}function Z1(a,i){switch(l0(i),i.tag){case 1:return kn(i.type)&&tu(),a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 3:return So(),Qt(En),Qt(qr),b0(),a=i.flags,(a&65536)!==0&&(a&128)===0?(i.flags=a&-65537|128,i):null;case 5:return y0(i),null;case 13:if(Qt(nr),a=i.memoizedState,a!==null&&a.dehydrated!==null){if(i.alternate===null)throw Error(e(340));yo()}return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 19:return Qt(nr),null;case 4:return So(),null;case 10:return m0(i.type._context),null;case 22:case 23:return Z0(),null;case 24:return null;default:return null}}var bu=!1,Qr=!1,ey=typeof WeakSet=="function"?WeakSet:Set,nt=null;function ko(a,i){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(g){or(a,i,g)}else d.current=null}function B0(a,i,d){try{d()}catch(g){or(a,i,g)}}var Zm=!1;function ty(a,i){if(Tl=ls,a=Xc(),_l(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var g=d.getSelection&&d.getSelection();if(g&&g.rangeCount!==0){d=g.anchorNode;var x=g.anchorOffset,S=g.focusNode;g=g.focusOffset;try{d.nodeType,S.nodeType}catch{d=null;break e}var M=0,de=-1,ge=-1,je=0,Be=0,ze=a,Ue=null;t:for(;;){for(var et;ze!==d||x!==0&&ze.nodeType!==3||(de=M+x),ze!==S||g!==0&&ze.nodeType!==3||(ge=M+g),ze.nodeType===3&&(M+=ze.nodeValue.length),(et=ze.firstChild)!==null;)Ue=ze,ze=et;for(;;){if(ze===a)break t;if(Ue===d&&++je===x&&(de=M),Ue===S&&++Be===g&&(ge=M),(et=ze.nextSibling)!==null)break;ze=Ue,Ue=ze.parentNode}ze=et}d=de===-1||ge===-1?null:{start:de,end:ge}}else d=null}d=d||{start:0,end:0}}else d=null;for(Nl={focusedElem:a,selectionRange:d},ls=!1,nt=i;nt!==null;)if(i=nt,a=i.child,(i.subtreeFlags&1028)!==0&&a!==null)a.return=i,nt=a;else for(;nt!==null;){i=nt;try{var st=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(st!==null){var at=st.memoizedProps,hr=st.memoizedState,be=i.stateNode,xe=be.getSnapshotBeforeUpdate(i.elementType===i.type?at:ds(i.type,at),hr);be.__reactInternalSnapshotBeforeUpdate=xe}break;case 3:var Se=i.stateNode.containerInfo;Se.nodeType===1?Se.textContent="":Se.nodeType===9&&Se.documentElement&&Se.removeChild(Se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(e(163))}}catch(Ge){or(i,i.return,Ge)}if(a=i.sibling,a!==null){a.return=i.return,nt=a;break}nt=i.return}return st=Zm,Zm=!1,st}function $l(a,i,d){var g=i.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var x=g=g.next;do{if((x.tag&a)===a){var S=x.destroy;x.destroy=void 0,S!==void 0&&B0(i,d,S)}x=x.next}while(x!==g)}}function _u(a,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var d=i=i.next;do{if((d.tag&a)===a){var g=d.create;d.destroy=g()}d=d.next}while(d!==i)}}function V0(a){var i=a.ref;if(i!==null){var d=a.stateNode;switch(a.tag){case 5:a=d;break;default:a=d}typeof i=="function"?i(a):i.current=a}}function eg(a){var i=a.alternate;i!==null&&(a.alternate=null,eg(i)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(i=a.stateNode,i!==null&&(delete i[Is],delete i[Cl],delete i[s0],delete i[L1],delete i[M1])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function tg(a){return a.tag===5||a.tag===3||a.tag===4}function rg(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||tg(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function W0(a,i,d){var g=a.tag;if(g===5||g===6)a=a.stateNode,i?d.nodeType===8?d.parentNode.insertBefore(a,i):d.insertBefore(a,i):(d.nodeType===8?(i=d.parentNode,i.insertBefore(a,d)):(i=d,i.appendChild(a)),d=d._reactRootContainer,d!=null||i.onclick!==null||(i.onclick=fo));else if(g!==4&&(a=a.child,a!==null))for(W0(a,i,d),a=a.sibling;a!==null;)W0(a,i,d),a=a.sibling}function H0(a,i,d){var g=a.tag;if(g===5||g===6)a=a.stateNode,i?d.insertBefore(a,i):d.appendChild(a);else if(g!==4&&(a=a.child,a!==null))for(H0(a,i,d),a=a.sibling;a!==null;)H0(a,i,d),a=a.sibling}var Vr=null,fs=!1;function Ma(a,i,d){for(d=d.child;d!==null;)ng(a,i,d),d=d.sibling}function ng(a,i,d){if(fr&&typeof fr.onCommitFiberUnmount=="function")try{fr.onCommitFiberUnmount(un,d)}catch{}switch(d.tag){case 5:Qr||ko(d,i);case 6:var g=Vr,x=fs;Vr=null,Ma(a,i,d),Vr=g,fs=x,Vr!==null&&(fs?(a=Vr,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):Vr.removeChild(d.stateNode));break;case 18:Vr!==null&&(fs?(a=Vr,d=d.stateNode,a.nodeType===8?n0(a.parentNode,d):a.nodeType===1&&n0(a,d),ba(a)):n0(Vr,d.stateNode));break;case 4:g=Vr,x=fs,Vr=d.stateNode.containerInfo,fs=!0,Ma(a,i,d),Vr=g,fs=x;break;case 0:case 11:case 14:case 15:if(!Qr&&(g=d.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){x=g=g.next;do{var S=x,M=S.destroy;S=S.tag,M!==void 0&&((S&2)!==0||(S&4)!==0)&&B0(d,i,M),x=x.next}while(x!==g)}Ma(a,i,d);break;case 1:if(!Qr&&(ko(d,i),g=d.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=d.memoizedProps,g.state=d.memoizedState,g.componentWillUnmount()}catch(de){or(d,i,de)}Ma(a,i,d);break;case 21:Ma(a,i,d);break;case 22:d.mode&1?(Qr=(g=Qr)||d.memoizedState!==null,Ma(a,i,d),Qr=g):Ma(a,i,d);break;default:Ma(a,i,d)}}function sg(a){var i=a.updateQueue;if(i!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new ey),i.forEach(function(g){var x=uy.bind(null,a,g);d.has(g)||(d.add(g),g.then(x,x))})}}function hs(a,i){var d=i.deletions;if(d!==null)for(var g=0;g<d.length;g++){var x=d[g];try{var S=a,M=i,de=M;e:for(;de!==null;){switch(de.tag){case 5:Vr=de.stateNode,fs=!1;break e;case 3:Vr=de.stateNode.containerInfo,fs=!0;break e;case 4:Vr=de.stateNode.containerInfo,fs=!0;break e}de=de.return}if(Vr===null)throw Error(e(160));ng(S,M,x),Vr=null,fs=!1;var ge=x.alternate;ge!==null&&(ge.return=null),x.return=null}catch(je){or(x,i,je)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)ag(i,a),i=i.sibling}function ag(a,i){var d=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(hs(i,a),Fs(a),g&4){try{$l(3,a,a.return),_u(3,a)}catch(at){or(a,a.return,at)}try{$l(5,a,a.return)}catch(at){or(a,a.return,at)}}break;case 1:hs(i,a),Fs(a),g&512&&d!==null&&ko(d,d.return);break;case 5:if(hs(i,a),Fs(a),g&512&&d!==null&&ko(d,d.return),a.flags&32){var x=a.stateNode;try{Ze(x,"")}catch(at){or(a,a.return,at)}}if(g&4&&(x=a.stateNode,x!=null)){var S=a.memoizedProps,M=d!==null?d.memoizedProps:S,de=a.type,ge=a.updateQueue;if(a.updateQueue=null,ge!==null)try{de==="input"&&S.type==="radio"&&S.name!=null&&tt(x,S),wr(de,M);var je=wr(de,S);for(M=0;M<ge.length;M+=2){var Be=ge[M],ze=ge[M+1];Be==="style"?dr(x,ze):Be==="dangerouslySetInnerHTML"?Et(x,ze):Be==="children"?Ze(x,ze):j(x,Be,ze,je)}switch(de){case"input":Ve(x,S);break;case"textarea":ft(x,S);break;case"select":var Ue=x._wrapperState.wasMultiple;x._wrapperState.wasMultiple=!!S.multiple;var et=S.value;et!=null?rt(x,!!S.multiple,et,!1):Ue!==!!S.multiple&&(S.defaultValue!=null?rt(x,!!S.multiple,S.defaultValue,!0):rt(x,!!S.multiple,S.multiple?[]:"",!1))}x[Cl]=S}catch(at){or(a,a.return,at)}}break;case 6:if(hs(i,a),Fs(a),g&4){if(a.stateNode===null)throw Error(e(162));x=a.stateNode,S=a.memoizedProps;try{x.nodeValue=S}catch(at){or(a,a.return,at)}}break;case 3:if(hs(i,a),Fs(a),g&4&&d!==null&&d.memoizedState.isDehydrated)try{ba(i.containerInfo)}catch(at){or(a,a.return,at)}break;case 4:hs(i,a),Fs(a);break;case 13:hs(i,a),Fs(a),x=a.child,x.flags&8192&&(S=x.memoizedState!==null,x.stateNode.isHidden=S,!S||x.alternate!==null&&x.alternate.memoizedState!==null||(K0=Pe())),g&4&&sg(a);break;case 22:if(Be=d!==null&&d.memoizedState!==null,a.mode&1?(Qr=(je=Qr)||Be,hs(i,a),Qr=je):hs(i,a),Fs(a),g&8192){if(je=a.memoizedState!==null,(a.stateNode.isHidden=je)&&!Be&&(a.mode&1)!==0)for(nt=a,Be=a.child;Be!==null;){for(ze=nt=Be;nt!==null;){switch(Ue=nt,et=Ue.child,Ue.tag){case 0:case 11:case 14:case 15:$l(4,Ue,Ue.return);break;case 1:ko(Ue,Ue.return);var st=Ue.stateNode;if(typeof st.componentWillUnmount=="function"){g=Ue,d=Ue.return;try{i=g,st.props=i.memoizedProps,st.state=i.memoizedState,st.componentWillUnmount()}catch(at){or(g,d,at)}}break;case 5:ko(Ue,Ue.return);break;case 22:if(Ue.memoizedState!==null){lg(ze);continue}}et!==null?(et.return=Ue,nt=et):lg(ze)}Be=Be.sibling}e:for(Be=null,ze=a;;){if(ze.tag===5){if(Be===null){Be=ze;try{x=ze.stateNode,je?(S=x.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none"):(de=ze.stateNode,ge=ze.memoizedProps.style,M=ge!=null&&ge.hasOwnProperty("display")?ge.display:null,de.style.display=kt("display",M))}catch(at){or(a,a.return,at)}}}else if(ze.tag===6){if(Be===null)try{ze.stateNode.nodeValue=je?"":ze.memoizedProps}catch(at){or(a,a.return,at)}}else if((ze.tag!==22&&ze.tag!==23||ze.memoizedState===null||ze===a)&&ze.child!==null){ze.child.return=ze,ze=ze.child;continue}if(ze===a)break e;for(;ze.sibling===null;){if(ze.return===null||ze.return===a)break e;Be===ze&&(Be=null),ze=ze.return}Be===ze&&(Be=null),ze.sibling.return=ze.return,ze=ze.sibling}}break;case 19:hs(i,a),Fs(a),g&4&&sg(a);break;case 21:break;default:hs(i,a),Fs(a)}}function Fs(a){var i=a.flags;if(i&2){try{e:{for(var d=a.return;d!==null;){if(tg(d)){var g=d;break e}d=d.return}throw Error(e(160))}switch(g.tag){case 5:var x=g.stateNode;g.flags&32&&(Ze(x,""),g.flags&=-33);var S=rg(a);H0(a,S,x);break;case 3:case 4:var M=g.stateNode.containerInfo,de=rg(a);W0(a,de,M);break;default:throw Error(e(161))}}catch(ge){or(a,a.return,ge)}a.flags&=-3}i&4096&&(a.flags&=-4097)}function ry(a,i,d){nt=a,ig(a)}function ig(a,i,d){for(var g=(a.mode&1)!==0;nt!==null;){var x=nt,S=x.child;if(x.tag===22&&g){var M=x.memoizedState!==null||bu;if(!M){var de=x.alternate,ge=de!==null&&de.memoizedState!==null||Qr;de=bu;var je=Qr;if(bu=M,(Qr=ge)&&!je)for(nt=x;nt!==null;)M=nt,ge=M.child,M.tag===22&&M.memoizedState!==null?cg(x):ge!==null?(ge.return=M,nt=ge):cg(x);for(;S!==null;)nt=S,ig(S),S=S.sibling;nt=x,bu=de,Qr=je}og(a)}else(x.subtreeFlags&8772)!==0&&S!==null?(S.return=x,nt=S):og(a)}}function og(a){for(;nt!==null;){var i=nt;if((i.flags&8772)!==0){var d=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Qr||_u(5,i);break;case 1:var g=i.stateNode;if(i.flags&4&&!Qr)if(d===null)g.componentDidMount();else{var x=i.elementType===i.type?d.memoizedProps:ds(i.type,d.memoizedProps);g.componentDidUpdate(x,d.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var S=i.updateQueue;S!==null&&lm(i,S,g);break;case 3:var M=i.updateQueue;if(M!==null){if(d=null,i.child!==null)switch(i.child.tag){case 5:d=i.child.stateNode;break;case 1:d=i.child.stateNode}lm(i,M,d)}break;case 5:var de=i.stateNode;if(d===null&&i.flags&4){d=de;var ge=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":ge.autoFocus&&d.focus();break;case"img":ge.src&&(d.src=ge.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var je=i.alternate;if(je!==null){var Be=je.memoizedState;if(Be!==null){var ze=Be.dehydrated;ze!==null&&ba(ze)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(e(163))}Qr||i.flags&512&&V0(i)}catch(Ue){or(i,i.return,Ue)}}if(i===a){nt=null;break}if(d=i.sibling,d!==null){d.return=i.return,nt=d;break}nt=i.return}}function lg(a){for(;nt!==null;){var i=nt;if(i===a){nt=null;break}var d=i.sibling;if(d!==null){d.return=i.return,nt=d;break}nt=i.return}}function cg(a){for(;nt!==null;){var i=nt;try{switch(i.tag){case 0:case 11:case 15:var d=i.return;try{_u(4,i)}catch(ge){or(i,d,ge)}break;case 1:var g=i.stateNode;if(typeof g.componentDidMount=="function"){var x=i.return;try{g.componentDidMount()}catch(ge){or(i,x,ge)}}var S=i.return;try{V0(i)}catch(ge){or(i,S,ge)}break;case 5:var M=i.return;try{V0(i)}catch(ge){or(i,M,ge)}}}catch(ge){or(i,i.return,ge)}if(i===a){nt=null;break}var de=i.sibling;if(de!==null){de.return=i.return,nt=de;break}nt=i.return}}var ny=Math.ceil,Su=F.ReactCurrentDispatcher,z0=F.ReactCurrentOwner,Qn=F.ReactCurrentBatchConfig,Pt=0,Dr=null,pr=null,Wr=0,Mn=0,To=Oa(0),Er=0,Ul=null,Ei=0,Eu=0,G0=0,Bl=null,Nn=null,K0=0,No=1/0,ia=null,ku=!1,X0=null,$a=null,Tu=!1,Ua=null,Nu=0,Vl=0,q0=null,Cu=-1,ju=0;function hn(){return(Pt&6)!==0?Pe():Cu!==-1?Cu:Cu=Pe()}function Ba(a){return(a.mode&1)===0?1:(Pt&2)!==0&&Wr!==0?Wr&-Wr:U1.transition!==null?(ju===0&&(ju=al()),ju):(a=Tt,a!==0||(a=window.event,a=a===void 0?16:Zi(a.type)),a)}function ms(a,i,d,g){if(50<Vl)throw Vl=0,q0=null,Error(e(185));Hs(a,d,g),((Pt&2)===0||a!==Dr)&&(a===Dr&&((Pt&2)===0&&(Eu|=d),Er===4&&Va(a,Wr)),Cn(a,g),d===1&&Pt===0&&(i.mode&1)===0&&(No=Pe()+500,nu&&Fa()))}function Cn(a,i){var d=a.callbackNode;Ic(a,i);var g=ya(a,a===Dr?Wr:0);if(g===0)d!==null&&Ke(d),a.callbackNode=null,a.callbackPriority=0;else if(i=g&-g,a.callbackPriority!==i){if(d!=null&&Ke(d),i===1)a.tag===0?$1(dg.bind(null,a)):Jh(dg.bind(null,a)),F1(function(){(Pt&6)===0&&Fa()}),d=null;else{switch(il(g)){case 1:d=Bt;break;case 4:d=Gt;break;case 16:d=tr;break;case 536870912:d=Kr;break;default:d=tr}d=yg(d,ug.bind(null,a))}a.callbackPriority=i,a.callbackNode=d}}function ug(a,i){if(Cu=-1,ju=0,(Pt&6)!==0)throw Error(e(327));var d=a.callbackNode;if(Co()&&a.callbackNode!==d)return null;var g=ya(a,a===Dr?Wr:0);if(g===0)return null;if((g&30)!==0||(g&a.expiredLanes)!==0||i)i=Au(a,g);else{i=g;var x=Pt;Pt|=2;var S=hg();(Dr!==a||Wr!==i)&&(ia=null,No=Pe()+500,Ti(a,i));do try{iy();break}catch(de){fg(a,de)}while(!0);h0(),Su.current=S,Pt=x,pr!==null?i=0:(Dr=null,Wr=0,i=Er)}if(i!==0){if(i===2&&(x=Ji(a),x!==0&&(g=x,i=J0(a,x))),i===1)throw d=Ul,Ti(a,0),Va(a,g),Cn(a,Pe()),d;if(i===6)Va(a,g);else{if(x=a.current.alternate,(g&30)===0&&!sy(x)&&(i=Au(a,g),i===2&&(S=Ji(a),S!==0&&(g=S,i=J0(a,S))),i===1))throw d=Ul,Ti(a,0),Va(a,g),Cn(a,Pe()),d;switch(a.finishedWork=x,a.finishedLanes=g,i){case 0:case 1:throw Error(e(345));case 2:Ni(a,Nn,ia);break;case 3:if(Va(a,g),(g&130023424)===g&&(i=K0+500-Pe(),10<i)){if(ya(a,0)!==0)break;if(x=a.suspendedLanes,(x&g)!==g){hn(),a.pingedLanes|=a.suspendedLanes&x;break}a.timeoutHandle=r0(Ni.bind(null,a,Nn,ia),i);break}Ni(a,Nn,ia);break;case 4:if(Va(a,g),(g&4194240)===g)break;for(i=a.eventTimes,x=-1;0<g;){var M=31-rr(g);S=1<<M,M=i[M],M>x&&(x=M),g&=~S}if(g=x,g=Pe()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*ny(g/1960))-g,10<g){a.timeoutHandle=r0(Ni.bind(null,a,Nn,ia),g);break}Ni(a,Nn,ia);break;case 5:Ni(a,Nn,ia);break;default:throw Error(e(329))}}}return Cn(a,Pe()),a.callbackNode===d?ug.bind(null,a):null}function J0(a,i){var d=Bl;return a.current.memoizedState.isDehydrated&&(Ti(a,i).flags|=256),a=Au(a,i),a!==2&&(i=Nn,Nn=d,i!==null&&Y0(i)),a}function Y0(a){Nn===null?Nn=a:Nn.push.apply(Nn,a)}function sy(a){for(var i=a;;){if(i.flags&16384){var d=i.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var g=0;g<d.length;g++){var x=d[g],S=x.getSnapshot;x=x.value;try{if(!Dn(S(),x))return!1}catch{return!1}}}if(d=i.child,i.subtreeFlags&16384&&d!==null)d.return=i,i=d;else{if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Va(a,i){for(i&=~G0,i&=~Eu,a.suspendedLanes|=i,a.pingedLanes&=~i,a=a.expirationTimes;0<i;){var d=31-rr(i),g=1<<d;a[d]=-1,i&=~g}}function dg(a){if((Pt&6)!==0)throw Error(e(327));Co();var i=ya(a,0);if((i&1)===0)return Cn(a,Pe()),null;var d=Au(a,i);if(a.tag!==0&&d===2){var g=Ji(a);g!==0&&(i=g,d=J0(a,g))}if(d===1)throw d=Ul,Ti(a,0),Va(a,i),Cn(a,Pe()),d;if(d===6)throw Error(e(345));return a.finishedWork=a.current.alternate,a.finishedLanes=i,Ni(a,Nn,ia),Cn(a,Pe()),null}function Q0(a,i){var d=Pt;Pt|=1;try{return a(i)}finally{Pt=d,Pt===0&&(No=Pe()+500,nu&&Fa())}}function ki(a){Ua!==null&&Ua.tag===0&&(Pt&6)===0&&Co();var i=Pt;Pt|=1;var d=Qn.transition,g=Tt;try{if(Qn.transition=null,Tt=1,a)return a()}finally{Tt=g,Qn.transition=d,Pt=i,(Pt&6)===0&&Fa()}}function Z0(){Mn=To.current,Qt(To)}function Ti(a,i){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,D1(d)),pr!==null)for(d=pr.return;d!==null;){var g=d;switch(l0(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&tu();break;case 3:So(),Qt(En),Qt(qr),b0();break;case 5:y0(g);break;case 4:So();break;case 13:Qt(nr);break;case 19:Qt(nr);break;case 10:m0(g.type._context);break;case 22:case 23:Z0()}d=d.return}if(Dr=a,pr=a=Wa(a.current,null),Wr=Mn=i,Er=0,Ul=null,G0=Eu=Ei=0,Nn=Bl=null,bi!==null){for(i=0;i<bi.length;i++)if(d=bi[i],g=d.interleaved,g!==null){d.interleaved=null;var x=g.next,S=d.pending;if(S!==null){var M=S.next;S.next=x,g.next=M}d.pending=g}bi=null}return a}function fg(a,i){do{var d=pr;try{if(h0(),hu.current=xu,mu){for(var g=sr.memoizedState;g!==null;){var x=g.queue;x!==null&&(x.pending=null),g=g.next}mu=!1}if(Si=0,Or=Sr=sr=null,Dl=!1,Fl=0,z0.current=null,d===null||d.return===null){Er=1,Ul=i,pr=null;break}e:{var S=a,M=d.return,de=d,ge=i;if(i=Wr,de.flags|=32768,ge!==null&&typeof ge=="object"&&typeof ge.then=="function"){var je=ge,Be=de,ze=Be.tag;if((Be.mode&1)===0&&(ze===0||ze===11||ze===15)){var Ue=Be.alternate;Ue?(Be.updateQueue=Ue.updateQueue,Be.memoizedState=Ue.memoizedState,Be.lanes=Ue.lanes):(Be.updateQueue=null,Be.memoizedState=null)}var et=Lm(M);if(et!==null){et.flags&=-257,Mm(et,M,de,S,i),et.mode&1&&Pm(S,je,i),i=et,ge=je;var st=i.updateQueue;if(st===null){var at=new Set;at.add(ge),i.updateQueue=at}else st.add(ge);break e}else{if((i&1)===0){Pm(S,je,i),ef();break e}ge=Error(e(426))}}else if(Zt&&de.mode&1){var hr=Lm(M);if(hr!==null){(hr.flags&65536)===0&&(hr.flags|=256),Mm(hr,M,de,S,i),d0(Eo(ge,de));break e}}S=ge=Eo(ge,de),Er!==4&&(Er=2),Bl===null?Bl=[S]:Bl.push(S),S=M;do{switch(S.tag){case 3:S.flags|=65536,i&=-i,S.lanes|=i;var be=Dm(S,ge,i);om(S,be);break e;case 1:de=ge;var xe=S.type,Se=S.stateNode;if((S.flags&128)===0&&(typeof xe.getDerivedStateFromError=="function"||Se!==null&&typeof Se.componentDidCatch=="function"&&($a===null||!$a.has(Se)))){S.flags|=65536,i&=-i,S.lanes|=i;var Ge=Fm(S,de,i);om(S,Ge);break e}}S=S.return}while(S!==null)}gg(d)}catch(it){i=it,pr===d&&d!==null&&(pr=d=d.return);continue}break}while(!0)}function hg(){var a=Su.current;return Su.current=xu,a===null?xu:a}function ef(){(Er===0||Er===3||Er===2)&&(Er=4),Dr===null||(Ei&268435455)===0&&(Eu&268435455)===0||Va(Dr,Wr)}function Au(a,i){var d=Pt;Pt|=2;var g=hg();(Dr!==a||Wr!==i)&&(ia=null,Ti(a,i));do try{ay();break}catch(x){fg(a,x)}while(!0);if(h0(),Pt=d,Su.current=g,pr!==null)throw Error(e(261));return Dr=null,Wr=0,Er}function ay(){for(;pr!==null;)mg(pr)}function iy(){for(;pr!==null&&!Qe();)mg(pr)}function mg(a){var i=vg(a.alternate,a,Mn);a.memoizedProps=a.pendingProps,i===null?gg(a):pr=i,z0.current=null}function gg(a){var i=a;do{var d=i.alternate;if(a=i.return,(i.flags&32768)===0){if(d=Q1(d,i,Mn),d!==null){pr=d;return}}else{if(d=Z1(d,i),d!==null){d.flags&=32767,pr=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Er=6,pr=null;return}}if(i=i.sibling,i!==null){pr=i;return}pr=i=a}while(i!==null);Er===0&&(Er=5)}function Ni(a,i,d){var g=Tt,x=Qn.transition;try{Qn.transition=null,Tt=1,oy(a,i,d,g)}finally{Qn.transition=x,Tt=g}return null}function oy(a,i,d,g){do Co();while(Ua!==null);if((Pt&6)!==0)throw Error(e(327));d=a.finishedWork;var x=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(e(177));a.callbackNode=null,a.callbackPriority=0;var S=d.lanes|d.childLanes;if(Rd(a,S),a===Dr&&(pr=Dr=null,Wr=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Tu||(Tu=!0,yg(tr,function(){return Co(),null})),S=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||S){S=Qn.transition,Qn.transition=null;var M=Tt;Tt=1;var de=Pt;Pt|=4,z0.current=null,ty(a,d),ag(d,a),Yd(Nl),ls=!!Tl,Nl=Tl=null,a.current=d,ry(d),$e(),Pt=de,Tt=M,Qn.transition=S}else a.current=d;if(Tu&&(Tu=!1,Ua=a,Nu=x),S=a.pendingLanes,S===0&&($a=null),va(d.stateNode),Cn(a,Pe()),i!==null)for(g=a.onRecoverableError,d=0;d<i.length;d++)x=i[d],g(x.value,{componentStack:x.stack,digest:x.digest});if(ku)throw ku=!1,a=X0,X0=null,a;return(Nu&1)!==0&&a.tag!==0&&Co(),S=a.pendingLanes,(S&1)!==0?a===q0?Vl++:(Vl=0,q0=a):Vl=0,Fa(),null}function Co(){if(Ua!==null){var a=il(Nu),i=Qn.transition,d=Tt;try{if(Qn.transition=null,Tt=16>a?16:a,Ua===null)var g=!1;else{if(a=Ua,Ua=null,Nu=0,(Pt&6)!==0)throw Error(e(331));var x=Pt;for(Pt|=4,nt=a.current;nt!==null;){var S=nt,M=S.child;if((nt.flags&16)!==0){var de=S.deletions;if(de!==null){for(var ge=0;ge<de.length;ge++){var je=de[ge];for(nt=je;nt!==null;){var Be=nt;switch(Be.tag){case 0:case 11:case 15:$l(8,Be,S)}var ze=Be.child;if(ze!==null)ze.return=Be,nt=ze;else for(;nt!==null;){Be=nt;var Ue=Be.sibling,et=Be.return;if(eg(Be),Be===je){nt=null;break}if(Ue!==null){Ue.return=et,nt=Ue;break}nt=et}}}var st=S.alternate;if(st!==null){var at=st.child;if(at!==null){st.child=null;do{var hr=at.sibling;at.sibling=null,at=hr}while(at!==null)}}nt=S}}if((S.subtreeFlags&2064)!==0&&M!==null)M.return=S,nt=M;else e:for(;nt!==null;){if(S=nt,(S.flags&2048)!==0)switch(S.tag){case 0:case 11:case 15:$l(9,S,S.return)}var be=S.sibling;if(be!==null){be.return=S.return,nt=be;break e}nt=S.return}}var xe=a.current;for(nt=xe;nt!==null;){M=nt;var Se=M.child;if((M.subtreeFlags&2064)!==0&&Se!==null)Se.return=M,nt=Se;else e:for(M=xe;nt!==null;){if(de=nt,(de.flags&2048)!==0)try{switch(de.tag){case 0:case 11:case 15:_u(9,de)}}catch(it){or(de,de.return,it)}if(de===M){nt=null;break e}var Ge=de.sibling;if(Ge!==null){Ge.return=de.return,nt=Ge;break e}nt=de.return}}if(Pt=x,Fa(),fr&&typeof fr.onPostCommitFiberRoot=="function")try{fr.onPostCommitFiberRoot(un,a)}catch{}g=!0}return g}finally{Tt=d,Qn.transition=i}}return!1}function pg(a,i,d){i=Eo(d,i),i=Dm(a,i,1),a=La(a,i,1),i=hn(),a!==null&&(Hs(a,1,i),Cn(a,i))}function or(a,i,d){if(a.tag===3)pg(a,a,d);else for(;i!==null;){if(i.tag===3){pg(i,a,d);break}else if(i.tag===1){var g=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&($a===null||!$a.has(g))){a=Eo(d,a),a=Fm(i,a,1),i=La(i,a,1),a=hn(),i!==null&&(Hs(i,1,a),Cn(i,a));break}}i=i.return}}function ly(a,i,d){var g=a.pingCache;g!==null&&g.delete(i),i=hn(),a.pingedLanes|=a.suspendedLanes&d,Dr===a&&(Wr&d)===d&&(Er===4||Er===3&&(Wr&130023424)===Wr&&500>Pe()-K0?Ti(a,0):G0|=d),Cn(a,i)}function xg(a,i){i===0&&((a.mode&1)===0?i=1:(i=ii,ii<<=1,(ii&130023424)===0&&(ii=4194304)));var d=hn();a=na(a,i),a!==null&&(Hs(a,i,d),Cn(a,d))}function cy(a){var i=a.memoizedState,d=0;i!==null&&(d=i.retryLane),xg(a,d)}function uy(a,i){var d=0;switch(a.tag){case 13:var g=a.stateNode,x=a.memoizedState;x!==null&&(d=x.retryLane);break;case 19:g=a.stateNode;break;default:throw Error(e(314))}g!==null&&g.delete(i),xg(a,d)}var vg;vg=function(a,i,d){if(a!==null)if(a.memoizedProps!==i.pendingProps||En.current)Tn=!0;else{if((a.lanes&d)===0&&(i.flags&128)===0)return Tn=!1,Y1(a,i,d);Tn=(a.flags&131072)!==0}else Tn=!1,Zt&&(i.flags&1048576)!==0&&Yh(i,au,i.index);switch(i.lanes=0,i.tag){case 2:var g=i.type;wu(a,i),a=i.pendingProps;var x=po(i,qr.current);_o(i,d),x=E0(null,i,g,a,x,d);var S=k0();return i.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,kn(g)?(S=!0,ru(i)):S=!1,i.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x0(i),x.updater=vu,i.stateNode=x,x._reactInternals=i,R0(i,g,a,d),i=F0(null,i,g,!0,S,d)):(i.tag=0,Zt&&S&&o0(i),fn(null,i,x,d),i=i.child),i;case 16:g=i.elementType;e:{switch(wu(a,i),a=i.pendingProps,x=g._init,g=x(g._payload),i.type=g,x=i.tag=fy(g),a=ds(g,a),x){case 0:i=D0(null,i,g,a,d);break e;case 1:i=Hm(null,i,g,a,d);break e;case 11:i=$m(null,i,g,a,d);break e;case 14:i=Um(null,i,g,ds(g.type,a),d);break e}throw Error(e(306,g,""))}return i;case 0:return g=i.type,x=i.pendingProps,x=i.elementType===g?x:ds(g,x),D0(a,i,g,x,d);case 1:return g=i.type,x=i.pendingProps,x=i.elementType===g?x:ds(g,x),Hm(a,i,g,x,d);case 3:e:{if(zm(i),a===null)throw Error(e(387));g=i.pendingProps,S=i.memoizedState,x=S.element,im(a,i),du(i,g,null,d);var M=i.memoizedState;if(g=M.element,S.isDehydrated)if(S={element:g,isDehydrated:!1,cache:M.cache,pendingSuspenseBoundaries:M.pendingSuspenseBoundaries,transitions:M.transitions},i.updateQueue.baseState=S,i.memoizedState=S,i.flags&256){x=Eo(Error(e(423)),i),i=Gm(a,i,g,d,x);break e}else if(g!==x){x=Eo(Error(e(424)),i),i=Gm(a,i,g,d,x);break e}else for(Ln=Ia(i.stateNode.containerInfo.firstChild),Pn=i,Zt=!0,us=null,d=sm(i,null,g,d),i.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(yo(),g===x){i=aa(a,i,d);break e}fn(a,i,g,d)}i=i.child}return i;case 5:return cm(i),a===null&&u0(i),g=i.type,x=i.pendingProps,S=a!==null?a.memoizedProps:null,M=x.children,t0(g,x)?M=null:S!==null&&t0(g,S)&&(i.flags|=32),Wm(a,i),fn(a,i,M,d),i.child;case 6:return a===null&&u0(i),null;case 13:return Km(a,i,d);case 4:return v0(i,i.stateNode.containerInfo),g=i.pendingProps,a===null?i.child=wo(i,null,g,d):fn(a,i,g,d),i.child;case 11:return g=i.type,x=i.pendingProps,x=i.elementType===g?x:ds(g,x),$m(a,i,g,x,d);case 7:return fn(a,i,i.pendingProps,d),i.child;case 8:return fn(a,i,i.pendingProps.children,d),i.child;case 12:return fn(a,i,i.pendingProps.children,d),i.child;case 10:e:{if(g=i.type._context,x=i.pendingProps,S=i.memoizedProps,M=x.value,qt(lu,g._currentValue),g._currentValue=M,S!==null)if(Dn(S.value,M)){if(S.children===x.children&&!En.current){i=aa(a,i,d);break e}}else for(S=i.child,S!==null&&(S.return=i);S!==null;){var de=S.dependencies;if(de!==null){M=S.child;for(var ge=de.firstContext;ge!==null;){if(ge.context===g){if(S.tag===1){ge=sa(-1,d&-d),ge.tag=2;var je=S.updateQueue;if(je!==null){je=je.shared;var Be=je.pending;Be===null?ge.next=ge:(ge.next=Be.next,Be.next=ge),je.pending=ge}}S.lanes|=d,ge=S.alternate,ge!==null&&(ge.lanes|=d),g0(S.return,d,i),de.lanes|=d;break}ge=ge.next}}else if(S.tag===10)M=S.type===i.type?null:S.child;else if(S.tag===18){if(M=S.return,M===null)throw Error(e(341));M.lanes|=d,de=M.alternate,de!==null&&(de.lanes|=d),g0(M,d,i),M=S.sibling}else M=S.child;if(M!==null)M.return=S;else for(M=S;M!==null;){if(M===i){M=null;break}if(S=M.sibling,S!==null){S.return=M.return,M=S;break}M=M.return}S=M}fn(a,i,x.children,d),i=i.child}return i;case 9:return x=i.type,g=i.pendingProps.children,_o(i,d),x=Jn(x),g=g(x),i.flags|=1,fn(a,i,g,d),i.child;case 14:return g=i.type,x=ds(g,i.pendingProps),x=ds(g.type,x),Um(a,i,g,x,d);case 15:return Bm(a,i,i.type,i.pendingProps,d);case 17:return g=i.type,x=i.pendingProps,x=i.elementType===g?x:ds(g,x),wu(a,i),i.tag=1,kn(g)?(a=!0,ru(i)):a=!1,_o(i,d),Im(i,g,x),R0(i,g,x,d),F0(null,i,g,!0,a,d);case 19:return qm(a,i,d);case 22:return Vm(a,i,d)}throw Error(e(156,i.tag))};function yg(a,i){return He(a,i)}function dy(a,i,d,g){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zn(a,i,d,g){return new dy(a,i,d,g)}function tf(a){return a=a.prototype,!(!a||!a.isReactComponent)}function fy(a){if(typeof a=="function")return tf(a)?1:0;if(a!=null){if(a=a.$$typeof,a===U)return 11;if(a===we)return 14}return 2}function Wa(a,i){var d=a.alternate;return d===null?(d=Zn(a.tag,i,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=i,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,i=a.dependencies,d.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function Ru(a,i,d,g,x,S){var M=2;if(g=a,typeof a=="function")tf(a)&&(M=1);else if(typeof a=="string")M=5;else e:switch(a){case V:return Ci(d.children,x,S,i);case ee:M=8,x|=8;break;case T:return a=Zn(12,d,i,x|2),a.elementType=T,a.lanes=S,a;case X:return a=Zn(13,d,i,x),a.elementType=X,a.lanes=S,a;case ve:return a=Zn(19,d,i,x),a.elementType=ve,a.lanes=S,a;case he:return Iu(d,x,S,i);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case O:M=10;break e;case H:M=9;break e;case U:M=11;break e;case we:M=14;break e;case Ne:M=16,g=null;break e}throw Error(e(130,a==null?a:typeof a,""))}return i=Zn(M,d,i,x),i.elementType=a,i.type=g,i.lanes=S,i}function Ci(a,i,d,g){return a=Zn(7,a,g,i),a.lanes=d,a}function Iu(a,i,d,g){return a=Zn(22,a,g,i),a.elementType=he,a.lanes=d,a.stateNode={isHidden:!1},a}function rf(a,i,d){return a=Zn(6,a,null,i),a.lanes=d,a}function nf(a,i,d){return i=Zn(4,a.children!==null?a.children:[],a.key,i),i.lanes=d,i.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},i}function hy(a,i,d,g,x){this.tag=i,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Oc(0),this.expirationTimes=Oc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oc(0),this.identifierPrefix=g,this.onRecoverableError=x,this.mutableSourceEagerHydrationData=null}function sf(a,i,d,g,x,S,M,de,ge){return a=new hy(a,i,d,de,ge),i===1?(i=1,S===!0&&(i|=8)):i=0,S=Zn(3,null,null,i),a.current=S,S.stateNode=a,S.memoizedState={element:g,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},x0(S),a}function my(a,i,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:g==null?null:""+g,children:a,containerInfo:i,implementation:d}}function wg(a){if(!a)return Da;a=a._reactInternals;e:{if(ie(a)!==a||a.tag!==1)throw Error(e(170));var i=a;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(kn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(e(171))}if(a.tag===1){var d=a.type;if(kn(d))return Xh(a,d,i)}return i}function bg(a,i,d,g,x,S,M,de,ge){return a=sf(d,g,!0,a,x,S,M,de,ge),a.context=wg(null),d=a.current,g=hn(),x=Ba(d),S=sa(g,x),S.callback=i??null,La(d,S,x),a.current.lanes=x,Hs(a,x,g),Cn(a,g),a}function Ou(a,i,d,g){var x=i.current,S=hn(),M=Ba(x);return d=wg(d),i.context===null?i.context=d:i.pendingContext=d,i=sa(S,M),i.payload={element:a},g=g===void 0?null:g,g!==null&&(i.callback=g),a=La(x,i,M),a!==null&&(ms(a,x,M,S),uu(a,x,M)),M}function Du(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function _g(a,i){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<i?d:i}}function af(a,i){_g(a,i),(a=a.alternate)&&_g(a,i)}function gy(){return null}var Sg=typeof reportError=="function"?reportError:function(a){console.error(a)};function of(a){this._internalRoot=a}Fu.prototype.render=of.prototype.render=function(a){var i=this._internalRoot;if(i===null)throw Error(e(409));Ou(a,i,null,null)},Fu.prototype.unmount=of.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var i=a.containerInfo;ki(function(){Ou(null,a,null,null)}),i[Zs]=null}};function Fu(a){this._internalRoot=a}Fu.prototype.unstable_scheduleHydration=function(a){if(a){var i=Dc();a={blockedOn:null,target:a,priority:i};for(var d=0;d<gr.length&&i!==0&&i<gr[d].priority;d++);gr.splice(d,0,a),d===0&&cl(a)}};function lf(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Pu(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function Eg(){}function py(a,i,d,g,x){if(x){if(typeof g=="function"){var S=g;g=function(){var je=Du(M);S.call(je)}}var M=bg(i,g,a,0,null,!1,!1,"",Eg);return a._reactRootContainer=M,a[Zs]=M.current,ot(a.nodeType===8?a.parentNode:a),ki(),M}for(;x=a.lastChild;)a.removeChild(x);if(typeof g=="function"){var de=g;g=function(){var je=Du(ge);de.call(je)}}var ge=sf(a,0,!1,null,null,!1,!1,"",Eg);return a._reactRootContainer=ge,a[Zs]=ge.current,ot(a.nodeType===8?a.parentNode:a),ki(function(){Ou(i,ge,d,g)}),ge}function Lu(a,i,d,g,x){var S=d._reactRootContainer;if(S){var M=S;if(typeof x=="function"){var de=x;x=function(){var ge=Du(M);de.call(ge)}}Ou(i,M,a,x)}else M=py(d,i,a,x,g);return Du(M)}Ns=function(a){switch(a.tag){case 3:var i=a.stateNode;if(i.current.memoizedState.isDehydrated){var d=Ts(i.pendingLanes);d!==0&&(wa(i,d|1),Cn(i,Pe()),(Pt&6)===0&&(No=Pe()+500,Fa()))}break;case 13:ki(function(){var g=na(a,1);if(g!==null){var x=hn();ms(g,a,1,x)}}),af(a,1)}},ol=function(a){if(a.tag===13){var i=na(a,134217728);if(i!==null){var d=hn();ms(i,a,134217728,d)}af(a,134217728)}},Yi=function(a){if(a.tag===13){var i=Ba(a),d=na(a,i);if(d!==null){var g=hn();ms(d,a,i,g)}af(a,i)}},Dc=function(){return Tt},pt=function(a,i){var d=Tt;try{return Tt=a,i()}finally{Tt=d}},ln=function(a,i,d){switch(i){case"input":if(Ve(a,d),i=d.name,d.type==="radio"&&i!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<d.length;i++){var g=d[i];if(g!==a&&g.form===a.form){var x=eu(g);if(!x)throw Error(e(90));z(g),Ve(g,x)}}}break;case"textarea":ft(a,d);break;case"select":i=d.value,i!=null&&rt(a,!!d.multiple,i,!1)}},bn=Q0,Mt=ki;var xy={usingClientEntryPoint:!1,Events:[jl,mo,eu,cn,si,Q0]},Wl={findFiberByHostInstance:xi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vy={bundleType:Wl.bundleType,version:Wl.version,rendererPackageName:Wl.rendererPackageName,rendererConfig:Wl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:F.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=ke(a),a===null?null:a.stateNode},findFiberByHostInstance:Wl.findFiberByHostInstance||gy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mu.isDisabled&&Mu.supportsFiber)try{un=Mu.inject(vy),fr=Mu}catch{}}return jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xy,jn.createPortal=function(a,i){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lf(i))throw Error(e(200));return my(a,i,null,d)},jn.createRoot=function(a,i){if(!lf(a))throw Error(e(299));var d=!1,g="",x=Sg;return i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(g=i.identifierPrefix),i.onRecoverableError!==void 0&&(x=i.onRecoverableError)),i=sf(a,1,!1,null,null,d,!1,g,x),a[Zs]=i.current,ot(a.nodeType===8?a.parentNode:a),new of(i)},jn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var i=a._reactInternals;if(i===void 0)throw typeof a.render=="function"?Error(e(188)):(a=Object.keys(a).join(","),Error(e(268,a)));return a=ke(i),a=a===null?null:a.stateNode,a},jn.flushSync=function(a){return ki(a)},jn.hydrate=function(a,i,d){if(!Pu(i))throw Error(e(200));return Lu(null,a,i,!0,d)},jn.hydrateRoot=function(a,i,d){if(!lf(a))throw Error(e(405));var g=d!=null&&d.hydratedSources||null,x=!1,S="",M=Sg;if(d!=null&&(d.unstable_strictMode===!0&&(x=!0),d.identifierPrefix!==void 0&&(S=d.identifierPrefix),d.onRecoverableError!==void 0&&(M=d.onRecoverableError)),i=bg(i,null,a,1,d??null,x,!1,S,M),a[Zs]=i.current,ot(a),g)for(a=0;a<g.length;a++)d=g[a],x=d._getVersion,x=x(d._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[d,x]:i.mutableSourceEagerHydrationData.push(d,x);return new Fu(i)},jn.render=function(a,i,d){if(!Pu(i))throw Error(e(200));return Lu(null,a,i,!1,d)},jn.unmountComponentAtNode=function(a){if(!Pu(a))throw Error(e(40));return a._reactRootContainer?(ki(function(){Lu(null,null,a,!1,function(){a._reactRootContainer=null,a[Zs]=null})}),!0):!1},jn.unstable_batchedUpdates=Q0,jn.unstable_renderSubtreeIntoContainer=function(a,i,d,g){if(!Pu(d))throw Error(e(200));if(a==null||a._reactInternals===void 0)throw Error(e(38));return Lu(a,i,d,!1,g)},jn.version="18.3.1-next-f1338f8080-20240426",jn}var Ig;function Ny(){if(Ig)return df.exports;Ig=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}return t(),df.exports=Ty(),df.exports}var Og;function Cy(){if(Og)return $u;Og=1;var t=Ny();return $u.createRoot=t.createRoot,$u.hydrateRoot=t.hydrateRoot,$u}var jy=Cy();const Ay=ah(jy);/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Dg="popstate";function Ry(t={}){function r(n,s){let{pathname:o,search:l,hash:u}=n.location;return Df("",{pathname:o,search:l,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function e(n,s){return typeof s=="string"?s:cc(s)}return Oy(r,e,null,t)}function ir(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function Ss(t,r){if(!t){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function Iy(){return Math.random().toString(36).substring(2,10)}function Fg(t,r){return{usr:t.state,key:t.key,idx:r}}function Df(t,r,e=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof r=="string"?Yo(r):r,state:e,key:r&&r.key||n||Iy()}}function cc({pathname:t="/",search:r="",hash:e=""}){return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),e&&e!=="#"&&(t+=e.charAt(0)==="#"?e:"#"+e),t}function Yo(t){let r={};if(t){let e=t.indexOf("#");e>=0&&(r.hash=t.substring(e),t=t.substring(0,e));let n=t.indexOf("?");n>=0&&(r.search=t.substring(n),t=t.substring(0,n)),t&&(r.pathname=t)}return r}function Oy(t,r,e,n={}){let{window:s=document.defaultView,v5Compat:o=!1}=n,l=s.history,u="POP",f=null,m=p();m==null&&(m=0,l.replaceState({...l.state,idx:m},""));function p(){return(l.state||{idx:null}).idx}function v(){u="POP";let y=p(),L=y==null?null:y-m;m=y,f&&f({action:u,location:b.location,delta:L})}function w(y,L){u="PUSH";let G=Df(b.location,y,L);m=p()+1;let j=Fg(G,m),F=b.createHref(G);try{l.pushState(j,"",F)}catch(ue){if(ue instanceof DOMException&&ue.name==="DataCloneError")throw ue;s.location.assign(F)}o&&f&&f({action:u,location:b.location,delta:1})}function _(y,L){u="REPLACE";let G=Df(b.location,y,L);m=p();let j=Fg(G,m),F=b.createHref(G);l.replaceState(j,"",F),o&&f&&f({action:u,location:b.location,delta:0})}function k(y){return Dy(y)}let b={get action(){return u},get location(){return t(s,l)},listen(y){if(f)throw new Error("A history only accepts one active listener");return s.addEventListener(Dg,v),f=y,()=>{s.removeEventListener(Dg,v),f=null}},createHref(y){return r(s,y)},createURL:k,encodeLocation(y){let L=k(y);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:w,replace:_,go(y){return l.go(y)}};return b}function Dy(t,r=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),ir(e,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:cc(t);return n=n.replace(/ $/,"%20"),!r&&n.startsWith("//")&&(n=e+n),new URL(n,e)}function gx(t,r,e="/"){return Fy(t,r,e,!1)}function Fy(t,r,e,n){let s=typeof r=="string"?Yo(r):r,o=ha(s.pathname||"/",e);if(o==null)return null;let l=px(t);Py(l);let u=null;for(let f=0;u==null&&f<l.length;++f){let m=Ky(o);u=zy(l[f],m,n)}return u}function px(t,r=[],e=[],n="",s=!1){let o=(l,u,f=s,m)=>{let p={relativePath:m===void 0?l.path||"":m,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&f)return;ir(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let v=ua([n,p.relativePath]),w=e.concat(p);l.children&&l.children.length>0&&(ir(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),px(l.children,r,w,v,f)),!(l.path==null&&!l.index)&&r.push({path:v,score:Wy(v,l.index),routesMeta:w})};return t.forEach((l,u)=>{if(l.path===""||!l.path?.includes("?"))o(l,u);else for(let f of xx(l.path))o(l,u,!0,f)}),r}function xx(t){let r=t.split("/");if(r.length===0)return[];let[e,...n]=r,s=e.endsWith("?"),o=e.replace(/\?$/,"");if(n.length===0)return s?[o,""]:[o];let l=xx(n.join("/")),u=[];return u.push(...l.map(f=>f===""?o:[o,f].join("/"))),s&&u.push(...l),u.map(f=>t.startsWith("/")&&f===""?"/":f)}function Py(t){t.sort((r,e)=>r.score!==e.score?e.score-r.score:Hy(r.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}var Ly=/^:[\w-]+$/,My=3,$y=2,Uy=1,By=10,Vy=-2,Pg=t=>t==="*";function Wy(t,r){let e=t.split("/"),n=e.length;return e.some(Pg)&&(n+=Vy),r&&(n+=$y),e.filter(s=>!Pg(s)).reduce((s,o)=>s+(Ly.test(o)?My:o===""?Uy:By),n)}function Hy(t,r){return t.length===r.length&&t.slice(0,-1).every((n,s)=>n===r[s])?t[t.length-1]-r[r.length-1]:0}function zy(t,r,e=!1){let{routesMeta:n}=t,s={},o="/",l=[];for(let u=0;u<n.length;++u){let f=n[u],m=u===n.length-1,p=o==="/"?r:r.slice(o.length)||"/",v=id({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},p),w=f.route;if(!v&&m&&e&&!n[n.length-1].route.index&&(v=id({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!v)return null;Object.assign(s,v.params),l.push({params:s,pathname:ua([o,v.pathname]),pathnameBase:Yy(ua([o,v.pathnameBase])),route:w}),v.pathnameBase!=="/"&&(o=ua([o,v.pathnameBase]))}return l}function id(t,r){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[e,n]=Gy(t.path,t.caseSensitive,t.end),s=r.match(e);if(!s)return null;let o=s[0],l=o.replace(/(.)\/+$/,"$1"),u=s.slice(1);return{params:n.reduce((m,{paramName:p,isOptional:v},w)=>{if(p==="*"){let k=u[w]||"";l=o.slice(0,o.length-k.length).replace(/(.)\/+$/,"$1")}const _=u[w];return v&&!_?m[p]=void 0:m[p]=(_||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:l,pattern:t}}function Gy(t,r=!1,e=!0){Ss(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,f)=>(n.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,r?void 0:"i"),n]}function Ky(t){try{return t.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return Ss(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),t}}function ha(t,r){if(r==="/")return t;if(!t.toLowerCase().startsWith(r.toLowerCase()))return null;let e=r.endsWith("/")?r.length-1:r.length,n=t.charAt(e);return n&&n!=="/"?null:t.slice(e)||"/"}function Xy(t,r="/"){let{pathname:e,search:n="",hash:s=""}=typeof t=="string"?Yo(t):t;return{pathname:e?e.startsWith("/")?e:qy(e,r):r,search:Qy(n),hash:Zy(s)}}function qy(t,r){let e=r.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?e.length>1&&e.pop():s!=="."&&e.push(s)}),e.length>1?e.join("/"):"/"}function mf(t,r,e,n){return`Cannot include a '${t}' character in a manually specified \`to.${r}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Jy(t){return t.filter((r,e)=>e===0||r.route.path&&r.route.path.length>0)}function vx(t){let r=Jy(t);return r.map((e,n)=>n===r.length-1?e.pathname:e.pathnameBase)}function yx(t,r,e,n=!1){let s;typeof t=="string"?s=Yo(t):(s={...t},ir(!s.pathname||!s.pathname.includes("?"),mf("?","pathname","search",s)),ir(!s.pathname||!s.pathname.includes("#"),mf("#","pathname","hash",s)),ir(!s.search||!s.search.includes("#"),mf("#","search","hash",s)));let o=t===""||s.pathname==="",l=o?"/":s.pathname,u;if(l==null)u=e;else{let v=r.length-1;if(!n&&l.startsWith("..")){let w=l.split("/");for(;w[0]==="..";)w.shift(),v-=1;s.pathname=w.join("/")}u=v>=0?r[v]:"/"}let f=Xy(s,u),m=l&&l!=="/"&&l.endsWith("/"),p=(o||l===".")&&e.endsWith("/");return!f.pathname.endsWith("/")&&(m||p)&&(f.pathname+="/"),f}var ua=t=>t.join("/").replace(/\/\/+/g,"/"),Yy=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Qy=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Zy=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function ew(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var wx=["POST","PUT","PATCH","DELETE"];new Set(wx);var tw=["GET",...wx];new Set(tw);var Qo=R.createContext(null);Qo.displayName="DataRouter";var bd=R.createContext(null);bd.displayName="DataRouterState";R.createContext(!1);var bx=R.createContext({isTransitioning:!1});bx.displayName="ViewTransition";var rw=R.createContext(new Map);rw.displayName="Fetchers";var nw=R.createContext(null);nw.displayName="Await";var Us=R.createContext(null);Us.displayName="Navigation";var wc=R.createContext(null);wc.displayName="Location";var ga=R.createContext({outlet:null,matches:[],isDataRoute:!1});ga.displayName="Route";var oh=R.createContext(null);oh.displayName="RouteError";function sw(t,{relative:r}={}){ir(bc(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:n}=R.useContext(Us),{hash:s,pathname:o,search:l}=_c(t,{relative:r}),u=o;return e!=="/"&&(u=o==="/"?e:ua([e,o])),n.createHref({pathname:u,search:l,hash:s})}function bc(){return R.useContext(wc)!=null}function an(){return ir(bc(),"useLocation() may be used only in the context of a <Router> component."),R.useContext(wc).location}var _x="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Sx(t){R.useContext(Us).static||R.useLayoutEffect(t)}function ti(){let{isDataRoute:t}=R.useContext(ga);return t?xw():aw()}function aw(){ir(bc(),"useNavigate() may be used only in the context of a <Router> component.");let t=R.useContext(Qo),{basename:r,navigator:e}=R.useContext(Us),{matches:n}=R.useContext(ga),{pathname:s}=an(),o=JSON.stringify(vx(n)),l=R.useRef(!1);return Sx(()=>{l.current=!0}),R.useCallback((f,m={})=>{if(Ss(l.current,_x),!l.current)return;if(typeof f=="number"){e.go(f);return}let p=yx(f,JSON.parse(o),s,m.relative==="path");t==null&&r!=="/"&&(p.pathname=p.pathname==="/"?r:ua([r,p.pathname])),(m.replace?e.replace:e.push)(p,m.state,m)},[r,e,o,s,t])}R.createContext(null);function _c(t,{relative:r}={}){let{matches:e}=R.useContext(ga),{pathname:n}=an(),s=JSON.stringify(vx(e));return R.useMemo(()=>yx(t,JSON.parse(s),n,r==="path"),[t,s,n,r])}function iw(t,r){return Ex(t,r)}function Ex(t,r,e,n,s){ir(bc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=R.useContext(Us),{matches:l}=R.useContext(ga),u=l[l.length-1],f=u?u.params:{},m=u?u.pathname:"/",p=u?u.pathnameBase:"/",v=u&&u.route;{let G=v&&v.path||"";kx(m,!v||G.endsWith("*")||G.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${G}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${G}"> to <Route path="${G==="/"?"*":`${G}/*`}">.`)}let w=an(),_;if(r){let G=typeof r=="string"?Yo(r):r;ir(p==="/"||G.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${G.pathname}" was given in the \`location\` prop.`),_=G}else _=w;let k=_.pathname||"/",b=k;if(p!=="/"){let G=p.replace(/^\//,"").split("/");b="/"+k.replace(/^\//,"").split("/").slice(G.length).join("/")}let y=gx(t,{pathname:b});Ss(v||y!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),Ss(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let L=dw(y&&y.map(G=>Object.assign({},G,{params:Object.assign({},f,G.params),pathname:ua([p,o.encodeLocation?o.encodeLocation(G.pathname).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?p:ua([p,o.encodeLocation?o.encodeLocation(G.pathnameBase).pathname:G.pathnameBase])})),l,e,n,s);return r&&L?R.createElement(wc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},L):L}function ow(){let t=pw(),r=ew(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),e=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",t),l=R.createElement(R.Fragment,null,R.createElement("p",null," Hey developer "),R.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",R.createElement("code",{style:o},"ErrorBoundary")," or"," ",R.createElement("code",{style:o},"errorElement")," prop on your route.")),R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},r),e?R.createElement("pre",{style:s},e):null,l)}var lw=R.createElement(ow,null),cw=class extends R.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){this.props.unstable_onError?this.props.unstable_onError(t,r):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?R.createElement(ga.Provider,{value:this.props.routeContext},R.createElement(oh.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function uw({routeContext:t,match:r,children:e}){let n=R.useContext(Qo);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),R.createElement(ga.Provider,{value:t},e)}function dw(t,r=[],e=null,n=null,s=null){if(t==null){if(!e)return null;if(e.errors)t=e.matches;else if(r.length===0&&!e.initialized&&e.matches.length>0)t=e.matches;else return null}let o=t,l=e?.errors;if(l!=null){let m=o.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);ir(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),o=o.slice(0,Math.min(o.length,m+1))}let u=!1,f=-1;if(e)for(let m=0;m<o.length;m++){let p=o[m];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(f=m),p.route.id){let{loaderData:v,errors:w}=e,_=p.route.loader&&!v.hasOwnProperty(p.route.id)&&(!w||w[p.route.id]===void 0);if(p.route.lazy||_){u=!0,f>=0?o=o.slice(0,f+1):o=[o[0]];break}}}return o.reduceRight((m,p,v)=>{let w,_=!1,k=null,b=null;e&&(w=l&&p.route.id?l[p.route.id]:void 0,k=p.route.errorElement||lw,u&&(f<0&&v===0?(kx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,b=null):f===v&&(_=!0,b=p.route.hydrateFallbackElement||null)));let y=r.concat(o.slice(0,v+1)),L=()=>{let G;return w?G=k:_?G=b:p.route.Component?G=R.createElement(p.route.Component,null):p.route.element?G=p.route.element:G=m,R.createElement(uw,{match:p,routeContext:{outlet:m,matches:y,isDataRoute:e!=null},children:G})};return e&&(p.route.ErrorBoundary||p.route.errorElement||v===0)?R.createElement(cw,{location:e.location,revalidation:e.revalidation,component:k,error:w,children:L(),routeContext:{outlet:null,matches:y,isDataRoute:!0},unstable_onError:n}):L()},null)}function lh(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function fw(t){let r=R.useContext(Qo);return ir(r,lh(t)),r}function hw(t){let r=R.useContext(bd);return ir(r,lh(t)),r}function mw(t){let r=R.useContext(ga);return ir(r,lh(t)),r}function ch(t){let r=mw(t),e=r.matches[r.matches.length-1];return ir(e.route.id,`${t} can only be used on routes that contain a unique "id"`),e.route.id}function gw(){return ch("useRouteId")}function pw(){let t=R.useContext(oh),r=hw("useRouteError"),e=ch("useRouteError");return t!==void 0?t:r.errors?.[e]}function xw(){let{router:t}=fw("useNavigate"),r=ch("useNavigate"),e=R.useRef(!1);return Sx(()=>{e.current=!0}),R.useCallback(async(s,o={})=>{Ss(e.current,_x),e.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:r,...o}))},[t,r])}var Lg={};function kx(t,r,e){!r&&!Lg[t]&&(Lg[t]=!0,Ss(!1,e))}R.memo(vw);function vw({routes:t,future:r,state:e,unstable_onError:n}){return Ex(t,void 0,e,n,r)}function ts(t){ir(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function yw({basename:t="/",children:r=null,location:e,navigationType:n="POP",navigator:s,static:o=!1}){ir(!bc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),u=R.useMemo(()=>({basename:l,navigator:s,static:o,future:{}}),[l,s,o]);typeof e=="string"&&(e=Yo(e));let{pathname:f="/",search:m="",hash:p="",state:v=null,key:w="default"}=e,_=R.useMemo(()=>{let k=ha(f,l);return k==null?null:{location:{pathname:k,search:m,hash:p,state:v,key:w},navigationType:n}},[l,f,m,p,v,w,n]);return Ss(_!=null,`<Router basename="${l}"> is not able to match the URL "${f}${m}${p}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:R.createElement(Us.Provider,{value:u},R.createElement(wc.Provider,{children:r,value:_}))}function Mg({children:t,location:r}){return iw(Ff(t),r)}function Ff(t,r=[]){let e=[];return R.Children.forEach(t,(n,s)=>{if(!R.isValidElement(n))return;let o=[...r,s];if(n.type===R.Fragment){e.push.apply(e,Ff(n.props.children,o));return}ir(n.type===ts,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ir(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Ff(n.props.children,o)),e.push(l)}),e}var nd="get",sd="application/x-www-form-urlencoded";function _d(t){return t!=null&&typeof t.tagName=="string"}function ww(t){return _d(t)&&t.tagName.toLowerCase()==="button"}function bw(t){return _d(t)&&t.tagName.toLowerCase()==="form"}function _w(t){return _d(t)&&t.tagName.toLowerCase()==="input"}function Sw(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Ew(t,r){return t.button===0&&(!r||r==="_self")&&!Sw(t)}function Pf(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((r,e)=>{let n=t[e];return r.concat(Array.isArray(n)?n.map(s=>[e,s]):[[e,n]])},[]))}function kw(t,r){let e=Pf(t);return r&&r.forEach((n,s)=>{e.has(s)||r.getAll(s).forEach(o=>{e.append(s,o)})}),e}var Uu=null;function Tw(){if(Uu===null)try{new FormData(document.createElement("form"),0),Uu=!1}catch{Uu=!0}return Uu}var Nw=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function gf(t){return t!=null&&!Nw.has(t)?(Ss(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${sd}"`),null):t}function Cw(t,r){let e,n,s,o,l;if(bw(t)){let u=t.getAttribute("action");n=u?ha(u,r):null,e=t.getAttribute("method")||nd,s=gf(t.getAttribute("enctype"))||sd,o=new FormData(t)}else if(ww(t)||_w(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||u.getAttribute("action");if(n=f?ha(f,r):null,e=t.getAttribute("formmethod")||u.getAttribute("method")||nd,s=gf(t.getAttribute("formenctype"))||gf(u.getAttribute("enctype"))||sd,o=new FormData(u,t),!Tw()){let{name:m,type:p,value:v}=t;if(p==="image"){let w=m?`${m}.`:"";o.append(`${w}x`,"0"),o.append(`${w}y`,"0")}else m&&o.append(m,v)}}else{if(_d(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=nd,n=null,s=sd,l=t}return o&&s==="text/plain"&&(l=o,o=void 0),{action:n,method:e.toLowerCase(),encType:s,formData:o,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function uh(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function jw(t,r,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${e}`:r&&ha(n.pathname,r)==="/"?n.pathname=`${r.replace(/\/$/,"")}/_root.${e}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${e}`,n}async function Aw(t,r){if(t.id in r)return r[t.id];try{let e=await import(t.module);return r[t.id]=e,e}catch(e){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Rw(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function Iw(t,r,e){let n=await Promise.all(t.map(async s=>{let o=r.routes[s.route.id];if(o){let l=await Aw(o,e);return l.links?l.links():[]}return[]}));return Pw(n.flat(1).filter(Rw).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function $g(t,r,e,n,s,o){let l=(f,m)=>e[m]?f.route.id!==e[m].route.id:!0,u=(f,m)=>e[m].pathname!==f.pathname||e[m].route.path?.endsWith("*")&&e[m].params["*"]!==f.params["*"];return o==="assets"?r.filter((f,m)=>l(f,m)||u(f,m)):o==="data"?r.filter((f,m)=>{let p=n.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(l(f,m)||u(f,m))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function Ow(t,r,{includeHydrateFallback:e}={}){return Dw(t.map(n=>{let s=r.routes[n.route.id];if(!s)return[];let o=[s.module];return s.clientActionModule&&(o=o.concat(s.clientActionModule)),s.clientLoaderModule&&(o=o.concat(s.clientLoaderModule)),e&&s.hydrateFallbackModule&&(o=o.concat(s.hydrateFallbackModule)),s.imports&&(o=o.concat(s.imports)),o}).flat(1))}function Dw(t){return[...new Set(t)]}function Fw(t){let r={},e=Object.keys(t).sort();for(let n of e)r[n]=t[n];return r}function Pw(t,r){let e=new Set;return new Set(r),t.reduce((n,s)=>{let o=JSON.stringify(Fw(s));return e.has(o)||(e.add(o),n.push({key:o,link:s})),n},[])}function Tx(){let t=R.useContext(Qo);return uh(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Lw(){let t=R.useContext(bd);return uh(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var dh=R.createContext(void 0);dh.displayName="FrameworkContext";function Nx(){let t=R.useContext(dh);return uh(t,"You must render this element inside a <HydratedRouter> element"),t}function Mw(t,r){let e=R.useContext(dh),[n,s]=R.useState(!1),[o,l]=R.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:m,onMouseLeave:p,onTouchStart:v}=r,w=R.useRef(null);R.useEffect(()=>{if(t==="render"&&l(!0),t==="viewport"){let b=L=>{L.forEach(G=>{l(G.isIntersecting)})},y=new IntersectionObserver(b,{threshold:.5});return w.current&&y.observe(w.current),()=>{y.disconnect()}}},[t]),R.useEffect(()=>{if(n){let b=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(b)}}},[n]);let _=()=>{s(!0)},k=()=>{s(!1),l(!1)};return e?t!=="intent"?[o,w,{}]:[o,w,{onFocus:zl(u,_),onBlur:zl(f,k),onMouseEnter:zl(m,_),onMouseLeave:zl(p,k),onTouchStart:zl(v,_)}]:[!1,w,{}]}function zl(t,r){return e=>{t&&t(e),e.defaultPrevented||r(e)}}function $w({page:t,...r}){let{router:e}=Tx(),n=R.useMemo(()=>gx(e.routes,t,e.basename),[e.routes,t,e.basename]);return n?R.createElement(Bw,{page:t,matches:n,...r}):null}function Uw(t){let{manifest:r,routeModules:e}=Nx(),[n,s]=R.useState([]);return R.useEffect(()=>{let o=!1;return Iw(t,r,e).then(l=>{o||s(l)}),()=>{o=!0}},[t,r,e]),n}function Bw({page:t,matches:r,...e}){let n=an(),{manifest:s,routeModules:o}=Nx(),{basename:l}=Tx(),{loaderData:u,matches:f}=Lw(),m=R.useMemo(()=>$g(t,r,f,s,n,"data"),[t,r,f,s,n]),p=R.useMemo(()=>$g(t,r,f,s,n,"assets"),[t,r,f,s,n]),v=R.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let k=new Set,b=!1;if(r.forEach(L=>{let G=s.routes[L.route.id];!G||!G.hasLoader||(!m.some(j=>j.route.id===L.route.id)&&L.route.id in u&&o[L.route.id]?.shouldRevalidate||G.hasClientLoader?b=!0:k.add(L.route.id))}),k.size===0)return[];let y=jw(t,l,"data");return b&&k.size>0&&y.searchParams.set("_routes",r.filter(L=>k.has(L.route.id)).map(L=>L.route.id).join(",")),[y.pathname+y.search]},[l,u,n,s,m,r,t,o]),w=R.useMemo(()=>Ow(p,s),[p,s]),_=Uw(p);return R.createElement(R.Fragment,null,v.map(k=>R.createElement("link",{key:k,rel:"prefetch",as:"fetch",href:k,...e})),w.map(k=>R.createElement("link",{key:k,rel:"modulepreload",href:k,...e})),_.map(({key:k,link:b})=>R.createElement("link",{key:k,nonce:e.nonce,...b})))}function Vw(...t){return r=>{t.forEach(e=>{typeof e=="function"?e(r):e!=null&&(e.current=r)})}}var Cx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Cx&&(window.__reactRouterVersion="7.8.2")}catch{}function Ww({basename:t,children:r,window:e}){let n=R.useRef();n.current==null&&(n.current=Ry({window:e,v5Compat:!0}));let s=n.current,[o,l]=R.useState({action:s.action,location:s.location}),u=R.useCallback(f=>{R.startTransition(()=>l(f))},[l]);return R.useLayoutEffect(()=>s.listen(u),[s,u]),R.createElement(yw,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:s})}var jx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ax=R.forwardRef(function({onClick:r,discover:e="render",prefetch:n="none",relative:s,reloadDocument:o,replace:l,state:u,target:f,to:m,preventScrollReset:p,viewTransition:v,...w},_){let{basename:k}=R.useContext(Us),b=typeof m=="string"&&jx.test(m),y,L=!1;if(typeof m=="string"&&b&&(y=m,Cx))try{let T=new URL(window.location.href),O=m.startsWith("//")?new URL(T.protocol+m):new URL(m),H=ha(O.pathname,k);O.origin===T.origin&&H!=null?m=H+O.search+O.hash:L=!0}catch{Ss(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let G=sw(m,{relative:s}),[j,F,ue]=Mw(n,w),D=Kw(m,{replace:l,state:u,target:f,preventScrollReset:p,relative:s,viewTransition:v});function V(T){r&&r(T),T.defaultPrevented||D(T)}let ee=R.createElement("a",{...w,...ue,href:y||G,onClick:L||o?r:V,ref:Vw(_,F),target:f,"data-discover":!b&&e==="render"?"true":void 0});return j&&!b?R.createElement(R.Fragment,null,ee,R.createElement($w,{page:G})):ee});Ax.displayName="Link";var Hw=R.forwardRef(function({"aria-current":r="page",caseSensitive:e=!1,className:n="",end:s=!1,style:o,to:l,viewTransition:u,children:f,...m},p){let v=_c(l,{relative:m.relative}),w=an(),_=R.useContext(bd),{navigator:k,basename:b}=R.useContext(Us),y=_!=null&&Qw(v)&&u===!0,L=k.encodeLocation?k.encodeLocation(v).pathname:v.pathname,G=w.pathname,j=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;e||(G=G.toLowerCase(),j=j?j.toLowerCase():null,L=L.toLowerCase()),j&&b&&(j=ha(j,b)||j);const F=L!=="/"&&L.endsWith("/")?L.length-1:L.length;let ue=G===L||!s&&G.startsWith(L)&&G.charAt(F)==="/",D=j!=null&&(j===L||!s&&j.startsWith(L)&&j.charAt(L.length)==="/"),V={isActive:ue,isPending:D,isTransitioning:y},ee=ue?r:void 0,T;typeof n=="function"?T=n(V):T=[n,ue?"active":null,D?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let O=typeof o=="function"?o(V):o;return R.createElement(Ax,{...m,"aria-current":ee,className:T,ref:p,style:O,to:l,viewTransition:u},typeof f=="function"?f(V):f)});Hw.displayName="NavLink";var zw=R.forwardRef(({discover:t="render",fetcherKey:r,navigate:e,reloadDocument:n,replace:s,state:o,method:l=nd,action:u,onSubmit:f,relative:m,preventScrollReset:p,viewTransition:v,...w},_)=>{let k=Jw(),b=Yw(u,{relative:m}),y=l.toLowerCase()==="get"?"get":"post",L=typeof u=="string"&&jx.test(u),G=j=>{if(f&&f(j),j.defaultPrevented)return;j.preventDefault();let F=j.nativeEvent.submitter,ue=F?.getAttribute("formmethod")||l;k(F||j.currentTarget,{fetcherKey:r,method:ue,navigate:e,replace:s,state:o,relative:m,preventScrollReset:p,viewTransition:v})};return R.createElement("form",{ref:_,method:y,action:b,onSubmit:n?f:G,...w,"data-discover":!L&&t==="render"?"true":void 0})});zw.displayName="Form";function Gw(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Rx(t){let r=R.useContext(Qo);return ir(r,Gw(t)),r}function Kw(t,{target:r,replace:e,state:n,preventScrollReset:s,relative:o,viewTransition:l}={}){let u=ti(),f=an(),m=_c(t,{relative:o});return R.useCallback(p=>{if(Ew(p,r)){p.preventDefault();let v=e!==void 0?e:cc(f)===cc(m);u(t,{replace:v,state:n,preventScrollReset:s,relative:o,viewTransition:l})}},[f,u,m,e,n,r,t,s,o,l])}function Sd(t){Ss(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let r=R.useRef(Pf(t)),e=R.useRef(!1),n=an(),s=R.useMemo(()=>kw(n.search,e.current?null:r.current),[n.search]),o=ti(),l=R.useCallback((u,f)=>{const m=Pf(typeof u=="function"?u(new URLSearchParams(s)):u);e.current=!0,o("?"+m,f)},[o,s]);return[s,l]}var Xw=0,qw=()=>`__${String(++Xw)}__`;function Jw(){let{router:t}=Rx("useSubmit"),{basename:r}=R.useContext(Us),e=gw();return R.useCallback(async(n,s={})=>{let{action:o,method:l,encType:u,formData:f,body:m}=Cw(n,r);if(s.navigate===!1){let p=s.fetcherKey||qw();await t.fetch(p,e,s.action||o,{preventScrollReset:s.preventScrollReset,formData:f,body:m,formMethod:s.method||l,formEncType:s.encType||u,flushSync:s.flushSync})}else await t.navigate(s.action||o,{preventScrollReset:s.preventScrollReset,formData:f,body:m,formMethod:s.method||l,formEncType:s.encType||u,replace:s.replace,state:s.state,fromRouteId:e,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,r,e])}function Yw(t,{relative:r}={}){let{basename:e}=R.useContext(Us),n=R.useContext(ga);ir(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),o={..._c(t||".",{relative:r})},l=an();if(t==null){o.search=l.search;let u=new URLSearchParams(o.search),f=u.getAll("index");if(f.some(p=>p==="")){u.delete("index"),f.filter(v=>v).forEach(v=>u.append("index",v));let p=u.toString();o.search=p?`?${p}`:""}}return(!t||t===".")&&s.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(o.pathname=o.pathname==="/"?e:ua([e,o.pathname])),cc(o)}function Qw(t,{relative:r}={}){let e=R.useContext(bx);ir(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Rx("useViewTransitionState"),s=_c(t,{relative:r});if(!e.isTransitioning)return!1;let o=ha(e.currentLocation.pathname,n)||e.currentLocation.pathname,l=ha(e.nextLocation.pathname,n)||e.nextLocation.pathname;return id(s.pathname,l)!=null||id(s.pathname,o)!=null}const Zw="modulepreload",eb=function(t){return"/"+t},Ug={},Zo=function(r,e,n){let s=Promise.resolve();if(e&&e.length>0){let m=function(p){return Promise.all(p.map(v=>Promise.resolve(v).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};var l=m;document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=u?.nonce||u?.getAttribute("nonce");s=m(e.map(p=>{if(p=eb(p),p in Ug)return;Ug[p]=!0;const v=p.endsWith(".css"),w=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${w}`))return;const _=document.createElement("link");if(_.rel=v?"stylesheet":Zw,v||(_.as="script"),_.crossOrigin="",_.href=p,f&&_.setAttribute("nonce",f),document.head.appendChild(_),v)return new Promise((k,b)=>{_.addEventListener("load",k),_.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return s.then(u=>{for(const f of u||[])f.status==="rejected"&&o(f.reason);return r().catch(o)})},tb=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>Zo(async()=>{const{default:n}=await Promise.resolve().then(()=>el);return{default:n}},[]).then(({default:n})=>n(...e)):r=fetch,(...e)=>r(...e)};class fh extends Error{constructor(r,e="FunctionsError",n){super(r),this.name=e,this.context=n}}class rb extends fh{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class Bg extends fh{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class Vg extends fh{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var Lf;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Lf||(Lf={}));var nb=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};class sb{constructor(r,{headers:e={},customFetch:n,region:s=Lf.Any}={}){this.url=r,this.headers=e,this.region=s,this.fetch=tb(n)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,e={}){var n;return nb(this,void 0,void 0,function*(){try{const{headers:s,method:o,body:l}=e;let u={},{region:f}=e;f||(f=this.region);const m=new URL(`${this.url}/${r}`);f&&f!=="any"&&(u["x-region"]=f,m.searchParams.set("forceFunctionRegion",f));let p;l&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",p=l):typeof l=="string"?(u["Content-Type"]="text/plain",p=l):typeof FormData<"u"&&l instanceof FormData?p=l:(u["Content-Type"]="application/json",p=JSON.stringify(l)));const v=yield this.fetch(m.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),s),body:p}).catch(b=>{throw new rb(b)}),w=v.headers.get("x-relay-error");if(w&&w==="true")throw new Bg(v);if(!v.ok)throw new Vg(v);let _=((n=v.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),k;return _==="application/json"?k=yield v.json():_==="application/octet-stream"?k=yield v.blob():_==="text/event-stream"?k=v:_==="multipart/form-data"?k=yield v.formData():k=yield v.text(),{data:k,error:null,response:v}}catch(s){return{data:null,error:s,response:s instanceof Vg||s instanceof Bg?s.context:void 0}}})}}var Pr={},jo={},Ao={},Ro={},Io={},Oo={},ab=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Xo=ab();const ib=Xo.fetch,Ix=Xo.fetch.bind(Xo),Ox=Xo.Headers,ob=Xo.Request,lb=Xo.Response,el=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ox,Request:ob,Response:lb,default:Ix,fetch:ib},Symbol.toStringTag,{value:"Module"})),cb=wy(el);var Bu={},Wg;function Dx(){if(Wg)return Bu;Wg=1,Object.defineProperty(Bu,"__esModule",{value:!0});class t extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}return Bu.default=t,Bu}var Hg;function Fx(){if(Hg)return Oo;Hg=1;var t=Oo&&Oo.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Oo,"__esModule",{value:!0});const r=t(cb),e=t(Dx());class n{constructor(o){var l,u;this.shouldThrowOnError=!1,this.method=o.method,this.url=o.url,this.headers=new Headers(o.headers),this.schema=o.schema,this.body=o.body,this.shouldThrowOnError=(l=o.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=o.signal,this.isMaybeSingle=(u=o.isMaybeSingle)!==null&&u!==void 0?u:!1,o.fetch?this.fetch=o.fetch:typeof fetch>"u"?this.fetch=r.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(o,l){return this.headers=new Headers(this.headers),this.headers.set(o,l),this}then(o,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const u=this.fetch;let f=u(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var p,v,w,_;let k=null,b=null,y=null,L=m.status,G=m.statusText;if(m.ok){if(this.method!=="HEAD"){const D=await m.text();D===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((p=this.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?b=D:b=JSON.parse(D))}const F=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),ue=(w=m.headers.get("content-range"))===null||w===void 0?void 0:w.split("/");F&&ue&&ue.length>1&&(y=parseInt(ue[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(k={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,y=null,L=406,G="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const F=await m.text();try{k=JSON.parse(F),Array.isArray(k)&&m.status===404&&(b=[],k=null,L=200,G="OK")}catch{m.status===404&&F===""?(L=204,G="No Content"):k={message:F}}if(k&&this.isMaybeSingle&&(!((_=k?.details)===null||_===void 0)&&_.includes("0 rows"))&&(k=null,L=200,G="OK"),k&&this.shouldThrowOnError)throw new e.default(k)}return{error:k,data:b,count:y,status:L,statusText:G}});return this.shouldThrowOnError||(f=f.catch(m=>{var p,v,w;return{error:{message:`${(p=m?.name)!==null&&p!==void 0?p:"FetchError"}: ${m?.message}`,details:`${(v=m?.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(w=m?.code)!==null&&w!==void 0?w:""}`},data:null,count:null,status:0,statusText:""}})),f.then(o,l)}returns(){return this}overrideTypes(){return this}}return Oo.default=n,Oo}var zg;function Px(){if(zg)return Io;zg=1;var t=Io&&Io.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Io,"__esModule",{value:!0});const r=t(Fx());class e extends r.default{select(s){let o=!1;const l=(s??"*").split("").map(u=>/\s/.test(u)&&!o?"":(u==='"'&&(o=!o),u)).join("");return this.url.searchParams.set("select",l),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:o=!0,nullsFirst:l,foreignTable:u,referencedTable:f=u}={}){const m=f?`${f}.order`:"order",p=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${p?`${p},`:""}${s}.${o?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:o,referencedTable:l=o}={}){const u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(u,`${s}`),this}range(s,o,{foreignTable:l,referencedTable:u=l}={}){const f=typeof u>"u"?"offset":`${u}.offset`,m=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(f,`${s}`),this.url.searchParams.set(m,`${o-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:o=!1,settings:l=!1,buffers:u=!1,wal:f=!1,format:m="text"}={}){var p;const v=[s?"analyze":null,o?"verbose":null,l?"settings":null,u?"buffers":null,f?"wal":null].filter(Boolean).join("|"),w=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${w}"; options=${v};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Io.default=e,Io}var Gg;function hh(){if(Gg)return Ro;Gg=1;var t=Ro&&Ro.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ro,"__esModule",{value:!0});const r=t(Px());class e extends r.default{eq(s,o){return this.url.searchParams.append(s,`eq.${o}`),this}neq(s,o){return this.url.searchParams.append(s,`neq.${o}`),this}gt(s,o){return this.url.searchParams.append(s,`gt.${o}`),this}gte(s,o){return this.url.searchParams.append(s,`gte.${o}`),this}lt(s,o){return this.url.searchParams.append(s,`lt.${o}`),this}lte(s,o){return this.url.searchParams.append(s,`lte.${o}`),this}like(s,o){return this.url.searchParams.append(s,`like.${o}`),this}likeAllOf(s,o){return this.url.searchParams.append(s,`like(all).{${o.join(",")}}`),this}likeAnyOf(s,o){return this.url.searchParams.append(s,`like(any).{${o.join(",")}}`),this}ilike(s,o){return this.url.searchParams.append(s,`ilike.${o}`),this}ilikeAllOf(s,o){return this.url.searchParams.append(s,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(s,o){return this.url.searchParams.append(s,`ilike(any).{${o.join(",")}}`),this}is(s,o){return this.url.searchParams.append(s,`is.${o}`),this}in(s,o){const l=Array.from(new Set(o)).map(u=>typeof u=="string"&&new RegExp("[,()]").test(u)?`"${u}"`:`${u}`).join(",");return this.url.searchParams.append(s,`in.(${l})`),this}contains(s,o){return typeof o=="string"?this.url.searchParams.append(s,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(s,`cs.{${o.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(o)}`),this}containedBy(s,o){return typeof o=="string"?this.url.searchParams.append(s,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(s,`cd.{${o.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(o)}`),this}rangeGt(s,o){return this.url.searchParams.append(s,`sr.${o}`),this}rangeGte(s,o){return this.url.searchParams.append(s,`nxl.${o}`),this}rangeLt(s,o){return this.url.searchParams.append(s,`sl.${o}`),this}rangeLte(s,o){return this.url.searchParams.append(s,`nxr.${o}`),this}rangeAdjacent(s,o){return this.url.searchParams.append(s,`adj.${o}`),this}overlaps(s,o){return typeof o=="string"?this.url.searchParams.append(s,`ov.${o}`):this.url.searchParams.append(s,`ov.{${o.join(",")}}`),this}textSearch(s,o,{config:l,type:u}={}){let f="";u==="plain"?f="pl":u==="phrase"?f="ph":u==="websearch"&&(f="w");const m=l===void 0?"":`(${l})`;return this.url.searchParams.append(s,`${f}fts${m}.${o}`),this}match(s){return Object.entries(s).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(s,o,l){return this.url.searchParams.append(s,`not.${o}.${l}`),this}or(s,{foreignTable:o,referencedTable:l=o}={}){const u=l?`${l}.or`:"or";return this.url.searchParams.append(u,`(${s})`),this}filter(s,o,l){return this.url.searchParams.append(s,`${o}.${l}`),this}}return Ro.default=e,Ro}var Kg;function Lx(){if(Kg)return Ao;Kg=1;var t=Ao&&Ao.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ao,"__esModule",{value:!0});const r=t(hh());class e{constructor(s,{headers:o={},schema:l,fetch:u}){this.url=s,this.headers=new Headers(o),this.schema=l,this.fetch=u}select(s,{head:o=!1,count:l}={}){const u=o?"HEAD":"GET";let f=!1;const m=(s??"*").split("").map(p=>/\s/.test(p)&&!f?"":(p==='"'&&(f=!f),p)).join("");return this.url.searchParams.set("select",m),l&&this.headers.append("Prefer",`count=${l}`),new r.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:o,defaultToNull:l=!0}={}){var u;const f="POST";if(o&&this.headers.append("Prefer",`count=${o}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const m=s.reduce((p,v)=>p.concat(Object.keys(v)),[]);if(m.length>0){const p=[...new Set(m)].map(v=>`"${v}"`);this.url.searchParams.set("columns",p.join(","))}}return new r.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}upsert(s,{onConflict:o,ignoreDuplicates:l=!1,count:u,defaultToNull:f=!0}={}){var m;const p="POST";if(this.headers.append("Prefer",`resolution=${l?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),u&&this.headers.append("Prefer",`count=${u}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const v=s.reduce((w,_)=>w.concat(Object.keys(_)),[]);if(v.length>0){const w=[...new Set(v)].map(_=>`"${_}"`);this.url.searchParams.set("columns",w.join(","))}}return new r.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(s,{count:o}={}){var l;const u="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new r.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}delete({count:s}={}){var o;const l="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new r.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return Ao.default=e,Ao}var Xg;function ub(){if(Xg)return jo;Xg=1;var t=jo&&jo.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(jo,"__esModule",{value:!0});const r=t(Lx()),e=t(hh());class n{constructor(o,{headers:l={},schema:u,fetch:f}={}){this.url=o,this.headers=new Headers(l),this.schemaName=u,this.fetch=f}from(o){const l=new URL(`${this.url}/${o}`);return new r.default(l,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,l={},{head:u=!1,get:f=!1,count:m}={}){var p;let v;const w=new URL(`${this.url}/rpc/${o}`);let _;u||f?(v=u?"HEAD":"GET",Object.entries(l).filter(([b,y])=>y!==void 0).map(([b,y])=>[b,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([b,y])=>{w.searchParams.append(b,y)})):(v="POST",_=l);const k=new Headers(this.headers);return m&&k.set("Prefer",`count=${m}`),new e.default({method:v,url:w,headers:k,schema:this.schemaName,body:_,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return jo.default=n,jo}var qg;function db(){if(qg)return Pr;qg=1;var t=Pr&&Pr.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.PostgrestError=Pr.PostgrestBuilder=Pr.PostgrestTransformBuilder=Pr.PostgrestFilterBuilder=Pr.PostgrestQueryBuilder=Pr.PostgrestClient=void 0;const r=t(ub());Pr.PostgrestClient=r.default;const e=t(Lx());Pr.PostgrestQueryBuilder=e.default;const n=t(hh());Pr.PostgrestFilterBuilder=n.default;const s=t(Px());Pr.PostgrestTransformBuilder=s.default;const o=t(Fx());Pr.PostgrestBuilder=o.default;const l=t(Dx());return Pr.PostgrestError=l.default,Pr.default={PostgrestClient:r.default,PostgrestQueryBuilder:e.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:o.default,PostgrestError:l.default},Pr}var fb=db();const hb=ah(fb),{PostgrestClient:mb,PostgrestQueryBuilder:jj,PostgrestFilterBuilder:Aj,PostgrestTransformBuilder:Rj,PostgrestBuilder:Ij,PostgrestError:Oj}=hb;class gb{static detectEnvironment(){var r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((r=navigator.userAgent)===null||r===void 0)&&r.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const e=parseInt(process.versions.node.split(".")[0]);return e>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${e} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${e} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const r=this.detectEnvironment();if(r.constructor)return r.constructor;let e=r.error||"WebSocket not supported in this environment.";throw r.workaround&&(e+=`

Suggested solution: ${r.workaround}`),new Error(e)}static createWebSocket(r,e){const n=this.getWebSocketConstructor();return new n(r,e)}static isWebSocketSupported(){try{const r=this.detectEnvironment();return r.type==="native"||r.type==="ws"}catch{return!1}}}const pb="2.15.4",xb=`realtime-js/${pb}`,vb="1.0.0",Mf=1e4,yb=1e3,wb=100;var Yl;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Yl||(Yl={}));var Tr;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Tr||(Tr={}));var vs;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(vs||(vs={}));var $f;(function(t){t.websocket="websocket"})($f||($f={}));var Oi;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Oi||(Oi={}));class bb{constructor(){this.HEADER_LENGTH=1}decode(r,e){return r.constructor===ArrayBuffer?e(this._binaryDecode(r)):e(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const e=new DataView(r),n=new TextDecoder;return this._decodeBroadcast(r,e,n)}_decodeBroadcast(r,e,n){const s=e.getUint8(1),o=e.getUint8(2);let l=this.HEADER_LENGTH+2;const u=n.decode(r.slice(l,l+s));l=l+s;const f=n.decode(r.slice(l,l+o));l=l+o;const m=JSON.parse(n.decode(r.slice(l,r.byteLength)));return{ref:null,topic:u,event:f,payload:m}}}class Mx{constructor(r,e){this.callback=r,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Jt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Jt||(Jt={}));const Jg=(t,r,e={})=>{var n;const s=(n=e.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(r).reduce((o,l)=>(o[l]=_b(l,t,r,s),o),{})},_b=(t,r,e,n)=>{const s=r.find(u=>u.name===t),o=s?.type,l=e[t];return o&&!n.includes(o)?$x(o,l):Uf(l)},$x=(t,r)=>{if(t.charAt(0)==="_"){const e=t.slice(1,t.length);return Tb(r,e)}switch(t){case Jt.bool:return Sb(r);case Jt.float4:case Jt.float8:case Jt.int2:case Jt.int4:case Jt.int8:case Jt.numeric:case Jt.oid:return Eb(r);case Jt.json:case Jt.jsonb:return kb(r);case Jt.timestamp:return Nb(r);case Jt.abstime:case Jt.date:case Jt.daterange:case Jt.int4range:case Jt.int8range:case Jt.money:case Jt.reltime:case Jt.text:case Jt.time:case Jt.timestamptz:case Jt.timetz:case Jt.tsrange:case Jt.tstzrange:return Uf(r);default:return Uf(r)}},Uf=t=>t,Sb=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Eb=t=>{if(typeof t=="string"){const r=parseFloat(t);if(!Number.isNaN(r))return r}return t},kb=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(r){return console.log(`JSON parse error: ${r}`),t}return t},Tb=(t,r)=>{if(typeof t!="string")return t;const e=t.length-1,n=t[e];if(t[0]==="{"&&n==="}"){let o;const l=t.slice(1,e);try{o=JSON.parse("["+l+"]")}catch{o=l?l.split(","):[]}return o.map(u=>$x(r,u))}return t},Nb=t=>typeof t=="string"?t.replace(" ","T"):t,Ux=t=>{let r=t;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")+"/api/broadcast"};class pf{constructor(r,e,n={},s=Mf){this.channel=r,this.event=e,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,e){var n;return this._hasReceived(r)&&e((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:r,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:e}){this.recHooks.filter(n=>n.status===r).forEach(n=>n.callback(e))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var Yg;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Yg||(Yg={}));class Ql{constructor(r,e){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:o,onLeave:l,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ql.syncState(this.state,s,o,l),this.pendingDiffs.forEach(f=>{this.state=Ql.syncDiff(this.state,f,o,l)}),this.pendingDiffs=[],u()}),this.channel._on(n.diff,{},s=>{const{onJoin:o,onLeave:l,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ql.syncDiff(this.state,s,o,l),u())}),this.onJoin((s,o,l)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:o,newPresences:l})}),this.onLeave((s,o,l)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:o,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,e,n,s){const o=this.cloneDeep(r),l=this.transformState(e),u={},f={};return this.map(o,(m,p)=>{l[m]||(f[m]=p)}),this.map(l,(m,p)=>{const v=o[m];if(v){const w=p.map(y=>y.presence_ref),_=v.map(y=>y.presence_ref),k=p.filter(y=>_.indexOf(y.presence_ref)<0),b=v.filter(y=>w.indexOf(y.presence_ref)<0);k.length>0&&(u[m]=k),b.length>0&&(f[m]=b)}else u[m]=p}),this.syncDiff(o,{joins:u,leaves:f},n,s)}static syncDiff(r,e,n,s){const{joins:o,leaves:l}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(o,(u,f)=>{var m;const p=(m=r[u])!==null&&m!==void 0?m:[];if(r[u]=this.cloneDeep(f),p.length>0){const v=r[u].map(_=>_.presence_ref),w=p.filter(_=>v.indexOf(_.presence_ref)<0);r[u].unshift(...w)}n(u,p,f)}),this.map(l,(u,f)=>{let m=r[u];if(!m)return;const p=f.map(v=>v.presence_ref);m=m.filter(v=>p.indexOf(v.presence_ref)<0),r[u]=m,s(u,m,f),m.length===0&&delete r[u]}),r}static map(r,e){return Object.getOwnPropertyNames(r).map(n=>e(n,r[n]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((e,n)=>{const s=r[n];return"metas"in s?e[n]=s.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):e[n]=s,e},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Qg;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Qg||(Qg={}));var Zl;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Zl||(Zl={}));var la;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(la||(la={}));class mh{constructor(r,e={config:{}},n){this.topic=r,this.params=e,this.socket=n,this.bindings={},this.state=Tr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new pf(this,vs.join,this.params,this.timeout),this.rejoinTimer=new Mx(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Tr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Tr.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Tr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Tr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Tr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(vs.reply,{},(s,o)=>{this._trigger(this._replyEventName(o),s)}),this.presence=new Ql(this),this.broadcastEndpointURL=Ux(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(r,e=this.timeout){var n,s,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Tr.closed){const{config:{broadcast:l,presence:u,private:f}}=this.params,m=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(_=>_.filter))!==null&&s!==void 0?s:[],p=!!this.bindings[Zl.PRESENCE]&&this.bindings[Zl.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,v={},w={broadcast:l,presence:Object.assign(Object.assign({},u),{enabled:p}),postgres_changes:m,private:f};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(_=>r?.(la.CHANNEL_ERROR,_)),this._onClose(()=>r?.(la.CLOSED)),this.updateJoinPayload(Object.assign({config:w},v)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:_})=>{var k;if(this.socket.setAuth(),_===void 0){r?.(la.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,y=(k=b?.length)!==null&&k!==void 0?k:0,L=[];for(let G=0;G<y;G++){const j=b[G],{filter:{event:F,schema:ue,table:D,filter:V}}=j,ee=_&&_[G];if(ee&&ee.event===F&&ee.schema===ue&&ee.table===D&&ee.filter===V)L.push(Object.assign(Object.assign({},j),{id:ee.id}));else{this.unsubscribe(),this.state=Tr.errored,r?.(la.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=L,r&&r(la.SUBSCRIBED);return}}).receive("error",_=>{this.state=Tr.errored,r?.(la.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{r?.(la.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,e={}){return await this.send({type:"presence",event:"track",payload:r},e.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,e,n){return this.state===Tr.joined&&r===Zl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(r,e,n)}async send(r,e={}){var n,s;if(!this._canPush()&&r.type==="broadcast"){const{event:o,payload:l}=r,f={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:l,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(n=e.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=m.body)===null||s===void 0?void 0:s.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var l,u,f;const m=this._push(r.type,r,e.timeout||this.timeout);r.type==="broadcast"&&!(!((f=(u=(l=this.params)===null||l===void 0?void 0:l.config)===null||u===void 0?void 0:u.broadcast)===null||f===void 0)&&f.ack)&&o("ok"),m.receive("ok",()=>o("ok")),m.receive("error",()=>o("error")),m.receive("timeout",()=>o("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=Tr.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(vs.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new pf(this,vs.leave,{},r),n.receive("ok",()=>{e(),s("ok")}).receive("timeout",()=>{e(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Tr.closed,this.bindings={}}async _fetchWithTimeout(r,e,n){const s=new AbortController,o=setTimeout(()=>s.abort(),n),l=await this.socket.fetch(r,Object.assign(Object.assign({},e),{signal:s.signal}));return clearTimeout(o),l}_push(r,e,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new pf(this,r,e,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(r){if(r.startTimeout(),this.pushBuffer.push(r),this.pushBuffer.length>wb){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(r,e,n){return e}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,e,n){var s,o;const l=r.toLocaleLowerCase(),{close:u,error:f,leave:m,join:p}=vs;if(n&&[u,f,m,p].indexOf(l)>=0&&n!==this._joinRef())return;let w=this._onMessage(l,e,n);if(e&&!w)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(_=>{var k,b,y;return((k=_.filter)===null||k===void 0?void 0:k.event)==="*"||((y=(b=_.filter)===null||b===void 0?void 0:b.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===l}).map(_=>_.callback(w,n)):(o=this.bindings[l])===null||o===void 0||o.filter(_=>{var k,b,y,L,G,j;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in _){const F=_.id,ue=(k=_.filter)===null||k===void 0?void 0:k.event;return F&&((b=e.ids)===null||b===void 0?void 0:b.includes(F))&&(ue==="*"||ue?.toLocaleLowerCase()===((y=e.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const F=(G=(L=_?.filter)===null||L===void 0?void 0:L.event)===null||G===void 0?void 0:G.toLocaleLowerCase();return F==="*"||F===((j=e?.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===l}).map(_=>{if(typeof w=="object"&&"ids"in w){const k=w.data,{schema:b,table:y,commit_timestamp:L,type:G,errors:j}=k;w=Object.assign(Object.assign({},{schema:b,table:y,commit_timestamp:L,eventType:G,new:{},old:{},errors:j}),this._getPayloadRecords(k))}_.callback(w,n)})}_isClosed(){return this.state===Tr.closed}_isJoined(){return this.state===Tr.joined}_isJoining(){return this.state===Tr.joining}_isLeaving(){return this.state===Tr.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,e,n){const s=r.toLocaleLowerCase(),o={type:s,filter:e,callback:n};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(r,e){const n=r.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var o;return!(((o=s.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&mh.isEqual(s.filter,e))})),this}static isEqual(r,e){if(Object.keys(r).length!==Object.keys(e).length)return!1;for(const n in r)if(r[n]!==e[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(vs.close,{},r)}_onError(r){this._on(vs.error,{},e=>r(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Tr.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const e={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(e.new=Jg(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(e.old=Jg(r.columns,r.old_record)),e}}const xf=()=>{},Vu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Cb=[1e3,2e3,5e3,1e4],jb=1e4,Ab=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Rb{constructor(r,e){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Mf,this.transport=null,this.heartbeatIntervalMs=Vu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=xf,this.ref=0,this.reconnectTimer=null,this.logger=xf,this.conn=null,this.sendBuffer=[],this.serializer=new bb,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...l)=>Zo(async()=>{const{default:u}=await Promise.resolve().then(()=>el);return{default:u}},void 0).then(({default:u})=>u(...l)).catch(u=>{throw new Error(`Failed to load @supabase/node-fetch: ${u.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...l)=>o(...l)},!(!((n=e?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=e.params.apikey,this.endPoint=`${r}/${$f.websocket}`,this.httpEndpoint=Ux(r),this._initializeOptions(e),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(e?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=gb.createWebSocket(this.endpointURL())}catch(r){this._setConnectionState("disconnected");const e=r.message;throw e.includes("Node.js")?new Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:vb}))}disconnect(r,e){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},r?this.conn.close(r,e??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(r){const e=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const r=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,e,n){this.logger(r,e,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Yl.connecting:return Oi.Connecting;case Yl.open:return Oi.Open;case Yl.closing:return Oi.Closing;default:return Oi.Closed}}isConnected(){return this.connectionState()===Oi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(r,e={config:{}}){const n=`realtime:${r}`,s=this.getChannels().find(o=>o.topic===n);if(s)return s;{const o=new mh(`realtime:${r}`,e,this);return this.channels.push(o),o}}push(r){const{topic:e,event:n,payload:s,ref:o}=r,l=()=>{this.encode(r,u=>{var f;(f=this.conn)===null||f===void 0||f.send(u)})};this.log("push",`${e} ${n} (${o})`,s),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(r=null){this._authPromise=this._performAuth(r);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var r;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,(r=this.conn)===null||r===void 0||r.close(yb,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout()},Vu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let e=this.channels.find(n=>n.topic===r&&(n._isJoined()||n._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${r}"`),e.unsubscribe())}_remove(r){this.channels=this.channels.filter(e=>e.topic!==r.topic)}_onConnMessage(r){this.decode(r.data,e=>{if(e.topic==="phoenix"&&e.event==="phx_reply")try{this.heartbeatCallback(e.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:o,ref:l}=e,u=l?`(${l})`:"",f=o.status||"";this.log("receive",`${f} ${n} ${s} ${u}`.trim(),o),this.channels.filter(m=>m._isMember(n)).forEach(m=>m._trigger(s,o,l)),this._triggerStateCallbacks("message",e)})}_clearTimer(r){var e;r==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):r==="reconnect"&&((e=this.reconnectTimer)===null||e===void 0||e.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(r=>r.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(r){var e;this._setConnectionState("disconnected"),this.log("transport","close",r),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout(),this._triggerStateCallbacks("close",r)}_onConnError(r){this._setConnectionState("disconnected"),this.log("transport",`${r}`),this._triggerChanError(),this._triggerStateCallbacks("error",r)}_triggerChanError(){this.channels.forEach(r=>r._trigger(vs.error))}_appendParams(r,e){if(Object.keys(e).length===0)return r;const n=r.match(/\?/)?"&":"?",s=new URLSearchParams(e);return`${r}${n}${s}`}_workerObjectUrl(r){let e;if(r)e=r;else{const n=new Blob([Ab],{type:"application/javascript"});e=URL.createObjectURL(n)}return e}_setConnectionState(r,e=!1){this._connectionState=r,r==="connecting"?this._wasManualDisconnect=!1:r==="disconnecting"&&(this._wasManualDisconnect=e)}async _performAuth(r=null){let e;r?e=r:this.accessToken?e=await this.accessToken():e=this.accessTokenValue,this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(n=>{const s={access_token:e,version:xb};e&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(vs.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(r="general"){this.setAuth().catch(e=>{this.log("error",`error setting auth in ${r}`,e)})}_triggerStateCallbacks(r,e){try{this.stateChangeCallbacks[r].forEach(n=>{try{n(e)}catch(s){this.log("error",`error in ${r} callback`,s)}})}catch(n){this.log("error",`error triggering ${r} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Mx(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Vu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(r){var e,n,s,o,l,u,f,m,p;if(this.transport=(e=r?.transport)!==null&&e!==void 0?e:null,this.timeout=(n=r?.timeout)!==null&&n!==void 0?n:Mf,this.heartbeatIntervalMs=(s=r?.heartbeatIntervalMs)!==null&&s!==void 0?s:Vu.HEARTBEAT_INTERVAL,this.worker=(o=r?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(l=r?.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(u=r?.heartbeatCallback)!==null&&u!==void 0?u:xf,r?.params&&(this.params=r.params),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=r?.reconnectAfterMs)!==null&&f!==void 0?f:(v=>Cb[v-1]||jb),this.encode=(m=r?.encode)!==null&&m!==void 0?m:((v,w)=>w(JSON.stringify(v))),this.decode=(p=r?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=r?.workerUrl}}}class gh extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function Nr(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Ib extends gh{constructor(r,e,n){super(r),this.name="StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Bf extends gh{constructor(r,e){super(r),this.name="StorageUnknownError",this.originalError=e}}var Ob=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};const Bx=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>Zo(async()=>{const{default:n}=await Promise.resolve().then(()=>el);return{default:n}},void 0).then(({default:n})=>n(...e)):r=fetch,(...e)=>r(...e)},Db=()=>Ob(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Zo(()=>Promise.resolve().then(()=>el),void 0)).Response:Response}),Vf=t=>{if(Array.isArray(t))return t.map(e=>Vf(e));if(typeof t=="function"||t!==Object(t))return t;const r={};return Object.entries(t).forEach(([e,n])=>{const s=e.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));r[s]=Vf(n)}),r},Fb=t=>{if(typeof t!="object"||t===null)return!1;const r=Object.getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Bi=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};const vf=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Pb=(t,r,e)=>Bi(void 0,void 0,void 0,function*(){const n=yield Db();t instanceof n&&!e?.noResolveJson?t.json().then(s=>{const o=t.status||500,l=s?.statusCode||o+"";r(new Ib(vf(s),o,l))}).catch(s=>{r(new Bf(vf(s),s))}):r(new Bf(vf(t),t))}),Lb=(t,r,e,n)=>{const s={method:t,headers:r?.headers||{}};return t==="GET"||!n?s:(Fb(n)?(s.headers=Object.assign({"Content-Type":"application/json"},r?.headers),s.body=JSON.stringify(n)):s.body=n,r?.duplex&&(s.duplex=r.duplex),Object.assign(Object.assign({},s),e))};function Sc(t,r,e,n,s,o){return Bi(this,void 0,void 0,function*(){return new Promise((l,u)=>{t(e,Lb(r,n,s,o)).then(f=>{if(!f.ok)throw f;return n?.noResolveJson?f:f.json()}).then(f=>l(f)).catch(f=>Pb(f,u,n))})})}function od(t,r,e,n){return Bi(this,void 0,void 0,function*(){return Sc(t,"GET",r,e,n)})}function Ms(t,r,e,n,s){return Bi(this,void 0,void 0,function*(){return Sc(t,"POST",r,n,s,e)})}function Wf(t,r,e,n,s){return Bi(this,void 0,void 0,function*(){return Sc(t,"PUT",r,n,s,e)})}function Mb(t,r,e,n){return Bi(this,void 0,void 0,function*(){return Sc(t,"HEAD",r,Object.assign(Object.assign({},e),{noResolveJson:!0}),n)})}function Vx(t,r,e,n,s){return Bi(this,void 0,void 0,function*(){return Sc(t,"DELETE",r,n,s,e)})}var mn=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};const $b={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Zg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ub{constructor(r,e={},n,s){this.url=r,this.headers=e,this.bucketId=n,this.fetch=Bx(s)}uploadOrUpdate(r,e,n,s){return mn(this,void 0,void 0,function*(){try{let o;const l=Object.assign(Object.assign({},Zg),s);let u=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(l.upsert)});const f=l.metadata;typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",l.cacheControl),f&&o.append("metadata",this.encodeMetadata(f)),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.append("cacheControl",l.cacheControl),f&&o.append("metadata",this.encodeMetadata(f))):(o=n,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType,f&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(f)))),s?.headers&&(u=Object.assign(Object.assign({},u),s.headers));const m=this._removeEmptyFolders(e),p=this._getFinalPath(m),v=yield(r=="PUT"?Wf:Ms)(this.fetch,`${this.url}/object/${p}`,o,Object.assign({headers:u},l?.duplex?{duplex:l.duplex}:{}));return{data:{path:m,id:v.Id,fullPath:v.Key},error:null}}catch(o){if(Nr(o))return{data:null,error:o};throw o}})}upload(r,e,n){return mn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,e,n)})}uploadToSignedUrl(r,e,n,s){return mn(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(r),l=this._getFinalPath(o),u=new URL(this.url+`/object/upload/sign/${l}`);u.searchParams.set("token",e);try{let f;const m=Object.assign({upsert:Zg.upsert},s),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&n instanceof Blob?(f=new FormData,f.append("cacheControl",m.cacheControl),f.append("",n)):typeof FormData<"u"&&n instanceof FormData?(f=n,f.append("cacheControl",m.cacheControl)):(f=n,p["cache-control"]=`max-age=${m.cacheControl}`,p["content-type"]=m.contentType);const v=yield Wf(this.fetch,u.toString(),f,{headers:p});return{data:{path:o,fullPath:v.Key},error:null}}catch(f){if(Nr(f))return{data:null,error:f};throw f}})}createSignedUploadUrl(r,e){return mn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(r);const s=Object.assign({},this.headers);e?.upsert&&(s["x-upsert"]="true");const o=yield Ms(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),l=new URL(this.url+o.url),u=l.searchParams.get("token");if(!u)throw new gh("No token returned by API");return{data:{signedUrl:l.toString(),path:r,token:u},error:null}}catch(n){if(Nr(n))return{data:null,error:n};throw n}})}update(r,e,n){return mn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,e,n)})}move(r,e,n){return mn(this,void 0,void 0,function*(){try{return{data:yield Ms(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Nr(s))return{data:null,error:s};throw s}})}copy(r,e,n){return mn(this,void 0,void 0,function*(){try{return{data:{path:(yield Ms(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Nr(s))return{data:null,error:s};throw s}})}createSignedUrl(r,e,n){return mn(this,void 0,void 0,function*(){try{let s=this._getFinalPath(r),o=yield Ms(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:e},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${l}`)},{data:o,error:null}}catch(s){if(Nr(s))return{data:null,error:s};throw s}})}createSignedUrls(r,e,n){return mn(this,void 0,void 0,function*(){try{const s=yield Ms(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:r},{headers:this.headers}),o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${o}`):null})),error:null}}catch(s){if(Nr(s))return{data:null,error:s};throw s}})}download(r,e){return mn(this,void 0,void 0,function*(){const s=typeof e?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(e?.transform||{}),l=o?`?${o}`:"";try{const u=this._getFinalPath(r);return{data:yield(yield od(this.fetch,`${this.url}/${s}/${u}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(u){if(Nr(u))return{data:null,error:u};throw u}})}info(r){return mn(this,void 0,void 0,function*(){const e=this._getFinalPath(r);try{const n=yield od(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:Vf(n),error:null}}catch(n){if(Nr(n))return{data:null,error:n};throw n}})}exists(r){return mn(this,void 0,void 0,function*(){const e=this._getFinalPath(r);try{return yield Mb(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Nr(n)&&n instanceof Bf){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(r,e){const n=this._getFinalPath(r),s=[],o=e?.download?`download=${e.download===!0?"":e.download}`:"";o!==""&&s.push(o);const u=typeof e?.transform<"u"?"render/image":"object",f=this.transformOptsToQueryString(e?.transform||{});f!==""&&s.push(f);let m=s.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${n}${m}`)}}}remove(r){return mn(this,void 0,void 0,function*(){try{return{data:yield Vx(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(e){if(Nr(e))return{data:null,error:e};throw e}})}list(r,e,n){return mn(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},$b),e),{prefix:r||""});return{data:yield Ms(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Nr(s))return{data:null,error:s};throw s}})}listV2(r,e){return mn(this,void 0,void 0,function*(){try{const n=Object.assign({},r);return{data:yield Ms(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},e),error:null}}catch(n){if(Nr(n))return{data:null,error:n};throw n}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const e=[];return r.width&&e.push(`width=${r.width}`),r.height&&e.push(`height=${r.height}`),r.resize&&e.push(`resize=${r.resize}`),r.format&&e.push(`format=${r.format}`),r.quality&&e.push(`quality=${r.quality}`),e.join("&")}}const Bb="2.11.1",Vb={"X-Client-Info":`storage-js/${Bb}`};var Do=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};class Wb{constructor(r,e={},n,s){const o=new URL(r);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href,this.headers=Object.assign(Object.assign({},Vb),e),this.fetch=Bx(n)}listBuckets(){return Do(this,void 0,void 0,function*(){try{return{data:yield od(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(Nr(r))return{data:null,error:r};throw r}})}getBucket(r){return Do(this,void 0,void 0,function*(){try{return{data:yield od(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(e){if(Nr(e))return{data:null,error:e};throw e}})}createBucket(r,e={public:!1}){return Do(this,void 0,void 0,function*(){try{return{data:yield Ms(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Nr(n))return{data:null,error:n};throw n}})}updateBucket(r,e){return Do(this,void 0,void 0,function*(){try{return{data:yield Wf(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Nr(n))return{data:null,error:n};throw n}})}emptyBucket(r){return Do(this,void 0,void 0,function*(){try{return{data:yield Ms(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(Nr(e))return{data:null,error:e};throw e}})}deleteBucket(r){return Do(this,void 0,void 0,function*(){try{return{data:yield Vx(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(e){if(Nr(e))return{data:null,error:e};throw e}})}}class Hb extends Wb{constructor(r,e={},n,s){super(r,e,n,s)}from(r){return new Ub(this.url,this.headers,r,this.fetch)}}const zb="2.57.0";let Gl="";typeof Deno<"u"?Gl="deno":typeof document<"u"?Gl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Gl="react-native":Gl="node";const Gb={"X-Client-Info":`supabase-js-${Gl}/${zb}`},Kb={headers:Gb},Xb={schema:"public"},qb={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Jb={};var Yb=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};const Qb=t=>{let r;return t?r=t:typeof fetch>"u"?r=Ix:r=fetch,(...e)=>r(...e)},Zb=()=>typeof Headers>"u"?Ox:Headers,e_=(t,r,e)=>{const n=Qb(e),s=Zb();return(o,l)=>Yb(void 0,void 0,void 0,function*(){var u;const f=(u=yield r())!==null&&u!==void 0?u:t;let m=new s(l?.headers);return m.has("apikey")||m.set("apikey",t),m.has("Authorization")||m.set("Authorization",`Bearer ${f}`),n(o,Object.assign(Object.assign({},l),{headers:m}))})};var t_=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};function r_(t){return t.endsWith("/")?t:t+"/"}function n_(t,r){var e,n;const{db:s,auth:o,realtime:l,global:u}=t,{db:f,auth:m,realtime:p,global:v}=r,w={db:Object.assign(Object.assign({},f),s),auth:Object.assign(Object.assign({},m),o),realtime:Object.assign(Object.assign({},p),l),storage:{},global:Object.assign(Object.assign(Object.assign({},v),u),{headers:Object.assign(Object.assign({},(e=v?.headers)!==null&&e!==void 0?e:{}),(n=u?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>t_(this,void 0,void 0,function*(){return""})};return t.accessToken?w.accessToken=t.accessToken:delete w.accessToken,w}const Wx="2.71.1",Bo=30*1e3,Hf=3,yf=Hf*Bo,s_="http://localhost:9999",a_="supabase.auth.token",i_={"X-Client-Info":`gotrue-js/${Wx}`},zf="X-Supabase-Api-Version",Hx={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},o_=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,l_=600*1e3;class ph extends Error{constructor(r,e,n){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=n}}function _t(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class c_ extends ph{constructor(r,e,n){super(r,e,n),this.name="AuthApiError",this.status=e,this.code=n}}function u_(t){return _t(t)&&t.name==="AuthApiError"}class zx extends ph{constructor(r,e){super(r),this.name="AuthUnknownError",this.originalError=e}}class ri extends ph{constructor(r,e,n,s){super(r,n,s),this.name=e,this.status=n}}class Ka extends ri{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function d_(t){return _t(t)&&t.name==="AuthSessionMissingError"}class Wu extends ri{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Hu extends ri{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class zu extends ri{constructor(r,e=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function f_(t){return _t(t)&&t.name==="AuthImplicitGrantRedirectError"}class ep extends ri{constructor(r,e=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Gf extends ri{constructor(r,e){super(r,"AuthRetryableFetchError",e,void 0)}}function wf(t){return _t(t)&&t.name==="AuthRetryableFetchError"}class tp extends ri{constructor(r,e,n){super(r,"AuthWeakPasswordError",e,"weak_password"),this.reasons=n}}class Kf extends ri{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const ld="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),rp=` 	
\r=`.split(""),h_=(()=>{const t=new Array(128);for(let r=0;r<t.length;r+=1)t[r]=-1;for(let r=0;r<rp.length;r+=1)t[rp[r].charCodeAt(0)]=-2;for(let r=0;r<ld.length;r+=1)t[ld[r].charCodeAt(0)]=r;return t})();function np(t,r,e){if(t!==null)for(r.queue=r.queue<<8|t,r.queuedBits+=8;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;e(ld[n]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;e(ld[n]),r.queuedBits-=6}}function Gx(t,r,e){const n=h_[t];if(n>-1)for(r.queue=r.queue<<6|n,r.queuedBits+=6;r.queuedBits>=8;)e(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function sp(t){const r=[],e=l=>{r.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},o=l=>{p_(l,n,e)};for(let l=0;l<t.length;l+=1)Gx(t.charCodeAt(l),s,o);return r.join("")}function m_(t,r){if(t<=127){r(t);return}else if(t<=2047){r(192|t>>6),r(128|t&63);return}else if(t<=65535){r(224|t>>12),r(128|t>>6&63),r(128|t&63);return}else if(t<=1114111){r(240|t>>18),r(128|t>>12&63),r(128|t>>6&63),r(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function g_(t,r){for(let e=0;e<t.length;e+=1){let n=t.charCodeAt(e);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(e+1)-56320&65535|s)+65536,e+=1}m_(n,r)}}function p_(t,r,e){if(r.utf8seq===0){if(t<=127){e(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){r.utf8seq=n;break}if(r.utf8seq===2)r.codepoint=t&31;else if(r.utf8seq===3)r.codepoint=t&15;else if(r.utf8seq===4)r.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|t&63,r.utf8seq-=1,r.utf8seq===0&&e(r.codepoint)}}function x_(t){const r=[],e={queue:0,queuedBits:0},n=s=>{r.push(s)};for(let s=0;s<t.length;s+=1)Gx(t.charCodeAt(s),e,n);return new Uint8Array(r)}function v_(t){const r=[];return g_(t,e=>r.push(e)),new Uint8Array(r)}function y_(t){const r=[],e={queue:0,queuedBits:0},n=s=>{r.push(s)};return t.forEach(s=>np(s,e,n)),np(null,e,n),r.join("")}function w_(t){return Math.round(Date.now()/1e3)+t}function b_(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const r=Math.random()*16|0;return(t=="x"?r:r&3|8).toString(16)})}const xs=()=>typeof window<"u"&&typeof document<"u",ji={tested:!1,writable:!1},Kx=()=>{if(!xs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ji.tested)return ji.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ji.tested=!0,ji.writable=!0}catch{ji.tested=!0,ji.writable=!1}return ji.writable};function __(t){const r={},e=new URL(t);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((s,o)=>{r[o]=s})}catch{}return e.searchParams.forEach((n,s)=>{r[s]=n}),r}const Xx=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>Zo(async()=>{const{default:n}=await Promise.resolve().then(()=>el);return{default:n}},void 0).then(({default:n})=>n(...e)):r=fetch,(...e)=>r(...e)},S_=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Vo=async(t,r,e)=>{await t.setItem(r,JSON.stringify(e))},Ai=async(t,r)=>{const e=await t.getItem(r);if(!e)return null;try{return JSON.parse(e)}catch{return e}},za=async(t,r)=>{await t.removeItem(r)};class Ed{constructor(){this.promise=new Ed.promiseConstructor((r,e)=>{this.resolve=r,this.reject=e})}}Ed.promiseConstructor=Promise;function bf(t){const r=t.split(".");if(r.length!==3)throw new Kf("Invalid JWT structure");for(let n=0;n<r.length;n++)if(!o_.test(r[n]))throw new Kf("JWT not in base64url format");return{header:JSON.parse(sp(r[0])),payload:JSON.parse(sp(r[1])),signature:x_(r[2]),raw:{header:r[0],payload:r[1]}}}async function E_(t){return await new Promise(r=>{setTimeout(()=>r(null),t)})}function k_(t,r){return new Promise((n,s)=>{(async()=>{for(let o=0;o<1/0;o++)try{const l=await t(o);if(!r(o,null,l)){n(l);return}}catch(l){if(!r(o,l)){s(l);return}}})()})}function T_(t){return("0"+t.toString(16)).substr(-2)}function N_(){const r=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=e.length;let s="";for(let o=0;o<56;o++)s+=e.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(r),Array.from(r,T_).join("")}async function C_(t){const e=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",e),s=new Uint8Array(n);return Array.from(s).map(o=>String.fromCharCode(o)).join("")}async function j_(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const e=await C_(t);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Fo(t,r,e=!1){const n=N_();let s=n;e&&(s+="/PASSWORD_RECOVERY"),await Vo(t,`${r}-code-verifier`,s);const o=await j_(n);return[o,n===o?"plain":"s256"]}const A_=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function R_(t){const r=t.headers.get(zf);if(!r||!r.match(A_))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function I_(t){if(!t)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(t<=r)throw new Error("JWT has expired")}function O_(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const D_=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Po(t){if(!D_.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function _f(){const t={};return new Proxy(t,{get:(r,e)=>{if(e==="__isUserNotAvailableProxy")return!0;if(typeof e=="symbol"){const n=e.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${e}" property of the session object is not supported. Please use getUser() instead.`)},set:(r,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(r,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ap(t){return JSON.parse(JSON.stringify(t))}var F_=function(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(e[n[s]]=t[n[s]]);return e};const Ii=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),P_=[502,503,504];async function ip(t){var r;if(!S_(t))throw new Gf(Ii(t),0);if(P_.includes(t.status))throw new Gf(Ii(t),t.status);let e;try{e=await t.json()}catch(o){throw new zx(Ii(o),o)}let n;const s=R_(t);if(s&&s.getTime()>=Hx["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?n=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(n=e.error_code),n){if(n==="weak_password")throw new tp(Ii(e),t.status,((r=e.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(n==="session_not_found")throw new Ka}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((o,l)=>o&&typeof l=="string",!0))throw new tp(Ii(e),t.status,e.weak_password.reasons);throw new c_(Ii(e),t.status||500,n)}const L_=(t,r,e,n)=>{const s={method:t,headers:r?.headers||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),e))};async function jt(t,r,e,n){var s;const o=Object.assign({},n?.headers);o[zf]||(o[zf]=Hx["2024-01-01"].name),n?.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const l=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(l.redirect_to=n.redirectTo);const u=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",f=await M_(t,r,e+u,{headers:o,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(f):{data:Object.assign({},f),error:null}}async function M_(t,r,e,n,s,o){const l=L_(r,n,s,o);let u;try{u=await t(e,Object.assign({},l))}catch(f){throw console.error(f),new Gf(Ii(f),0)}if(u.ok||await ip(u),n?.noResolveJson)return u;try{return await u.json()}catch(f){await ip(f)}}function oa(t){var r;let e=null;V_(t)&&(e=Object.assign({},t),t.expires_at||(e.expires_at=w_(t.expires_in)));const n=(r=t.user)!==null&&r!==void 0?r:t;return{data:{session:e,user:n},error:null}}function op(t){const r=oa(t);return!r.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((e,n)=>e&&typeof n=="string",!0)&&(r.data.weak_password=t.weak_password),r}function Xa(t){var r;return{data:{user:(r=t.user)!==null&&r!==void 0?r:t},error:null}}function $_(t){return{data:t,error:null}}function U_(t){const{action_link:r,email_otp:e,hashed_token:n,redirect_to:s,verification_type:o}=t,l=F_(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:r,email_otp:e,hashed_token:n,redirect_to:s,verification_type:o},f=Object.assign({},l);return{data:{properties:u,user:f},error:null}}function B_(t){return t}function V_(t){return t.access_token&&t.refresh_token&&t.expires_in}const Sf=["global","local","others"];var W_=function(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(e[n[s]]=t[n[s]]);return e};class H_{constructor({url:r="",headers:e={},fetch:n}){this.url=r,this.headers=e,this.fetch=Xx(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,e=Sf[0]){if(Sf.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Sf.join(", ")}`);try{return await jt(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(n){if(_t(n))return{data:null,error:n};throw n}}async inviteUserByEmail(r,e={}){try{return await jt(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:Xa})}catch(n){if(_t(n))return{data:{user:null},error:n};throw n}}async generateLink(r){try{const{options:e}=r,n=W_(r,["options"]),s=Object.assign(Object.assign({},n),e);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await jt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:U_,redirectTo:e?.redirectTo})}catch(e){if(_t(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(r){try{return await jt(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:Xa})}catch(e){if(_t(e))return{data:{user:null},error:e};throw e}}async listUsers(r){var e,n,s,o,l,u,f;try{const m={nextPage:null,lastPage:0,total:0},p=await jt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(e=r?.page)===null||e===void 0?void 0:e.toString())!==null&&n!==void 0?n:"",per_page:(o=(s=r?.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:B_});if(p.error)throw p.error;const v=await p.json(),w=(l=p.headers.get("x-total-count"))!==null&&l!==void 0?l:0,_=(f=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&f!==void 0?f:[];return _.length>0&&(_.forEach(k=>{const b=parseInt(k.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(k.split(";")[1].split("=")[1]);m[`${y}Page`]=b}),m.total=parseInt(w)),{data:Object.assign(Object.assign({},v),m),error:null}}catch(m){if(_t(m))return{data:{users:[]},error:m};throw m}}async getUserById(r){Po(r);try{return await jt(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:Xa})}catch(e){if(_t(e))return{data:{user:null},error:e};throw e}}async updateUserById(r,e){Po(r);try{return await jt(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:e,headers:this.headers,xform:Xa})}catch(n){if(_t(n))return{data:{user:null},error:n};throw n}}async deleteUser(r,e=!1){Po(r);try{return await jt(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:e},xform:Xa})}catch(n){if(_t(n))return{data:{user:null},error:n};throw n}}async _listFactors(r){Po(r.userId);try{const{data:e,error:n}=await jt(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:e,error:n}}catch(e){if(_t(e))return{data:null,error:e};throw e}}async _deleteFactor(r){Po(r.userId),Po(r.id);try{return{data:await jt(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(e){if(_t(e))return{data:null,error:e};throw e}}}function lp(t={}){return{getItem:r=>t[r]||null,setItem:(r,e)=>{t[r]=e},removeItem:r=>{delete t[r]}}}function z_(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Lo={debug:!!(globalThis&&Kx()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class qx extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class G_ extends qx{}async function K_(t,r,e){Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,r);const n=new globalThis.AbortController;return r>0&&setTimeout(()=>{n.abort(),Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await e()}finally{Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(r===0)throw Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new G_(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Lo.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await e()}}))}z_();const X_={url:s_,storageKey:a_,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:i_,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function cp(t,r,e){return await e()}const Mo={};class uc{constructor(r){var e,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=uc.nextInstanceID,uc.nextInstanceID+=1,this.instanceID>0&&xs()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},X_),r);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new H_({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Xx(s.fetch),this.lock=s.lock||cp,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:xs()&&(!((e=globalThis?.navigator)===null||e===void 0)&&e.locks)?this.lock=K_:this.lock=cp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:Kx()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=lp(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=lp(this.memoryStorage)),xs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}get jwks(){var r,e;return(e=(r=Mo[this.storageKey])===null||r===void 0?void 0:r.jwks)!==null&&e!==void 0?e:{keys:[]}}set jwks(r){Mo[this.storageKey]=Object.assign(Object.assign({},Mo[this.storageKey]),{jwks:r})}get jwks_cached_at(){var r,e;return(e=(r=Mo[this.storageKey])===null||r===void 0?void 0:r.cachedAt)!==null&&e!==void 0?e:Number.MIN_SAFE_INTEGER}set jwks_cached_at(r){Mo[this.storageKey]=Object.assign(Object.assign({},Mo[this.storageKey]),{cachedAt:r})}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Wx}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const e=__(window.location.href);let n="none";if(this._isImplicitGrantCallback(e)?n="implicit":await this._isPKCECallback(e)&&(n="pkce"),xs()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:o}=await this._getSessionFromURL(e,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),f_(o)){const f=(r=o.details)===null||r===void 0?void 0:r.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:l,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",l,"redirect type",u),await this._saveSession(l),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return _t(e)?{error:e}:{error:new zx("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var e,n,s;try{const o=await jt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(e=r?.options)===null||e===void 0?void 0:e.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=r?.options)===null||s===void 0?void 0:s.captchaToken}},xform:oa}),{data:l,error:u}=o;if(u||!l)return{data:{user:null,session:null},error:u};const f=l.session,m=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:m,session:f},error:null}}catch(o){if(_t(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(r){var e,n,s;try{let o;if("email"in r){const{email:p,password:v,options:w}=r;let _=null,k=null;this.flowType==="pkce"&&([_,k]=await Fo(this.storage,this.storageKey)),o=await jt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:w?.emailRedirectTo,body:{email:p,password:v,data:(e=w?.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:w?.captchaToken},code_challenge:_,code_challenge_method:k},xform:oa})}else if("phone"in r){const{phone:p,password:v,options:w}=r;o=await jt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:v,data:(n=w?.data)!==null&&n!==void 0?n:{},channel:(s=w?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:w?.captchaToken}},xform:oa})}else throw new Hu("You must provide either an email or phone number and a password");const{data:l,error:u}=o;if(u||!l)return{data:{user:null,session:null},error:u};const f=l.session,m=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:m,session:f},error:null}}catch(o){if(_t(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(r){try{let e;if("email"in r){const{email:o,password:l,options:u}=r;e=await jt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:op})}else if("phone"in r){const{phone:o,password:l,options:u}=r;e=await jt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:op})}else throw new Hu("You must provide either an email or phone number and a password");const{data:n,error:s}=e;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Wu}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(e){if(_t(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(r){var e,n,s,o;return await this._handleProviderSignIn(r.provider,{redirectTo:(e=r.options)===null||e===void 0?void 0:e.redirectTo,scopes:(n=r.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=r.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=r.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:e}=r;if(e==="solana")return await this.signInWithSolana(r);throw new Error(`@supabase/auth-js: Unsupported chain "${e}"`)}async signInWithSolana(r){var e,n,s,o,l,u,f,m,p,v,w,_;let k,b;if("message"in r)k=r.message,b=r.signature;else{const{chain:y,wallet:L,statement:G,options:j}=r;let F;if(xs())if(typeof L=="object")F=L;else{const D=window;if("solana"in D&&typeof D.solana=="object"&&("signIn"in D.solana&&typeof D.solana.signIn=="function"||"signMessage"in D.solana&&typeof D.solana.signMessage=="function"))F=D.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof L!="object"||!j?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");F=L}const ue=new URL((e=j?.url)!==null&&e!==void 0?e:window.location.href);if("signIn"in F&&F.signIn){const D=await F.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},j?.signInWithSolana),{version:"1",domain:ue.host,uri:ue.href}),G?{statement:G}:null));let V;if(Array.isArray(D)&&D[0]&&typeof D[0]=="object")V=D[0];else if(D&&typeof D=="object"&&"signedMessage"in D&&"signature"in D)V=D;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in V&&"signature"in V&&(typeof V.signedMessage=="string"||V.signedMessage instanceof Uint8Array)&&V.signature instanceof Uint8Array)k=typeof V.signedMessage=="string"?V.signedMessage:new TextDecoder().decode(V.signedMessage),b=V.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in F)||typeof F.signMessage!="function"||!("publicKey"in F)||typeof F!="object"||!F.publicKey||!("toBase58"in F.publicKey)||typeof F.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");k=[`${ue.host} wants you to sign in with your Solana account:`,F.publicKey.toBase58(),...G?["",G,""]:[""],"Version: 1",`URI: ${ue.href}`,`Issued At: ${(s=(n=j?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((o=j?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${j.signInWithSolana.notBefore}`]:[],...!((l=j?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${j.signInWithSolana.expirationTime}`]:[],...!((u=j?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${j.signInWithSolana.chainId}`]:[],...!((f=j?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${j.signInWithSolana.nonce}`]:[],...!((m=j?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${j.signInWithSolana.requestId}`]:[],...!((v=(p=j?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||v===void 0)&&v.length?["Resources",...j.signInWithSolana.resources.map(V=>`- ${V}`)]:[]].join(`
`);const D=await F.signMessage(new TextEncoder().encode(k),"utf8");if(!D||!(D instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=D}}try{const{data:y,error:L}=await jt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:k,signature:y_(b)},!((w=r.options)===null||w===void 0)&&w.captchaToken?{gotrue_meta_security:{captcha_token:(_=r.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:oa});if(L)throw L;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Wu}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:L})}catch(y){if(_t(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(r){const e=await Ai(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(e??"").split("/");try{const{data:o,error:l}=await jt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:n},xform:oa});if(await za(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Wu}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:l})}catch(o){if(_t(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(r){try{const{options:e,provider:n,token:s,access_token:o,nonce:l}=r,u=await jt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:o,nonce:l,gotrue_meta_security:{captcha_token:e?.captchaToken}},xform:oa}),{data:f,error:m}=u;return m?{data:{user:null,session:null},error:m}:!f||!f.session||!f.user?{data:{user:null,session:null},error:new Wu}:(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),{data:f,error:m})}catch(e){if(_t(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(r){var e,n,s,o,l;try{if("email"in r){const{email:u,options:f}=r;let m=null,p=null;this.flowType==="pkce"&&([m,p]=await Fo(this.storage,this.storageKey));const{error:v}=await jt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(e=f?.data)!==null&&e!==void 0?e:{},create_user:(n=f?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:m,code_challenge_method:p},redirectTo:f?.emailRedirectTo});return{data:{user:null,session:null},error:v}}if("phone"in r){const{phone:u,options:f}=r,{data:m,error:p}=await jt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=f?.data)!==null&&s!==void 0?s:{},create_user:(o=f?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(l=f?.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:m?.message_id},error:p}}throw new Hu("You must provide either an email or phone number.")}catch(u){if(_t(u))return{data:{user:null,session:null},error:u};throw u}}async verifyOtp(r){var e,n;try{let s,o;"options"in r&&(s=(e=r.options)===null||e===void 0?void 0:e.redirectTo,o=(n=r.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:u}=await jt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:oa});if(u)throw u;if(!l)throw new Error("An error occurred on token verification.");const f=l.session,m=l.user;return f?.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),{data:{user:m,session:f},error:null}}catch(s){if(_t(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(r){var e,n,s;try{let o=null,l=null;return this.flowType==="pkce"&&([o,l]=await Fo(this.storage,this.storageKey)),await jt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(n=(e=r.options)===null||e===void 0?void 0:e.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=r?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:$_})}catch(o){if(_t(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:e},error:n}=r;if(n)throw n;if(!e)throw new Ka;const{error:s}=await jt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return{data:{user:null,session:null},error:s}})}catch(r){if(_t(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const e=`${this.url}/resend`;if("email"in r){const{email:n,type:s,options:o}=r,{error:l}=await jt(this.fetch,"POST",e,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in r){const{phone:n,type:s,options:o}=r,{data:l,error:u}=await jt(this.fetch,"POST",e,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:l?.message_id},error:u}}throw new Hu("You must provide either an email or phone number and a type")}catch(e){if(_t(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(r,e){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await e()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=e();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await r(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const e=await Ai(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?r=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const n=r.expires_at?r.expires_at*1e3-Date.now()<yf:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",r.expires_at),!n){if(this.userStorage){const l=await Ai(this.userStorage,this.storageKey+"-user");l?.user?r.user=l.user:r.user=_f()}if(this.storage.isServer&&r.user){let l=this.suppressGetSessionWarning;r=new Proxy(r,{get:(f,m,p)=>(!l&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(f,m,p))})}return{data:{session:r},error:null}}const{session:s,error:o}=await this._callRefreshToken(r.refresh_token);return o?{data:{session:null},error:o}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await jt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:Xa}):await this._useSession(async e=>{var n,s,o;const{data:l,error:u}=e;if(u)throw u;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ka}:await jt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:Xa})})}catch(e){if(_t(e))return d_(e)&&(await this._removeSession(),await za(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(r,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,e))}async _updateUser(r,e={}){try{return await this._useSession(async n=>{const{data:s,error:o}=n;if(o)throw o;if(!s.session)throw new Ka;const l=s.session;let u=null,f=null;this.flowType==="pkce"&&r.email!=null&&([u,f]=await Fo(this.storage,this.storageKey));const{data:m,error:p}=await jt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e?.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:u,code_challenge_method:f}),jwt:l.access_token,xform:Xa});if(p)throw p;return l.user=m.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(n){if(_t(n))return{data:{user:null},error:n};throw n}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new Ka;const e=Date.now()/1e3;let n=e,s=!0,o=null;const{payload:l}=bf(r.access_token);if(l.exp&&(n=l.exp,s=n<=e),s){const{session:u,error:f}=await this._callRefreshToken(r.refresh_token);if(f)return{data:{user:null,session:null},error:f};if(!u)return{data:{user:null,session:null},error:null};o=u}else{const{data:u,error:f}=await this._getUser(r.access_token);if(f)throw f;o={access_token:r.access_token,refresh_token:r.refresh_token,user:u.user,token_type:"bearer",expires_in:n-e,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(e){if(_t(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async e=>{var n;if(!r){const{data:l,error:u}=e;if(u)throw u;r=(n=l.session)!==null&&n!==void 0?n:void 0}if(!r?.refresh_token)throw new Ka;const{session:s,error:o}=await this._callRefreshToken(r.refresh_token);return o?{data:{user:null,session:null},error:o}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(_t(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(r,e){try{if(!xs())throw new zu("No browser detected.");if(r.error||r.error_description||r.error_code)throw new zu(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(e){case"implicit":if(this.flowType==="pkce")throw new ep("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new zu("Not a valid implicit grant flow url.");break;default:}if(e==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new ep("No code detected.");const{data:G,error:j}=await this._exchangeCodeForSession(r.code);if(j)throw j;const F=new URL(window.location.href);return F.searchParams.delete("code"),window.history.replaceState(window.history.state,"",F.toString()),{data:{session:G.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:o,refresh_token:l,expires_in:u,expires_at:f,token_type:m}=r;if(!o||!u||!l||!m)throw new zu("No session defined in URL");const p=Math.round(Date.now()/1e3),v=parseInt(u);let w=p+v;f&&(w=parseInt(f));const _=w-p;_*1e3<=Bo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${v}s`);const k=w-v;p-k>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",k,w,p):p-k<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",k,w,p);const{data:b,error:y}=await this._getUser(o);if(y)throw y;const L={provider_token:n,provider_refresh_token:s,access_token:o,expires_in:v,expires_at:w,refresh_token:l,token_type:m,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:L,redirectType:r.type},error:null}}catch(n){if(_t(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const e=await Ai(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&e)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async e=>{var n;const{data:s,error:o}=e;if(o)return{error:o};const l=(n=s.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:u}=await this.admin.signOut(l,r);if(u&&!(u_(u)&&(u.status===404||u.status===401||u.status===403)))return{error:u}}return r!=="others"&&(await this._removeSession(),await za(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const e=b_(),n={id:e,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:n}}}async _emitInitialSession(r){return await this._useSession(async e=>{var n,s;try{const{data:{session:o},error:l}=e;if(l)throw l;await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",r,"session",o)}catch(o){await((s=this.stateChangeEmitters.get(r))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",o),console.error(o)}})}async resetPasswordForEmail(r,e={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Fo(this.storage,this.storageKey,!0));try{return await jt(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(o){if(_t(o))return{data:null,error:o};throw o}}async getUserIdentities(){var r;try{const{data:e,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(r=e.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(e){if(_t(e))return{data:null,error:e};throw e}}async linkIdentity(r){var e;try{const{data:n,error:s}=await this._useSession(async o=>{var l,u,f,m,p;const{data:v,error:w}=o;if(w)throw w;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(l=r.options)===null||l===void 0?void 0:l.redirectTo,scopes:(u=r.options)===null||u===void 0?void 0:u.scopes,queryParams:(f=r.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await jt(this.fetch,"GET",_,{headers:this.headers,jwt:(p=(m=v.session)===null||m===void 0?void 0:m.access_token)!==null&&p!==void 0?p:void 0})});if(s)throw s;return xs()&&!(!((e=r.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:r.provider,url:n?.url},error:null}}catch(n){if(_t(n))return{data:{provider:r.provider,url:null},error:n};throw n}}async unlinkIdentity(r){try{return await this._useSession(async e=>{var n,s;const{data:o,error:l}=e;if(l)throw l;return await jt(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(s=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(e){if(_t(e))return{data:null,error:e};throw e}}async _refreshAccessToken(r){const e=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(e,"begin");try{const n=Date.now();return await k_(async s=>(s>0&&await E_(200*Math.pow(2,s-1)),this._debug(e,"refreshing attempt",s),await jt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:oa})),(s,o)=>{const l=200*Math.pow(2,s);return o&&wf(o)&&Date.now()+l-n<Bo})}catch(n){if(this._debug(e,"error",n),_t(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(e,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,e){const n=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",e,"url",n),xs()&&!e.skipBrowserRedirect&&window.location.assign(n),{data:{provider:r,url:n},error:null}}async _recoverAndRefresh(){var r,e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Ai(this.storage,this.storageKey);if(s&&this.userStorage){let l=await Ai(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:s.user},await Vo(this.userStorage,this.storageKey+"-user",l)),s.user=(r=l?.user)!==null&&r!==void 0?r:_f()}else if(s&&!s.user&&!s.user){const l=await Ai(this.storage,this.storageKey+"-user");l&&l?.user?(s.user=l.user,await za(this.storage,this.storageKey+"-user"),await Vo(this.storage,this.storageKey,s)):s.user=_f()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const o=((e=s.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<yf;if(this._debug(n,`session has${o?"":" not"} expired with margin of ${yf}s`),o){if(this.autoRefreshToken&&s.refresh_token){const{error:l}=await this._callRefreshToken(s.refresh_token);l&&(console.error(l),wf(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:u}=await this._getUser(s.access_token);!u&&l?.user?(s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(r){var e,n;if(!r)throw new Ka;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Ed;const{data:o,error:l}=await this._refreshAccessToken(r);if(l)throw l;if(!o.session)throw new Ka;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const u={session:o.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(o){if(this._debug(s,"error",o),_t(o)){const l={session:null,error:o};return wf(o)||await this._removeSession(),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(r,e,n=!0){const s=`#_notifyAllSubscribers(${r})`;this._debug(s,"begin",e,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:r,session:e});const o=[],l=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(r,e)}catch(f){o.push(f)}});if(await Promise.all(l),o.length>0){for(let u=0;u<o.length;u+=1)console.error(o[u]);throw o[0]}}finally{this._debug(s,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0;const e=Object.assign({},r),n=e.user&&e.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&e.user&&await Vo(this.userStorage,this.storageKey+"-user",{user:e.user});const s=Object.assign({},e);delete s.user;const o=ap(s);await Vo(this.storage,this.storageKey,o)}else{const s=ap(e);await Vo(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await za(this.storage,this.storageKey),await za(this.storage,this.storageKey+"-code-verifier"),await za(this.storage,this.storageKey+"-user"),this.userStorage&&await za(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&xs()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",r)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),Bo);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async e=>{const{data:{session:n}}=e;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-r)/Bo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Bo}ms, refresh threshold is ${Hf} ticks`),s<=Hf&&await this._callRefreshToken(n.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof qx)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xs()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const e=`#_onVisibilityChanged(${r})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,e,n){const s=[`provider=${encodeURIComponent(e)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[o,l]=await Fo(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(l)}`});s.push(u.toString())}if(n?.queryParams){const o=new URLSearchParams(n.queryParams);s.push(o.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${r}?${s.join("&")}`}async _unenroll(r){try{return await this._useSession(async e=>{var n;const{data:s,error:o}=e;return o?{data:null,error:o}:await jt(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(e){if(_t(e))return{data:null,error:e};throw e}}async _enroll(r){try{return await this._useSession(async e=>{var n,s;const{data:o,error:l}=e;if(l)return{data:null,error:l};const u=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:f,error:m}=await jt(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token});return m?{data:null,error:m}:(r.factorType==="totp"&&(!((s=f?.totp)===null||s===void 0)&&s.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),{data:f,error:null})})}catch(e){if(_t(e))return{data:null,error:e};throw e}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:s,error:o}=e;if(o)return{data:null,error:o};const{data:l,error:u}=await jt(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:u})})}catch(e){if(_t(e))return{data:null,error:e};throw e}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:s,error:o}=e;return o?{data:null,error:o}:await jt(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(e){if(_t(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(r){const{data:e,error:n}=await this._challenge({factorId:r.factorId});return n?{data:null,error:n}:await this._verify({factorId:r.factorId,challengeId:e.id,code:r.code})}async _listFactors(){const{data:{user:r},error:e}=await this.getUser();if(e)return{data:null,error:e};const n=r?.factors||[],s=n.filter(l=>l.factor_type==="totp"&&l.status==="verified"),o=n.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:n,totp:s,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var e,n;const{data:{session:s},error:o}=r;if(o)return{data:null,error:o};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=bf(s.access_token);let u=null;l.aal&&(u=l.aal);let f=u;((n=(e=s.user.factors)===null||e===void 0?void 0:e.filter(v=>v.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(f="aal2");const p=l.amr||[];return{data:{currentLevel:u,nextLevel:f,currentAuthenticationMethods:p},error:null}}))}async fetchJwk(r,e={keys:[]}){let n=e.keys.find(u=>u.kid===r);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(u=>u.kid===r),n&&this.jwks_cached_at+l_>s)return n;const{data:o,error:l}=await jt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=s,n=o.keys.find(u=>u.kid===r),!n)?null:n}async getClaims(r,e={}){try{let n=r;if(!n){const{data:_,error:k}=await this.getSession();if(k||!_.session)return{data:null,error:k};n=_.session.access_token}const{header:s,payload:o,signature:l,raw:{header:u,payload:f}}=bf(n);e?.allowExpired||I_(o.exp);const m=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,e?.keys?{keys:e.keys}:e?.jwks);if(!m){const{error:_}=await this.getUser(n);if(_)throw _;return{data:{claims:o,header:s,signature:l},error:null}}const p=O_(s.alg),v=await crypto.subtle.importKey("jwk",m,p,!0,["verify"]);if(!await crypto.subtle.verify(p,v,l,v_(`${u}.${f}`)))throw new Kf("Invalid JWT signature");return{data:{claims:o,header:s,signature:l},error:null}}catch(n){if(_t(n))return{data:null,error:n};throw n}}}uc.nextInstanceID=0;const q_=uc;class J_ extends q_{constructor(r){super(r)}}var Y_=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};class Q_{constructor(r,e,n){var s,o,l;if(this.supabaseUrl=r,this.supabaseKey=e,!r)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const u=r_(r),f=new URL(u);this.realtimeUrl=new URL("realtime/v1",f),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",f),this.storageUrl=new URL("storage/v1",f),this.functionsUrl=new URL("functions/v1",f);const m=`sb-${f.hostname.split(".")[0]}-auth-token`,p={db:Xb,realtime:Jb,auth:Object.assign(Object.assign({},qb),{storageKey:m}),global:Kb},v=n_(n??{},p);this.storageKey=(s=v.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(o=v.global.headers)!==null&&o!==void 0?o:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(w,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=v.auth)!==null&&l!==void 0?l:{},this.headers,v.global.fetch),this.fetch=e_(e,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.rest=new mb(new URL("rest/v1",f).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new Hb(this.storageUrl.href,this.headers,this.fetch,n?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new sb(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,e={},n={}){return this.rest.rpc(r,e,n)}channel(r,e={config:{}}){return this.realtime.channel(r,e)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,e;return Y_(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(e=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:o,storageKey:l,flowType:u,lock:f,debug:m},p,v){const w={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new J_({url:this.authUrl.href,headers:Object.assign(Object.assign({},w),p),storageKey:l,autoRefreshToken:r,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:o,flowType:u,lock:f,debug:m,fetch:v,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new Rb(this.realtimeUrl.href,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,n)=>{this._handleTokenChanged(e,"CLIENT",n?.access_token)})}_handleTokenChanged(r,e,n){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:r==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Z_=(t,r,e)=>new Q_(t,r,e);function eS(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}eS()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const tS="https://huqijhevmtgardkyeowa.supabase.co",Jx="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh1cWlqaGV2bXRnYXJka3llb3dhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcyNDgyNTQsImV4cCI6MjA3MjgyNDI1NH0.1G81Zif1YWQwISEGJw4XMzY89Rlvh6Jda1-j-roPZBk",Oe=Z_(tS,Jx),lt=Jx!=="YOUR_SUPABASE_ANON_KEY",rS=Object.freeze(Object.defineProperty({__proto__:null,isSupabaseConfigured:lt,supabase:Oe},Symbol.toStringTag,{value:"Module"})),Yx=R.createContext(void 0),Vi=()=>{const t=R.useContext(Yx);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},nS=({children:t})=>{const[r,e]=R.useState(null),[n,s]=R.useState(null),[o,l]=R.useState(!0);R.useEffect(()=>{Oe.auth.getSession().then(({data:{session:_}})=>{s(_),e(_?.user??null),l(!1)});const{data:{subscription:w}}=Oe.auth.onAuthStateChange((_,k)=>{s(k),e(k?.user??null),l(!1)});return()=>w.unsubscribe()},[]);const v={user:r,session:n,loading:o,signUp:async(w,_,k)=>{try{const{data:b,error:y}=await Oe.auth.signUp({email:w,password:_,options:{data:{full_name:k}}});if(y)return{error:y};if(b.user){const{error:L}=await Oe.from("user_profiles").insert([{user_id:b.user.id,full_name:k,role:"VIEWER"}]);L&&console.error("Error creating user profile:",L)}return{error:null}}catch(b){return{error:b}}},signIn:async(w,_)=>{const{error:k}=await Oe.auth.signInWithPassword({email:w,password:_});return{error:k}},signOut:async()=>{Object.keys(localStorage).forEach(k=>{k.startsWith("user_role_")&&localStorage.removeItem(k)});const{error:_}=await Oe.auth.signOut();_&&console.error("Sign out error:",_)},updateProfile:async w=>{if(!r)return{error:new Error("No user logged in")};const{error:_}=await Oe.from("user_profiles").update(w).eq("user_id",r.id);return{error:_}}};return c.jsx(Yx.Provider,{value:v,children:t})},sS=({isOpen:t,onClose:r,onSuccess:e})=>{const[n,s]=R.useState(!1),[o,l]=R.useState(""),[u,f]=R.useState(""),[m,p]=R.useState(""),[v,w]=R.useState(!1),[_,k]=R.useState(null),{signUp:b,signIn:y}=Vi(),L=async F=>{F.preventDefault(),w(!0),k(null);try{let ue;n?ue=await b(o,u,m):ue=await y(o,u),ue.error?k(ue.error.message||"An error occurred"):(e(),r())}catch{k("An unexpected error occurred")}finally{w(!1)}},G=()=>{l(""),f(""),p(""),k(null)},j=()=>{s(!n),G()};return t?c.jsxs("div",{className:"bg-slate-800 p-8 rounded-xl shadow-2xl max-w-md w-full border border-slate-700",children:[c.jsx("div",{className:"mb-6",children:c.jsx("h2",{className:"text-2xl font-bold text-white text-center",children:n?"Create Account":"Sign In"})}),c.jsxs("form",{onSubmit:L,className:"space-y-4",children:[n&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Full Name"}),c.jsx("input",{type:"text",value:m,onChange:F=>p(F.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",placeholder:"Enter your full name",required:n})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Email"}),c.jsx("input",{type:"email",value:o,onChange:F=>l(F.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",placeholder:"Enter your email",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Password"}),c.jsx("input",{type:"password",value:u,onChange:F=>f(F.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",placeholder:"Enter your password",required:!0,minLength:6})]}),_&&c.jsx("div",{className:"bg-red-900 border border-red-700 text-red-200 px-3 py-2 rounded text-sm",children:_}),c.jsx("button",{type:"submit",disabled:v,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors",children:v?"Loading...":n?"Create Account":"Sign In"})]}),c.jsx("div",{className:"mt-4 text-center",children:c.jsx("button",{onClick:j,className:"text-blue-400 hover:text-blue-300 text-sm",children:n?"Already have an account? Sign in":"Don't have an account? Sign up"})}),!n&&c.jsx("div",{className:"mt-3 text-center",children:c.jsx("button",{onClick:()=>{s(!0),G()},className:"text-green-400 hover:text-green-300 text-sm",children:"Create a new account"})}),n&&c.jsx("div",{className:"mt-4 p-3 bg-blue-900 rounded-lg",children:c.jsxs("p",{className:"text-blue-200 text-sm",children:[c.jsx("strong",{children:"Note:"})," After signing up, you'll be able to access the app immediately."]})})]}):null},aS=({onClose:t})=>{const{user:r,signOut:e,updateProfile:n}=Vi(),[s,o]=R.useState(null),[l,u]=R.useState(!0),[f,m]=R.useState(!1),[p,v]=R.useState(""),[w,_]=R.useState("VIEWER"),[k,b]=R.useState(!1),y=[{value:"VIEWER",label:"Viewer (Read Only)"},{value:"OPERATOR",label:"Operator (Limited Edit)"},{value:"EDITOR",label:"Editor (Full Access)"}];R.useEffect(()=>{r&&L()},[r]);const L=async()=>{if(r)try{const{data:F,error:ue}=await Oe.from("user_profiles").select("*").eq("user_id",r.id).single();if(ue){console.log("No profile found in database, using user metadata:",ue);const D={id:r.id,full_name:r.user_metadata?.full_name||r.email||"Unknown",role:r.user_metadata?.role||"VIEWER",email:r.email||"",created_at:r.created_at||new Date().toISOString()};o(D),v(D.full_name),_(D.role)}else o(F),v(F.full_name||""),_(F.role||"VIEWER")}catch(F){console.error("Error fetching profile:",F);const ue={id:r.id,full_name:r.user_metadata?.full_name||r.email||"Unknown",role:r.user_metadata?.role||"VIEWER",email:r.email||"",created_at:r.created_at||new Date().toISOString()};o(ue),v(ue.full_name),_(ue.role)}finally{u(!1)}},G=async()=>{if(r){b(!0);try{const{error:F}=await n({full_name:p,role:w});if(F)console.error("Error updating profile:",F),alert("Error updating profile");else{o(D=>D?{...D,full_name:p,role:w}:null),m(!1);const ue=new URLSearchParams(window.location.search).get("eventId")||window.location.pathname.includes("/run-of-show")?"current":null;ue&&localStorage.setItem(`user_role_${ue}_${r.id}`,w),t&&t()}}catch(F){console.error("Error updating profile:",F),alert("Error updating profile")}finally{b(!1)}}},j=async()=>{confirm("Are you sure you want to sign out?")&&await e()};return l?c.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),"Loading..."]}):s?c.jsxs("div",{className:"bg-slate-800 p-4 rounded-lg shadow-2xl w-80 border border-slate-700",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-bold text-white",children:"Profile"}),t&&c.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:""})]}),f?c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Full Name"}),c.jsx("input",{type:"text",value:p,onChange:F=>v(F.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-sm",placeholder:"Enter your full name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Role"}),c.jsx("select",{value:w,onChange:F=>_(F.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-sm",children:y.map(F=>c.jsx("option",{value:F.value,children:F.label},F.value))})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:G,disabled:k,className:"flex-1 px-3 py-2 bg-green-600 hover:bg-green-500 disabled:bg-slate-600 text-white text-sm rounded transition-colors",children:k?"Saving...":"Save"}),c.jsx("button",{onClick:()=>m(!1),className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded transition-colors",children:"Cancel"})]})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center text-white font-medium",children:(s.full_name||"U").charAt(0).toUpperCase()}),c.jsxs("div",{children:[c.jsx("div",{className:"text-white font-medium",children:s.full_name}),c.jsx("div",{className:"text-slate-400 text-sm",children:s.role}),c.jsx("div",{className:"text-slate-500 text-xs",children:r?.email})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>m(!0),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Edit Profile"}),c.jsx("button",{onClick:j,className:"px-3 py-2 bg-red-600 hover:bg-red-500 text-white text-sm rounded transition-colors",title:"Sign out",children:"Sign Out"})]})]})]}):c.jsx("div",{className:"text-slate-300",children:"Profile not found"})},Xf=()=>{const{user:t,signOut:r}=Vi(),[e,n]=R.useState(!1);return c.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-slate-800 border-b border-slate-700 px-6 py-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex items-center gap-4",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold text-lg",children:"R"})}),c.jsx("h1",{className:"text-xl font-bold text-white",children:"Run of Show"})]})}),t?c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-white font-semibold text-base",children:t.user_metadata?.full_name||t.email}),c.jsx("p",{className:"text-slate-300 text-xs",children:t.email})]}),c.jsx("button",{onClick:()=>{confirm("Are you sure you want to sign out?")&&r()},className:"px-3 py-1.5 bg-red-600 hover:bg-red-500 text-white text-sm rounded-md transition-colors",title:"Sign out",children:"Sign Out"})]}):c.jsx("div",{className:"flex items-center gap-4",children:c.jsx("div",{className:"text-slate-400 text-sm",children:"Please sign in to continue"})}),e&&c.jsx("div",{className:"absolute top-16 right-6 z-50",children:c.jsx(aS,{onClose:()=>n(!1)})})]})})},iS=({children:t})=>{const{user:r,loading:e}=Vi(),[n,s]=ad.useState(!1);return ad.useEffect(()=>{!e&&!r?s(!0):r&&s(!1)},[r,e]),e?c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 pt-16",children:[c.jsx(Xf,{}),c.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-80px)]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),c.jsx("p",{className:"text-slate-300",children:"Loading..."})]})})]}):r?c.jsx(c.Fragment,{children:t}):c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 pt-16",children:[c.jsx(Xf,{}),c.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-80px)]",children:c.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[c.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold text-2xl",children:"R"})}),c.jsx("h1",{className:"text-4xl font-bold text-white",children:"Run of Show"})]}),c.jsx("p",{className:"text-slate-300 text-lg",children:"Please sign in to access the Run of Show application."})]}),c.jsx(sS,{isOpen:n,onClose:()=>{},onSuccess:()=>{s(!1)}}),c.jsx("div",{className:"mt-4 text-center",children:c.jsx("button",{onClick:()=>s(!0),className:"text-blue-400 hover:text-blue-300 text-sm underline",children:"Already have an account? Sign in here"})})]})})]})},Gu=[{value:"Great Hall",label:"Great Hall",color:"bg-blue-600"},{value:"Briefing Center",label:"Briefing Center",color:"bg-green-600"},{value:"Lee Anderson",label:"Lee Anderson",color:"bg-purple-600"},{value:"Virtual Show",label:"Virtual Show",color:"bg-orange-600"},{value:"Off Site",label:"Off Site",color:"bg-red-600"}],up=[1,2,3,4,5];class qe{static async saveCalendarEvent(r){try{console.log(" Saving calendar event to Supabase:",r);const{data:e,error:n}=await Oe.from("calendar_events").insert([r]).select().single();return n?(console.error("Error saving calendar event:",n),this.saveCalendarToLocalStorage(r)):(console.log(" Calendar event saved to Supabase:",e),e)}catch(e){return console.error("Error saving calendar event:",e),this.saveCalendarToLocalStorage(r)}}static async updateCalendarEvent(r,e){try{console.log(" Updating calendar event in Supabase:",r,e);const{data:n,error:s}=await Oe.from("calendar_events").update({name:e.name,date:e.date,schedule_data:e.schedule_data,updated_at:new Date().toISOString()}).eq("id",r).select().single();return s?(console.error(" Error updating calendar event:",s),null):(console.log(" Calendar event updated successfully:",n),n)}catch(n){return console.error(" Exception updating calendar event:",n),null}}static async getCalendarEvents(){try{console.log(" Loading calendar events from Supabase...");const{data:r,error:e}=await Oe.from("calendar_events").select("*").order("date",{ascending:!1});return e?(console.error("Error fetching calendar events:",e),this.getCalendarFromLocalStorage()):(console.log(" Calendar events loaded from Supabase:",r?.length||0),r||[])}catch(r){return console.error("Error fetching calendar events:",r),this.getCalendarFromLocalStorage()}}static async getCalendarEvent(r){try{const{data:e,error:n}=await Oe.from("calendar_events").select("*").eq("id",r).single();return n?(console.error("Error fetching calendar event:",n),this.getCalendarFromLocalStorageById(r)):e}catch(e){return console.error("Error fetching calendar event:",e),this.getCalendarFromLocalStorageById(r)}}static async deleteCalendarEvent(r){try{const{error:e}=await Oe.from("calendar_events").delete().eq("id",r);return e?(console.error("Error deleting calendar event:",e),this.deleteCalendarFromLocalStorage(r)):!0}catch(e){return console.error("Error deleting calendar event:",e),this.deleteCalendarFromLocalStorage(r)}}static async logChange(r,e,n,s,o,l,u,f,m,p,v,w,_,k){try{console.log("Calling log_change with parameters:",{p_event_id:r,p_user_id:e,p_user_name:n,p_user_role:s,p_action:o,p_table_name:l,p_record_id:u,p_field_name:f,p_row_number:w,p_cue_number:_});const b={p_event_id:r,p_user_id:e,p_user_name:n,p_user_role:s,p_action:o,p_table_name:l,p_record_id:u||null,p_field_name:f||null,p_old_value:m?JSON.stringify(m):null,p_new_value:p?JSON.stringify(p):null,p_description:v||null,p_metadata:k||{},p_row_number:w||null,p_cue_number:_?typeof _=="string"?parseInt(_,10):_:null};console.log("Calling log_change with cleaned parameters:",b);const{data:y,error:L}=await Oe.rpc("log_change",b);return L?(console.error(" Error logging change:",L),console.error(" Parameters that caused error:",b),null):(console.log(" Change logged:",{action:o,tableName:l,recordId:u,changeId:y}),y)}catch(b){return console.error("Error logging change:",b),null}}static async logFieldChanges(r,e,n,s,o,l,u,f){try{for(const m of u)await this.logChange(r,e,n,s,"UPDATE",o,l,m.fieldName,m.oldValue,m.newValue,f)}catch(m){console.error("Error logging field changes:",m)}}static async getChangeLog(r,e=50,n=0){try{const{data:s,error:o}=await Oe.rpc("get_change_log",{p_event_id:r,p_limit:e,p_offset:n});return o?(console.error(" Error fetching change log:",o),[]):s||[]}catch(s){return console.error("Error fetching change log:",s),[]}}static async getRecordChangeLog(r,e,n,s=20){try{const{data:o,error:l}=await Oe.rpc("get_record_change_log",{p_event_id:r,p_table_name:e,p_record_id:n,p_limit:s});return l?(console.error(" Error fetching record change log:",l),[]):o||[]}catch(o){return console.error("Error fetching record change log:",o),[]}}static async getChangeLogSummary(r){try{const{data:e,error:n}=await Oe.rpc("get_change_log_summary",{p_event_id:r});return n?(console.error(" Error fetching change log summary:",n),null):e?.[0]||null}catch(e){return console.error("Error fetching change log summary:",e),null}}static async cleanupOldChangeLogs(){try{const{data:r,error:e}=await Oe.rpc("cleanup_old_change_logs");return e?(console.error(" Error cleaning up old change logs:",e),0):(console.log(" Cleaned up old change logs:",r),r||0)}catch(r){return console.error("Error cleaning up old change logs:",r),0}}static async saveRunOfShowData(r,e){try{console.log(" Saving run of show data to Supabase:",{eventId:r.event_id,scheduleItemsCount:r.schedule_items?.length||0,customColumnsCount:r.custom_columns?.length||0,settingsKeys:Object.keys(r.settings||{}),userInfo:e?`${e.userName} (${e.userRole})`:"No user info"});const n=new Date().toISOString(),s={...r,last_modified_by:e?.userId,last_modified_by_name:e?.userName,last_modified_by_role:e?.userRole,updated_at:n},{data:o,error:l}=await Oe.from("run_of_show_data").select("*").eq("event_id",r.event_id).single();let u;if(o&&!l){console.log(" Updating existing record for event:",r.event_id);const f=o.last_change_at||n,{data:m,error:p}=await Oe.from("run_of_show_data").update({event_name:s.event_name,event_date:s.event_date,schedule_items:s.schedule_items,custom_columns:s.custom_columns,settings:s.settings,last_modified_by:s.last_modified_by,last_modified_by_name:s.last_modified_by_name,last_modified_by_role:s.last_modified_by_role,updated_at:s.updated_at,last_change_at:f}).eq("event_id",r.event_id).select().single();if(p)throw console.error(" Error updating run of show data:",p),p;u=m}else{console.log(" Inserting new record for event:",r.event_id);const f={...s,last_change_at:n},{data:m,error:p}=await Oe.from("run_of_show_data").insert([f]).select().single();if(p)throw console.error(" Error inserting run of show data:",p),p;u=m}return console.log(" Run of show data saved to Supabase successfully"),u}catch(n){console.error(" Error saving run of show data:",n),console.error(" Error details:",n.message,n.details,n.hint);const s={...r,last_modified_by:e?.userId,last_modified_by_name:e?.userName,last_modified_by_role:e?.userRole,updated_at:new Date().toISOString()};return this.saveRunOfShowToLocalStorage(s)}}static async updateRunOfShowData(r,e){try{console.log(" Updating run of show data in Supabase for event:",r,e);const{data:n,error:s}=await Oe.from("run_of_show_data").update({...e,updated_at:new Date().toISOString()}).eq("event_id",r).select().single();return s?(console.error(" Error updating run of show data:",s),null):(console.log(" Run of show data updated successfully:",n),n)}catch(n){return console.error(" Exception updating run of show data:",n),null}}static async getRunOfShowData(r){try{console.log(" Loading run of show data from Supabase for event:",r),console.log(" Supabase configured:",lt),console.log(" Executing Supabase query...");const{data:e,error:n}=await Oe.from("run_of_show_data").select("*").eq("event_id",r).single();return console.log(" Supabase query completed. Error:",n),console.log(" Supabase query data:",e),n?(console.error(" Error fetching run of show data:",n),console.error(" Error details:",{message:n.message,details:n.details,hint:n.hint,code:n.code}),console.log(" Falling back to localStorage..."),this.getRunOfShowFromLocalStorageById(r)):(console.log(" Run of show data loaded from Supabase:",e?"Found":"Not found"),e&&console.log(" Data structure:",{hasScheduleItems:!!e.schedule_items,scheduleItemsLength:e.schedule_items?.length||0,hasCustomColumns:!!e.custom_columns,customColumnsLength:e.custom_columns?.length||0,hasSettings:!!e.settings}),e)}catch(e){return console.error(" Exception in getRunOfShowData:",e),console.error(" Exception details:",{message:e.message,stack:e.stack,eventId:r}),console.log(" Falling back to localStorage due to exception..."),this.getRunOfShowFromLocalStorageById(r)}}static async deleteRunOfShowData(r){try{const{error:e}=await Oe.from("run_of_show_data").delete().eq("event_id",r);return e?(console.error("Error deleting run of show data:",e),this.deleteRunOfShowFromLocalStorage(r)):!0}catch(e){return console.error("Error deleting run of show data:",e),this.deleteRunOfShowFromLocalStorage(r)}}static saveCalendarToLocalStorage(r){const e=this.getCalendarFromLocalStorage(),n={...r,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return e.unshift(n),localStorage.setItem("calendar_events",JSON.stringify(e)),console.log(" Calendar event saved to localStorage"),n}static getCalendarFromLocalStorage(){try{const r=localStorage.getItem("calendar_events"),e=r?JSON.parse(r):[];return console.log(" Calendar events loaded from localStorage:",e.length),e}catch(r){return console.error("Error reading from localStorage:",r),[]}}static getCalendarFromLocalStorageById(r){return this.getCalendarFromLocalStorage().find(n=>n.id===r)||null}static deleteCalendarFromLocalStorage(r){try{const n=this.getCalendarFromLocalStorage().filter(s=>s.id!==r);return localStorage.setItem("calendar_events",JSON.stringify(n)),!0}catch(e){return console.error("Error deleting from localStorage:",e),!1}}static saveRunOfShowToLocalStorage(r){const e=this.getAllRunOfShowFromLocalStorage(),n=new Date().toISOString(),s=e.findIndex(l=>l.event_id===r.event_id);let o;if(s>=0){const l=e[s],u=l.last_change_at||n;o={...r,id:l.id,created_at:l.created_at,updated_at:n,last_change_at:u},e[s]=o}else o={...r,id:Date.now().toString(),created_at:n,updated_at:n,last_change_at:n},e.push(o);return localStorage.setItem("run_of_show_data",JSON.stringify(e)),console.log(" Run of show data saved to localStorage"),o}static getAllRunOfShowFromLocalStorage(){try{const r=localStorage.getItem("run_of_show_data");return r?JSON.parse(r):[]}catch(r){return console.error("Error reading run of show data from localStorage:",r),[]}}static getRunOfShowFromLocalStorageById(r){console.log(" Loading from localStorage for event:",r);const e=this.getAllRunOfShowFromLocalStorage();console.log(" All localStorage data:",e);const n=e.find(s=>s.event_id===r);return console.log(" Found data for event:",n?"Yes":"No"),n&&console.log(" Found data structure:",{hasScheduleItems:!!n.schedule_items,scheduleItemsLength:n.schedule_items?.length||0,hasCustomColumns:!!n.custom_columns,customColumnsLength:n.custom_columns?.length||0,hasSettings:!!n.settings}),n||null}static deleteRunOfShowFromLocalStorage(r){try{const n=this.getAllRunOfShowFromLocalStorage().filter(s=>s.event_id!==r);return localStorage.setItem("run_of_show_data",JSON.stringify(n)),!0}catch(e){return console.error("Error deleting run of show data from localStorage:",e),!1}}static async checkForChanges(r,e){try{console.log(" Checking for changes:",{eventId:r,localLastChangeAt:e,isSupabaseConfigured:lt});const{data:n,error:s}=await Oe.from("run_of_show_data").select("updated_at, last_change_at, last_modified_by, last_modified_by_name").eq("event_id",r).single();if(s||!n)return console.error(" Error checking for changes:",s),console.error(" Event ID:",r),console.error(" Supabase configured:",lt),{hasChanges:!1};if(console.log(" Change check data:",n),!e)return{hasChanges:!0,lastChangeAt:n.last_change_at,updatedAt:n.updated_at,lastModifiedBy:n.last_modified_by,lastModifiedByName:n.last_modified_by_name};const o=e?n.updated_at!==e:!1;return console.log(" Change detection:",{localLastChangeAt:e,serverUpdatedAt:n.updated_at,hasChanges:o,lastChangeAt:n.last_change_at}),{hasChanges:o,lastChangeAt:n.last_change_at,updatedAt:n.updated_at,lastModifiedBy:n.last_modified_by,lastModifiedByName:n.last_modified_by_name}}catch(n){return console.error(" Error checking for changes:",n),{hasChanges:!1}}}static async loadChangesDynamically(r){try{console.log(" Loading changes dynamically for event:",r);const{data:e,error:n}=await Oe.from("run_of_show_data").select("*").eq("event_id",r).single();return n?(console.error(" Error loading changes:",n),null):(console.log(" Changes loaded successfully"),e)}catch(e){return console.error(" Error loading changes dynamically:",e),null}}static async saveUserSession(r,e,n,s){try{console.log(" Saving authenticated user session:",{eventId:r,userId:e,username:n,role:s});const{data:o,error:l}=await Oe.rpc("get_or_create_user_session",{p_user_id:e,p_event_id:r,p_user_role:s});return l?(console.error(" Supabase error saving user session:",l),console.error(" Error details:",l.message,l.details,l.hint),this.saveUserSessionToLocalStorage(r,n,s)):(console.log(" Authenticated user session saved to Supabase:",o),!0)}catch(o){return console.error("Error saving user session:",o),this.saveUserSessionToLocalStorage(r,n,s)}}static async getCurrentUserSession(r,e){try{let n=Oe.from("user_sessions").select("id, event_id, user_role").eq("user_id",r);e&&(n=n.eq("event_id",e));const{data:s,error:o}=await n.order("created_at",{ascending:!1}).limit(1);return o?(console.error(" Error getting current user session:",o),this.getCurrentUserSessionFromLocalStorage()):s?.[0]||null}catch(n){return console.error("Error getting current user session:",n),this.getCurrentUserSessionFromLocalStorage()}}static async updateUserActivity(r){try{const{error:e}=await Oe.rpc("update_user_activity",{p_user_id:r});e&&console.error(" Error updating user activity:",e)}catch(e){console.error("Error updating user activity:",e)}}static async cleanupInactiveSessions(){try{const{data:r,error:e}=await Oe.rpc("cleanup_inactive_sessions");e?console.error(" Error cleaning up inactive sessions:",e):console.log(" Cleaned up inactive sessions:",r)}catch(r){console.error("Error cleaning up inactive sessions:",r)}}static saveUserSessionToLocalStorage(r,e,n){try{const s={event_id:r,username:e,role:n,session_started_at:new Date().toISOString(),last_activity_at:new Date().toISOString(),is_active:!0};return localStorage.setItem(`current_user_session_${e}`,JSON.stringify(s)),localStorage.setItem(`user_role_${r}_${e}`,n),console.log(" User session saved to localStorage"),!0}catch(s){return console.error("Error saving user session to localStorage:",s),!1}}static getCurrentUserSessionFromLocalStorage(){try{const r=Object.keys(localStorage);let e=null,n=0;for(const s of r)if(s.startsWith("current_user_session_")){const o=JSON.parse(localStorage.getItem(s)||"{}");if(o.is_active&&o.last_activity_at){const l=new Date(o.last_activity_at).getTime();l>n&&(n=l,e=o)}}return e}catch(r){return console.error("Error getting current user session from localStorage:",r),null}}static async loadCue(r,e,n,s,o,l,u){try{const{data:f,error:m}=await Oe.rpc("load_cue_for_event",{p_event_id:r,p_item_id:e.toString(),p_user_id:n,p_duration_seconds:s,p_row_is:o||null,p_cue_is:l||null,p_timer_id:u||null});return m?(console.error(" Error loading CUE in Supabase:",m),console.error(" Error details:",m.message,m.details,m.hint),console.error(" Error code:",m.code),(m.code==="PGRST204"||m.message.includes("Could not find"))&&console.warn(" Timer functions do not exist. Please run the optimized-timer-schema.sql migration script first."),!1):(console.log(" CUE loaded in Supabase:",f),f)}catch(f){return console.error(" Error loading CUE:",f),!1}}static async startTimer(r,e,n,s,o,l,u,f){try{const{data:m,error:p}=await Oe.rpc("start_timer_for_event",{p_event_id:r,p_item_id:e.toString(),p_user_id:n,p_row_is:l||null,p_cue_is:u||null,p_timer_id:f||null});return p?(console.error(" Error starting timer in Supabase:",p),console.error(" Error details:",p.message,p.details,p.hint),console.error(" Error code:",p.code),!1):(console.log(" Timer started in Supabase (UPSERT):",m),!0)}catch(m){return console.error("Error starting timer:",m),!1}}static async stopTimer(r,e,n){try{const{data:s,error:o}=await Oe.from("active_timers").update({is_running:!1,is_active:!1,timer_state:"stopped"}).eq("event_id",r).select();return o?(console.error(" Error stopping timer in Supabase:",o),!1):(console.log(" Timer stopped in Supabase:",s),!0)}catch(s){return console.error("Error stopping timer:",s),!1}}static async updateTimerDuration(r,e,n){try{console.log(` Updating timer duration for event ${r}, item ${e} to ${n}s`);const{data:s,error:o}=await Oe.from("active_timers").update({duration_seconds:n}).eq("event_id",r).eq("item_id",e);return o?(console.error(" Error updating timer duration in Supabase:",o),!1):(console.log(" Timer duration updated in Supabase:",s),!0)}catch(s){return console.error("Error updating timer duration:",s),!1}}static async stopAllTimersForEvent(r,e){try{const{data:n,error:s}=await Oe.rpc("stop_timer_for_event",{p_event_id:r});return s?(console.error(" Error stopping all timers in Supabase:",s),!1):(console.log(" All timers stopped in Supabase"),!0)}catch(n){return console.error("Error stopping all timers:",n),!1}}static async getActiveTimer(r){try{const{data:e,error:n}=await Oe.from("active_timers").select("*").eq("event_id",r).eq("is_active",!0).single();if(n)return console.error(" Error getting active timer from Supabase:",n),null;if(e)if(e.timer_state==="running"&&e.started_at){const s=new Date,o=new Date(e.started_at),l=s.getTime()-o.getTime();e.elapsed_seconds=Math.floor(l/1e3)}else e.elapsed_seconds=0;return e}catch(e){return console.error("Error getting active timer:",e),null}}static subscribeToTimerChanges(r,e){return Oe.channel("active_timers_changes").on("postgres_changes",{event:"*",schema:"public",table:"active_timers",filter:`event_id=eq.${r}`},e).subscribe()}static async hasActiveSubCueTimer(r){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping has active sub-cue timer check"),{data:!1,error:null};const{data:e,error:n}=await Oe.rpc("has_active_sub_cue_timer_for_event",{p_event_id:r});return n?(console.error(" Error checking active sub-cue timer:",n),{data:!1,error:n}):{data:e||!1,error:null}}catch(e){return console.error(" Error checking active sub-cue timer:",e),{data:!1,error:e}}}static async getActiveSubCueTimer(r){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping get active sub-cue timer"),{data:null,error:null};const{data:e,error:n}=await Oe.rpc("get_active_sub_cue_timers_for_event",{p_event_id:r});return n?(console.error(" Error getting active sub-cue timer:",n),{data:null,error:n}):{data:e?.[0]||null,error:null}}catch(e){return console.error(" Error getting active sub-cue timer:",e),{data:null,error:e}}}static async getActiveSubCueTimers(r){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping get active sub-cue timers"),{data:null,error:null};const{data:e,error:n}=await Oe.rpc("get_active_sub_cue_timers_for_event",{p_event_id:r});if(n&&n.code==="PGRST204"){console.log(" RPC function not found, using direct table query for sub-cue timers");const{data:s,error:o}=await Oe.from("sub_cue_timers").select("*").eq("event_id",r).eq("is_active",!0).eq("is_running",!0).order("created_at",{ascending:!1});return o?(console.error(" Error getting active sub-cue timers from table:",o),{data:null,error:o}):{data:s||[],error:null}}return n?(console.error(" Error getting active sub-cue timers:",n),{data:null,error:n}):{data:e||[],error:null}}catch(e){return console.error(" Error getting active sub-cue timers:",e),{data:null,error:e}}}static async startSubCueTimer(r,e,n,s,o,l,u){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping start sub-cue timer"),{data:null,error:null};console.log(" Calling start_sub_cue_timer_for_event with params:",{p_event_id:r,p_item_id:e.toString(),p_user_id:n,p_duration_seconds:s,p_row_is:o,p_cue_is:l,p_timer_id:u}),console.log(" About to call RPC function...");const{data:f,error:m}=await Oe.rpc("start_sub_cue_timer_for_event",{p_event_id:r,p_item_id:e.toString(),p_user_id:n,p_duration_seconds:s,p_row_is:o||null,p_cue_is:l||null,p_timer_id:u||null});return console.log(" RPC response:",{data:f,error:m}),m?(console.error(" Error starting sub-cue timer:",m),console.error(" Error details:",JSON.stringify(m,null,2)),{data:null,error:m}):{data:f,error:null}}catch(f){return console.error(" Error starting sub-cue timer:",f),{data:null,error:f}}}static async expireCompletedSubCueTimers(){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping expire completed sub-cue timers"),{data:0,error:null};const{data:r,error:e}=await Oe.rpc("expire_completed_sub_cue_timers");return e?(console.error(" Error expiring completed sub-cue timers:",e),{data:0,error:e}):{data:r||0,error:null}}catch(r){return console.error(" Error expiring completed sub-cue timers:",r),{data:0,error:r}}}static async stopSubCueTimer(r,e){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping stop sub-cue timer"),{data:null,error:null};const{data:n,error:s}=await Oe.rpc("stop_sub_cue_timer_for_event",{p_event_id:r,p_item_id:null});return s?(console.error(" Error stopping sub-cue timer:",s),console.error(" Error details:",JSON.stringify(s,null,2)),{data:null,error:s}):{data:n,error:null}}catch(n){return console.error(" Error stopping sub-cue timer:",n),{data:null,error:n}}}static async getActiveSecondaryTimer(r){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping get active secondary timer"),{data:null,error:null};const{data:e,error:n}=await Oe.rpc("get_active_secondary_timer_for_event",{p_event_id:r});if(n&&n.code==="PGRST204"){console.log(" RPC function not found, trying secondary_timers table");const{data:s,error:o}=await Oe.from("secondary_timers").select("*").eq("event_id",r).eq("is_active",!0).eq("is_running",!0).order("created_at",{ascending:!1}).limit(1);if(o&&(o.code==="42P01"||o.message.includes("does not exist"))){console.log(" secondary_timers table not found, using sub_cue_timers as secondary timer");const{data:l,error:u}=await Oe.from("sub_cue_timers").select("*").eq("event_id",r).eq("is_active",!0).eq("is_running",!0).order("created_at",{ascending:!1}).limit(1);return u?(console.error(" Error getting sub-cue timers as secondary timer:",u),{data:null,error:u}):(console.log(" Using sub-cue timer as secondary timer:",l&&l.length>0?l[0]:null),{data:l&&l.length>0?l[0]:null,error:null})}return o?(console.error(" Error getting active secondary timer from table:",o),{data:null,error:o}):{data:s&&s.length>0?s[0]:null,error:null}}return n?(console.error(" Error getting active secondary timer:",n),n.code==="PGRST204"||n.message.includes("does not exist")?{data:null,error:null}:{data:null,error:n}):{data:e&&e.length>0?e[0]:null,error:null}}catch(e){return console.error(" Error getting active secondary timer:",e),{data:null,error:e}}}static async startSecondaryTimer(r,e,n,s){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping start secondary timer"),{data:null,error:null};const{data:o,error:l}=await Oe.rpc("start_secondary_timer_for_event",{p_event_id:r,p_item_id:e,p_user_id:n,p_duration_seconds:s});return l?(console.error(" Error starting secondary timer:",l),{data:null,error:l}):{data:o,error:null}}catch(o){return console.error(" Error starting secondary timer:",o),{data:null,error:o}}}static async stopSecondaryTimer(r){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping stop secondary timer"),{data:null,error:null};const{data:e,error:n}=await Oe.rpc("stop_secondary_timer_for_event",{p_event_id:r});return n?(console.error(" Error stopping secondary timer:",n),{data:null,error:n}):{data:e,error:null}}catch(e){return console.error(" Error stopping secondary timer:",e),{data:null,error:e}}}static async updateSecondaryTimerRemaining(r,e){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping update secondary timer remaining"),{data:null,error:null};const{data:n,error:s}=await Oe.rpc("update_secondary_timer_remaining",{p_event_id:r,p_remaining_seconds:e});return s?(console.error(" Error updating secondary timer remaining:",s),{data:null,error:s}):{data:n,error:null}}catch(n){return console.error(" Error updating secondary timer remaining:",n),{data:null,error:n}}}static async updateSubCueTimerRemaining(r,e,n){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping update sub-cue timer remaining"),!1;const{error:s}=await Oe.from("sub_cue_timers").update({remaining_seconds:n,updated_at:new Date().toISOString()}).eq("event_id",r).eq("item_id",e.toString()).eq("is_active",!0);return s?(console.error(" Error updating sub-cue timer remaining time:",s),!1):!0}catch(s){return console.error("Error updating sub-cue timer remaining time:",s),!1}}static async clearAllActiveTimersForEvent(r){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping clear all active timers"),!1;console.log(" Clearing all active timers for event:",r);const{error:e}=await Oe.from("active_timers").delete().eq("event_id",r);return e?(console.error(" Error clearing all active timers:",e),!1):(console.log(" All active timers cleared for event:",r),!0)}catch(e){return console.error(" Error clearing all active timers:",e),!1}}static async getCompletedCues(r){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping get completed cues"),null;const{data:e,error:n}=await Oe.rpc("get_completed_cues_for_event",{p_event_id:r});if(n)throw n;return e}catch(e){return console.error(" Error getting completed cues:",e),null}}static async markCueCompleted(r,e,n,s,o,l){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping mark cue completed"),!1;console.log(" Calling mark_cue_completed RPC with:",{p_event_id:r,p_item_id:e,p_user_id:s});const{data:u,error:f}=await Oe.from("completed_cues").insert({event_id:r,item_id:e,user_id:s,cue_id:n,user_name:o,user_role:l,completed_at:new Date().toISOString()});if(f)throw console.error(" Insert error:",f),console.error(" Error details:",f.message,f.details,f.hint),f;return console.log(" Cue marked as completed successfully:",{eventId:r,itemId:e,data:u}),!0}catch(u){return console.error(" Error marking cue as completed:",u),!1}}static async unmarkCueCompleted(r,e){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping unmark cue completed"),!1;const{data:n,error:s}=await Oe.rpc("unmark_cue_completed",{p_event_id:r,p_item_id:e});if(s)throw s;return console.log(" Cue unmarked as completed:",{eventId:r,itemId:e}),!0}catch(n){return console.error(" Error unmarking cue as completed:",n),!1}}static async clearCompletedCues(r){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping clear completed cues"),!1;const{data:e,error:n}=await Oe.rpc("clear_completed_cues_for_event",{p_event_id:r});if(n)throw n;return console.log(" Cleared all completed cues for event:",r),!0}catch(e){return console.error(" Error clearing completed cues:",e),!1}}static subscribeToTableChanges(r,e,n){try{if(!lt||!Oe)return console.error(" Supabase client not initialized"),null;const s=n?`event_id=eq.${n}`:void 0;return Oe.channel(`${r}_changes`).on("postgres_changes",{event:"*",schema:"public",table:r,filter:s},e).subscribe()}catch(s){return console.error(` Error setting up ${r} subscription:`,s),null}}static async updateLastLoadedCue(r,e,n){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping update last loaded CUE"),{data:null,error:null};const{data:s,error:o}=await Oe.rpc("update_last_loaded_cue",{p_event_id:r,p_cue_id:e,p_state:n});return o?(console.error(" Error updating last loaded CUE:",o),{data:null,error:o}):{data:s,error:null}}catch(s){return console.error(" Error updating last loaded CUE:",s),{data:null,error:s}}}static async getLastLoadedCue(r){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping get last loaded CUE"),{data:null,error:null};const{data:e,error:n}=await Oe.rpc("get_last_loaded_cue",{p_event_id:r});if(n&&n.code==="PGRST204"){console.log(" RPC function not found, using direct table query for last loaded CUE");const{data:s,error:o}=await Oe.from("last_loaded_cues").select("*").eq("event_id",r).order("updated_at",{ascending:!1}).limit(1);return o?(console.error(" Error getting last loaded CUE from table:",o),{data:null,error:o}):{data:s&&s.length>0?s[0]:null,error:null}}return n?(console.error(" Error getting last loaded CUE:",n),{data:null,error:n}):{data:e,error:null}}catch(e){return console.error(" Error getting last loaded CUE:",e),{data:null,error:e}}}static async saveTimerMessage(r){try{console.log(" Saving timer message to Supabase:",r);const{data:e,error:n}=await Oe.from("timer_messages").insert([r]).select().single();return n?(console.error("Error saving timer message:",n),this.saveTimerMessageToLocalStorage(r)):(console.log(" Timer message saved to Supabase:",e),e)}catch(e){return console.error(" Error saving timer message:",e),this.saveTimerMessageToLocalStorage(r)}}static async getTimerMessage(r){try{const{data:e,error:n}=await Oe.rpc("get_latest_timer_message",{p_event_id:r});return n?(console.error("Error loading timer message:",n),this.getTimerMessageFromLocalStorage(r)):e?.[0]||null}catch(e){return console.error(" Error loading timer message:",e),this.getTimerMessageFromLocalStorage(r)}}static async updateTimerMessage(r,e){try{const{error:n}=await Oe.from("timer_messages").update(e).eq("id",r);return n?(console.error("Error updating timer message:",n),this.updateTimerMessageInLocalStorage(r,e)):!0}catch(n){return console.error(" Error updating timer message:",n),this.updateTimerMessageInLocalStorage(r,e)}}static async disableTimerMessage(r){return this.updateTimerMessage(r,{enabled:!1})}static async getTimerMessagesForEvent(r){try{const{data:e,error:n}=await Oe.from("timer_messages").select("*").eq("event_id",r).order("created_at",{ascending:!1});return n?(console.error("Error loading timer messages:",n),this.getTimerMessagesFromLocalStorage().filter(s=>s.event_id===r)):e||[]}catch(e){return console.error(" Error loading timer messages:",e),this.getTimerMessagesFromLocalStorage().filter(n=>n.event_id===r)}}static async getCueDataForItem(r,e){try{if(!lt||!Oe)return console.warn(" Supabase client not initialized, skipping get CUE data"),null;const n=["run_of_show_data","schedule","items","schedule_items","event_items","cues","schedule_data","run_of_show","ros_items","event_schedule"];for(const s of n)try{if(console.log(` Trying to fetch CUE data from table: ${s}`),s==="run_of_show_data"){const o=[()=>Oe.from(s).select("*").eq("event_id",r).eq("id",e).single(),()=>Oe.from(s).select("*").eq("event_id",r),()=>Oe.from(s).select("*").eq("event_id",r).eq("item_id",e).single(),()=>Oe.from(s).select("*").eq("event_id",r).eq("cue_id",e).single()];for(let l=0;l<o.length;l++)try{console.log(` Trying query approach ${l+1} for ${s}`);const{data:u,error:f}=await o[l]();if(!f&&u){if(console.log(` Found CUE data in ${s} with approach ${l+1}:`,u),console.log(" CUE data fields:",Object.keys(u)),Array.isArray(u)&&u.length>0){console.log(` Array data length: ${u.length}`),console.log(" First item fields:",Object.keys(u[0]));const m=u[0];if(m.schedule_items&&Array.isArray(m.schedule_items)){console.log(` Found schedule_items with ${m.schedule_items.length} items`),console.log(" First schedule item:",m.schedule_items[0]);const p=m.schedule_items.find(v=>v.id===e||v.item_id===e||v.cue_id===e);return p?(console.log(" Found matching schedule item:",p),p):(console.log(" No matching schedule item found, using first schedule item"),m.schedule_items[0])}return m}return u}f&&console.log(` Error with approach ${l+1} for ${s}:`,f)}catch(u){console.log(` Exception with approach ${l+1} for ${s}:`,u)}}else{const{data:o,error:l}=await Oe.from(s).select("*").eq("event_id",r).eq("id",e).single();if(!l&&o)return console.log(` Found CUE data in table: ${s}`,o),console.log(" CUE data fields:",Object.keys(o)),o}}catch(o){console.log(` Table ${s} not found or error:`,o)}return console.log(" No CUE data found in any table"),null}catch(n){return console.error(" Error getting CUE data for item:",n),null}}static async getHybridTimerData(r){try{console.log(" Fetching hybrid timer data for event:",r);const[e,n,s,o,l]=await Promise.all([this.getActiveTimer(r),this.getActiveSecondaryTimer(r),this.getActiveSubCueTimers(r),this.getLastLoadedCue(r),this.getTimerMessage(r)]);let u=null;if(e&&(console.log(" Active timer full data structure:",e),console.log(" Active timer fields:",Object.keys(e)),e.cue_is&&(console.log(" Found CUE data in active timer cue_is column:",e.cue_is),u=e)),!u&&e?.last_loaded_cue_id&&(u=await this.getCueDataForItem(r,e.last_loaded_cue_id)),!u&&e?.item_id&&(u=await this.getCueDataForItem(r,e.item_id)),!u&&e?.item_id)try{console.log(" Trying to find CUE data by matching item_id in run_of_show_data");const{data:p,error:v}=await Oe.from("run_of_show_data").select("*").eq("event_id",r);if(!v&&p&&p.length>0){console.log(` Found ${p.length} items in run_of_show_data`);const w=p.find(_=>_.id===e.item_id||_.item_id===e.item_id||_.cue_id===e.item_id);w?(console.log(" Found matching CUE data:",w),u=w):(console.log(" No matching item found, using first item as fallback"),u=p[0])}}catch(p){console.log(" Error finding CUE data by matching:",p)}const f=n?.data||(s?.data&&s.data.length>0?s.data[0]:null),m={activeTimer:e,secondaryTimer:f,subCueTimers:s?.data||null,lastLoadedCue:o?.data||null,timerMessage:l,cueData:null};return console.log(" Hybrid timer data fetched:",{hasActiveTimer:!!m.activeTimer,hasSecondaryTimer:!!m.secondaryTimer,hasSubCueTimers:!!m.subCueTimers?.length,hasLastLoadedCue:!!m.lastLoadedCue,hasTimerMessage:!!m.timerMessage}),m}catch(e){return console.error(" Error fetching hybrid timer data:",e),null}}static saveTimerMessageToLocalStorage(r){const e=this.getTimerMessagesFromLocalStorage(),n={...r,id:`local_${Date.now()}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return e.push(n),localStorage.setItem("timer_messages",JSON.stringify(e)),n}static getTimerMessagesFromLocalStorage(){try{const r=localStorage.getItem("timer_messages");return r?JSON.parse(r):[]}catch(r){return console.error("Error loading timer messages from localStorage:",r),[]}}static getTimerMessageFromLocalStorage(r){return this.getTimerMessagesFromLocalStorage().find(n=>n.event_id===r&&n.enabled)||null}static updateTimerMessageInLocalStorage(r,e){try{const n=this.getTimerMessagesFromLocalStorage(),s=n.findIndex(o=>o.id===r);return s!==-1?(n[s]={...n[s],...e,updated_at:new Date().toISOString()},localStorage.setItem("timer_messages",JSON.stringify(n)),!0):!1}catch(n){return console.error("Error updating timer message in localStorage:",n),!1}}}const Qx=({isOpen:t,onClose:r,onRoleSelected:e,eventId:n})=>{const{user:s}=Vi(),[o,l]=R.useState("VIEWER"),[u,f]=R.useState(!1);R.useEffect(()=>{if(t&&s?.id&&n){const v=localStorage.getItem(`user_role_${n}_${s.id}`);v&&["VIEWER","EDITOR","OPERATOR"].includes(v)&&l(v)}},[t,s?.id,n]);const m=[{value:"VIEWER",label:"Viewer (Read Only)",description:"Can view but cannot edit any content",icon:""},{value:"OPERATOR",label:"Operator (Limited Edit)",description:"Can control timers and view data",icon:""},{value:"EDITOR",label:"Editor (Full Access)",description:"Can edit all content and settings",icon:""}],p=async()=>{if(!(!s||!n)){f(!0);try{await qe.saveUserSession(n,s.id,s.user_metadata?.full_name||s.email||"Unknown",o)?(e(o),r()):alert("Failed to save user session. Please try again.")}catch(v){console.error("Error saving user session:",v),alert("Error saving user session. Please try again.")}finally{f(!1)}}};return t?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[9999] p-4",children:c.jsxs("div",{className:"bg-slate-800 p-8 rounded-xl shadow-2xl max-w-2xl w-full",children:[c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Select Your Role"}),c.jsxs("p",{className:"text-slate-300 text-lg",children:["Welcome, ",s?.user_metadata?.full_name||s?.email,"! Please select your role for this session."]})]}),c.jsx("div",{className:"space-y-4 mb-8",children:m.map(v=>c.jsxs("label",{className:`flex items-start gap-4 cursor-pointer p-4 rounded-lg border-2 transition-colors ${o===v.value?"border-blue-500 bg-blue-900/20":"border-slate-600 hover:border-blue-400"}`,children:[c.jsx("input",{type:"radio",name:"role",value:v.value,checked:o===v.value,onChange:w=>l(w.target.value),className:"w-5 h-5 text-blue-600 mt-1"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx("span",{className:"text-2xl",children:v.icon}),c.jsx("span",{className:"text-white font-bold text-lg",children:v.label})]}),c.jsx("p",{className:"text-slate-300 text-sm",children:v.description})]})]},v.value))}),c.jsxs("div",{className:"flex gap-4",children:[c.jsx("button",{onClick:p,disabled:u,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors",children:u?"Loading...":"Continue with Selected Role"}),c.jsx("button",{onClick:r,className:"px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]}),c.jsx("div",{className:"mt-4 p-3 bg-blue-900 rounded-lg",children:c.jsxs("p",{className:"text-blue-200 text-sm",children:[c.jsx("strong",{children:"Note:"})," You can change your role later from your profile menu."]})})]})}):null},oS=()=>{const t=ti(),{user:r}=Vi(),[e,n]=R.useState([]),[s,o]=R.useState("upcoming"),[l,u]=R.useState(!1),[f,m]=R.useState("all"),[p,v]=R.useState("all"),[w,_]=R.useState(""),[k,b]=R.useState(null),[y,L]=R.useState({name:"",date:"",location:"Great Hall",numberOfDays:1}),[G,j]=R.useState({name:"",date:"",location:"Great Hall",numberOfDays:1}),[F,ue]=R.useState(!1),[D,V]=R.useState(null),[ee,T]=R.useState(!1);R.useEffect(()=>{O()},[]),R.useEffect(()=>{const A=setInterval(()=>{console.log(" Auto-refreshing events list..."),O()},3e4);return()=>clearInterval(A)},[]);const O=async()=>{try{T(!0),console.log(" Loading events from Supabase...");const A=await qe.getCalendarEvents();if(console.log(" Raw calendar events from Supabase:",A),A&&A.length>0){console.log(" Processing calendar events:",A.length);const N=A.map((B,q)=>{console.log(` Processing event ${q}:`,{id:B.id,name:B.name,date:B.date,schedule_data:B.schedule_data,created_at:B.created_at});const ne={id:B.id||Date.now().toString(),name:B.name,date:B.date,location:B.schedule_data?.location||"Great Hall",numberOfDays:B.schedule_data?.numberOfDays||1,created_at:B.created_at||new Date().toISOString(),updated_at:B.updated_at||new Date().toISOString()};return console.log(` Transformed event ${q}:`,ne),ne});console.log(" All transformed events:",N),n(N),console.log(" Loaded events from Supabase:",N.length),console.log(" Final events state:",N)}else{console.log(" No events found in Supabase, checking localStorage...");const N=localStorage.getItem("events");if(N)try{const B=JSON.parse(N);n(B),console.log(" Loaded events from localStorage fallback:",B.length)}catch(B){console.error("Error loading events from localStorage:",B)}else console.log(" No events found in either Supabase or localStorage"),n([])}}catch(A){console.error(" Error loading events from Supabase:",A);const N=localStorage.getItem("events");if(N)try{const B=JSON.parse(N);n(B),console.log(" Fallback to localStorage due to error:",B.length)}catch(B){console.error("Error parsing localStorage events:",B),n([])}else n([])}finally{T(!1)}};R.useEffect(()=>{localStorage.setItem("events",JSON.stringify(e))},[e]);const H=async()=>{if(!G.name||!G.date||!G.location){alert("Please fill in all fields");return}const N={id:`event-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:G.name,date:G.date,location:G.location,numberOfDays:G.numberOfDays,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};u(!1),j({name:"",date:"",location:"Great Hall",numberOfDays:1}),n(B=>[...B,N]);try{console.log(" Saving new event to Supabase:",N);const B={name:N.name,date:N.date,schedule_data:{location:N.location,numberOfDays:N.numberOfDays,eventId:N.id}},q=await qe.saveCalendarEvent(B);console.log(" Calendar event saved to Supabase:",q);const ne=await qe.saveRunOfShowData({event_id:N.id,event_name:N.name,event_date:N.date,schedule_items:[],custom_columns:[],settings:{eventName:N.name,masterStartTime:"",lastSaved:new Date().toISOString()}},{userId:r?.id||"unknown",userName:r?.user_metadata?.full_name||r?.email||"Unknown User",userRole:"EDITOR"});console.log(" Run of Show data created in Supabase:",ne),setTimeout(()=>{console.log(" Reloading events after save..."),O()},1e3)}catch(B){console.error(" Error auto-saving event to Supabase:",B)}},U=async()=>{if(!k||!y.name||!y.date||!y.location){alert("Please fill in all fields");return}const A={...k,name:y.name,date:y.date,location:y.location,numberOfDays:y.numberOfDays,updated_at:new Date().toISOString()};b(null),L({name:"",date:"",location:"Great Hall",numberOfDays:1}),n(N=>N.map(B=>B.id===k.id?A:B));try{const B=(await qe.getCalendarEvents()).find(q=>q.schedule_data?.eventId===k.id||q.name===k.name);if(B?.id){const q={name:A.name,date:A.date,schedule_data:{location:A.location,numberOfDays:A.numberOfDays,eventId:A.id}};await qe.updateCalendarEvent(B.id,q),console.log("Calendar event updated in Supabase")}await qe.updateRunOfShowData(k.id,{event_name:A.name,event_date:A.date,settings:{eventName:A.name,lastSaved:new Date().toISOString()}}),console.log("Run of Show data updated in Supabase")}catch(N){console.error("Error auto-updating event in Supabase:",N)}},X=async A=>{if(window.confirm("Are you sure you want to delete this event?")){n(N=>N.filter(B=>B.id!==A));try{const N=e.find(B=>B.id===A);if(N){await qe.deleteRunOfShowData(A),console.log("Run of Show data deleted from Supabase automatically");const q=(await qe.getCalendarEvents()).find(ne=>ne.schedule_data?.eventId===A||ne.name===N.name);q?.id&&(await qe.deleteCalendarEvent(q.id),console.log("Calendar event deleted from Supabase automatically"))}}catch(N){console.error("Error auto-deleting event from Supabase:",N)}}},ve=A=>{b(A),L({name:A.name,date:A.date,location:A.location,numberOfDays:A.numberOfDays})},we=A=>{V(A),ue(!0)},Ne=async A=>{if(D&&r?.id){try{const N=r.user_metadata?.full_name||r.email||"Unknown";await qe.saveUserSession(D.id,r.id,N,A),console.log(" Role saved to Supabase from EventListPage:",A)}catch(N){console.error(" Failed to save role to Supabase from EventListPage:",N)}t("/run-of-show",{state:{event:D,userRole:A}}),ue(!1),V(null)}},he=A=>{const N=Gu.find(B=>B.value===A);return N?N.color:"bg-gray-600"},ae=A=>{const[N,B,q]=A.split("-").map(Number);return new Date(N,B-1,q).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"America/New_York"})},oe=(()=>{console.log(" Filtering events:",{totalEvents:e.length,activeTab:s,filterLocation:f,filterDays:p,searchTerm:w,events:e.map(q=>({id:q.id,name:q.name,date:q.date}))});const A=new Date,N=new Date(A.getFullYear(),A.getMonth(),A.getDate()),B=e.filter(q=>{const[ne,pe,te]=q.date.split("-").map(Number),fe=new Date(ne,pe-1,te),I=s==="upcoming"?fe>=N:fe<N,le=f==="all"||q.location===f,se=p==="all"||q.numberOfDays.toString()===p,z=w===""||q.name.toLowerCase().includes(w.toLowerCase())||q.location.toLowerCase().includes(w.toLowerCase()),Ie=I&&le&&se&&z;return console.log(` Event "${q.name}" filter result:`,{dateMatch:I,locationMatch:le,daysMatch:se,searchMatch:z,passes:Ie,eventDate:fe.toISOString(),now:A.toISOString()}),Ie}).sort((q,ne)=>{const pe=new Date(q.date),te=new Date(ne.date);return s==="upcoming"?pe.getTime()-te.getTime():te.getTime()-pe.getTime()});return console.log(" Filtered events result:",B.length,B.map(q=>q.name)),B})();return c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 text-slate-200 pt-16",children:[c.jsxs("div",{className:"text-center py-8",children:[c.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:" Event List Calendar"}),c.jsx("p",{className:"text-xl text-slate-400 mb-4",children:"Manage your events and schedules"}),r&&c.jsx("div",{className:"text-center mb-6",children:c.jsxs("p",{className:"text-white font-medium text-lg",children:["Welcome back, ",r.user_metadata?.full_name||r.email,"!"]})})]}),c.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[c.jsx("div",{className:"flex justify-center mb-8",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-1 flex",children:[c.jsx("button",{onClick:()=>o("upcoming"),className:`px-6 py-3 rounded-md font-semibold transition-colors ${s==="upcoming"?"bg-green-600 text-white":"text-slate-400 hover:text-white"}`,children:" Upcoming Events"}),c.jsx("button",{onClick:()=>o("past"),className:`px-6 py-3 rounded-md font-semibold transition-colors ${s==="past"?"bg-orange-600 text-white":"text-slate-400 hover:text-white"}`,children:" Past Events"})]})}),c.jsx("div",{className:"flex justify-center mb-6",children:c.jsx("div",{className:"bg-slate-800 rounded-lg p-4 w-full max-w-4xl",children:c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white font-semibold",children:" Search:"}),c.jsx("input",{type:"text",value:w,onChange:A=>_(A.target.value),placeholder:"Search events by name or location...",className:"w-80 px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white font-semibold",children:" Filter by location:"}),c.jsxs("select",{value:f,onChange:A=>m(A.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:[c.jsx("option",{value:"all",children:"All Locations"}),Gu.map(A=>c.jsx("option",{value:A.value,children:A.label},A.value))]})]})]})})}),c.jsx("div",{className:"flex justify-center mb-8",children:c.jsx("button",{onClick:()=>u(!0),className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors",children:"+ Add New Event"})}),c.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 shadow-2xl",children:[ee&&c.jsx("div",{className:"text-center py-4 mb-4",children:c.jsx("div",{className:"text-blue-400 text-lg",children:" Loading events..."})}),c.jsx("div",{className:"bg-slate-800 rounded-lg overflow-hidden border border-slate-600",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-slate-700",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Event Name"}),c.jsx("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Date"}),c.jsx("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Location"}),c.jsx("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Duration"}),c.jsx("th",{className:"px-4 py-3 text-center text-slate-300 font-semibold",children:"Actions"})]})}),c.jsx("tbody",{children:oe.length===0?c.jsx("tr",{children:c.jsxs("td",{colSpan:5,className:"px-4 py-12 text-center",children:[c.jsx("div",{className:"text-6xl mb-4",children:s==="upcoming"?"":""}),c.jsxs("h3",{className:"text-2xl font-bold text-white mb-2",children:["No ",s," events"]}),c.jsx("p",{className:"text-slate-400",children:s==="upcoming"?"Add your first upcoming event to get started!":"Past events will appear here once you have some."})]})}):oe.map(A=>c.jsxs("tr",{className:"border-b border-slate-600",children:[c.jsx("td",{className:"px-4 py-3 text-white font-medium border-r border-slate-600",children:A.name}),c.jsx("td",{className:"px-4 py-3 text-slate-300 border-r border-slate-600",children:ae(A.date)}),c.jsx("td",{className:"px-4 py-3 border-r border-slate-600",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:`w-3 h-3 rounded-full ${he(A.location)}`}),c.jsx("span",{className:"text-slate-300",children:A.location})]})}),c.jsxs("td",{className:"px-4 py-3 text-slate-300 border-r border-slate-600",children:[A.numberOfDays," day",A.numberOfDays>1?"s":""]}),c.jsx("td",{className:"px-4 py-3",children:c.jsxs("div",{className:"flex gap-2 justify-center",children:[c.jsx("button",{onClick:()=>we(A),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm font-medium rounded transition-colors",children:"Launch"}),c.jsx("button",{onClick:()=>ve(A),className:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white text-sm font-medium rounded transition-colors",children:"Edit"}),c.jsx("button",{onClick:()=>X(A.id),className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white text-sm font-medium rounded transition-colors",children:"Delete"})]})})]},A.id))})]})})})]})]}),l&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 max-w-sm w-full",children:[c.jsxs("h2",{className:"text-lg font-bold text-white mb-4",children:[c.jsx("span",{style:{filter:"brightness(0) invert(1)"},children:""})," Add New Event"]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Event Name"}),c.jsx("input",{type:"text",value:G.name,onChange:A=>j(N=>({...N,name:A.target.value})),placeholder:"Enter event name",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Date"}),c.jsx("input",{type:"date",value:G.date,onChange:A=>j(N=>({...N,date:A.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",style:{colorScheme:"dark"}})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Location"}),c.jsx("select",{value:G.location,onChange:A=>j(N=>({...N,location:A.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:Gu.map(A=>c.jsx("option",{value:A.value,children:A.label},A.value))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Duration"}),c.jsx("select",{value:G.numberOfDays,onChange:A=>j(N=>({...N,numberOfDays:parseInt(A.target.value)})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:up.map(A=>c.jsxs("option",{value:A,children:[A," day",A>1?"s":""]},A))})]})]}),c.jsxs("div",{className:"flex gap-2 mt-4",children:[c.jsx("button",{onClick:()=>{u(!1),j({name:"",date:"",location:"Great Hall",numberOfDays:1})},className:"flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded text-sm font-medium",children:"Cancel"}),c.jsx("button",{onClick:H,className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded text-sm font-medium",children:"Add Event"})]})]})}),k&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 max-w-sm w-full",children:[c.jsxs("h2",{className:"text-lg font-bold text-white mb-4",children:[c.jsx("span",{style:{filter:"brightness(0) invert(1)"},children:""})," Edit Event"]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Event Name"}),c.jsx("input",{type:"text",value:y.name,onChange:A=>L(N=>({...N,name:A.target.value})),placeholder:"Enter event name",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Date"}),c.jsx("input",{type:"date",value:y.date,onChange:A=>L(N=>({...N,date:A.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",style:{colorScheme:"dark"}})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Location"}),c.jsx("select",{value:y.location,onChange:A=>L(N=>({...N,location:A.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:Gu.map(A=>c.jsx("option",{value:A.value,children:A.label},A.value))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Duration"}),c.jsx("select",{value:y.numberOfDays,onChange:A=>L(N=>({...N,numberOfDays:parseInt(A.target.value)})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:up.map(A=>c.jsxs("option",{value:A,children:[A," day",A>1?"s":""]},A))})]})]}),c.jsxs("div",{className:"flex gap-2 mt-4",children:[c.jsx("button",{onClick:()=>{b(null),L({name:"",date:"",location:"Great Hall",numberOfDays:1})},className:"flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded text-sm font-medium",children:"Cancel"}),c.jsx("button",{onClick:U,className:"flex-1 px-3 py-2 bg-green-600 hover:bg-green-500 text-white rounded text-sm font-medium",children:"Update Event"})]})]})}),c.jsx(Qx,{isOpen:F,onClose:()=>{ue(!1),V(null)},onRoleSelected:Ne,eventId:D?.id||""})]})};class lS{constructor(){this.localChanges=[],this.syncTimer=null,this.SYNC_DELAY=5e3,this.MAX_BATCH_SIZE=10,this.MAX_SYNC_ATTEMPTS=3,this.loadLocalChanges(),this.startSyncTimer()}addChange(r){const e={...r,id:`change_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date,synced:!1};this.localChanges.push(e),this.saveLocalChanges(),console.log(" Change added to local buffer:",e.description),this.localChanges.filter(n=>!n.synced).length>=this.MAX_BATCH_SIZE&&this.syncChanges()}getLocalChanges(){return[...this.localChanges]}getUnsyncedChanges(){return this.localChanges.filter(r=>!r.synced)}getChangesCount(){const r=this.localChanges.length,e=this.localChanges.filter(n=>!n.synced).length;return{total:r,unsynced:e}}reloadLocalChanges(){this.loadLocalChanges(),console.log(" Reloaded local changes:",this.localChanges.length)}startSyncTimer(){this.syncTimer&&clearInterval(this.syncTimer),this.syncTimer=setInterval(()=>{const r=this.getUnsyncedChanges();r.length>0&&(console.log(` Auto-syncing ${r.length} changes...`),this.syncChanges())},this.SYNC_DELAY)}stopSyncTimer(){this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null)}async syncChanges(){const r=this.getUnsyncedChanges();if(r.length===0)return!0;console.log(` Syncing ${r.length} changes to Supabase...`);try{const e=this.groupChangesByEvent(r);for(const[n,s]of e)await this.syncEventChanges(n,s);return this.localChanges=this.localChanges.map(n=>({...n,synced:!0})),this.saveLocalChanges(),console.log(" All changes synced successfully"),!0}catch(e){return console.error(" Error syncing changes:",e),!1}}groupChangesByEvent(r){const e=new Map;for(const n of r)e.has(n.eventId)||e.set(n.eventId,[]),e.get(n.eventId).push(n);return e}async syncEventChanges(r,e){console.log(` Syncing ${e.length} changes for event ${r}`);const n={event_id:r,changes:e.map(o=>({id:o.id,timestamp:o.timestamp.toISOString(),user_id:o.userId,user_name:o.userName,user_role:o.userRole,action:o.action,description:o.description,details:o.details,row_number:o.rowNumber,cue_number:o.cueNumber,segment_name:o.segmentName})),created_at:new Date().toISOString(),synced:!0},{error:s}=await Oe.from("change_log_batches").insert([n]);if(s)throw new Error(`Failed to sync batch: ${s.message}`);for(const o of e)await qe.logChange(o.eventId,o.userId,o.userName,o.userRole,o.action,"schedule_items",o.details?.itemId,o.details?.fieldName,o.details?.oldValue,o.details?.newValue,o.description,o.rowNumber,o.cueNumber,o.details)}loadLocalChanges(){try{const r=localStorage.getItem("runofshow_local_changes");if(r){const e=JSON.parse(r);this.localChanges=e.map(n=>({...n,timestamp:new Date(n.timestamp)})),console.log(` Loaded ${this.localChanges.length} local changes from localStorage`)}else console.log(" No local changes found in localStorage"),this.localChanges=[]}catch(r){console.error("Error loading local changes:",r),this.localChanges=[]}}saveLocalChanges(){try{localStorage.setItem("runofshow_local_changes",JSON.stringify(this.localChanges))}catch(r){console.error("Error saving local changes:",r)}}clearLocalChanges(){this.localChanges=[],this.saveLocalChanges(),console.log(" Local changes cleared")}async clearMasterChangeLog(r){try{console.log(" Clearing master change log for event:",r);let e=0,n=[];const{data:{user:s},error:o}=await Oe.auth.getUser();if(console.log(" Authenticated user:",s?.id,s?.email),o||!s)return console.error(" Authentication error:",o),{success:!1,error:"Not authenticated",deletedCount:0};console.log(" Attempting to delete from change_log_batches table...");try{const{data:p,error:v}=await Oe.from("change_log_batches").select("id").eq("event_id",r);if(v)console.log(" Cannot access change_log_batches table:",v.message),n.push(`change_log_batches: ${v.message}`);else if(console.log(` Found ${p?.length||0} batches to delete`),p&&p.length>0){const{data:w,error:_}=await Oe.from("change_log_batches").delete().eq("event_id",r).select("id");if(_)console.error(" Error deleting from change_log_batches:",_),n.push(`change_log_batches delete: ${_.message}`);else{const k=w?.length||0;console.log(` Deleted ${k} batch records`),e+=k}}}catch(p){console.log(" change_log_batches table not accessible:",p),n.push(`change_log_batches: ${p.message}`)}console.log(" Deleting from change_log table...");const{data:l,error:u}=await Oe.from("change_log").select("id").eq("event_id",r);if(u)console.error(" Error checking change_log records:",u),n.push(`change_log check: ${u.message}`);else if(console.log(` Found ${l?.length||0} log records to delete`),l&&l.length>0){const{data:p,error:v}=await Oe.from("change_log").delete().eq("event_id",r).select("id");if(v)console.error(" Error deleting from change_log:",v),n.push(`change_log delete: ${v.message}`);else{const w=p?.length||0;console.log(` Deleted ${w} log records`),e+=w}}const f=n.length===0||e>0,m=n.length>0?n.join("; "):void 0;return console.log(f?` Master change log cleared: ${e} total records deleted`:` Master change log clearing failed: ${m}`),{success:f,error:m,deletedCount:e}}catch(e){return console.error(" Unexpected error clearing master change log:",e),{success:!1,error:e.message||"Unexpected error",deletedCount:0}}}async getMasterChangeLog(r,e=100){try{console.log(" Fetching master change log from Supabase for event:",r);const{data:n,error:s}=await Oe.from("change_log_batches").select("*").eq("event_id",r).order("created_at",{ascending:!1}).limit(e);if(s){console.error(" Error fetching change batches:",s),console.log(" Falling back to regular change_log table...");const{data:u,error:f}=await Oe.from("change_log").select("*").eq("event_id",r).order("created_at",{ascending:!1}).limit(e);return f?(console.error(" Error fetching regular change log:",f),[]):(console.log(" Loaded regular change log:",u?.length||0,"changes"),u||[])}console.log(" Loaded change batches:",n?.length||0,"batches");const o=[];for(const u of n||[])if(u.changes&&Array.isArray(u.changes))for(const f of u.changes)o.push({...f,batch_id:u.id,batch_created_at:u.created_at});console.log(" Flattened changes from batches:",o.length,"changes");const l=o.sort((u,f)=>new Date(f.timestamp).getTime()-new Date(u.timestamp).getTime()).slice(0,e);return console.log(" Final sorted changes:",l.length,"changes"),l}catch(n){return console.error(" Error getting master change log:",n),[]}}exportChangesAsJSON(){return JSON.stringify(this.localChanges,null,2)}exportChangesAsCSV(){if(this.localChanges.length===0)return"No changes to export";const r=["Timestamp","User","Role","Action","Description","Row","Cue","Segment","Synced"],e=this.localChanges.map(n=>[n.timestamp.toISOString(),n.userName,n.userRole,n.action,n.description,n.rowNumber||"",n.cueNumber||"",n.segmentName||"",n.synced?"Yes":"No"]);return[r,...e].map(n=>n.join(",")).join(`
`)}}const kr=new lS;window.addEventListener("beforeunload",()=>{kr.stopSyncTimer()});class Ri{static async testBackupTable(){try{console.log(" Testing backup table access...");const{data:r,error:e}=await Oe.from("run_of_show_backups").select("id").limit(1);return e?(console.error(" Backup table test failed:",e),!1):(console.log(" Backup table is accessible"),!0)}catch(r){return console.error(" Backup table test error:",r),!1}}static async createBackup(r,e,n,s,o="auto",l){try{console.log(` Creating/updating ${o} backup for event: ${r}`);const{data:{user:u}}=await Oe.auth.getUser();if(!u)throw new Error("User not authenticated");const f=s?.name||"Unknown Event",m=s?.date?new Date(s.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],p=s?.location||null,v=new Date().toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),w=l||`${o==="auto"?"Auto Backup":"Manual Backup"} - ${v}`,{data:_,error:k}=await Oe.from("run_of_show_backups").select("*").eq("event_id",r).eq("event_date",m).single();if(k&&k.code!=="PGRST116")throw k;let b;if(_){console.log(` Updating existing backup for ${f} on ${m}`);const{data:y,error:L}=await Oe.from("run_of_show_backups").update({backup_name:w,schedule_data:e,custom_columns_data:n,event_data:s,backup_type:o,event_name:f,event_location:p,schedule_items_count:e?.length||0,custom_columns_count:n?.length||0,updated_at:new Date().toISOString()}).eq("id",_.id).select().single();if(L)throw L;b=y,console.log(` Backup updated successfully: ${y.backup_name}`)}else{console.log(` Creating new backup for ${f} on ${m}`);const{data:y,error:L}=await Oe.from("run_of_show_backups").insert({event_id:r,backup_name:w,schedule_data:e,custom_columns_data:n,event_data:s,backup_type:o,event_name:f,event_date:m,event_location:p,schedule_items_count:e?.length||0,custom_columns_count:n?.length||0,created_by:u.id}).select().single();if(L)throw L;b=y,console.log(` Backup created successfully: ${y.backup_name}`)}return b}catch(u){throw console.error(" Error creating/updating backup:",u),new Error(`Failed to create/update backup: ${u.message}`)}}static async getBackupsForEvent(r){try{console.log(` Fetching backups for event: ${r}`),console.log(" Supabase client status:",Oe?"Connected":"Not connected");const{data:e,error:n}=await Oe.from("run_of_show_backups").select("*").eq("event_id",r).order("backup_timestamp",{ascending:!1});if(console.log(" Supabase query result:",{data:e,error:n}),n)throw console.error(" Supabase error details:",{code:n.code,message:n.message,details:n.details,hint:n.hint}),n;return console.log(` Found ${e?.length||0} backups for event: ${r}`),console.log(" Backup data:",e),e||[]}catch(e){throw console.error(" Error fetching backups:",e),console.error(" Error type:",typeof e),console.error(" Error message:",e.message),new Error(`Failed to fetch backups: ${e.message}`)}}static async getBackupsWithFilters(r={}){try{console.log(" Fetching backups with filters:",r);let e=Oe.from("run_of_show_backups").select("*");switch(r.eventId&&(e=e.eq("event_id",r.eventId)),r.eventName&&(e=e.ilike("event_name",`%${r.eventName}%`)),r.eventDate&&(e=e.eq("event_date",r.eventDate)),r.backupType&&(e=e.eq("backup_type",r.backupType)),r.sortBy){case"oldest":e=e.order("backup_timestamp",{ascending:!0});break;case"event":e=e.order("event_name",{ascending:!0});break;case"type":e=e.order("backup_type",{ascending:!0});break;case"newest":default:e=e.order("backup_timestamp",{ascending:!1});break}r.limit&&(e=e.limit(r.limit));const{data:n,error:s}=await e;if(s)throw s;return console.log(` Found ${n?.length||0} backups with filters`),n||[]}catch(e){throw console.error(" Error fetching backups with filters:",e),new Error(`Failed to fetch backups: ${e.message}`)}}static async restoreFromBackup(r){try{console.log(` Restoring from backup: ${r}`);const{data:e,error:n}=await Oe.from("run_of_show_backups").select("*").eq("id",r).single();if(n)throw n;if(!e)throw new Error("Backup not found");return console.log(` Restored from backup: ${e.backup_name}`),{scheduleData:e.schedule_data||[],customColumnsData:e.custom_columns_data||[],eventData:e.event_data||{},backupName:e.backup_name,backupTimestamp:e.backup_timestamp}}catch(e){throw console.error(" Error restoring from backup:",e),new Error(`Failed to restore from backup: ${e.message}`)}}static async deleteBackup(r){try{console.log(` Deleting backup: ${r}`);const{error:e}=await Oe.from("run_of_show_backups").delete().eq("id",r);if(e)throw e;return console.log(` Backup deleted successfully: ${r}`),!0}catch(e){throw console.error(" Error deleting backup:",e),new Error(`Failed to delete backup: ${e.message}`)}}static async getBackupStats(r){try{const e=await this.getBackupsForEvent(r),n=e.filter(l=>l.backup_type==="auto").length,s=e.filter(l=>l.backup_type==="manual").length,o=e.length>0?e[0].backup_timestamp:null;return{totalBackups:e.length,lastBackup:o,autoBackups:n,manualBackups:s}}catch(e){throw console.error(" Error getting backup stats:",e),new Error(`Failed to get backup stats: ${e.message}`)}}}class cS{constructor(r){this.activeTimers=new Map,this.checkInterval=null,this.syncCallbacks=new Map,this.isRunning=!1,this.config={checkInterval:3e4,maxDriftThreshold:5,forceSyncInterval:3e4,minTimerDuration:0,...r}}startMonitoring(r,e,n,s){if(console.log(` DriftDetector: Starting monitoring for timer ${r}`,{startedAt:e.toISOString(),duration:n,minDuration:this.config.minTimerDuration}),n<this.config.minTimerDuration){console.log(` DriftDetector: Skipping timer ${r} - duration too short (${n}s < ${this.config.minTimerDuration}s)`);return}const o={itemId:r,startedAt:e,duration:n,lastSyncAt:new Date,localElapsed:0,serverElapsed:0};this.activeTimers.set(r,o),this.syncCallbacks.set(r,s),this.isRunning||this.startMonitoringLoop()}stopMonitoring(r){console.log(` DriftDetector: Stopping monitoring for timer ${r}`),this.activeTimers.delete(r),this.syncCallbacks.delete(r),this.activeTimers.size===0&&this.isRunning&&this.stopMonitoringLoop()}updateLocalElapsed(r,e){const n=this.activeTimers.get(r);n&&(n.localElapsed=e)}async forceSync(r,e){const n=this.activeTimers.get(r);if(n)try{const s=await e(),o=Math.abs(s-n.localElapsed);console.log(` DriftDetector: Force sync for timer ${r}`,{localElapsed:n.localElapsed,serverElapsed:s,drift:o.toFixed(2)}),n.serverElapsed=s,n.lastSyncAt=new Date;const l=this.syncCallbacks.get(r);l&&l(s)}catch(s){console.error(` DriftDetector: Error during force sync for timer ${r}:`,s)}}startMonitoringLoop(){this.isRunning||(console.log(" DriftDetector: Starting monitoring loop"),this.isRunning=!0,this.checkInterval=setInterval(()=>{this.checkAllTimers()},this.config.checkInterval))}stopMonitoringLoop(){this.isRunning&&(console.log(" DriftDetector: Stopping monitoring loop"),this.isRunning=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null))}async checkAllTimers(){const r=new Date,e=[];for(const[n,s]of this.activeTimers)e.push(this.checkTimerDrift(n,s,r));await Promise.all(e)}async checkTimerDrift(r,e,n){try{const s=n.getTime()-e.lastSyncAt.getTime();if(s>=this.config.forceSyncInterval){console.log(` DriftDetector: Force sync needed for timer ${r} (${s}ms since last sync)`);return}const l=Math.floor((n.getTime()-e.startedAt.getTime())/1e3),u=Math.abs(l-e.localElapsed);u>this.config.maxDriftThreshold&&console.log(` DriftDetector: Significant drift detected for timer ${r}`,{localElapsed:e.localElapsed,expectedElapsed:l,drift:u.toFixed(2),threshold:this.config.maxDriftThreshold})}catch(s){console.error(` DriftDetector: Error checking drift for timer ${r}:`,s)}}getConfig(){return{...this.config}}updateConfig(r){this.config={...this.config,...r},console.log(" DriftDetector: Configuration updated",this.config)}getStatus(){const r=new Date;return Array.from(this.activeTimers.entries()).map(([e,n])=>{const s=Math.abs(n.serverElapsed-n.localElapsed),o=r.getTime()-n.lastSyncAt.getTime();return{itemId:e,drift:s,timeSinceLastSync:o}})}getStatusForTimer(r){const e=this.activeTimers.get(r);if(!e)return{itemId:r,drift:0,timeSinceLastSync:0};const n=new Date,s=Math.abs(e.serverElapsed-e.localElapsed),o=n.getTime()-e.lastSyncAt.getTime();return{itemId:r,drift:s,timeSinceLastSync:o}}destroy(){console.log(" DriftDetector: Destroying drift detector"),this.stopMonitoringLoop(),this.activeTimers.clear(),this.syncCallbacks.clear()}}const ar=new cS,xh=({itemId:t,className:r=""})=>{const[e,n]=R.useState(null);if(R.useEffect(()=>{console.log(` DriftStatusIndicator: Starting for itemId ${t}`);const f=()=>{const p=ar.getStatusForTimer(t);console.log(` DriftStatusIndicator: Status for itemId ${t}:`,p),p?(console.log(` DriftStatusIndicator: Found status for itemId ${t}:`,p),n({drift:p.drift,timeSinceLastSync:p.timeSinceLastSync})):(console.log(` DriftStatusIndicator: No status found for itemId ${t}`),n(null))};f();const m=setInterval(f,5e3);return()=>clearInterval(m)},[t]),!e)return console.log(` DriftStatusIndicator: No drift info for itemId ${t}, showing blue dot (starting up)`),c.jsx("div",{className:`drift-status ${r}`,children:c.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500",title:`Drift detection starting up for timer ${t}`})});const{drift:s,timeSinceLastSync:o}=e,l=s>5,u=o>6e4;return c.jsx("div",{className:`drift-status ${r}`,children:c.jsx("div",{className:`w-2 h-2 rounded-full ${l?"bg-red-500":u?"bg-yellow-500":"bg-green-500"}`,title:`Drift: ${s.toFixed(1)}s, Last sync: ${Math.round(o/1e3)}s ago`})})},uS=({isOpen:t,onClose:r,event:e})=>t?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 w-full max-w-5xl max-h-[80vh] flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:"OSC Control Panel"}),c.jsx("button",{onClick:r,className:"text-slate-400 hover:text-white text-xl",children:""})]}),c.jsxs("div",{className:"flex-1 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-white mb-3",children:"Event Information"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Event ID:"}),c.jsx("div",{className:"px-3 py-2 bg-slate-600 border border-slate-500 rounded text-blue-400 font-mono text-sm",children:e?.id||"No event selected"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Event Name:"}),c.jsx("div",{className:"px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm",children:e?.name||"No event selected"})]})]})]}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-white mb-3 text-center",children:" Download Python OSC App"}),c.jsxs("div",{className:"text-center",children:[c.jsx("a",{href:"/OSC_GUI_App_Enhanced.zip",download:"OSC_GUI_App_Enhanced.zip",className:"block bg-green-600 hover:bg-green-700 text-white text-sm py-3 px-6 rounded text-center transition-colors font-semibold",children:" Python OSC GUI App (Multi-Day Support)"}),c.jsx("div",{className:"text-xs text-green-400 mt-2",children:" Multi-day events  Day selection  Enhanced GUI"})]}),c.jsxs("div",{className:"text-xs text-slate-500 mt-3 text-center",children:[c.jsx("strong",{children:"Instructions:"})," Extract zip, run install.bat to install dependencies, then run_app.bat to start"]})]})]}),c.jsx("div",{className:"space-y-4",children:c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-white mb-3",children:"OSC Commands Reference"}),c.jsxs("div",{className:"text-xs text-slate-400 space-y-3",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-slate-300 mb-2",children:"Main Cue Commands (Day-Aware):"}),c.jsxs("div",{className:"font-mono bg-slate-800 p-2 rounded text-xs space-y-1",children:[c.jsx("div",{children:"/cue/1/load"}),c.jsx("div",{children:"/cue/1.1/load"}),c.jsx("div",{children:"/cue/1A/load"})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-slate-300 mb-2",children:"Timer Commands:"}),c.jsxs("div",{className:"font-mono bg-slate-800 p-2 rounded text-xs space-y-1",children:[c.jsx("div",{children:"/timer/start"}),c.jsx("div",{children:"/timer/stop"}),c.jsx("div",{children:"/timer/reset"})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-slate-300 mb-2",children:"Sub-Timer Commands (Day-Aware):"}),c.jsxs("div",{className:"font-mono bg-slate-800 p-2 rounded text-xs space-y-1",children:[c.jsx("div",{children:"/subtimer/cue/5/start"}),c.jsx("div",{children:"/subtimer/cue/5/stop"})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-slate-300 mb-2",children:" Multi-Day Commands:"}),c.jsxs("div",{className:"font-mono bg-slate-800 p-2 rounded text-xs space-y-1",children:[c.jsx("div",{children:"/set-day 2"}),c.jsx("div",{children:"/get-day"}),c.jsx("div",{children:"/list-cues (shows current day only)"})]})]})]})]})})]})]})}):null,dS=({isOpen:t,onClose:r,onSelectFullscreenTimer:e,onSelectClock:n})=>t?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 w-full max-w-2xl",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:"Select Display Mode"}),c.jsx("button",{onClick:r,className:"text-slate-400 hover:text-white text-2xl",children:""})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-slate-300 text-sm mb-6",children:"Choose how you want to display the timer information:"}),c.jsx("div",{className:"bg-slate-700 rounded-lg p-3 mb-4",children:c.jsxs("p",{className:"text-slate-400 text-xs",children:[c.jsx("strong",{children:"Fullscreen Timer:"})," Browser dependent - opens in new browser window",c.jsx("br",{}),c.jsx("strong",{children:"Clock:"})," Full web based - integrated web display"]})}),c.jsx("button",{onClick:()=>{e(),r()},className:"w-full p-4 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors text-left",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:c.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-white font-semibold",children:"Fullscreen Timer"}),c.jsx("p",{className:"text-slate-400 text-sm",children:"Browser dependent - opens in new browser window"})]})]})}),c.jsx("button",{onClick:()=>{n(),r()},className:"w-full p-4 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors text-left",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:c.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-white font-semibold",children:"Clock"}),c.jsx("p",{className:"text-slate-400 text-sm",children:"Full web based - integrated web display"})]})]})})]})]})}):null;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Zx=1252,fS=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],vh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},yh=function(t){fS.indexOf(t)!=-1&&(Zx=vh[0]=t)};function hS(){yh(1252)}var ws=function(t){yh(t)};function ev(){ws(1200),hS()}function dp(t){for(var r=[],e=0,n=t.length;e<n;++e)r[e]=t.charCodeAt(e);return r}function mS(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e)+(t.charCodeAt(2*e+1)<<8));return r.join("")}function tv(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return r.join("")}var Kl=function(t){var r=t.charCodeAt(0),e=t.charCodeAt(1);return r==255&&e==254?mS(t.slice(2)):r==254&&e==255?tv(t.slice(2)):r==65279?t.slice(1):t},Ku=function(r){return String.fromCharCode(r)},fp=function(r){return String.fromCharCode(r)},dc,Ja="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function hp(t){for(var r="",e=0,n=0,s=0,o=0,l=0,u=0,f=0,m=0;m<t.length;)e=t.charCodeAt(m++),o=e>>2,n=t.charCodeAt(m++),l=(e&3)<<4|n>>4,s=t.charCodeAt(m++),u=(n&15)<<2|s>>6,f=s&63,isNaN(n)?u=f=64:isNaN(s)&&(f=64),r+=Ja.charAt(o)+Ja.charAt(l)+Ja.charAt(u)+Ja.charAt(f);return r}function Bn(t){var r="",e=0,n=0,s=0,o=0,l=0,u=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<t.length;)o=Ja.indexOf(t.charAt(m++)),l=Ja.indexOf(t.charAt(m++)),e=o<<2|l>>4,r+=String.fromCharCode(e),u=Ja.indexOf(t.charAt(m++)),n=(l&15)<<4|u>>2,u!==64&&(r+=String.fromCharCode(n)),f=Ja.indexOf(t.charAt(m++)),s=(u&3)<<6|f,f!==64&&(r+=String.fromCharCode(s));return r}var Rt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Wi=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function Za(t){return Rt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function mp(t){return Rt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ys=function(r){return Rt?Wi(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)&255})};function Hi(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function wh(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return wh(new Uint8Array(t));for(var r=new Array(t.length),e=0;e<t.length;++e)r[e]=t[e];return r}var qa=Rt?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:Wi(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var n=new Uint8Array(e),s=0;for(r=0,e=0;r<t.length;e+=s,++r)if(s=t[r].length,t[r]instanceof Uint8Array)n.set(t[r],e);else{if(typeof t[r]=="string")throw"wtf";n.set(new Uint8Array(t[r]),e)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function gS(t){for(var r=[],e=0,n=t.length+250,s=Za(t.length+255),o=0;o<t.length;++o){var l=t.charCodeAt(o);if(l<128)s[e++]=l;else if(l<2048)s[e++]=192|l>>6&31,s[e++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=t.charCodeAt(++o)&1023;s[e++]=240|l>>8&7,s[e++]=128|l>>2&63,s[e++]=128|u>>6&15|(l&3)<<4,s[e++]=128|u&63}else s[e++]=224|l>>12&15,s[e++]=128|l>>6&63,s[e++]=128|l&63;e>n&&(r.push(s.slice(0,e)),e=0,s=Za(65535),n=65530)}return r.push(s.slice(0,e)),qa(r)}var vn=/\u0000/g,Xl=/[\u0001-\u0006]/g;function zo(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function bs(t,r){var e=""+t;return e.length>=r?e:lr("0",r-e.length)+e}function bh(t,r){var e=""+t;return e.length>=r?e:lr(" ",r-e.length)+e}function cd(t,r){var e=""+t;return e.length>=r?e:e+lr(" ",r-e.length)}function pS(t,r){var e=""+Math.round(t);return e.length>=r?e:lr("0",r-e.length)+e}function xS(t,r){var e=""+t;return e.length>=r?e:lr("0",r-e.length)+e}var gp=Math.pow(2,32);function $o(t,r){if(t>gp||t<-gp)return pS(t,r);var e=Math.round(t);return xS(e,r)}function ud(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var pp=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ef=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function vS(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var St={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},xp={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},yS={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function dd(t,r,e){for(var n=t<0?-1:1,s=t*n,o=0,l=1,u=0,f=1,m=0,p=0,v=Math.floor(s);m<r&&(v=Math.floor(s),u=v*l+o,p=v*m+f,!(s-v<5e-8));)s=1/(s-v),o=l,l=u,f=m,m=p;if(p>r&&(m>r?(p=f,u=o):(p=m,u=l)),!e)return[0,n*u,p];var w=Math.floor(n*u/p);return[w,n*u-w*p,p]}function Fi(t,r,e){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),o=0,l=[],u={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),r&&r.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++n,++u.D)),n===60)l=e?[1317,10,29]:[1900,2,29],o=3;else if(n===0)l=e?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),n<60&&(o=(o+6)%7),e&&(o=kS(f,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=o,u}var rv=new Date(1899,11,31,0,0,0),wS=rv.getTime(),bS=new Date(1900,2,1,0,0,0);function nv(t,r){var e=t.getTime();return r?e-=1461*24*60*60*1e3:t>=bS&&(e+=1440*60*1e3),(e-(wS+(t.getTimezoneOffset()-rv.getTimezoneOffset())*6e4))/(1440*60*1e3)}function _h(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function _S(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SS(t){var r=t<0?12:11,e=_h(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10),e.length<=r)?e:t.toExponential(5)}function ES(t){var r=_h(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function fc(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return r>=-4&&r<=-1?e=t.toPrecision(10+r):Math.abs(r)<=9?e=SS(t):r===10?e=t.toFixed(10).substr(0,12):e=ES(t),_h(_S(e.toUpperCase()))}function Mi(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):fc(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ss(14,nv(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function kS(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function TS(t,r,e,n){var s="",o=0,l=0,u=e.y,f,m=0;switch(t){case 98:u=e.y+543;case 121:switch(r.length){case 1:case 2:f=u%100,m=2;break;default:f=u%1e4,m=4;break}break;case 109:switch(r.length){case 1:case 2:f=e.m,m=r.length;break;case 3:return Ef[e.m-1][1];case 5:return Ef[e.m-1][0];default:return Ef[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:f=e.d,m=r.length;break;case 3:return pp[e.q][0];default:return pp[e.q][1]}break;case 104:switch(r.length){case 1:case 2:f=1+(e.H+11)%12,m=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:f=e.H,m=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:f=e.M,m=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return e.u===0&&(r=="s"||r=="ss")?bs(e.S,r.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,o=Math.round(l*(e.S+e.u)),o>=60*l&&(o=0),r==="s"?o===0?"0":""+o/l:(s=bs(o,2+n),r==="ss"?s.substr(0,2):"."+s.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":f=e.D*24+e.H;break;case"[m]":case"[mm]":f=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":f=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+r}m=r.length===3?1:2;break;case 101:f=u,m=1;break}var p=m>0?bs(f,m):"";return p}function Ya(t){var r=3;if(t.length<=r)return t;for(var e=t.length%r,n=t.substr(0,e);e!=t.length;e+=r)n+=(n.length>0?",":"")+t.substr(e,r);return n}var sv=/%/g;function NS(t,r,e){var n=r.replace(sv,""),s=r.length-n.length;return da(t,n,e*Math.pow(10,2*s))+lr("%",s)}function CS(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return da(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function av(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+av(t,-r);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%s;if(o<0&&(o+=s),e=(r/Math.pow(10,o)).toPrecision(n+1+(s+o)%s),e.indexOf("e")===-1){var l=Math.floor(Math.log(r)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(l-e.length+o):e+="E+"+(l-o);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,s)+"."+e.substr(2+s),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,m,p){return f+m+p.substr(0,(s+o)%s)+"."+p.substr(o)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var iv=/# (\?+)( ?)\/( ?)(\d+)/;function jS(t,r,e){var n=parseInt(t[4],10),s=Math.round(r*n),o=Math.floor(s/n),l=s-o*n,u=n;return e+(o===0?"":""+o)+" "+(l===0?lr(" ",t[1].length+1+t[4].length):bh(l,t[1].length)+t[2]+"/"+t[3]+bs(u,t[4].length))}function AS(t,r,e){return e+(r===0?"":""+r)+lr(" ",t[1].length+2+t[4].length)}var ov=/^#*0*\.([0#]+)/,lv=/\).*[0#]/,cv=/\(###\) ###\\?-####/;function gn(t){for(var r="",e,n=0;n!=t.length;++n)switch(e=t.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function vp(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function yp(t,r){var e=t-Math.floor(t),n=Math.pow(10,r);return r<(""+Math.round(e*n)).length?0:Math.round(e*n)}function RS(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function IS(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function rs(t,r,e){if(t.charCodeAt(0)===40&&!r.match(lv)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?rs("n",n,e):"("+rs("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return CS(t,r,e);if(r.indexOf("%")!==-1)return NS(t,r,e);if(r.indexOf("E")!==-1)return av(r,e);if(r.charCodeAt(0)===36)return"$"+rs(t,r.substr(r.charAt(1)==" "?2:1),e);var s,o,l,u,f=Math.abs(e),m=e<0?"-":"";if(r.match(/^00+$/))return m+$o(f,r.length);if(r.match(/^[#?]+$/))return s=$o(e,0),s==="0"&&(s=""),s.length>r.length?s:gn(r.substr(0,r.length-s.length))+s;if(o=r.match(iv))return jS(o,f,m);if(r.match(/^#+0+$/))return m+$o(f,r.length-r.indexOf("0"));if(o=r.match(ov))return s=vp(e,o[1].length).replace(/^([^\.]+)$/,"$1."+gn(o[1])).replace(/\.$/,"."+gn(o[1])).replace(/\.(\d*)$/,function(k,b){return"."+b+lr("0",gn(o[1]).length-b.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return m+vp(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return m+Ya($o(f,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+rs(t,r,-e):Ya(""+(Math.floor(e)+RS(e,o[1].length)))+"."+bs(yp(e,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return rs(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=zo(rs(t,r.replace(/[\\-]/g,""),e)),l=0,zo(zo(r.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<s.length?s.charAt(l++):k==="0"?"0":""}));if(r.match(cv))return s=rs(t,"##########",e),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=dd(f,Math.pow(10,l)-1,!1),s=""+m,p=da("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+o[2]+"/"+o[3],p=cd(u[2],l),p.length<o[4].length&&(p=gn(o[4].substr(o[4].length-p.length))+p),s+=p,s;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=dd(f,Math.pow(10,l)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?bh(u[1],l)+o[2]+"/"+o[3]+cd(u[2],l):lr(" ",2*l+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return s=$o(e,0),r.length<=s.length?s:gn(r.substr(0,r.length-s.length))+s;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){s=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var v=r.indexOf(".")-l,w=r.length-s.length-v;return gn(r.substr(0,v)+s+r.substr(r.length-w))}if(o=r.match(/^00,000\.([#0]*0)$/))return l=yp(e,o[1].length),e<0?"-"+rs(t,r,-e):Ya(IS(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?bs(0,3-k.length):"")+k})+"."+bs(l,o[1].length);switch(r){case"###,##0.00":return rs(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var _=Ya($o(f,0));return _!=="0"?m+_:"";case"###,###.00":return rs(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return rs(t,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function OS(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return da(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function DS(t,r,e){var n=r.replace(sv,""),s=r.length-n.length;return da(t,n,e*Math.pow(10,2*s))+lr("%",s)}function uv(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+uv(t,-r);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%s;if(o<0&&(o+=s),e=(r/Math.pow(10,o)).toPrecision(n+1+(s+o)%s),!e.match(/[Ee]/)){var l=Math.floor(Math.log(r)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(l-e.length+o):e+="E+"+(l-o),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,m,p){return f+m+p.substr(0,(s+o)%s)+"."+p.substr(o)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Ls(t,r,e){if(t.charCodeAt(0)===40&&!r.match(lv)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ls("n",n,e):"("+Ls("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return OS(t,r,e);if(r.indexOf("%")!==-1)return DS(t,r,e);if(r.indexOf("E")!==-1)return uv(r,e);if(r.charCodeAt(0)===36)return"$"+Ls(t,r.substr(r.charAt(1)==" "?2:1),e);var s,o,l,u,f=Math.abs(e),m=e<0?"-":"";if(r.match(/^00+$/))return m+bs(f,r.length);if(r.match(/^[#?]+$/))return s=""+e,e===0&&(s=""),s.length>r.length?s:gn(r.substr(0,r.length-s.length))+s;if(o=r.match(iv))return AS(o,f,m);if(r.match(/^#+0+$/))return m+bs(f,r.length-r.indexOf("0"));if(o=r.match(ov))return s=(""+e).replace(/^([^\.]+)$/,"$1."+gn(o[1])).replace(/\.$/,"."+gn(o[1])),s=s.replace(/\.(\d*)$/,function(k,b){return"."+b+lr("0",gn(o[1]).length-b.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return m+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return m+Ya(""+f);if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ls(t,r,-e):Ya(""+e)+"."+lr("0",o[1].length);if(o=r.match(/^#,#*,#0/))return Ls(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=zo(Ls(t,r.replace(/[\\-]/g,""),e)),l=0,zo(zo(r.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<s.length?s.charAt(l++):k==="0"?"0":""}));if(r.match(cv))return s=Ls(t,"##########",e),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=dd(f,Math.pow(10,l)-1,!1),s=""+m,p=da("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+o[2]+"/"+o[3],p=cd(u[2],l),p.length<o[4].length&&(p=gn(o[4].substr(o[4].length-p.length))+p),s+=p,s;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=dd(f,Math.pow(10,l)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?bh(u[1],l)+o[2]+"/"+o[3]+cd(u[2],l):lr(" ",2*l+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return s=""+e,r.length<=s.length?s:gn(r.substr(0,r.length-s.length))+s;if(o=r.match(/^([#0]+)\.([#0]+)$/)){s=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var v=r.indexOf(".")-l,w=r.length-s.length-v;return gn(r.substr(0,v)+s+r.substr(r.length-w))}if(o=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Ls(t,r,-e):Ya(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?bs(0,3-k.length):"")+k})+"."+bs(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var _=Ya(""+f);return _!=="0"?m+_:"";default:if(r.match(/\.[0#?]*$/))return Ls(t,r.slice(0,r.lastIndexOf(".")),e)+gn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function da(t,r,e){return(e|0)===e?Ls(t,r,e):rs(t,r,e)}function FS(t){for(var r=[],e=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:e=!e;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=t.substr(s,n-s),s=n+1}if(r[r.length]=t.substr(s),e===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var dv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function tl(t){for(var r=0,e="",n="";r<t.length;)switch(e=t.charAt(r)){case"G":ud(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=e;t.charAt(r++)!=="]"&&r<t.length;)n+=t.charAt(r);if(n.match(dv))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||e=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function PS(t,r,e,n){for(var s=[],o="",l=0,u="",f="t",m,p,v,w="H";l<t.length;)switch(u=t.charAt(l)){case"G":if(!ud(t,l))throw new Error("unrecognized character "+u+" in "+t);s[s.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(v=t.charCodeAt(++l))!==34&&l<t.length;)o+=String.fromCharCode(v);s[s.length]={t:"t",v:o},++l;break;case"\\":var _=t.charAt(++l),k=_==="("||_===")"?_:"t";s[s.length]={t:k,v:_},++l;break;case"_":s[s.length]={t:"t",v:" "},l+=2;break;case"@":s[s.length]={t:"T",v:r},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(m==null&&(m=Fi(r,e,t.charAt(l+1)==="2"),m==null))return"";s[s.length]={t:"X",v:t.substr(l,2)},f=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||m==null&&(m=Fi(r,e),m==null))return"";for(o=u;++l<t.length&&t.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=w),s[s.length]={t:u,v:o},f=u;break;case"A":case"a":case"":var b={t:u,v:u};if(m==null&&(m=Fi(r,e)),t.substr(l,3).toUpperCase()==="A/P"?(m!=null&&(b.v=m.H>=12?"P":"A"),b.t="T",w="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(m!=null&&(b.v=m.H>=12?"PM":"AM"),b.t="T",l+=5,w="h"):t.substr(l,5).toUpperCase()==="/"?(m!=null&&(b.v=m.H>=12?"":""),b.t="T",l+=5,w="h"):(b.t="t",++l),m==null&&b.t==="T")return"";s[s.length]=b,f=u;break;case"[":for(o=u;t.charAt(l++)!=="]"&&l<t.length;)o+=t.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(dv)){if(m==null&&(m=Fi(r,e),m==null))return"";s[s.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",tl(t)||(s[s.length]={t:"t",v:o}));break;case".":if(m!=null){for(o=u;++l<t.length&&(u=t.charAt(l))==="0";)o+=u;s[s.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(l))>-1;)o+=u;s[s.length]={t:"n",v:o};break;case"?":for(o=u;t.charAt(++l)===u;)o+=u;s[s.length]={t:u,v:o},f=u;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":s[s.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)o+=t.charAt(l);s[s.length]={t:"D",v:o};break;case" ":s[s.length]={t:u,v:u},++l;break;case"$":s[s.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);s[s.length]={t:"t",v:u},++l;break}var y=0,L=0,G;for(l=s.length-1,f="t";l>=0;--l)switch(s[l].t){case"h":case"H":s[l].t=w,f="h",y<1&&(y=1);break;case"s":(G=s[l].v.match(/\.0+$/))&&(L=Math.max(L,G[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":f=s[l].t;break;case"m":f==="s"&&(s[l].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&s[l].v.match(/[Hh]/)&&(y=1),y<2&&s[l].v.match(/[Mm]/)&&(y=2),y<3&&s[l].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var j="",F;for(l=0;l<s.length;++l)switch(s[l].t){case"t":case"T":case" ":case"D":break;case"X":s[l].v="",s[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[l].v=TS(s[l].t.charCodeAt(0),s[l].v,m,L),s[l].t="t";break;case"n":case"?":for(F=l+1;s[F]!=null&&((u=s[F].t)==="?"||u==="D"||(u===" "||u==="t")&&s[F+1]!=null&&(s[F+1].t==="?"||s[F+1].t==="t"&&s[F+1].v==="/")||s[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[F].v==="/"||s[F].v===" "&&s[F+1]!=null&&s[F+1].t=="?"));)s[l].v+=s[F].v,s[F]={v:"",t:";"},++F;j+=s[l].v,l=F-1;break;case"G":s[l].t="t",s[l].v=Mi(r,e);break}var ue="",D,V;if(j.length>0){j.charCodeAt(0)==40?(D=r<0&&j.charCodeAt(0)===45?-r:r,V=da("n",j,D)):(D=r<0&&n>1?-r:r,V=da("n",j,D),D<0&&s[0]&&s[0].t=="t"&&(V=V.substr(1),s[0].v="-"+s[0].v)),F=V.length-1;var ee=s.length;for(l=0;l<s.length;++l)if(s[l]!=null&&s[l].t!="t"&&s[l].v.indexOf(".")>-1){ee=l;break}var T=s.length;if(ee===s.length&&V.indexOf("E")===-1){for(l=s.length-1;l>=0;--l)s[l]==null||"n?".indexOf(s[l].t)===-1||(F>=s[l].v.length-1?(F-=s[l].v.length,s[l].v=V.substr(F+1,s[l].v.length)):F<0?s[l].v="":(s[l].v=V.substr(0,F+1),F=-1),s[l].t="t",T=l);F>=0&&T<s.length&&(s[T].v=V.substr(0,F+1)+s[T].v)}else if(ee!==s.length&&V.indexOf("E")===-1){for(F=V.indexOf(".")-1,l=ee;l>=0;--l)if(!(s[l]==null||"n?".indexOf(s[l].t)===-1)){for(p=s[l].v.indexOf(".")>-1&&l===ee?s[l].v.indexOf(".")-1:s[l].v.length-1,ue=s[l].v.substr(p+1);p>=0;--p)F>=0&&(s[l].v.charAt(p)==="0"||s[l].v.charAt(p)==="#")&&(ue=V.charAt(F--)+ue);s[l].v=ue,s[l].t="t",T=l}for(F>=0&&T<s.length&&(s[T].v=V.substr(0,F+1)+s[T].v),F=V.indexOf(".")+1,l=ee;l<s.length;++l)if(!(s[l]==null||"n?(".indexOf(s[l].t)===-1&&l!==ee)){for(p=s[l].v.indexOf(".")>-1&&l===ee?s[l].v.indexOf(".")+1:0,ue=s[l].v.substr(0,p);p<s[l].v.length;++p)F<V.length&&(ue+=V.charAt(F++));s[l].v=ue,s[l].t="t",T=l}}}for(l=0;l<s.length;++l)s[l]!=null&&"n?".indexOf(s[l].t)>-1&&(D=n>1&&r<0&&l>0&&s[l-1].v==="-"?-r:r,s[l].v=da(s[l].t,s[l].v,D),s[l].t="t");var O="";for(l=0;l!==s.length;++l)s[l]!=null&&(O+=s[l].v);return O}var wp=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function bp(t,r){if(r==null)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function LS(t,r){var e=FS(t),n=e.length,s=e[n-1].indexOf("@");if(n<4&&s>-1&&--n,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof r!="number")return[4,e.length===4||s>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=s>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=s>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=s>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var o=r>0?e[0]:r<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[n,o];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var l=e[0].match(wp),u=e[1].match(wp);return bp(r,l)?[n,e[0]]:bp(r,u)?[n,e[1]]:[n,e[l!=null&&u!=null?2:1]]}return[n,o]}function ss(t,r,e){e==null&&(e={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?n=e.dateNF:n=t;break;case"number":t==14&&e.dateNF?n=e.dateNF:n=(e.table!=null?e.table:St)[t],n==null&&(n=e.table&&e.table[xp[t]]||St[xp[t]]),n==null&&(n=yS[t]||"General");break}if(ud(n,0))return Mi(r,e);r instanceof Date&&(r=nv(r,e.date1904));var s=LS(n,r);if(ud(s[1]))return Mi(r,e);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return PS(s[1],r,e,s[0])}function Pi(t,r){if(typeof r!="number"){r=+r||-1;for(var e=0;e<392;++e){if(St[e]==null){r<0&&(r=e);continue}if(St[e]==t){r=e;break}}r<0&&(r=391)}return St[r]=t,r}function fv(){St=vS()}var MS={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},hv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function $S(t){var r=typeof t=="number"?St[t]:t;return r=r.replace(hv,"(\\d+)"),new RegExp("^"+r+"$")}function US(t,r,e){var n=-1,s=-1,o=-1,l=-1,u=-1,f=-1;(r.match(hv)||[]).forEach(function(v,w){var _=parseInt(e[w+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=_;break;case"d":o=_;break;case"h":l=_;break;case"s":f=_;break;case"m":l>=0?u=_:s=_;break}}),f>=0&&u==-1&&s>=0&&(u=s,s=-1);var m=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&u==-1&&f==-1?m:n==-1&&s==-1&&o==-1?p:m+"T"+p}var BS=(function(){var t={};t.version="1.2.0";function r(){for(var V=0,ee=new Array(256),T=0;T!=256;++T)V=T,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,ee[T]=V;return typeof Int32Array<"u"?new Int32Array(ee):ee}var e=r();function n(V){var ee=0,T=0,O=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)H[O]=V[O];for(O=0;O!=256;++O)for(T=V[O],ee=256+O;ee<4096;ee+=256)T=H[ee]=T>>>8^V[T&255];var U=[];for(O=1;O!=16;++O)U[O-1]=typeof Int32Array<"u"?H.subarray(O*256,O*256+256):H.slice(O*256,O*256+256);return U}var s=n(e),o=s[0],l=s[1],u=s[2],f=s[3],m=s[4],p=s[5],v=s[6],w=s[7],_=s[8],k=s[9],b=s[10],y=s[11],L=s[12],G=s[13],j=s[14];function F(V,ee){for(var T=ee^-1,O=0,H=V.length;O<H;)T=T>>>8^e[(T^V.charCodeAt(O++))&255];return~T}function ue(V,ee){for(var T=ee^-1,O=V.length-15,H=0;H<O;)T=j[V[H++]^T&255]^G[V[H++]^T>>8&255]^L[V[H++]^T>>16&255]^y[V[H++]^T>>>24]^b[V[H++]]^k[V[H++]]^_[V[H++]]^w[V[H++]]^v[V[H++]]^p[V[H++]]^m[V[H++]]^f[V[H++]]^u[V[H++]]^l[V[H++]]^o[V[H++]]^e[V[H++]];for(O+=15;H<O;)T=T>>>8^e[(T^V[H++])&255];return~T}function D(V,ee){for(var T=ee^-1,O=0,H=V.length,U=0,X=0;O<H;)U=V.charCodeAt(O++),U<128?T=T>>>8^e[(T^U)&255]:U<2048?(T=T>>>8^e[(T^(192|U>>6&31))&255],T=T>>>8^e[(T^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,X=V.charCodeAt(O++)&1023,T=T>>>8^e[(T^(240|U>>8&7))&255],T=T>>>8^e[(T^(128|U>>2&63))&255],T=T>>>8^e[(T^(128|X>>6&15|(U&3)<<4))&255],T=T>>>8^e[(T^(128|X&63))&255]):(T=T>>>8^e[(T^(224|U>>12&15))&255],T=T>>>8^e[(T^(128|U>>6&63))&255],T=T>>>8^e[(T^(128|U&63))&255]);return~T}return t.table=e,t.bstr=F,t.buf=ue,t.str=D,t})(),It=(function(){var r={};r.version="1.2.1";function e(W,J){for(var Z=W.split("/"),Y=J.split("/"),re=0,ie=0,ye=Math.min(Z.length,Y.length);re<ye;++re){if(ie=Z[re].length-Y[re].length)return ie;if(Z[re]!=Y[re])return Z[re]<Y[re]?-1:1}return Z.length-Y.length}function n(W){if(W.charAt(W.length-1)=="/")return W.slice(0,-1).indexOf("/")===-1?W:n(W.slice(0,-1));var J=W.lastIndexOf("/");return J===-1?W:W.slice(0,J+1)}function s(W){if(W.charAt(W.length-1)=="/")return s(W.slice(0,-1));var J=W.lastIndexOf("/");return J===-1?W:W.slice(J+1)}function o(W,J){typeof J=="string"&&(J=new Date(J));var Z=J.getHours();Z=Z<<6|J.getMinutes(),Z=Z<<5|J.getSeconds()>>>1,W.write_shift(2,Z);var Y=J.getFullYear()-1980;Y=Y<<4|J.getMonth()+1,Y=Y<<5|J.getDate(),W.write_shift(2,Y)}function l(W){var J=W.read_shift(2)&65535,Z=W.read_shift(2)&65535,Y=new Date,re=Z&31;Z>>>=5;var ie=Z&15;Z>>>=4,Y.setMilliseconds(0),Y.setFullYear(Z+1980),Y.setMonth(ie-1),Y.setDate(re);var ye=J&31;J>>>=5;var Re=J&63;return J>>>=6,Y.setHours(J),Y.setMinutes(Re),Y.setSeconds(ye<<1),Y}function u(W){Hr(W,0);for(var J={},Z=0;W.l<=W.length-4;){var Y=W.read_shift(2),re=W.read_shift(2),ie=W.l+re,ye={};switch(Y){case 21589:Z=W.read_shift(1),Z&1&&(ye.mtime=W.read_shift(4)),re>5&&(Z&2&&(ye.atime=W.read_shift(4)),Z&4&&(ye.ctime=W.read_shift(4))),ye.mtime&&(ye.mt=new Date(ye.mtime*1e3));break}W.l=ie,J[Y]=ye}return J}var f;function m(){return f||(f={})}function p(W,J){if(W[0]==80&&W[1]==75)return ln(W,J);if((W[0]|32)==109&&(W[1]|32)==105)return Ws(W,J);if(W.length<512)throw new Error("CFB file size "+W.length+" < 512");var Z=3,Y=512,re=0,ie=0,ye=0,Re=0,_e=0,ke=[],Te=W.slice(0,512);Hr(Te,0);var He=v(Te);switch(Z=He[0],Z){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(He[1]==0)return ln(W,J);default:throw new Error("Major Version: Expected 3 or 4 saw "+Z)}Y!==512&&(Te=W.slice(0,Y),Hr(Te,28));var Ke=W.slice(0,Y);w(Te,Z);var Qe=Te.read_shift(4,"i");if(Z===3&&Qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Qe);Te.l+=4,ye=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),Re=Te.read_shift(4,"i"),re=Te.read_shift(4,"i"),_e=Te.read_shift(4,"i"),ie=Te.read_shift(4,"i");for(var $e=-1,Pe=0;Pe<109&&($e=Te.read_shift(4,"i"),!($e<0));++Pe)ke[Pe]=$e;var mt=_(W,Y);y(_e,ie,mt,Y,ke);var Bt=G(mt,ye,ke,Y);Bt[ye].name="!Directory",re>0&&Re!==X&&(Bt[Re].name="!MiniFAT"),Bt[ke[0]].name="!FAT",Bt.fat_addrs=ke,Bt.ssz=Y;var Gt={},tr=[],Wn=[],Kr=[];j(ye,Bt,mt,tr,re,Gt,Wn,Re),k(Wn,Kr,tr),tr.shift();var un={FileIndex:Wn,FullPaths:Kr};return J&&J.raw&&(un.raw={header:Ke,sectors:mt}),un}function v(W){if(W[W.l]==80&&W[W.l+1]==75)return[0,0];W.chk(ve,"Header Signature: "),W.l+=16;var J=W.read_shift(2,"u");return[W.read_shift(2,"u"),J]}function w(W,J){var Z=9;switch(W.l+=2,Z=W.read_shift(2)){case 9:if(J!=3)throw new Error("Sector Shift: Expected 9 saw "+Z);break;case 12:if(J!=4)throw new Error("Sector Shift: Expected 12 saw "+Z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Z)}W.chk("0600","Mini Sector Shift: "),W.chk("000000000000","Reserved: ")}function _(W,J){for(var Z=Math.ceil(W.length/J)-1,Y=[],re=1;re<Z;++re)Y[re-1]=W.slice(re*J,(re+1)*J);return Y[Z-1]=W.slice(Z*J),Y}function k(W,J,Z){for(var Y=0,re=0,ie=0,ye=0,Re=0,_e=Z.length,ke=[],Te=[];Y<_e;++Y)ke[Y]=Te[Y]=Y,J[Y]=Z[Y];for(;Re<Te.length;++Re)Y=Te[Re],re=W[Y].L,ie=W[Y].R,ye=W[Y].C,ke[Y]===Y&&(re!==-1&&ke[re]!==re&&(ke[Y]=ke[re]),ie!==-1&&ke[ie]!==ie&&(ke[Y]=ke[ie])),ye!==-1&&(ke[ye]=Y),re!==-1&&Y!=ke[Y]&&(ke[re]=ke[Y],Te.lastIndexOf(re)<Re&&Te.push(re)),ie!==-1&&Y!=ke[Y]&&(ke[ie]=ke[Y],Te.lastIndexOf(ie)<Re&&Te.push(ie));for(Y=1;Y<_e;++Y)ke[Y]===Y&&(ie!==-1&&ke[ie]!==ie?ke[Y]=ke[ie]:re!==-1&&ke[re]!==re&&(ke[Y]=ke[re]));for(Y=1;Y<_e;++Y)if(W[Y].type!==0){if(Re=Y,Re!=ke[Re])do Re=ke[Re],J[Y]=J[Re]+"/"+J[Y];while(Re!==0&&ke[Re]!==-1&&Re!=ke[Re]);ke[Y]=-1}for(J[0]+="/",Y=1;Y<_e;++Y)W[Y].type!==2&&(J[Y]+="/")}function b(W,J,Z){for(var Y=W.start,re=W.size,ie=[],ye=Y;Z&&re>0&&ye>=0;)ie.push(J.slice(ye*U,ye*U+U)),re-=U,ye=Di(Z,ye*4);return ie.length===0?Cr(0):qa(ie).slice(0,W.size)}function y(W,J,Z,Y,re){var ie=X;if(W===X){if(J!==0)throw new Error("DIFAT chain shorter than expected")}else if(W!==-1){var ye=Z[W],Re=(Y>>>2)-1;if(!ye)return;for(var _e=0;_e<Re&&(ie=Di(ye,_e*4))!==X;++_e)re.push(ie);y(Di(ye,Y-4),J-1,Z,Y,re)}}function L(W,J,Z,Y,re){var ie=[],ye=[];re||(re=[]);var Re=Y-1,_e=0,ke=0;for(_e=J;_e>=0;){re[_e]=!0,ie[ie.length]=_e,ye.push(W[_e]);var Te=Z[Math.floor(_e*4/Y)];if(ke=_e*4&Re,Y<4+ke)throw new Error("FAT boundary crossed: "+_e+" 4 "+Y);if(!W[Te])break;_e=Di(W[Te],ke)}return{nodes:ie,data:Rp([ye])}}function G(W,J,Z,Y){var re=W.length,ie=[],ye=[],Re=[],_e=[],ke=Y-1,Te=0,He=0,Ke=0,Qe=0;for(Te=0;Te<re;++Te)if(Re=[],Ke=Te+J,Ke>=re&&(Ke-=re),!ye[Ke]){_e=[];var $e=[];for(He=Ke;He>=0;){$e[He]=!0,ye[He]=!0,Re[Re.length]=He,_e.push(W[He]);var Pe=Z[Math.floor(He*4/Y)];if(Qe=He*4&ke,Y<4+Qe)throw new Error("FAT boundary crossed: "+He+" 4 "+Y);if(!W[Pe]||(He=Di(W[Pe],Qe),$e[He]))break}ie[Ke]={nodes:Re,data:Rp([_e])}}return ie}function j(W,J,Z,Y,re,ie,ye,Re){for(var _e=0,ke=Y.length?2:0,Te=J[W].data,He=0,Ke=0,Qe;He<Te.length;He+=128){var $e=Te.slice(He,He+128);Hr($e,64),Ke=$e.read_shift(2),Qe=Nh($e,0,Ke-ke),Y.push(Qe);var Pe={name:Qe,type:$e.read_shift(1),color:$e.read_shift(1),L:$e.read_shift(4,"i"),R:$e.read_shift(4,"i"),C:$e.read_shift(4,"i"),clsid:$e.read_shift(16),state:$e.read_shift(4,"i"),start:0,size:0},mt=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);mt!==0&&(Pe.ct=F($e,$e.l-8));var Bt=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);Bt!==0&&(Pe.mt=F($e,$e.l-8)),Pe.start=$e.read_shift(4,"i"),Pe.size=$e.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=X,Pe.name=""),Pe.type===5?(_e=Pe.start,re>0&&_e!==X&&(J[_e].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",J[Pe.start]===void 0&&(J[Pe.start]=L(Z,Pe.start,J.fat_addrs,J.ssz)),J[Pe.start].name=Pe.name,Pe.content=J[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:_e!==X&&Pe.start!==X&&J[_e]&&(Pe.content=b(Pe,J[_e].data,(J[Re]||{}).data))),Pe.content&&Hr(Pe.content,0),ie[Qe]=Pe,ye.push(Pe)}}function F(W,J){return new Date(($n(W,J+4)/1e7*Math.pow(2,32)+$n(W,J)/1e7-11644473600)*1e3)}function ue(W,J){return m(),p(f.readFileSync(W),J)}function D(W,J){var Z=J&&J.type;switch(Z||Rt&&Buffer.isBuffer(W)&&(Z="buffer"),Z||"base64"){case"file":return ue(W,J);case"base64":return p(ys(Bn(W)),J);case"binary":return p(ys(W),J)}return p(W,J)}function V(W,J){var Z=J||{},Y=Z.root||"Root Entry";if(W.FullPaths||(W.FullPaths=[]),W.FileIndex||(W.FileIndex=[]),W.FullPaths.length!==W.FileIndex.length)throw new Error("inconsistent CFB structure");W.FullPaths.length===0&&(W.FullPaths[0]=Y+"/",W.FileIndex[0]={name:Y,type:5}),Z.CLSID&&(W.FileIndex[0].clsid=Z.CLSID),ee(W)}function ee(W){var J="Sh33tJ5";if(!It.find(W,"/"+J)){var Z=Cr(4);Z[0]=55,Z[1]=Z[3]=50,Z[2]=54,W.FileIndex.push({name:J,type:2,content:Z,size:4,L:69,R:69,C:69}),W.FullPaths.push(W.FullPaths[0]+J),T(W)}}function T(W,J){V(W);for(var Z=!1,Y=!1,re=W.FullPaths.length-1;re>=0;--re){var ie=W.FileIndex[re];switch(ie.type){case 0:Y?Z=!0:(W.FileIndex.pop(),W.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(ie.R*ie.L*ie.C)&&(Z=!0),ie.R>-1&&ie.L>-1&&ie.R==ie.L&&(Z=!0);break;default:Z=!0;break}}if(!(!Z&&!J)){var ye=new Date(1987,1,19),Re=0,_e=Object.create?Object.create(null):{},ke=[];for(re=0;re<W.FullPaths.length;++re)_e[W.FullPaths[re]]=!0,W.FileIndex[re].type!==0&&ke.push([W.FullPaths[re],W.FileIndex[re]]);for(re=0;re<ke.length;++re){var Te=n(ke[re][0]);Y=_e[Te],Y||(ke.push([Te,{name:s(Te).replace("/",""),type:1,clsid:Ne,ct:ye,mt:ye,content:null}]),_e[Te]=!0)}for(ke.sort(function(Qe,$e){return e(Qe[0],$e[0])}),W.FullPaths=[],W.FileIndex=[],re=0;re<ke.length;++re)W.FullPaths[re]=ke[re][0],W.FileIndex[re]=ke[re][1];for(re=0;re<ke.length;++re){var He=W.FileIndex[re],Ke=W.FullPaths[re];if(He.name=s(Ke).replace("/",""),He.L=He.R=He.C=-(He.color=1),He.size=He.content?He.content.length:0,He.start=0,He.clsid=He.clsid||Ne,re===0)He.C=ke.length>1?1:-1,He.size=0,He.type=5;else if(Ke.slice(-1)=="/"){for(Re=re+1;Re<ke.length&&n(W.FullPaths[Re])!=Ke;++Re);for(He.C=Re>=ke.length?-1:Re,Re=re+1;Re<ke.length&&n(W.FullPaths[Re])!=n(Ke);++Re);He.R=Re>=ke.length?-1:Re,He.type=1}else n(W.FullPaths[re+1]||"")==n(Ke)&&(He.R=re+1),He.type=2}}}function O(W,J){var Z=J||{};if(Z.fileType=="mad")return ks(W,Z);switch(T(W),Z.fileType){case"zip":return Rn(W,Z)}var Y=(function(Qe){for(var $e=0,Pe=0,mt=0;mt<Qe.FileIndex.length;++mt){var Bt=Qe.FileIndex[mt];if(Bt.content){var Gt=Bt.content.length;Gt>0&&(Gt<4096?$e+=Gt+63>>6:Pe+=Gt+511>>9)}}for(var tr=Qe.FullPaths.length+3>>2,Wn=$e+7>>3,Kr=$e+127>>7,un=Wn+Pe+tr+Kr,fr=un+127>>7,va=fr<=109?0:Math.ceil((fr-109)/127);un+fr+va+127>>7>fr;)va=++fr<=109?0:Math.ceil((fr-109)/127);var rr=[1,va,fr,Kr,tr,Pe,$e,0];return Qe.FileIndex[0].size=$e<<6,rr[7]=(Qe.FileIndex[0].start=rr[0]+rr[1]+rr[2]+rr[3]+rr[4]+rr[5])+(rr[6]+7>>3),rr})(W),re=Cr(Y[7]<<9),ie=0,ye=0;{for(ie=0;ie<8;++ie)re.write_shift(1,we[ie]);for(ie=0;ie<8;++ie)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),ie=0;ie<3;++ie)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,Y[2]),re.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:X),re.write_shift(4,Y[3]),re.write_shift(-4,Y[1]?Y[0]-1:X),re.write_shift(4,Y[1]),ie=0;ie<109;++ie)re.write_shift(-4,ie<Y[2]?Y[1]+ie:-1)}if(Y[1])for(ye=0;ye<Y[1];++ye){for(;ie<236+ye*127;++ie)re.write_shift(-4,ie<Y[2]?Y[1]+ie:-1);re.write_shift(-4,ye===Y[1]-1?X:ye+1)}var Re=function(Qe){for(ye+=Qe;ie<ye-1;++ie)re.write_shift(-4,ie+1);Qe&&(++ie,re.write_shift(-4,X))};for(ye=ie=0,ye+=Y[1];ie<ye;++ie)re.write_shift(-4,he.DIFSECT);for(ye+=Y[2];ie<ye;++ie)re.write_shift(-4,he.FATSECT);Re(Y[3]),Re(Y[4]);for(var _e=0,ke=0,Te=W.FileIndex[0];_e<W.FileIndex.length;++_e)Te=W.FileIndex[_e],Te.content&&(ke=Te.content.length,!(ke<4096)&&(Te.start=ye,Re(ke+511>>9)));for(Re(Y[6]+7>>3);re.l&511;)re.write_shift(-4,he.ENDOFCHAIN);for(ye=ie=0,_e=0;_e<W.FileIndex.length;++_e)Te=W.FileIndex[_e],Te.content&&(ke=Te.content.length,!(!ke||ke>=4096)&&(Te.start=ye,Re(ke+63>>6)));for(;re.l&511;)re.write_shift(-4,he.ENDOFCHAIN);for(ie=0;ie<Y[4]<<2;++ie){var He=W.FullPaths[ie];if(!He||He.length===0){for(_e=0;_e<17;++_e)re.write_shift(4,0);for(_e=0;_e<3;++_e)re.write_shift(4,-1);for(_e=0;_e<12;++_e)re.write_shift(4,0);continue}Te=W.FileIndex[ie],ie===0&&(Te.start=Te.size?Te.start-1:X);var Ke=ie===0&&Z.root||Te.name;if(ke=2*(Ke.length+1),re.write_shift(64,Ke,"utf16le"),re.write_shift(2,ke),re.write_shift(1,Te.type),re.write_shift(1,Te.color),re.write_shift(-4,Te.L),re.write_shift(-4,Te.R),re.write_shift(-4,Te.C),Te.clsid)re.write_shift(16,Te.clsid,"hex");else for(_e=0;_e<4;++_e)re.write_shift(4,0);re.write_shift(4,Te.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,Te.start),re.write_shift(4,Te.size),re.write_shift(4,0)}for(ie=1;ie<W.FileIndex.length;++ie)if(Te=W.FileIndex[ie],Te.size>=4096)if(re.l=Te.start+1<<9,Rt&&Buffer.isBuffer(Te.content))Te.content.copy(re,re.l,0,Te.size),re.l+=Te.size+511&-512;else{for(_e=0;_e<Te.size;++_e)re.write_shift(1,Te.content[_e]);for(;_e&511;++_e)re.write_shift(1,0)}for(ie=1;ie<W.FileIndex.length;++ie)if(Te=W.FileIndex[ie],Te.size>0&&Te.size<4096)if(Rt&&Buffer.isBuffer(Te.content))Te.content.copy(re,re.l,0,Te.size),re.l+=Te.size+63&-64;else{for(_e=0;_e<Te.size;++_e)re.write_shift(1,Te.content[_e]);for(;_e&63;++_e)re.write_shift(1,0)}if(Rt)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function H(W,J){var Z=W.FullPaths.map(function(_e){return _e.toUpperCase()}),Y=Z.map(function(_e){var ke=_e.split("/");return ke[ke.length-(_e.slice(-1)=="/"?2:1)]}),re=!1;J.charCodeAt(0)===47?(re=!0,J=Z[0].slice(0,-1)+J):re=J.indexOf("/")!==-1;var ie=J.toUpperCase(),ye=re===!0?Z.indexOf(ie):Y.indexOf(ie);if(ye!==-1)return W.FileIndex[ye];var Re=!ie.match(Xl);for(ie=ie.replace(vn,""),Re&&(ie=ie.replace(Xl,"!")),ye=0;ye<Z.length;++ye)if((Re?Z[ye].replace(Xl,"!"):Z[ye]).replace(vn,"")==ie||(Re?Y[ye].replace(Xl,"!"):Y[ye]).replace(vn,"")==ie)return W.FileIndex[ye];return null}var U=64,X=-2,ve="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],Ne="00000000000000000000000000000000",he={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:X,FREESECT:-1,HEADER_SIGNATURE:ve,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ae(W,J,Z){m();var Y=O(W,Z);f.writeFileSync(J,Y)}function K(W){for(var J=new Array(W.length),Z=0;Z<W.length;++Z)J[Z]=String.fromCharCode(W[Z]);return J.join("")}function oe(W,J){var Z=O(W,J);switch(J&&J.type||"buffer"){case"file":return m(),f.writeFileSync(J.filename,Z),Z;case"binary":return typeof Z=="string"?Z:K(Z);case"base64":return hp(typeof Z=="string"?Z:K(Z));case"buffer":if(Rt)return Buffer.isBuffer(Z)?Z:Wi(Z);case"array":return typeof Z=="string"?ys(Z):Z}return Z}var A;function N(W){try{var J=W.InflateRaw,Z=new J;if(Z._processChunk(new Uint8Array([3,0]),Z._finishFlushFlag),Z.bytesRead)A=W;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function B(W,J){if(!A)return Ur(W,J);var Z=A.InflateRaw,Y=new Z,re=Y._processChunk(W.slice(W.l),Y._finishFlushFlag);return W.l+=Y.bytesRead,re}function q(W){return A?A.deflateRawSync(W):Ze(W)}var ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],pe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(W){var J=(W<<1|W<<11)&139536|(W<<5|W<<15)&558144;return(J>>16|J>>8|J)&255}for(var I=typeof Uint8Array<"u",le=I?new Uint8Array(256):[],se=0;se<256;++se)le[se]=fe(se);function z(W,J){var Z=le[W&255];return J<=8?Z>>>8-J:(Z=Z<<8|le[W>>8&255],J<=16?Z>>>16-J:(Z=Z<<8|le[W>>16&255],Z>>>24-J))}function Ie(W,J){var Z=J&7,Y=J>>>3;return(W[Y]|(Z<=6?0:W[Y+1]<<8))>>>Z&3}function Fe(W,J){var Z=J&7,Y=J>>>3;return(W[Y]|(Z<=5?0:W[Y+1]<<8))>>>Z&7}function Ye(W,J){var Z=J&7,Y=J>>>3;return(W[Y]|(Z<=4?0:W[Y+1]<<8))>>>Z&15}function tt(W,J){var Z=J&7,Y=J>>>3;return(W[Y]|(Z<=3?0:W[Y+1]<<8))>>>Z&31}function Ve(W,J){var Z=J&7,Y=J>>>3;return(W[Y]|(Z<=1?0:W[Y+1]<<8))>>>Z&127}function Ee(W,J,Z){var Y=J&7,re=J>>>3,ie=(1<<Z)-1,ye=W[re]>>>Y;return Z<8-Y||(ye|=W[re+1]<<8-Y,Z<16-Y)||(ye|=W[re+2]<<16-Y,Z<24-Y)||(ye|=W[re+3]<<24-Y),ye&ie}function Le(W,J,Z){var Y=J&7,re=J>>>3;return Y<=5?W[re]|=(Z&7)<<Y:(W[re]|=Z<<Y&255,W[re+1]=(Z&7)>>8-Y),J+3}function Me(W,J,Z){var Y=J&7,re=J>>>3;return Z=(Z&1)<<Y,W[re]|=Z,J+1}function rt(W,J,Z){var Y=J&7,re=J>>>3;return Z<<=Y,W[re]|=Z&255,Z>>>=8,W[re+1]=Z,J+8}function Nt(W,J,Z){var Y=J&7,re=J>>>3;return Z<<=Y,W[re]|=Z&255,Z>>>=8,W[re+1]=Z&255,W[re+2]=Z>>>8,J+16}function wt(W,J){var Z=W.length,Y=2*Z>J?2*Z:J+5,re=0;if(Z>=J)return W;if(Rt){var ie=mp(Y);if(W.copy)W.copy(ie);else for(;re<W.length;++re)ie[re]=W[re];return ie}else if(I){var ye=new Uint8Array(Y);if(ye.set)ye.set(W);else for(;re<Z;++re)ye[re]=W[re];return ye}return W.length=Y,W}function ft(W){for(var J=new Array(W),Z=0;Z<W;++Z)J[Z]=0;return J}function Wt(W,J,Z){var Y=1,re=0,ie=0,ye=0,Re=0,_e=W.length,ke=I?new Uint16Array(32):ft(32);for(ie=0;ie<32;++ie)ke[ie]=0;for(ie=_e;ie<Z;++ie)W[ie]=0;_e=W.length;var Te=I?new Uint16Array(_e):ft(_e);for(ie=0;ie<_e;++ie)ke[re=W[ie]]++,Y<re&&(Y=re),Te[ie]=0;for(ke[0]=0,ie=1;ie<=Y;++ie)ke[ie+16]=Re=Re+ke[ie-1]<<1;for(ie=0;ie<_e;++ie)Re=W[ie],Re!=0&&(Te[ie]=ke[Re+16]++);var He=0;for(ie=0;ie<_e;++ie)if(He=W[ie],He!=0)for(Re=z(Te[ie],Y)>>Y-He,ye=(1<<Y+4-He)-1;ye>=0;--ye)J[Re|ye<<He]=He&15|ie<<4;return Y}var Dt=I?new Uint16Array(512):ft(512),Ft=I?new Uint16Array(32):ft(32);if(!I){for(var xt=0;xt<512;++xt)Dt[xt]=0;for(xt=0;xt<32;++xt)Ft[xt]=0}(function(){for(var W=[],J=0;J<32;J++)W.push(5);Wt(W,Ft,32);var Z=[];for(J=0;J<=143;J++)Z.push(8);for(;J<=255;J++)Z.push(9);for(;J<=279;J++)Z.push(7);for(;J<=287;J++)Z.push(8);Wt(Z,Dt,288)})();var Et=(function(){for(var J=I?new Uint8Array(32768):[],Z=0,Y=0;Z<te.length-1;++Z)for(;Y<te[Z+1];++Y)J[Y]=Z;for(;Y<32768;++Y)J[Y]=29;var re=I?new Uint8Array(259):[];for(Z=0,Y=0;Z<pe.length-1;++Z)for(;Y<pe[Z+1];++Y)re[Y]=Z;function ie(Re,_e){for(var ke=0;ke<Re.length;){var Te=Math.min(65535,Re.length-ke),He=ke+Te==Re.length;for(_e.write_shift(1,+He),_e.write_shift(2,Te),_e.write_shift(2,~Te&65535);Te-- >0;)_e[_e.l++]=Re[ke++]}return _e.l}function ye(Re,_e){for(var ke=0,Te=0,He=I?new Uint16Array(32768):[];Te<Re.length;){var Ke=Math.min(65535,Re.length-Te);if(Ke<10){for(ke=Le(_e,ke,+(Te+Ke==Re.length)),ke&7&&(ke+=8-(ke&7)),_e.l=ke/8|0,_e.write_shift(2,Ke),_e.write_shift(2,~Ke&65535);Ke-- >0;)_e[_e.l++]=Re[Te++];ke=_e.l*8;continue}ke=Le(_e,ke,+(Te+Ke==Re.length)+2);for(var Qe=0;Ke-- >0;){var $e=Re[Te];Qe=(Qe<<5^$e)&32767;var Pe=-1,mt=0;if((Pe=He[Qe])&&(Pe|=Te&-32768,Pe>Te&&(Pe-=32768),Pe<Te))for(;Re[Pe+mt]==Re[Te+mt]&&mt<250;)++mt;if(mt>2){$e=re[mt],$e<=22?ke=rt(_e,ke,le[$e+1]>>1)-1:(rt(_e,ke,3),ke+=5,rt(_e,ke,le[$e-23]>>5),ke+=3);var Bt=$e<8?0:$e-4>>2;Bt>0&&(Nt(_e,ke,mt-pe[$e]),ke+=Bt),$e=J[Te-Pe],ke=rt(_e,ke,le[$e]>>3),ke-=3;var Gt=$e<4?0:$e-2>>1;Gt>0&&(Nt(_e,ke,Te-Pe-te[$e]),ke+=Gt);for(var tr=0;tr<mt;++tr)He[Qe]=Te&32767,Qe=(Qe<<5^Re[Te])&32767,++Te;Ke-=mt-1}else $e<=143?$e=$e+48:ke=Me(_e,ke,1),ke=rt(_e,ke,le[$e]),He[Qe]=Te&32767,++Te}ke=rt(_e,ke,0)-1}return _e.l=(ke+7)/8|0,_e.l}return function(_e,ke){return _e.length<8?ie(_e,ke):ye(_e,ke)}})();function Ze(W){var J=Cr(50+Math.floor(W.length*1.1)),Z=Et(W,J);return J.slice(0,Z)}var bt=I?new Uint16Array(32768):ft(32768),ur=I?new Uint16Array(32768):ft(32768),kt=I?new Uint16Array(128):ft(128),dr=1,$r=1;function Es(W,J){var Z=tt(W,J)+257;J+=5;var Y=tt(W,J)+1;J+=5;var re=Ye(W,J)+4;J+=4;for(var ie=0,ye=I?new Uint8Array(19):ft(19),Re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_e=1,ke=I?new Uint8Array(8):ft(8),Te=I?new Uint8Array(8):ft(8),He=ye.length,Ke=0;Ke<re;++Ke)ye[ne[Ke]]=ie=Fe(W,J),_e<ie&&(_e=ie),ke[ie]++,J+=3;var Qe=0;for(ke[0]=0,Ke=1;Ke<=_e;++Ke)Te[Ke]=Qe=Qe+ke[Ke-1]<<1;for(Ke=0;Ke<He;++Ke)(Qe=ye[Ke])!=0&&(Re[Ke]=Te[Qe]++);var $e=0;for(Ke=0;Ke<He;++Ke)if($e=ye[Ke],$e!=0){Qe=le[Re[Ke]]>>8-$e;for(var Pe=(1<<7-$e)-1;Pe>=0;--Pe)kt[Qe|Pe<<$e]=$e&7|Ke<<3}var mt=[];for(_e=1;mt.length<Z+Y;)switch(Qe=kt[Ve(W,J)],J+=Qe&7,Qe>>>=3){case 16:for(ie=3+Ie(W,J),J+=2,Qe=mt[mt.length-1];ie-- >0;)mt.push(Qe);break;case 17:for(ie=3+Fe(W,J),J+=3;ie-- >0;)mt.push(0);break;case 18:for(ie=11+Ve(W,J),J+=7;ie-- >0;)mt.push(0);break;default:mt.push(Qe),_e<Qe&&(_e=Qe);break}var Bt=mt.slice(0,Z),Gt=mt.slice(Z);for(Ke=Z;Ke<286;++Ke)Bt[Ke]=0;for(Ke=Y;Ke<30;++Ke)Gt[Ke]=0;return dr=Wt(Bt,bt,286),$r=Wt(Gt,ur,30),J}function wr(W,J){if(W[0]==3&&!(W[1]&3))return[Za(J),2];for(var Z=0,Y=0,re=mp(J||1<<18),ie=0,ye=re.length>>>0,Re=0,_e=0;(Y&1)==0;){if(Y=Fe(W,Z),Z+=3,Y>>>1)Y>>1==1?(Re=9,_e=5):(Z=Es(W,Z),Re=dr,_e=$r);else{Z&7&&(Z+=8-(Z&7));var ke=W[Z>>>3]|W[(Z>>>3)+1]<<8;if(Z+=32,ke>0)for(!J&&ye<ie+ke&&(re=wt(re,ie+ke),ye=re.length);ke-- >0;)re[ie++]=W[Z>>>3],Z+=8;continue}for(;;){!J&&ye<ie+32767&&(re=wt(re,ie+32767),ye=re.length);var Te=Ee(W,Z,Re),He=Y>>>1==1?Dt[Te]:bt[Te];if(Z+=He&15,He>>>=4,(He>>>8&255)===0)re[ie++]=He;else{if(He==256)break;He-=257;var Ke=He<8?0:He-4>>2;Ke>5&&(Ke=0);var Qe=ie+pe[He];Ke>0&&(Qe+=Ee(W,Z,Ke),Z+=Ke),Te=Ee(W,Z,_e),He=Y>>>1==1?Ft[Te]:ur[Te],Z+=He&15,He>>>=4;var $e=He<4?0:He-2>>1,Pe=te[He];for($e>0&&(Pe+=Ee(W,Z,$e),Z+=$e),!J&&ye<Qe&&(re=wt(re,Qe+100),ye=re.length);ie<Qe;)re[ie]=re[ie-Pe],++ie}}}return J?[re,Z+7>>>3]:[re.slice(0,ie),Z+7>>>3]}function Ur(W,J){var Z=W.slice(W.l||0),Y=wr(Z,J);return W.l+=Y[1],Y[0]}function dt(W,J){if(W)typeof console<"u"&&console.error(J);else throw new Error(J)}function ln(W,J){var Z=W;Hr(Z,0);var Y=[],re=[],ie={FileIndex:Y,FullPaths:re};V(ie,{root:J.root});for(var ye=Z.length-4;(Z[ye]!=80||Z[ye+1]!=75||Z[ye+2]!=5||Z[ye+3]!=6)&&ye>=0;)--ye;Z.l=ye+4,Z.l+=4;var Re=Z.read_shift(2);Z.l+=6;var _e=Z.read_shift(4);for(Z.l=_e,ye=0;ye<Re;++ye){Z.l+=20;var ke=Z.read_shift(4),Te=Z.read_shift(4),He=Z.read_shift(2),Ke=Z.read_shift(2),Qe=Z.read_shift(2);Z.l+=8;var $e=Z.read_shift(4),Pe=u(Z.slice(Z.l+He,Z.l+He+Ke));Z.l+=He+Ke+Qe;var mt=Z.l;Z.l=$e+4,wn(Z,ke,Te,ie,Pe),Z.l=mt}return ie}function wn(W,J,Z,Y,re){W.l+=2;var ie=W.read_shift(2),ye=W.read_shift(2),Re=l(W);if(ie&8257)throw new Error("Unsupported ZIP encryption");for(var _e=W.read_shift(4),ke=W.read_shift(4),Te=W.read_shift(4),He=W.read_shift(2),Ke=W.read_shift(2),Qe="",$e=0;$e<He;++$e)Qe+=String.fromCharCode(W[W.l++]);if(Ke){var Pe=u(W.slice(W.l,W.l+Ke));(Pe[21589]||{}).mt&&(Re=Pe[21589].mt),((re||{})[21589]||{}).mt&&(Re=re[21589].mt)}W.l+=Ke;var mt=W.slice(W.l,W.l+ke);switch(ye){case 8:mt=B(W,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ye)}var Bt=!1;ie&8&&(_e=W.read_shift(4),_e==134695760&&(_e=W.read_shift(4),Bt=!0),ke=W.read_shift(4),Te=W.read_shift(4)),ke!=J&&dt(Bt,"Bad compressed size: "+J+" != "+ke),Te!=Z&&dt(Bt,"Bad uncompressed size: "+Z+" != "+Te),is(Y,Qe,mt,{unsafe:!0,mt:Re})}function Rn(W,J){var Z=J||{},Y=[],re=[],ie=Cr(1),ye=Z.compression?8:0,Re=0,_e=0,ke=0,Te=0,He=0,Ke=W.FullPaths[0],Qe=Ke,$e=W.FileIndex[0],Pe=[],mt=0;for(_e=1;_e<W.FullPaths.length;++_e)if(Qe=W.FullPaths[_e].slice(Ke.length),$e=W.FileIndex[_e],!(!$e.size||!$e.content||Qe=="Sh33tJ5")){var Bt=Te,Gt=Cr(Qe.length);for(ke=0;ke<Qe.length;++ke)Gt.write_shift(1,Qe.charCodeAt(ke)&127);Gt=Gt.slice(0,Gt.l),Pe[He]=BS.buf($e.content,0);var tr=$e.content;ye==8&&(tr=q(tr)),ie=Cr(30),ie.write_shift(4,67324752),ie.write_shift(2,20),ie.write_shift(2,Re),ie.write_shift(2,ye),$e.mt?o(ie,$e.mt):ie.write_shift(4,0),ie.write_shift(-4,Pe[He]),ie.write_shift(4,tr.length),ie.write_shift(4,$e.content.length),ie.write_shift(2,Gt.length),ie.write_shift(2,0),Te+=ie.length,Y.push(ie),Te+=Gt.length,Y.push(Gt),Te+=tr.length,Y.push(tr),ie=Cr(46),ie.write_shift(4,33639248),ie.write_shift(2,0),ie.write_shift(2,20),ie.write_shift(2,Re),ie.write_shift(2,ye),ie.write_shift(4,0),ie.write_shift(-4,Pe[He]),ie.write_shift(4,tr.length),ie.write_shift(4,$e.content.length),ie.write_shift(2,Gt.length),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(4,0),ie.write_shift(4,Bt),mt+=ie.l,re.push(ie),mt+=Gt.length,re.push(Gt),++He}return ie=Cr(22),ie.write_shift(4,101010256),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,He),ie.write_shift(2,He),ie.write_shift(4,mt),ie.write_shift(4,Te),ie.write_shift(2,0),qa([qa(Y),qa(re),ie])}var At={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function cn(W,J){if(W.ctype)return W.ctype;var Z=W.name||"",Y=Z.match(/\.([^\.]+)$/);return Y&&At[Y[1]]||J&&(Y=(Z=J).match(/[\.\\]([^\.\\])+$/),Y&&At[Y[1]])?At[Y[1]]:"application/octet-stream"}function si(W){for(var J=hp(W),Z=[],Y=0;Y<J.length;Y+=76)Z.push(J.slice(Y,Y+76));return Z.join(`\r
`)+`\r
`}function bn(W){var J=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ke){var Te=ke.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});J=J.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),J.charAt(0)==`
`&&(J="=0D"+J.slice(1)),J=J.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Z=[],Y=J.split(`\r
`),re=0;re<Y.length;++re){var ie=Y[re];if(ie.length==0){Z.push("");continue}for(var ye=0;ye<ie.length;){var Re=76,_e=ie.slice(ye,ye+Re);_e.charAt(Re-1)=="="?Re--:_e.charAt(Re-2)=="="?Re-=2:_e.charAt(Re-3)=="="&&(Re-=3),_e=ie.slice(ye,ye+Re),ye+=Re,ye<ie.length&&(_e+="="),Z.push(_e)}}return Z.join(`\r
`)}function Mt(W){for(var J=[],Z=0;Z<W.length;++Z){for(var Y=W[Z];Z<=W.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+W[++Z];J.push(Y)}for(var re=0;re<J.length;++re)J[re]=J[re].replace(/[=][0-9A-Fa-f]{2}/g,function(ie){return String.fromCharCode(parseInt(ie.slice(1),16))});return ys(J.join(`\r
`))}function _n(W,J,Z){for(var Y="",re="",ie="",ye,Re=0;Re<10;++Re){var _e=J[Re];if(!_e||_e.match(/^\s*$/))break;var ke=_e.match(/^(.*?):\s*([^\s].*)$/);if(ke)switch(ke[1].toLowerCase()){case"content-location":Y=ke[2].trim();break;case"content-type":ie=ke[2].trim();break;case"content-transfer-encoding":re=ke[2].trim();break}}switch(++Re,re.toLowerCase()){case"base64":ye=ys(Bn(J.slice(Re).join("")));break;case"quoted-printable":ye=Mt(J.slice(Re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var Te=is(W,Y.slice(Z.length),ye,{unsafe:!0});ie&&(Te.ctype=ie)}function Ws(W,J){if(K(W.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Z=J&&J.root||"",Y=(Rt&&Buffer.isBuffer(W)?W.toString("binary"):K(W)).split(`\r
`),re=0,ie="";for(re=0;re<Y.length;++re)if(ie=Y[re],!!/^Content-Location:/i.test(ie)&&(ie=ie.slice(ie.indexOf("file")),Z||(Z=ie.slice(0,ie.lastIndexOf("/")+1)),ie.slice(0,Z.length)!=Z))for(;Z.length>0&&(Z=Z.slice(0,Z.length-1),Z=Z.slice(0,Z.lastIndexOf("/")+1),ie.slice(0,Z.length)!=Z););var ye=(Y[1]||"").match(/boundary="(.*?)"/);if(!ye)throw new Error("MAD cannot find boundary");var Re="--"+(ye[1]||""),_e=[],ke=[],Te={FileIndex:_e,FullPaths:ke};V(Te);var He,Ke=0;for(re=0;re<Y.length;++re){var Qe=Y[re];Qe!==Re&&Qe!==Re+"--"||(Ke++&&_n(Te,Y.slice(He,re),Z),He=re)}return Te}function ks(W,J){var Z=J||{},Y=Z.boundary||"SheetJS";Y="------="+Y;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],ie=W.FullPaths[0],ye=ie,Re=W.FileIndex[0],_e=1;_e<W.FullPaths.length;++_e)if(ye=W.FullPaths[_e].slice(ie.length),Re=W.FileIndex[_e],!(!Re.size||!Re.content||ye=="Sh33tJ5")){ye=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(mt){return"_x"+mt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(mt){return"_u"+mt.charCodeAt(0).toString(16)+"_"});for(var ke=Re.content,Te=Rt&&Buffer.isBuffer(ke)?ke.toString("binary"):K(ke),He=0,Ke=Math.min(1024,Te.length),Qe=0,$e=0;$e<=Ke;++$e)(Qe=Te.charCodeAt($e))>=32&&Qe<128&&++He;var Pe=He>=Ke*4/5;re.push(Y),re.push("Content-Location: "+(Z.root||"file:///C:/SheetJS/")+ye),re.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),re.push("Content-Type: "+cn(Re,ye)),re.push(""),re.push(Pe?bn(Te):si(Te))}return re.push(Y+`--\r
`),re.join(`\r
`)}function xa(W){var J={};return V(J,W),J}function is(W,J,Z,Y){var re=Y&&Y.unsafe;re||V(W);var ie=!re&&It.find(W,J);if(!ie){var ye=W.FullPaths[0];J.slice(0,ye.length)==ye?ye=J:(ye.slice(-1)!="/"&&(ye+="/"),ye=(ye+J).replace("//","/")),ie={name:s(J),type:2},W.FileIndex.push(ie),W.FullPaths.push(ye),re||It.utils.cfb_gc(W)}return ie.content=Z,ie.size=Z?Z.length:0,Y&&(Y.CLSID&&(ie.clsid=Y.CLSID),Y.mt&&(ie.mt=Y.mt),Y.ct&&(ie.ct=Y.ct)),ie}function Ac(W,J){V(W);var Z=It.find(W,J);if(Z){for(var Y=0;Y<W.FileIndex.length;++Y)if(W.FileIndex[Y]==Z)return W.FileIndex.splice(Y,1),W.FullPaths.splice(Y,1),!0}return!1}function Vn(W,J,Z){V(W);var Y=It.find(W,J);if(Y){for(var re=0;re<W.FileIndex.length;++re)if(W.FileIndex[re]==Y)return W.FileIndex[re].name=s(Z),W.FullPaths[re]=Z,!0}return!1}function ai(W){T(W,!0)}return r.find=H,r.read=D,r.parse=p,r.write=oe,r.writeFile=ae,r.utils={cfb_new:xa,cfb_add:is,cfb_del:Ac,cfb_mov:Vn,cfb_gc:ai,ReadShift:ec,CheckField:Fv,prep_blob:Hr,bconcat:qa,use_zlib:N,_deflateRaw:Ze,_inflateRaw:Ur,consts:he},r})();function VS(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(t);r.open("r"),r.encoding="binary";var e=r.read();return r.close(),e}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function $s(t){for(var r=Object.keys(t),e=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(t,r[n])&&e.push(r[n]);return e}function Sh(t){for(var r=[],e=$s(t),n=0;n!==e.length;++n)r[t[e[n]]]=e[n];return r}var fd=new Date(1899,11,30,0,0,0);function yn(t,r){var e=t.getTime(),n=fd.getTime()+(t.getTimezoneOffset()-fd.getTimezoneOffset())*6e4;return(e-n)/(1440*60*1e3)}var mv=new Date,WS=fd.getTime()+(mv.getTimezoneOffset()-fd.getTimezoneOffset())*6e4,_p=mv.getTimezoneOffset();function kd(t){var r=new Date;return r.setTime(t*24*60*60*1e3+WS),r.getTimezoneOffset()!==_p&&r.setTime(r.getTime()+(r.getTimezoneOffset()-_p)*6e4),r}function HS(t){var r=0,e=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=s.length;++o)if(s[o]){switch(e=1,o>3&&(n=!0),s[o].slice(s[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[o].slice(s[o].length-1));case"D":e*=24;case"H":e*=60;case"M":if(n)e*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=e*parseInt(s[o],10)}return r}var Sp=new Date("2017-02-19T19:06:09.000Z"),gv=isNaN(Sp.getFullYear())?new Date("2/19/17"):Sp,zS=gv.getFullYear()==2017;function Mr(t,r){var e=new Date(t);if(zS)return r>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):r<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(gv.getFullYear()==1917&&!isNaN(e.getFullYear())){var n=e.getFullYear();return t.indexOf(""+n)>-1||e.setFullYear(e.getFullYear()+100),e}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function $i(t,r){if(Rt&&Buffer.isBuffer(t)){if(r){if(t[0]==255&&t[1]==254)return Jl(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Jl(tv(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(t[0]==255&&t[1]==254)return Jl(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Jl(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return e[o]||o})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function zr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=zr(t[e]));return r}function lr(t,r){for(var e="";e.length<r;)e+=t;return e}function _s(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,o){return e=-e,o}),!isNaN(r=Number(n)))?r/e:r}var GS=["january","february","march","april","may","june","july","august","september","october","november","december"];function qo(t){var r=new Date(t),e=new Date(NaN),n=r.getYear(),s=r.getMonth(),o=r.getDate();if(isNaN(o))return e;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&GS.indexOf(l)==-1)return e}else if(l.match(/[a-z]/))return e;return n<0||n>8099?e:(s>0||o>1)&&n!=101?r:t.match(/[^-0-9:,\/\\]/)?e:r}var KS=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(e,n,s){if(t||typeof n=="string")return e.split(n);for(var o=e.split(n),l=[o[0]],u=1;u<o.length;++u)l.push(s),l.push(o[u]);return l}})();function pv(t){return t?t.content&&t.type?$i(t.content,!0):t.data?Kl(t.data):t.asNodeBuffer&&Rt?Kl(t.asNodeBuffer().toString("binary")):t.asBinary?Kl(t.asBinary()):t._data&&t._data.getContent?Kl($i(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function xv(t){if(!t)return null;if(t.data)return dp(t.data);if(t.asNodeBuffer&&Rt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var r=t._data.getContent();return typeof r=="string"?dp(r):Array.prototype.slice.call(r)}return t.content&&t.type?t.content:null}function XS(t){return t&&t.name.slice(-4)===".bin"?xv(t):pv(t)}function ns(t,r){for(var e=t.FullPaths||$s(t.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),o=0;o<e.length;++o){var l=e[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||s==l)return t.files?t.files[e[o]]:t.FileIndex[o]}return null}function Eh(t,r){var e=ns(t,r);if(e==null)throw new Error("Cannot find file "+r+" in zip");return e}function vr(t,r,e){if(!e)return XS(Eh(t,r));if(!r)return null;try{return vr(t,r)}catch{return null}}function Un(t,r,e){if(!e)return pv(Eh(t,r));if(!r)return null;try{return Un(t,r)}catch{return null}}function qS(t,r,e){return xv(Eh(t,r))}function Ep(t){for(var r=t.FullPaths||$s(t.files),e=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&e.push(r[n].replace(/^Root Entry[\/]/,""));return e.sort()}function JS(t,r,e){if(t.FullPaths){if(typeof e=="string"){var n;return Rt?n=Wi(e):n=gS(e),It.utils.cfb_add(t,r,n)}It.utils.cfb_add(t,r,e)}else t.file(r,e)}function vv(t,r){switch(r.type){case"base64":return It.read(t,{type:"base64"});case"binary":return It.read(t,{type:"binary"});case"buffer":case"array":return It.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function ql(t,r){if(t.charAt(0)=="/")return t.slice(1);var e=r.split("/");r.slice(-1)!="/"&&e.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?e.pop():s!=="."&&e.push(s)}return e.join("/")}var yv=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,YS=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,kp=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,QS=/<[^>]*>/g,on=yv.match(kp)?kp:QS,ZS=/<\w*:/,e2=/<(\/?)\w+:/;function ht(t,r,e){for(var n={},s=0,o=0;s!==t.length&&!((o=t.charCodeAt(s))===32||o===10||o===13);++s);if(r||(n[0]=t.slice(0,s)),s===t.length)return n;var l=t.match(YS),u=0,f="",m=0,p="",v="",w=1;if(l)for(m=0;m!=l.length;++m){for(v=l[m],o=0;o!=v.length&&v.charCodeAt(o)!==61;++o);for(p=v.slice(0,o).trim();v.charCodeAt(o+1)==32;)++o;for(w=(s=v.charCodeAt(o+1))==34||s==39?1:0,f=v.slice(o+1+w,v.length-w),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=f,n[p.toLowerCase()]=f;else{var _=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[_]&&p.slice(u-3,u)=="ext")continue;n[_]=f,n[_.toLowerCase()]=f}}return n}function Bs(t){return t.replace(e2,"<$1")}var wv={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},t2=Sh(wv),Lt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function e(n){var s=n+"",o=s.indexOf("<![CDATA[");if(o==-1)return s.replace(t,function(u,f){return wv[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(r,function(u,f){return String.fromCharCode(parseInt(f,16))});var l=s.indexOf("]]>");return e(s.slice(0,o))+s.slice(o+9,l)+e(s.slice(l+3))}})(),r2=/[&<>'"]/g,n2=/[\u0000-\u001f]/g;function kh(t){var r=t+"";return r.replace(r2,function(e){return t2[e]}).replace(/\n/g,"<br/>").replace(n2,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var Tp=(function(){var t=/&#(\d+);/g;function r(e,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,r)}})();function er(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function kf(t){for(var r="",e=0,n=0,s=0,o=0,l=0,u=0;e<t.length;){if(n=t.charCodeAt(e++),n<128){r+=String.fromCharCode(n);continue}if(s=t.charCodeAt(e++),n>191&&n<224){l=(n&31)<<6,l|=s&63,r+=String.fromCharCode(l);continue}if(o=t.charCodeAt(e++),n<240){r+=String.fromCharCode((n&15)<<12|(s&63)<<6|o&63);continue}l=t.charCodeAt(e++),u=((n&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536,r+=String.fromCharCode(55296+(u>>>10&1023)),r+=String.fromCharCode(56320+(u&1023))}return r}function Np(t){var r=Za(2*t.length),e,n,s=1,o=0,l=0,u;for(n=0;n<t.length;n+=s)s=1,(u=t.charCodeAt(n))<128?e=u:u<224?(e=(u&31)*64+(t.charCodeAt(n+1)&63),s=2):u<240?(e=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,e=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),e-=65536,l=55296+(e>>>10&1023),e=56320+(e&1023)),l!==0&&(r[o++]=l&255,r[o++]=l>>>8,l=0),r[o++]=e%256,r[o++]=e>>>8;return r.slice(0,o).toString("ucs2")}function Cp(t){return Wi(t,"binary").toString("utf8")}var Xu="foo bar baz",Yt=Rt&&(Cp(Xu)==kf(Xu)&&Cp||Np(Xu)==kf(Xu)&&Np)||kf,Jl=Rt?function(t){return Wi(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,n=0,s=0;e<t.length;)switch(n=t.charCodeAt(e++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(e++)-56320+(n<<10),r.push(String.fromCharCode(240+(s>>18&7))),r.push(String.fromCharCode(144+(s>>12&63))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},hc=(function(){var t={};return function(e,n){var s=e+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",n||"")}})(),bv=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var n=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}})(),s2=(function(){var t={};return function(e){return t[e]!==void 0?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}})(),a2=/<\/?(?:vt:)?variant>/g,i2=/<(?:vt:)([^>]*)>([\s\S]*)</;function jp(t,r){var e=ht(t),n=t.match(s2(e.baseType))||[],s=[];if(n.length!=e.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+e.size);return s}return n.forEach(function(o){var l=o.replace(a2,"").match(i2);l&&s.push({v:Yt(l[2]),t:l[1]})}),s}var o2=/(^\s|\s$|\n)/;function l2(t){return $s(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function c2(t,r,e){return"<"+t+(e!=null?l2(e):"")+(r!=null?(r.match(o2)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function Th(t){if(Rt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Yt(Hi(wh(t)));throw new Error("Bad input format: expected Buffer or string")}var mc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,u2={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},d2=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function f2(t,r){for(var e=1-2*(t[r+7]>>>7),n=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),s=t[r+6]&15,o=5;o>=0;--o)s=s*256+t[r+o];return n==2047?s==0?e*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),e*Math.pow(2,n-52)*s)}function h2(t,r,e){var n=(r<0||1/r==-1/0?1:0)<<7,s=0,o=0,l=n?-r:r;isFinite(l)?l==0?s=o=0:(s=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-s),s<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?s=-1022:(o-=Math.pow(2,52),s+=1023)):(s=2047,o=isNaN(r)?26985:0);for(var u=0;u<=5;++u,o/=256)t[e+u]=o&255;t[e+6]=(s&15)<<4|o&15,t[e+7]=s>>4|n}var Ap=function(t){for(var r=[],e=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,o=t[0][n].length;s<o;s+=e)r.push.apply(r,t[0][n].slice(s,s+e));return r},Rp=Rt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:Wi(r)})):Ap(t)}:Ap,Ip=function(t,r,e){for(var n=[],s=r;s<e;s+=2)n.push(String.fromCharCode(ca(t,s)));return n.join("").replace(vn,"")},Nh=Rt?function(t,r,e){return Buffer.isBuffer(t)?t.toString("utf16le",r,e).replace(vn,""):Ip(t,r,e)}:Ip,Op=function(t,r,e){for(var n=[],s=r;s<r+e;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},_v=Rt?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):Op(t,r,e)}:Op,Dp=function(t,r,e){for(var n=[],s=r;s<e;s++)n.push(String.fromCharCode(Wo(t,s)));return n.join("")},Ec=Rt?function(r,e,n){return Buffer.isBuffer(r)?r.toString("utf8",e,n):Dp(r,e,n)}:Dp,Sv=function(t,r){var e=$n(t,r);return e>0?Ec(t,r+4,r+4+e-1):""},Ev=Sv,kv=function(t,r){var e=$n(t,r);return e>0?Ec(t,r+4,r+4+e-1):""},Tv=kv,Nv=function(t,r){var e=2*$n(t,r);return e>0?Ec(t,r+4,r+4+e-1):""},Cv=Nv,jv=function(r,e){var n=$n(r,e);return n>0?Nh(r,e+4,e+4+n):""},Av=jv,Rv=function(t,r){var e=$n(t,r);return e>0?Ec(t,r+4,r+4+e):""},Iv=Rv,Ov=function(t,r){return f2(t,r)},hd=Ov,Dv=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Rt&&(Ev=function(r,e){if(!Buffer.isBuffer(r))return Sv(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},Tv=function(r,e){if(!Buffer.isBuffer(r))return kv(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},Cv=function(r,e){if(!Buffer.isBuffer(r))return Nv(r,e);var n=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n-1)},Av=function(r,e){if(!Buffer.isBuffer(r))return jv(r,e);var n=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n)},Iv=function(r,e){if(!Buffer.isBuffer(r))return Rv(r,e);var n=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+n)},hd=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):Ov(r,e)},Dv=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Wo=function(t,r){return t[r]},ca=function(t,r){return t[r+1]*256+t[r]},m2=function(t,r){var e=t[r+1]*256+t[r];return e<32768?e:(65535-e+1)*-1},$n=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},Di=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},g2=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function ec(t,r){var e="",n,s,o=[],l,u,f,m;switch(r){case"dbcs":if(m=this.l,Rt&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)e+=String.fromCharCode(ca(this,m)),m+=2;t*=2;break;case"utf8":e=Ec(this,this.l,this.l+t);break;case"utf16le":t*=2,e=Nh(this,this.l,this.l+t);break;case"wstr":return ec.call(this,t,"dbcs");case"lpstr-ansi":e=Ev(this,this.l),t=4+$n(this,this.l);break;case"lpstr-cp":e=Tv(this,this.l),t=4+$n(this,this.l);break;case"lpwstr":e=Cv(this,this.l),t=4+2*$n(this,this.l);break;case"lpp4":t=4+$n(this,this.l),e=Av(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+$n(this,this.l),e=Iv(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(l=Wo(this,this.l+t++))!==0;)o.push(Ku(l));e=o.join("");break;case"_wstr":for(t=0,e="";(l=ca(this,this.l+t))!==0;)o.push(Ku(l)),t+=2;t+=2,e=o.join("");break;case"dbcs-cont":for(e="",m=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(m)!==-1)return l=Wo(this,m),this.l=m+1,u=ec.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Ku(ca(this,m))),m+=2}e=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(e="",m=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(m)!==-1)return l=Wo(this,m),this.l=m+1,u=ec.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Ku(Wo(this,m))),m+=1}e=o.join("");break;default:switch(t){case 1:return n=Wo(this,this.l),this.l++,n;case 2:return n=(r==="i"?m2:ca)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(t>0?Di:g2)(this,this.l),this.l+=4,n):(s=$n(this,this.l),this.l+=4,s);case 8:case-8:if(r==="f")return t==8?s=hd(this,this.l):s=hd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:e=_v(this,this.l,t);break}}return this.l+=t,e}var p2=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},x2=function(t,r,e){t[e]=r&255,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},v2=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255};function y2(t,r,e){var n=0,s=0;if(e==="dbcs"){for(s=0;s!=r.length;++s)v2(this,r.charCodeAt(s),this.l+2*s);n=2*r.length}else if(e==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=r.length;++s)this[this.l+s]=r.charCodeAt(s)&255;n=r.length}else if(e==="hex"){for(;s<t;++s)this[this.l++]=parseInt(r.slice(2*s,2*s+2),16)||0;return this}else if(e==="utf16le"){var o=Math.min(this.l+t,this.length);for(s=0;s<Math.min(r.length,t);++s){var l=r.charCodeAt(s);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,p2(this,r,this.l);break;case 8:if(n=8,e==="f"){h2(this,r,this.l);break}case 16:break;case-4:n=4,x2(this,r,this.l);break}return this.l+=n,this}function Fv(t,r){var e=_v(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function Hr(t,r){t.l=r,t.read_shift=ec,t.chk=Fv,t.write_shift=y2}function sn(t,r){t.l+=r}function Cr(t){var r=Za(t);return Hr(r,0),r}function pa(t,r,e){if(t){var n,s,o;Hr(t,t.l||0);for(var l=t.length,u=0,f=0;t.l<l;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var m=yd[u]||yd[65535];for(n=t.read_shift(1),o=n&127,s=1;s<4&&n&128;++s)o+=((n=t.read_shift(1))&127)<<7*s;f=t.l+o;var p=m.f&&m.f(t,o,e);if(t.l=f,r(p,m,u))return}}}function qf(){var t=[],r=Rt?256:2048,e=function(m){var p=Cr(m);return Hr(p,0),p},n=e(r),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(m){return n&&m<n.length-n.l?n:(s(),n=e(Math.max(m+1,r)))},l=function(){return s(),qa(t)},u=function(m){s(),n=m,n.l==null&&(n.l=n.length),o(r)};return{next:o,push:u,end:l,_bufs:t}}function tc(t,r,e){var n=zr(t);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!e||e.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Fp(t,r,e){var n=zr(t);return n.s=tc(n.s,r.s,e),n.e=tc(n.e,r.s,e),n}function rc(t,r){if(t.cRel&&t.c<0)for(t=zr(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=zr(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=yt(t);return!t.cRel&&t.cRel!=null&&(e=_2(e)),!t.rRel&&t.rRel!=null&&(e=w2(e)),e}function Tf(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+jr(t.s.c)+":"+(t.e.cRel?"":"$")+jr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Gr(t.s.r)+":"+(t.e.rRel?"":"$")+Gr(t.e.r):rc(t.s,r.biff)+":"+rc(t.e,r.biff)}function Ch(t){return parseInt(b2(t),10)-1}function Gr(t){return""+(t+1)}function w2(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function b2(t){return t.replace(/\$(\d+)$/,"$1")}function jh(t){for(var r=S2(t),e=0,n=0;n!==r.length;++n)e=26*e+r.charCodeAt(n)-64;return e-1}function jr(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function _2(t){return t.replace(/^([A-Z])/,"$$$1")}function S2(t){return t.replace(/^\$([A-Z])/,"$1")}function E2(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function xn(t){for(var r=0,e=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?r=10*r+(s-48):s>=65&&s<=90&&(e=26*e+(s-64))}return{c:e-1,r:r-1}}function yt(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function rl(t){var r=t.indexOf(":");return r==-1?{s:xn(t),e:xn(t)}:{s:xn(t.slice(0,r)),e:xn(t.slice(r+1))}}function Ot(t,r){return typeof r>"u"||typeof r=="number"?Ot(t.s,t.e):(typeof t!="string"&&(t=yt(t)),typeof r!="string"&&(r=yt(r)),t==r?t:t+":"+r)}function cr(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,n=0,s=0,o=t.length;for(e=0;n<o&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)e=26*e+s;for(r.s.c=--e,e=0;n<o&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)e=10*e+s;if(r.s.r=--e,n===o||s!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,e=0;n!=o&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)e=26*e+s;for(r.e.c=--e,e=0;n!=o&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)e=10*e+s;return r.e.r=--e,r}function Pp(t,r){var e=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=ss(t.z,e?yn(r):r)}catch{}try{return t.w=ss((t.XF||{}).numFmtId||(e?14:0),e?yn(r):r)}catch{return""+r}}function ma(t,r,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?Ki[t.v]||t.v:r==null?Pp(t,t.v):Pp(t,r))}function ni(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",n={};return n[e]=t,{SheetNames:[e],Sheets:n}}function Pv(t,r,e){var n=e||{},s=t?Array.isArray(t):n.dense,o=t||(s?[]:{}),l=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?xn(n.origin):n.origin;l=f.r,u=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=cr(o["!ref"]);m.s.c=p.s.c,m.s.r=p.s.r,m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),l==-1&&(m.e.r=l=p.e.r+1)}for(var v=0;v!=r.length;++v)if(r[v]){if(!Array.isArray(r[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var w=0;w!=r[v].length;++w)if(!(typeof r[v][w]>"u")){var _={v:r[v][w]},k=l+v,b=u+w;if(m.s.r>k&&(m.s.r=k),m.s.c>b&&(m.s.c=b),m.e.r<k&&(m.e.r=k),m.e.c<b&&(m.e.c=b),r[v][w]&&typeof r[v][w]=="object"&&!Array.isArray(r[v][w])&&!(r[v][w]instanceof Date))_=r[v][w];else if(Array.isArray(_.v)&&(_.f=r[v][w][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(n.nullError)_.t="e",_.v=0;else if(n.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=n.dateNF||St[14],n.cellDates?(_.t="d",_.w=ss(_.z,yn(_.v))):(_.t="n",_.v=yn(_.v),_.w=ss(_.z,_.v))):_.t="s";if(s)o[k]||(o[k]=[]),o[k][b]&&o[k][b].z&&(_.z=o[k][b].z),o[k][b]=_;else{var y=yt({c:b,r:k});o[y]&&o[y].z&&(_.z=o[y].z),o[y]=_}}}return m.s.c<1e7&&(o["!ref"]=Ot(m)),o}function nl(t,r){return Pv(null,t,r)}function k2(t){return t.read_shift(4,"i")}function nn(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function T2(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Ah(t,r){var e=t.l,n=t.read_shift(1),s=nn(t),o=[],l={t:s,h:s};if((n&1)!==0){for(var u=t.read_shift(4),f=0;f!=u;++f)o.push(T2(t));l.r=o}else l.r=[{ich:0,ifnt:0}];return t.l=e+r,l}var N2=Ah;function as(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function zi(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}var C2=nn;function Rh(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}var j2=nn,Jf=Rh;function Ih(t){var r=t.slice(t.l,t.l+4),e=r[0]&1,n=r[0]&2;t.l+=4;var s=n===0?hd([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Di(r,0)>>2;return e?s/100:s}function Lv(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}var Gi=Lv;function tn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function A2(t){var r={},e=t.read_shift(1),n=e>>>1,s=t.read_shift(1),o=t.read_shift(2,"i"),l=t.read_shift(1),u=t.read_shift(1),f=t.read_shift(1);switch(t.l++,n){case 0:r.auto=1;break;case 1:r.index=s;var m=Li[s];m&&(r.rgb=pc(m));break;case 2:r.rgb=pc([l,u,f]);break;case 3:r.theme=s;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function R2(t){var r=t.read_shift(1);t.l++;var e={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return e}function Mv(t,r){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return e[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,r==1?"lpstr":"lpwstr")}function I2(t){return Mv(t,1)}function O2(t){return Mv(t,2)}var Oh=2,An=3,qu=11,Lp=12,md=19,Ju=64,D2=65,F2=71,P2=4108,L2=4126,Lr=80,$v=81,M2=[Lr,$v],$2={1:{n:"CodePage",t:Oh},2:{n:"Category",t:Lr},3:{n:"PresentationFormat",t:Lr},4:{n:"ByteCount",t:An},5:{n:"LineCount",t:An},6:{n:"ParagraphCount",t:An},7:{n:"SlideCount",t:An},8:{n:"NoteCount",t:An},9:{n:"HiddenCount",t:An},10:{n:"MultimediaClipCount",t:An},11:{n:"ScaleCrop",t:qu},12:{n:"HeadingPairs",t:P2},13:{n:"TitlesOfParts",t:L2},14:{n:"Manager",t:Lr},15:{n:"Company",t:Lr},16:{n:"LinksUpToDate",t:qu},17:{n:"CharacterCount",t:An},19:{n:"SharedDoc",t:qu},22:{n:"HyperlinksChanged",t:qu},23:{n:"AppVersion",t:An,p:"version"},24:{n:"DigSig",t:D2},26:{n:"ContentType",t:Lr},27:{n:"ContentStatus",t:Lr},28:{n:"Language",t:Lr},29:{n:"Version",t:Lr},255:{},2147483648:{n:"Locale",t:md},2147483651:{n:"Behavior",t:md},1919054434:{}},U2={1:{n:"CodePage",t:Oh},2:{n:"Title",t:Lr},3:{n:"Subject",t:Lr},4:{n:"Author",t:Lr},5:{n:"Keywords",t:Lr},6:{n:"Comments",t:Lr},7:{n:"Template",t:Lr},8:{n:"LastAuthor",t:Lr},9:{n:"RevNumber",t:Lr},10:{n:"EditTime",t:Ju},11:{n:"LastPrinted",t:Ju},12:{n:"CreatedDate",t:Ju},13:{n:"ModifiedDate",t:Ju},14:{n:"PageCount",t:An},15:{n:"WordCount",t:An},16:{n:"CharCount",t:An},17:{n:"Thumbnail",t:F2},18:{n:"Application",t:Lr},19:{n:"DocSecurity",t:An},255:{},2147483648:{n:"Locale",t:md},2147483651:{n:"Behavior",t:md},1919054434:{}},Mp={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},B2=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function V2(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var W2=V2([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Li=zr(W2),Ki={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Uv={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},$p={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function H2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function z2(t){var r=H2();if(!t||!t.match)return r;var e={};if((t.match(on)||[]).forEach(function(n){var s=ht(n);switch(s[0].replace(ZS,"<")){case"<?xml":break;case"<Types":r.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[s.Extension]=s.ContentType;break;case"<Override":r[$p[s.ContentType]]!==void 0&&r[$p[s.ContentType]].push(s.PartName);break}}),r.xmlns!==u2.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=e,delete r.calcchains,r}var Ho={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Yf(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function nc(t,r){var e={"!id":{}};if(!t)return e;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(t.match(on)||[]).forEach(function(s){var o=ht(s);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:ql(o.Target,r);e[u]=l,n[o.Id]=l}}),e["!id"]=n,e}var G2="application/vnd.oasis.opendocument.spreadsheet";function K2(t,r){for(var e=Th(t),n,s;n=mc.exec(e);)switch(n[3]){case"manifest":break;case"file-entry":if(s=ht(n[0],!1),s.path=="/"&&s.type!==G2)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var sc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],X2=(function(){for(var t=new Array(sc.length),r=0;r<sc.length;++r){var e=sc[r],n="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);t[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function Bv(t){var r={};t=Yt(t);for(var e=0;e<sc.length;++e){var n=sc[e],s=t.match(X2[e]);s!=null&&s.length>0&&(r[n[1]]=Lt(s[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=Mr(r[n[1]]))}return r}var q2=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Vv(t,r,e,n){var s=[];if(typeof t=="string")s=jp(t,n);else for(var o=0;o<t.length;++o)s=s.concat(t[o].map(function(p){return{v:p}}));var l=typeof r=="string"?jp(r,n).map(function(p){return p.v}):r,u=0,f=0;if(l.length>0)for(var m=0;m!==s.length;m+=2){switch(f=+s[m+1].v,s[m].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":e.Worksheets=f,e.SheetNames=l.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":e.NamedRanges=f,e.DefinedNames=l.slice(u,u+f);break;case"Charts":case"Diagramme":e.Chartsheets=f,e.ChartNames=l.slice(u,u+f);break}u+=f}}function J2(t,r,e){var n={};return r||(r={}),t=Yt(t),q2.forEach(function(s){var o=(t.match(hc(s[0]))||[])[1];switch(s[2]){case"string":o&&(r[s[1]]=Lt(o));break;case"bool":r[s[1]]=o==="true";break;case"raw":var l=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));l&&l.length>0&&(n[s[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Vv(n.HeadingPairs,n.TitlesOfParts,r,e),r}var Y2=/<[^>]+>[^<]*/g;function Q2(t,r){var e={},n="",s=t.match(Y2);if(s)for(var o=0;o!=s.length;++o){var l=s[o],u=ht(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Lt(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),m=f[0].slice(4),p=f[1];switch(m){case"lpstr":case"bstr":case"lpwstr":e[n]=Lt(p);break;case"bool":e[n]=er(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":e[n]=parseFloat(p);break;case"filetime":case"date":e[n]=Mr(p);break;case"cy":case"error":e[n]=Lt(p);break;default:if(m.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",l,m,f)}}else if(l.slice(0,2)!=="</"){if(r.WTF)throw new Error(l)}}}return e}var Z2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Nf;function eE(t,r,e){Nf||(Nf=Sh(Z2)),r=Nf[r]||r,t[r]=e}function Dh(t){var r=t.read_shift(4),e=t.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Wv(t,r,e){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(e)for(;t.l-n&3;)++t.l;return s}function Hv(t,r,e){var n=t.read_shift(0,"lpwstr");return n}function zv(t,r,e){return r===31?Hv(t):Wv(t,r,e)}function Qf(t,r,e){return zv(t,r,e===!1?0:4)}function tE(t,r){if(!r)throw new Error("VtUnalignedString must have positive length");return zv(t,r,0)}function rE(t){for(var r=t.read_shift(4),e=[],n=0;n!=r;++n){var s=t.l;e[n]=t.read_shift(0,"lpwstr").replace(vn,""),t.l-s&2&&(t.l+=2)}return e}function nE(t){for(var r=t.read_shift(4),e=[],n=0;n!=r;++n)e[n]=t.read_shift(0,"lpstr-cp").replace(vn,"");return e}function sE(t){var r=t.l,e=gd(t,$v);t[t.l]==0&&t[t.l+1]==0&&t.l-r&2&&(t.l+=2);var n=gd(t,An);return[e,n]}function aE(t){for(var r=t.read_shift(4),e=[],n=0;n<r/2;++n)e.push(sE(t));return e}function Up(t,r){for(var e=t.read_shift(4),n={},s=0;s!=e;++s){var o=t.read_shift(4),l=t.read_shift(4);n[o]=t.read_shift(l,r===1200?"utf16le":"utf8").replace(vn,"").replace(Xl,"!"),r===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function Gv(t){var r=t.read_shift(4),e=t.slice(t.l,t.l+r);return t.l+=r,(r&3)>0&&(t.l+=4-(r&3)&3),e}function iE(t){var r={};return r.Size=t.read_shift(4),t.l+=r.Size+3-(r.Size-1)%4,r}function gd(t,r,e){var n=t.read_shift(2),s,o=e||{};if(t.l+=2,r!==Lp&&n!==r&&M2.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===Lp?n:r){case 2:return s=t.read_shift(2,"i"),o.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return Wv(t,n,4).replace(vn,"");case 31:return Hv(t);case 64:return Dh(t);case 65:return Gv(t);case 71:return iE(t);case 80:return Qf(t,n,!o.raw).replace(vn,"");case 81:return tE(t,n).replace(vn,"");case 4108:return aE(t);case 4126:case 4127:return n==4127?rE(t):nE(t);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function Bp(t,r){var e=t.l,n=t.read_shift(4),s=t.read_shift(4),o=[],l=0,u=0,f=-1,m={};for(l=0;l!=s;++l){var p=t.read_shift(4),v=t.read_shift(4);o[l]=[p,v+e]}o.sort(function(G,j){return G[1]-j[1]});var w={};for(l=0;l!=s;++l){if(t.l!==o[l][1]){var _=!0;if(l>0&&r)switch(r[o[l-1][0]].t){case 2:t.l+2===o[l][1]&&(t.l+=2,_=!1);break;case 80:t.l<=o[l][1]&&(t.l=o[l][1],_=!1);break;case 4108:t.l<=o[l][1]&&(t.l=o[l][1],_=!1);break}if((!r||l==0)&&t.l<=o[l][1]&&(_=!1,t.l=o[l][1]),_)throw new Error("Read Error: Expected address "+o[l][1]+" at "+t.l+" :"+l)}if(r){var k=r[o[l][0]];if(w[k.n]=gd(t,k.t,{raw:!0}),k.p==="version"&&(w[k.n]=String(w[k.n]>>16)+"."+("0000"+String(w[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(w[k.n]){case 0:w[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ws(u=w[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+w[k.n])}}else if(o[l][0]===1){if(u=w.CodePage=gd(t,Oh),ws(u),f!==-1){var b=t.l;t.l=o[f][1],m=Up(t,u),t.l=b}}else if(o[l][0]===0){if(u===0){f=l,t.l=o[l+1][1];continue}m=Up(t,u)}else{var y=m[o[l][0]],L;switch(t[t.l]){case 65:t.l+=4,L=Gv(t);break;case 30:t.l+=4,L=Qf(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,L=Qf(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,L=t.read_shift(4,"i");break;case 19:t.l+=4,L=t.read_shift(4);break;case 5:t.l+=4,L=t.read_shift(8,"f");break;case 11:t.l+=4,L=mr(t,4);break;case 64:t.l+=4,L=Mr(Dh(t));break;default:throw new Error("unparsed value: "+t[t.l])}w[y]=L}}return t.l=e+n,w}function Vp(t,r,e){var n=t.content;if(!n)return{};Hr(n,0);var s,o,l,u,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var m=n.read_shift(4),p=n.read_shift(16);if(p!==It.utils.consts.HEADER_CLSID&&p!==e)throw new Error("Bad PropertySet CLSID "+p);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(o=n.read_shift(16),u=n.read_shift(4),s===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);s===2&&(l=n.read_shift(16),f=n.read_shift(4));var v=Bp(n,r),w={SystemIdentifier:m};for(var _ in v)w[_]=v[_];if(w.FMTID=o,s===1)return w;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var k;try{k=Bp(n,null)}catch{}for(_ in k)w[_]=k[_];return w.FMTID=[o,l],w}function Ga(t,r){return t.read_shift(r),null}function oE(t,r,e){for(var n=[],s=t.l+r;t.l<s;)n.push(e(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function mr(t,r){return t.read_shift(r)===1}function yr(t){return t.read_shift(2,"u")}function Kv(t,r){return oE(t,r,yr)}function lE(t){var r=t.read_shift(1),e=t.read_shift(1);return e===1?r:r===1}function kc(t,r,e){var n=t.read_shift(e&&e.biff>=12?2:1),s="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var o=t.read_shift(1);o&&(s="dbcs-cont")}else e.biff==12&&(s="wstr");e.biff>=2&&e.biff<=5&&(s="cpstr");var l=n?t.read_shift(n,s):"";return l}function cE(t){var r=t.read_shift(2),e=t.read_shift(1),n=e&4,s=e&8,o=1+(e&1),l=0,u,f={};s&&(l=t.read_shift(2)),n&&(u=t.read_shift(4));var m=o==2?"dbcs-cont":"sbcs-cont",p=r===0?"":t.read_shift(r,m);return s&&(t.l+=4*l),n&&(t.l+=u),f.t=p,s||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function Ui(t,r,e){var n;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(r,"sbcs-cont"):n=t.read_shift(r,"dbcs-cont"),n}function Tc(t,r,e){var n=t.read_shift(e&&e.biff==2?1:2);return n===0?(t.l++,""):Ui(t,n,e)}function Xi(t,r,e){if(e.biff>5)return Tc(t,r,e);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function uE(t){var r=t.read_shift(1);t.l++;var e=t.read_shift(2);return t.l+=2,[r,e]}function dE(t){var r=t.read_shift(4),e=t.l,n=!1;r>24&&(t.l+=r-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=e);var s=t.read_shift((n?r-24:r)>>1,"utf16le").replace(vn,"");return n&&(t.l+=24),s}function fE(t){for(var r=t.read_shift(2),e="";r-- >0;)e+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return e+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(o>>1,"utf16le").replace(vn,"");return e+l}function hE(t,r){var e=t.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return dE(t);case"0303000000000000c000000000000046":return fE(t);default:throw new Error("Unsupported Moniker "+e)}}function Yu(t){var r=t.read_shift(4),e=r>0?t.read_shift(r,"utf16le").replace(vn,""):"";return e}function mE(t,r){var e=t.l+r,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var o,l,u,f,m="",p,v;s&16&&(o=Yu(t,e-t.l)),s&128&&(l=Yu(t,e-t.l)),(s&257)===257&&(u=Yu(t,e-t.l)),(s&257)===1&&(f=hE(t,e-t.l)),s&8&&(m=Yu(t,e-t.l)),s&32&&(p=t.read_shift(16)),s&64&&(v=Dh(t)),t.l=e;var w=l||u||f||"";w&&m&&(w+="#"+m),w||(w="#"+m),s&2&&w.charAt(0)=="/"&&w.charAt(1)!="/"&&(w="file://"+w);var _={Target:w};return p&&(_.guid=p),v&&(_.time=v),o&&(_.Tooltip=o),_}function Xv(t){var r=t.read_shift(1),e=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[r,e,n,s]}function qv(t,r){var e=Xv(t);return e[3]=0,e}function Vs(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2);return{r,c:e,ixfe:n}}function gE(t){var r=t.read_shift(2),e=t.read_shift(2);return t.l+=8,{type:r,flags:e}}function pE(t,r,e){return r===0?"":Xi(t,r,e)}function xE(t,r,e){var n=e.biff>8?4:2,s=t.read_shift(n),o=t.read_shift(n,"i"),l=t.read_shift(n,"i");return[s,o,l]}function Jv(t){var r=t.read_shift(2),e=Ih(t);return[r,e]}function vE(t,r,e){t.l+=4,r-=4;var n=t.l+r,s=kc(t,r,e),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,s}function Td(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r},e:{c:s,r:e}}}function Yv(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r},e:{c:s,r:e}}}var yE=Yv;function Qv(t){t.l+=4;var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[e,r,n]}function wE(t){var r={};return t.l+=4,t.l+=16,r.fSharedNote=t.read_shift(2),t.l+=4,r}function bE(t){var r={};return t.l+=4,t.cf=t.read_shift(2),r}function Zr(t){t.l+=2,t.l+=t.read_shift(2)}var _E={0:Zr,4:Zr,5:Zr,6:Zr,7:bE,8:Zr,9:Zr,10:Zr,11:Zr,12:Zr,13:wE,14:Zr,15:Zr,16:Zr,17:Zr,18:Zr,19:Zr,20:Zr,21:Qv};function SE(t,r){for(var e=t.l+r,n=[];t.l<e;){var s=t.read_shift(2);t.l-=2;try{n.push(_E[s](t,e-t.l))}catch{return t.l=e,n}}return t.l!=e&&(t.l=e),n}function Qu(t,r){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=t.read_shift(2),r-=2,r>=2&&(e.dt=t.read_shift(2),t.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return t.read_shift(r),e}function EE(t,r){return r===0||t.read_shift(2),1200}function kE(t,r,e){if(e.enc)return t.l+=r,"";var n=t.l,s=Xi(t,0,e);return t.read_shift(r+n-t.l),s}function TE(t,r,e){var n=e&&e.biff==8||r==2?t.read_shift(2):(t.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function NE(t,r,e){var n=t.read_shift(4),s=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=kc(t,0,e);return l.length===0&&(l="Sheet1"),{pos:n,hs:s,dt:o,name:l}}function CE(t,r){for(var e=t.l+r,n=t.read_shift(4),s=t.read_shift(4),o=[],l=0;l!=s&&t.l<e;++l)o.push(cE(t));return o.Count=n,o.Unique=s,o}function jE(t,r){var e={};return e.dsst=t.read_shift(2),t.l+=r-2,e}function AE(t){var r={};r.r=t.read_shift(2),r.c=t.read_shift(2),r.cnt=t.read_shift(2)-r.c;var e=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=e/20),r}function RE(t){var r=gE(t);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var e=t.read_shift(4);return e!==0}function IE(t){return t.read_shift(2),t.read_shift(4)}function Wp(t,r,e){var n=0;e&&e.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);e&&e.biff==2&&(n=1-(s>>15),s&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,s]}function OE(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2),f=t.read_shift(2),m=t.read_shift(2);return{Pos:[r,e],Dim:[n,s],Flags:o,CurTab:l,FirstTab:u,Selected:f,TabRatio:m}}function DE(t,r,e){if(e&&e.biff>=2&&e.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function FE(){}function PE(t,r,e){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=kc(t,0,e),n}function LE(t){var r=Vs(t);return r.isst=t.read_shift(4),r}function ME(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=t.l+r,s=Vs(t);e.biff==2&&t.l++;var o=Tc(t,n-t.l,e);return s.val=o,s}function $E(t,r,e){var n=t.read_shift(2),s=Xi(t,0,e);return[n,s]}var UE=Xi;function Hp(t,r,e){var n=t.l+r,s=e.biff==8||!e.biff?4:2,o=t.read_shift(s),l=t.read_shift(s),u=t.read_shift(2),f=t.read_shift(2);return t.l=n,{s:{r:o,c:u},e:{r:l,c:f}}}function BE(t){var r=t.read_shift(2),e=t.read_shift(2),n=Jv(t);return{r,c:e,ixfe:n[0],rknum:n[1]}}function VE(t,r){for(var e=t.l+r-2,n=t.read_shift(2),s=t.read_shift(2),o=[];t.l<e;)o.push(Jv(t));if(t.l!==e)throw new Error("MulRK read error");var l=t.read_shift(2);if(o.length!=l-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:l,rkrec:o}}function WE(t,r){for(var e=t.l+r-2,n=t.read_shift(2),s=t.read_shift(2),o=[];t.l<e;)o.push(t.read_shift(2));if(t.l!==e)throw new Error("MulBlank read error");var l=t.read_shift(2);if(o.length!=l-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:l,ixfe:o}}function HE(t,r,e,n){var s={},o=t.read_shift(4),l=t.read_shift(4),u=t.read_shift(4),f=t.read_shift(2);return s.patternType=B2[u>>26],n.cellStyles&&(s.alc=o&7,s.fWrap=o>>3&1,s.alcV=o>>4&7,s.fJustLast=o>>7&1,s.trot=o>>8&255,s.cIndent=o>>16&15,s.fShrinkToFit=o>>20&1,s.iReadOrder=o>>22&2,s.fAtrNum=o>>26&1,s.fAtrFnt=o>>27&1,s.fAtrAlc=o>>28&1,s.fAtrBdr=o>>29&1,s.fAtrPat=o>>30&1,s.fAtrProt=o>>31&1,s.dgLeft=l&15,s.dgRight=l>>4&15,s.dgTop=l>>8&15,s.dgBottom=l>>12&15,s.icvLeft=l>>16&127,s.icvRight=l>>23&127,s.grbitDiag=l>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=f&127,s.icvBack=f>>7&127,s.fsxButton=f>>14&1),s}function zE(t,r,e){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=HE(t,r,n.fStyle,e),n}function GE(t){t.l+=4;var r=[t.read_shift(2),t.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function zp(t,r,e){var n=Vs(t);(e.biff==2||r==9)&&++t.l;var s=lE(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function KE(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=Vs(t),s=tn(t);return n.val=s,n}var Gp=pE;function XE(t,r,e){var n=t.l+r,s=t.read_shift(2),o=t.read_shift(2);if(e.sbcch=o,o==1025||o==14849)return[o,s];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=Ui(t,o),u=[];n>t.l;)u.push(Tc(t));return[o,s,l,u]}function Kp(t,r,e){var n=t.read_shift(2),s,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return e.sbcch===14849&&(s=vE(t,r-2,e)),o.body=s||t.read_shift(r-2),typeof s=="string"&&(o.Name=s),o}var qE=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Xp(t,r,e){var n=t.l+r,s=t.read_shift(2),o=t.read_shift(1),l=t.read_shift(1),u=t.read_shift(e&&e.biff==2?1:2),f=0;(!e||e.biff>=5)&&(e.biff!=5&&(t.l+=2),f=t.read_shift(2),e.biff==5&&(t.l+=2),t.l+=4);var m=Ui(t,l,e);s&32&&(m=qE[m.charCodeAt(0)]);var p=n-t.l;e&&e.biff==2&&--p;var v=n==t.l||u===0||!(p>0)?[]:AC(t,p,e,u);return{chKey:o,Name:m,itab:f,rgce:v}}function Zv(t,r,e){if(e.biff<8)return JE(t,r,e);for(var n=[],s=t.l+r,o=t.read_shift(e.biff>8?4:2);o--!==0;)n.push(xE(t,e.biff>8?12:6,e));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function JE(t,r,e){t[t.l+1]==3&&t[t.l]++;var n=kc(t,r,e);return n.charCodeAt(0)==3?n.slice(1):n}function YE(t,r,e){if(e.biff<8){t.l+=r;return}var n=t.read_shift(2),s=t.read_shift(2),o=Ui(t,n,e),l=Ui(t,s,e);return[o,l]}function QE(t,r,e){var n=Yv(t);t.l++;var s=t.read_shift(1);return r-=8,[RC(t,r,e),s,n]}function qp(t,r,e){var n=yE(t);switch(e.biff){case 2:t.l++,r-=7;break;case 3:case 4:t.l+=2,r-=8;break;default:t.l+=6,r-=12}return[n,CC(t,r,e)]}function ZE(t){var r=t.read_shift(4)!==0,e=t.read_shift(4)!==0,n=t.read_shift(4);return[r,e,n]}function ek(t,r,e){if(!(e.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=Xi(t,0,e);return e.biff<8&&t.read_shift(1),[{r:n,c:s},u,l,o]}}function tk(t,r,e){return ek(t,r,e)}function rk(t,r){for(var e=[],n=t.read_shift(2);n--;)e.push(Td(t));return e}function nk(t,r,e){if(e&&e.biff<8)return ak(t,r,e);var n=Qv(t),s=SE(t,r-22,n[1]);return{cmo:n,ft:s}}var sk={8:function(t,r){var e=t.l+r;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=e,{fmt:n}}};function ak(t,r,e){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,r-=36;var l=[];return l.push((sk[n]||sn)(t,r,e)),{cmo:[s,n,o],ft:l}}function ik(t,r,e){var n=t.l,s="";try{t.l+=4;var o=(e.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:l=uE(t,6,e);var u=t.read_shift(2);t.read_shift(2),yr(t,2);var f=t.read_shift(2);t.l+=f;for(var m=1;m<t.lens.length-1;++m){if(t.l-n!=t.lens[m])throw new Error("TxO: bad continue record");var p=t[t.l],v=Ui(t,t.lens[m+1]-t.lens[m]-1);if(s+=v,s.length>=(p?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return t.l=n+r,{t:s}}catch{return t.l=n+r,{t:s}}}function ok(t,r){var e=Td(t);t.l+=16;var n=mE(t,r-24);return[e,n]}function lk(t,r){t.read_shift(2);var e=Td(t),n=t.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(vn,""),[e,n]}function ck(t){var r=[0,0],e;return e=t.read_shift(2),r[0]=Mp[e]||e,e=t.read_shift(2),r[1]=Mp[e]||e,r}function uk(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(qv(t));return e}function dk(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(qv(t));return e}function fk(t){t.l+=2;var r={cxfs:0,crc:0};return r.cxfs=t.read_shift(2),r.crc=t.read_shift(4),r}function e1(t,r,e){if(!e.cellStyles)return sn(t,r);var n=e&&e.biff>=12?4:2,s=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),u=t.read_shift(n),f=t.read_shift(2);n==2&&(t.l+=2);var m={s,e:o,w:l,ixfe:u,flags:f};return(e.biff>=5||!e.biff)&&(m.level=f>>8&7),m}function hk(t,r){var e={};return r<32||(t.l+=16,e.header=tn(t),e.footer=tn(t),t.l+=2),e}function mk(t,r,e){var n={area:!1};if(e.biff!=5)return t.l+=r,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var gk=Vs,pk=Kv,xk=Tc;function vk(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(4),s={fmt:r,env:e,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function yk(t,r,e){e.biffguess&&e.biff==5&&(e.biff=2);var n=Vs(t);++t.l;var s=Xi(t,r-7,e);return n.t="str",n.val=s,n}function wk(t){var r=Vs(t);++t.l;var e=tn(t);return r.t="n",r.val=e,r}function bk(t){var r=Vs(t);++t.l;var e=t.read_shift(2);return r.t="n",r.val=e,r}function _k(t){var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,"sbcs-cont")}function Sk(t,r){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=r-13}function Ek(t,r,e){var n=t.l+r,s=Vs(t),o=t.read_shift(2),l=Ui(t,o,e);return t.l=n,s.t="str",s.val=l,s}var kk=[2,3,48,49,131,139,140,245],Jp=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Sh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(u,f){var m=[],p=Za(1);switch(f.type){case"base64":p=ys(Bn(u));break;case"binary":p=ys(u);break;case"buffer":case"array":p=u;break}Hr(p,0);var v=p.read_shift(1),w=!!(v&136),_=!1,k=!1;switch(v){case 2:break;case 3:break;case 48:_=!0,w=!0;break;case 49:_=!0,w=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var b=0,y=521;v==2&&(b=p.read_shift(2)),p.l+=3,v!=2&&(b=p.read_shift(4)),b>1048576&&(b=1e6),v!=2&&(y=p.read_shift(2));var L=p.read_shift(2),G=f.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(G=t[p[p.l]]),p.l+=1,p.l+=2),k&&(p.l+=36);for(var j=[],F={},ue=Math.min(p.length,v==2?521:y-10-(_?264:0)),D=k?32:11;p.l<ue&&p[p.l]!=13;)switch(F={},F.name=dc.utils.decode(G,p.slice(p.l,p.l+D)).replace(/[\u0000\r\n].*$/g,""),p.l+=D,F.type=String.fromCharCode(p.read_shift(1)),v!=2&&!k&&(F.offset=p.read_shift(4)),F.len=p.read_shift(1),v==2&&(F.offset=p.read_shift(2)),F.dec=p.read_shift(1),F.name.length&&j.push(F),v!=2&&(p.l+=k?13:14),F.type){case"B":(!_||F.len!=8)&&f.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(p[p.l]!==13&&(p.l=y-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=y;var V=0,ee=0;for(m[0]=[],ee=0;ee!=j.length;++ee)m[0][ee]=j[ee].name;for(;b-- >0;){if(p[p.l]===42){p.l+=L;continue}for(++p.l,m[++V]=[],ee=0,ee=0;ee!=j.length;++ee){var T=p.slice(p.l,p.l+j[ee].len);p.l+=j[ee].len,Hr(T,0);var O=dc.utils.decode(G,T);switch(j[ee].type){case"C":O.trim().length&&(m[V][ee]=O.replace(/\s+$/,""));break;case"D":O.length===8?m[V][ee]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):m[V][ee]=O;break;case"F":m[V][ee]=parseFloat(O.trim());break;case"+":case"I":m[V][ee]=k?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":m[V][ee]=!0;break;case"N":case"F":m[V][ee]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!w)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));m[V][ee]="##MEMO##"+(k?parseInt(O.trim(),10):T.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(m[V][ee]=+O||0);break;case"@":m[V][ee]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":m[V][ee]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":m[V][ee]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[V][ee]=-T.read_shift(-8,"f");break;case"B":if(_&&j[ee].len==8){m[V][ee]=T.read_shift(8,"f");break}case"G":case"P":T.l+=j[ee].len;break;case"0":if(j[ee].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+j[ee].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(m=m.slice(0,f.sheetRows)),f.DBF=j,m}function n(u,f){var m=f||{};m.dateNF||(m.dateNF="yyyymmdd");var p=nl(e(u,m),m);return p["!cols"]=m.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete m.DBF,p}function s(u,f){try{return ni(n(u,f),f)}catch(m){if(f&&f.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,f){var m=f||{};if(+m.codepage>=0&&ws(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var p=qf(),v=sh(u,{header:1,raw:!0,cellDates:!0}),w=v[0],_=v.slice(1),k=u["!cols"]||[],b=0,y=0,L=0,G=1;for(b=0;b<w.length;++b){if(((k[b]||{}).DBF||{}).name){w[b]=k[b].DBF.name,++L;continue}if(w[b]!=null){if(++L,typeof w[b]=="number"&&(w[b]=w[b].toString(10)),typeof w[b]!="string")throw new Error("DBF Invalid column name "+w[b]+" |"+typeof w[b]+"|");if(w.indexOf(w[b])!==b){for(y=0;y<1024;++y)if(w.indexOf(w[b]+"_"+y)==-1){w[b]+="_"+y;break}}}}var j=cr(u["!ref"]),F=[],ue=[],D=[];for(b=0;b<=j.e.c-j.s.c;++b){var V="",ee="",T=0,O=[];for(y=0;y<_.length;++y)_[y][b]!=null&&O.push(_[y][b]);if(O.length==0||w[b]==null){F[b]="?";continue}for(y=0;y<O.length;++y){switch(typeof O[y]){case"number":ee="B";break;case"string":ee="C";break;case"boolean":ee="L";break;case"object":ee=O[y]instanceof Date?"D":"C";break;default:ee="C"}T=Math.max(T,String(O[y]).length),V=V&&V!=ee?"C":ee}T>250&&(T=250),ee=((k[b]||{}).DBF||{}).type,ee=="C"&&k[b].DBF.len>T&&(T=k[b].DBF.len),V=="B"&&ee=="N"&&(V="N",D[b]=k[b].DBF.dec,T=k[b].DBF.len),ue[b]=V=="C"||ee=="N"?T:o[V]||0,G+=ue[b],F[b]=V}var H=p.next(32);for(H.write_shift(4,318902576),H.write_shift(4,_.length),H.write_shift(2,296+32*L),H.write_shift(2,G),b=0;b<4;++b)H.write_shift(4,0);for(H.write_shift(4,0|(+r[Zx]||3)<<8),b=0,y=0;b<w.length;++b)if(w[b]!=null){var U=p.next(32),X=(w[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,X,"sbcs"),U.write_shift(1,F[b]=="?"?"C":F[b],"sbcs"),U.write_shift(4,y),U.write_shift(1,ue[b]||o[F[b]]||0),U.write_shift(1,D[b]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),y+=ue[b]||o[F[b]]||0}var ve=p.next(264);for(ve.write_shift(4,13),b=0;b<65;++b)ve.write_shift(4,0);for(b=0;b<_.length;++b){var we=p.next(G);for(we.write_shift(1,0),y=0;y<w.length;++y)if(w[y]!=null)switch(F[y]){case"L":we.write_shift(1,_[b][y]==null?63:_[b][y]?84:70);break;case"B":we.write_shift(8,_[b][y]||0,"f");break;case"N":var Ne="0";for(typeof _[b][y]=="number"&&(Ne=_[b][y].toFixed(D[y]||0)),L=0;L<ue[y]-Ne.length;++L)we.write_shift(1,32);we.write_shift(1,Ne,"sbcs");break;case"D":_[b][y]?(we.write_shift(4,("0000"+_[b][y].getFullYear()).slice(-4),"sbcs"),we.write_shift(2,("00"+(_[b][y].getMonth()+1)).slice(-2),"sbcs"),we.write_shift(2,("00"+_[b][y].getDate()).slice(-2),"sbcs")):we.write_shift(8,"00000000","sbcs");break;case"C":var he=String(_[b][y]!=null?_[b][y]:"").slice(0,ue[y]);for(we.write_shift(1,he,"sbcs"),L=0;L<ue[y]-he.length;++L)we.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:s,to_sheet:n,from_sheet:l}})(),Tk=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+$s(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(w,_){var k=t[_];return typeof k=="number"?fp(k):k},n=function(w,_,k){var b=_.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return b==59?w:fp(b)};t["|"]=254;function s(w,_){switch(_.type){case"base64":return o(Bn(w),_);case"binary":return o(w,_);case"buffer":return o(Rt&&Buffer.isBuffer(w)?w.toString("binary"):Hi(w),_);case"array":return o($i(w),_)}throw new Error("Unrecognized type "+_.type)}function o(w,_){var k=w.split(/[\n\r]+/),b=-1,y=-1,L=0,G=0,j=[],F=[],ue=null,D={},V=[],ee=[],T=[],O=0,H;for(+_.codepage>=0&&ws(+_.codepage);L!==k.length;++L){O=0;var U=k[L].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,e),X=U.replace(/;;/g,"\0").split(";").map(function(ne){return ne.replace(/\u0000/g,";")}),ve=X[0],we;if(U.length>0)switch(ve){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":X[1].charAt(0)=="P"&&F.push(U.slice(3).replace(/;;/g,";"));break;case"C":var Ne=!1,he=!1,ae=!1,K=!1,oe=-1,A=-1;for(G=1;G<X.length;++G)switch(X[G].charAt(0)){case"A":break;case"X":y=parseInt(X[G].slice(1))-1,he=!0;break;case"Y":for(b=parseInt(X[G].slice(1))-1,he||(y=0),H=j.length;H<=b;++H)j[H]=[];break;case"K":we=X[G].slice(1),we.charAt(0)==='"'?we=we.slice(1,we.length-1):we==="TRUE"?we=!0:we==="FALSE"?we=!1:isNaN(_s(we))?isNaN(qo(we).getDate())||(we=Mr(we)):(we=_s(we),ue!==null&&tl(ue)&&(we=kd(we))),Ne=!0;break;case"E":K=!0;var N=Go(X[G].slice(1),{r:b,c:y});j[b][y]=[j[b][y],N];break;case"S":ae=!0,j[b][y]=[j[b][y],"S5S"];break;case"G":break;case"R":oe=parseInt(X[G].slice(1))-1;break;case"C":A=parseInt(X[G].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+U)}if(Ne&&(j[b][y]&&j[b][y].length==2?j[b][y][0]=we:j[b][y]=we,ue=null),ae){if(K)throw new Error("SYLK shared formula cannot have own formula");var B=oe>-1&&j[oe][A];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");j[b][y][1]=u1(B[1],{r:b-oe,c:y-A})}break;case"F":var q=0;for(G=1;G<X.length;++G)switch(X[G].charAt(0)){case"X":y=parseInt(X[G].slice(1))-1,++q;break;case"Y":for(b=parseInt(X[G].slice(1))-1,H=j.length;H<=b;++H)j[H]=[];break;case"M":O=parseInt(X[G].slice(1))/20;break;case"F":break;case"G":break;case"P":ue=F[parseInt(X[G].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=X[G].slice(1).split(" "),H=parseInt(T[0],10);H<=parseInt(T[1],10);++H)O=parseInt(T[2],10),ee[H-1]=O===0?{hidden:!0}:{wch:O},Jo(ee[H-1]);break;case"C":y=parseInt(X[G].slice(1))-1,ee[y]||(ee[y]={});break;case"R":b=parseInt(X[G].slice(1))-1,V[b]||(V[b]={}),O>0?(V[b].hpt=O,V[b].hpx=xc(O)):O===0&&(V[b].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+U)}q<1&&(ue=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+U)}}return V.length>0&&(D["!rows"]=V),ee.length>0&&(D["!cols"]=ee),_&&_.sheetRows&&(j=j.slice(0,_.sheetRows)),[j,D]}function l(w,_){var k=s(w,_),b=k[0],y=k[1],L=nl(b,_);return $s(y).forEach(function(G){L[G]=y[G]}),L}function u(w,_){return ni(l(w,_),_)}function f(w,_,k,b){var y="C;Y"+(k+1)+";X"+(b+1)+";K";switch(w.t){case"n":y+=w.v||0,w.f&&!w.F&&(y+=";E"+fN(w.f,{r:k,c:b}));break;case"b":y+=w.v?"TRUE":"FALSE";break;case"e":y+=w.w||w.v;break;case"d":y+='"'+(w.w||w.v)+'"';break;case"s":y+='"'+w.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function m(w,_){_.forEach(function(k,b){var y="F;W"+(b+1)+" "+(b+1)+" ";k.hidden?y+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=xd(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=vd(k.wpx)),typeof k.wch=="number"&&(y+=Math.round(k.wch))),y.charAt(y.length-1)!=" "&&w.push(y)})}function p(w,_){_.forEach(function(k,b){var y="F;";k.hidden?y+="M0;":k.hpt?y+="M"+20*k.hpt+";":k.hpx&&(y+="M"+20*o1(k.hpx)+";"),y.length>2&&w.push(y+"R"+(b+1))})}function v(w,_){var k=["ID;PWXL;N;E"],b=[],y=cr(w["!ref"]),L,G=Array.isArray(w),j=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),w["!cols"]&&m(k,w["!cols"]),w["!rows"]&&p(k,w["!rows"]),k.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var F=y.s.r;F<=y.e.r;++F)for(var ue=y.s.c;ue<=y.e.c;++ue){var D=yt({r:F,c:ue});L=G?(w[F]||[])[ue]:w[D],!(!L||L.v==null&&(!L.f||L.F))&&b.push(f(L,w,F,ue))}return k.join(j)+j+b.join(j)+j+"E"+j}return{to_workbook:u,to_sheet:l,from_sheet:v}})(),Nk=(function(){function t(o,l){switch(l.type){case"base64":return r(Bn(o),l);case"binary":return r(o,l);case"buffer":return r(Rt&&Buffer.isBuffer(o)?o.toString("binary"):Hi(o),l);case"array":return r($i(o),l)}throw new Error("Unrecognized type "+l.type)}function r(o,l){for(var u=o.split(`
`),f=-1,m=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++f]=[],m=0;continue}if(!(f<0)){var w=u[p].trim().split(","),_=w[0],k=w[1];++p;for(var b=u[p]||"";(b.match(/["]/g)||[]).length&1&&p<u.length-1;)b+=`
`+u[++p];switch(b=b.trim(),+_){case-1:if(b==="BOT"){v[++f]=[],m=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?v[f][m]=!0:b==="FALSE"?v[f][m]=!1:isNaN(_s(k))?isNaN(qo(k).getDate())?v[f][m]=k:v[f][m]=Mr(k):v[f][m]=_s(k),++m;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),v[f][m++]=b!==""?b:null;break}if(b==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function e(o,l){return nl(t(o,l),l)}function n(o,l){return ni(e(o,l),l)}var s=(function(){var o=function(f,m,p,v,w){f.push(m),f.push(p+","+v),f.push('"'+w.replace(/"/g,'""')+'"')},l=function(f,m,p,v){f.push(m+","+p),f.push(m==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(f){var m=[],p=cr(f["!ref"]),v,w=Array.isArray(f);o(m,"TABLE",0,1,"sheetjs"),o(m,"VECTORS",0,p.e.r-p.s.r+1,""),o(m,"TUPLES",0,p.e.c-p.s.c+1,""),o(m,"DATA",0,0,"");for(var _=p.s.r;_<=p.e.r;++_){l(m,-1,0,"BOT");for(var k=p.s.c;k<=p.e.c;++k){var b=yt({r:_,c:k});if(v=w?(f[_]||[])[k]:f[b],!v){l(m,1,0,"");continue}switch(v.t){case"n":var y=v.w;!y&&v.v!=null&&(y=v.v),y==null?v.f&&!v.F?l(m,1,0,"="+v.f):l(m,1,0,""):l(m,0,y,"V");break;case"b":l(m,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(m,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=ss(v.z||St[14],yn(Mr(v.v)))),l(m,0,v.w,"V");break;default:l(m,1,0,"")}}}l(m,-1,0,"EOD");var L=`\r
`,G=m.join(L);return G}})();return{to_workbook:n,to_sheet:e,from_sheet:s}})(),Ck=(function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(v,w){for(var _=v.split(`
`),k=-1,b=-1,y=0,L=[];y!==_.length;++y){var G=_[y].trim().split(":");if(G[0]==="cell"){var j=xn(G[1]);if(L.length<=j.r)for(k=L.length;k<=j.r;++k)L[k]||(L[k]=[]);switch(k=j.r,b=j.c,G[2]){case"t":L[k][b]=t(G[3]);break;case"v":L[k][b]=+G[3];break;case"vtf":var F=G[G.length-1];case"vtc":switch(G[3]){case"nl":L[k][b]=!!+G[4];break;default:L[k][b]=+G[4];break}G[2]=="vtf"&&(L[k][b]=[L[k][b],F])}}}return w&&w.sheetRows&&(L=L.slice(0,w.sheetRows)),L}function n(v,w){return nl(e(v,w),w)}function s(v,w){return ni(n(v,w),w)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function m(v){if(!v||!v["!ref"])return"";for(var w=[],_=[],k,b="",y=rl(v["!ref"]),L=Array.isArray(v),G=y.s.r;G<=y.e.r;++G)for(var j=y.s.c;j<=y.e.c;++j)if(b=yt({r:G,c:j}),k=L?(v[G]||[])[j]:v[b],!(!k||k.v==null||k.t==="z")){switch(_=["cell",b,"t"],k.t){case"s":case"str":_.push(r(k.v));break;case"n":k.f?(_[2]="vtf",_[3]="n",_[4]=k.v,_[5]=r(k.f)):(_[2]="v",_[3]=k.v);break;case"b":_[2]="vt"+(k.f?"f":"c"),_[3]="nl",_[4]=k.v?"1":"0",_[5]=r(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var F=yn(Mr(k.v));_[2]="vtc",_[3]="nd",_[4]=""+F,_[5]=k.w||ss(k.z||St[14],F);break;case"e":continue}w.push(_.join(":"))}return w.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),w.push("valueformat:1:text-wiki"),w.join(`
`)}function p(v){return[o,l,u,l,m(v),f].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:p}})(),gc=(function(){function t(p,v,w,_,k){k.raw?v[w][_]=p:p===""||(p==="TRUE"?v[w][_]=!0:p==="FALSE"?v[w][_]=!1:isNaN(_s(p))?isNaN(qo(p).getDate())?v[w][_]=p:v[w][_]=Mr(p):v[w][_]=_s(p))}function r(p,v){var w=v||{},_=[];if(!p||p.length===0)return _;for(var k=p.split(/[\r\n]/),b=k.length-1;b>=0&&k[b].length===0;)--b;for(var y=10,L=0,G=0;G<=b;++G)L=k[G].indexOf(" "),L==-1?L=k[G].length:L++,y=Math.max(y,L);for(G=0;G<=b;++G){_[G]=[];var j=0;for(t(k[G].slice(0,y).trim(),_,G,j,w),j=1;j<=(k[G].length-y)/10+1;++j)t(k[G].slice(y+(j-1)*10,y+j*10).trim(),_,G,j,w)}return w.sheetRows&&(_=_.slice(0,w.sheetRows)),_}var e={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(p){for(var v={},w=!1,_=0,k=0;_<p.length;++_)(k=p.charCodeAt(_))==34?w=!w:!w&&k in e&&(v[k]=(v[k]||0)+1);k=[];for(_ in v)Object.prototype.hasOwnProperty.call(v,_)&&k.push([v[_],_]);if(!k.length){v=n;for(_ in v)Object.prototype.hasOwnProperty.call(v,_)&&k.push([v[_],_])}return k.sort(function(b,y){return b[0]-y[0]||n[b[1]]-n[y[1]]}),e[k.pop()[1]]||44}function o(p,v){var w=v||{},_="",k=w.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(_=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(_=p.charAt(4),p=p.slice(6)):_=s(p.slice(0,1024)):w&&w.FS?_=w.FS:_=s(p.slice(0,1024));var y=0,L=0,G=0,j=0,F=0,ue=_.charCodeAt(0),D=!1,V=0,ee=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var T=w.dateNF!=null?$S(w.dateNF):null;function O(){var H=p.slice(j,F),U={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)U.t="z";else if(w.raw)U.t="s",U.v=H;else if(H.trim().length===0)U.t="s",U.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(U.t="s",U.v=H.slice(2,-1).replace(/""/g,'"')):mN(H)?(U.t="n",U.f=H.slice(1)):(U.t="s",U.v=H);else if(H=="TRUE")U.t="b",U.v=!0;else if(H=="FALSE")U.t="b",U.v=!1;else if(!isNaN(G=_s(H)))U.t="n",w.cellText!==!1&&(U.w=H),U.v=G;else if(!isNaN(qo(H).getDate())||T&&H.match(T)){U.z=w.dateNF||St[14];var X=0;T&&H.match(T)&&(H=US(H,w.dateNF,H.match(T)||[]),X=1),w.cellDates?(U.t="d",U.v=Mr(H,X)):(U.t="n",U.v=yn(Mr(H,X))),w.cellText!==!1&&(U.w=ss(U.z,U.v instanceof Date?yn(U.v):U.v)),w.cellNF||delete U.z}else U.t="s",U.v=H;if(U.t=="z"||(w.dense?(k[y]||(k[y]=[]),k[y][L]=U):k[yt({c:L,r:y})]=U),j=F+1,ee=p.charCodeAt(j),b.e.c<L&&(b.e.c=L),b.e.r<y&&(b.e.r=y),V==ue)++L;else if(L=0,++y,w.sheetRows&&w.sheetRows<=y)return!0}e:for(;F<p.length;++F)switch(V=p.charCodeAt(F)){case 34:ee===34&&(D=!D);break;case ue:case 10:case 13:if(!D&&O())break e;break}return F-j>0&&O(),k["!ref"]=Ot(b),k}function l(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,v):nl(r(p,v),v)}function u(p,v){var w="",_=v.type=="string"?[0,0,0,0]:Vh(p,v);switch(v.type){case"base64":w=Bn(p);break;case"binary":w=p;break;case"buffer":v.codepage==65001?w=p.toString("utf8"):v.codepage&&typeof dc<"u"||(w=Rt&&Buffer.isBuffer(p)?p.toString("binary"):Hi(p));break;case"array":w=$i(p);break;case"string":w=p;break;default:throw new Error("Unrecognized type "+v.type)}return _[0]==239&&_[1]==187&&_[2]==191?w=Yt(w.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?w=Yt(w):v.type=="binary"&&typeof dc<"u",w.slice(0,19)=="socialcalc:version:"?Ck.to_sheet(v.type=="string"?w:Yt(w),v):l(w,v)}function f(p,v){return ni(u(p,v),v)}function m(p){for(var v=[],w=cr(p["!ref"]),_,k=Array.isArray(p),b=w.s.r;b<=w.e.r;++b){for(var y=[],L=w.s.c;L<=w.e.c;++L){var G=yt({r:b,c:L});if(_=k?(p[b]||[])[L]:p[G],!_||_.v==null){y.push("          ");continue}for(var j=(_.w||(ma(_),_.w)||"").slice(0,10);j.length<10;)j+=" ";y.push(j+(L===0?" ":""))}v.push(y.join(""))}return v.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:m}})();function jk(t,r){var e=r||{},n=!!e.WTF;e.WTF=!0;try{var s=Tk.to_workbook(t,e);return e.WTF=n,s}catch(o){if(e.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return gc.to_workbook(t,r)}}var ac=(function(){function t(N,B,q){if(N){Hr(N,N.l||0);for(var ne=q.Enum||oe;N.l<N.length;){var pe=N.read_shift(2),te=ne[pe]||ne[65535],fe=N.read_shift(2),I=N.l+fe,le=te.f&&te.f(N,fe,q);if(N.l=I,B(le,te,pe))return}}}function r(N,B){switch(B.type){case"base64":return e(ys(Bn(N)),B);case"binary":return e(ys(N),B);case"buffer":case"array":return e(N,B)}throw"Unsupported type "+B.type}function e(N,B){if(!N)return N;var q=B||{},ne=q.dense?[]:{},pe="Sheet1",te="",fe=0,I={},le=[],se=[],z={s:{r:0,c:0},e:{r:0,c:0}},Ie=q.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)q.Enum=oe,t(N,function(Ve,Ee,Le){switch(Le){case 0:q.vers=Ve,Ve>=4096&&(q.qpro=!0);break;case 6:z=Ve;break;case 204:Ve&&(te=Ve);break;case 222:te=Ve;break;case 15:case 51:q.qpro||(Ve[1].v=Ve[1].v.slice(1));case 13:case 14:case 16:Le==14&&(Ve[2]&112)==112&&(Ve[2]&15)>1&&(Ve[2]&15)<15&&(Ve[1].z=q.dateNF||St[14],q.cellDates&&(Ve[1].t="d",Ve[1].v=kd(Ve[1].v))),q.qpro&&Ve[3]>fe&&(ne["!ref"]=Ot(z),I[pe]=ne,le.push(pe),ne=q.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},fe=Ve[3],pe=te||"Sheet"+(fe+1),te="");var Me=q.dense?(ne[Ve[0].r]||[])[Ve[0].c]:ne[yt(Ve[0])];if(Me){Me.t=Ve[1].t,Me.v=Ve[1].v,Ve[1].z!=null&&(Me.z=Ve[1].z),Ve[1].f!=null&&(Me.f=Ve[1].f);break}q.dense?(ne[Ve[0].r]||(ne[Ve[0].r]=[]),ne[Ve[0].r][Ve[0].c]=Ve[1]):ne[yt(Ve[0])]=Ve[1];break}},q);else if(N[2]==26||N[2]==14)q.Enum=A,N[2]==14&&(q.qpro=!0,N.l=0),t(N,function(Ve,Ee,Le){switch(Le){case 204:pe=Ve;break;case 22:Ve[1].v=Ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ve[3]>fe&&(ne["!ref"]=Ot(z),I[pe]=ne,le.push(pe),ne=q.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},fe=Ve[3],pe="Sheet"+(fe+1)),Ie>0&&Ve[0].r>=Ie)break;q.dense?(ne[Ve[0].r]||(ne[Ve[0].r]=[]),ne[Ve[0].r][Ve[0].c]=Ve[1]):ne[yt(Ve[0])]=Ve[1],z.e.c<Ve[0].c&&(z.e.c=Ve[0].c),z.e.r<Ve[0].r&&(z.e.r=Ve[0].r);break;case 27:Ve[14e3]&&(se[Ve[14e3][0]]=Ve[14e3][1]);break;case 1537:se[Ve[0]]=Ve[1],Ve[0]==fe&&(pe=Ve[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(ne["!ref"]=Ot(z),I[te||pe]=ne,le.push(te||pe),!se.length)return{SheetNames:le,Sheets:I};for(var Fe={},Ye=[],tt=0;tt<se.length;++tt)I[le[tt]]?(Ye.push(se[tt]||le[tt]),Fe[se[tt]]=I[se[tt]]||I[le[tt]]):(Ye.push(se[tt]),Fe[se[tt]]={"!ref":"A1"});return{SheetNames:Ye,Sheets:Fe}}function n(N,B){var q=B||{};if(+q.codepage>=0&&ws(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var ne=qf(),pe=cr(N["!ref"]),te=Array.isArray(N),fe=[];ps(ne,0,o(1030)),ps(ne,6,f(pe));for(var I=Math.min(pe.e.r,8191),le=pe.s.r;le<=I;++le)for(var se=Gr(le),z=pe.s.c;z<=pe.e.c;++z){le===pe.s.r&&(fe[z]=jr(z));var Ie=fe[z]+se,Fe=te?(N[le]||[])[z]:N[Ie];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")(Fe.v|0)==Fe.v&&Fe.v>=-32768&&Fe.v<=32767?ps(ne,13,_(le,z,Fe.v)):ps(ne,14,b(le,z,Fe.v));else{var Ye=ma(Fe);ps(ne,15,v(le,z,Ye.slice(0,239)))}}return ps(ne,1),ne.end()}function s(N,B){var q=B||{};if(+q.codepage>=0&&ws(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var ne=qf();ps(ne,0,l(N));for(var pe=0,te=0;pe<N.SheetNames.length;++pe)(N.Sheets[N.SheetNames[pe]]||{})["!ref"]&&ps(ne,27,K(N.SheetNames[pe],te++));var fe=0;for(pe=0;pe<N.SheetNames.length;++pe){var I=N.Sheets[N.SheetNames[pe]];if(!(!I||!I["!ref"])){for(var le=cr(I["!ref"]),se=Array.isArray(I),z=[],Ie=Math.min(le.e.r,8191),Fe=le.s.r;Fe<=Ie;++Fe)for(var Ye=Gr(Fe),tt=le.s.c;tt<=le.e.c;++tt){Fe===le.s.r&&(z[tt]=jr(tt));var Ve=z[tt]+Ye,Ee=se?(I[Fe]||[])[tt]:I[Ve];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")ps(ne,23,O(Fe,tt,fe,Ee.v));else{var Le=ma(Ee);ps(ne,22,V(Fe,tt,fe,Le.slice(0,239)))}}++fe}}return ps(ne,1),ne.end()}function o(N){var B=Cr(2);return B.write_shift(2,N),B}function l(N){var B=Cr(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var q=0,ne=0,pe=0,te=0;te<N.SheetNames.length;++te){var fe=N.SheetNames[te],I=N.Sheets[fe];if(!(!I||!I["!ref"])){++pe;var le=rl(I["!ref"]);q<le.e.r&&(q=le.e.r),ne<le.e.c&&(ne=le.e.c)}}return q>8191&&(q=8191),B.write_shift(2,q),B.write_shift(1,pe),B.write_shift(1,ne),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function u(N,B,q){var ne={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&q.qpro?(ne.s.c=N.read_shift(1),N.l++,ne.s.r=N.read_shift(2),ne.e.c=N.read_shift(1),N.l++,ne.e.r=N.read_shift(2),ne):(ne.s.c=N.read_shift(2),ne.s.r=N.read_shift(2),B==12&&q.qpro&&(N.l+=2),ne.e.c=N.read_shift(2),ne.e.r=N.read_shift(2),B==12&&q.qpro&&(N.l+=2),ne.s.c==65535&&(ne.s.c=ne.e.c=ne.s.r=ne.e.r=0),ne)}function f(N){var B=Cr(8);return B.write_shift(2,N.s.c),B.write_shift(2,N.s.r),B.write_shift(2,N.e.c),B.write_shift(2,N.e.r),B}function m(N,B,q){var ne=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(ne[0].c=N.read_shift(1),ne[3]=N.read_shift(1),ne[0].r=N.read_shift(2),N.l+=2):(ne[2]=N.read_shift(1),ne[0].c=N.read_shift(2),ne[0].r=N.read_shift(2)),ne}function p(N,B,q){var ne=N.l+B,pe=m(N,B,q);if(pe[1].t="s",q.vers==20768){N.l++;var te=N.read_shift(1);return pe[1].v=N.read_shift(te,"utf8"),pe}return q.qpro&&N.l++,pe[1].v=N.read_shift(ne-N.l,"cstr"),pe}function v(N,B,q){var ne=Cr(7+q.length);ne.write_shift(1,255),ne.write_shift(2,B),ne.write_shift(2,N),ne.write_shift(1,39);for(var pe=0;pe<ne.length;++pe){var te=q.charCodeAt(pe);ne.write_shift(1,te>=128?95:te)}return ne.write_shift(1,0),ne}function w(N,B,q){var ne=m(N,B,q);return ne[1].v=N.read_shift(2,"i"),ne}function _(N,B,q){var ne=Cr(7);return ne.write_shift(1,255),ne.write_shift(2,B),ne.write_shift(2,N),ne.write_shift(2,q,"i"),ne}function k(N,B,q){var ne=m(N,B,q);return ne[1].v=N.read_shift(8,"f"),ne}function b(N,B,q){var ne=Cr(13);return ne.write_shift(1,255),ne.write_shift(2,B),ne.write_shift(2,N),ne.write_shift(8,q,"f"),ne}function y(N,B,q){var ne=N.l+B,pe=m(N,B,q);if(pe[1].v=N.read_shift(8,"f"),q.qpro)N.l=ne;else{var te=N.read_shift(2);F(N.slice(N.l,N.l+te),pe),N.l+=te}return pe}function L(N,B,q){var ne=B&32768;return B&=-32769,B=(ne?N:0)+(B>=8192?B-16384:B),(ne?"":"$")+(q?jr(B):Gr(B))}var G={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},j=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(N,B){Hr(N,0);for(var q=[],ne=0,pe="",te="",fe="",I="";N.l<N.length;){var le=N[N.l++];switch(le){case 0:q.push(N.read_shift(8,"f"));break;case 1:te=L(B[0].c,N.read_shift(2),!0),pe=L(B[0].r,N.read_shift(2),!1),q.push(te+pe);break;case 2:{var se=L(B[0].c,N.read_shift(2),!0),z=L(B[0].r,N.read_shift(2),!1);te=L(B[0].c,N.read_shift(2),!0),pe=L(B[0].r,N.read_shift(2),!1),q.push(se+z+":"+te+pe)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(N.read_shift(2));break;case 6:{for(var Ie="";le=N[N.l++];)Ie+=String.fromCharCode(le);q.push('"'+Ie.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:I=q.pop(),fe=q.pop(),q.push(["AND","OR"][le-20]+"("+fe+","+I+")");break;default:if(le<32&&j[le])I=q.pop(),fe=q.pop(),q.push(fe+j[le]+I);else if(G[le]){if(ne=G[le][1],ne==69&&(ne=N[N.l++]),ne>q.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+q.join("|")+"|");return}var Fe=q.slice(-ne);q.length-=ne,q.push(G[le][0]+"("+Fe.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}q.length==1?B[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function ue(N){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=N.read_shift(2),B[3]=N[N.l++],B[0].c=N[N.l++],B}function D(N,B){var q=ue(N);return q[1].t="s",q[1].v=N.read_shift(B-4,"cstr"),q}function V(N,B,q,ne){var pe=Cr(6+ne.length);pe.write_shift(2,N),pe.write_shift(1,q),pe.write_shift(1,B),pe.write_shift(1,39);for(var te=0;te<ne.length;++te){var fe=ne.charCodeAt(te);pe.write_shift(1,fe>=128?95:fe)}return pe.write_shift(1,0),pe}function ee(N,B){var q=ue(N);q[1].v=N.read_shift(2);var ne=q[1].v>>1;if(q[1].v&1)switch(ne&7){case 0:ne=(ne>>3)*5e3;break;case 1:ne=(ne>>3)*500;break;case 2:ne=(ne>>3)/20;break;case 3:ne=(ne>>3)/200;break;case 4:ne=(ne>>3)/2e3;break;case 5:ne=(ne>>3)/2e4;break;case 6:ne=(ne>>3)/16;break;case 7:ne=(ne>>3)/64;break}return q[1].v=ne,q}function T(N,B){var q=ue(N),ne=N.read_shift(4),pe=N.read_shift(4),te=N.read_shift(2);if(te==65535)return ne===0&&pe===3221225472?(q[1].t="e",q[1].v=15):ne===0&&pe===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var fe=te&32768;return te=(te&32767)-16446,q[1].v=(1-fe*2)*(pe*Math.pow(2,te+32)+ne*Math.pow(2,te)),q}function O(N,B,q,ne){var pe=Cr(14);if(pe.write_shift(2,N),pe.write_shift(1,q),pe.write_shift(1,B),ne==0)return pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(2,65535),pe;var te=0,fe=0,I=0,le=0;return ne<0&&(te=1,ne=-ne),fe=Math.log2(ne)|0,ne/=Math.pow(2,fe-31),le=ne>>>0,(le&2147483648)==0&&(ne/=2,++fe,le=ne>>>0),ne-=le,le|=2147483648,le>>>=0,ne*=Math.pow(2,32),I=ne>>>0,pe.write_shift(4,I),pe.write_shift(4,le),fe+=16383+(te?32768:0),pe.write_shift(2,fe),pe}function H(N,B){var q=T(N);return N.l+=B-14,q}function U(N,B){var q=ue(N),ne=N.read_shift(4);return q[1].v=ne>>6,q}function X(N,B){var q=ue(N),ne=N.read_shift(8,"f");return q[1].v=ne,q}function ve(N,B){var q=X(N);return N.l+=B-10,q}function we(N,B){return N[N.l+B-1]==0?N.read_shift(B,"cstr"):""}function Ne(N,B){var q=N[N.l++];q>B-1&&(q=B-1);for(var ne="";ne.length<q;)ne+=String.fromCharCode(N[N.l++]);return ne}function he(N,B,q){if(!(!q.qpro||B<21)){var ne=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var pe=N.read_shift(B-21,"cstr");return[ne,pe]}}function ae(N,B){for(var q={},ne=N.l+B;N.l<ne;){var pe=N.read_shift(2);if(pe==14e3){for(q[pe]=[0,""],q[pe][0]=N.read_shift(2);N[N.l];)q[pe][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return q}function K(N,B){var q=Cr(5+N.length);q.write_shift(2,14e3),q.write_shift(2,B);for(var ne=0;ne<N.length;++ne){var pe=N.charCodeAt(ne);q[q.l++]=pe>127?95:pe}return q[q.l++]=0,q}var oe={0:{n:"BOF",f:yr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:w},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:we},222:{n:"SHEETNAMELP",f:Ne},65535:{n:""}},A={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:ee},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:X},40:{n:"FORMULA28",f:ve},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:we},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:he},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:r}})();function Ak(t){var r={},e=t.match(on),n=0,s=!1;if(e)for(;n!=e.length;++n){var o=ht(e[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;r.cp=vh[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=o.val;break;case"<sz":r.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":o.rgb&&(r.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(o[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+o[0])}}return r}var Rk=(function(){var t=hc("t"),r=hc("rPr");function e(o){var l=o.match(t);if(!l)return{t:"s",v:""};var u={t:"s",v:Lt(l[1])},f=o.match(r);return f&&(u.s=Ak(f[1])),u}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(s).map(e).filter(function(u){return u.v})}})(),Ik=(function(){var r=/(\r\n|\n)/g;function e(s,o,l){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),s.b&&(o.push("<b>"),l.push("</b>")),s.i&&(o.push("<i>"),l.push("</i>")),s.strike&&(o.push("<s>"),l.push("</s>"));var f=s.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(o.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),s}function n(s){var o=[[],s.v,[]];return s.v?(s.s&&e(s.s,o[0],o[2]),o[0].join("")+o[1].replace(r,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}})(),Ok=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Dk=/<(?:\w+:)?r>/,Fk=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Fh(t,r){var e=r?r.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Lt(Yt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Yt(t),e&&(n.h=kh(n.t))):t.match(Dk)&&(n.r=Yt(t),n.t=Lt(Yt((t.replace(Fk,"").match(Ok)||[]).join("").replace(on,""))),e&&(n.h=Ik(Rk(n.r)))),n):{t:""}}var Pk=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Lk=/<(?:\w+:)?(?:si|sstItem)>/g,Mk=/<\/(?:\w+:)?(?:si|sstItem)>/;function $k(t,r){var e=[],n="";if(!t)return e;var s=t.match(Pk);if(s){n=s[2].replace(Lk,"").split(Mk);for(var o=0;o!=n.length;++o){var l=Fh(n[o].trim(),r);l!=null&&(e[e.length]=l)}s=ht(s[1]),e.Count=s.count,e.Unique=s.uniqueCount}return e}function Uk(t){return[t.read_shift(4),t.read_shift(4)]}function Bk(t,r){var e=[],n=!1;return pa(t,function(o,l,u){switch(u){case 159:e.Count=o[0],e.Unique=o[1];break;case 19:e.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),e}function t1(t){for(var r=[],e=t.split(""),n=0;n<e.length;++n)r[n]=e[n].charCodeAt(0);return r}function fa(t,r){var e={};return e.Major=t.read_shift(2),e.Minor=t.read_shift(2),r>=4&&(t.l+=r-4),e}function Vk(t){var r={};return r.id=t.read_shift(0,"lpp4"),r.R=fa(t,4),r.U=fa(t,4),r.W=fa(t,4),r}function Wk(t){for(var r=t.read_shift(4),e=t.l+r-4,n={},s=t.read_shift(4),o=[];s-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=e)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+e);return n}function Hk(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(Wk(t));return r}function zk(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(t.read_shift(0,"lpp4"));return r}function Gk(t){var r={};return t.read_shift(4),t.l+=4,r.id=t.read_shift(0,"lpp4"),r.name=t.read_shift(0,"lpp4"),r.R=fa(t,4),r.U=fa(t,4),r.W=fa(t,4),r}function Kk(t){var r=Gk(t);if(r.ename=t.read_shift(0,"8lpp4"),r.blksz=t.read_shift(4),r.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function r1(t,r){var e=t.l+r,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(e-t.l>>1,"utf16le"),t.l=e,n}function n1(t,r){var e={},n=t.l+r;return t.l+=4,e.Salt=t.slice(t.l,t.l+16),t.l+=16,e.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),e.VerifierHash=t.slice(t.l,n),t.l=n,e}function Xk(t){var r=fa(t);switch(r.Minor){case 2:return[r.Minor,qk(t)];case 3:return[r.Minor,Jk()];case 4:return[r.Minor,Yk(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function qk(t){var r=t.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4),n=r1(t,e),s=n1(t,t.length-t.l);return{t:"Std",h:n,v:s}}function Jk(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Yk(t){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var e=t.read_shift(t.length-t.l,"utf8"),n={};return e.replace(on,function(o){var l=ht(o);switch(Bs(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function Qk(t,r){var e={},n=e.EncryptionVersionInfo=fa(t,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);e.Flags=t.read_shift(4),r-=4;var s=t.read_shift(4);return r-=4,e.EncryptionHeader=r1(t,s),r-=s,e.EncryptionVerifier=n1(t,r),e}function Zk(t){var r={},e=r.EncryptionVersionInfo=fa(t,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return r.Salt=t.read_shift(16),r.EncryptedVerifier=t.read_shift(16),r.EncryptedVerifierHash=t.read_shift(16),r}function eT(t){var r=0,e,n=t1(t),s=n.length+1,o,l,u,f,m;for(e=Za(s),e[0]=n.length,o=1;o!=s;++o)e[o]=n[o-1];for(o=s-1;o>=0;--o)l=e[o],u=(r&16384)===0?0:1,f=r<<1&32767,m=u|f,r=m^l;return r^52811}var s1=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},s=function(l,u){return n(l^u)},o=function(l){for(var u=r[l.length-1],f=104,m=l.length-1;m>=0;--m)for(var p=l[m],v=0;v!=7;++v)p&64&&(u^=e[f]),p*=2,--f;return u};return function(l){for(var u=t1(l),f=o(u),m=u.length,p=Za(16),v=0;v!=16;++v)p[v]=0;var w,_,k;for((m&1)===1&&(w=f>>8,p[m]=s(t[0],w),--m,w=f&255,_=u[u.length-1],p[m]=s(_,w));m>0;)--m,w=f>>8,p[m]=s(u[m],w),--m,w=f&255,p[m]=s(u[m],w);for(m=15,k=15-u.length;k>0;)w=f>>8,p[m]=s(t[k],w),--m,--k,w=f&255,p[m]=s(u[m],w),--m,--k;return p}})(),tT=function(t,r,e,n,s){s||(s=r),n||(n=s1(t));var o,l;for(o=0;o!=r.length;++o)l=r[o],l^=n[e],l=(l>>5|l<<3)&255,s[o]=l,++e;return[s,e,n]},rT=function(t){var r=0,e=s1(t);return function(n){var s=tT("",n,r,e);return r=s[1],s[0]}};function nT(t,r,e,n){var s={key:yr(t),verificationBytes:yr(t)};return e.password&&(s.verifier=eT(e.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=rT(e.password)),s}function sT(t,r,e){var n=e||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=Zk(t):n.Data=Qk(t,r),n}function aT(t,r,e){var n={Type:e.biff>=8?t.read_shift(2):0};return n.Type?sT(t,r-2,n):nT(t,e.biff>=8?r:r-2,e,n),n}var iT=(function(){function t(s,o){switch(o.type){case"base64":return r(Bn(s),o);case"binary":return r(s,o);case"buffer":return r(Rt&&Buffer.isBuffer(s)?s.toString("binary"):Hi(s),o);case"array":return r($i(s),o)}throw new Error("Unrecognized type "+o.type)}function r(s,o){var l=o||{},u=l.dense?[]:{},f=s.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,v){Array.isArray(u)&&(u[v]=[]);for(var w=/\\\w+\b/g,_=0,k,b=-1;k=w.exec(p);){switch(k[0]){case"\\cell":var y=p.slice(_,w.lastIndex-k[0].length);if(y[0]==" "&&(y=y.slice(1)),++b,y.length){var L={v:y,t:"s"};Array.isArray(u)?u[v][b]=L:u[yt({r:v,c:b})]=L}break}_=w.lastIndex}b>m.e.c&&(m.e.c=b)}),u["!ref"]=Ot(m),u}function e(s,o){return ni(t(s,o),o)}function n(s){for(var o=["{\\rtf1\\ansi"],l=cr(s["!ref"]),u,f=Array.isArray(s),m=l.s.r;m<=l.e.r;++m){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var v=yt({r:m,c:p});u=f?(s[m]||[])[p]:s[v],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(ma(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:n}})();function oT(t){var r=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function pc(t){for(var r=0,e=1;r!=3;++r)e=e*256+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}function lT(t){var r=t[0]/255,e=t[1]/255,n=t[2]/255,s=Math.max(r,e,n),o=Math.min(r,e,n),l=s-o;if(l===0)return[0,0,r];var u=0,f=0,m=s+o;switch(f=l/(m>1?2-m:m),s){case r:u=((e-n)/l+6)%6;break;case e:u=(n-r)/l+2;break;case n:u=(r-e)/l+4;break}return[u/6,f,m/2]}function cT(t){var r=t[0],e=t[1],n=t[2],s=e*2*(n<.5?n:1-n),o=n-s/2,l=[o,o,o],u=6*r,f;if(e!==0)switch(u|0){case 0:case 6:f=s*u,l[0]+=s,l[1]+=f;break;case 1:f=s*(2-u),l[0]+=f,l[1]+=s;break;case 2:f=s*(u-2),l[1]+=s,l[2]+=f;break;case 3:f=s*(4-u),l[1]+=f,l[2]+=s;break;case 4:f=s*(u-4),l[2]+=s,l[0]+=f;break;case 5:f=s*(6-u),l[2]+=f,l[0]+=s;break}for(var m=0;m!=3;++m)l[m]=Math.round(l[m]*255);return l}function pd(t,r){if(r===0)return t;var e=lT(oT(t));return r<0?e[2]=e[2]*(1+r):e[2]=1-(1-e[2])*(1-r),pc(cT(e))}var a1=6,uT=15,dT=1,pn=a1;function xd(t){return Math.floor((t+Math.round(128/pn)/256)*pn)}function vd(t){return Math.floor((t-5)/pn*100+.5)/100}function Zf(t){return Math.round((t*pn+5)/pn*256)/256}function Cf(t){return Zf(vd(xd(t)))}function Ph(t){var r=Math.abs(t-Cf(t)),e=pn;if(r>.005)for(pn=dT;pn<uT;++pn)Math.abs(t-Cf(t))<=r&&(r=Math.abs(t-Cf(t)),e=pn);pn=e}function Jo(t){t.width?(t.wpx=xd(t.width),t.wch=vd(t.wpx),t.MDW=pn):t.wpx?(t.wch=vd(t.wpx),t.width=Zf(t.wch),t.MDW=pn):typeof t.wch=="number"&&(t.width=Zf(t.wch),t.wpx=xd(t.width),t.MDW=pn),t.customWidth&&delete t.customWidth}var fT=96,i1=fT;function o1(t){return t*96/i1}function xc(t){return t*i1/96}var hT={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function mT(t,r,e,n){r.Borders=[];var s={},o=!1;(t[0].match(on)||[]).forEach(function(l){var u=ht(l);switch(Bs(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=er(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=er(u.diagonalDown)),r.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function gT(t,r,e,n){r.Fills=[];var s={},o=!1;(t[0].match(on)||[]).forEach(function(l){var u=ht(l);switch(Bs(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},r.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function pT(t,r,e,n){r.Fonts=[];var s={},o=!1;(t[0].match(on)||[]).forEach(function(l){var u=ht(l);switch(Bs(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=Yt(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?er(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?er(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?er(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?er(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?er(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?er(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?er(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=vh[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=er(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var f=Li[s.color.index];s.color.index==81&&(f=Li[1]),f||(f=Li[1]),s.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&e.themeElements&&e.themeElements.clrScheme&&(s.color.rgb=pd(e.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function xT(t,r,e){r.NumberFmt=[];for(var n=$s(St),s=0;s<n.length;++s)r.NumberFmt[n[s]]=St[n[s]];var o=t[0].match(on);if(o)for(s=0;s<o.length;++s){var l=ht(o[s]);switch(Bs(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Lt(Yt(l.formatCode)),f=parseInt(l.numFmtId,10);if(r.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&r.NumberFmt[f]!=null;--f);r.NumberFmt[f]=u}Pi(u,f)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var Zu=["numFmtId","fillId","fontId","borderId","xfId"],ed=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function vT(t,r,e){r.CellXf=[];var n,s=!1;(t[0].match(on)||[]).forEach(function(o){var l=ht(o),u=0;switch(Bs(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<Zu.length;++u)n[Zu[u]]&&(n[Zu[u]]=parseInt(n[Zu[u]],10));for(u=0;u<ed.length;++u)n[ed[u]]&&(n[ed[u]]=er(n[ed[u]]));if(r.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[u]){n.numFmtId=u;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=er(l.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(e&&e.WTF&&!s)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var yT=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,m){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(r))&&xT(v,p,m),(v=u.match(s))&&pT(v,p,f,m),(v=u.match(n))&&gT(v,p,f,m),(v=u.match(o))&&mT(v,p,f,m),(v=u.match(e))&&vT(v,p,m),p}})();function wT(t,r){var e=t.read_shift(2),n=nn(t);return[e,n]}function bT(t,r,e){var n={};n.sz=t.read_shift(2)/20;var s=R2(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(n.underline=l);var u=t.read_shift(1);u>0&&(n.family=u);var f=t.read_shift(1);switch(f>0&&(n.charset=f),t.l++,n.color=A2(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=nn(t),n}var _T=sn;function ST(t,r){var e=t.l+r,n=t.read_shift(2),s=t.read_shift(2);return t.l=e,{ixfe:n,numFmtId:s}}var ET=sn;function kT(t,r,e){var n={};n.NumberFmt=[];for(var s in St)n.NumberFmt[s]=St[s];n.CellXf=[],n.Fonts=[];var o=[],l=!1;return pa(t,function(f,m,p){switch(p){case 44:n.NumberFmt[f[0]]=f[1],Pi(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(f.color.rgb=pd(r.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p),l=!0;break;case 38:o.pop(),l=!1;break;default:if(m.T>0)o.push(p);else if(m.T<0)o.pop();else if(!l||e.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}var TT=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function NT(t,r,e){r.themeElements.clrScheme=[];var n={};(t[0].match(on)||[]).forEach(function(s){var o=ht(s);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(r.themeElements.clrScheme[TT.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function CT(){}function jT(){}var AT=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,RT=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,IT=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function OT(t,r,e){r.themeElements={};var n;[["clrScheme",AT,NT],["fontScheme",RT,CT],["fmtScheme",IT,jT]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,r,e)})}var DT=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function l1(t,r){(!t||t.length===0)&&(t=FT());var e,n={};if(!(e=t.match(DT)))throw new Error("themeElements not found in theme");return OT(e[0],n,r),n.raw=t,n}function FT(t,r){var e=[yv];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function PT(t,r,e){var n=t.l+r,s=t.read_shift(4);if(s!==124226){if(!e.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var l;try{l=vv(o,{type:"array"})}catch{return}var u=Un(l,"theme/theme/theme1.xml",!0);if(u)return l1(u,e)}}function LT(t){return t.read_shift(4)}function MT(t){var r={};switch(r.xclrType=t.read_shift(2),r.nTintShade=t.read_shift(2),r.xclrType){case 0:t.l+=4;break;case 1:r.xclrValue=$T(t,4);break;case 2:r.xclrValue=Xv(t);break;case 3:r.xclrValue=LT(t);break;case 4:t.l+=4;break}return t.l+=8,r}function $T(t,r){return sn(t,r)}function UT(t,r){return sn(t,r)}function BT(t){var r=t.read_shift(2),e=t.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=MT(t);break;case 6:n[1]=UT(t,e);break;case 14:case 15:n[1]=t.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+e)}return n}function VT(t,r){var e=t.l+r;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),o=[];s-- >0;)o.push(BT(t,e-t.l));return{ixfe:n,ext:o}}function WT(t,r){r.forEach(function(e){e[0]})}function HT(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:nn(t)}}function zT(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function GT(t){return t.l+=4,t.read_shift(4)!=0}function KT(t,r,e){var n={Types:[],Cell:[],Value:[]},s=e||{},o=[],l=!1,u=2;return pa(t,function(f,m,p){switch(p){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(v){u==1?n.Cell.push({type:n.Types[v[0]-1].name,index:v[1]}):u==0&&n.Value.push({type:n.Types[v[0]-1].name,index:v[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:o.push(p),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!m.T){if(!l||s.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function XT(t,r,e){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,o=2,l;return t.replace(on,function(u){var f=ht(u);switch(Bs(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<n.Types.length;++m)n.Types[m].name==f.name&&(l=n.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):o==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!s&&e.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),n}function qT(t){var r=[];if(!t)return r;var e=1;return(t.match(on)||[]).forEach(function(n){var s=ht(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?e=s.i:s.i=e,r.push(s);break}}),r}function JT(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=yt(e);var n=t.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function YT(t,r,e){var n=[];return pa(t,function(o,l,u){switch(u){case 63:n.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function QT(t,r,e,n){if(!t)return t;var s=n||{},o=!1;pa(t,function(u,f,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!f.T){if(!o||s.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},s)}function ZT(t,r){if(!t)return"??";var e=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][e].Target}function Yp(t,r,e,n){var s=Array.isArray(t),o;r.forEach(function(l){var u=xn(l.ref);if(s?(t[u.r]||(t[u.r]=[]),o=t[u.r][u.c]):o=t[l.ref],!o){o={t:"z"},s?t[u.r][u.c]=o:t[l.ref]=o;var f=cr(t["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var m=Ot(f);m!==t["!ref"]&&(t["!ref"]=m)}o.c||(o.c=[]);var p={a:l.author,t:l.t,r:l.r,T:e};l.h&&(p.h=l.h);for(var v=o.c.length-1;v>=0;--v){if(!e&&o.c[v].T)return;e&&!o.c[v].T&&o.c.splice(v,1)}if(e&&n){for(v=0;v<n.length;++v)if(p.a==n[v].id){p.a=n[v].name||p.a;break}}o.c.push(p)})}function eN(t,r){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&e.push(u[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=ht(u[0]),m={author:f.authorId&&e[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},p=xn(f.ref);if(!(r.sheetRows&&r.sheetRows<=p.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),w=!!v&&!!v[1]&&Fh(v[1])||{r:"",t:"",h:""};m.r=w.r,w.r=="<t></t>"&&(w.t=w.h=""),m.t=(w.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(m.h=w.h),n.push(m)}}}}),n}function tN(t,r){var e=[],n=!1,s={},o=0;return t.replace(on,function(u,f){var m=ht(u);switch(Bs(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":s.t!=null&&e.push(s);break;case"<text>":case"<text":o=f+u.length;break;case"</text>":s.t=t.slice(o,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return u}),e}function rN(t,r){var e=[],n=!1;return t.replace(on,function(o){var l=ht(o);switch(Bs(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),e}function nN(t){var r={};r.iauthor=t.read_shift(4);var e=Gi(t);return r.rfx=e.s,r.ref=yt(e.s),t.l+=16,r}var sN=nn;function aN(t,r){var e=[],n=[],s={},o=!1;return pa(t,function(u,f,m){switch(m){case 632:n.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,r.sheetRows&&s.rfx&&r.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,e.push(s);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!o||r.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),e}var iN="application/vnd.ms-office.vbaProject";function oN(t){var r=It.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(e,n){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var s=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");It.utils.cfb_add(r,s,t.FileIndex[n].content)}}),It.write(r)}function lN(){return{"!type":"dialog"}}function cN(){return{"!type":"dialog"}}function uN(){return{"!type":"macro"}}function dN(){return{"!type":"macro"}}var Go=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(n,s,o,l){var u=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var m=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return u?p+=r.c:--p,f?m+=r.r:--m,s+(u?"":"$")+jr(p)+(f?"":"$")+Gr(m)}return function(s,o){return r=o,s.replace(t,e)}})(),c1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,fN=(function(){return function(r,e){return r.replace(c1,function(n,s,o,l,u,f){var m=jh(l)-(o?0:e.c),p=Ch(f)-(u?0:e.r),v=p==0?"":u?p+1:"["+p+"]",w=m==0?"":o?m+1:"["+m+"]";return s+"R"+v+"C"+w})}})();function u1(t,r){return t.replace(c1,function(e,n,s,o,l,u){return n+(s=="$"?s+o:jr(jh(o)+r.c))+(l=="$"?l+u:Gr(Ch(u)+r.r))})}function hN(t,r,e){var n=rl(r),s=n.s,o=xn(e),l={r:o.r-s.r,c:o.c-s.c};return u1(t,l)}function mN(t){return t.length!=1}function Qp(t){return t.replace(/_xlfn\./g,"")}function xr(t){t.l+=1}function ei(t,r){var e=t.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function d1(t,r,e){var n=2;if(e){if(e.biff>=2&&e.biff<=5)return f1(t);e.biff==12&&(n=4)}var s=t.read_shift(n),o=t.read_shift(n),l=ei(t),u=ei(t);return{s:{r:s,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function f1(t){var r=ei(t),e=ei(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:e[0],c:s,cRel:e[1],rRel:e[2]}}}function gN(t,r,e){if(e.biff<8)return f1(t);var n=t.read_shift(e.biff==12?4:2),s=t.read_shift(e.biff==12?4:2),o=ei(t),l=ei(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function h1(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return pN(t);var n=t.read_shift(e&&e.biff==12?4:2),s=ei(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function pN(t){var r=ei(t),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}function xN(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function vN(t,r,e){var n=e&&e.biff?e.biff:8;if(n>=2&&n<=5)return yN(t);var s=t.read_shift(n>=12?4:2),o=t.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;s>524287;)s-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:s,c:o,cRel:l,rRel:u}}function yN(t){var r=t.read_shift(2),e=t.read_shift(1),n=(r&32768)>>15,s=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),s==1&&e>=128&&(e=e-256),{r,c:e,cRel:s,rRel:n}}function wN(t,r,e){var n=(t[t.l++]&96)>>5,s=d1(t,e.biff>=2&&e.biff<=5?6:8,e);return[n,s]}function bN(t,r,e){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var l=d1(t,o,e);return[n,s,l]}function _N(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[n]}function SN(t,r,e){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,s]}function EN(t,r,e){var n=(t[t.l++]&96)>>5,s=gN(t,r-1,e);return[n,s]}function kN(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[n]}function Zp(t){var r=t[t.l+1]&1,e=1;return t.l+=4,[r,e]}function TN(t,r,e){t.l+=2;for(var n=t.read_shift(e&&e.biff==2?1:2),s=[],o=0;o<=n;++o)s.push(t.read_shift(e&&e.biff==2?1:2));return s}function NN(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function CN(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function jN(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function AN(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[n]}function m1(t){var r=t.read_shift(1),e=t.read_shift(1);return[r,e]}function RN(t){return t.read_shift(2),m1(t)}function IN(t){return t.read_shift(2),m1(t)}function ON(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var s=h1(t,0,e);return[n,s]}function DN(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var s=vN(t,0,e);return[n,s]}function FN(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var o=h1(t,0,e);return[n,s,o]}function PN(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(e&&e.biff<=3?1:2);return[LC[s],x1[s],n]}function LN(t,r,e){var n=t[t.l++],s=t.read_shift(1),o=e&&e.biff<=3?[n==88?-1:0,t.read_shift(1)]:MN(t);return[s,(o[0]===0?x1:PC)[o[1]]]}function MN(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function $N(t,r,e){t.l+=e&&e.biff==2?3:4}function UN(t,r,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(e&&e.biff==2?1:2);return[n,s]}function BN(t){return t.l++,Ki[t.read_shift(1)]}function VN(t){return t.l++,t.read_shift(2)}function WN(t){return t.l++,t.read_shift(1)!==0}function HN(t){return t.l++,tn(t)}function zN(t,r,e){return t.l++,kc(t,r-1,e)}function GN(t,r){var e=[t.read_shift(1)];if(r==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=mr(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:e[1]=Ki[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=tn(t);break;case 2:e[1]=Xi(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function KN(t,r,e){for(var n=t.read_shift(e.biff==12?4:2),s=[],o=0;o!=n;++o)s.push((e.biff==12?Gi:Td)(t));return s}function XN(t,r,e){var n=0,s=0;e.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--n,--s==0&&(s=256));for(var o=0,l=[];o!=n&&(l[o]=[]);++o)for(var u=0;u!=s;++u)l[o][u]=GN(t,e.biff);return l}function qN(t,r,e){var n=t.read_shift(1)>>>5&3,s=!e||e.biff>=8?4:2,o=t.read_shift(s);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function JN(t,r,e){if(e.biff==5)return YN(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),o=t.read_shift(4);return[n,s,o]}function YN(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[r,e,n]}function QN(t,r,e){var n=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var s=t.read_shift(e&&e.biff==2?1:2);return[n,s]}function ZN(t,r,e){var n=t.read_shift(1)>>>5&3,s=t.read_shift(e&&e.biff==2?1:2);return[n,s]}function eC(t,r,e){var n=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[n]}function tC(t,r,e){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),o=4;if(e)switch(e.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,s]}var rC=sn,nC=sn,sC=sn;function Nc(t,r,e){return t.l+=2,[xN(t)]}function Lh(t){return t.l+=6,[]}var aC=Nc,iC=Lh,oC=Lh,lC=Nc;function g1(t){return t.l+=2,[yr(t),t.read_shift(2)&1]}var cC=Nc,uC=g1,dC=Lh,fC=Nc,hC=Nc,mC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function gC(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),o=t.read_shift(2),l=mC[e>>2&31];return{ixti:r,coltype:e&3,rt:l,idx:n,c:s,C:o}}function pC(t){return t.l+=2,[t.read_shift(4)]}function xC(t,r,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function vC(t,r,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function yC(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function wC(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function bC(t){return t.l+=4,[0,0]}var ex={1:{n:"PtgExp",f:UN},2:{n:"PtgTbl",f:sC},3:{n:"PtgAdd",f:xr},4:{n:"PtgSub",f:xr},5:{n:"PtgMul",f:xr},6:{n:"PtgDiv",f:xr},7:{n:"PtgPower",f:xr},8:{n:"PtgConcat",f:xr},9:{n:"PtgLt",f:xr},10:{n:"PtgLe",f:xr},11:{n:"PtgEq",f:xr},12:{n:"PtgGe",f:xr},13:{n:"PtgGt",f:xr},14:{n:"PtgNe",f:xr},15:{n:"PtgIsect",f:xr},16:{n:"PtgUnion",f:xr},17:{n:"PtgRange",f:xr},18:{n:"PtgUplus",f:xr},19:{n:"PtgUminus",f:xr},20:{n:"PtgPercent",f:xr},21:{n:"PtgParen",f:xr},22:{n:"PtgMissArg",f:xr},23:{n:"PtgStr",f:zN},26:{n:"PtgSheet",f:xC},27:{n:"PtgEndSheet",f:vC},28:{n:"PtgErr",f:BN},29:{n:"PtgBool",f:WN},30:{n:"PtgInt",f:VN},31:{n:"PtgNum",f:HN},32:{n:"PtgArray",f:kN},33:{n:"PtgFunc",f:PN},34:{n:"PtgFuncVar",f:LN},35:{n:"PtgName",f:qN},36:{n:"PtgRef",f:ON},37:{n:"PtgArea",f:wN},38:{n:"PtgMemArea",f:QN},39:{n:"PtgMemErr",f:rC},40:{n:"PtgMemNoMem",f:nC},41:{n:"PtgMemFunc",f:ZN},42:{n:"PtgRefErr",f:eC},43:{n:"PtgAreaErr",f:_N},44:{n:"PtgRefN",f:DN},45:{n:"PtgAreaN",f:EN},46:{n:"PtgMemAreaN",f:yC},47:{n:"PtgMemNoMemN",f:wC},57:{n:"PtgNameX",f:JN},58:{n:"PtgRef3d",f:FN},59:{n:"PtgArea3d",f:bN},60:{n:"PtgRefErr3d",f:tC},61:{n:"PtgAreaErr3d",f:SN},255:{}},_C={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},SC={1:{n:"PtgElfLel",f:g1},2:{n:"PtgElfRw",f:fC},3:{n:"PtgElfCol",f:aC},6:{n:"PtgElfRwV",f:hC},7:{n:"PtgElfColV",f:lC},10:{n:"PtgElfRadical",f:cC},11:{n:"PtgElfRadicalS",f:dC},13:{n:"PtgElfColS",f:iC},15:{n:"PtgElfColSV",f:oC},16:{n:"PtgElfRadicalLel",f:uC},25:{n:"PtgList",f:gC},29:{n:"PtgSxName",f:pC},255:{}},EC={0:{n:"PtgAttrNoop",f:bC},1:{n:"PtgAttrSemi",f:AN},2:{n:"PtgAttrIf",f:CN},4:{n:"PtgAttrChoose",f:TN},8:{n:"PtgAttrGoto",f:NN},16:{n:"PtgAttrSum",f:$N},32:{n:"PtgAttrBaxcel",f:Zp},33:{n:"PtgAttrBaxcel",f:Zp},64:{n:"PtgAttrSpace",f:RN},65:{n:"PtgAttrSpaceSemi",f:IN},128:{n:"PtgAttrIfError",f:jN},255:{}};function Cc(t,r,e,n){if(n.biff<8)return sn(t,r);for(var s=t.l+r,o=[],l=0;l!==e.length;++l)switch(e[l][0]){case"PtgArray":e[l][1]=XN(t,0,n),o.push(e[l][1]);break;case"PtgMemArea":e[l][2]=KN(t,e[l][1],n),o.push(e[l][2]);break;case"PtgExp":n&&n.biff==12&&(e[l][1][1]=t.read_shift(4),o.push(e[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[l][0]}return r=s-t.l,r!==0&&o.push(sn(t,r)),o}function jc(t,r,e){for(var n=t.l+r,s,o,l=[];n!=t.l;)r=n-t.l,o=t[t.l],s=ex[o]||ex[_C[o]],(o===24||o===25)&&(s=(o===24?SC:EC)[t[t.l+1]]),!s||!s.f?sn(t,r):l.push([s.n,s.f(t,r,e)]);return l}function kC(t){for(var r=[],e=0;e<t.length;++e){for(var n=t[e],s=[],o=0;o<n.length;++o){var l=n[o];if(l)switch(l[0]){case 2:s.push('"'+l[1].replace(/"/g,'""')+'"');break;default:s.push(l[1])}else s.push("")}r.push(s.join(","))}return r.join(";")}var TC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function NC(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function p1(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!n)return"SH33TJSERR1";var s="";if(e.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function tx(t,r,e){var n=p1(t,r,e);return n=="#REF"?n:NC(n,e)}function en(t,r,e,n,s){var o=s&&s.biff||8,l={s:{c:0,r:0}},u=[],f,m,p,v=0,w=0,_,k="";if(!t[0]||!t[0][0])return"";for(var b=-1,y="",L=0,G=t[0].length;L<G;++L){var j=t[0][L];switch(j[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),m=u.pop(),b>=0){switch(t[0][b][1][0]){case 0:y=lr(" ",t[0][b][1][1]);break;case 1:y=lr("\r",t[0][b][1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}m=m+y,b=-1}u.push(m+TC[j[0]]+f);break;case"PtgIsect":f=u.pop(),m=u.pop(),u.push(m+" "+f);break;case"PtgUnion":f=u.pop(),m=u.pop(),u.push(m+","+f);break;case"PtgRange":f=u.pop(),m=u.pop(),u.push(m+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=tc(j[1][1],l,s),u.push(rc(p,o));break;case"PtgRefN":p=e?tc(j[1][1],e,s):j[1][1],u.push(rc(p,o));break;case"PtgRef3d":v=j[1][1],p=tc(j[1][2],l,s),k=tx(n,v,s),u.push(k+"!"+rc(p,o));break;case"PtgFunc":case"PtgFuncVar":var F=j[1][0],ue=j[1][1];F||(F=0),F&=127;var D=F==0?[]:u.slice(-F);u.length-=F,ue==="User"&&(ue=D.shift()),u.push(ue+"("+D.join(",")+")");break;case"PtgBool":u.push(j[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(j[1]);break;case"PtgNum":u.push(String(j[1]));break;case"PtgStr":u.push('"'+j[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(j[1]);break;case"PtgAreaN":_=Fp(j[1][1],e?{s:e}:l,s),u.push(Tf(_,s));break;case"PtgArea":_=Fp(j[1][1],l,s),u.push(Tf(_,s));break;case"PtgArea3d":v=j[1][1],_=j[1][2],k=tx(n,v,s),u.push(k+"!"+Tf(_,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":w=j[1][2];var V=(n.names||[])[w-1]||(n[0]||[])[w],ee=V?V.Name:"SH33TJSNAME"+String(w);ee&&ee.slice(0,6)=="_xlfn."&&!s.xlfn&&(ee=ee.slice(6)),u.push(ee);break;case"PtgNameX":var T=j[1][1];w=j[1][2];var O;if(s.biff<=5)T<0&&(T=-T),n[T]&&(O=n[T][w]);else{var H="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][w]&&n[T][w].itab>0&&(H=n.SheetNames[n[T][w].itab-1]+"!"):H=n.SheetNames[w-1]+"!"),n[T]&&n[T][w])H+=n[T][w].Name;else if(n[0]&&n[0][w])H+=n[0][w].Name;else{var U=(p1(n,T,s)||"").split(";;");U[w-1]?H=U[w-1]:H+="SH33TJSERRX"}u.push(H);break}O||(O={Name:"SH33TJSERRY"}),u.push(O.Name);break;case"PtgParen":var X="(",ve=")";if(b>=0){switch(y="",t[0][b][1][0]){case 2:X=lr(" ",t[0][b][1][1])+X;break;case 3:X=lr("\r",t[0][b][1][1])+X;break;case 4:ve=lr(" ",t[0][b][1][1])+ve;break;case 5:ve=lr("\r",t[0][b][1][1])+ve;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}b=-1}u.push(X+u.pop()+ve);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:j[1][1],r:j[1][0]};var we={c:e.c,r:e.r};if(n.sharedf[yt(p)]){var Ne=n.sharedf[yt(p)];u.push(en(Ne,l,we,n,s))}else{var he=!1;for(f=0;f!=n.arrayf.length;++f)if(m=n.arrayf[f],!(p.c<m[0].s.c||p.c>m[0].e.c)&&!(p.r<m[0].s.r||p.r>m[0].e.r)){u.push(en(m[1],l,we,n,s)),he=!0;break}he||u.push(j[1])}break;case"PtgArray":u.push("{"+kC(j[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=L;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+j[1].idx+"[#"+j[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(j));default:throw new Error("Unrecognized Formula Token: "+String(j))}var ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&b>=0&&ae.indexOf(t[0][L][0])==-1){j=t[0][b];var K=!0;switch(j[1][0]){case 4:K=!1;case 0:y=lr(" ",j[1][1]);break;case 5:K=!1;case 1:y=lr("\r",j[1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+j[1][0])}u.push((K?y:"")+u.pop()+(K?"":y)),b=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function CC(t,r,e){var n=t.l+r,s=e.biff==2?1:2,o,l=t.read_shift(s);if(l==65535)return[[],sn(t,r-2)];var u=jc(t,l,e);return r!==l+s&&(o=Cc(t,r-l-s,u,e)),t.l=n,[u,o]}function jC(t,r,e){var n=t.l+r,s=e.biff==2?1:2,o,l=t.read_shift(s);if(l==65535)return[[],sn(t,r-2)];var u=jc(t,l,e);return r!==l+s&&(o=Cc(t,r-l-s,u,e)),t.l=n,[u,o]}function AC(t,r,e,n){var s=t.l+r,o=jc(t,n,e),l;return s!==t.l&&(l=Cc(t,s-t.l,o,e)),[o,l]}function RC(t,r,e){var n=t.l+r,s,o=t.read_shift(2),l=jc(t,o,e);return o==65535?[[],sn(t,r-2)]:(r!==o+2&&(s=Cc(t,n-o-2,l,e)),[l,s])}function IC(t){var r;if(ca(t,t.l+6)!==65535)return[tn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return r=t[t.l+2]===1,t.l+=8,[r,"b"];case 2:return r=t[t.l+2],t.l+=8,[r,"e"];case 3:return t.l+=8,["","s"]}return[]}function jf(t,r,e){var n=t.l+r,s=Vs(t);e.biff==2&&++t.l;var o=IC(t),l=t.read_shift(1);e.biff!=2&&(t.read_shift(1),e.biff>=5&&t.read_shift(4));var u=jC(t,n-t.l,e);return{cell:s,val:o[0],formula:u,shared:l>>3&1,tt:o[1]}}function Nd(t,r,e){var n=t.read_shift(4),s=jc(t,n,e),o=t.read_shift(4),l=o>0?Cc(t,o,s,e):null;return[s,l]}var OC=Nd,Cd=Nd,DC=Nd,FC=Nd,PC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},x1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},LC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function rx(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,e){return e.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Af(t){var r=t.split(":"),e=r[0].split(".")[0];return[e,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var ic={},Ko={};function oc(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function v1(t,r,e,n,s,o){try{n.cellNF&&(t.z=St[r])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Mr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(St[r]==null&&Pi(MS[r]||"General",r),t.t==="e")t.w=t.w||Ki[t.v];else if(r===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=fc(t.v);else if(t.t==="d"){var l=yn(t.v);(l|0)===l?t.w=l.toString(10):t.w=fc(l)}else{if(t.v===void 0)return"";t.w=Mi(t.v,Ko)}else t.t==="d"?t.w=ss(r,yn(t.v),Ko):t.w=ss(r,t.v,Ko)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&e!=null)try{t.s=o.Fills[e],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=pd(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=pd(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function MC(t,r){var e=cr(r);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(t["!ref"]=Ot(e))}var $C=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,UC=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,BC=/<(?:\w:)?hyperlink [^>]*>/mg,VC=/"(\w*:\w*)"/,WC=/<(?:\w:)?col\b[^>]*[\/]?>/g,HC=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,zC=/<(?:\w:)?pageMargins[^>]*\/>/g,y1=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,GC=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,KC=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function XC(t,r,e,n,s,o,l){if(!t)return t;n||(n={"!id":{}});var u=r.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",p="",v=t.match(UC);v?(m=t.slice(0,v.index),p=t.slice(v.index+v[0].length)):m=p=t;var w=m.match(y1);w?Mh(w[0],u,s,e):(w=m.match(GC))&&qC(w[0],w[1]||"",u,s,e);var _=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var k=m.slice(_,_+50).match(VC);k&&MC(u,k[1])}var b=m.match(KC);b&&b[1]&&t4(b[1],s);var y=[];if(r.cellStyles){var L=m.match(WC);L&&QC(y,L)}v&&r4(v[1],u,r,f,o,l);var G=p.match(HC);G&&(u["!autofilter"]=ZC(G[0]));var j=[],F=p.match($C);if(F)for(_=0;_!=F.length;++_)j[_]=cr(F[_].slice(F[_].indexOf('"')+1));var ue=p.match(BC);ue&&JC(u,ue,n);var D=p.match(zC);if(D&&(u["!margins"]=YC(ht(D[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=Ot(f)),r.sheetRows>0&&u["!ref"]){var V=cr(u["!ref"]);r.sheetRows<=+V.e.r&&(V.e.r=r.sheetRows-1,V.e.r>f.e.r&&(V.e.r=f.e.r),V.e.r<V.s.r&&(V.s.r=V.e.r),V.e.c>f.e.c&&(V.e.c=f.e.c),V.e.c<V.s.c&&(V.s.c=V.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Ot(V))}return y.length>0&&(u["!cols"]=y),j.length>0&&(u["!merges"]=j),u}function Mh(t,r,e,n){var s=ht(t);e.Sheets[n]||(e.Sheets[n]={}),s.codeName&&(e.Sheets[n].CodeName=Lt(Yt(s.codeName)))}function qC(t,r,e,n,s){Mh(t.slice(0,t.indexOf(">")),e,n,s)}function JC(t,r,e){for(var n=Array.isArray(t),s=0;s!=r.length;++s){var o=ht(Yt(r[s]),!0);if(!o.ref)return;var l=((e||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Lt(o.location))):(o.Target="#"+Lt(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=cr(o.ref),f=u.s.r;f<=u.e.r;++f)for(var m=u.s.c;m<=u.e.c;++m){var p=yt({c:m,r:f});n?(t[f]||(t[f]=[]),t[f][m]||(t[f][m]={t:"z",v:void 0}),t[f][m].l=o):(t[p]||(t[p]={t:"z",v:void 0}),t[p].l=o)}}}function YC(t){var r={};return["left","right","top","bottom","header","footer"].forEach(function(e){t[e]&&(r[e]=parseFloat(t[e]))}),r}function QC(t,r){for(var e=!1,n=0;n!=r.length;++n){var s=ht(r[n],!0);s.hidden&&(s.hidden=er(s.hidden));var o=parseInt(s.min,10)-1,l=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!e&&s.width&&(e=!0,Ph(s.width)),Jo(s);o<=l;)t[o++]=zr(s)}}function ZC(t){var r={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return r}var e4=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function t4(t,r){r.Views||(r.Views=[{}]),(t.match(e4)||[]).forEach(function(e,n){var s=ht(e);r.Views[n]||(r.Views[n]={}),+s.zoomScale&&(r.Views[n].zoom=+s.zoomScale),er(s.rightToLeft)&&(r.Views[n].RTL=!0)})}var r4=(function(){var t=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,o=hc("v"),l=hc("f");return function(f,m,p,v,w,_){for(var k=0,b="",y=[],L=[],G=0,j=0,F=0,ue="",D,V,ee=0,T=0,O,H,U=0,X=0,ve=Array.isArray(_.CellXf),we,Ne=[],he=[],ae=Array.isArray(m),K=[],oe={},A=!1,N=!!p.sheetStubs,B=f.split(r),q=0,ne=B.length;q!=ne;++q){b=B[q].trim();var pe=b.length;if(pe!==0){var te=0;e:for(k=0;k<pe;++k)switch(b[k]){case">":if(b[k-1]!="/"){++k;break e}if(p&&p.cellStyles){if(V=ht(b.slice(te,k),!0),ee=V.r!=null?parseInt(V.r,10):ee+1,T=-1,p.sheetRows&&p.sheetRows<ee)continue;oe={},A=!1,V.ht&&(A=!0,oe.hpt=parseFloat(V.ht),oe.hpx=xc(oe.hpt)),V.hidden=="1"&&(A=!0,oe.hidden=!0),V.outlineLevel!=null&&(A=!0,oe.level=+V.outlineLevel),A&&(K[ee-1]=oe)}break;case"<":te=k;break}if(te>=k)break;if(V=ht(b.slice(te,k),!0),ee=V.r!=null?parseInt(V.r,10):ee+1,T=-1,!(p.sheetRows&&p.sheetRows<ee)){v.s.r>ee-1&&(v.s.r=ee-1),v.e.r<ee-1&&(v.e.r=ee-1),p&&p.cellStyles&&(oe={},A=!1,V.ht&&(A=!0,oe.hpt=parseFloat(V.ht),oe.hpx=xc(oe.hpt)),V.hidden=="1"&&(A=!0,oe.hidden=!0),V.outlineLevel!=null&&(A=!0,oe.level=+V.outlineLevel),A&&(K[ee-1]=oe)),y=b.slice(k).split(t);for(var fe=0;fe!=y.length&&y[fe].trim().charAt(0)=="<";++fe);for(y=y.slice(fe),k=0;k!=y.length;++k)if(b=y[k].trim(),b.length!==0){if(L=b.match(e),G=k,j=0,F=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,L!=null&&L.length===2){for(G=0,ue=L[1],j=0;j!=ue.length&&!((F=ue.charCodeAt(j)-64)<1||F>26);++j)G=26*G+F;--G,T=G}else++T;for(j=0;j!=b.length&&b.charCodeAt(j)!==62;++j);if(++j,V=ht(b.slice(0,j),!0),V.r||(V.r=yt({r:ee-1,c:T})),ue=b.slice(j),D={t:""},(L=ue.match(o))!=null&&L[1]!==""&&(D.v=Lt(L[1])),p.cellFormula){if((L=ue.match(l))!=null&&L[1]!==""){if(D.f=Lt(Yt(L[1])).replace(/\r\n/g,`
`),p.xlfn||(D.f=Qp(D.f)),L[0].indexOf('t="array"')>-1)D.F=(ue.match(s)||[])[1],D.F.indexOf(":")>-1&&Ne.push([cr(D.F),D.F]);else if(L[0].indexOf('t="shared"')>-1){H=ht(L[0]);var I=Lt(Yt(L[1]));p.xlfn||(I=Qp(I)),he[parseInt(H.si,10)]=[H,I,V.r]}}else(L=ue.match(/<f[^>]*\/>/))&&(H=ht(L[0]),he[H.si]&&(D.f=hN(he[H.si][1],he[H.si][2],V.r)));var le=xn(V.r);for(j=0;j<Ne.length;++j)le.r>=Ne[j][0].s.r&&le.r<=Ne[j][0].e.r&&le.c>=Ne[j][0].s.c&&le.c<=Ne[j][0].e.c&&(D.F=Ne[j][1])}if(V.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(N)D.t="z";else continue;else D.t=V.t||"n";switch(v.s.c>T&&(v.s.c=T),v.e.c<T&&(v.e.c=T),D.t){case"n":if(D.v==""||D.v==null){if(!N)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!N)continue;D.t="z"}else O=ic[parseInt(D.v,10)],D.v=O.t,D.r=O.r,p.cellHTML&&(D.h=O.h);break;case"str":D.t="s",D.v=D.v!=null?Yt(D.v):"",p.cellHTML&&(D.h=kh(D.v));break;case"inlineStr":L=ue.match(n),D.t="s",L!=null&&(O=Fh(L[1]))?(D.v=O.t,p.cellHTML&&(D.h=O.h)):D.v="";break;case"b":D.v=er(D.v);break;case"d":p.cellDates?D.v=Mr(D.v,1):(D.v=yn(Mr(D.v,1)),D.t="n");break;case"e":(!p||p.cellText!==!1)&&(D.w=D.v),D.v=Uv[D.v];break}if(U=X=0,we=null,ve&&V.s!==void 0&&(we=_.CellXf[V.s],we!=null&&(we.numFmtId!=null&&(U=we.numFmtId),p.cellStyles&&we.fillId!=null&&(X=we.fillId))),v1(D,U,X,p,w,_),p.cellDates&&ve&&D.t=="n"&&tl(St[U])&&(D.t="d",D.v=kd(D.v)),V.cm&&p.xlmeta){var se=(p.xlmeta.Cell||[])[+V.cm-1];se&&se.type=="XLDAPR"&&(D.D=!0)}if(ae){var z=xn(V.r);m[z.r]||(m[z.r]=[]),m[z.r][z.c]=D}else m[V.r]=D}}}}K.length>0&&(m["!rows"]=K)}})();function n4(t,r){var e={},n=t.l+r;e.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(e.level=o&7),o&16&&(e.hidden=!0),o&32&&(e.hpt=s/20),e}var s4=Gi;function a4(){}function i4(t,r){var e={},n=t[t.l];return++t.l,e.above=!(n&64),e.left=!(n&128),t.l+=18,e.name=C2(t),e}function o4(t){var r=as(t);return[r]}function l4(t){var r=zi(t);return[r]}function c4(t){var r=as(t),e=t.read_shift(1);return[r,e,"b"]}function u4(t){var r=zi(t),e=t.read_shift(1);return[r,e,"b"]}function d4(t){var r=as(t),e=t.read_shift(1);return[r,e,"e"]}function f4(t){var r=zi(t),e=t.read_shift(1);return[r,e,"e"]}function h4(t){var r=as(t),e=t.read_shift(4);return[r,e,"s"]}function m4(t){var r=zi(t),e=t.read_shift(4);return[r,e,"s"]}function g4(t){var r=as(t),e=tn(t);return[r,e,"n"]}function w1(t){var r=zi(t),e=tn(t);return[r,e,"n"]}function p4(t){var r=as(t),e=Ih(t);return[r,e,"n"]}function x4(t){var r=zi(t),e=Ih(t);return[r,e,"n"]}function v4(t){var r=as(t),e=Ah(t);return[r,e,"is"]}function y4(t){var r=as(t),e=nn(t);return[r,e,"str"]}function w4(t){var r=zi(t),e=nn(t);return[r,e,"str"]}function b4(t,r,e){var n=t.l+r,s=as(t);s.r=e["!row"];var o=t.read_shift(1),l=[s,o,"b"];if(e.cellFormula){t.l+=2;var u=Cd(t,n-t.l,e);l[3]=en(u,null,s,e.supbooks,e)}else t.l=n;return l}function _4(t,r,e){var n=t.l+r,s=as(t);s.r=e["!row"];var o=t.read_shift(1),l=[s,o,"e"];if(e.cellFormula){t.l+=2;var u=Cd(t,n-t.l,e);l[3]=en(u,null,s,e.supbooks,e)}else t.l=n;return l}function S4(t,r,e){var n=t.l+r,s=as(t);s.r=e["!row"];var o=tn(t),l=[s,o,"n"];if(e.cellFormula){t.l+=2;var u=Cd(t,n-t.l,e);l[3]=en(u,null,s,e.supbooks,e)}else t.l=n;return l}function E4(t,r,e){var n=t.l+r,s=as(t);s.r=e["!row"];var o=nn(t),l=[s,o,"str"];if(e.cellFormula){t.l+=2;var u=Cd(t,n-t.l,e);l[3]=en(u,null,s,e.supbooks,e)}else t.l=n;return l}var k4=Gi;function T4(t,r){var e=t.l+r,n=Gi(t),s=Rh(t),o=nn(t),l=nn(t),u=nn(t);t.l=e;var f={rfx:n,relId:s,loc:o,display:u};return l&&(f.Tooltip=l),f}function N4(){}function C4(t,r,e){var n=t.l+r,s=Lv(t),o=t.read_shift(1),l=[s];if(l[2]=o,e.cellFormula){var u=OC(t,n-t.l,e);l[1]=u}else t.l=n;return l}function j4(t,r,e){var n=t.l+r,s=Gi(t),o=[s];if(e.cellFormula){var l=FC(t,n-t.l,e);o[1]=l,t.l=n}else t.l=n;return o}var A4=["left","right","top","bottom","header","footer"];function R4(t){var r={};return A4.forEach(function(e){r[e]=tn(t)}),r}function I4(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function O4(){}function D4(){}function F4(t,r,e,n,s,o,l){if(!t)return t;var u=r||{};n||(n={"!id":{}});var f=u.dense?[]:{},m,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,w=!1,_,k,b,y,L,G,j,F,ue,D=[];u.biff=12,u["!row"]=0;var V=0,ee=!1,T=[],O={},H=u.supbooks||s.supbooks||[[]];if(H.sharedf=O,H.arrayf=T,H.SheetNames=s.SheetNames||s.Sheets.map(function(ae){return ae.name}),!u.supbooks&&(u.supbooks=H,s.Names))for(var U=0;U<s.Names.length;++U)H[0][U+1]=s.Names[U];var X=[],ve=[],we=!1;yd[16]={n:"BrtShortReal",f:w1};var Ne;if(pa(t,function(K,oe,A){if(!w)switch(A){case 148:m=K;break;case 0:_=K,u.sheetRows&&u.sheetRows<=_.r&&(w=!0),F=Gr(y=_.r),u["!row"]=_.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=xc(K.hpt)),ve[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:K[2]},K[2]){case"n":k.v=K[1];break;case"s":j=ic[K[1]],k.v=j.t,k.r=j.r;break;case"b":k.v=!!K[1];break;case"e":k.v=K[1],u.cellText!==!1&&(k.w=Ki[k.v]);break;case"str":k.t="s",k.v=K[1];break;case"is":k.t="s",k.v=K[1].t;break}if((b=l.CellXf[K[0].iStyleRef])&&v1(k,b.numFmtId,null,u,o,l),L=K[0].c==-1?L+1:K[0].c,u.dense?(f[y]||(f[y]=[]),f[y][L]=k):f[jr(L)+F]=k,u.cellFormula){for(ee=!1,V=0;V<T.length;++V){var N=T[V];_.r>=N[0].s.r&&_.r<=N[0].e.r&&L>=N[0].s.c&&L<=N[0].e.c&&(k.F=Ot(N[0]),ee=!0)}!ee&&K.length>3&&(k.f=K[3])}if(p.s.r>_.r&&(p.s.r=_.r),p.s.c>L&&(p.s.c=L),p.e.r<_.r&&(p.e.r=_.r),p.e.c<L&&(p.e.c=L),u.cellDates&&b&&k.t=="n"&&tl(St[b.numFmtId])){var B=Fi(k.v);B&&(k.t="d",k.v=new Date(B.y,B.m-1,B.d,B.H,B.M,B.S,B.u))}Ne&&(Ne.type=="XLDAPR"&&(k.D=!0),Ne=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;k={t:"z",v:void 0},L=K[0].c==-1?L+1:K[0].c,u.dense?(f[y]||(f[y]=[]),f[y][L]=k):f[jr(L)+F]=k,p.s.r>_.r&&(p.s.r=_.r),p.s.c>L&&(p.s.c=L),p.e.r<_.r&&(p.e.r=_.r),p.e.c<L&&(p.e.c=L),Ne&&(Ne.type=="XLDAPR"&&(k.D=!0),Ne=void 0);break;case 176:D.push(K);break;case 49:Ne=((u.xlmeta||{}).Cell||[])[K-1];break;case 494:var q=n["!id"][K.relId];for(q?(K.Target=q.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=q):K.relId==""&&(K.Target="#"+K.loc),y=K.rfx.s.r;y<=K.rfx.e.r;++y)for(L=K.rfx.s.c;L<=K.rfx.e.c;++L)u.dense?(f[y]||(f[y]=[]),f[y][L]||(f[y][L]={t:"z",v:void 0}),f[y][L].l=K):(G=yt({c:L,r:y}),f[G]||(f[G]={t:"z",v:void 0}),f[G].l=K);break;case 426:if(!u.cellFormula)break;T.push(K),ue=u.dense?f[y][L]:f[jr(L)+F],ue.f=en(K[1],p,{r:_.r,c:L},H,u),ue.F=Ot(K[0]);break;case 427:if(!u.cellFormula)break;O[yt(K[0].s)]=K[1],ue=u.dense?f[y][L]:f[jr(L)+F],ue.f=en(K[1],p,{r:_.r,c:L},H,u);break;case 60:if(!u.cellStyles)break;for(;K.e>=K.s;)X[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},we||(we=!0,Ph(K.w/256)),Jo(X[K.e+1]);break;case 161:f["!autofilter"]={ref:Ot(K)};break;case 476:f["!margins"]=K;break;case 147:s.Sheets[e]||(s.Sheets[e]={}),K.name&&(s.Sheets[e].CodeName=K.name),(K.above||K.left)&&(f["!outline"]={above:K.above,left:K.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),K.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!oe.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(p.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(f["!ref"]=Ot(m||p)),u.sheetRows&&f["!ref"]){var he=cr(f["!ref"]);u.sheetRows<=+he.e.r&&(he.e.r=u.sheetRows-1,he.e.r>p.e.r&&(he.e.r=p.e.r),he.e.r<he.s.r&&(he.s.r=he.e.r),he.e.c>p.e.c&&(he.e.c=p.e.c),he.e.c<he.s.c&&(he.s.c=he.e.c),f["!fullref"]=f["!ref"],f["!ref"]=Ot(he))}return D.length>0&&(f["!merges"]=D),X.length>0&&(f["!cols"]=X),ve.length>0&&(f["!rows"]=ve),f}function P4(t){var r=[],e=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(r[+l[1]]=e?+l[2]:l[2])});var s=Lt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[r,s,n]}function L4(t,r,e,n,s,o){var l=o||{"!type":"chart"};if(!t)return o;var u=0,f=0,m="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var w=P4(v);p.s.r=p.s.c=0,p.e.c=u,m=jr(u),w[0].forEach(function(_,k){l[m+Gr(k)]={t:"n",v:_,z:w[1]},f=k}),p.e.r<f&&(p.e.r=f),++u}),u>0&&(l["!ref"]=Ot(p)),l}function M4(t,r,e,n,s){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,u=t.match(y1);return u&&Mh(u[0],o,s,e),(l=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function $4(t,r){t.l+=10;var e=nn(t);return{name:e}}function U4(t,r,e,n,s){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return pa(t,function(f,m,p){switch(p){case 550:o["!rel"]=f;break;case 651:s.Sheets[e]||(s.Sheets[e]={}),f.name&&(s.Sheets[e].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!l||r.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},r),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var b1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],B4=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],V4=[],W4=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function nx(t,r){for(var e=0;e!=t.length;++e)for(var n=t[e],s=0;s!=r.length;++s){var o=r[s];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=er(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function sx(t,r){for(var e=0;e!=r.length;++e){var n=r[e];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=er(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function _1(t){sx(t.WBProps,b1),sx(t.CalcPr,W4),nx(t.WBView,B4),nx(t.Sheets,V4),Ko.date1904=er(t.WBProps.date1904)}var H4="][*?/\\".split("");function z4(t,r){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return H4.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}var G4=/<\w+:workbook/;function K4(t,r){if(!t)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",o={},l=0;if(t.replace(on,function(f,m){var p=ht(f);switch(Bs(p[0])){case"<?xml":break;case"<workbook":f.match(G4)&&(s="xmlns"+f.match(/<(\w+):/)[1]),e.xmlns=p[s];break;case"</workbook>":break;case"<fileVersion":delete p[0],e.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":b1.forEach(function(v){if(p[v[0]]!=null)switch(v[2]){case"bool":e.WBProps[v[0]]=er(p[v[0]]);break;case"int":e.WBProps[v[0]]=parseInt(p[v[0]],10);break;default:e.WBProps[v[0]]=p[v[0]]}}),p.codeName&&(e.WBProps.CodeName=Yt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],e.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Lt(Yt(p.name)),delete p[0],e.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=Yt(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),er(p.hidden||"0")&&(o.Hidden=!0),l=m+f.length;break;case"</definedName>":o.Ref=Lt(Yt(t.slice(l,m))),e.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],e.CalcPr=p;break;case"<calcPr/>":delete p[0],e.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return f}),d2.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return _1(e),e}function X4(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=Jf(t),e.name=nn(t),e}function q4(t,r){var e={},n=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var s=r>8?nn(t):"";return s.length>0&&(e.CodeName=s),e.autoCompressPictures=!!(n&65536),e.backupFile=!!(n&64),e.checkCompatibility=!!(n&4096),e.date1904=!!(n&1),e.filterPrivacy=!!(n&8),e.hidePivotFieldList=!!(n&1024),e.promptedSolutions=!!(n&16),e.publishItems=!!(n&2048),e.refreshAllConnections=!!(n&262144),e.saveExternalLinkValues=!!(n&128),e.showBorderUnselectedTables=!!(n&4),e.showInkAnnotation=!!(n&32),e.showObjects=["all","placeholders","none"][n>>13&3],e.showPivotChartFilter=!!(n&32768),e.updateLinks=["userSet","never","always"][n>>8&3],e}function J4(t,r){var e={};return t.read_shift(4),e.ArchID=t.read_shift(4),t.l+=r-8,e}function Y4(t,r,e){var n=t.l+r;t.l+=4,t.l+=1;var s=t.read_shift(4),o=j2(t),l=DC(t,0,e),u=Rh(t);t.l=n;var f={Name:o,Ptg:l};return s<268435455&&(f.Sheet=s),u&&(f.Comment=u),f}function Q4(t,r){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;r||(r={}),r.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],yd[16]={n:"BrtFRTArchID$",f:J4},pa(t,function(f,m,p){switch(p){case 156:l.SheetNames.push(f.name),e.Sheets.push(f);break;case 153:e.WBProps=f;break;case 39:f.Sheet!=null&&(r.SID=f.Sheet),f.Ref=en(f.Ptg,null,null,l,r),delete r.SID,delete f.Ptg,o.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([p,f]):l[0]=[p,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(p),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!m.T){if(!s||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},r),_1(e),e.Names=o,e.supbooks=l,e}function Z4(t,r,e){return r.slice(-4)===".bin"?Q4(t,e):K4(t,e)}function e3(t,r,e,n,s,o,l,u){return r.slice(-4)===".bin"?F4(t,n,e,s,o,l,u):XC(t,n,e,s,o,l,u)}function t3(t,r,e,n,s,o,l,u){return r.slice(-4)===".bin"?U4(t,n,e,s,o):M4(t,n,e,s,o)}function r3(t,r,e,n,s,o,l,u){return r.slice(-4)===".bin"?uN():dN()}function n3(t,r,e,n,s,o,l,u){return r.slice(-4)===".bin"?lN():cN()}function s3(t,r,e,n){return r.slice(-4)===".bin"?kT(t,e,n):yT(t,e,n)}function a3(t,r,e){return l1(t,e)}function i3(t,r,e){return r.slice(-4)===".bin"?Bk(t,e):$k(t,e)}function o3(t,r,e){return r.slice(-4)===".bin"?aN(t,e):eN(t,e)}function l3(t,r,e){return r.slice(-4)===".bin"?YT(t):qT(t)}function c3(t,r,e,n){return e.slice(-4)===".bin"?QT(t,r,e,n):void 0}function u3(t,r,e){return r.slice(-4)===".bin"?KT(t,r,e):XT(t,r,e)}var S1=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,E1=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function gs(t,r){var e=t.split(/\s+/),n=[];if(n[0]=e[0],e.length===1)return n;var s=t.match(S1),o,l,u,f;if(s)for(f=0;f!=s.length;++f)o=s[f].match(E1),(l=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(l+1),n[u]=o[2].slice(1,o[2].length-1));return n}function d3(t){var r=t.split(/\s+/),e={};if(r.length===1)return e;var n=t.match(S1),s,o,l,u;if(n)for(u=0;u!=n.length;++u)s=n[u].match(E1),(o=s[1].indexOf(":"))===-1?e[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),e[l]=s[2].slice(1,s[2].length-1));return e}var lc;function f3(t,r){var e=lc[t]||Lt(t);return e==="General"?Mi(r):ss(e,r)}function h3(t,r,e,n){var s=n;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=er(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Mr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}t[Lt(r)]=s}function m3(t,r,e){if(t.t!=="z"){if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ki[t.v]:r==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=fc(t.v):t.w=Mi(t.v):t.w=f3(r||"General",t.v)}catch(o){if(e.WTF)throw o}try{var n=lc[r]||r||"General";if(e.cellNF&&(t.z=n),e.cellDates&&t.t=="n"&&tl(n)){var s=Fi(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(o){if(e.WTF)throw o}}}function g3(t,r,e){if(e.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=hT[n.Pattern]||n.Pattern)}t[r.ID]=r}function p3(t,r,e,n,s,o,l,u,f,m){var p="General",v=n.StyleID,w={};m=m||{};var _=[],k=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&l&&(v=l.StyleID);o[v]!==void 0&&(o[v].nf&&(p=o[v].nf),o[v].Interior&&_.push(o[v].Interior),!!o[v].Parent);)v=o[v].Parent;switch(e.Type){case"Boolean":n.t="b",n.v=er(t);break;case"String":n.t="s",n.r=Tp(Lt(t)),n.v=t.indexOf("<")>-1?Lt(r||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Mr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Lt(t):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Uv[t],m.cellText!==!1&&(n.w=t);break;default:t==""&&r==""?n.t="z":(n.t="s",n.v=Tp(r||t));break}if(m3(n,p,m),m.cellFormula!==!1)if(n.Formula){var b=Lt(n.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),n.f=Go(b,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Go("RC:RC",s):n.ArrayRange&&(n.F=Go(n.ArrayRange,s),f.push([cr(n.F),n.F]))}else for(k=0;k<f.length;++k)s.r>=f[k][0].s.r&&s.r<=f[k][0].e.r&&s.c>=f[k][0].s.c&&s.c<=f[k][0].e.c&&(n.F=f[k][1]);m.cellStyles&&(_.forEach(function(y){!w.patternType&&y.patternType&&(w.patternType=y.patternType)}),n.s=w),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function x3(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Rf(t,r){var e=r||{};fv();var n=Kl(Th(t));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(n=Yt(n));var s=n.slice(0,1024).toLowerCase(),o=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var l=zr(e);return l.type="string",gc.to_workbook(n,l)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ee){s.indexOf("<"+Ee)>=0&&(o=!0)}),o)return T3(n,e);lc={"General Number":"General","General Date":St[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":St[15],"Short Date":St[14],"Long Time":St[19],"Medium Time":St[18],"Short Time":St[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:St[2],Standard:St[4],Percent:St[10],Scientific:St[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],m,p={},v=[],w=e.dense?[]:{},_="",k={},b={},y=gs('<Data ss:Type="String">'),L=0,G=0,j=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},ue={},D={},V="",ee=0,T=[],O={},H={},U=0,X=[],ve=[],we={},Ne=[],he,ae=!1,K=[],oe=[],A={},N=0,B=0,q={Sheets:[],WBProps:{date1904:!1}},ne={};mc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var pe="";u=mc.exec(n);)switch(u[3]=(pe=u[3]).toLowerCase()){case"data":if(pe=="data"){if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?p3(n.slice(L,u.index),V,y,f[f.length-1][0]=="comment"?we:k,{c:G,r:j},ue,Ne[G],b,K,e):(V="",y=gs(u[0]),L=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(ve.length>0&&(k.c=ve),(!e.sheetRows||e.sheetRows>j)&&k.v!==void 0&&(e.dense?(w[j]||(w[j]=[]),w[j][G]=k):w[jr(G)+Gr(j)]=k),k.HRef&&(k.l={Target:Lt(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(N=G+(parseInt(k.MergeAcross,10)|0),B=j+(parseInt(k.MergeDown,10)|0),T.push({s:{c:G,r:j},e:{c:N,r:B}})),!e.sheetStubs)k.MergeAcross?G=N+1:++G;else if(k.MergeAcross||k.MergeDown){for(var te=G;te<=N;++te)for(var fe=j;fe<=B;++fe)(te>G||fe>j)&&(e.dense?(w[fe]||(w[fe]=[]),w[fe][te]={t:"z"}):w[jr(te)+Gr(fe)]={t:"z"});G=N+1}else++G;else k=d3(u[0]),k.Index&&(G=+k.Index-1),G<F.s.c&&(F.s.c=G),G>F.e.c&&(F.e.c=G),u[0].slice(-2)==="/>"&&++G,ve=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(j<F.s.r&&(F.s.r=j),j>F.e.r&&(F.e.r=j),u[0].slice(-2)==="/>"&&(b=gs(u[0]),b.Index&&(j=+b.Index-1)),G=0,++j):(b=gs(u[0]),b.Index&&(j=+b.Index-1),A={},(b.AutoFitHeight=="0"||b.Height)&&(A.hpx=parseInt(b.Height,10),A.hpt=o1(A.hpx),oe[j]=A),b.Hidden=="1"&&(A.hidden=!0,oe[j]=A));break;case"worksheet":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));v.push(_),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(w["!ref"]=Ot(F),e.sheetRows&&e.sheetRows<=F.e.r&&(w["!fullref"]=w["!ref"],F.e.r=e.sheetRows-1,w["!ref"]=Ot(F))),T.length&&(w["!merges"]=T),Ne.length>0&&(w["!cols"]=Ne),oe.length>0&&(w["!rows"]=oe),p[_]=w}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},j=G=0,f.push([u[3],!1]),m=gs(u[0]),_=Lt(m.Name),w=e.dense?[]:{},T=[],K=[],oe=[],ne={name:_,Hidden:0},q.Sheets.push(ne);break;case"table":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),Ne=[],ae=!1}break;case"style":u[1]==="/"?g3(ue,D,e):D=gs(u[0]);break;case"numberformat":D.nf=Lt(gs(u[0]).Format||"General"),lc[D.nf]&&(D.nf=lc[D.nf]);for(var I=0;I!=392&&St[I]!=D.nf;++I);if(I==392){for(I=57;I!=392;++I)if(St[I]==null){Pi(D.nf,I);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(he=gs(u[0]),he.Hidden&&(he.hidden=!0,delete he.Hidden),he.Width&&(he.wpx=parseInt(he.Width,10)),!ae&&he.wpx>10){ae=!0,pn=a1;for(var le=0;le<Ne.length;++le)Ne[le]&&Jo(Ne[le])}ae&&Jo(he),Ne[he.Index-1||Ne.length]=he;for(var se=0;se<+he.Span;++se)Ne[Ne.length]=zr(he);break;case"namedrange":if(u[1]==="/")break;q.Names||(q.Names=[]);var z=ht(u[0]),Ie={Name:z.Name,Ref:Go(z.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(Ie.Sheet=q.Sheets.length-1),q.Names.push(Ie);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?V+=n.slice(ee,u.index):ee=u.index+u[0].length;break;case"interior":if(!e.cellStyles)break;D.Interior=gs(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?eE(O,pe,n.slice(U,u.index)):U=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));x3(we),ve.push(we)}else f.push([u[3],!1]),m=gs(u[0]),we={a:m.Author};break;case"autofilter":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Fe=gs(u[0]);w["!autofilter"]={ref:Go(Fe.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return ux(n,e);var Ye=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ye=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ye=!1}break;case"excelworkbook":switch(u[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ye=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Ye=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(U,u.index)){case"SheetHidden":ne.Hidden=1;break;case"SheetVeryHidden":ne.Hidden=2;break}else U=u.index+u[0].length;break;case"header":w["!margins"]||oc(w["!margins"]={},"xlml"),isNaN(+ht(u[0]).Margin)||(w["!margins"].header=+ht(u[0]).Margin);break;case"footer":w["!margins"]||oc(w["!margins"]={},"xlml"),isNaN(+ht(u[0]).Margin)||(w["!margins"].footer=+ht(u[0]).Margin);break;case"pagemargins":var tt=ht(u[0]);w["!margins"]||oc(w["!margins"]={},"xlml"),isNaN(+tt.Top)||(w["!margins"].top=+tt.Top),isNaN(+tt.Left)||(w["!margins"].left=+tt.Left),isNaN(+tt.Right)||(w["!margins"].right=+tt.Right),isNaN(+tt.Bottom)||(w["!margins"].bottom=+tt.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":w["!outline"]||(w["!outline"]={}),w["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":w["!outline"]||(w["!outline"]={}),w["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ye=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ye=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ye=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ye=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ye=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ye=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ye=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ye=!1}break;case"smarttags":break;default:Ye=!1;break}if(Ye||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?h3(H,pe,X,n.slice(U,u.index)):(X=u,U=u.index+u[0].length);break}if(e.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var Ve={};return!e.bookSheets&&!e.bookProps&&(Ve.Sheets=p),Ve.SheetNames=v,Ve.Workbook=q,Ve.SSF=zr(St),Ve.Props=O,Ve.Custprops=H,Ve}function eh(t,r){switch(Bh(r=r||{}),r.type||"base64"){case"base64":return Rf(Bn(t),r);case"binary":case"buffer":case"file":return Rf(t,r);case"array":return Rf(Hi(t),r)}}function v3(t){var r={},e=t.content;if(e.l=28,r.AnsiUserType=e.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=I2(e),e.length-e.l<=4)return r;var n=e.read_shift(4);if(n==0||n>40||(e.l-=4,r.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(n=e.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=O2(e),n=e.read_shift(4),n==0||n>40))return r;e.l-=4,r.Reserved2=e.read_shift(0,"lpwstr")}var y3=[60,1084,2066,2165,2175];function w3(t,r,e,n,s){var o=n,l=[],u=e.slice(e.l,e.l+o);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}l.push(u),e.l+=o;for(var f=ca(e,e.l),m=th[f],p=0;m!=null&&y3.indexOf(f)>-1;)o=ca(e,e.l+2),p=e.l+4,f==2066?p+=4:(f==2165||f==2175)&&(p+=12),u=e.slice(p,e.l+4+o),l.push(u),e.l+=4+o,m=th[f=ca(e,e.l)];var v=qa(l);Hr(v,0);var w=0;v.lens=[];for(var _=0;_<l.length;++_)v.lens.push(w),w+=l[_].length;if(v.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+n;return r.f(v,v.length,s)}function Ps(t,r,e){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,r.cellNF&&(t.z=St[n])}catch(o){if(r.WTF)throw o}if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Ki[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=fc(t.v):t.w=Mi(t.v):t.w=ss(n,t.v,{date1904:!!e,dateNF:r&&r.dateNF})}catch(o){if(r.WTF)throw o}if(r.cellDates&&n&&t.t=="n"&&tl(St[n]||String(n))){var s=Fi(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function td(t,r,e){return{v:t,ixfe:r,t:e}}function b3(t,r){var e={opts:{}},n={},s=r.dense?[]:{},o={},l={},u=null,f=[],m="",p={},v,w="",_,k,b,y,L={},G=[],j,F,ue=[],D=[],V={Sheets:[],WBProps:{date1904:!1},Views:[{}]},ee={},T=function(Ze){return Ze<8?Li[Ze]:Ze<64&&D[Ze-8]||Li[Ze]},O=function(Ze,bt,ur){var kt=bt.XF.data;if(!(!kt||!kt.patternType||!ur||!ur.cellStyles)){bt.s={},bt.s.patternType=kt.patternType;var dr;(dr=pc(T(kt.icvFore)))&&(bt.s.fgColor={rgb:dr}),(dr=pc(T(kt.icvBack)))&&(bt.s.bgColor={rgb:dr})}},H=function(Ze,bt,ur){if(!(A>1)&&!(ur.sheetRows&&Ze.r>=ur.sheetRows)){if(ur.cellStyles&&bt.XF&&bt.XF.data&&O(Ze,bt,ur),delete bt.ixfe,delete bt.XF,v=Ze,w=yt(Ze),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Ze.r<l.s.r&&(l.s.r=Ze.r),Ze.c<l.s.c&&(l.s.c=Ze.c),Ze.r+1>l.e.r&&(l.e.r=Ze.r+1),Ze.c+1>l.e.c&&(l.e.c=Ze.c+1),ur.cellFormula&&bt.f){for(var kt=0;kt<G.length;++kt)if(!(G[kt][0].s.c>Ze.c||G[kt][0].s.r>Ze.r)&&!(G[kt][0].e.c<Ze.c||G[kt][0].e.r<Ze.r)){bt.F=Ot(G[kt][0]),(G[kt][0].s.c!=Ze.c||G[kt][0].s.r!=Ze.r)&&delete bt.f,bt.f&&(bt.f=""+en(G[kt][1],l,Ze,K,U));break}}ur.dense?(s[Ze.r]||(s[Ze.r]=[]),s[Ze.r][Ze.c]=bt):s[w]=bt}},U={enc:!1,sbcch:0,snames:[],sharedf:L,arrayf:G,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(U.password=r.password);var X,ve=[],we=[],Ne=[],he=[],ae=!1,K=[];K.SheetNames=U.snames,K.sharedf=U.sharedf,K.arrayf=U.arrayf,K.names=[],K.XTI=[];var oe=0,A=0,N=0,B=[],q=[],ne;U.codepage=1200,ws(1200);for(var pe=!1;t.l<t.length-1;){var te=t.l,fe=t.read_shift(2);if(fe===0&&oe===10)break;var I=t.l===t.length?0:t.read_shift(2),le=th[fe];if(le&&le.f){if(r.bookSheets&&oe===133&&fe!==133)break;if(oe=fe,le.r===2||le.r==12){var se=t.read_shift(2);if(I-=2,!U.enc&&se!==fe&&((se&255)<<8|se>>8)!==fe)throw new Error("rt mismatch: "+se+"!="+fe);le.r==12&&(t.l+=10,I-=10)}var z={};if(fe===10?z=le.f(t,I,U):z=w3(fe,le,t,I,U),A==0&&[9,521,1033,2057].indexOf(oe)===-1)continue;switch(fe){case 34:e.opts.Date1904=V.WBProps.date1904=z;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(U.enc||(t.l=0),U.enc=z,!r.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:U.lastuser=z;break;case 66:var Ie=Number(z);switch(Ie){case 21010:Ie=1200;break;case 32768:Ie=1e4;break;case 32769:Ie=1252;break}ws(U.codepage=Ie),pe=!0;break;case 317:U.rrtabid=z;break;case 25:U.winlocked=z;break;case 439:e.opts.RefreshAll=z;break;case 12:e.opts.CalcCount=z;break;case 16:e.opts.CalcDelta=z;break;case 17:e.opts.CalcIter=z;break;case 13:e.opts.CalcMode=z;break;case 14:e.opts.CalcPrecision=z;break;case 95:e.opts.CalcSaveRecalc=z;break;case 15:U.CalcRefMode=z;break;case 2211:e.opts.FullCalc=z;break;case 129:z.fDialog&&(s["!type"]="dialog"),z.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),z.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:ue.push(z);break;case 430:K.push([z]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(z);break;case 24:case 536:ne={Name:z.Name,Ref:en(z.rgce,l,null,K,U)},z.itab>0&&(ne.Sheet=z.itab-1),K.names.push(ne),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(q[z.itab-1]={ref:Ot(z.rgce[0][0][1][2])});break;case 22:U.ExternCount=z;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(z),K.XTI=K.XTI.concat(z);break;case 2196:if(U.biff<8)break;ne!=null&&(ne.Comment=z[1]);break;case 18:s["!protect"]=z;break;case 19:z!==0&&U.WTF&&console.error("Password verifier: "+z);break;case 133:o[z.pos]=z,U.snames.push(z.name);break;case 10:{if(--A)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,s["!ref"]=Ot(l),r.sheetRows&&r.sheetRows<=l.e.r){var Fe=l.e.r;l.e.r=r.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Ot(l),l.e.r=Fe}l.e.r++,l.e.c++}ve.length>0&&(s["!merges"]=ve),we.length>0&&(s["!objects"]=we),Ne.length>0&&(s["!cols"]=Ne),he.length>0&&(s["!rows"]=he),V.Sheets.push(ee)}m===""?p=s:n[m]=s,s=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(U.biff===8&&(U.biff={9:2,521:3,1033:4}[fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),U.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(U.biff=5,pe=!0,ws(U.codepage=28591)),U.biff==8&&z.BIFFVer==0&&z.dt==16&&(U.biff=2),A++)break;if(s=r.dense?[]:{},U.biff<8&&!pe&&(pe=!0,ws(U.codepage=r.codepage||1252)),U.biff<5||z.BIFFVer==0&&z.dt==4096){m===""&&(m="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Ye={pos:t.l-I,name:m};o[Ye.pos]=Ye,U.snames.push(m)}else m=(o[te]||{name:""}).name;z.dt==32&&(s["!type"]="chart"),z.dt==64&&(s["!type"]="macro"),ve=[],we=[],U.arrayf=G=[],Ne=[],he=[],ae=!1,ee={Hidden:(o[te]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(r.dense?(s[z.r]||[])[z.c]:s[yt({c:z.c,r:z.r})])&&++z.c,j={ixfe:z.ixfe,XF:ue[z.ixfe]||{},v:z.val,t:"n"},N>0&&(j.z=B[j.ixfe>>8&63]),Ps(j,r,e.opts.Date1904),H({c:z.c,r:z.r},j,r);break;case 5:case 517:j={ixfe:z.ixfe,XF:ue[z.ixfe],v:z.val,t:z.t},N>0&&(j.z=B[j.ixfe>>8&63]),Ps(j,r,e.opts.Date1904),H({c:z.c,r:z.r},j,r);break;case 638:j={ixfe:z.ixfe,XF:ue[z.ixfe],v:z.rknum,t:"n"},N>0&&(j.z=B[j.ixfe>>8&63]),Ps(j,r,e.opts.Date1904),H({c:z.c,r:z.r},j,r);break;case 189:for(var tt=z.c;tt<=z.C;++tt){var Ve=z.rkrec[tt-z.c][0];j={ixfe:Ve,XF:ue[Ve],v:z.rkrec[tt-z.c][1],t:"n"},N>0&&(j.z=B[j.ixfe>>8&63]),Ps(j,r,e.opts.Date1904),H({c:tt,r:z.r},j,r)}break;case 6:case 518:case 1030:{if(z.val=="String"){u=z;break}if(j=td(z.val,z.cell.ixfe,z.tt),j.XF=ue[j.ixfe],r.cellFormula){var Ee=z.formula;if(Ee&&Ee[0]&&Ee[0][0]&&Ee[0][0][0]=="PtgExp"){var Le=Ee[0][0][1][0],Me=Ee[0][0][1][1],rt=yt({r:Le,c:Me});L[rt]?j.f=""+en(z.formula,l,z.cell,K,U):j.F=((r.dense?(s[Le]||[])[Me]:s[rt])||{}).F}else j.f=""+en(z.formula,l,z.cell,K,U)}N>0&&(j.z=B[j.ixfe>>8&63]),Ps(j,r,e.opts.Date1904),H(z.cell,j,r),u=z}break;case 7:case 519:if(u)u.val=z,j=td(z,u.cell.ixfe,"s"),j.XF=ue[j.ixfe],r.cellFormula&&(j.f=""+en(u.formula,l,u.cell,K,U)),N>0&&(j.z=B[j.ixfe>>8&63]),Ps(j,r,e.opts.Date1904),H(u.cell,j,r),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{G.push(z);var Nt=yt(z[0].s);if(_=r.dense?(s[z[0].s.r]||[])[z[0].s.c]:s[Nt],r.cellFormula&&_){if(!u||!Nt||!_)break;_.f=""+en(z[1],l,z[0],K,U),_.F=Ot(z[0])}}break;case 1212:{if(!r.cellFormula)break;if(w){if(!u)break;L[yt(u.cell)]=z[0],_=r.dense?(s[u.cell.r]||[])[u.cell.c]:s[yt(u.cell)],(_||{}).f=""+en(z[0],l,v,K,U)}}break;case 253:j=td(f[z.isst].t,z.ixfe,"s"),f[z.isst].h&&(j.h=f[z.isst].h),j.XF=ue[j.ixfe],N>0&&(j.z=B[j.ixfe>>8&63]),Ps(j,r,e.opts.Date1904),H({c:z.c,r:z.r},j,r);break;case 513:r.sheetStubs&&(j={ixfe:z.ixfe,XF:ue[z.ixfe],t:"z"},N>0&&(j.z=B[j.ixfe>>8&63]),Ps(j,r,e.opts.Date1904),H({c:z.c,r:z.r},j,r));break;case 190:if(r.sheetStubs)for(var wt=z.c;wt<=z.C;++wt){var ft=z.ixfe[wt-z.c];j={ixfe:ft,XF:ue[ft],t:"z"},N>0&&(j.z=B[j.ixfe>>8&63]),Ps(j,r,e.opts.Date1904),H({c:wt,r:z.r},j,r)}break;case 214:case 516:case 4:j=td(z.val,z.ixfe,"s"),j.XF=ue[j.ixfe],N>0&&(j.z=B[j.ixfe>>8&63]),Ps(j,r,e.opts.Date1904),H({c:z.c,r:z.r},j,r);break;case 0:case 512:A===1&&(l=z);break;case 252:f=z;break;case 1054:if(U.biff==4){B[N++]=z[1];for(var Wt=0;Wt<N+163&&St[Wt]!=z[1];++Wt);Wt>=163&&Pi(z[1],N+163)}else Pi(z[1],z[0]);break;case 30:{B[N++]=z;for(var Dt=0;Dt<N+163&&St[Dt]!=z;++Dt);Dt>=163&&Pi(z,N+163)}break;case 229:ve=ve.concat(z);break;case 93:we[z.cmo[0]]=U.lastobj=z;break;case 438:U.lastobj.TxO=z;break;case 127:U.lastobj.ImData=z;break;case 440:for(y=z[0].s.r;y<=z[0].e.r;++y)for(b=z[0].s.c;b<=z[0].e.c;++b)_=r.dense?(s[y]||[])[b]:s[yt({c:b,r:y})],_&&(_.l=z[1]);break;case 2048:for(y=z[0].s.r;y<=z[0].e.r;++y)for(b=z[0].s.c;b<=z[0].e.c;++b)_=r.dense?(s[y]||[])[b]:s[yt({c:b,r:y})],_&&_.l&&(_.l.Tooltip=z[1]);break;case 28:{if(U.biff<=5&&U.biff>=2)break;_=r.dense?(s[z[0].r]||[])[z[0].c]:s[yt(z[0])];var Ft=we[z[2]];_||(r.dense?(s[z[0].r]||(s[z[0].r]=[]),_=s[z[0].r][z[0].c]={t:"z"}):_=s[yt(z[0])]={t:"z"},l.e.r=Math.max(l.e.r,z[0].r),l.s.r=Math.min(l.s.r,z[0].r),l.e.c=Math.max(l.e.c,z[0].c),l.s.c=Math.min(l.s.c,z[0].c)),_.c||(_.c=[]),k={a:z[1],t:Ft.TxO.t},_.c.push(k)}break;case 2173:WT(ue[z.ixfe],z.ext);break;case 125:{if(!U.cellStyles)break;for(;z.e>=z.s;)Ne[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},ae||(ae=!0,Ph(z.w/256)),Jo(Ne[z.e+1])}break;case 520:{var xt={};z.level!=null&&(he[z.r]=xt,xt.level=z.level),z.hidden&&(he[z.r]=xt,xt.hidden=!0),z.hpt&&(he[z.r]=xt,xt.hpt=z.hpt,xt.hpx=xc(z.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||oc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[fe]]=z;break;case 161:s["!margins"]||oc(s["!margins"]={}),s["!margins"].header=z.header,s["!margins"].footer=z.footer;break;case 574:z.RTL&&(V.Views[0].RTL=!0);break;case 146:D=z;break;case 2198:X=z;break;case 140:F=z;break;case 442:m?ee.CodeName=z||ee.name:V.WBProps.CodeName=z||"ThisWorkbook";break}}else le||console.error("Missing Info for XLS Record 0x"+fe.toString(16)),t.l+=I}return e.SheetNames=$s(o).sort(function(Et,Ze){return Number(Et)-Number(Ze)}).map(function(Et){return o[Et].name}),r.bookSheets||(e.Sheets=n),!e.SheetNames.length&&p["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=p)):e.Preamble=p,e.Sheets&&q.forEach(function(Et,Ze){e.Sheets[e.SheetNames[Ze]]["!autofilter"]=Et}),e.Strings=f,e.SSF=zr(St),U.enc&&(e.Encryption=U.enc),X&&(e.Themes=X),e.Metadata={},F!==void 0&&(e.Metadata.Country=F),K.names.length>0&&(V.Names=K.names),e.Workbook=V,e}var ax={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _3(t,r,e){var n=It.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=Vp(n,$2,ax.DSI);for(var o in s)r[o]=s[o]}catch(m){if(e.WTF)throw m}var l=It.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var u=Vp(l,U2,ax.SI);for(var f in u)r[f]==null&&(r[f]=u[f])}catch(m){if(e.WTF)throw m}r.HeadingPairs&&r.TitlesOfParts&&(Vv(r.HeadingPairs,r.TitlesOfParts,r,e),delete r.HeadingPairs,delete r.TitlesOfParts)}function k1(t,r){r||(r={}),Bh(r),ev(),r.codepage&&yh(r.codepage);var e,n;if(t.FullPaths){if(It.find(t,"/encryption"))throw new Error("File is password-protected");e=It.find(t,"!CompObj"),n=It.find(t,"/Workbook")||It.find(t,"/Book")}else{switch(r.type){case"base64":t=ys(Bn(t));break;case"binary":t=ys(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Hr(t,0),n={content:t}}var s,o;if(e&&v3(e),r.bookProps&&!r.bookSheets)s={};else{var l=Rt?"buffer":"array";if(n&&n.content)s=b3(n.content,r);else if((o=It.find(t,"PerfectOffice_MAIN"))&&o.content)s=ac.to_workbook(o.content,(r.type=l,r));else if((o=It.find(t,"NativeContent_MAIN"))&&o.content)s=ac.to_workbook(o.content,(r.type=l,r));else throw(o=It.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&t.FullPaths&&It.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=oN(t))}var u={};return t.FullPaths&&_3(t,u,r),s.Props=s.Custprops=u,r.bookFiles&&(s.cfb=t),s}var yd={0:{f:n4},1:{f:o4},2:{f:p4},3:{f:d4},4:{f:c4},5:{f:g4},6:{f:y4},7:{f:h4},8:{f:E4},9:{f:S4},10:{f:b4},11:{f:_4},12:{f:l4},13:{f:x4},14:{f:f4},15:{f:u4},16:{f:w1},17:{f:w4},18:{f:m4},19:{f:Ah},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Y4},40:{},42:{},43:{f:bT},44:{f:wT},45:{f:_T},46:{f:ET},47:{f:ST},48:{},49:{f:k2},50:{},51:{f:zT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:e1},62:{f:v4},63:{f:JT},64:{f:O4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:sn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:I4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:i4},148:{f:s4,p:16},151:{f:N4},152:{},153:{f:q4},154:{},155:{},156:{f:X4},157:{},158:{},159:{T:1,f:Uk},160:{T:-1},161:{T:1,f:Gi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:k4},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:HT},336:{T:-1},337:{f:GT,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Jf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Zv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:C4},427:{f:j4},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:R4},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:a4},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:T4},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Jf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:sN},633:{T:1},634:{T:-1},635:{T:1,f:nN},636:{T:-1},637:{f:N2},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:$4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:D4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},th={6:{f:jf},10:{f:Ga},12:{f:yr},13:{f:yr},14:{f:mr},15:{f:mr},16:{f:tn},17:{f:mr},18:{f:mr},19:{f:yr},20:{f:Gp},21:{f:Gp},23:{f:Zv},24:{f:Xp},25:{f:mr},26:{},27:{},28:{f:tk},29:{},34:{f:mr},35:{f:Kp},38:{f:tn},39:{f:tn},40:{f:tn},41:{f:tn},42:{f:mr},43:{f:mr},47:{f:aT},49:{f:PE},51:{f:yr},60:{},61:{f:OE},64:{f:mr},65:{f:FE},66:{f:yr},77:{},80:{},81:{},82:{},85:{f:yr},89:{},90:{},91:{},92:{f:kE},93:{f:nk},94:{},95:{f:mr},96:{},97:{},99:{f:mr},125:{f:e1},128:{f:GE},129:{f:TE},130:{f:yr},131:{f:mr},132:{f:mr},133:{f:NE},134:{},140:{f:ck},141:{f:yr},144:{},146:{f:dk},151:{},152:{},153:{},154:{},155:{},156:{f:yr},157:{},158:{},160:{f:pk},161:{f:hk},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:VE},190:{f:WE},193:{f:Ga},197:{},198:{},199:{},200:{},201:{},202:{f:mr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:yr},220:{},221:{f:mr},222:{},224:{f:zE},225:{f:EE},226:{f:Ga},227:{},229:{f:rk},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:CE},253:{f:LE},255:{f:jE},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Kv},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:mr},353:{f:Ga},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:XE},431:{f:mr},432:{},433:{},434:{},437:{},438:{f:ik},439:{f:mr},440:{f:ok},441:{},442:{f:Tc},443:{},444:{f:yr},445:{},446:{},448:{f:Ga},449:{f:IE,r:2},450:{f:Ga},512:{f:Hp},513:{f:gk},515:{f:KE},516:{f:ME},517:{f:zp},519:{f:xk},520:{f:AE},523:{},545:{f:qp},549:{f:Wp},566:{},574:{f:DE},638:{f:BE},659:{},1048:{},1054:{f:$E},1084:{},1212:{f:QE},2048:{f:lk},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Qu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ga},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:fk,r:12},2173:{f:VT,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:mr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:YE,r:12},2197:{},2198:{f:PT,r:12},2199:{},2200:{},2201:{},2202:{f:ZE,r:12},2203:{f:Ga},2204:{},2205:{},2206:{},2207:{},2211:{f:RE},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:yr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:mk},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:uk},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Hp},1:{},2:{f:bk},3:{f:wk},4:{f:yk},5:{f:zp},7:{f:_k},8:{},9:{f:Qu},11:{},22:{f:yr},30:{f:UE},31:{},32:{},33:{f:qp},36:{},37:{f:Wp},50:{f:Sk},62:{},52:{},67:{},68:{f:yr},69:{},86:{},126:{},127:{f:vk},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Ek},223:{},234:{},354:{},421:{},518:{f:jf},521:{f:Qu},536:{f:Xp},547:{f:Kp},561:{},579:{},1030:{f:jf},1033:{f:Qu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ps(t,r,e,n){var s=r;if(!isNaN(s)){var o=(e||[]).length||0,l=t.next(4);l.write_shift(2,s),l.write_shift(2,o),o>0&&Dv(e)&&t.push(e)}}function ix(t,r){var e=r||{},n=e.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),l=s.index,u=o&&o.index||t.length,f=KS(t.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,p=0,v=0,w=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(l=0;l<f.length;++l){var b=f[l].trim(),y=b.slice(0,3).toLowerCase();if(y=="<tr"){if(++m,e.sheetRows&&e.sheetRows<=m){--m;break}p=0;continue}if(!(y!="<td"&&y!="<th")){var L=b.split(/<\/t[dh]>/i);for(u=0;u<L.length;++u){var G=L[u].trim();if(G.match(/<t[dh]/i)){for(var j=G,F=0;j.charAt(0)=="<"&&(F=j.indexOf(">"))>-1;)j=j.slice(F+1);for(var ue=0;ue<k.length;++ue){var D=k[ue];D.s.c==p&&D.s.r<m&&m<=D.e.r&&(p=D.e.c+1,ue=-1)}var V=ht(G.slice(0,G.indexOf(">")));w=V.colspan?+V.colspan:1,((v=+V.rowspan)>1||w>1)&&k.push({s:{r:m,c:p},e:{r:m+(v||1)-1,c:p+w-1}});var ee=V.t||V["data-t"]||"";if(!j.length){p+=w;continue}if(j=bv(j),_.s.r>m&&(_.s.r=m),_.e.r<m&&(_.e.r=m),_.s.c>p&&(_.s.c=p),_.e.c<p&&(_.e.c=p),!j.length){p+=w;continue}var T={t:"s",v:j};e.raw||!j.trim().length||ee=="s"||(j==="TRUE"?T={t:"b",v:!0}:j==="FALSE"?T={t:"b",v:!1}:isNaN(_s(j))?isNaN(qo(j).getDate())||(T={t:"d",v:Mr(j)},e.cellDates||(T={t:"n",v:yn(T.v)}),T.z=e.dateNF||St[14]):T={t:"n",v:_s(j)}),e.dense?(n[m]||(n[m]=[]),n[m][p]=T):n[yt({r:m,c:p})]=T,p+=w}}}}return n["!ref"]=Ot(_),k.length&&(n["!merges"]=k),n}function S3(t,r,e,n){for(var s=t["!merges"]||[],o=[],l=r.s.c;l<=r.e.c;++l){for(var u=0,f=0,m=0;m<s.length;++m)if(!(s[m].s.r>e||s[m].s.c>l)&&!(s[m].e.r<e||s[m].e.c<l)){if(s[m].s.r<e||s[m].s.c<l){u=-1;break}u=s[m].e.r-s[m].s.r+1,f=s[m].e.c-s[m].s.c+1;break}if(!(u<0)){var p=yt({r:e,c:l}),v=n.dense?(t[e]||[])[l]:t[p],w=v&&v.v!=null&&(v.h||kh(v.w||(ma(v),v.w)||""))||"",_={};u>1&&(_.rowspan=u),f>1&&(_.colspan=f),n.editable?w='<span contenteditable="true">'+w+"</span>":v&&(_["data-t"]=v&&v.t||"z",v.v!=null&&(_["data-v"]=v.v),v.z!=null&&(_["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(w='<a href="'+v.l.Target+'">'+w+"</a>")),_.id=(n.id||"sjs")+"-"+p,o.push(c2("td",w,_))}}var k="<tr>";return k+o.join("")+"</tr>"}var E3='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',k3="</body></html>";function T3(t,r){var e=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return ni(ix(e[0],r),r);var n=Wh();return e.forEach(function(s,o){Hh(n,ix(s,r),"Sheet"+(o+1))}),n}function N3(t,r,e){var n=[];return n.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function C3(t,r){var e=r||{},n=e.header!=null?e.header:E3,s=e.footer!=null?e.footer:k3,o=[n],l=rl(t["!ref"]);e.dense=Array.isArray(t),o.push(N3(t,l,e));for(var u=l.s.r;u<=l.e.r;++u)o.push(S3(t,l,u,e));return o.push("</table>"+s),o.join("")}function T1(t,r,e){var n=e||{},s=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?xn(n.origin):n.origin;s=l.r,o=l.c}var u=r.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),m={s:{r:0,c:0},e:{r:s,c:o}};if(t["!ref"]){var p=rl(t["!ref"]);m.s.r=Math.min(m.s.r,p.s.r),m.s.c=Math.min(m.s.c,p.s.c),m.e.r=Math.max(m.e.r,p.e.r),m.e.c=Math.max(m.e.c,p.e.c),s==-1&&(m.e.r=s=p.e.r+1)}var v=[],w=0,_=t["!rows"]||(t["!rows"]=[]),k=0,b=0,y=0,L=0,G=0,j=0;for(t["!cols"]||(t["!cols"]=[]);k<u.length&&b<f;++k){var F=u[k];if(ox(F)){if(n.display)continue;_[b]={hidden:!0}}var ue=F.children;for(y=L=0;y<ue.length;++y){var D=ue[y];if(!(n.display&&ox(D))){var V=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):bv(D.innerHTML),ee=D.getAttribute("data-z")||D.getAttribute("z");for(w=0;w<v.length;++w){var T=v[w];T.s.c==L+o&&T.s.r<b+s&&b+s<=T.e.r&&(L=T.e.c+1-o,w=-1)}j=+D.getAttribute("colspan")||1,((G=+D.getAttribute("rowspan")||1)>1||j>1)&&v.push({s:{r:b+s,c:L+o},e:{r:b+s+(G||1)-1,c:L+o+(j||1)-1}});var O={t:"s",v:V},H=D.getAttribute("data-t")||D.getAttribute("t")||"";V!=null&&(V.length==0?O.t=H||"z":n.raw||V.trim().length==0||H=="s"||(V==="TRUE"?O={t:"b",v:!0}:V==="FALSE"?O={t:"b",v:!1}:isNaN(_s(V))?isNaN(qo(V).getDate())||(O={t:"d",v:Mr(V)},n.cellDates||(O={t:"n",v:yn(O.v)}),O.z=n.dateNF||St[14]):O={t:"n",v:_s(V)})),O.z===void 0&&ee!=null&&(O.z=ee);var U="",X=D.getElementsByTagName("A");if(X&&X.length)for(var ve=0;ve<X.length&&!(X[ve].hasAttribute("href")&&(U=X[ve].getAttribute("href"),U.charAt(0)!="#"));++ve);U&&U.charAt(0)!="#"&&(O.l={Target:U}),n.dense?(t[b+s]||(t[b+s]=[]),t[b+s][L+o]=O):t[yt({c:L+o,r:b+s})]=O,m.e.c<L+o&&(m.e.c=L+o),L+=j}}++b}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),m.e.r=Math.max(m.e.r,b-1+s),t["!ref"]=Ot(m),b>=f&&(t["!fullref"]=Ot((m.e.r=u.length-k+b-1+s,m))),t}function N1(t,r){var e=r||{},n=e.dense?[]:{};return T1(n,t,r)}function j3(t,r){return ni(N1(t,r),r)}function ox(t){var r="",e=A3(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function A3(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function R3(t){var r=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=Lt(r.replace(/<[^>]*>/g,""));return[e]}var lx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function C1(t,r){var e=r||{},n=Th(t),s=[],o,l,u={name:""},f="",m=0,p,v,w={},_=[],k=e.dense?[]:{},b,y,L={value:""},G="",j=0,F=[],ue=-1,D=-1,V={s:{r:1e6,c:1e7},e:{r:0,c:0}},ee=0,T={},O=[],H={},U=0,X=0,ve=[],we=1,Ne=1,he=[],ae={Names:[]},K={},oe=["",""],A=[],N={},B="",q=0,ne=!1,pe=!1,te=0;for(mc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=mc.exec(n);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(V.e.c>=V.s.c&&V.e.r>=V.s.r?k["!ref"]=Ot(V):k["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=V.e.r&&(k["!fullref"]=k["!ref"],V.e.r=e.sheetRows-1,k["!ref"]=Ot(V)),O.length&&(k["!merges"]=O),ve.length&&(k["!rows"]=ve),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),_.push(p.name),w[p.name]=k,pe=!1):b[0].charAt(b[0].length-2)!=="/"&&(p=ht(b[0],!1),ue=D=-1,V.s.r=V.s.c=1e7,V.e.r=V.e.c=0,k=e.dense?[]:{},O=[],ve=[],pe=!0);break;case"table-row-group":b[1]==="/"?--ee:++ee;break;case"table-row":case"":if(b[1]==="/"){ue+=we,we=1;break}if(v=ht(b[0],!1),v.?ue=v.-1:ue==-1&&(ue=0),we=+v["number-rows-repeated"]||1,we<10)for(te=0;te<we;++te)ee>0&&(ve[ue+te]={level:ee});D=-1;break;case"covered-table-cell":b[1]!=="/"&&++D,e.sheetStubs&&(e.dense?(k[ue]||(k[ue]=[]),k[ue][D]={t:"z"}):k[yt({r:ue,c:D})]={t:"z"}),G="",F=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++D,L=ht(b[0],!1),Ne=parseInt(L["number-columns-repeated"]||"1",10),y={t:"z",v:null},L.formula&&e.cellFormula!=!1&&(y.f=rx(Lt(L.formula))),(L.||L["value-type"])=="string"&&(y.t="s",y.v=Lt(L["string-value"]||""),e.dense?(k[ue]||(k[ue]=[]),k[ue][D]=y):k[yt({r:ue,c:D})]=y),D+=Ne-1;else if(b[1]!=="/"){++D,G="",j=0,F=[],Ne=1;var fe=we?ue+we-1:ue;if(D>V.e.c&&(V.e.c=D),D<V.s.c&&(V.s.c=D),ue<V.s.r&&(V.s.r=ue),fe>V.e.r&&(V.e.r=fe),L=ht(b[0],!1),A=[],N={},y={t:L.||L["value-type"],v:null},e.cellFormula)if(L.formula&&(L.formula=Lt(L.formula)),L["number-matrix-columns-spanned"]&&L["number-matrix-rows-spanned"]&&(U=parseInt(L["number-matrix-rows-spanned"],10)||0,X=parseInt(L["number-matrix-columns-spanned"],10)||0,H={s:{r:ue,c:D},e:{r:ue+U-1,c:D+X-1}},y.F=Ot(H),he.push([H,y.F])),L.formula)y.f=rx(L.formula);else for(te=0;te<he.length;++te)ue>=he[te][0].s.r&&ue<=he[te][0].e.r&&D>=he[te][0].s.c&&D<=he[te][0].e.c&&(y.F=he[te][1]);switch((L["number-columns-spanned"]||L["number-rows-spanned"])&&(U=parseInt(L["number-rows-spanned"],10)||0,X=parseInt(L["number-columns-spanned"],10)||0,H={s:{r:ue,c:D},e:{r:ue+U-1,c:D+X-1}},O.push(H)),L["number-columns-repeated"]&&(Ne=parseInt(L["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=er(L["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(L.value);break;case"percentage":y.t="n",y.v=parseFloat(L.value);break;case"currency":y.t="n",y.v=parseFloat(L.value);break;case"date":y.t="d",y.v=Mr(L["date-value"]),e.cellDates||(y.t="n",y.v=yn(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=HS(L["time-value"])/86400,e.cellDates&&(y.t="d",y.v=kd(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(L.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",L["string-value"]!=null&&(G=Lt(L["string-value"]),F=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(ne=!1,y.t==="s"&&(y.v=G||"",F.length&&(y.R=F),ne=j==0),K.Target&&(y.l=K),A.length>0&&(y.c=A,A=[]),G&&e.cellText!==!1&&(y.w=G),ne&&(y.t="z",delete y.v),(!ne||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=ue))for(var I=0;I<we;++I){if(Ne=parseInt(L["number-columns-repeated"]||"1",10),e.dense)for(k[ue+I]||(k[ue+I]=[]),k[ue+I][D]=I==0?y:zr(y);--Ne>0;)k[ue+I][D+Ne]=zr(y);else for(k[yt({r:ue+I,c:D})]=y;--Ne>0;)k[yt({r:ue+I,c:D+Ne})]=zr(y);V.e.c<=D&&(V.e.c=D)}Ne=parseInt(L["number-columns-repeated"]||"1",10),D+=Ne-1,Ne=0,y={},G="",F=[]}K={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((o=s.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&s.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((o=s.pop())[0]!==b[3])throw"Bad state: "+o;N.t=G,F.length&&(N.R=F),N.a=B,A.push(N)}else b[0].charAt(b[0].length-2)!=="/"&&s.push([b[3],!1]);B="",q=0,G="",j=0,F=[];break;case"creator":b[1]==="/"?B=n.slice(q,b.index):q=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((o=s.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&s.push([b[3],!1]);G="",j=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(T[u.name]=f,(o=s.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&(f="",u=ht(b[0],!1),s.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":l=ht(b[0],!1),f+=lx[b[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":l=ht(b[0],!1),f+=lx[b[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(m,b.index);break}else m=b.index+b[0].length;break;case"named-range":l=ht(b[0],!1),oe=Af(l["cell-range-address"]);var le={Name:l.name,Ref:oe[0]+"!"+oe[1]};pe&&(le.Sheet=_.length),ae.Names.push(le);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(b[1]==="/"&&(!L||!L["string-value"])){var se=R3(n.slice(j,b.index));G=(G.length>0?G+`
`:"")+se[0]}else ht(b[0],!1),j=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{oe=Af(ht(b[0])["target-range-address"]),w[oe[0]]["!autofilter"]={ref:oe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(K=ht(b[0],!1),!K.href)break;K.Target=Lt(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(oe=Af(K.Target.slice(1)),K.Target="#"+oe[0]+"!"+oe[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(e.WTF)throw new Error(b)}}var z={Sheets:w,SheetNames:_,Workbook:ae};return e.bookSheets&&delete z.Sheets,z}function cx(t,r){r=r||{},ns(t,"META-INF/manifest.xml")&&K2(vr(t,"META-INF/manifest.xml"),r);var e=Un(t,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var n=C1(Yt(e),r);return ns(t,"meta.xml")&&(n.Props=Bv(vr(t,"meta.xml"))),n}function ux(t,r){return C1(t,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function $h(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function rh(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Yt(Hi(t))}function nh(t){var r=t.reduce(function(s,o){return s+o.length},0),e=new Uint8Array(r),n=0;return t.forEach(function(s){e.set(s,n),n+=s.length}),e}function dx(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function I3(t,r){for(var e=(t[r+15]&127)<<7|t[r+14]>>1,n=t[r+14]&1,s=r+13;s>=r;--s)n=n*256+t[s];return(t[r+15]&128?-n:n)*Math.pow(10,e-6176)}function vc(t,r){var e=r?r[0]:0,n=t[e]&127;e:if(t[e++]>=128&&(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return r&&(r[0]=e),n}function Ar(t){var r=0,e=t[r]&127;e:if(t[r++]>=128){if(e|=(t[r]&127)<<7,t[r++]<128||(e|=(t[r]&127)<<14,t[r++]<128)||(e|=(t[r]&127)<<21,t[r++]<128))break e;e|=(t[r]&127)<<28}return e}function rn(t){for(var r=[],e=[0];e[0]<t.length;){var n=e[0],s=vc(t,e),o=s&7;s=Math.floor(s/8);var l=0,u;if(s==0)break;switch(o){case 0:{for(var f=e[0];t[e[0]++]>=128;);u=t.slice(f,e[0])}break;case 5:l=4,u=t.slice(e[0],e[0]+l),e[0]+=l;break;case 1:l=8,u=t.slice(e[0],e[0]+l),e[0]+=l;break;case 2:l=vc(t,e),u=t.slice(e[0],e[0]+l),e[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(s," at offset ").concat(n))}var m={data:u,type:o};r[s]==null?r[s]=[m]:r[s].push(m)}return r}function Uh(t,r){return t?.map(function(e){return r(e.data)})||[]}function O3(t){for(var r,e=[],n=[0];n[0]<t.length;){var s=vc(t,n),o=rn(t.slice(n[0],n[0]+s));n[0]+=s;var l={id:Ar(o[1][0].data),messages:[]};o[2].forEach(function(u){var f=rn(u.data),m=Ar(f[3][0].data);l.messages.push({meta:f,data:t.slice(n[0],n[0]+m)}),n[0]+=m}),(r=o[3])!=null&&r[0]&&(l.merge=Ar(o[3][0].data)>>>0>0),e.push(l)}return e}function D3(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],n=vc(r,e),s=[];e[0]<r.length;){var o=r[e[0]]&3;if(o==0){var l=r[e[0]++]>>2;if(l<60)++l;else{var u=l-59;l=r[e[0]],u>1&&(l|=r[e[0]+1]<<8),u>2&&(l|=r[e[0]+2]<<16),u>3&&(l|=r[e[0]+3]<<24),l>>>=0,l++,e[0]+=u}s.push(r.slice(e[0],e[0]+l)),e[0]+=l;continue}else{var f=0,m=0;if(o==1?(m=(r[e[0]]>>2&7)+4,f=(r[e[0]++]&224)<<3,f|=r[e[0]++]):(m=(r[e[0]++]>>2)+1,o==2?(f=r[e[0]]|r[e[0]+1]<<8,e[0]+=2):(f=(r[e[0]]|r[e[0]+1]<<8|r[e[0]+2]<<16|r[e[0]+3]<<24)>>>0,e[0]+=4)),s=[nh(s)],f==0)throw new Error("Invalid offset 0");if(f>s[0].length)throw new Error("Invalid offset beyond length");if(m>=f)for(s.push(s[0].slice(-f)),m-=f;m>=s[s.length-1].length;)s.push(s[s.length-1]),m-=s[s.length-1].length;s.push(s[0].slice(-f,-f+m))}}var p=nh(s);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function F3(t){for(var r=[],e=0;e<t.length;){var n=t[e++],s=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,r.push(D3(n,t.slice(e,e+s))),e+=s}if(e!==t.length)throw new Error("data is not a valid framed stream!");return nh(r)}function P3(t,r,e,n){var s=$h(t),o=s.getUint32(4,!0),l=(n>1?12:8)+dx(o&(n>1?3470:398))*4,u=-1,f=-1,m=NaN,p=new Date(2001,0,1);o&512&&(u=s.getUint32(l,!0),l+=4),l+=dx(o&(n>1?12288:4096))*4,o&16&&(f=s.getUint32(l,!0),l+=4),o&32&&(m=s.getFloat64(l,!0),l+=8),o&64&&(p.setTime(p.getTime()+s.getFloat64(l,!0)*1e3),l+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:m};break;case 3:v={t:"s",v:r[f]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:e[u]};else if(f>-1)v={t:"s",v:r[f]};else if(!isNaN(m))v={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function L3(t,r,e){var n=$h(t),s=n.getUint32(8,!0),o=12,l=-1,u=-1,f=NaN,m=NaN,p=new Date(2001,0,1);s&1&&(f=I3(t,o),o+=16),s&2&&(m=n.getFloat64(o,!0),o+=8),s&4&&(p.setTime(p.getTime()+n.getFloat64(o,!0)*1e3),o+=8),s&8&&(u=n.getUint32(o,!0),o+=4),s&16&&(l=n.getUint32(o,!0),o+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:f};break;case 3:v={t:"s",v:r[u]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:e[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return v}function M3(t,r,e){switch(t[0]){case 0:case 1:case 2:case 3:return P3(t,r,e,t[0]);case 5:return L3(t,r,e);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Qa(t){var r=rn(t);return vc(r[1][0].data)}function fx(t,r){var e=rn(r.data),n=Ar(e[1][0].data),s=e[3],o=[];return(s||[]).forEach(function(l){var u=rn(l.data),f=Ar(u[1][0].data)>>>0;switch(n){case 1:o[f]=rh(u[3][0].data);break;case 8:{var m=t[Qa(u[9][0].data)][0],p=rn(m.data),v=t[Qa(p[1][0].data)][0],w=Ar(v.meta[1][0].data);if(w!=2001)throw new Error("2000 unexpected reference to ".concat(w));var _=rn(v.data);o[f]=_[3].map(function(k){return rh(k.data)}).join("")}break}}),o}function $3(t,r){var e,n,s,o,l,u,f,m,p,v,w,_,k,b,y=rn(t),L=Ar(y[1][0].data)>>>0,G=Ar(y[2][0].data)>>>0,j=((n=(e=y[8])==null?void 0:e[0])==null?void 0:n.data)&&Ar(y[8][0].data)>0||!1,F,ue;if((o=(s=y[7])==null?void 0:s[0])!=null&&o.data&&r!=0)F=(u=(l=y[7])==null?void 0:l[0])==null?void 0:u.data,ue=(m=(f=y[6])==null?void 0:f[0])==null?void 0:m.data;else if((v=(p=y[4])==null?void 0:p[0])!=null&&v.data&&r!=1)F=(_=(w=y[4])==null?void 0:w[0])==null?void 0:_.data,ue=(b=(k=y[3])==null?void 0:k[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var D=j?4:1,V=$h(F),ee=[],T=0;T<F.length/2;++T){var O=V.getUint16(T*2,!0);O<65535&&ee.push([T,O])}if(ee.length!=G)throw"Expected ".concat(G," cells, found ").concat(ee.length);var H=[];for(T=0;T<ee.length-1;++T)H[ee[T][0]]=ue.subarray(ee[T][1]*D,ee[T+1][1]*D);return ee.length>=1&&(H[ee[ee.length-1][0]]=ue.subarray(ee[ee.length-1][1]*D)),{R:L,cells:H}}function U3(t,r){var e,n=rn(r.data),s=(e=n?.[7])!=null&&e[0]?Ar(n[7][0].data)>>>0>0?1:0:-1,o=Uh(n[5],function(l){return $3(l,s)});return{nrows:Ar(n[4][0].data)>>>0,data:o.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(f,m){if(l[u.R][m])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(m));l[u.R][m]=f}),l},[])}}function B3(t,r,e){var n,s=rn(r.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Ar(s[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(o.e.c=(Ar(s[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));e["!ref"]=Ot(o);var l=rn(s[4][0].data),u=fx(t,t[Qa(l[4][0].data)][0]),f=(n=l[17])!=null&&n[0]?fx(t,t[Qa(l[17][0].data)][0]):[],m=rn(l[3][0].data),p=0;m[1].forEach(function(v){var w=rn(v.data),_=t[Qa(w[2][0].data)][0],k=Ar(_.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var b=U3(t,_);b.data.forEach(function(y,L){y.forEach(function(G,j){var F=yt({r:p+L,c:j}),ue=M3(G,u,f);ue&&(e[F]=ue)})}),p+=b.nrows})}function V3(t,r){var e=rn(r.data),n={"!ref":"A1"},s=t[Qa(e[2][0].data)],o=Ar(s[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return B3(t,s[0],n),n}function W3(t,r){var e,n=rn(r.data),s={name:(e=n[1])!=null&&e[0]?rh(n[1][0].data):"",sheets:[]},o=Uh(n[2],Qa);return o.forEach(function(l){t[l].forEach(function(u){var f=Ar(u.meta[1][0].data);f==6e3&&s.sheets.push(V3(t,u))})}),s}function H3(t,r){var e=Wh(),n=rn(r.data),s=Uh(n[1],Qa);if(s.forEach(function(o){t[o].forEach(function(l){var u=Ar(l.meta[1][0].data);if(u==2){var f=W3(t,l);f.sheets.forEach(function(m,p){Hh(e,m,p==0?f.name:f.name+"_"+p,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function If(t){var r,e,n,s,o={},l=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var m;try{m=F3(f.content)}catch(v){return console.log("?? "+f.content.length+" "+(v.message||v))}var p;try{p=O3(m)}catch(v){return console.log("## "+(v.message||v))}p.forEach(function(v){o[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var u=((s=(n=(e=(r=o?.[1])==null?void 0:r[0])==null?void 0:e.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Ar(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||l.forEach(function(f){o[f].forEach(function(m){var p=Ar(m.meta[1][0].data)>>>0;if(p==1)if(!u)u=m;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return H3(o,u)}function z3(t){return function(e){for(var n=0;n!=t.length;++n){var s=t[n];e[s[0]]===void 0&&(e[s[0]]=s[1]),s[2]==="n"&&(e[s[0]]=Number(e[s[0]]))}}}function Bh(t){z3([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function G3(t){return Ho.WS.indexOf(t)>-1?"sheet":t==Ho.CS?"chart":t==Ho.DS?"dialog":t==Ho.MS?"macro":t&&t.length?t:"sheet"}function K3(t,r){if(!t)return 0;try{t=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,G3(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function X3(t,r,e,n,s,o,l,u,f,m,p,v){try{o[n]=nc(Un(t,e,!0),r);var w=vr(t,r),_;switch(u){case"sheet":_=e3(w,r,s,f,o[n],m,p,v);break;case"chart":if(_=t3(w,r,s,f,o[n],m,p,v),!_||!_["!drawel"])break;var k=ql(_["!drawel"].Target,r),b=Yf(k),y=ZT(Un(t,k,!0),nc(Un(t,b,!0),k)),L=ql(y,k),G=Yf(L);_=L4(Un(t,L,!0),L,f,nc(Un(t,G,!0),L),m,_);break;case"macro":_=r3(w,r,s,f,o[n],m,p,v);break;case"dialog":_=n3(w,r,s,f,o[n],m,p,v);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=_;var j=[];o&&o[n]&&$s(o[n]).forEach(function(F){var ue="";if(o[n][F].Type==Ho.CMNT){ue=ql(o[n][F].Target,r);var D=o3(vr(t,ue,!0),ue,f);if(!D||!D.length)return;Yp(_,D,!1)}o[n][F].Type==Ho.TCMNT&&(ue=ql(o[n][F].Target,r),j=j.concat(tN(vr(t,ue,!0),f)))}),j&&j.length&&Yp(_,j,!0,f.people||[])}catch(F){if(f.WTF)throw F}}function es(t){return t.charAt(0)=="/"?t.slice(1):t}function q3(t,r){if(fv(),r=r||{},Bh(r),ns(t,"META-INF/manifest.xml")||ns(t,"objectdata.xml"))return cx(t,r);if(ns(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof If<"u"){if(t.FileIndex)return If(t);var e=It.utils.cfb_new();return Ep(t).forEach(function(ve){JS(e,ve,qS(t,ve))}),If(e)}throw new Error("Unsupported NUMBERS file")}if(!ns(t,"[Content_Types].xml"))throw ns(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ns(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Ep(t),s=z2(Un(t,"[Content_Types].xml")),o=!1,l,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",vr(t,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!vr(t,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),o=!0}s.workbooks[0].slice(-3)=="bin"&&(o=!0);var f={},m={};if(!r.bookSheets&&!r.bookProps){if(ic=[],s.sst)try{ic=i3(vr(t,es(s.sst)),s.sst,r)}catch(ve){if(r.WTF)throw ve}r.cellStyles&&s.themes.length&&(f=a3(Un(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],r)),s.style&&(m=s3(vr(t,es(s.style)),s.style,f,r))}s.links.map(function(ve){try{var we=nc(Un(t,Yf(es(ve))),ve);return c3(vr(t,es(ve)),we,ve,r)}catch{}});var p=Z4(vr(t,es(s.workbooks[0])),s.workbooks[0],r),v={},w="";s.coreprops.length&&(w=vr(t,es(s.coreprops[0]),!0),w&&(v=Bv(w)),s.extprops.length!==0&&(w=vr(t,es(s.extprops[0]),!0),w&&J2(w,v,r)));var _={};(!r.bookSheets||r.bookProps)&&s.custprops.length!==0&&(w=Un(t,es(s.custprops[0]),!0),w&&(_=Q2(w,r)));var k={};if((r.bookSheets||r.bookProps)&&(p.Sheets?l=p.Sheets.map(function(we){return we.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),r.bookProps&&(k.Props=v,k.Custprops=_),r.bookSheets&&typeof l<"u"&&(k.SheetNames=l),r.bookSheets?k.SheetNames:r.bookProps))return k;l={};var b={};r.bookDeps&&s.calcchain&&(b=l3(vr(t,es(s.calcchain)),s.calcchain));var y=0,L={},G,j;{var F=p.Sheets;v.Worksheets=F.length,v.SheetNames=[];for(var ue=0;ue!=F.length;++ue)v.SheetNames[ue]=F[ue].name}var D=o?"bin":"xml",V=s.workbooks[0].lastIndexOf("/"),ee=(s.workbooks[0].slice(0,V+1)+"_rels/"+s.workbooks[0].slice(V+1)+".rels").replace(/^\//,"");ns(t,ee)||(ee="xl/_rels/workbook."+D+".rels");var T=nc(Un(t,ee,!0),ee.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(r.xlmeta=u3(vr(t,es(s.metadata[0])),s.metadata[0],r)),(s.people||[]).length>=1&&(r.people=rN(vr(t,es(s.people[0])),r)),T&&(T=K3(T,p.Sheets));var O=vr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=v.Worksheets;++y){var H="sheet";if(T&&T[y]?(G="xl/"+T[y][1].replace(/[\/]?xl\//,""),ns(t,G)||(G=T[y][1]),ns(t,G)||(G=ee.replace(/_rels\/.*$/,"")+T[y][1]),H=T[y][2]):(G="xl/worksheets/sheet"+(y+1-O)+"."+D,G=G.replace(/sheet0\./,"sheet.")),j=G.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(y!=r.sheets)continue e;break;case"string":if(v.SheetNames[y].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var U=!1,X=0;X!=r.sheets.length;++X)typeof r.sheets[X]=="number"&&r.sheets[X]==y&&(U=1),typeof r.sheets[X]=="string"&&r.sheets[X].toLowerCase()==v.SheetNames[y].toLowerCase()&&(U=1);if(!U)continue e}}X3(t,G,j,v.SheetNames[y],y,L,l,H,r,p,f,m)}return k={Directory:s,Workbook:p,Props:v,Custprops:_,Deps:b,Sheets:l,SheetNames:v.SheetNames,Strings:ic,Styles:m,Themes:f,SSF:zr(St)},r&&r.bookFiles&&(t.files?(k.keys=n,k.files=t.files):(k.keys=[],k.files={},t.FullPaths.forEach(function(ve,we){ve=ve.replace(/^Root Entry[\/]/,""),k.keys.push(ve),k.files[ve]=t.FileIndex[we]}))),r&&r.bookVBA&&(s.vba.length>0?k.vbaraw=vr(t,es(s.vba[0]),!0):s.defaults&&s.defaults.bin===iN&&(k.vbaraw=vr(t,"xl/vbaProject.bin",!0))),k}function J3(t,r){var e=r||{},n="Workbook",s=It.find(t,n);try{if(n="/!DataSpaces/Version",s=It.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Vk(s.content),n="/!DataSpaces/DataSpaceMap",s=It.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Hk(s.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=It.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=zk(s.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=It.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Kk(s.content)}catch{}if(n="/EncryptionInfo",s=It.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=Xk(s.content);if(n="/EncryptedPackage",s=It.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,e.password||"",e);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,e.password||"",e);throw new Error("File is password-protected")}function Vh(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=Bn(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function Y3(t,r){return It.find(t,"EncryptedPackage")?J3(t,r):k1(t,r)}function Q3(t,r){var e,n=t,s=r||{};return s.type||(s.type=Rt&&Buffer.isBuffer(t)?"buffer":"base64"),e=vv(n,s),q3(e,s)}function j1(t,r){var e=0;e:for(;e<t.length;)switch(t.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return eh(t.slice(e),r);default:break e}return gc.to_workbook(t,r)}function Z3(t,r){var e="",n=Vh(t,r);switch(r.type){case"base64":e=Bn(t);break;case"binary":e=t;break;case"buffer":e=t.toString("binary");break;case"array":e=$i(t);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(e=Yt(e)),r.type="binary",j1(e,r)}function ej(t,r){var e=t;return r.type=="base64"&&(e=Bn(e)),e=dc.utils.decode(1200,e.slice(2),"str"),r.type="binary",j1(e,r)}function tj(t){return t.match(/[^\x00-\x7F]/)?Jl(t):t}function Of(t,r,e,n){return n?(e.type="string",gc.to_workbook(t,e)):gc.to_workbook(r,e)}function wd(t,r){ev();var e=r||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return wd(new Uint8Array(t),(e=zr(e),e.type="array",e));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],o=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),Ko={},e.dateNF&&(Ko.dateNF=e.dateNF),e.type||(e.type=Rt&&Buffer.isBuffer(t)?"buffer":"base64"),e.type=="file"&&(e.type=Rt?"buffer":"binary",n=VS(t),typeof Uint8Array<"u"&&!Rt&&(e.type="array")),e.type=="string"&&(o=!0,e.type="binary",e.codepage=65001,n=tj(t)),e.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return e=zr(e),e.type="array",wd(wh(n),e)}switch((s=Vh(n,e))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Y3(It.read(n,e),e);break;case 9:if(s[1]<=8)return k1(n,e);break;case 60:return eh(n,e);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return jk(n,e);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Nk.to_workbook(n,e);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Q3(n,e):Of(t,n,e,o);case 239:return s[3]===60?eh(n,e):Of(t,n,e,o);case 255:if(s[1]===254)return ej(n,e);if(s[1]===0&&s[2]===2&&s[3]===0)return ac.to_workbook(n,e);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ac.to_workbook(n,e);break;case 3:case 131:case 139:case 140:return Jp.to_workbook(n,e);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return iT.to_workbook(n,e);break;case 10:case 13:case 32:return Z3(n,e);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return kk.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Jp.to_workbook(n,e):Of(t,n,e,o)}function rj(t,r,e,n,s,o,l,u){var f=Gr(e),m=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,w=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(w,"__rowNum__",{value:e,enumerable:!1})}catch{w.__rowNum__=e}else w.__rowNum__=e;if(!l||t[e])for(var _=r.s.c;_<=r.e.c;++_){var k=l?t[e][_]:t[n[_]+f];if(k===void 0||k.t===void 0){if(m===void 0)continue;o[_]!=null&&(w[o[_]]=m);continue}var b=k.v;switch(k.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(o[_]!=null){if(b==null)if(k.t=="e"&&b===null)w[o[_]]=null;else if(m!==void 0)w[o[_]]=m;else if(p&&b===null)w[o[_]]=null;else continue;else w[o[_]]=p&&(k.t!=="n"||k.t==="n"&&u.rawNumbers!==!1)?b:ma(k,b,u);b!=null&&(v=!1)}}return{row:w,isempty:v}}function sh(t,r){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},n=0,s=1,o=[],l=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},m=r||{},p=m.range!=null?m.range:t["!ref"];switch(m.header===1?n=1:m.header==="A"?n=2:Array.isArray(m.header)?n=3:m.header==null&&(n=0),typeof p){case"string":f=cr(p);break;case"number":f=cr(t["!ref"]),f.s.r=p;break;default:f=p}n>0&&(s=0);var v=Gr(f.s.r),w=[],_=[],k=0,b=0,y=Array.isArray(t),L=f.s.r,G=0,j={};y&&!t[L]&&(t[L]=[]);var F=m.skipHidden&&t["!cols"]||[],ue=m.skipHidden&&t["!rows"]||[];for(G=f.s.c;G<=f.e.c;++G)if(!(F[G]||{}).hidden)switch(w[G]=jr(G),e=y?t[L][G]:t[w[G]+v],n){case 1:o[G]=G-f.s.c;break;case 2:o[G]=w[G];break;case 3:o[G]=m.header[G-f.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),u=l=ma(e,null,m),b=j[l]||0,!b)j[l]=1;else{do u=l+"_"+b++;while(j[u]);j[l]=b,j[u]=1}o[G]=u}for(L=f.s.r+s;L<=f.e.r;++L)if(!(ue[L]||{}).hidden){var D=rj(t,f,L,w,n,o,y,m);(D.isempty===!1||(n===1?m.blankrows!==!1:m.blankrows))&&(_[k++]=D.row)}return _.length=k,_}var hx=/"/g;function nj(t,r,e,n,s,o,l,u){for(var f=!0,m=[],p="",v=Gr(e),w=r.s.c;w<=r.e.c;++w)if(n[w]){var _=u.dense?(t[e]||[])[w]:t[n[w]+v];if(_==null)p="";else if(_.v!=null){f=!1,p=""+(u.rawNumbers&&_.t=="n"?_.v:ma(_,null,u));for(var k=0,b=0;k!==p.length;++k)if((b=p.charCodeAt(k))===s||b===o||b===34||u.forceQuotes){p='"'+p.replace(hx,'""')+'"';break}p=="ID"&&(p='"ID"')}else _.f!=null&&!_.F?(f=!1,p="="+_.f,p.indexOf(",")>=0&&(p='"'+p.replace(hx,'""')+'"')):p="";m.push(p)}return u.blankrows===!1&&f?null:m.join(l)}function A1(t,r){var e=[],n=r??{};if(t==null||t["!ref"]==null)return"";var s=cr(t["!ref"]),o=n.FS!==void 0?n.FS:",",l=o.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),m=new RegExp((o=="|"?"\\|":o)+"+$"),p="",v=[];n.dense=Array.isArray(t);for(var w=n.skipHidden&&t["!cols"]||[],_=n.skipHidden&&t["!rows"]||[],k=s.s.c;k<=s.e.c;++k)(w[k]||{}).hidden||(v[k]=jr(k));for(var b=0,y=s.s.r;y<=s.e.r;++y)(_[y]||{}).hidden||(p=nj(t,s,y,v,l,f,o,n),p!=null&&(n.strip&&(p=p.replace(m,"")),(p||n.blankrows!==!1)&&e.push((b++?u:"")+p)));return delete n.dense,e.join("")}function sj(t,r){r||(r={}),r.FS="	",r.RS=`
`;var e=A1(t,r);return e}function aj(t){var r="",e,n="";if(t==null||t["!ref"]==null)return[];var s=cr(t["!ref"]),o="",l=[],u,f=[],m=Array.isArray(t);for(u=s.s.c;u<=s.e.c;++u)l[u]=jr(u);for(var p=s.s.r;p<=s.e.r;++p)for(o=Gr(p),u=s.s.c;u<=s.e.c;++u)if(r=l[u]+o,e=m?(t[p]||[])[u]:t[r],n="",e!==void 0){if(e.F!=null){if(r=e.F,!e.f)continue;n=e.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(e.f!=null)n=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)n=""+e.v;else if(e.t=="b")n=e.v?"TRUE":"FALSE";else if(e.w!==void 0)n="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?n="'"+e.v:n=""+e.v}}f[f.length]=r+"="+n}return f}function R1(t,r,e){var n=e||{},s=+!n.skipHeader,o=t||{},l=0,u=0;if(o&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?xn(n.origin):n.origin;l=f.r,u=f.c}var m,p={s:{c:0,r:0},e:{c:u,r:l+r.length-1+s}};if(o["!ref"]){var v=cr(o["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),l==-1&&(l=v.e.r+1,p.e.r=l+r.length-1+s)}else l==-1&&(l=0,p.e.r=r.length-1+s);var w=n.header||[],_=0;r.forEach(function(b,y){$s(b).forEach(function(L){(_=w.indexOf(L))==-1&&(w[_=w.length]=L);var G=b[L],j="z",F="",ue=yt({c:u+_,r:l+y+s});m=yc(o,ue),G&&typeof G=="object"&&!(G instanceof Date)?o[ue]=G:(typeof G=="number"?j="n":typeof G=="boolean"?j="b":typeof G=="string"?j="s":G instanceof Date?(j="d",n.cellDates||(j="n",G=yn(G)),F=n.dateNF||St[14]):G===null&&n.nullError&&(j="e",G=0),m?(m.t=j,m.v=G,delete m.w,delete m.R,F&&(m.z=F)):o[ue]=m={t:j,v:G},F&&(m.z=F))})}),p.e.c=Math.max(p.e.c,u+w.length-1);var k=Gr(l);if(s)for(_=0;_<w.length;++_)o[jr(_+u)+k]={t:"s",v:w[_]};return o["!ref"]=Ot(p),o}function ij(t,r){return R1(null,t,r)}function yc(t,r,e){if(typeof r=="string"){if(Array.isArray(t)){var n=xn(r);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?yc(t,yt(r)):yc(t,yt({r,c:e||0}))}function oj(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Wh(){return{SheetNames:[],Sheets:{}}}function Hh(t,r,e,n){var s=1;if(!e)for(;s<=65535&&t.SheetNames.indexOf(e="Sheet"+s)!=-1;++s,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(e)>=0){var o=e.match(/(^.*?)(\d+)$/);s=o&&+o[2]||0;var l=o&&o[1]||e;for(++s;s<=65535&&t.SheetNames.indexOf(e=l+s)!=-1;++s);}if(z4(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function lj(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=oj(t,r);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[n].Hidden=e}function cj(t,r){return t.z=r,t}function I1(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}function uj(t,r,e){return I1(t,"#"+r,e)}function dj(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})}function fj(t,r,e,n){for(var s=typeof r!="string"?r:cr(r),o=typeof r=="string"?r:Ot(r),l=s.s.r;l<=s.e.r;++l)for(var u=s.s.c;u<=s.e.c;++u){var f=yc(t,l,u);f.t="n",f.F=o,delete f.v,l==s.s.r&&u==s.s.c&&(f.f=e,n&&(f.D=!0))}return t}var mx={encode_col:jr,encode_row:Gr,encode_cell:yt,encode_range:Ot,decode_col:jh,decode_row:Ch,split_cell:E2,decode_cell:xn,decode_range:rl,format_cell:ma,sheet_add_aoa:Pv,sheet_add_json:R1,sheet_add_dom:T1,aoa_to_sheet:nl,json_to_sheet:ij,table_to_sheet:N1,table_to_book:j3,sheet_to_csv:A1,sheet_to_txt:sj,sheet_to_json:sh,sheet_to_html:C3,sheet_to_formulae:aj,sheet_to_row_object_array:sh,sheet_get_cell:yc,book_new:Wh,book_append_sheet:Hh,book_set_sheet_visibility:lj,cell_set_number_format:cj,cell_set_hyperlink:I1,cell_set_internal_link:uj,cell_add_comment:dj,sheet_set_array_formula:fj,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const hj=({isOpen:t,onClose:r,onImport:e,onDeleteAll:n})=>{const[s,o]=R.useState(null),[l,u]=R.useState([]),[f,m]=R.useState(!1),[p,v]=R.useState(null),[w,_]=R.useState([]),[k,b]=R.useState(""),y=R.useRef(null),L=O=>{const H=O.target.files?.[0];H&&(o(H),v(null),u([]),_([]),b(""))},G=O=>{const H=Math.round(O*24*60*60),U=Math.floor(H/3600),X=Math.floor(H%3600/60),ve=H%60;return`${U.toString().padStart(2,"0")}:${X.toString().padStart(2,"0")}:${ve.toString().padStart(2,"0")}`},j=O=>{const H=O.toString().toLowerCase();let U=O,X=!1,ve=!1;return(H.includes("ppt")||H.includes("powerpoint"))&&(X=!0,U=U.replace(/\+?\s*ppt\s*\+?/gi,"").replace(/\+?\s*powerpoint\s*\+?/gi,"")),(H.includes("q&a")||H.includes("qa"))&&(ve=!0,U=U.replace(/\+?\s*q&a\s*\+?/gi,"").replace(/\s*\+\s*qa\s*\+?/gi,"")),U=U.replace(/^\++|\++$/g,"").replace(/\s*\+\s*/g," ").trim(),{shotType:U,hasPPT:X,hasQA:ve}},F=(O,H)=>{if(!O.trim())return null;const U=O.split(/\r?\n/).map(X=>X.trim()).filter(X=>X.length>0);if(U.length>=2){let X=U[0],ve="Seat";X.startsWith("*P*")?(ve="Podium",X=X.replace("*P*","").trim()):X.startsWith("*M*")?(ve="Moderator",X=X.replace("*M*","").trim()):X.startsWith("*V*")&&(ve="Virtual",X=X.replace("*V*","").trim());const we=U[1];let Ne="",he="";for(let K=U.length-1;K>=2;K--){const oe=U[K];if(oe&&[/^https?:\/\/.+/i,/^www\..+/i,/^[a-zA-Z0-9-]+\.[a-zA-Z]{2,}/i,/^\/.+\.(jpg|jpeg|png|gif|webp)$/i,/^.+\/(.+)\.(jpg|jpeg|png|gif|webp)$/i].some(B=>B.test(oe))){let B=oe.trim();!B.startsWith("http://")&&!B.startsWith("https://")&&(B.startsWith("www.")||B.includes(".")&&!B.startsWith("/"))&&(B="https://"+B),Ne=B,K>2&&U[K-1]&&(he=U[K-1]);break}}if(!Ne&&U.length>2){for(let K=2;K<U.length;K++){const oe=U[K];if(oe&&(oe.includes(".jpg")||oe.includes(".jpeg")||oe.includes(".png")||oe.includes(".gif")||oe.includes(".webp")||oe.includes("http")||oe.includes("www.")||oe.includes(".")&&oe.length>10)){let A=oe.trim();!A.startsWith("http://")&&!A.startsWith("https://")&&(A.startsWith("www.")||A.includes(".")&&!A.startsWith("/"))&&(A="https://"+A),Ne=A;break}}Ne||(U.length===3||U.length>3)&&(he=U[2])}return{id:`speaker-${H}`,slot:H,location:ve,fullName:X,title:we,org:he,photoUrl:Ne}}return null},ue=async()=>{if(s){m(!0),v(null);try{const O=await s.arrayBuffer(),H=wd(O),U=H.SheetNames;if(_(U),U.length>1){b(U[0]),u([]);return}const X=U[0],ve=H.Sheets[X],we=mx.sheet_to_json(ve,{header:1});if(we.length<12)throw new Error("Excel file must have at least 12 rows. Headers should be in row 11, data should start from row 12.");const Ne=we[10];if(!Ne||Ne.length===0)throw new Error("No headers found in row 11. Please ensure headers are in row 11.");const he=[];for(let ae=11;ae<we.length;ae++){const K=we[ae];if(!K||K.length===0)continue;const oe={row:ae-10,cue:"",segmentName:"",duration:"",shotType:"",hasPPT:!1,hasQA:!1,programType:"",notes:"",assets:"",speakers:""};if(K[0]&&(oe.cue=K[0].toString()),K[2]){let N=K[2].toString();N.toLowerCase()==="pod transition"&&(N="Podium Transition"),oe.programType=N}if(K[3]){const N=K[3];typeof N=="number"&&N<1?oe.duration=G(N):oe.duration=N.toString()}if(K[9]&&(oe.segmentName=K[9].toString()),K[10]){const N=K[10].toString(),{shotType:B,hasPPT:q,hasQA:ne}=j(N);oe.shotType=B,oe.hasPPT=q,oe.hasQA=ne}K[11]&&(oe.notes=K[11].toString()),K[13]&&(oe.assets=K[13].toString());const A=[];for(let N=21;N<=27;N++)if(K[N]){const B=K[N].toString().trim();if(B&&B.length>0&&B!==""){const q=N-20,ne=F(B,q);ne&&ne.fullName&&ne.fullName.trim()!==""&&A.push(ne)}}A.length>0&&(oe.speakers=JSON.stringify(A)),he.push(oe)}u(he),console.log(" Excel parsing completed:",he.length,"rows")}catch(O){console.error(" Error parsing Excel:",O),v(O instanceof Error?O.message:"Failed to parse Excel file")}finally{m(!1)}}},D=async()=>{if(!(!s||!k)){m(!0),v(null);try{const O=await s.arrayBuffer(),U=wd(O).Sheets[k],X=mx.sheet_to_json(U,{header:1});if(X.length<12)throw new Error("Excel file must have at least 12 rows. Headers should be in row 11, data should start from row 12.");const ve=X[10];if(!ve||ve.length===0)throw new Error("No headers found in row 11. Please ensure headers are in row 11.");const we=[];for(let Ne=11;Ne<X.length;Ne++){const he=X[Ne];if(!he||he.length===0)continue;const ae={row:Ne-10,cue:"",segmentName:"",duration:"",shotType:"",hasPPT:!1,hasQA:!1,programType:"",notes:"",assets:"",speakers:""};if(he[0]&&(ae.cue=he[0].toString()),he[2]){let oe=he[2].toString();oe.toLowerCase()==="pod transition"&&(oe="Podium Transition"),ae.programType=oe}if(he[3]){const oe=he[3];typeof oe=="number"&&oe<1?ae.duration=G(oe):ae.duration=oe.toString()}if(he[9]&&(ae.segmentName=he[9].toString()),he[10]){const oe=he[10].toString(),{shotType:A,hasPPT:N,hasQA:B}=j(oe);ae.shotType=A,ae.hasPPT=N,ae.hasQA=B}he[11]&&(ae.notes=he[11].toString()),he[13]&&(ae.assets=he[13].toString());const K=[];for(let oe=21;oe<=27;oe++)if(he[oe]){const A=he[oe].toString().trim();if(A&&A.length>0&&A!==""){const N=oe-20,B=F(A,N);B&&B.fullName&&B.fullName.trim()!==""&&K.push(B)}}K.length>0&&(ae.speakers=JSON.stringify(K)),we.push(ae)}u(we),console.log(" Excel parsing completed:",we.length,"rows")}catch(O){console.error(" Error parsing Excel:",O),v(O instanceof Error?O.message:"Failed to parse Excel file")}finally{m(!1)}}},V=()=>{l.length!==0&&(e(l),r())},ee=()=>{window.confirm("Are you sure you want to delete ALL existing schedule items? This action cannot be undone.")&&n()},T=()=>{o(null),u([]),v(null),_([]),b(""),r()};return t?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 w-full max-w-4xl max-h-[80vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:"Import Excel File"}),c.jsx("button",{onClick:T,className:"text-gray-400 hover:text-white text-2xl",children:""})]}),c.jsxs("div",{className:"space-y-4",children:[l.length===0&&c.jsx("div",{className:"bg-red-900/20 border border-red-600 rounded-md p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-red-400 font-semibold mb-1",children:"Clear Existing Data"}),c.jsx("p",{className:"text-gray-300 text-sm",children:"Delete all existing schedule items before importing new data"})]}),c.jsx("button",{onClick:ee,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-md transition-colors",children:"Delete All Rows"})]})}),l.length===0&&c.jsxs("div",{className:"bg-slate-700 p-4 rounded-md",children:[c.jsx("h3",{className:"text-white font-semibold mb-2",children:"Excel File Format Requirements:"}),c.jsxs("ul",{className:"text-gray-300 text-sm space-y-1",children:[c.jsx("li",{children:" Headers should be in row 11, data should start from row 12"}),c.jsx("li",{children:" Expected columns: A=CUE, C=Program Type, D=Duration, J=Segment Name, K=Shot Type+PPT+QA, L=Notes, N=Assets, V-AB=Speakers"}),c.jsx("li",{children:' "Pod Transition" will be converted to "Podium Transition"'}),c.jsx("li",{children:" Excel decimal time format (0.002083...) will be converted to HH:MM:SS"}),c.jsx("li",{children:" Speaker format: Name, Title, [Org], Photo URL (with line breaks). Use *P* (Podium), *M* (Moderator), *V* (Virtual) prefixes"})]})]}),l.length===0&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Select Excel File (.xlsx, .xls)"}),c.jsx("input",{ref:y,type:"file",accept:".xlsx,.xls",onChange:L,className:"block w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700"})]}),s&&l.length===0&&c.jsxs("div",{className:"bg-slate-700 p-3 rounded-md",children:[c.jsxs("p",{className:"text-white text-sm",children:[c.jsx("strong",{children:"Selected file:"})," ",s.name]}),c.jsxs("p",{className:"text-gray-300 text-sm",children:[c.jsx("strong",{children:"Size:"})," ",(s.size/1024).toFixed(2)," KB"]})]}),w.length>1&&l.length===0&&c.jsxs("div",{children:[c.jsxs("label",{className:"block text-white text-sm font-medium mb-2",children:["Select Sheet (",w.length," sheets found)"]}),c.jsx("select",{value:k,onChange:O=>b(O.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:w.map(O=>c.jsx("option",{value:O,children:O},O))})]}),l.length===0&&c.jsxs("div",{className:"flex justify-center gap-4",children:[c.jsx("button",{onClick:w.length>1?D:ue,disabled:!s||f||w.length>1&&!k,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-medium rounded-md transition-colors",children:f?"Parsing...":"Parse Excel File"}),c.jsx("button",{onClick:T,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-md transition-colors",children:"Cancel"})]}),p&&c.jsxs("div",{className:"bg-red-600 text-white p-3 rounded-md",children:[c.jsx("strong",{children:"Error:"})," ",p]}),l.length>0&&c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-white mb-3",children:["Preview (",l.length," rows found)"]}),c.jsx("div",{className:"border border-slate-600 rounded-md bg-slate-700 max-h-96 overflow-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"sticky top-0 bg-slate-600",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Row"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"CUE"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Segment Name"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Duration"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Shot Type"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"PPT/QA"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Program Type"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Notes"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Assets"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm",children:"Speakers"})]})}),c.jsx("tbody",{children:l.map((O,H)=>c.jsxs("tr",{className:"border-t border-slate-600 hover:bg-slate-600",children:[c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:O.row}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:O.cue}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:O.segmentName}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:O.duration}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:O.shotType}),c.jsxs("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:[O.hasPPT&&"PPT ",O.hasQA&&"QA",!O.hasPPT&&!O.hasQA&&"-"]}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:O.programType}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:O.notes?O.notes.length>30?`${O.notes.substring(0,30)}...`:O.notes:"None"}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:O.assets?O.assets.length>30?`${O.assets.substring(0,30)}...`:O.assets:"None"}),c.jsx("td",{className:"px-3 py-2 text-white text-sm",children:O.speakers?(()=>{try{const U=JSON.parse(O.speakers);return U.length>0?c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"font-medium",children:[U.length," speaker(s)"]}),U.map((X,ve)=>c.jsxs("div",{className:"text-xs text-gray-300",children:[c.jsxs("div",{children:[" ",X.fullName," (",X.location,")"]}),c.jsxs("div",{className:"text-gray-400",children:["  ",X.title]}),X.org&&c.jsxs("div",{className:"text-gray-400",children:["  ",X.org]}),X.photoUrl&&c.jsxs("div",{className:"text-blue-300 text-xs truncate max-w-xs",children:[" ",X.photoUrl.length>40?`${X.photoUrl.substring(0,40)}...`:X.photoUrl]})]},ve))]}):"None"}catch{return"None"}})():"None"})]},H))})]})}),c.jsxs("div",{className:"flex justify-center gap-4 mt-4",children:[c.jsxs("button",{onClick:V,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-md transition-colors",children:["Import ",l.length," Items"]}),c.jsx("button",{onClick:()=>{o(null),u([]),v(null),y.current&&(y.current.value="")},className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:"Import Another File"})]})]})]})]})}):null},mj=()=>{const t=an(),r=ti();let e=t.state?.event,n=t.state?.userRole;const{user:s,loading:o}=Vi(),[l,u]=R.useState("VIEWER"),[f,m]=R.useState(!1),[p,v]=R.useState(!1),[w,_]=R.useState([]),[k,b]=R.useState([]),[y,L]=R.useState(!1),[G,j]=R.useState(new Map),F=R.useRef(new Map),ue=R.useRef(new Set),D=(h,E,C)=>{if(l!=="EDITOR"&&l!=="OPERATOR"||!s||!e?.id){console.log(" Not logging change - missing requirements:",{role:l,user:!!s,event:!!e?.id});return}let P=E,Q,ce;C?.itemId&&(Q=T.findIndex(Ae=>Ae.id===C.itemId)+1,ce=T.find(Ae=>Ae.id===C.itemId)?.customFields?.cue||"CUE",P=`ROW ${Q} - ${zn(ce)}: ${E}`),kr.addChange({eventId:e.id,userId:s.id,userName:s.user_metadata?.full_name||s.email||"Unknown",userRole:l,action:h,description:P,details:C,rowNumber:Q,cueNumber:ce,segmentName:C?.itemName||C?.segmentName});const me=kr.getLocalChanges();_(me.slice(0,100)),console.log(" Change logged to buffer:",P)},V=(h,E,C,P)=>{if(l!=="EDITOR"&&l!=="OPERATOR"){console.log(" Not logging change - user role is not EDITOR or OPERATOR:",l);return}const Q=P?.fieldName?.includes("Name")||P?.fieldName?.includes("segmentName")||P?.fieldName?.includes("cue")||P?.fieldName?.includes("custom"),ce=Q?`text_${P?.itemId}_${P?.fieldName}`:h,me=F.current.get(ce);me&&(clearTimeout(me),F.current.delete(ce)),j(We=>{const De=new Map(We);for(const[Je,ot]of De.entries())ot.originalKey===ce&&De.delete(Je);return De});let Ce=C,Ae={...P};if(P?.itemId){const We=T.findIndex(ot=>ot.id===P.itemId)+1,Je=T.find(ot=>ot.id===P.itemId)?.customFields?.cue||"CUE";Ce=`ROW ${We} - ${zn(Je)}: ${C}`,Ae={...P,rowNumber:We,cueNumber:Je}}if(Q)j(We=>{const De=new Map(We);for(const[ot,Vt]of De.entries())Vt.originalKey===ce&&De.delete(ot);const Je=`${ce}_${Date.now()}`;return De.set(Je,{action:E,description:Ce,details:Ae,timestamp:new Date,user:s?.user_metadata?.full_name||s?.email||"Unknown User",originalKey:ce}),console.log(" Updated text field pending change:",Je,"for baseKey:",ce),console.log(" Total pending changes:",De.size),console.log(" Pending change details:",{action:E,description:Ce,baseKey:ce,uniqueKey:Je}),De});else{const We=`${ce}_${Date.now()}`;j(De=>{const Je=new Map(De.set(We,{action:E,description:Ce,details:Ae,timestamp:new Date,user:s?.user_metadata?.full_name||s?.email||"Unknown User",originalKey:ce}));return console.log(" Added pending change:",We,"for baseKey:",ce),console.log(" Total pending changes:",Je.size),console.log(" Pending change details:",{action:E,description:Ce,baseKey:ce,uniqueKey:We}),Je})}const Xe=setTimeout(async()=>{console.log(" TIMEOUT FIRED for baseKey:",ce),j(We=>{let De=null,Je=null;console.log(" TIMEOUT: Looking for baseKey:",ce),console.log(" TIMEOUT: Available pending changes:",Array.from(We.entries()).map(([Vt,zt])=>({key:Vt,originalKey:zt.originalKey})));for(const[Vt,zt]of We.entries())if(zt.originalKey===ce){De=zt,Je=Vt,console.log(" TIMEOUT: Found match - key:",Vt,"originalKey:",zt.originalKey);break}console.log(" TIMEOUT: Found pending change:",De?"YES":"NO"),console.log(" TIMEOUT: Change key:",Je),console.log(" TIMEOUT: Has change key in prev:",We.has(Je||""));const ot=`${ce}-${De?.timestamp?.getTime()||Date.now()}`;if(console.log(" TIMEOUT: Change ID:",ot),console.log(" TIMEOUT: Already processed:",ue.current.has(ot)),De&&Je&&We.has(Je)&&s&&e?.id&&!ue.current.has(ot)){console.log(" TIMEOUT: Processing change..."),ue.current.add(ot);const Vt={eventId:e.id,userId:s.id,userName:s.user_metadata?.full_name||s.email||"Unknown",userRole:l||"VIEWER",action:De?.action||"unknown",description:De?.description||"unknown",details:De?.details||{},rowNumber:De?.details?.rowNumber,cueNumber:De?.details?.cueNumber,segmentName:De?.details?.itemName||De?.details?.segmentName};console.log(" Adding change to service:",Vt),kr.addChange(Vt);const zt=kr.getLocalChanges();console.log(" Local changes after adding to service:",zt.length),console.log(" Latest change:",zt[zt.length-1]),console.log(" Current changeLog state length:",w.length),_(zt.slice(0,100)),console.log(" Set changeLog to:",zt.slice(0,100).length,"changes"),console.log(" Debounced change logged to change log service:",De?.description||"unknown"),console.log(" Removed pending change from queue:",Je),console.log(" Auto-syncing changes after timeout... (with 3s additional delay)"),setTimeout(()=>{gl().then(()=>{console.log(" Auto-sync completed after timeout + 3s delay"),fl(!0),console.log(" Set skipNextSync flag to prevent false reset")}).catch(dn=>{console.error(" Auto-sync failed after timeout + 3s delay:",dn)})},3e3),F.current.delete(ce);const Ir=new Map(We);return Ir.delete(Je),console.log(" Pending changes after removal:",Ir.size),console.log(" Remaining pending keys:",Array.from(Ir.keys())),Ir}else{F.current.delete(ce),ue.current.has(ot)?console.log(" Prevented duplicate processing of change:",ot):console.log(" Pending change already processed or removed:",ce);const Vt=Date.now(),zt=new Map(We);let Ir=0;for(const[dn,Rs]of zt.entries()){const pi=Vt-Rs.timestamp.getTime();pi>15e3&&(console.log(" Removing stale pending change:",dn,"age:",pi+"ms"),zt.delete(dn),Ir++)}return Ir>0?(console.log(" Removed",Ir,"stale pending changes"),zt):We}})},5e3);F.current.set(ce,Xe),console.log(" Set timeout for baseKey:",ce,"in",5e3,"ms"),console.log(" Total active timeouts:",F.current.size)},ee=async()=>{console.log(" Finalizing all pending changes...");const h=Array.from(G.entries());if(h.length===0){console.log(" No pending changes to finalize");return}F.current.forEach(P=>{clearTimeout(P)}),F.current.clear(),console.log(` Processing ${h.length} pending changes immediately...`);const E=new Set;for(const[P,Q]of h)if(Q&&s&&e?.id){const ce=`${Q.originalKey||P}-${Q.timestamp.getTime()}`;if(ue.current.has(ce)){console.log(" Skipping already processed change:",ce);continue}ue.current.add(ce),E.add(ce);let me=Q.description,Ce,Ae;Q.details?.itemId&&(Ce=T.findIndex(We=>We.id===Q.details.itemId)+1,Ae=T.find(We=>We.id===Q.details.itemId)?.customFields?.cue||"CUE",me=`ROW ${Ce} - ${zn(Ae)}: ${Q.description}`),kr.addChange({eventId:e.id,userId:s.id,userName:s.user_metadata?.full_name||s.email||"Unknown",userRole:l||"VIEWER",action:Q.action,description:me,details:Q.details,rowNumber:Ce,cueNumber:Ae,segmentName:Q.details?.itemName||Q.details?.segmentName}),console.log(" Processed pending change immediately:",me)}j(new Map);const C=kr.getLocalChanges();_(C.slice(0,100)),console.log(` All ${E.size} pending changes processed immediately`),console.log(" Auto-syncing changes after manual finalization...");try{await gl(),console.log(" Auto-sync completed after manual finalization")}catch(P){console.error(" Auto-sync failed after manual finalization:",P)}setTimeout(()=>{E.forEach(P=>{ue.current.delete(P)}),console.log(" Cleaned up processed change tracking for",E.size,"changes")},6e4)};if(R.useEffect(()=>()=>{F.current.forEach(h=>clearTimeout(h))},[]),R.useEffect(()=>{const h=setInterval(()=>{j(E=>{const C=Date.now(),P=new Map(E);let Q=0;for(const[ce,me]of P.entries()){const Ce=C-me.timestamp.getTime();Ce>2e4&&(console.log(" Periodic cleanup: Removing stale pending change:",ce,"age:",Ce+"ms"),P.delete(ce),Q++)}return Q>0&&console.log(" Periodic cleanup: Removed",Q,"stale pending changes"),P})},5e3);return()=>clearInterval(h)},[]),R.useEffect(()=>{const h=kr.getChangesCount().unsynced;Qi(h)},[w,G]),!e){const h=localStorage.getItem("events");if(h){const E=JSON.parse(h);e=E[E.length-1]}}console.log("Event from location.state:",t.state?.event),console.log("Final event data:",e);const[T,O]=R.useState([]),[H,U]=R.useState([]),[X,ve]=R.useState(e?.name||""),[we,Ne]=R.useState(""),[he,ae]=R.useState({}),[K,oe]=R.useState(1),[A,N]=R.useState(null),[B,q]=R.useState(!1),[ne,pe]=R.useState({show:!1}),[te,fe]=R.useState(!1),[I,le]=R.useState(!1),[se,z]=R.useState(null),[Ie,Fe]=R.useState(!1),[Ye,tt]=R.useState(!1),[Ve,Ee]=R.useState(null),[Le,Me]=R.useState(!1),[rt,Nt]=R.useState(null),[wt,ft]=R.useState([]),[Wt,Dt]=R.useState(!1),[Ft,xt]=R.useState(null),[Et,Ze]=R.useState(!1),[bt,ur]=R.useState(null),[kt,dr]=R.useState(!1),[$r,Es]=R.useState(null),[wr,Ur]=R.useState([]),[dt,ln]=R.useState({}),[wn,Rn]=R.useState({}),[At,cn]=R.useState({}),[si,bn]=R.useState({}),[Mt,_n]=R.useState(null),[Ws,ks]=R.useState(null),[xa,is]=R.useState(!1),[Ac,Vn]=R.useState(null),[ai,W]=R.useState(null),[J,Z]=R.useState(null),[Y,re]=R.useState({}),[ie,ye]=R.useState({}),[Re,_e]=R.useState(new Set),[ke,Te]=R.useState(null),[He,Ke]=R.useState({}),[Qe,$e]=R.useState(!1),[Pe,mt]=R.useState(null),[Bt,Gt]=R.useState(null),[tr,Wn]=R.useState(!1),[Kr,un]=R.useState(""),[fr,va]=R.useState(!1),[rr,sl]=R.useState(!1),[jd,Rc]=R.useState(!1),[qi,ii]=R.useState(!1),[Ts,ya]=R.useState(!1),[Ad,Ic]=R.useState(!1),[Ji,al]=R.useState([]),[Oc,Hs]=R.useState({totalBackups:0,lastBackup:null,autoBackups:0,manualBackups:0}),[Rd,wa]=R.useState(!1),[Tt,il]=R.useState(null),[Ns,ol]=R.useState(!0),[Yi,Dc]=R.useState(null),[pt,Xr]=R.useState({start:!0,programType:!0,duration:!0,segmentName:!0,shotType:!0,pptQA:!0,notes:!0,assets:!0,participants:!1,speakers:!0,public:!0,custom:!0}),[zs,Hn]=R.useState({}),[vt,Cs]=R.useState({start:128,programType:224,duration:224,segmentName:320,shotType:192,pptQA:192,notes:384,assets:192,participants:256,speakers:384,public:128}),[js,oi]=R.useState({}),[gr,Fc]=R.useState(!1);R.useEffect(()=>{const h=localStorage.getItem(`followEnabled_${e?.id}`);h!==null&&Fc(h==="true")},[e?.id]),R.useEffect(()=>{localStorage.setItem(`followEnabled_${e?.id}`,gr.toString())},[gr,e?.id]),R.useEffect(()=>{if(gr&&J){const h=localStorage.getItem(`scrollPosition_${e?.id}`);if(h){const E=parseInt(h);setTimeout(()=>{window.scrollTo({top:E,behavior:"smooth"})},100)}}},[J,gr,e?.id]);const[ll,In]=R.useState(new Set),zn=h=>h?h.includes("CUE ")?h:h.match(/^CUE\d+$/)?h.replace(/^CUE(\d+)$/,"CUE $1"):`CUE ${h}`:"CUE",[cl,os]=R.useState(new Set),[ul,li]=R.useState(null),[ci,ba]=R.useState(!1),[_a,ls]=R.useState(!1),[Sa,Id]=R.useState(!0),[Ea,Qi]=R.useState(0),[Gn,Zi]=R.useState(null),[On,dl]=R.useState(0),[eo,fl]=R.useState(!1),[Gs,cs]=R.useState(!1),[Ks,Rr]=R.useState(null),[ka,Ta]=R.useState(20),[ui,to]=R.useState(!1),As=R.useRef(null),Xt=()=>{console.log(" User started editing - pausing sync"),cs(!0),Ks&&clearTimeout(Ks);const h=setTimeout(()=>{console.log(" User stopped editing - resuming sync"),cs(!1),Xs()},5e3);Rr(h)},br=()=>{console.log(" Modal opened - pausing sync until closed"),cs(!0),Ks&&(clearTimeout(Ks),Rr(null))},Xs=R.useCallback(()=>{As.current&&clearInterval(As.current),Ta(20),to(!1);const h=setInterval(()=>{Ta(E=>E<=1?(to(!0),setTimeout(()=>{to(!1),Ta(20)},3e3),0):E-1)},1e3);As.current=h},[]),hl=R.useCallback(()=>{As.current&&(clearInterval(As.current),As.current=null),Ta(20),to(!1)},[]),Br=()=>{console.log(" Modal closed - resuming sync in 5 seconds");const h=setTimeout(()=>{console.log(" User stopped editing - resuming sync"),cs(!1),Xs()},5e3);Rr(h)};R.useEffect(()=>{if(o){console.log(" Authentication still loading, waiting...");return}s&&e?.id?(async()=>{try{console.log(" Loading role from Supabase for user:",s.id,"event:",e.id);const E=await qe.getCurrentUserSession(s.id,e.id);if(console.log(" User session from Supabase:",E),E&&E.event_id===e.id&&E.user_role)return u(E.user_role),console.log(" Loaded role from Supabase:",E.user_role),localStorage.setItem(`userRole_${e.id}`,E.user_role),console.log(" Updated localStorage with Supabase role:",E.user_role),!0;console.log(" No valid role found in Supabase:",{hasSession:!!E,eventIdMatch:E?.event_id===e.id,hasRole:!!E?.user_role,userSessionEventId:E?.event_id,currentEventId:e.id,userRole:E?.user_role})}catch(E){console.log(" Failed to load role from Supabase:",E)}return!1})().then(E=>{if(E){console.log(" Using role from Supabase");return}if(n&&["VIEWER","EDITOR","OPERATOR"].includes(n)){u(n),qe.saveUserSession(e.id,s.id,s.user_metadata?.full_name||s.email||"Unknown",n).then(ce=>{ce?console.log(" Role saved to Supabase from navigation state:",n):console.log(" Failed to save role to Supabase, using localStorage only")}),localStorage.setItem(`userRole_${e.id}`,n),console.log(" Saved role to localStorage:",n),console.log(" Using role from navigation state (no Supabase role found):",n);return}const C=localStorage.getItem(`userRole_${e.id}`);if(console.log(" Checking localStorage for role:",{eventId:e.id,savedRole:C}),C&&["VIEWER","EDITOR","OPERATOR"].includes(C)){u(C),console.log(" Using role from localStorage fallback:",C),qe.saveUserSession(e.id,s.id,s.user_metadata?.full_name||s.email||"Unknown",C).then(ce=>{ce?console.log(" Role synced to Supabase from localStorage:",C):console.log(" Failed to sync role to Supabase, keeping localStorage only")});return}const P=Object.keys(localStorage),Q=P.filter(ce=>ce.startsWith("userRole_"));if(console.log(" Checking all localStorage role keys:",Q),console.log(" Current event ID:",e.id),console.log(" All localStorage keys:",P),Q.length>0){const ce=Q[Q.length-1],me=localStorage.getItem(ce);if(console.log(" Found latest role in localStorage:",{key:ce,role:me}),me&&["VIEWER","EDITOR","OPERATOR"].includes(me)){u(me),console.log(" Using latest role from localStorage:",me),localStorage.setItem(`userRole_${e.id}`,me),qe.saveUserSession(e.id,s.id,s.user_metadata?.full_name||s.email||"Unknown",me).then(Ce=>{Ce?console.log(" Role synced to Supabase from latest localStorage:",me):console.log(" Failed to sync role to Supabase, keeping localStorage only")});return}}console.log(" No role found, showing role selection modal"),m(!0)}):!s&&e?.id&&(console.log(" No user authenticated, defaulting to VIEWER role"),u("VIEWER"))},[s,e?.id,o,n,r]),R.useEffect(()=>{if(e?.id){console.log(" Loading change log data for event:",e.id),kr.reloadLocalChanges();const h=kr.getLocalChanges();_(h.slice(0,100)),console.log(" Loaded local changes:",h.length),fi(),Pd(),Lc(),ro(),Ld();const E=setInterval(()=>{const C=kr.getLocalChanges();_(C.slice(0,100))},2e3);return()=>clearInterval(E)}},[e?.id]);const[Od,ml]=R.useState(!1),[di,Dd]=R.useState(null),[Pc,Fd]=R.useState(!1);R.useEffect(()=>{e?.id&&T.length>0&&!Pc&&(console.log(" Schedule loaded, checking for running timers for event:",e.id),Md(),Fd(!0))},[e?.id,T.length,Pc]),R.useEffect(()=>{if(!e?.id)return;const h=async()=>{try{const{data:C,error:P}=await Oe.from("completed_cues").select("*").eq("event_id",e.id);if(!P&&C){const Q={};C.forEach(ce=>{ce.item_id&&(Q[ce.item_id]=!0)}),bn(Q),console.log(" Synced completed cues:",Q)}}catch(C){console.warn(" Error syncing completed cues:",C)}};h();const E=setInterval(h,2e3);return()=>clearInterval(E)},[e?.id]),R.useEffect(()=>{if(!e?.id)return;const h=async()=>{try{await ro()}catch(C){console.warn(" Error syncing sub-cue timers:",C)}};h();const E=setInterval(h,1e3);return()=>clearInterval(E)},[e?.id]),R.useEffect(()=>{if(!e?.id||!s?.id)return;const h=async()=>{try{const{data:C,error:P}=await Oe.from("active_timers").select("*").eq("event_id",e.id).order("updated_at",{ascending:!1}).limit(1);if(P){console.warn(" Top text sync error:",P);return}const Q=C?.[0];if(Q&&Q.user_id===s.id)return;if(Q){const ce=Q.timer_state||"unknown",me=parseInt(Q.item_id),Ce=Q.is_active,Ae=Q.started_at;let Xe=ce;if((ce==="unknown"||!ce)&&(Ce&&Ae?Xe="running":Ce?Xe="loaded":Xe="stopped"),Xe==="running"){Z(me),Ke(Je=>({...Je,[me]:!0})),ln(Je=>({...Je,[me]:!0}));const We=T.findIndex(Je=>Je.id===me),De=new Set;if(We!==-1)for(let Je=We+1;Je<T.length&&T[Je].isIndented;Je++)De.add(T[Je].id);os(De),li(me)}else if(Xe==="loaded"){Z(me),Ke(Je=>({...Je,[me]:!0})),ln({});const We=T.findIndex(Je=>Je.id===me),De=new Set;if(We!==-1)for(let Je=We+1;Je<T.length&&T[Je].isIndented;Je++)De.add(T[Je].id);os(De),li(me)}else Xe==="stopped"&&(Z(null),Ke({}),ln({}),os(new Set),li(null))}else Z(null),Ke({}),ln({}),os(new Set),li(null)}catch(C){console.warn(" Top text sync error:",C)}};h();const E=setInterval(h,2e3);return()=>clearInterval(E)},[e?.id,s?.id,T]),R.useEffect(()=>()=>{console.log(" Cleaning up drift detector on component unmount"),ar.destroy()},[]),R.useEffect(()=>{if(e?.id&&s?.id&&l&&l!=="VIEWER"){console.log(" Saving current role to Supabase:",l);try{const h=s.user_metadata?.full_name||s.email||"Unknown";qe.saveUserSession(e.id,s.id,h,l),console.log(" Role saved to Supabase:",l)}catch(h){console.error(" Failed to save role to Supabase:",h)}}},[e?.id,s?.id,l]),R.useEffect(()=>()=>{if(e?.id&&s?.id&&l&&l!=="VIEWER"){console.log(" Saving current role to Supabase before navigating away:",l);try{const h=s.user_metadata?.full_name||s.email||"Unknown";qe.saveUserSession(e.id,s.id,h,l),console.log(" Role saved to Supabase on navigation away:",l)}catch(h){console.error(" Failed to save role to Supabase on navigation away:",h)}}},[e?.id,s?.id,l]);const Pd=async()=>{if(e?.id)try{console.log(" Loading completed cues from Supabase for event:",e.id);const h=await qe.getCompletedCues(e.id);if(h&&h.length>0){console.log(" Found completed cues:",h);const E={};h.forEach(C=>{if(C.item_id){if(J&&C.item_id===J){console.log(" Skipping currently loaded cue from completed cues:",C.item_id);return}E[C.item_id]=!0}}),bn(E),console.log(" Set completedCues state:",E)}else console.log(" No completed cues found")}catch(h){console.error(" Error loading completed cues from Supabase:",h),console.log(" This means the completed_cues table or functions need to be created first"),console.log(" Please run the create-completed-cues-table.sql script in your Supabase SQL Editor")}};R.useCallback(()=>e?.id?(console.log(" Starting countdown sync for Browser B"),setInterval(async()=>{try{const E=await qe.getActiveTimer(e.id);E&&E.timer_state==="running"&&E.started_at&&E.elapsed_seconds!==void 0&&E.duration_seconds!==void 0&&re(C=>({...C,[E.item_id]:{elapsed:E.elapsed_seconds,total:E.duration_seconds,startedAt:new Date(E.started_at)}}))}catch(E){console.warn(" Failed to sync countdown from server:",E)}},1e3)):void 0,[e?.id]),R.useEffect(()=>{if(!e?.id||!s?.id)return;console.log(" Starting countdown sync for Browser B");const h=setInterval(async()=>{try{const E=await qe.getActiveTimer(e.id);if(E){if(E.user_id===s.id){console.log(" Skipping countdown sync - timer started by current user");return}if(console.log(" Browser B: Syncing timer from server:",{itemId:E.item_id,state:E.timer_state,elapsed:E.elapsed_seconds,total:E.duration_seconds,startedAt:E.started_at,userId:E.user_id,currentUserId:s.id}),re(C=>{const P=C[E.item_id];return E.timer_state==="running"&&E.started_at?{...C,[E.item_id]:{elapsed:E.elapsed_seconds,total:E.duration_seconds,startedAt:new Date(E.started_at)}}:{...C,[E.item_id]:{elapsed:0,total:E.duration_seconds,startedAt:null}}}),E.timer_state==="running"&&E.started_at){const C=new Date(E.started_at),P=E.duration_seconds;console.log(` Browser B: Starting drift detection for timer ${E.item_id} with duration ${P}s`),ar.startMonitoring(E.item_id,C,P,Q=>{console.log(` Browser B DriftDetector: Syncing timer ${E.item_id} with server elapsed: ${Q}s`),_e(ce=>{const me=new Set([...ce,E.item_id]);return console.log(` Browser B DriftDetector: Marking timer ${E.item_id} as server-synced. Server-synced timers:`,Array.from(me)),me}),re(ce=>{const me={...ce,[E.item_id]:{...ce[E.item_id],elapsed:Q}};return console.log(` Browser B DriftDetector: Updated timer ${E.item_id} progress to elapsed: ${Q}s`),me})})}}else console.log(" No active timer, clearing timer progress"),re({})}catch(E){console.warn(" Failed to sync countdown from server:",E)}},1e3);return()=>{console.log(" Cleaning up countdown sync"),clearInterval(h)}},[e?.id,s?.id]);const ro=async()=>{if(e?.id){console.log(" Polling for sub-cue timer...");try{const{data:h}=await qe.hasActiveSubCueTimer(e.id);if(!h){console.log(" No active sub-cue timer found, clearing local state"),Object.keys(At).forEach(P=>{At[parseInt(P)]&&clearInterval(At[parseInt(P)])}),cn({}),ye({}),_n(null);return}const{data:E,error:C}=await qe.getActiveSubCueTimer(e.id);if(console.log(" Sub-cue timer data from Supabase:",E),C){console.error(" Error loading sub-cue timer:",C);return}if(E&&E.is_active&&E.is_running){if(console.log(" Sub-cue timer loaded:",E.item_id,"Duration:",E.duration_seconds,"s","Active:",E.is_active,"Running:",E.is_running),s&&E.user_id===s.id){console.log(" Skipping sub-cue sync - change made by current user");return}ba(!0),Object.keys(At).forEach(Ae=>{At[parseInt(Ae)]&&clearInterval(At[parseInt(Ae)])});const P=parseInt(E.item_id),Q=new Date(E.started_at),me=Math.floor((new Date().getTime()-Q.getTime())/1e3)+2;ye(Ae=>({...Ae,[P]:{elapsed:Math.max(0,me),total:E.duration_seconds,startedAt:Q}})),console.log(" Browser B: Not starting local timer, will update via 2-second sync"),console.log(" Set sub-cue timer state");const Ce=Math.max(0,E.duration_seconds-me);console.log(" Browser B timing debug:",{startedAt:Q.toISOString(),elapsed:me,duration:E.duration_seconds,remaining:Ce,fix:"Browser B uses database elapsed time, no local timer"}),_n({itemId:P,remaining:Ce,duration:E.duration_seconds,isActive:!0,startedAt:Q,timerState:"running"}),console.log(" Set secondaryTimer state for top UI"),setTimeout(()=>{ba(!1)},100)}else E&&(!E.is_active||!E.is_running)?(console.log(" Sub-cue timer found but not active or not running, clearing local state"),Object.keys(At).forEach(P=>{At[parseInt(P)]&&clearInterval(At[parseInt(P)])}),cn({}),ye({}),_n(null)):(console.log(" No sub-cue timer found, clearing local state"),Object.keys(At).forEach(P=>{At[parseInt(P)]&&clearInterval(At[parseInt(P)])}),cn({}),ye({}),_n(null))}catch(h){console.error(" Error loading sub-cue timer:",h),Object.keys(At).forEach(E=>{At[parseInt(E)]&&clearInterval(At[parseInt(E)])}),cn({}),ye({})}}},Lc=async()=>{if(e?.id)try{const{data:h,error:E}=await qe.getActiveSubCueTimers(e.id);if(E){console.error(" Error loading sub-cue timers:",E);return}h&&h.length>0&&(console.log(" Loaded sub-cue timers from Supabase:",h),console.log(" Setting up sub-cue timer states..."),h.forEach(C=>{const P=C.item_id,Q=C.duration_seconds||0;if(console.log(` Setting up sub-cue timer for item ${P}:`,{elapsed:C.elapsed_seconds||0,total:Q,startedAt:C.started_at?new Date(C.started_at):null,timer_state:C.timer_state}),ye(ce=>({...ce,[P]:{elapsed:C.elapsed_seconds||0,total:Q,startedAt:C.started_at?new Date(C.started_at):null}})),C.timer_state==="running"){console.log(` Starting local timer interval for sub-cue item ${P}`);const ce=setInterval(()=>{ye(me=>{if(me[P]&&me[P].startedAt){const Ce=me[P].startedAt,Ae=Ce instanceof Date?Ce.getTime():new Date(Ce).getTime(),Xe=Math.floor((Date.now()-Ae)/1e3);return{...me,[P]:{...me[P],elapsed:Xe}}}return me})},100);cn(me=>(console.log(` Setting sub-cue timer state for item ${P}`),{...me,[P]:ce}))}else console.log(` Sub-cue timer for item ${P} is not running, state: ${C.timer_state}`)}))}catch(h){console.error(" Error loading sub-cue timers:",h)}},Ld=async()=>{if(e?.id){console.log(" Testing database connection...");try{const{data:h,error:E}=await qe.getLastLoadedCue(e.id);E?(console.error(" Database test failed:",E),console.log(" This means the SQL migration needs to be run first"),console.log(" Please run the migrate-timer-states.sql script in your Supabase SQL Editor")):(console.log(" Database connection test passed"),console.log(" Test data received:",h))}catch(h){console.error(" Database connection test error:",h)}}},Md=async()=>{if(!e?.id){console.log(" No event ID for checking running timers");return}console.log(" Checking for running timers for event:",e.id);try{console.log(" Using fallback timer detection..."),Dd({cueName:"Timer Detected",remainingTime:"Check Console"}),ml(!0),console.log(" Fallback timer popup shown")}catch(h){console.error(" Error checking running timers:",h)}},$d=async()=>{if(console.log(" Master sync: Getting active timer from database..."),!e?.id){console.warn(" No event selected for sync");return}try{const h=await qe.getActiveTimer(e.id);if(!h){console.log(" No active timer found in database");return}console.log(" Found active timer in database:",h);const E=new Date,C=Math.floor(E.getTime()/1e3),P=new Date(h.started_at),Q=Math.floor(P.getTime()/1e3),ce=h.duration_seconds||0,me=h.is_running;if(console.log(" Timer calculation:",{currentTime:C,startTimeSeconds:Q,durationSeconds:ce,isRunning:me,currentTimeFormatted:E.toISOString(),startTimeFormatted:P.toISOString()}),Z(h.item_id),me){const Ce=C-Q,Ae=ce-Ce;if(console.log(" Time calculation for running timer:",{elapsedSeconds:Ce,remainingSeconds:Ae,isOverdue:Ae<0}),re(Xe=>({...Xe,[h.item_id]:{elapsed:Ce,total:ce,startedAt:P}})),Ae!==0){Ae>0?console.log(` Timer synced: ${Ae} seconds remaining - starting countdown`):console.log(` Timer synced: ${Math.abs(Ae)} seconds overdue - starting count up`),dt[h.item_id]&&clearInterval(wn[h.item_id]);const Xe=setInterval(()=>{re(We=>{const De=We[h.item_id];if(!De)return We;const Je=De.elapsed+1,ot=De.total-Je;return ot>0?console.log(` Timer countdown: ${ot} seconds remaining`):console.log(ot===0?" Timer just expired":` Timer count up: ${Math.abs(ot)} seconds overdue`),{...We,[h.item_id]:{...De,elapsed:Je}}})},1e3);Rn(We=>({...We,[h.item_id]:Xe}))}else console.log(" Timer just expired")}else console.log(" Timer is loaded but not running - setting duration only"),re(Ce=>({...Ce,[h.item_id]:{elapsed:0,total:ce,startedAt:null}})),console.log(` Timer synced: Set loaded duration to ${ce} seconds`)}catch(h){console.error(" Error during master sync:",h)}},no=async()=>{if(!(!e?.id||!s?.id))try{console.log(" Backing up schedule data..."),await qe.saveRunOfShowData({event_id:e.id,event_name:e.name,event_date:e.date,schedule_items:T,custom_columns:H,settings:{}}),console.log(" Schedule data backed up")}catch(h){console.error(" Error backing up schedule data:",h)}},fi=async()=>{if(!e?.id){console.log(" No event ID for loading master change log");return}try{console.log(" Loading master change log for event:",e.id);const h=await kr.getMasterChangeLog(e.id,100);b(h),console.log(" Loaded master change log:",h.length,"changes"),h.length===0&&console.log(" No master changes found - this might be normal for new events")}catch(h){console.error(" Error loading master change log:",h),b([])}},gl=async()=>{if(!e?.id||!s){console.log(" Cannot sync - missing event ID or user");return}if(!Ns){console.log(" Skipping sync - page not visible");return}if(Le||Ye||Wt||kt||Ts){console.log(" Skipping sync - modal is open");return}if(Gs){console.log(" Skipping sync - user is actively editing");return}try{console.log(" Syncing schedule data to database...");const h={event_id:e.id,event_name:e.name,event_date:e.date,schedule_items:T,custom_columns:H,settings:{eventName:X,masterStartTime:we,dayStartTimes:he}};await qe.saveRunOfShowData(h,{userId:s.id,userName:s.user_metadata?.full_name||s.email||"Unknown User",userRole:l||"VIEWER"})?(console.log(" Schedule data synced to database successfully"),fi()):console.log(" Failed to sync schedule data to database")}catch(h){console.error(" Error syncing schedule data to database:",h)}},Ud=async()=>{if(prompt("Enter password to clear all change logs:")!=="1615"){alert("Incorrect password. Change logs not cleared.");return}if(confirm(` WARNING: This will permanently delete ALL change logs (local and master) for this event. This action cannot be undone.

Are you sure you want to continue?`))try{if(kr.clearLocalChanges(),_([]),console.log(" Local changes cleared"),e?.id){console.log(" Attempting to clear master change log for event:",e.id);const{data:{user:C},error:P}=await Oe.auth.getUser();if(console.log(" Current user:",C?.id,C?.email),P){console.error(" Auth error:",P),alert(" Authentication error. Please refresh and try again.");return}const Q=await kr.clearMasterChangeLog(e.id);if(Q.success){b([]),console.log(" Master change log cleared successfully"),console.log(" Verifying master change log is cleared...");const ce=await kr.getMasterChangeLog(e.id);console.log(" Master change log after clearing:",ce.length,"records"),b(ce),ce.length===0?alert(` All change logs cleared successfully!

- Local changes:  Cleared
- Master changes:  Cleared (${Q.deletedCount} records deleted)`):alert(` Partial success:

- Local changes:  Cleared
- Master changes:  ${Q.deletedCount} deleted, but ${ce.length} remain

Some records may be protected by RLS policies.`)}else console.log(" Failed to clear master change log:",Q.error),alert(` Partial success:

- Local changes:  Cleared
- Master changes:  Failed

Error: ${Q.error}

This might be due to database permissions. Check the console for details.`)}else alert(" Error: No event ID found. Cannot clear master change log.")}catch(C){console.error("Error clearing change logs:",C),alert(" Error clearing change logs. Check the console for details.")}};R.useEffect(()=>{if(Object.keys(dt).length===0){ls(!1);return}if(!Sa)return;const h=parseInt(Object.keys(dt)[0]),E=T.find(C=>C.id===h);if(E)try{const C=new Date,P=T.findIndex(ce=>ce.id===E.id),Q=uo(P);if(Q){const[ce,me]=Q.split(" "),[Ce,Ae]=ce.split(":").map(Number);let Xe=Ce;me==="PM"&&Ce!==12&&(Xe+=12),me==="AM"&&Ce===12&&(Xe=0);const We=new Date,De=new Date(We.getFullYear(),We.getMonth(),We.getDate(),Xe,Ae),Je=C.getTime()-De.getTime(),ot=Math.round(Je/(1e3*60));dl(Math.abs(ot)),ot<-1?(Zi("early"),ls(!0)):ot>1?(Zi("late"),ls(!0)):(Zi("on-time"),ls(!0))}}catch(C){console.error("Error calculating time status:",C),ls(!1)}},[dt,T,Sa]);const Bd=()=>{if(!gr)return;const h=document.querySelector(`[data-item-id="${J}"]`);if(h){const E=h.getBoundingClientRect(),C=window.pageYOffset||document.documentElement.scrollTop,P=E.top+C,Q=document.querySelector("#main-scroll-container .h-24");let ce=100;Q&&(ce=Q.getBoundingClientRect().height+20);const Ce=P-ce-230;window.scrollTo({top:Math.max(0,Ce),behavior:"smooth"}),localStorage.setItem(`scrollPosition_${e?.id}`,Ce.toString())}},[$t,_r]=R.useState({cue:"",day:1,programType:"PreShow/End",shotType:"",segmentName:"",durationHours:0,durationMinutes:0,durationSeconds:0,notes:"",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!1,timerId:"",isPublic:!1,isIndented:!1,customFields:{}});R.useEffect(()=>{_r(h=>({...h,day:K}))},[K]);const Mc=["PreShow/End","Podium Transition","Panel Transition","Sub Cue","No Transition","Video","Panel+Remote","Remote Only","Break","TBD","KILLED"],so={"PreShow/End":"#8B5CF6","Podium Transition":"#8B4513","Panel Transition":"#404040","Sub Cue":"#F3F4F6","No Transition":"#059669",Video:"#F59E0B","Panel+Remote":"#1E40AF","Remote Only":"#60A5FA",Break:"#EC4899",TBD:"#6B7280",KILLED:"#DC2626"},Sn=(h,E,C,P,Q)=>{let ce=6.5;if(h&&h.trim()!==""){const me=document.createElement("div");me.style.position="absolute",me.style.visibility="hidden";const De=(vt.notes-32-1)/16;me.style.width=`${De}rem`,me.style.padding="0.75rem",me.style.fontSize="1rem",me.style.lineHeight="1.5",me.style.fontFamily="system-ui, -apple-system, sans-serif",me.style.whiteSpace="pre-wrap",me.style.wordWrap="break-word",me.innerHTML=h,document.body.appendChild(me);const Je=me.scrollHeight;document.body.removeChild(me);const zt=Je/16+3;ce=Math.max(ce,zt)}if(C&&C.trim()!=="")try{const me=JSON.parse(C);if(Array.isArray(me)&&me.length>0){const Ce=me.filter(Ae=>Ae.fullName&&Ae.fullName.trim()!=="");if(Ce.length>0){const We=4+Ce.length*1.5;ce=Math.max(ce,We)}}}catch{if(C.includes(`
`)){const Ae=4+C.split(`
`).filter(Xe=>Xe.trim()!=="").length*1.5;ce=Math.max(ce,Ae)}}if(E&&E.trim()!=="")try{const me=JSON.parse(E);if(Array.isArray(me)&&me.length>0){const Ce=me.filter(Ae=>Ae.fullName&&Ae.fullName.trim()!=="");if(Ce.length>0){const We=4+Ce.length*1.5;ce=Math.max(ce,We)}}}catch{if(E.includes(`
`)){const Ae=4+E.split(`
`).filter(Xe=>Xe.trim()!=="").length*1.5;ce=Math.max(ce,Ae)}}return P&&Q&&Q.length>0&&Q.forEach(me=>{const Ce=P[me.name];if(Ce&&Ce.trim()!==""){const Ae=Ce.split(`
`),ot=3+Math.max(2,Ae.length)*1.6+1;ce=Math.max(ce,ot)}}),`${ce}rem`},$c=h=>{if(!h||h.trim()==="")return"3.5rem";let E=1;try{const ce=JSON.parse(h);if(Array.isArray(ce)){const me=ce.filter(Ce=>Ce.fullName&&Ce.fullName.trim()!=="");E=Math.max(1,me.length)}}catch{E=Math.max(1,h.split(`
`).filter(me=>me.trim()!=="").length)}const Q=3+(E-1)*1.5;return`${Math.max(3.5,Q)}rem`},Vd=()=>{let h=0;T.forEach(Q=>{!Q.isIndented&&(Q.day||1)===K&&(h+=(Q.durationHours||0)*3600+(Q.durationMinutes||0)*60+(Q.durationSeconds||0))});const E=Math.floor(h/3600),C=Math.floor(h%3600/60),P=h%60;return{hours:E,minutes:C,seconds:P,totalSeconds:h}},Ht=(h,E)=>{const C=document.getElementById("notes-editor");if(C){C.focus();try{switch(h){case"bold":document.execCommand("bold",!1);break;case"italic":document.execCommand("italic",!1);break;case"underline":document.execCommand("underline",!1);break;case"color":E&&document.execCommand("foreColor",!1,E);break;case"highlight":E&&E!=="none"?document.execCommand("backColor",!1,E):document.execCommand("removeFormat",!1);break;case"fontSize":E&&document.execCommand("fontSize",!1,E);break;case"bullet":document.execCommand("insertUnorderedList",!1);break;case"list":document.execCommand("insertOrderedList",!1);break;case"left":document.execCommand("justifyLeft",!1);break;case"center":document.execCommand("justifyCenter",!1);break;case"right":document.execCommand("justifyRight",!1);break;case"undo":document.execCommand("undo",!1);break;case"redo":document.execCommand("redo",!1);break}}catch{console.warn("Formatting command not supported:",h)}}},pl=()=>{const h=document.getElementById("notes-editor");if(h&&Ve!==null){const E=h.innerHTML;if(Ve===-1)_r(C=>({...C,notes:E}));else{const C=T.find(Q=>Q.id===Ve)?.notes||"",P=T.find(Q=>Q.id===Ve);O(Q=>Q.map(ce=>ce.id===Ve?{...ce,notes:E}:ce)),P&&D("FIELD_UPDATE",`Updated notes for "${P.segmentName}"`,{changeType:"FIELD_CHANGE",itemId:P.id,itemName:P.segmentName,fieldName:"notes",oldValue:C,newValue:E,details:{fieldType:"text",characterChange:E.length-C.length}})}tt(!1),Ee(null),Br()}},hi=()=>{if(rt!==null){const h=JSON.stringify(wt);if(rt===-1)_r(E=>({...E,speakersText:h}));else{const E=T.find(P=>P.id===rt)?.speakersText||"",C=T.find(P=>P.id===rt);O(P=>P.map(Q=>Q.id===rt?{...Q,speakersText:h}:Q)),C&&D("FIELD_UPDATE",`Updated speakers for "${C.segmentName}"`,{changeType:"FIELD_CHANGE",itemId:C.id,itemName:C.segmentName,fieldName:"speakers",oldValue:E,newValue:h,details:{fieldType:"speakers",speakerCount:wt.length,characterChange:h.length-E.length}})}Me(!1),Nt(null),Br()}},Wd=()=>{if(Ft!==null){const h=document.getElementById("assets-list");if(h){const E=h.querySelectorAll(".asset-item"),C=[];E.forEach(Q=>{const ce=Q.querySelector(".asset-name"),me=Q.querySelector(".asset-link");if(ce&&me){const Ce=ce.value.trim(),Ae=me.value.trim();Ce&&C.push(Ae?`${Ce}|${Ae}`:Ce)}});const P=C.join("||");if(Ft===-1)_r(Q=>({...Q,assets:P}));else{const Q=T.find(me=>me.id===Ft)?.assets||"",ce=T.find(me=>me.id===Ft);O(me=>me.map(Ce=>Ce.id===Ft?{...Ce,assets:P}:Ce)),ce&&D("FIELD_UPDATE",`Updated assets for "${ce.segmentName}"`,{changeType:"FIELD_CHANGE",itemId:ce.id,itemName:ce.segmentName,fieldName:"assets",oldValue:Q,newValue:P,details:{fieldType:"assets",assetCount:C.length,characterChange:P.length-Q.length}})}Dt(!1),xt(null),Br()}}},xl=()=>{const h=document.getElementById("assets-list");if(h){const E=document.createElement("div");E.className="asset-item p-3 bg-slate-700 rounded-lg space-y-3",E.innerHTML=`
        <div class="flex gap-3 items-center">
          <input type="text" class="asset-name flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Asset name..." />
          <button type="button" class="toggle-link px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded transition-colors text-sm">
            + Link
          </button>
          <button type="button" class="remove-asset px-3 py-2 bg-red-600 hover:bg-red-500 text-white rounded transition-colors">Remove</button>
        </div>
        <div class="asset-link-container hidden">
          <input type="url" class="asset-link w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Enter asset URL..." />
        </div>
      `;const C=E.querySelector(".toggle-link"),P=E.querySelector(".asset-link-container"),Q=E.querySelector(".asset-link");C?.addEventListener("click",()=>{P?.classList.contains("hidden")?(P.classList.remove("hidden"),C.textContent=" Link",C.classList.remove("bg-blue-600","hover:bg-blue-500"),C.classList.add("bg-slate-600","hover:bg-slate-500"),Q?.focus()):(P?.classList.add("hidden"),C.textContent="+ Link",C.classList.remove("bg-slate-600","hover:bg-slate-500"),C.classList.add("bg-blue-600","hover:bg-blue-500"),Q&&(Q.value=""))}),E.querySelector(".remove-asset")?.addEventListener("click",()=>{E.remove()}),h.appendChild(E)}},vl=()=>{if(wr.length>=7)return;const h=wr.map(P=>P.slot),E=[1,2,3,4,5,6,7].find(P=>!h.includes(P))||1,C={id:`speaker_${Date.now()}`,slot:E,location:"Podium",fullName:"",title:"",org:"",photoLink:""};Ur(P=>[...P,C].sort((Q,ce)=>Q.slot-ce.slot))},Uc=h=>{Ur(E=>E.filter(C=>C.id!==h))},qs=(h,E,C)=>{Ur(P=>P.map(Q=>Q.id===h?{...Q,[E]:C}:Q).sort((Q,ce)=>Q.slot-ce.slot))},Bc=()=>{if($r!==null){const h=JSON.stringify(wr);$r===-1?_r(E=>({...E,speakers:h})):O(E=>E.map(C=>C.id===$r?{...C,speakers:h}:C)),dr(!1),Es(null)}},Na=()=>{if(wt.length>=7)return;const h=wt.map(P=>P.slot),E=[1,2,3,4,5,6,7].find(P=>!h.includes(P))||1,C={id:Date.now().toString(),fullName:"",location:"Podium",slot:E,title:"",org:"",photoLink:""};ft(P=>[...P,C])},Hd=h=>{ft(E=>E.filter(C=>C.id!==h))},Js=(h,E,C)=>{ft(P=>P.map(Q=>Q.id===h?{...Q,[E]:C}:Q))},zd=(h,E)=>{if(wt.some(P=>P.id!==h&&P.slot===E)){const P=wt.find(Q=>Q.id!==h&&Q.slot===E);if(P){const Q=wt.find(ce=>ce.id===h);Q&&Js(P.id,"slot",Q.slot)}}Js(h,"slot",E)},Vc=(h,E)=>{const C=wr.find(Q=>Q.id===h);if(!C)return;const P=wr.find(Q=>Q.id!==h&&Q.slot===E);if(P){const Q=wr.map(ce=>ce.id===h?{...ce,slot:E}:ce.id===P.id?{...ce,slot:C.slot}:ce);Ur(Q)}else qs(h,"slot",E)},yl=h=>{if(!h)return"Click to add participants...";try{const E=JSON.parse(h);return!Array.isArray(E)||E.length===0?"Click to add participants...":E.sort((C,P)=>C.slot-P.slot).map(C=>`${C.location==="Podium"?"P":C.location==="Seat"?"S":C.location==="Virtual"?"V":"M"}${C.slot} - ${C.fullName||"Unnamed"}`).join(`
`)}catch{return"Click to add participants..."}},Ys=h=>{if(!h)return"Click to add speakers...";try{const E=JSON.parse(h);return!Array.isArray(E)||E.length===0?"Click to add speakers...":E.sort((C,P)=>C.slot-P.slot).filter(C=>C.fullName&&C.fullName.trim()!=="").map(C=>`${C.location==="Podium"?"P":C.location==="Seat"?"S":C.location==="Virtual"?"V":"M"}${C.slot} - ${C.fullName||"Unnamed"}`).join(`
`)}catch{return"Click to add speakers..."}},Ca=["Podium","2-Shot","3-Shot","4-Shot","5-Shot","6-Shot","7-Shot","Ted-Talk"],Gd=h=>{if(isNaN(h)||h===void 0||h===null)return console.warn(" formatTime received invalid value:",h),"00:00:00";const E=h<0,C=Math.abs(h),P=Math.floor(C/3600),Q=Math.floor(C%3600/60),ce=Math.floor(C%60);return`${E?"-":""}${P.toString().padStart(2,"0")}:${Q.toString().padStart(2,"0")}:${ce.toString().padStart(2,"0")}`},ao=h=>{if(isNaN(h)||h===void 0||h===null)return console.warn(" formatSubCueTime received invalid value:",h),"00:00";const E=h<0,C=Math.abs(h),P=Math.floor(C/3600),Q=Math.floor(C%3600/60),ce=Math.floor(C%60),me=E?"-":"";return P===0?`${me}${Q.toString().padStart(2,"0")}:${ce.toString().padStart(2,"0")}`:`${me}${P.toString().padStart(2,"0")}:${Q.toString().padStart(2,"0")}:${ce.toString().padStart(2,"0")}`},mi=h=>{const E=T.find(P=>P.id===h);if(!E||!E.isIndented)return!1;const C=T.findIndex(P=>P.id===h);if(C===-1)return!1;for(let P=C-1;P>=0;P--){const Q=T[P];if(!Q.isIndented)return dt[Q.id]!==void 0}return!1},Wc=()=>{const h=Object.keys(dt);if(h.length>0){const C=parseInt(h[0]);if(Y[C]){const P=Y[C];return P.total-P.elapsed}}const E=Object.keys(At);if(E.length>0){const C=parseInt(E[0]);if(ie[C]){const P=ie[C];return P.total-P.elapsed}}if(J&&Y[J]){const C=Y[J];return C.total-C.elapsed}return 0},wl=()=>{const h=Object.keys(dt);if(h.length>0){const C=parseInt(h[0]);if(Y[C]){const P=Y[C],Q=P.total-P.elapsed;return Q<0?0:P.total>0?Q/P.total*100:0}}const E=Object.keys(At);if(E.length>0){const C=parseInt(E[0]);if(ie[C]){const P=ie[C],Q=P.total-P.elapsed;return P.total>0?Q/P.total*100:0}}if(J&&Y[J]){const C=Y[J],P=C.total-C.elapsed;return C.total>0?P/C.total*100:0}return 0},bl=()=>{const h=Object.keys(dt);if(h.length>0){const C=parseInt(h[0]);if(Y[C]){const P=Y[C],Q=P.total-P.elapsed;return Q<0?"bg-red-500":Q>120?"#10b981":Q>30?"#f59e0b":"#ef4444"}}const E=Object.keys(At);if(E.length>0){const C=parseInt(E[0]);if(ie[C]){const P=ie[C],Q=P.total-P.elapsed;return Q>120?"#10b981":Q>30?"#f59e0b":"#ef4444"}}if(J&&Y[J]){const C=Y[J],P=C.total-C.elapsed;return P>120?"#10b981":P>30?"#f59e0b":"#ef4444"}return"transparent"},Hc=()=>{const h=Object.keys(dt);if(h.length>0){const E=parseInt(h[0]);if(Y[E]){const C=Y[E],P=C.total-C.elapsed;return P>120?"#10b981":P>30?"#f59e0b":"#ef4444"}}if(J&&Y[J]){const E=Y[J],C=E.total-E.elapsed;return C>120?"#10b981":C>30?"#f59e0b":"#ef4444"}return"#ffffff"},gi=async h=>{if(!J||!s||!e?.id)return;const E=T.find(me=>me.id===J);if(!E)return;const C=Math.max(0,E.durationHours*3600+E.durationMinutes*60+E.durationSeconds+h),P=Math.floor(C/3600),Q=Math.floor(C%3600/60),ce=C%60;O(me=>me.map(Ce=>Ce.id===J?{...Ce,durationHours:P,durationMinutes:Q,durationSeconds:ce}:Ce)),Y[J]&&(console.log(" Updating timer duration for item:",J,"new duration:",C),re(me=>({...me,[J]:{...me[J],total:C}})),dt[J]?(console.log(" Timer duration updated locally for running timer"),await qe.updateTimerDuration(e.id,J,C)?console.log(" Timer duration updated on server - Browser B will see the change"):console.warn(" Failed to update timer duration on server"),await no(),console.log(" Time adjustment completed locally and on server")):console.log(" Timer duration updated locally for loaded timer"))},zc=async h=>{if(console.log(" loadCue function STARTED with itemId:",h),console.log(" loadCue function STARTED with itemId:",h),console.log(" loadCue function STARTED with itemId:",h),!s||!e?.id){console.log(" Missing user or event ID:",{user:!!s,eventId:e?.id});return}Object.keys(dt).forEach(async ce=>{if(dt[parseInt(ce)]){clearInterval(wn[parseInt(ce)]),bn(Ce=>({...Ce,[parseInt(ce)]:!0}));const me=T.find(Ce=>Ce.id===parseInt(ce));console.log(" About to mark cue as completed:",{eventId:e.id,itemId:parseInt(ce),userId:s.id,cueId:me?.customFields?.cue||"CUE"});try{const Ce=await qe.markCueCompleted(e.id,parseInt(ce),me?.customFields?.cue||"CUE",s.id,s.user_metadata?.full_name||s.email||"Unknown User",l||"VIEWER");console.log(" Mark completed result:",Ce)}catch(Ce){console.error(" Error marking cue as completed:",Ce)}}}),ln({}),console.log(" Stopping all timers in Supabase for event:",e.id,"user:",s.id);const E=await qe.stopAllTimersForEvent(e.id,s.id);if(console.log(" Stop all timers result:",E),J&&J!==h){In(Ce=>new Set([...Ce,J])),bn(Ce=>({...Ce,[J]:!0}));const ce=T.find(Ce=>Ce.id===J);console.log(" About to mark active cue as completed:",{eventId:e.id,itemId:J,userId:s.id,cueId:ce?.customFields?.cue||"CUE"});try{const Ce=await qe.markCueCompleted(e.id,J,ce?.customFields?.cue||"CUE",s.id,s.user_metadata?.full_name||s.email||"Unknown User",l||"VIEWER");console.log(" Mark active completed result:",Ce)}catch(Ce){console.error(" Error marking active cue as completed:",Ce)}const me=T.findIndex(Ce=>Ce.id===J);if(me!==-1)for(let Ce=me+1;Ce<T.length&&T[Ce].isIndented;Ce++)bn(Ae=>({...Ae,[T[Ce].id]:!0})),In(Ae=>new Set([...Ae,T[Ce].id])),await qe.markCueCompleted(e.id,T[Ce].id,T[Ce].customFields?.cue||"CUE",s.id,s.user_metadata?.full_name||s.email||"Unknown User",l||"VIEWER")}bn(ce=>{const me={...ce};delete me[h];const Ce=T.findIndex(Ae=>Ae.id===h);if(Ce!==-1)for(let Ae=Ce+1;Ae<T.length&&T[Ae].isIndented;Ae++)delete me[T[Ae].id];return me}),In(ce=>{const me=new Set(ce);me.delete(h);const Ce=T.findIndex(Ae=>Ae.id===h);if(Ce!==-1)for(let Ae=Ce+1;Ae<T.length&&T[Ae].isIndented;Ae++)me.delete(T[Ae].id);return me});const C=T.find(ce=>ce.id===h);if(C){console.log(" Item found:",C),console.log(" Item ID type:",typeof C.id,"Value:",C.id),console.log(" Item duration values:",{durationHours:C.durationHours,durationMinutes:C.durationMinutes,durationSeconds:C.durationSeconds});const ce=C.durationHours*3600+C.durationMinutes*60+C.durationSeconds;console.log(" Calculated total seconds:",ce);const me=typeof h=="string"?parseInt(h):h;console.log(" Numeric item ID:",me),console.log(" Optimistic UI update - showing loaded state immediately"),re(De=>({...De,[h]:{elapsed:0,total:ce,startedAt:null}})),Z(h),Ke(De=>({...De,[h]:!0}));const Ae=T.findIndex(De=>De.id===h)+1,Xe=zn(C.customFields.cue),We=C.timerId;console.log(" Loading CUE in Supabase:",{eventId:e.id,itemId:me,userId:s.id,totalSeconds:ce,rowNumber:Ae,cueDisplay:Xe,timerId:We}),console.log(" About to call DatabaseService.loadCue..."),console.log(" DatabaseService object:",typeof qe),console.log(" DatabaseService.loadCue function:",typeof qe.loadCue),console.log(" Testing Supabase configuration...");try{const{isSupabaseConfigured:De}=await Zo(async()=>{const{isSupabaseConfigured:Je}=await Promise.resolve().then(()=>rS);return{isSupabaseConfigured:Je}},void 0);console.log(" Supabase configured:",De)}catch(De){console.error(" Error importing Supabase config:",De)}try{console.log(" Calling DatabaseService.loadCue now...");const De=await qe.loadCue(e.id,me,s.id,ce,Ae,Xe,We);console.log(" Load CUE result:",De),De?console.log(" Load CUE succeeded!"):console.error(" Load CUE failed - check database connection and functions")}catch(De){console.error(" Load CUE error:",De),console.error(" Error stack:",De.stack)}console.log(" Finished loadCue database call"),li(me);try{await qe.updateLastLoadedCue(e.id,me,"loaded"),console.log(" Last loaded CUE saved")}catch(De){console.log(" Could not save last loaded CUE (migration may not be run):",De)}await no(),console.log(" Load CUE action completed locally")}const P=T.findIndex(ce=>ce.id===h),Q=new Set;if(P!==-1)for(let ce=P+1;ce<T.length&&T[ce].isIndented;ce++)Q.add(T[ce].id);os(Q)},Kd=async()=>{if(Object.keys(dt).forEach(h=>{dt[parseInt(h)]&&clearInterval(wn[parseInt(h)])}),Object.keys(At).forEach(h=>{At[parseInt(h)]&&clearInterval(At[parseInt(h)])}),e?.id)try{await qe.clearCompletedCues(e.id),console.log(" Cleared completed cues from database"),await qe.clearAllActiveTimersForEvent(e.id),console.log(" Cleared all active timers from Supabase")}catch(h){console.warn(" Failed to clear database:",h)}ln({}),cn({}),re({}),ye({}),bn({}),Z(null),In(new Set),os(new Set)},Xd=()=>{$e(!1),Pe&&!Pe.closed&&Pe.close();const h=Object.keys(dt),E=h.length>0?T.find(Q=>dt[Q.id]):T.find(Q=>Q.id===J),C={isRunning:h.length>0,elapsedTime:E&&Y[E.id]?Y[E.id].elapsed:0,totalDuration:E?E.durationHours*3600+E.durationMinutes*60+E.durationSeconds:0,eventId:e?.id,mainTimer:E?{cue:E.customFields.cue||"CUE",segmentName:E.segmentName||""}:null,secondaryTimer:Mt?{itemId:Mt.itemId,remaining:Mt.remaining,duration:Mt.duration,cue:T.find(Q=>Q.id===Mt.itemId)?.customFields.cue||"CUE",segmentName:T.find(Q=>Q.id===Mt.itemId)?.segmentName||""}:null},P=window.open("/fullscreen-timer","fullScreenTimer","width=1920,height=1080,fullscreen=yes,menubar=no,toolbar=no,location=no,status=no,scrollbars=no,resizable=yes");P&&(mt(P),P.addEventListener("load",()=>{P.postMessage({type:"TIMER_UPDATE",...C},"*")}))},qd=()=>{$e(!1),Bt&&!Bt.closed&&Bt.close();const h=Object.keys(dt),E=h.length>0?T.find(ce=>dt[ce.id]):T.find(ce=>ce.id===J),C={isRunning:h.length>0,elapsedTime:E&&Y[E.id]?Y[E.id].elapsed:0,totalDuration:E?E.durationHours*3600+E.durationMinutes*60+E.durationSeconds:0,eventId:e?.id,mainTimer:E?{cue:E.customFields.cue||"CUE",segmentName:E.segmentName||""}:null,secondaryTimer:Mt?{itemId:Mt.itemId,remaining:Mt.remaining,duration:Mt.duration,cue:T.find(ce=>ce.id===Mt.itemId)?.customFields.cue||"CUE",segmentName:T.find(ce=>ce.id===Mt.itemId)?.segmentName||""}:null},P=e?.id?`/clock?eventId=${e.id}`:"/clock",Q=window.open(P,"clock","width=1920,height=1080,fullscreen=yes,menubar=no,toolbar=no,location=no,status=no,scrollbars=no,resizable=yes");Q&&(Gt(Q),Q.addEventListener("load",()=>{Q.postMessage({type:"TIMER_UPDATE",...C},"*")}))};R.useEffect(()=>{const h=()=>{W(null),Vn(null),$e(!1)};return document.addEventListener("click",h),()=>document.removeEventListener("click",h)},[]),R.useEffect(()=>{if(Ye&&Ve!==null){const h=document.getElementById("notes-editor");if(h)if(Ve===-1)h.innerHTML=$t.notes||"";else{const E=T.find(C=>C.id===Ve);h.innerHTML=E?.notes||""}}},[Ye,Ve,T,$t.notes]),R.useEffect(()=>{if(Le&&rt!==null)if(rt===-1)if($t.speakersText)try{const h=JSON.parse($t.speakersText);ft(Array.isArray(h)?h:[])}catch{ft([])}else ft([]);else{const h=T.find(E=>E.id===rt);if(h?.speakersText)try{const E=JSON.parse(h.speakersText);ft(Array.isArray(E)?E:[])}catch{ft([])}else ft([])}},[Le,rt,T,$t.speakersText]),R.useEffect(()=>{if(Wt&&Ft!==null){const h=document.getElementById("assets-list");if(h){h.innerHTML="";let E="";Ft===-1?E=$t.assets||"":E=T.find(P=>P.id===Ft)?.assets||"",E&&E.split("||").forEach(P=>{if(P.trim()){const[Q,ce]=P.split("|"),me=ce&&ce.trim()!=="",Ce=document.createElement("div");Ce.className="asset-item p-3 bg-slate-700 rounded-lg space-y-3",Ce.innerHTML=`
                <div class="flex gap-3 items-center">
                  <input type="text" class="asset-name flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Asset name..." value="${Q||""}" />
                  <button type="button" class="toggle-link px-3 py-2 text-white rounded transition-colors text-sm ${me?"bg-slate-600 hover:bg-slate-500":"bg-blue-600 hover:bg-blue-500"}">
                    ${me?" Link":"+ Link"}
                  </button>
                  <button type="button" class="remove-asset px-3 py-2 bg-red-600 hover:bg-red-500 text-white rounded transition-colors">Remove</button>
                </div>
                <div class="asset-link-container ${me?"":"hidden"}">
                  <input type="url" class="asset-link w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Enter asset URL..." value="${ce||""}" />
                </div>
              `;const Ae=Ce.querySelector(".toggle-link"),Xe=Ce.querySelector(".asset-link-container"),We=Ce.querySelector(".asset-link");Ae?.addEventListener("click",()=>{Xe?.classList.contains("hidden")?(Xe.classList.remove("hidden"),Ae.textContent=" Link",Ae.classList.remove("bg-blue-600","hover:bg-blue-500"),Ae.classList.add("bg-slate-600","hover:bg-slate-500"),We?.focus()):(Xe?.classList.add("hidden"),Ae.textContent="+ Link",Ae.classList.remove("bg-slate-600","hover:bg-slate-500"),Ae.classList.add("bg-blue-600","hover:bg-blue-500"),We&&(We.value=""))}),Ce.querySelector(".remove-asset")?.addEventListener("click",()=>{Ce.remove()}),h.appendChild(Ce)}}),h.children.length===0&&xl()}}},[Wt,Ft,T,$t.assets]),R.useEffect(()=>{if(kt&&$r!==null)if($r===-1)if($t.speakers)try{const h=JSON.parse($t.speakers);Ur(Array.isArray(h)?h:[])}catch{Ur([])}else Ur([]);else{const h=T.find(E=>E.id===$r);if(h?.speakers)try{const E=JSON.parse(h.speakers);Ur(Array.isArray(E)?E:[])}catch{Ur([])}else Ur([])}},[kt,$r,T,$t.speakers]);const Kn=ad.useCallback(Jd(async()=>{if(e?.id)try{const h={event_id:e.id,event_name:e.name,event_date:e.date,schedule_items:T,custom_columns:H,settings:{eventName:X,masterStartTime:we,dayStartTimes:he,lastSaved:new Date().toISOString()}};console.log(" Auto-saving to Supabase:",{eventId:e.id,scheduleItemsCount:T.length,customColumnsCount:H.length,eventName:X,masterStartTime:we,sampleScheduleItem:T[0]?{id:T[0].id,segmentName:T[0].segmentName,speakersText:T[0].speakersText?"Has speakers data":"No speakers data",speakers:T[0].speakers?"Has speakers data":"No speakers data"}:"No schedule items"});const E=await qe.saveRunOfShowData(h,{userId:s?.id||"unknown",userName:s?.user_metadata?.full_name||s?.email||"Unknown User",userRole:l||"VIEWER"});console.log(" Auto-saved to Supabase successfully")}catch(h){console.error(" Error auto-saving to Supabase:",h)}},1e3),[e?.id,e?.name,e?.date,T,H,X,we,he]);function Jd(h,E){let C;return((...P)=>{clearTimeout(C),C=setTimeout(()=>h(...P),E)})}const Dn=R.useCallback(async()=>{if(e?.id)try{console.log(" Loading from Supabase for event:",e.id);const h=qe.getRunOfShowData(e.id),E=new Promise((P,Q)=>setTimeout(()=>Q(new Error("Database query timeout after 10 seconds")),1e4)),C=await Promise.race([h,E]);if(console.log(" Debug - Raw data from Supabase:",C),console.log(" Debug - schedule_items:",C?.schedule_items),console.log(" Debug - custom_columns:",C?.custom_columns),console.log(" Debug - settings:",C?.settings),C){console.log(" Data loaded from Supabase:",{scheduleItemsCount:C.schedule_items?.length||0,customColumnsCount:C.custom_columns?.length||0,eventName:C.settings?.eventName,masterStartTime:C.settings?.masterStartTime,sampleScheduleItem:C.schedule_items?.[0]?{id:C.schedule_items[0].id,segmentName:C.schedule_items[0].segmentName,speakersText:C.schedule_items[0].speakersText?"Has speakers data":"No speakers data",speakers:C.schedule_items[0].speakers?"Has speakers data":"No speakers data"}:"No schedule items"});const P=C.schedule_items?[...C.schedule_items]:[];O(P),U(C.custom_columns||[]),C.settings?.eventName&&ve(C.settings.eventName),C.settings?.masterStartTime&&Ne(C.settings.masterStartTime),C.settings?.dayStartTimes&&ae(C.settings.dayStartTimes),N(C.updated_at||null),q(!1),pe({show:!1}),console.log(" Run of Show data loaded from Supabase successfully")}else{console.log(" No data found in Supabase, falling back to localStorage for event:",e.id);const P=localStorage.getItem(`runOfShowSchedule_${e.id}`),Q=localStorage.getItem(`customColumns_${e.id}`),ce=localStorage.getItem(`eventName_${e.id}`),me=localStorage.getItem(`masterStartTime_${e.id}`),Ce=localStorage.getItem(`dayStartTimes_${e.id}`);if(P)try{const Ae=JSON.parse(P);console.log(" Parsed schedule from localStorage:",Ae);const Xe=Ae.map(We=>({...We,day:We.day||1}));O(Xe),console.log(" Loaded schedule from localStorage:",Xe.length,"items"),console.log(" First few items:",Xe.slice(0,3))}catch(Ae){console.error(" Error parsing schedule from localStorage:",Ae),console.log(" Raw localStorage data:",P)}else console.log(" No schedule found in localStorage for event:",e.id);Q&&(U(JSON.parse(Q)),console.log(" Loaded custom columns from localStorage")),ce&&(ve(ce),console.log(" Loaded event name from localStorage")),me&&(Ne(me),console.log(" Loaded master start time from localStorage")),Ce&&(ae(JSON.parse(Ce)),console.log(" Loaded day start times from localStorage"))}}catch(h){console.error(" Error loading run of show data from Supabase:",h),console.error(" Error details:",{message:h.message,stack:h.stack,eventId:e?.id}),console.log(" Falling back to localStorage due to error");const E=localStorage.getItem(`runOfShowSchedule_${e.id}`);if(E)try{const P=JSON.parse(E).map(Q=>({...Q,day:Q.day||1}));O(P),console.log(" Loaded schedule from localStorage after error:",P.length,"items"),console.log(" First few items after error:",P.slice(0,3))}catch(C){console.error(" Error parsing schedule from localStorage after error:",C),console.log(" Raw localStorage data after error:",E)}else console.log(" No schedule found in localStorage after error for event:",e.id)}},[e?.id]),ja=R.useCallback(async()=>{if(e?.id)try{console.log(" Loading changes dynamically for event:",e.id);const h=await qe.loadChangesDynamically(e.id);if(h){console.log(" Dynamic changes loaded:",{scheduleItemsCount:h.schedule_items?.length||0,customColumnsCount:h.custom_columns?.length||0,lastModifiedBy:h.last_modified_by_name});const E=h.schedule_items?[...h.schedule_items]:[];O(E),U(h.custom_columns||[]),h.settings?.eventName&&ve(h.settings.eventName),h.settings?.masterStartTime&&Ne(h.settings.masterStartTime),h.settings?.dayStartTimes&&ae(h.settings.dayStartTimes),N(h.updated_at||null),q(!1),pe({show:!1}),console.log(" Changes loaded dynamically - timers preserved")}}catch(h){console.error(" Error loading changes dynamically:",h)}},[e?.id]);R.useEffect(()=>{console.log(" useEffect triggered for event ID:",e?.id),e?.id?(console.log(" Calling loadFromSupabase for event:",e.id),Dn()):console.log(" No event ID available for loading data")},[e?.id]),R.useEffect(()=>{console.log(" Schedule state changed:",{scheduleLength:T.length,firstItem:T[0]?{id:T[0].id,segmentName:T[0].segmentName,programType:T[0].programType}:"No items",eventId:e?.id})},[T,e?.id]);const io=async()=>{if(!e?.id){console.log(" No event ID available for loading backups");return}try{if(console.log(" Loading backups for event:",e.id),console.log(" Event details:",{id:e.id,name:e.name}),!await Ri.testBackupTable())throw new Error("Backup table is not accessible");const E=await Ri.getBackupsForEvent(e.id);console.log(" Raw backup data received:",E),al(E),console.log(" Loading backup stats...");const C=await Ri.getBackupStats(e.id);console.log(" Backup stats:",C),Hs(C),console.log(` Loaded ${E.length} backups successfully`)}catch(h){console.error(" Error loading backups:",h),console.error(" Error details:",{message:h.message,stack:h.stack,eventId:e?.id}),al([]),Hs({totalBackups:0,lastBackup:null,autoBackups:0,manualBackups:0})}},Gc=async()=>{if(e?.id)try{console.log(" Creating manual backup for event:",e.id);const h=new Date().toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),E=`${e.name}  ${h}`;await Ri.createBackup(e.id,T,H,e,"manual",E),console.log(" Manual backup created:",E);const C=await Ri.getBackupStats(e.id);Hs(C),alert(` Manual backup created successfully!

Backup: ${E}
Schedule Items: ${T.length}
Custom Columns: ${H.length}`)}catch(h){console.error(" Error creating manual backup:",h),alert(` Error creating manual backup: ${h.message}`)}},Kc=h=>{il(h),wa(!0)},Xc=async()=>{if(!(!e?.id||!Tt))try{console.log(" Restoring from backup:",Tt.id);const h=await Ri.restoreFromBackup(Tt.id);O(h.scheduleData),U(h.customColumnsData),localStorage.setItem(`runOfShowSchedule_${e.id}`,JSON.stringify(h.scheduleData)),localStorage.setItem(`customColumns_${e.id}`,JSON.stringify(h.customColumnsData)),await qe.saveRunOfShowData({event_id:e.id,schedule_items:h.scheduleData,custom_columns:h.customColumnsData}),console.log(" Restored from backup:",h.backupName),wa(!1),ya(!1),il(null),alert(` Data restored from backup!

Backup: ${h.backupName}
Date: ${new Date(h.backupTimestamp).toLocaleString()}

Schedule Items: ${h.scheduleData.length}
Custom Columns: ${h.customColumnsData.length}`)}catch(h){console.error(" Error restoring from backup:",h),alert(` Error restoring from backup: ${h.message}`)}},_l=async h=>{if(confirm("Are you sure you want to delete this backup?"))try{console.log(" Deleting backup:",h),await Ri.deleteBackup(h),console.log(" Backup deleted successfully"),alert("Backup deleted successfully"),await io()}catch(E){console.error(" Error deleting backup:",E),alert(`Error deleting backup: ${E.message}`)}};R.useEffect(()=>{if(!e?.id){console.log(" No event ID, skipping change detection");return}console.log(" Starting change detection for event:",e.id),Xs();const h=async()=>{try{if(eo){console.log(" Skipping sync check - user just made a change"),fl(!1),Xs();return}if(Gs){console.log(" Skipping sync check - user is actively editing");return}console.log(" Running change check...");const C=await qe.checkForChanges(e.id,A??void 0);C.hasChanges?(console.log(" Changes detected:",C),q(!0),pe({show:!0,lastModifiedBy:C.lastModifiedBy,lastModifiedByName:C.lastModifiedByName}),Ns?(console.log(" Loading changes automatically..."),await ja()):console.log(" Changes detected but page not visible - will load when page becomes visible")):console.log(" No changes detected")}catch(C){console.error(" Error checking for changes:",C)}};h();const E=setInterval(h,2e4);return()=>{clearInterval(E),hl()}},[e?.id,A,Ns,hl]),R.useEffect(()=>{Ns&&B&&(console.log(" Page became visible with pending changes - loading changes..."),ja())},[Ns,B]),R.useEffect(()=>{Ts&&e?.id&&io()},[Ts,e?.id]),R.useEffect(()=>{const h=()=>{const E=!document.hidden;console.log(` Page visibility changed: ${E?"visible":"hidden"}`),ol(E),E?(console.log(" Page became visible, checking for changes..."),Yd()):(Dc(new Date),console.log(" Page became hidden, recording last sync time"))};return document.addEventListener("visibilitychange",h),()=>document.removeEventListener("visibilitychange",h)},[]);const Yd=async()=>{if(!e?.id||!Yi){console.log(" No event ID or last sync time, skipping change check");return}try{console.log(" Checking for changes since last sync...");const h=await qe.getRunOfShowData(e.id);if(h){const E=new Date(h.last_change_at||new Date);console.log(" Latest change time:",E),console.log(" Last sync time:",Yi),E>Yi?(console.log(" Changes detected since last sync, updating local data..."),O(h.schedule_items||[]),U(h.custom_columns||[]),localStorage.setItem(`runOfShowSchedule_${e.id}`,JSON.stringify(h.schedule_items||[])),localStorage.setItem(`customColumns_${e.id}`,JSON.stringify(h.custom_columns||[])),console.log(" Local data updated with latest changes")):console.log(" No changes detected since last sync")}}catch(h){console.error(" Error checking for changes on return:",h)}};R.useEffect(()=>{e?.id&&(localStorage.setItem(`runOfShowSchedule_${e.id}`,JSON.stringify(T)),window.dispatchEvent(new CustomEvent("scheduleUpdated",{detail:{eventId:e.id,schedule:T}})),console.log(" Schedule saved and event dispatched for event:",e.id),Kn())},[T,e?.id,Kn]),R.useEffect(()=>{if(!e?.id)return;const h=()=>{console.log(" Updating graphics data for live JSON files..."),localStorage.setItem(`runOfShowSchedule_${e.id}`,JSON.stringify(T)),localStorage.setItem(`customColumns_${e.id}`,JSON.stringify(H)),localStorage.setItem(`eventName_${e.id}`,X),localStorage.setItem(`masterStartTime_${e.id}`,we),localStorage.setItem(`dayStartTimes_${e.id}`,JSON.stringify(he)),window.dispatchEvent(new CustomEvent("scheduleUpdated",{detail:{eventId:e.id,schedule:T}}))};h();const E=setInterval(h,1e4);return()=>clearInterval(E)},[e?.id,T,H,X,we,he]),R.useEffect(()=>{e?.id&&(localStorage.setItem(`customColumns_${e.id}`,JSON.stringify(H)),Kn())},[H,e?.id,Kn]),R.useEffect(()=>{e?.id&&(localStorage.setItem(`eventName_${e.id}`,X),Kn())},[X,e?.id,Kn]),R.useEffect(()=>{e?.id&&(localStorage.setItem(`masterStartTime_${e.id}`,we),Kn())},[we,e?.id,Kn]),R.useEffect(()=>{e?.id&&(localStorage.setItem(`dayStartTimes_${e.id}`,JSON.stringify(he)),Kn())},[he,e?.id,Kn]),R.useEffect(()=>{if(Pe&&!Pe.closed){const h=Object.keys(dt),E=h.length>0?T.find(P=>dt[P.id]):T.find(P=>P.id===J),C={type:"TIMER_UPDATE",isRunning:h.length>0,elapsedTime:E&&Y[E.id]?Y[E.id].elapsed:0,totalDuration:E&&Y[E.id]?Y[E.id].total:E?E.durationHours*3600+E.durationMinutes*60+E.durationSeconds:0,eventId:e?.id,itemId:E?.id,mainTimer:E?{cue:E.customFields.cue||"CUE",segmentName:E.segmentName||""}:null,secondaryTimer:Mt?{itemId:Mt.itemId,remaining:Mt.remaining,duration:Mt.duration,cue:T.find(P=>P.id===Mt.itemId)?.customFields.cue||"CUE",segmentName:T.find(P=>P.id===Mt.itemId)?.segmentName||""}:null};Pe.postMessage(C,"*")}},[dt,Y,J,T,we,X,Pe,Mt]);const Qd=h=>{const E=()=>{const Q="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let ce="";for(let me=0;me<5;me++)ce+=Q.charAt(Math.floor(Math.random()*Q.length));return ce},C={...h,id:Date.now(),timerId:E(),isIndented:h.isIndented||!1,customFields:{cue:h.cue?`CUE${h.cue}`:"CUE"}};se!==null?(O(Q=>{const ce=[...Q];return ce.splice(se+1,0,C),ce}),z(null)):O(Q=>[...Q,C]);const P=se!==null?se+2:T.length+1;D("ADD_ITEM",`Added new schedule item: "${C.segmentName}"`,{changeType:"ADD",itemId:C.id,itemName:C.segmentName,rowNumber:P,cueNumber:C.customFields.cue?parseInt(C.customFields.cue,10):null,details:{day:C.day,programType:C.programType,shotType:C.shotType,position:`Row ${P}`,durationHours:C.durationHours,durationMinutes:C.durationMinutes,totalDurationMinutes:C.durationHours*60+C.durationMinutes,speakers:C.speakers||"None",speakersText:C.speakersText||"None",notes:C.notes||"",assets:C.assets||"None",hasPPT:C.hasPPT,hasQA:C.hasQA,timerId:C.timerId,isPublic:C.isPublic,isIndented:C.isIndented}}),fe(!1),Br(),_r({cue:"",day:K,programType:"PreShow/End",shotType:"",segmentName:"",durationHours:0,durationMinutes:0,durationSeconds:0,notes:"",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!1,timerId:"",isPublic:!1,isIndented:!1,customFields:{}})},Qs=h=>{const E={name:h,id:Date.now().toString()};U(C=>[...C,E]),O(C=>C.map(P=>({...P,customFields:{...P.customFields,[h]:""}}))),D("COLUMN_ADD",`Added custom column "${h}"`,{changeType:"COLUMN_ADD",columnName:h,details:{columnType:"text",affectedItems:T.length,defaultValue:""}}),Fe(!1),Br()},Sl=h=>{const E=H.find(C=>C.id===h);E&&(U(C=>C.filter(P=>P.id!==h)),O(C=>C.map(P=>{const{[E.name]:Q,...ce}=P.customFields;return{...P,customFields:ce}})),D("COLUMN_REMOVE",`Removed custom column "${E.name}"`,{changeType:"COLUMN_REMOVE",columnName:E.name,details:{affectedItems:T.length,columnId:E.id}}))},Kt=(h,E)=>{h.preventDefault(),h.stopPropagation();const C=h.clientX,P=vt[E]||256;document.body.style.cursor="col-resize",document.body.style.userSelect="none";const Q=me=>{const Ce=me.clientX-C,Ae=Math.max(100,P+Ce);Cs(Xe=>({...Xe,[E]:Ae}))},ce=()=>{document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",Q),document.removeEventListener("mouseup",ce)};document.addEventListener("mousemove",Q),document.addEventListener("mouseup",ce)},oo=(h,E)=>{h.preventDefault(),h.stopPropagation();const C=h.clientX,P=js[E]||256;document.body.style.cursor="col-resize",document.body.style.userSelect="none";const Q=me=>{const Ce=me.clientX-C,Ae=Math.max(100,P+Ce);oi(Xe=>({...Xe,[E]:Ae}))},ce=()=>{document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",Q),document.removeEventListener("mouseup",ce)};document.addEventListener("mousemove",Q),document.addEventListener("mouseup",ce)},qc=async h=>{if(!(!s||!e?.id))if(dt[h]){clearInterval(wn[h]);const E=`${h}_drift`;dt[E]&&clearInterval(wn[E]),ln(P=>{const Q={...P};return delete Q[h],delete Q[E],Q}),Rn(P=>{const Q={...P};return delete Q[h],delete Q[E],Q}),ar.stopMonitoring(h),_e(P=>{const Q=new Set(P);return Q.delete(h),Q}),bn(P=>({...P,[h]:!0})),In(P=>new Set([...P,h]));try{const P=T.find(Q=>Q.id===h);await qe.markCueCompleted(e.id,h,P?.customFields?.cue||"CUE",s.id,s.user_metadata?.full_name||s.email||"Unknown User",l||"VIEWER")}catch(P){console.warn(" Failed to mark cue as completed in database:",P),console.log(" This means the completed_cues table needs to be created first")}const C=T.findIndex(P=>P.id===h);if(C!==-1)for(let P=C+1;P<T.length&&T[P].isIndented;P++)bn(Q=>({...Q,[T[P].id]:!0})),In(Q=>new Set([...Q,T[P].id])),await qe.markCueCompleted(e.id,T[P].id,T[P].customFields?.cue||"CUE",s.id,s.user_metadata?.full_name||s.email||"Unknown User",l||"VIEWER");Ke(P=>{const Q={...P};return delete Q[h],Q}),J===h&&Z(null),re(P=>{const Q={...P};return delete Q[h],Q}),console.log(" Stopping timer in Supabase for item:",h),await qe.stopTimer(e.id,h,s.id),console.log(" Timer stopped in Supabase");try{await qe.updateLastLoadedCue(e.id,h,"stopped"),console.log(" Last loaded CUE saved as stopped")}catch(P){console.log(" Could not save last loaded CUE as stopped (migration may not be run):",P)}await no()}else{if(Object.keys(dt).length>0)return;const E=T.find(C=>C.id===h);if(E){const C=E.durationHours*3600+E.durationMinutes*60+E.durationSeconds;console.log(" Optimistic UI update - showing running state immediately");const P=new Date;re(De=>({...De,[h]:{elapsed:0,total:C,startedAt:P}}));const Q=setInterval(()=>{re(De=>{if(De[h]){if(Re.has(h)&&dt[h]&&De[h]?.startedAt)return console.log(` Timer ${h}: Skipping local update - using server-synced time (Browser A)`),De;const Je=Date.now(),ot=De[h].startedAt;let Vt;ot instanceof Date?Vt=ot.getTime():typeof ot=="string"?Vt=new Date(ot).getTime():(console.warn(" startedAt is not a Date or string:",ot),Vt=Je);const zt=Math.floor((Je-Vt)/1e3),Ir=C-zt;return ar.updateLocalElapsed(h,zt),zt<=10&&console.log(` Timer ${h}: Elapsed=${zt}s, Remaining=${Ir}s, Start=${new Date(Vt).toISOString()}, Now=${new Date(Je).toISOString()}`),{...De,[h]:{...De[h],elapsed:zt}}}return De})},100);Rn(De=>({...De,[h]:Q})),ln(De=>({...De,[h]:!0})),console.log(` Starting drift detection for timer ${h} with duration ${C}s`),console.log(" Drift detector config:",ar.getConfig()),ar.startMonitoring(h,P,C,De=>{console.log(` DriftDetector: Syncing timer ${h} with server elapsed: ${De}s`),_e(Je=>{const ot=new Set([...Je,h]);return console.log(` DriftDetector: Marking timer ${h} as server-synced. Server-synced timers:`,Array.from(ot)),ot}),re(Je=>{const ot={...Je,[h]:{...Je[h],elapsed:De}};return console.log(` DriftDetector: Updated timer ${h} progress to elapsed: ${De}s`),ot})});const ce=ar.getStatus();console.log(" Drift detector status after starting:",ce),console.log(` Timer ${h} will run locally until first drift sync`);const Ce=T.findIndex(De=>De.id===h)+1,Ae=zn(E.customFields.cue),Xe=E.timerId;console.log(" Starting timer in Supabase for item:",h,"at:",P.toISOString(),"row:",Ce,"cue:",Ae,"timerId:",Xe);try{const De=await qe.startTimer(e.id,h,s.id,C,P,Ce,Ae,Xe);console.log(" Timer started in Supabase:",De),De||console.error(" Start timer failed - check database connection and functions")}catch(De){console.error(" Start timer error:",De)}try{await qe.updateLastLoadedCue(e.id,h,"running"),console.log(" Last loaded CUE saved as running")}catch(De){console.log(" Could not save last loaded CUE as running (migration may not be run):",De)}const We=setInterval(async()=>{try{console.log(` DriftDetector: Starting periodic sync for timer ${h}`),await ar.forceSync(h,async()=>{const Je=(await qe.getActiveTimer(e.id))?.elapsed_seconds||0;return console.log(` DriftDetector: Server returned elapsed: ${Je}s for timer ${h}`),Je}),console.log(` DriftDetector: Periodic sync completed for timer ${h}`)}catch(De){console.warn(` DriftDetector: Failed to sync timer ${h}:`,De)}},3e4);Rn(De=>({...De,[`${h}_drift`]:We})),console.log(" Timer started locally with drift detection enabled"),await no(),In(De=>{const Je=new Set(De);Je.delete(h);const ot=T.findIndex(Vt=>Vt.id===h);if(ot!==-1)for(let Vt=ot+1;Vt<T.length&&T[Vt].isIndented;Vt++)Je.delete(T[Vt].id);return Je})}}},lo=async h=>{if(!s||!e?.id)return;const E=T.find(C=>C.id===h);if(E&&E.isIndented){const C=E.durationHours*3600+E.durationMinutes*60+E.durationSeconds;console.log(" Starting secondary timer for item:",h,"Duration:",C,"s"),ye(Q=>({...Q,[h]:{elapsed:0,total:C,startedAt:new Date}}));const P=setInterval(()=>{ye(Q=>{const ce=Q[h];if(!ce)return Q;const me=Math.floor((Date.now()-(ce.startedAt?.getTime()||Date.now()))/1e3);return Math.max(0,ce.total-me),{...Q,[h]:{...ce,elapsed:me}}}),_n(Q=>{if(!Q)return null;if(ci)return Q;const ce=Q.startedAt?.getTime()||Date.now(),me=Math.floor((Date.now()-ce)/1e3),Ce=Math.max(0,Q.duration-me);if(Ce===0){console.log(" Sub-cue timer reached 0 - holding for a beat");const Ae=e?.id;console.log(" Current event ID for database call:",Ae),setTimeout(()=>{console.log(" Sub-cue timer auto-stopping after hold - clearing local state"),Ws&&(clearInterval(Ws),ks(null)),Object.keys(At).forEach(Xe=>{At[parseInt(Xe)]&&clearInterval(At[parseInt(Xe)])}),cn({}),ye({}),_n(null),setTimeout(async()=>{try{if(Ae){console.log(" Clearing sub-cue timer from database after 3s delay with event ID:",Ae);const Xe=await qe.stopSubCueTimer(Ae);console.log(" Database stop result:",Xe),console.log(" Sub-cue timer stopped in database (is_active = false)")}else console.error(" No event ID available for database call")}catch(Xe){console.error(" Error stopping sub-cue timer in database:",Xe),console.error(" Error details:",Xe)}},3e3)},1e3)}return{...Q,remaining:Ce}})},1e3);cn(Q=>({...Q,[h]:P})),_n({itemId:h,remaining:C,duration:C,isActive:!0,startedAt:new Date,timerState:"running"});try{console.log(" User ID:",s.id,"Event ID:",e.id);const Q=T.find(Ae=>Ae.id===h),ce=T.findIndex(Ae=>Ae.id===h)+1,me=Q?zn(Q.customFields.cue):`CUE ${h}`,Ce=Q?.timerId||`SUB${h}`;try{console.log(" Starting sub-cue timer for item:",h,"(will auto-stop any existing timers)");const Ae=await qe.startSubCueTimer(e.id,h,s.id,C,ce,me,Ce);console.log(" Secondary timer started in Supabase for item:",h,"Result:",Ae),Ae?.error&&console.error(" Secondary timer database error:",Ae.error)}catch(Ae){console.error(" Secondary timer call failed:",Ae)}try{console.log(" Sub-cue timer started locally"),console.log(" Secondary timer action broadcasted")}catch(Ae){console.error(" Error broadcasting secondary timer action:",Ae)}await ro()}catch(Q){console.error(" Error starting secondary timer:",Q),clearInterval(P),cn(ce=>{const me={...ce};return delete me[h],me}),ye(ce=>{const me={...ce};return delete me[h],me})}}},Aa=async()=>{if(e?.id){console.log(" Stopping secondary timer..."),_n(null),Ws&&(clearInterval(Ws),ks(null)),Object.keys(At).forEach(h=>{At[parseInt(h)]&&clearInterval(At[parseInt(h)])}),cn({}),ye({}),console.log(" Local secondary timer state cleared");try{console.log(" Stopping sub-cue timer in database with event ID:",e.id);const h=await qe.stopSubCueTimer(e.id);console.log(" Database stop result:",h),console.log(" Secondary timer stopped in database (is_active = false)");try{console.log(" Broadcasting STOP_SECONDARY_TIMER action..."),console.log(" Sub-cue timer stopped locally"),console.log(" Secondary timer stop action broadcasted successfully")}catch(E){console.error(" Error broadcasting secondary timer stop action:",E)}}catch(h){console.error(" Error stopping sub-cue timer in database:",h),console.error(" Error details:",h)}try{await ro()}catch(h){console.error(" Error loading updated timer from Supabase:",h)}}},El=h=>{if(!h)return"";let E=h.toString().trim();return E=E.replace(/^CUE\s*/i,""),E=E.trim(),E},Jc=async h=>{try{console.log(" Processing Excel import:",h);const E=`This will add ${h.length} new items to your schedule. Continue?`;if(!window.confirm(E)){console.log(" Excel import cancelled by user");return}const C=h.map((P,Q)=>{const ce=P.duration?P.duration.split(":"):["0","0","0"],me=parseInt(ce[0])||0,Ce=parseInt(ce[1])||0,Ae=parseInt(ce[2])||0,Xe=Math.max(...T.map(De=>De.id),0)+Q+1;let We=P.speakers||"";if(P.speakers)try{const De=JSON.parse(P.speakers);if(Array.isArray(De)){const Je=De.map(ot=>({...ot,photoLink:ot.photoUrl||ot.photoLink||"",photoUrl:void 0}));We=JSON.stringify(Je)}}catch(De){console.warn("Failed to transform speaker data:",De)}return{id:Xe,segmentName:P.segmentName||`Imported Item ${Q+1}`,programType:P.programType||"",shotType:P.shotType||"",durationHours:me,durationMinutes:Ce,durationSeconds:Ae,notes:P.notes||"",assets:P.assets||"",speakers:We,speakersText:We,hasPPT:P.hasPPT||!1,hasQA:P.hasQA||!1,timerId:P.timerId||"",isPublic:P.isPublic||!1,isIndented:P.isIndented||!1,day:P.day||K,customFields:{cue:El(P.cue)||`CUE ${Q+1}`,...P.customFields}}});O(P=>[...P,...C]),console.log(" Imported items with assets:",C.filter(P=>P.assets).map(P=>({id:P.id,segmentName:P.segmentName,assets:P.assets}))),D("IMPORT_EXCEL",`Imported ${C.length} items from Excel`,{changeType:"IMPORT",itemCount:C.length,source:"Excel"}),console.log(" Excel import completed successfully")}catch(E){console.error(" Error importing Excel data:",E),alert("Error importing Excel data. Please check the file format and try again.")}},co=()=>{try{const h=T.length;O([]),D("DELETE_ALL",`Deleted all ${h} schedule items`,{changeType:"DELETE_ALL",itemCount:h,source:"Excel Import Modal"}),console.log(` Deleted all ${h} schedule items`)}catch(h){console.error(" Error deleting all schedule items:",h),alert("Error deleting schedule items. Please try again.")}},Yc=h=>{if(window.confirm("Delete this schedule item?")){const E=T.find(C=>C.id===h);if(O(C=>C.filter(P=>P.id!==h)),Vn(null),E){const C=T.findIndex(P=>P.id===h)+1;D("REMOVE_ITEM",`Deleted schedule item: "${E.segmentName}"`,{changeType:"DELETE",itemId:E.id,itemName:E.segmentName,rowNumber:C,cueNumber:E.customFields.cue?parseInt(E.customFields.cue,10):null,details:{day:E.day,programType:E.programType,shotType:E.shotType,position:`Row ${C}`,durationHours:E.durationHours,durationMinutes:E.durationMinutes,totalDurationMinutes:E.durationHours*60+E.durationMinutes,speakers:E.speakers||"None",speakersText:E.speakersText||"None",notes:E.notes||"",assets:E.assets||"None",hasPPT:E.hasPPT,hasQA:E.hasQA,timerId:E.timerId,isPublic:E.isPublic,isIndented:E.isIndented}})}}},kl=(h,E)=>{const C=T.findIndex(Ce=>Ce.id===h);if(C===-1)return;const P=E==="up"?C-1:C+1;if(P<0||P>=T.length)return;const Q=T[C],ce=C+1,me=P+1;O(Ce=>{const Ae=[...Ce];return[Ae[C],Ae[P]]=[Ae[P],Ae[C]],Ae}),Q&&D("MOVE_ITEM",`Moved "${Q.segmentName}" from row ${ce} to row ${me}`,{changeType:"MOVE",itemId:Q.id,itemName:Q.segmentName,details:{fromRow:ce,toRow:me,direction:E}}),Vn(null)},Qc=(h,E)=>{const C=T.findIndex(Ce=>Ce.id===h);if(C===-1)return;const P=E-1;if(P<0||P>=T.length||P===C)return;const Q=T[C],ce=C+1,me=E;O(Ce=>{const Ae=[...Ce],Xe=Ae[C];return Ae.splice(C,1),Ae.splice(P,0,Xe),Ae}),Q&&D("MOVE_ITEM",`Moved "${Q.segmentName}" from row ${ce} to row ${me}`,{changeType:"MOVE",itemId:Q.id,itemName:Q.segmentName,details:{fromRow:ce,toRow:me,direction:"specific"}}),Vn(null)},uo=h=>{const E=T[h];if(!E||E.isIndented)return"";const C=E.day||1,P=he[C]||we;if(!P)return"";let Q=0;for(let Je=0;Je<h;Je++){const ot=T[Je];(ot.day||1)===C&&!ot.isIndented&&(Q+=(ot.durationHours||0)*3600+(ot.durationMinutes||0)*60+(ot.durationSeconds||0))}const[ce,me]=P.split(":").map(Number),Ae=ce*3600+me*60+Q,Xe=Math.floor(Ae/3600)%24,We=Math.floor(Ae%3600/60),De=new Date;return De.setHours(Xe,We,0,0),De.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},Fn=()=>T.filter(h=>(h.day||1)===K);return R.useEffect(()=>{const h=()=>{const E=window.pageYOffset||document.documentElement.scrollTop;is(E>100)};return window.addEventListener("scroll",h),()=>window.removeEventListener("scroll",h)},[]),R.useEffect(()=>{const h=document.getElementById("main-scroll-container");if(!h)return;let E=!1;const C=(me,Ce)=>{E||(E=!0,Ce.scrollLeft=me.scrollLeft,requestAnimationFrame(()=>{E=!1}))},P=()=>{const me=document.querySelector(".sticky-header-scroll-container");me&&C(h,me)},Q=()=>{const me=document.querySelector(".sticky-header-scroll-container");me&&C(me,h)};h.addEventListener("scroll",P);const ce=new MutationObserver(()=>{const me=document.querySelector(".sticky-header-scroll-container");me&&me.addEventListener("scroll",Q)});return ce.observe(document.body,{childList:!0,subtree:!0}),()=>{h.removeEventListener("scroll",P),ce.disconnect()}},[]),R.useEffect(()=>{J!==null&&setTimeout(()=>{Bd()},100)},[J,gr]),R.useEffect(()=>{if(gr&&Object.keys(dt).length>0){const h=parseInt(Object.keys(dt)[0]),E=document.querySelector(`[data-item-id="${h}"]`);E&&setTimeout(()=>{const C=document.querySelector("#main-scroll-container .h-24");let P=100;if(C){const me=C.getBoundingClientRect(),Ce=document.querySelector("#main-scroll-container")?.getBoundingClientRect();Ce&&(P=me.bottom-Ce.top-120)}const Q=E.getBoundingClientRect(),ce=document.querySelector("#main-scroll-container")?.getBoundingClientRect();if(ce){const me=Q.top-ce.top-P;window.scrollTo({top:me,behavior:"smooth"})}},100)}},[dt,gr]),e?c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 text-slate-200",children:[!Ns&&c.jsxs("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 bg-yellow-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2",children:[c.jsx("div",{className:"w-2 h-2 bg-yellow-300 rounded-full animate-pulse"}),c.jsx("span",{className:"text-sm font-medium",children:"Tab Hidden - Syncing Paused"})]}),c.jsx(Qx,{isOpen:f,onClose:()=>m(!1),onRoleSelected:h=>{if(u(h),e?.id&&s?.id)try{const E=s.user_metadata?.full_name||s.email||"Unknown";qe.saveUserSession(e.id,s.id,E,h).then(C=>{C?console.log(" Role saved to Supabase from RunOfShowPage:",h):console.log(" Failed to save role to Supabase, using localStorage only")}),localStorage.setItem(`userRole_${e.id}`,h),console.log(" Saved role to localStorage from RunOfShowPage:",h)}catch(E){console.error(" Failed to save role to Supabase from RunOfShowPage:",E),localStorage.setItem(`userRole_${e.id}`,h),console.log(" Saved role to localStorage as fallback:",h)}m(!1)},eventId:e?.id||""}),Od&&di&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsx("div",{className:"bg-slate-800 rounded-lg p-6 max-w-md w-full mx-4 border-2 border-orange-500",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-orange-400 text-2xl font-bold mb-4",children:" Timer Running"}),c.jsx("div",{className:"text-white text-lg mb-2",children:c.jsx("strong",{children:di.cueName})}),c.jsxs("div",{className:"text-orange-300 text-xl font-mono mb-6",children:[di.remainingTime," remaining"]}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx("button",{onClick:()=>ml(!1),className:"px-6 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded transition-colors",children:"Dismiss"}),c.jsx("button",{onClick:()=>{ml(!1),$d()},className:"px-6 py-2 bg-orange-600 hover:bg-orange-500 text-white rounded transition-colors",children:"Sync Timer"})]})]})})}),p&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Change Log"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:()=>L(!1),className:`px-3 py-1 rounded text-sm transition-colors ${y?"bg-slate-600 text-slate-300 hover:bg-slate-500":"bg-blue-600 text-white"}`,children:["Local (",w.length,")"]}),c.jsxs("button",{onClick:()=>L(!0),className:`px-3 py-1 rounded text-sm transition-colors ${y?"bg-blue-600 text-white":"bg-slate-600 text-slate-300 hover:bg-slate-500"}`,children:["Master (",k.length,")"]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[!y&&c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:gl,className:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white text-sm rounded transition-colors",title:"Sync changes to Supabase",children:" Sync"}),c.jsx("button",{onClick:()=>{kr.reloadLocalChanges();const h=kr.getLocalChanges();_(h.slice(0,100)),console.log(" Manually reloaded local changes:",h.length)},className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",title:"Reload local changes",children:" Reload"})]}),y&&c.jsx("button",{onClick:fi,className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",title:"Reload master change log",children:" Reload"}),c.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-white text-2xl",children:""})]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto",children:y?k.length===0?c.jsx("p",{className:"text-gray-400 text-center py-8",children:"No master changes found"}):c.jsx("div",{className:"space-y-3",children:k.map(h=>c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:`text-white text-xs px-2 py-1 rounded ${h.action==="ADD_ITEM"?"bg-green-600":h.action==="REMOVE_ITEM"?"bg-red-600":h.action==="FIELD_UPDATE"?"bg-blue-600":h.action==="MOVE_ITEM"?"bg-yellow-600":h.action==="COLUMN_ADD"?"bg-purple-600":h.action==="COLUMN_REMOVE"?"bg-orange-600":"bg-blue-600"}`,children:h.action}),c.jsxs("span",{className:"text-gray-300 text-sm",children:["by ",h.user_name]}),c.jsxs("span",{className:"text-gray-500 text-xs",children:["(",h.user_role,")"]}),h.row_number&&c.jsxs("span",{className:"text-gray-400 text-xs bg-slate-600 px-2 py-1 rounded",children:["ROW ",h.row_number]}),h.cue_number&&h.cue_number!=="CUE"&&c.jsx("span",{className:"text-gray-400 text-xs bg-slate-600 px-2 py-1 rounded",children:zn(h.cue_number)})]}),c.jsx("div",{className:"text-gray-400 text-xs",children:new Date(h.timestamp||h.change_timestamp).toLocaleString()})]}),h.details&&c.jsxs("div",{className:"space-y-1 text-sm",children:[h.details.fieldName&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Field:"})," ",h.details.fieldName]}),h.details.oldValue!==void 0&&h.details.newValue!==void 0&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Changed from:"}),c.jsxs("span",{className:"text-red-300 ml-1",children:['"',h.details.oldValue,'"']}),c.jsx("span",{className:"text-slate-400 mx-1",children:""}),c.jsxs("span",{className:"text-green-300",children:['"',h.details.newValue,'"']})]}),h.batch_id&&c.jsxs("div",{className:"text-gray-500 text-xs mt-2 pt-2 border-t border-slate-600",children:["Batch: ",h.batch_id.slice(0,8),"... | Synced: ",new Date(h.batch_created_at).toLocaleString()]})]})]},h.id))}):w.length===0&&G.size===0?c.jsx("p",{className:"text-gray-400 text-center py-8",children:"No local changes recorded yet"}):c.jsxs("div",{className:"space-y-3",children:[w.map(h=>c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:`text-white text-xs px-2 py-1 rounded ${h.action==="ADD_ITEM"?"bg-green-600":h.action==="REMOVE_ITEM"?"bg-red-600":h.action==="FIELD_UPDATE"?"bg-blue-600":h.action==="MOVE_ITEM"?"bg-yellow-600":h.action==="COLUMN_ADD"?"bg-purple-600":h.action==="COLUMN_REMOVE"?"bg-orange-600":h.action==="AUTO_SAVE"?"bg-gray-600":"bg-blue-600"}`,children:h.action}),h.details?.processedBy&&c.jsx("span",{className:`text-white text-xs px-2 py-1 rounded ${h.details.processedBy==="TIMEOUT"?"bg-orange-600":h.details.processedBy==="SAVE_BUTTON"?"bg-purple-600":"bg-gray-600"}`,children:h.details.processedBy}),c.jsxs("span",{className:"text-gray-300 text-sm",children:["by ",h.userName]}),h.details?.itemId&&c.jsxs("span",{className:"text-gray-400 text-xs",children:["Item #",h.details.itemId]})]}),c.jsx("div",{className:"text-gray-400 text-xs",children:h.timestamp.toLocaleString()})]}),h.details&&c.jsxs("div",{className:"space-y-1 text-sm",children:[(h.details?.rowNumber||h.details?.cueNumber)&&c.jsx("div",{className:"text-gray-300",children:c.jsxs("strong",{children:["Row ",h.details?.rowNumber||"?"," | ",h.details?.cueNumber||"CUE"]})}),h.action==="ADD_ITEM"&&h.details.details&&c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Program Type:"})," ",h.details.details.programType]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Shot Type:"})," ",h.details.details.shotType]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Duration:"})," ",h.details.details.durationHours,"h ",h.details.details.durationMinutes,"m"]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Speakers:"})," ",h.details.details.speakers]}),h.details.details.notes&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Notes:"})," ",h.details.details.notes]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Position:"})," ",h.details.details.position]})]}),h.action==="REMOVE_ITEM"&&h.details.details&&c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Program Type:"})," ",h.details.details.programType]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Shot Type:"})," ",h.details.details.shotType]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Duration:"})," ",h.details.details.durationHours,"h ",h.details.details.durationMinutes,"m"]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Speakers:"})," ",h.details.details.speakers]}),h.details.details.notes&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Notes:"})," ",h.details.details.notes]})]}),h.action!=="ADD_ITEM"&&h.action!=="REMOVE_ITEM"&&h.details.fieldName&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Field:"})," ",h.details.fieldName]}),h.action!=="ADD_ITEM"&&h.action!=="REMOVE_ITEM"&&h.details.fieldName==="speakers"&&h.details.details&&c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Speaker Count:"})," ",h.details.details.speakerCount||0]}),h.details.newValue&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Speakers:"}),c.jsx("div",{className:"mt-1 text-sm text-blue-300",children:(()=>{try{const E=JSON.parse(h.details.newValue);if(Array.isArray(E))return E.sort((C,P)=>C.slot-P.slot).map(C=>`${C.slot}. ${C.fullName||C.name||"Unknown"} (${C.location||"Unknown"})`).join(", ")}catch{return"Unable to parse speakers"}return"No speakers"})()})]})]}),h.action!=="ADD_ITEM"&&h.action!=="REMOVE_ITEM"&&h.details.fieldName==="assets"&&h.details.details&&c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Asset Count:"})," ",h.details.details.assetCount||0]}),h.details.newValue&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Assets:"}),c.jsx("div",{className:"mt-1 text-sm text-blue-300",children:h.details.newValue.split("||").filter(C=>C.trim()).map(C=>{if(C.includes("|")){const[P,Q]=C.split("|");return`${P}${Q?` (${Q})`:""}`}return C}).join(", ")})]})]}),h.action==="MOVE_ITEM"&&h.details.details&&c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Moved from Row:"})," ",h.details.details.fromRow||"Unknown"]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Moved to Row:"})," ",h.details.details.toRow||"Unknown"]})]}),h.action!=="ADD_ITEM"&&h.action!=="REMOVE_ITEM"&&h.action!=="MOVE_ITEM"&&h.details.fieldName!=="speakers"&&h.details.fieldName!=="assets"&&h.details.oldValue!==void 0&&h.details.newValue!==void 0&&c.jsx("div",{className:"text-gray-300",children:h.details.fieldName==="durationHours"||h.details.fieldName==="durationMinutes"||h.details.fieldName==="durationSeconds"?c.jsx("span",{className:"text-green-300",children:h.details.newValue}):c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Changed from:"}),c.jsxs("span",{className:"text-red-300 ml-1",children:['"',h.details.oldValue,'"']}),c.jsx("span",{className:"text-gray-400 mx-1",children:""}),c.jsxs("span",{className:"text-green-300",children:['"',h.details.newValue,'"']})]})})]})]},h.id)),Array.from(G.entries()).map(([h,E])=>{const C=Date.now()-E.timestamp.getTime(),P=Math.max(0,1e4-C),Q=Math.ceil(P/1e3);return c.jsxs("div",{className:"bg-slate-600 rounded-lg p-4 border-2 border-yellow-500 animate-pulse",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("span",{className:"bg-yellow-600 text-white text-xs px-2 py-1 rounded",children:["PENDING [",E.originalKey||"NO_KEY","]"]}),c.jsxs("span",{className:"text-slate-300 text-sm",children:["by ",E.user]}),c.jsxs("span",{className:"text-yellow-300 text-xs",children:[" Will confirm in ",Q,"s"]})]}),c.jsx("div",{className:"text-slate-400 text-xs",children:E.timestamp.toLocaleString()})]}),E.details&&c.jsxs("div",{className:"space-y-1 text-sm",children:[(E.details?.rowNumber||E.details?.cueNumber)&&c.jsx("div",{className:"text-slate-300",children:c.jsxs("strong",{children:["Row ",E.details?.rowNumber||"?"," | ",E.details?.cueNumber||"CUE"]})}),E.details.fieldName&&c.jsxs("div",{className:"text-slate-300",children:[c.jsx("strong",{children:"Field:"})," ",E.details.fieldName]}),E.details.oldValue!==void 0&&E.details.newValue!==void 0&&c.jsxs("div",{className:"text-slate-300",children:[c.jsx("strong",{children:"Will change from:"}),c.jsxs("span",{className:"text-red-300 ml-1",children:['"',E.details.oldValue,'"']}),c.jsx("span",{className:"text-slate-400 mx-1",children:""}),c.jsxs("span",{className:"text-green-300",children:['"',E.details.newValue,'"']})]})]})]},h)})]})}),c.jsx("div",{className:"mt-4 pt-4 border-t border-slate-600",children:c.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-400",children:[c.jsxs("div",{children:[c.jsxs("span",{children:["Total changes: ",w.length," (",G.size," pending)"]}),G.size>0&&c.jsx("span",{className:"ml-2 text-yellow-400",children:" Changes will be confirmed after 10s of inactivity"})]}),c.jsxs("div",{className:"flex gap-2",children:[G.size>0&&c.jsxs("button",{className:"px-3 py-1 bg-yellow-600 text-white rounded transition-colors animate-pulse cursor-not-allowed",disabled:!0,title:"Changes are pending and will auto-save after 5 seconds",children:[" Changes Pending (",G.size,")"]}),c.jsx("button",{onClick:Ud,className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",title:"Clear all change logs (password protected)",children:" Clear All Logs"})]})]})})]})}),c.jsx("style",{children:`
          select {
            border: 2px solid #64748b !important;
            border-radius: 6px !important;
          }
          select:focus {
            border-color: #3b82f6 !important;
            outline: none !important;
          }
          select option {
            background-color: #1e293b !important;
            color: #ffffff !important;
            border-bottom: 1px solid #475569 !important;
            padding: 8px 12px !important;
            margin: 0 !important;
          }
          select option:hover {
            background-color: #334155 !important;
          }
          select option:checked {
            background-color: #3b82f6 !important;
          }
        `}),c.jsx("div",{className:"fixed top-16 left-0 right-0 z-40 bg-slate-900 shadow-lg border-b border-slate-600",style:{height:xa?"240px":"150px"},children:c.jsxs("div",{className:"py-2 pt-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2 px-8",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:()=>r("/"),className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:" Back to Events"}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:h=>{h.stopPropagation(),$e(!Qe)},className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",title:"Menu",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),Qe&&c.jsx("div",{className:"absolute top-full left-0 mt-1 w-48 bg-slate-800 border border-slate-600 rounded-lg shadow-lg z-50",children:c.jsxs("div",{className:"py-1",children:[c.jsxs("button",{onClick:()=>{$e(!1),ii(!0)},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Display Timer"]}),c.jsxs("button",{onClick:()=>{$e(!1);const h=`/reports?eventId=${e?.id}&eventName=${encodeURIComponent(e?.name||"")}`;window.open(h,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Reports and Printing"]}),c.jsxs("button",{onClick:()=>{$e(!1);const h=`/graphics-links?eventId=${e?.id}&eventName=${encodeURIComponent(e?.name||"")}`;window.open(h,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Graphic Links"]}),c.jsxs("button",{onClick:()=>{$e(!1);const h=`/photo-view?eventId=${e?.id}&eventName=${encodeURIComponent(e?.name||"")}&eventDate=${encodeURIComponent(e?.date||"")}&eventLocation=${encodeURIComponent(e?.location||"")}`;window.open(h,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"PhotoView"]}),c.jsxs("button",{onClick:()=>{$e(!1),console.log("=== CSV EXPORT ==="),console.log("Event:",e),console.log("Schedule length:",T.length),console.log("Full schedule:",T),console.log("Master start time:",we);const h=["ROW","CUE","Program Type","Shot Type","Segment Name","Duration","Start Time","End Time","Notes","Assets","Speakers","Has PPT","Has QA","Timer ID","Is Public","Is Indented","Day"],E=H.map(Xe=>Xe.name),C=[...h,...E],Q=T.filter(Xe=>(Xe.day||1)===K).map((Xe,We)=>{const De=T.findIndex(dn=>dn.id===Xe.id),Je=uo(De),ot=`${Xe.durationHours}:${Xe.durationMinutes.toString().padStart(2,"0")}:${Xe.durationSeconds.toString().padStart(2,"0")}`,Vt=Je?(()=>{const[dn,Rs,pi]=Je.split(":").map(Number),[Zd,e0,Zc]=ot.split(":").map(Number);let Ra=dn*3600+Rs*60+pi+(Zd*3600+e0*60+Zc);const fo=Math.floor(Ra/3600),Tl=Math.floor(Ra%3600/60),Nl=Ra%60;return`${fo.toString().padStart(2,"0")}:${Tl.toString().padStart(2,"0")}:${Nl.toString().padStart(2,"0")}`})():"",zt=[We+1,Xe.customFields?.cue||`CUE ${We+1}`,Xe.programType||"",Xe.shotType||"",Xe.segmentName||"",ot,Je||"",Vt,Xe.notes||"",Xe.assets||"",Xe.speakersText||"",Xe.hasPPT?"Yes":"No",Xe.hasQA?"Yes":"No",Xe.timerId||"",Xe.isPublic?"Yes":"No",Xe.isIndented?"Yes":"No",Xe.day||1],Ir=H.map(dn=>Xe.customFields[dn.id]||"");return[...zt,...Ir]}),ce=[C.join(","),...Q.map(Xe=>Xe.map(We=>typeof We=="string"&&(We.includes(",")||We.includes('"')||We.includes(`
`))?`"${We.replace(/"/g,'""')}"`:We).join(","))].join(`
`);console.log("CSV Content:",ce);const me=new Blob([ce],{type:"text/csv;charset=utf-8;"}),Ce=URL.createObjectURL(me),Ae=document.createElement("a");Ae.href=Ce,Ae.download=`${e?.name||"RunOfShow"}_Day${K}_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(Ae),Ae.click(),document.body.removeChild(Ae),URL.revokeObjectURL(Ce),console.log("=== END CSV EXPORT ===")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export CSV"]}),c.jsxs("button",{onClick:()=>{$e(!1),Ic(!0)},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Import Excel"]}),c.jsxs("button",{onClick:()=>{$e(!1),ya(!0)},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Backups"]}),c.jsxs("button",{onClick:()=>{$e(!1);const h=`/green-room?eventId=${e?.id}&eventName=${encodeURIComponent(e?.name||"")}&eventDate=${e?.date||""}&eventLocation=${encodeURIComponent(e?.location||"")}`;window.open(h,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Green Room"]}),c.jsxs("button",{onClick:()=>{$e(!1),Rc(!0)},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"OSC Control"]})]})})]})]}),c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-white font-semibold",children:"Event Name:"}),c.jsx("div",{className:"px-4 py-2 bg-slate-700 border-2 border-slate-600 rounded-lg text-white w-80 truncate",children:X||"No Event Name"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-white font-semibold",children:"Start Time:"}),c.jsx("input",{type:"time",value:e?.numberOfDays&&e.numberOfDays>1?he[K]||"":we,onChange:h=>{if(Xt(),l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can change start time. Please change your role to EDITOR.");return}e?.numberOfDays&&e.numberOfDays>1?ae(E=>({...E,[K]:h.target.value})):Ne(h.target.value)},disabled:l==="VIEWER"||l==="OPERATOR",className:"px-4 py-2 border-2 rounded-lg focus:outline-none w-36 transition-colors bg-slate-700 border-slate-600 text-white focus:border-blue-500",style:{colorScheme:"dark"},title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can change start time":`Set ${e?.numberOfDays&&e.numberOfDays>1?`Day ${K}`:"master"} start time`})]})]}),c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsx("div",{className:"text-center",children:Object.keys(dt).length>0?c.jsxs("div",{className:"text-lg text-green-400 font-bold",children:["RUNNING - ",zn(T.find(h=>dt[h.id])?.customFields.cue),Mt&&c.jsxs("div",{className:"text-lg text-orange-400 mt-0.5 font-bold",children:[zn(T.find(h=>h.id===Mt.itemId)?.customFields.cue)," - ",ao(Mt.remaining)]})]}):J&&Y[J]?c.jsxs("div",{className:"text-lg text-yellow-400 font-bold",children:["LOADED - ",zn(T.find(h=>h.id===J)?.customFields.cue)]}):c.jsx("div",{className:"text-lg text-slate-300 font-bold",children:"No CUE Selected"})}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"text-3xl font-mono bg-slate-800 px-6 py-3 rounded-lg border border-slate-600",style:{color:Hc()},children:Gd(Wc())}),J&&c.jsx("div",{className:"absolute bottom-1 right-1",children:c.jsx(xh,{itemId:J,className:"flex-shrink-0"})})]})]})]}),c.jsx("div",{className:"px-8 mb-2",children:c.jsx("div",{className:"w-full h-2 bg-slate-700 rounded-full overflow-hidden border border-slate-600 relative",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${wl()}%`,background:bl()}})})}),c.jsx("div",{className:"px-8 pb-2",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"text-sm text-slate-300",children:["Role: ",c.jsx("span",{className:"font-semibold text-white",children:l})]}),c.jsx("button",{onClick:()=>m(!0),className:"px-3 py-1 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded transition-colors",title:"Change your role",children:"Change Role"}),c.jsx("button",{onClick:Gc,className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",title:"Create a manual backup of current data",children:" Create Backup"}),Gs&&c.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 bg-yellow-600 rounded text-sm",children:[c.jsx("div",{className:"w-2 h-2 bg-yellow-200 rounded-full animate-pulse"}),c.jsx("span",{className:"text-yellow-100 font-medium",children:"Editing - Sync Paused"})]}),!Gs&&Ns&&c.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 bg-blue-600 rounded text-sm",children:[c.jsx("div",{className:"w-2 h-2 bg-blue-200 rounded-full animate-pulse"}),c.jsx("span",{className:"text-blue-100 font-medium",children:ui?"Syncing...":`Next sync in ${ka}s`})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>sl(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm font-medium rounded transition-colors",title:"Open Filter View",children:"Filter View"}),c.jsx("button",{onClick:()=>Id(!Sa),className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${Sa?"bg-green-600 hover:bg-green-500":"bg-slate-600 hover:bg-slate-500"}`,title:Sa?"Disable Time Toast":"Enable Time Toast",children:" Time Toast"}),c.jsx("button",{onClick:()=>Fc(!gr),className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${gr?"bg-purple-600 hover:bg-purple-500 ring-4 ring-inset ring-green-400":"bg-purple-600 hover:bg-purple-500"}`,title:gr?"Disable auto-scroll to active row":"Enable auto-scroll to active row",children:" Follow"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-medium",children:"Duration:"}),c.jsx("button",{onClick:async()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await gi(-300)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-700 hover:bg-red-600"}`,disabled:l==="VIEWER"||l==="EDITOR",title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can adjust timer duration":"Subtract 5 minutes",children:"-5"}),c.jsx("button",{onClick:async()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await gi(-60)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-600 hover:bg-red-500"}`,disabled:l==="VIEWER"||l==="EDITOR",title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can adjust timer duration":"Subtract 1 minute",children:"-1"}),c.jsx("button",{onClick:async()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await gi(60)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500"}`,disabled:l==="VIEWER"||l==="EDITOR",title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can adjust timer duration":"Add 1 minute",children:"+1"}),c.jsx("button",{onClick:async()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await gi(300)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-700 hover:bg-blue-600"}`,disabled:l==="VIEWER"||l==="EDITOR",title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can adjust timer duration":"Add 5 minutes",children:"+5"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can send messages. Please change your role to OPERATOR.");return}Wn(!0)},className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":fr?"bg-purple-600 hover:bg-purple-500 ring-4 ring-inset ring-green-500":"bg-purple-600 hover:bg-purple-500"}`,disabled:l==="VIEWER"||l==="EDITOR",title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can send messages":"Send Messages to Full Screen Timer",children:"Messages"}),fr&&c.jsx("button",{onClick:async()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can control messages. Please change your role to OPERATOR.");return}try{if(e?.id){const E=(await qe.getTimerMessagesForEvent(e.id)).find(C=>C.enabled);E&&(await qe.disableTimerMessage(E.id),console.log(" Message disabled in Supabase via Turn Off button"))}}catch(h){console.error(" Error disabling message in Supabase:",h)}va(!1),un(""),Pe&&!Pe.closed&&Pe.postMessage({type:"MESSAGE_UPDATE",message:"",enabled:!1},"*")},className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500 animate-pulse"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot control messages":"Turn Off Message",children:"Click to Turn Off"})]})]})]})}),c.jsx("div",{className:`px-8 transition-all duration-500 ease-in-out overflow-hidden ${xa?"max-h-80 opacity-100 -mb-6":"max-h-0 opacity-0 mb-0"}`,children:c.jsx("div",{className:"bg-slate-800 rounded-xl p-4 shadow-2xl",style:{transform:"scale(0.75)",transformOrigin:"top center",width:"127.67%",marginLeft:"-13.83%"},children:c.jsxs("div",{className:"flex border-2 border-slate-600 rounded-lg overflow-hidden bg-slate-900",children:[c.jsx("div",{className:"w-12 flex-shrink-0 bg-slate-900 border-r-2 border-slate-600",children:c.jsx("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold text-xs",children:"#"})})}),c.jsx("div",{className:"w-40 flex-shrink-0 bg-slate-900",style:{borderRight:"6px solid #475569"},children:c.jsx("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:c.jsxs("span",{className:"text-white font-bold text-lg flex items-center gap-1",children:["CUE",l==="VIEWER"&&c.jsx("span",{className:"text-yellow-400",title:"Viewers cannot edit CUE",children:""})]})})}),c.jsx("div",{className:"flex-1 overflow-x-auto sticky-header-scroll-container",style:{scrollbarWidth:"thin"},children:c.jsx("div",{className:"min-w-max",children:c.jsxs("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex",children:[pt.start&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.start},children:[c.jsx("span",{className:"text-white font-bold",children:"Start"}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"start")})]}),pt.programType&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.programType},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Program Type",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"programType")})]}),pt.duration&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.duration},children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-white font-bold flex items-center justify-center gap-1",children:["Duration",l==="VIEWER"&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"text-xs text-slate-400",children:"HH MM SS"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"duration")})]}),pt.segmentName&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.segmentName},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Segment Name",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"segmentName")})]}),pt.shotType&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.shotType},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Shot Type",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"shotType")})]}),pt.pptQA&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.pptQA},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["PPT/Q&A",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"pptQA")})]}),pt.notes&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.notes},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Notes",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"notes")})]}),pt.assets&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.assets},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Assets",l==="VIEWER"&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for VIEWERs",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"assets")})]}),pt.participants&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.participants},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Participants",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"participants")})]}),pt.speakers&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.speakers},children:[c.jsx("span",{className:"text-white font-bold",children:"Speakers"}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"speakers")})]}),pt.public&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.public},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Public",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"public")})]}),H.map(h=>zs[h.id]!==!1&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center relative flex-shrink-0",style:{width:js[h.id]||256},children:[c.jsx("span",{className:"text-white font-bold",children:h.name}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:E=>oo(E,h.id)})]},h.id))]})})}),c.jsx("div",{className:"w-32 flex-shrink-0 bg-slate-900",style:{borderLeft:"6px solid #475569"},children:c.jsx("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:c.jsxs("span",{className:"text-white font-bold text-base flex items-center gap-1",children:["Timer",(l==="VIEWER"||l==="EDITOR")&&c.jsx("span",{className:"text-yellow-400",title:"Only OPERATORs can control timers",children:""})]})})})]})})})]})}),c.jsx("div",{className:"max-w-[95%] mx-auto px-6",style:{paddingTop:"250px"},children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 shadow-2xl",style:{transform:"scale(0.75)",transformOrigin:"top center",width:"133.33%",marginLeft:"-16.67%"},children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Schedule",e?.numberOfDays&&e.numberOfDays>1?` - Day ${K}`:""," - TRT ",(()=>{const h=Vd();return`${h.hours}h ${h.minutes}m ${h.seconds}s`})()]}),s&&c.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[c.jsxs("button",{onClick:()=>v(!0),className:"text-xs bg-purple-600 hover:bg-purple-500 text-white px-2 py-1 rounded transition-colors",title:"View change history",children:[" Change Log (",w.length+G.size,")",kr.getChangesCount().unsynced>0&&c.jsxs("span",{className:"ml-1 text-yellow-400",children:["(",kr.getChangesCount().unsynced," unsynced)"]})]}),Ea>0&&c.jsx("button",{onClick:async()=>{await ee()},className:"text-xs bg-yellow-600 hover:bg-yellow-500 text-white px-2 py-1 rounded transition-colors animate-pulse",title:`${Ea} unsynced change${Ea!==1?"s":""} - Click to sync`,children:Ea}),G.size>0&&c.jsxs("button",{className:"text-xs bg-yellow-600 text-white px-2 py-1 rounded transition-colors animate-pulse cursor-not-allowed",title:"Changes are pending and will auto-save after 5 seconds",disabled:!0,children:[" Changes Pending (",G.size,")"]})]})]}),c.jsxs("div",{className:"flex gap-3",children:[e?.numberOfDays&&e.numberOfDays>1&&c.jsxs("div",{className:"flex items-center gap-3 mr-4",children:[c.jsx("label",{className:"text-white font-bold text-base",children:"Day:"}),c.jsx("select",{value:K,onChange:h=>{Xt(),oe(parseInt(h.target.value))},className:"px-4 py-2 bg-slate-700 border-2 border-slate-600 rounded-lg text-white focus:border-blue-500 focus:outline-none text-base font-semibold w-20",children:Array.from({length:e.numberOfDays},(h,E)=>c.jsx("option",{value:E+1,children:E+1},E+1))})]}),c.jsx("button",{onClick:()=>{if(l==="VIEWER"){alert("Viewers cannot add items. Please change your role to EDITOR or OPERATOR.");return}br(),fe(!0),_r({cue:"",day:K,programType:"PreShow/End",shotType:"",segmentName:"",durationHours:0,durationMinutes:0,durationSeconds:0,notes:"",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!1,timerId:"",isPublic:!1,isIndented:!1,customFields:{}})},className:`px-4 py-2 font-medium rounded text-sm transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Only EDITORs and OPERATORs can add items":"Add new item",children:"+ Item"}),c.jsx("button",{onClick:()=>{if(l==="VIEWER"){alert("Viewers cannot add columns. Please change your role to EDITOR or OPERATOR.");return}br(),Fe(!0)},className:`px-4 py-2 font-medium rounded text-sm transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot add columns":"Add custom column",children:"+ Column"}),c.jsx("button",{onClick:async()=>{if(l==="VIEWER"){alert("Viewers cannot reset the schedule. Please change your role to EDITOR or OPERATOR.");return}await Kd()},className:`px-4 py-2 font-medium rounded text-sm transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-600 hover:bg-red-700 text-white"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot reset the schedule":"Reset all states",children:"Reset"})]})]}),c.jsxs("div",{className:"flex border-2 border-slate-600 rounded-lg overflow-hidden bg-slate-900",children:[c.jsxs("div",{className:"w-12 flex-shrink-0 bg-slate-900 border-r-2 border-slate-600",children:[c.jsx("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold text-xs",children:"#"})}),Fn().length===0?c.jsx("div",{className:"h-24 flex items-center justify-center text-slate-500",children:"-"}):Fn().map((h,E)=>c.jsx("div",{className:`border-b-2 border-slate-600 flex items-center justify-center gap-1 ${dt[h.id]?"bg-green-900 border-green-500":J===h.id?"bg-blue-900 border-blue-500":cl.has(h.id)?"bg-amber-800 border-amber-600":si[h.id]||ll.has(h.id)?"bg-gray-900 border-gray-700 opacity-40":E%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:Sn(h.notes,h.speakersText,h.speakers,h.customFields,H)},children:c.jsxs("div",{className:"flex flex-col items-center gap-1",children:[c.jsx("button",{onClick:()=>{if(l==="VIEWER"){alert("Viewers cannot jump to rows. Please change your role to EDITOR or OPERATOR.");return}console.log(" Row jump button clicked - pausing sync"),cs(!0),Ks&&clearTimeout(Ks),setTimeout(()=>{const C=prompt(`Move to row (1-${Fn().length}):`,(E+1).toString());console.log(" Row jump prompt closed - resuming sync in 5 seconds");const P=setTimeout(()=>{console.log(" User stopped editing - resuming sync"),cs(!1)},5e3);Rr(P),C&&!isNaN(Number(C))&&Qc(h.id,Number(C))},0)},className:`w-5 h-5 text-white rounded flex items-center justify-center text-xs font-bold transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-purple-600 hover:bg-purple-500"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot jump to rows":"Jump to Row",children:"#"}),c.jsx("span",{className:"text-white font-bold text-lg",children:E+1}),c.jsx("button",{onClick:()=>{if(l==="VIEWER"){alert("Viewers cannot add rows. Please change your role to EDITOR or OPERATOR.");return}br(),z(E),fe(!0)},className:`w-5 h-5 text-white rounded flex items-center justify-center text-xs font-bold transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot add rows":`Insert row after row ${E+1}`,children:"+"})]})},`${h.id}-${h.notes?.length||0}-${h.speakers?.length||0}`))]}),c.jsxs("div",{className:"w-40 flex-shrink-0 bg-slate-900",style:{borderRight:"6px solid #475569"},children:[c.jsx("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:c.jsxs("span",{className:"text-white font-bold text-lg flex items-center gap-1",children:["CUE",l==="VIEWER"&&c.jsx("span",{className:"text-yellow-400",title:"Viewers cannot edit CUE",children:""})]})}),Fn().length===0?c.jsx("div",{className:"h-24 flex items-center justify-center text-slate-500",children:"No items"}):Fn().map((h,E)=>c.jsxs("div",{className:`border-b-2 border-slate-600 flex flex-col items-center justify-center gap-1 ${E%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:Sn(h.notes,h.speakersText,h.speakers,h.customFields,H)},children:[c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:`flex items-center px-1 py-1 border border-slate-600 border-r-0 rounded-l text-white text-lg font-medium min-w-[40px] ${ul===h.id?"bg-purple-600":"bg-slate-600"}`,children:"CUE"}),c.jsx("input",{type:"text",value:h.customFields.cue?h.customFields.cue.replace(/^CUE\s*/,""):"",onChange:C=>{if(Xt(),l==="VIEWER"){alert("Viewers cannot edit cue names. Please change your role to EDITOR or OPERATOR.");return}const P=h.customFields.cue||"CUE ",Q=C.target.value?`CUE ${C.target.value}`:"CUE ";O(ce=>ce.map(me=>me.id===h.id?{...me,customFields:{...me.customFields,cue:Q}}:me)),V(`cue_${h.id}`,"FIELD_UPDATE",`Updated cue for "${h.segmentName}" from "${P}" to "${Q}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"cue",oldValue:P,newValue:Q,details:{fieldType:"text",characterChange:Q.length-P.length}})},disabled:l==="VIEWER",className:"w-14 px-1 py-1 border border-slate-600 rounded-r text-center text-lg transition-colors bg-slate-700 text-white focus:outline-none focus:border-blue-500",title:l==="VIEWER"?"Viewers cannot edit cue names":"Edit cue number",maxLength:4})]}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>{if(Xt(),l==="VIEWER"){alert("Viewers cannot indent/unindent items. Please change your role to EDITOR or OPERATOR.");return}const C=h.isIndented;O(P=>P.map(Q=>Q.id===h.id?{...Q,isIndented:!Q.isIndented}:Q)),D("FIELD_UPDATE",`Updated indentation for "${h.segmentName}" from ${C} to ${!C}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"isIndented",oldValue:C,newValue:!C,details:{fieldType:"boolean",booleanChange:!0}})},className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot indent/unindent items":h.isIndented?"Unindent (group with row above)":"Indent (group with row above)",children:h.isIndented?"":""}),c.jsx("button",{onClick:()=>{if(Xt(),l==="VIEWER"){alert("Viewers cannot move items. Please change your role to EDITOR or OPERATOR.");return}kl(h.id,"up")},disabled:E===0||l==="VIEWER",className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500 disabled:opacity-30 disabled:cursor-not-allowed"}`,title:l==="VIEWER"?"Viewers cannot move items":"Move Up",children:""}),c.jsx("button",{onClick:()=>{if(Xt(),l==="VIEWER"){alert("Viewers cannot move items. Please change your role to EDITOR or OPERATOR.");return}kl(h.id,"down")},disabled:E===Fn().length-1||l==="VIEWER",className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500 disabled:opacity-30 disabled:cursor-not-allowed"}`,title:l==="VIEWER"?"Viewers cannot move items":"Move Down",children:""}),c.jsx("button",{onClick:()=>{if(Xt(),l==="VIEWER"){alert("Viewers cannot delete items. Please change your role to EDITOR or OPERATOR.");return}Yc(h.id)},className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-600 hover:bg-red-500"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot delete items":"Delete",children:""})]})]},`${h.id}-${h.notes?.length||0}-${h.speakers?.length||0}`))]}),c.jsx("div",{id:"main-scroll-container",className:"flex-1 overflow-x-auto",style:{scrollbarWidth:"thin"},children:c.jsxs("div",{className:"min-w-max",children:[c.jsxs("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex",children:[pt.start&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.start},children:[c.jsx("span",{className:"text-white font-bold",children:"Start"}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"start")})]}),pt.programType&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.programType},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Program Type",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"programType")})]}),pt.duration&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.duration},children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-white font-bold flex items-center justify-center gap-1",children:["Duration",l==="VIEWER"&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"text-xs text-slate-400",children:"HH MM SS"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"duration")})]}),pt.segmentName&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.segmentName},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Segment Name",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"segmentName")})]}),pt.shotType&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.shotType},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Shot Type",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"shotType")})]}),pt.pptQA&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.pptQA},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["PPT/Q&A",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"pptQA")})]}),pt.notes&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.notes},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Notes",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"notes")})]}),pt.assets&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.assets},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Assets",l==="VIEWER"&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for VIEWERs",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"assets")})]}),pt.participants&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.participants},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Participants",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"participants")})]}),pt.speakers&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.speakers},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Speakers",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"speakers")})]}),pt.public&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:vt.public},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Public",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:""})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Kt(h,"public")})]}),H.map(h=>zs[h.id]!==!1&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center relative flex-shrink-0",style:{width:js[h.id]||256},children:[c.jsx("span",{className:"text-white font-bold",children:h.name}),c.jsx("button",{onClick:()=>{window.confirm(`Are you sure you want to remove the "${h.name}" column? This will delete all data in this column.`)&&Sl(h.id)},className:"absolute top-1 right-1 w-6 h-6 bg-red-600 hover:bg-red-700 text-white rounded-md text-base font-bold flex items-center justify-center transition-colors shadow-md hover:shadow-lg",title:`Remove "${h.name}" column`,children:""}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:E=>oo(E,h.id)})]},h.id))]}),Fn().length===0?c.jsxs("div",{className:"h-24 flex items-center justify-center text-slate-500 text-xl",children:["No schedule items for Day ",K,'. Click "Add Schedule Item" to start!']}):Fn().map((h,E)=>c.jsxs("div",{"data-item-id":h.id,className:`border-b-2 border-slate-600 flex ${dt[h.id]?"bg-green-950":J===h.id?"bg-blue-950":cl.has(h.id)?"bg-amber-950 border-amber-600":si[h.id]||ll.has(h.id)?"bg-gray-900 opacity-40":ul===h.id?"bg-purple-950 border-purple-400":E%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:Sn(h.notes,h.speakersText,h.speakers,h.customFields,H)},children:[pt.start&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:vt.start},children:c.jsx("span",{className:"text-white font-mono text-base font-bold",children:h.isIndented?"":uo(E)})}),pt.programType&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:vt.programType},children:c.jsx("select",{value:h.programType,onFocus:()=>{console.log(" Program Type dropdown focused - pausing sync"),br()},onChange:C=>{if(l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can edit program type. Please change your role to EDITOR.");return}const P=h.programType;O(Q=>Q.map(ce=>ce.id===h.id?{...ce,programType:C.target.value}:ce)),V(`programType_${h.id}`,"FIELD_UPDATE",`Updated program type for "${h.segmentName}" from "${P}" to "${C.target.value}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"programType",oldValue:P,newValue:C.target.value,details:{fieldType:"select",optionChange:!0}}),Br()},disabled:l==="VIEWER"||l==="OPERATOR",className:"w-full px-3 py-2 border-2 rounded text-base transition-colors bg-slate-700 border-slate-500 text-white focus:border-blue-500",style:{backgroundColor:so[h.programType]||"#374151",color:h.programType==="Sub Cue"?"#000000":"#ffffff",opacity:1},title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can edit program type":"Select program type",children:Mc.map(C=>c.jsx("option",{value:C,style:{backgroundColor:so[C]||"#374151",color:C==="Sub Cue"?"#000000":"#ffffff"},children:C},C))})}),pt.duration&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:vt.duration},children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",min:"0",max:"23",value:h.durationHours,onChange:C=>{if(Xt(),l==="VIEWER"){alert("Only EDITORs and OPERATORs can edit duration. Please change your role to EDITOR or OPERATOR.");return}const P=h.durationHours,Q=parseInt(C.target.value)||0;O(ce=>ce.map(me=>me.id===h.id?{...me,durationHours:Q}:me)),V(`durationHours_${h.id}`,"FIELD_UPDATE",`Updated duration hours for "${h.segmentName}" from ${P} to ${Q}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"durationHours",oldValue:P,newValue:Q,details:{fieldType:"number",timeChange:Q-P}})},disabled:l==="VIEWER",className:"w-14 px-2 py-2 border border-slate-600 rounded text-center text-lg font-mono font-bold transition-colors bg-slate-700 text-white",style:{opacity:1},title:l==="VIEWER"?"Only EDITORs and OPERATORs can edit duration":"Edit hours"}),c.jsx("span",{className:"text-slate-400 text-xl font-bold",children:":"}),c.jsx("input",{type:"number",min:"0",max:"59",value:h.durationMinutes,onChange:C=>{if(Xt(),l==="VIEWER"){alert("Only EDITORs and OPERATORs can edit duration. Please change your role to EDITOR or OPERATOR.");return}const P=h.durationMinutes,Q=parseInt(C.target.value)||0;O(ce=>ce.map(me=>me.id===h.id?{...me,durationMinutes:Q}:me)),V(`durationMinutes_${h.id}`,"FIELD_UPDATE",`Updated duration minutes for "${h.segmentName}" from ${P} to ${Q}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"durationMinutes",oldValue:P,newValue:Q,details:{fieldType:"number",timeChange:Q-P}})},disabled:l==="VIEWER",className:"w-14 px-2 py-2 border border-slate-600 rounded text-center text-lg font-mono font-bold transition-colors bg-slate-700 text-white",style:{opacity:1},title:l==="VIEWER"?"Only EDITORs and OPERATORs can edit duration":"Edit minutes"}),c.jsx("span",{className:"text-slate-400 text-xl font-bold",children:":"}),c.jsx("input",{type:"number",min:"0",max:"59",value:h.durationSeconds,onChange:C=>{if(Xt(),l==="VIEWER"){alert("Only EDITORs and OPERATORs can edit duration. Please change your role to EDITOR or OPERATOR.");return}const P=h.durationSeconds,Q=parseInt(C.target.value)||0;O(ce=>ce.map(me=>me.id===h.id?{...me,durationSeconds:Q}:me)),V(`durationSeconds_${h.id}`,"FIELD_UPDATE",`Updated duration seconds for "${h.segmentName}" from ${P} to ${Q}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"durationSeconds",oldValue:P,newValue:Q,details:{fieldType:"number",timeChange:Q-P}})},disabled:l==="VIEWER",className:"w-14 px-2 py-2 border border-slate-600 rounded text-center text-lg font-mono font-bold transition-colors bg-slate-700 text-white",style:{opacity:1},title:l==="VIEWER"?"Only EDITORs and OPERATORs can edit duration":"Edit seconds"})]})}),pt.segmentName&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:vt.segmentName},children:c.jsx("input",{type:"text",value:h.segmentName,onChange:C=>{if(Xt(),l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can edit segment names. Please change your role to EDITOR.");return}const P=h.segmentName;O(Q=>Q.map(ce=>ce.id===h.id?{...ce,segmentName:C.target.value}:ce)),V(`segmentName_${h.id}`,"FIELD_UPDATE",`Updated segment name for "${P}" to "${C.target.value}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:C.target.value,fieldName:"segmentName",oldValue:P,newValue:C.target.value,details:{fieldType:"text",characterChange:C.target.value.length-P.length}})},disabled:l==="VIEWER"||l==="OPERATOR",className:"w-full px-3 py-2 border border-slate-600 rounded text-base transition-colors bg-slate-700 text-white",placeholder:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can edit":"Enter segment name",title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can edit segment names":"Edit segment name"})}),pt.shotType&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:vt.shotType},children:c.jsxs("select",{value:h.shotType,onFocus:()=>{console.log(" Shot Type dropdown focused - pausing sync"),br()},onChange:C=>{if(l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can edit shot type. Please change your role to EDITOR.");return}const P=h.shotType;O(Q=>Q.map(ce=>ce.id===h.id?{...ce,shotType:C.target.value}:ce)),V(`shotType_${h.id}`,"FIELD_UPDATE",`Updated shot type for "${h.segmentName}" from "${P}" to "${C.target.value}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"shotType",oldValue:P,newValue:C.target.value,details:{fieldType:"select",optionChange:!0}}),Br()},disabled:l==="VIEWER"||l==="OPERATOR",className:"w-full px-3 py-2 border border-slate-600 rounded text-base transition-colors bg-slate-700 text-white",style:{opacity:1},title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can edit shot type":"Select shot type",children:[c.jsx("option",{value:"",children:"Select Shot Type"}),Ca.map(C=>c.jsx("option",{value:C,children:C},C))]})}),pt.pptQA&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:vt.pptQA},children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("label",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"checkbox",checked:h.hasPPT,onChange:C=>{if(Xt(),l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can edit PPT settings. Please change your role to EDITOR.");return}const P=h.hasPPT;O(Q=>Q.map(ce=>ce.id===h.id?{...ce,hasPPT:C.target.checked}:ce)),V(`hasPPT_${h.id}`,"FIELD_UPDATE",`Updated PPT status for "${h.segmentName}" from ${P?"TRUE":"FALSE"} to ${C.target.checked?"TRUE":"FALSE"}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"hasPPT",oldValue:P?"TRUE":"FALSE",newValue:C.target.checked?"TRUE":"FALSE",details:{fieldType:"checkbox",booleanChange:!0}})},className:`w-6 h-6 rounded border-2 transition-colors ${l==="VIEWER"||l==="OPERATOR"?"border-slate-400 bg-slate-700 cursor-not-allowed":"border-slate-400 bg-slate-700 hover:border-blue-400 focus:ring-2 focus:ring-blue-500"}`,style:{opacity:1,filter:"none",WebkitFilter:"none"},title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can edit PPT settings":"Toggle PPT"}),c.jsx("span",{className:"text-base font-medium text-white",children:"PPT"})]}),c.jsxs("label",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"checkbox",checked:h.hasQA,onChange:C=>{if(Xt(),l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can edit Q&A settings. Please change your role to EDITOR.");return}const P=h.hasQA;O(Q=>Q.map(ce=>ce.id===h.id?{...ce,hasQA:C.target.checked}:ce)),V(`hasQA_${h.id}`,"FIELD_UPDATE",`Updated Q&A status for "${h.segmentName}" from ${P?"TRUE":"FALSE"} to ${C.target.checked?"TRUE":"FALSE"}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"hasQA",oldValue:P?"TRUE":"FALSE",newValue:C.target.checked?"TRUE":"FALSE",details:{fieldType:"checkbox",booleanChange:!0}})},className:`w-6 h-6 rounded border-2 transition-colors ${l==="VIEWER"||l==="OPERATOR"?"border-slate-400 bg-slate-700 cursor-not-allowed":"border-slate-400 bg-slate-700 hover:border-blue-400 focus:ring-2 focus:ring-blue-500"}`,style:{opacity:1,filter:"none",WebkitFilter:"none"},title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can edit Q&A settings":"Toggle Q&A"}),c.jsx("span",{className:"text-base font-medium text-white",children:"Q&A"})]})]})}),pt.notes&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:vt.notes,height:Sn(h.notes,h.speakersText,h.speakers,h.customFields,H)},children:c.jsx("div",{onClick:()=>{if(l==="VIEWER"||l==="OPERATOR"){if(l==="OPERATOR"&&h.notes){alert(`Notes (View Only):

${h.notes.replace(/<[^>]*>/g,"")}`);return}alert("Only EDITORs can edit notes. Please change your role to EDITOR.");return}br(),Ee(h.id),tt(!0)},className:"w-full px-3 py-2 border border-slate-600 rounded text-white text-base transition-colors bg-slate-700 cursor-pointer hover:bg-slate-600",style:{minHeight:"4rem",maxHeight:"none",wordWrap:"break-word",overflowWrap:"break-word",display:"flex",alignItems:"flex-start",justifyContent:"flex-start"},title:l==="VIEWER"?"Viewers cannot edit notes":l==="OPERATOR"?"Click to view notes (read-only)":"Click to edit notes",children:h.notes?c.jsx("div",{className:"text-left w-full",style:{lineHeight:"1.4",overflow:"visible"},dangerouslySetInnerHTML:{__html:h.notes}}):c.jsx("span",{className:"text-slate-400",children:"Click to edit notes..."})})}),pt.assets&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:vt.assets},children:c.jsx("div",{onClick:()=>{if(l==="VIEWER"||l==="OPERATOR"){if(l==="OPERATOR"&&h.assets){ur(h.id),Ze(!0);return}alert("Only EDITORs can edit assets. Please change your role to EDITOR.");return}br(),xt(h.id),Dt(!0)},className:"w-full px-3 py-2 border border-slate-600 rounded text-white text-base transition-colors flex items-center justify-center bg-slate-700 cursor-pointer hover:bg-slate-600",title:l==="VIEWER"?"Viewers cannot edit assets":l==="OPERATOR"?"Click to view assets (read-only)":"Click to edit assets",children:h.assets?c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"text-sm font-medium",children:[h.assets.split("||").length," Asset",h.assets.split("||").length!==1?"s":""]})}):c.jsx("span",{className:"text-slate-400",children:"Click to add assets..."})})}),pt.participants&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-start justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:vt.participants,height:Sn(h.notes,h.speakersText,h.speakers,h.customFields,H)},children:c.jsx("div",{onClick:()=>{if(l==="VIEWER"||l==="OPERATOR"){if(l==="OPERATOR"&&h.speakers){alert(`Participants (View Only):

${yl(h.speakers)}`);return}alert("Only EDITORs can edit participants. Please change your role to EDITOR.");return}Es(h.id),dr(!0)},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-base cursor-pointer hover:bg-slate-600",style:{height:`calc(${Sn(h.notes,h.speakersText,h.speakers,h.customFields,H)} - 2rem)`,maxHeight:`calc(${Sn(h.notes,h.speakersText,h.speakers,h.customFields,H)} - 2rem)`,overflow:"hidden",lineHeight:"1.6",wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"pre-wrap"},title:l==="VIEWER"?"Viewers cannot edit participants":l==="OPERATOR"?"Click to view participants (read-only)":"Click to edit participants",children:yl(h.speakers||"")||"Click to add participants..."})}),pt.speakers&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:vt.speakers,height:Sn(h.notes,h.speakersText,h.speakers,h.customFields,H)},children:c.jsx("div",{onClick:()=>{if(l==="VIEWER"||l==="OPERATOR"){if(l==="OPERATOR"&&h.speakersText){alert(`Speakers (View Only):

${Ys(h.speakersText)}`);return}alert("Only EDITORs can edit speakers. Please change your role to EDITOR.");return}br(),Nt(h.id),Me(!0)},className:"w-full px-3 py-2 border border-slate-600 rounded text-white text-base transition-colors flex items-start justify-start bg-slate-700 cursor-pointer hover:bg-slate-600",style:{height:$c(h.speakersText),minHeight:$c(h.speakersText),wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden",paddingBottom:"1rem",lineHeight:"1.6",whiteSpace:"pre-wrap"},title:l==="VIEWER"?"Viewers cannot edit speakers":l==="OPERATOR"?"Click to view speakers (read-only)":"Click to edit speakers",children:c.jsx("div",{className:"text-left w-full",children:Ys(h.speakersText||"")||"Click to add speakers..."})})}),pt.public&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:vt.public},children:c.jsx("input",{type:"checkbox",checked:h.isPublic||!1,onChange:C=>{if(l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can change public status. Please change your role to EDITOR.");return}const P=h.isPublic;O(Q=>Q.map(ce=>ce.id===h.id?{...ce,isPublic:C.target.checked}:ce)),D("FIELD_UPDATE",`Updated Public status for "${h.segmentName}" from ${P} to ${C.target.checked}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"isPublic",oldValue:P,newValue:C.target.checked,details:{fieldType:"checkbox",booleanChange:!0}})},className:`w-5 h-5 rounded border-2 focus:ring-2 transition-colors ${l==="VIEWER"||l==="OPERATOR"?"border-slate-500 bg-slate-700 text-blue-600 cursor-not-allowed":"border-slate-500 bg-slate-700 text-blue-600 focus:ring-blue-500"}`,style:{opacity:1,filter:"none",WebkitFilter:"none"},title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can change public status":"Toggle public visibility"})}),H.map(C=>zs[C.id]!==!1&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:js[C.id]||256,height:Sn(h.notes,h.speakersText,h.speakers,h.customFields,H)},children:c.jsx("textarea",{value:h.customFields[C.name]||"",onFocus:()=>{console.log(" Custom column focused - pausing sync"),Xt()},onChange:P=>{Xt();const Q=h.customFields[C.name]||"";O(ce=>ce.map(me=>me.id===h.id?{...me,customFields:{...me.customFields,[C.name]:P.target.value}}:me)),V(`custom_${C.name}_${h.id}`,"FIELD_UPDATE",`Updated custom field "${C.name}" for "${h.segmentName}" from "${Q}" to "${P.target.value}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:`custom_${C.name}`,oldValue:Q,newValue:P.target.value,details:{fieldType:"custom_field",columnName:C.name,characterChange:P.target.value.length-Q.length}})},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-base resize-none",style:{height:`calc(${Sn(h.notes,h.speakersText,h.speakers,h.customFields,H)} - 2rem)`,maxHeight:`calc(${Sn(h.notes,h.speakersText,h.speakers,h.customFields,H)} - 2rem)`,overflow:"hidden",lineHeight:"1.6",wordWrap:"break-word",overflowWrap:"break-word"},rows:Math.max(2,(h.customFields[C.name]||"").split(`
`).length),placeholder:`${C.name}...`})},C.id))]},`${h.id}-${h.notes?.length||0}-${h.speakers?.length||0}`))]})}),c.jsxs("div",{className:"w-32 flex-shrink-0 bg-slate-900",style:{borderLeft:"6px solid #475569"},children:[c.jsx("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:c.jsxs("span",{className:"text-white font-bold text-base flex items-center gap-1",children:["Timer",(l==="VIEWER"||l==="EDITOR")&&c.jsx("span",{className:"text-yellow-400",title:"Only OPERATORs can control timers",children:""})]})}),Fn().length===0?c.jsx("div",{className:"h-24 flex items-center justify-center text-slate-500",children:"-"}):Fn().map((h,E)=>c.jsx("div",{className:`border-b-2 border-slate-600 flex flex-col items-center justify-center gap-1 ${E%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:Sn(h.notes,h.speakersText,h.speakers,h.customFields,H)},children:c.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-1",children:[c.jsx("div",{className:"text-sm font-mono text-slate-300",children:h.timerId||"TIMER"}),c.jsx("div",{className:"flex flex-col gap-1",children:h.isIndented?c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can start secondary timers. Please change your role to OPERATOR.");return}lo(h.id)},disabled:Mt?.itemId===h.id||l==="VIEWER"||l==="EDITOR"||!mi(h.id),className:`px-3 py-1 rounded text-sm font-bold transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":mi(h.id)?Mt?.itemId===h.id?"bg-orange-600 text-white cursor-default":"bg-orange-500 hover:bg-orange-400 text-white":"bg-gray-500 text-gray-300 cursor-not-allowed"}`,title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can start secondary timers":mi(h.id)?"Start secondary timer":"Start the CUE above first before starting secondary timer",children:Mt?.itemId===h.id?"PLAYING":"PLAY"}),c.jsx("button",{onClick:()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can stop secondary timers. Please change your role to OPERATOR.");return}Aa()},disabled:Mt?.itemId!==h.id||l==="VIEWER"||l==="EDITOR"||!mi(h.id),className:`px-3 py-1 rounded text-sm font-bold transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":mi(h.id)?Mt?.itemId===h.id?"bg-red-600 hover:bg-red-500 text-white":"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-gray-500 text-gray-300 cursor-not-allowed"}`,title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can stop secondary timers":"Stop secondary timer",children:"STOP"})]}):c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:async()=>{if(l==="VIEWER"){alert("Viewers cannot load cues. Please change your role to EDITOR or OPERATOR.");return}if(console.log(" Button clicked, currentUserRole:",l),console.log(" Button clicked, item.id:",h.id),l==="EDITOR"){alert("Editors cannot load cues. Please change your role to OPERATOR.");return}console.log(" Button clicked, calling loadCue with item.id:",h.id),await zc(h.id)},disabled:J===h.id||l==="VIEWER"||l==="EDITOR",className:`px-3 py-1 rounded text-sm font-bold transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":J===h.id?"bg-blue-600 text-white cursor-default":"bg-slate-600 hover:bg-slate-500 text-white"}`,title:l==="VIEWER"?"Viewers cannot load cues":l==="EDITOR"?"Editors cannot load cues":"Load this cue",children:J===h.id?"LOADED":"LOAD"}),c.jsx("button",{onClick:async()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can start/stop timers. Please change your role to OPERATOR.");return}await qc(h.id)},disabled:J!==h.id||(dt[h.id]?!1:Object.keys(dt).length>0)||l==="VIEWER"||l==="EDITOR",className:`px-3 py-1 rounded text-sm font-bold transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":dt[h.id]?"bg-red-600 hover:bg-red-500 text-white":J===h.id&&Object.keys(dt).length===0?"bg-green-600 hover:bg-green-500 text-white":"bg-slate-600 text-slate-400 cursor-not-allowed"}`,title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can start/stop timers":dt[h.id]?"Stop timer":"Start timer",children:dt[h.id]?"STOP":"START"})]})})]})},`${h.id}-${h.notes?.length||0}-${h.speakers?.length||0}`))]})]})]})}),te&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg max-w-lg w-full max-h-[90vh] flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-600",children:[c.jsx("h2",{className:"text-lg font-bold text-white",children:"Add Schedule Item"}),c.jsxs("label",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:$t.isPublic,onChange:h=>_r(E=>({...E,isPublic:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-slate-300 text-sm",children:"Public"})]})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Cue"}),c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex items-center px-2 py-2 bg-slate-600 border border-slate-600 border-r-0 rounded-l text-white text-sm font-medium min-w-[40px]",children:"CUE"}),c.jsx("input",{type:"text",value:$t.cue,onChange:h=>{Xt(),_r(E=>({...E,cue:h.target.value}))},className:"flex-1 px-3 py-2 bg-slate-700 border border-slate-600 rounded-r text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm",placeholder:"1, 1.1, 1A, etc."})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Program Type"}),c.jsx("select",{value:$t.programType,onFocus:()=>{console.log(" Program Type modal dropdown focused - pausing sync"),br()},onChange:h=>{_r(E=>({...E,programType:h.target.value})),Br()},className:"w-full px-3 py-2 bg-slate-700 border-2 border-slate-500 rounded text-white focus:outline-none focus:border-blue-500 text-sm",style:{backgroundColor:so[$t.programType]||"#374151",color:$t.programType==="Sub Cue"?"#000000":"#ffffff"},children:Mc.map(h=>c.jsx("option",{value:h,style:{backgroundColor:so[h]||"#374151",color:h==="Sub Cue"?"#000000":"#ffffff"},children:h},h))})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Segment Name"}),c.jsx("input",{type:"text",value:$t.segmentName,onChange:h=>{Xt(),_r(E=>({...E,segmentName:h.target.value}))},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm",placeholder:"Enter segment name"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Shot Type"}),c.jsxs("select",{value:$t.shotType,onFocus:()=>{console.log(" Shot Type modal dropdown focused - pausing sync"),br()},onChange:h=>{_r(E=>({...E,shotType:h.target.value})),Br()},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm",children:[c.jsx("option",{value:"",children:"Select Shot Type"}),Ca.map(h=>c.jsx("option",{value:h,children:h},h))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Duration"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("input",{type:"number",value:$t.durationHours,onChange:h=>{Xt(),_r(E=>({...E,durationHours:parseInt(h.target.value)||0}))},className:"w-12 px-2 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm text-center",min:"0",placeholder:"H"}),c.jsx("span",{className:"text-slate-400 self-center text-sm",children:":"}),c.jsx("input",{type:"number",value:$t.durationMinutes,onChange:h=>{Xt(),_r(E=>({...E,durationMinutes:parseInt(h.target.value)||0}))},className:"w-12 px-2 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm text-center",min:"0",max:"59",placeholder:"M"}),c.jsx("span",{className:"text-slate-400 self-center text-sm",children:":"}),c.jsx("input",{type:"number",value:$t.durationSeconds,onChange:h=>{Xt(),_r(E=>({...E,durationSeconds:parseInt(h.target.value)||0}))},className:"w-12 px-2 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm text-center",min:"0",max:"59",placeholder:"S"})]})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("label",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:$t.hasPPT,onChange:h=>{Xt(),_r(E=>({...E,hasPPT:h.target.checked}))},className:"rounded"}),c.jsx("span",{className:"text-slate-300 text-sm",children:"Has PPT"})]}),c.jsxs("label",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:$t.hasQA,onChange:h=>{Xt(),_r(E=>({...E,hasQA:h.target.checked}))},className:"rounded"}),c.jsx("span",{className:"text-slate-300 text-sm",children:"Has QA"})]})]})]}),c.jsxs("div",{className:"mt-3",children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Notes"}),c.jsx("div",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm cursor-pointer hover:bg-slate-600 transition-colors min-h-[60px] flex items-center",onClick:()=>{br(),Ee(-1),tt(!0)},children:$t.notes?c.jsx("div",{className:"text-sm",style:{lineHeight:"1.4",overflow:"visible"},dangerouslySetInnerHTML:{__html:$t.notes}}):c.jsx("span",{className:"text-slate-400",children:"Click to edit notes with rich formatting..."})})]}),c.jsxs("div",{className:"mt-3",children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Assets"}),c.jsx("div",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm cursor-pointer hover:bg-slate-600 transition-colors min-h-[60px] flex items-center",onClick:()=>{br(),xt(-1),Dt(!0)},children:$t.assets?c.jsx("div",{className:"text-sm",dangerouslySetInnerHTML:{__html:$t.assets.replace(/\|\|/g,"<br>")}}):c.jsx("span",{className:"text-slate-400",children:"Click to edit assets with advanced management..."})})]}),c.jsxs("div",{className:"mt-3",children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Speakers"}),c.jsx("div",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm cursor-pointer hover:bg-slate-600 transition-colors min-h-[60px] flex items-start justify-start",onClick:()=>{br(),Nt(-1),Me(!0)},style:{wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.6",whiteSpace:"pre-wrap"},children:$t.speakersText?c.jsx("div",{className:"text-sm text-left w-full",children:Ys($t.speakersText)}):c.jsx("span",{className:"text-slate-400",children:"Click to add speakers..."})})]})]}),c.jsx("div",{className:"p-4 border-t border-slate-600",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>Qd($t),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded transition-colors text-sm",children:"Add Item"}),c.jsx("button",{onClick:()=>{fe(!1),Br()},className:"flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors text-sm",children:"Cancel"})]})})]})}),Ie&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-8 max-w-md w-full",children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Add Custom Column"}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-slate-300 font-semibold mb-2",children:"Column Name"}),c.jsx("input",{type:"text",placeholder:"Enter column name",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",onFocus:()=>{console.log(" Custom column input focused - pausing sync"),Xt()},onKeyPress:h=>{if(h.key==="Enter"){const E=h.target;E.value.trim()&&(Qs(E.value.trim()),E.value="")}}})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>{const h=document.querySelector('input[placeholder="Enter column name"]');h?.value.trim()&&(Qs(h.value.trim()),h.value="")},className:"flex-1 px-4 py-3 bg-purple-600 hover:bg-purple-500 text-white font-semibold rounded-lg transition-colors",children:"Add Column"}),c.jsx("button",{onClick:()=>{Fe(!1),Br()},className:"flex-1 px-4 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})]})}),Ye&&Ve!==null&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-5xl w-full max-h-[90vh] flex flex-col",children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Edit Notes"}),c.jsxs("div",{className:"mb-4 bg-slate-700 rounded-lg overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 border-b border-slate-600",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-semibold",children:"Format:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>Ht("undo"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Undo",children:""}),c.jsx("button",{onClick:()=>Ht("redo"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Redo",children:""}),c.jsx("div",{className:"w-px h-6 bg-slate-500 mx-1"}),c.jsx("button",{onClick:()=>Ht("bold"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded font-bold flex items-center justify-center",title:"Bold",children:"B"}),c.jsx("button",{onClick:()=>Ht("italic"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded italic flex items-center justify-center",title:"Italic",children:"I"}),c.jsx("button",{onClick:()=>Ht("underline"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded underline flex items-center justify-center",title:"Underline",children:"U"})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-semibold",children:"Size:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>Ht("fontSize","1"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Small",children:"S"}),c.jsx("button",{onClick:()=>Ht("fontSize","3"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded flex items-center justify-center",title:"Normal",children:"N"}),c.jsx("button",{onClick:()=>Ht("fontSize","5"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-base rounded flex items-center justify-center",title:"Large",children:"L"}),c.jsx("button",{onClick:()=>Ht("fontSize","7"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-lg rounded flex items-center justify-center",title:"X-Large",children:"XL"})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-semibold",children:"Align:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>Ht("left"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Left Align",children:""}),c.jsx("button",{onClick:()=>Ht("center"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Center Align",children:""}),c.jsx("button",{onClick:()=>Ht("right"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Right Align",children:""})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-semibold",children:"Lists:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>Ht("bullet"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded flex items-center justify-center",title:"Bullet List",children:""}),c.jsx("button",{onClick:()=>Ht("list"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded flex items-center justify-center",title:"Numbered List",children:"1."})]})]})]}),c.jsxs("div",{className:"flex items-center justify-center gap-6 p-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-semibold",children:"Text Color:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>Ht("color","#ffffff"),className:"w-6 h-6 bg-white border border-slate-400 rounded",title:"White"}),c.jsx("button",{onClick:()=>Ht("color","#ef4444"),className:"w-6 h-6 bg-red-500 rounded",title:"Red"}),c.jsx("button",{onClick:()=>Ht("color","#3b82f6"),className:"w-6 h-6 bg-blue-500 rounded",title:"Blue"}),c.jsx("button",{onClick:()=>Ht("color","#22c55e"),className:"w-6 h-6 bg-green-500 rounded",title:"Green"}),c.jsx("button",{onClick:()=>Ht("color","#f97316"),className:"w-6 h-6 bg-orange-500 rounded",title:"Orange"}),c.jsx("button",{onClick:()=>Ht("color","#a855f7"),className:"w-6 h-6 bg-purple-500 rounded",title:"Purple"}),c.jsx("button",{onClick:()=>Ht("color","#000000"),className:"w-6 h-6 bg-black border border-slate-400 rounded",title:"Black"})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-semibold",children:"Highlight:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>Ht("highlight","transparent"),className:"w-6 h-6 bg-slate-600 border border-slate-400 rounded flex items-center justify-center text-white text-xs",title:"No Highlight",children:""}),c.jsx("button",{onClick:()=>Ht("highlight","#fbbf24"),className:"w-6 h-6 bg-yellow-400 rounded",title:"Yellow"}),c.jsx("button",{onClick:()=>Ht("highlight","#60a5fa"),className:"w-6 h-6 bg-blue-400 rounded",title:"Light Blue"}),c.jsx("button",{onClick:()=>Ht("highlight","#4ade80"),className:"w-6 h-6 bg-green-400 rounded",title:"Light Green"}),c.jsx("button",{onClick:()=>Ht("highlight","#f472b6"),className:"w-6 h-6 bg-pink-400 rounded",title:"Pink"}),c.jsx("button",{onClick:()=>Ht("highlight","#fb923c"),className:"w-6 h-6 bg-orange-400 rounded",title:"Orange"})]})]})]})]}),c.jsxs("div",{className:"flex-1 min-h-[400px] mb-6",children:[c.jsx("label",{className:"block text-white text-sm mb-2",children:"Notes:"}),c.jsx("div",{id:"notes-editor",contentEditable:!0,className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white text-base focus:outline-none focus:border-blue-500 overflow-auto",style:{height:"400px",lineHeight:"1.5",fontFamily:"system-ui, -apple-system, sans-serif"},"data-placeholder":"Start typing your notes here...",onInput:h=>{}})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:pl,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"}),c.jsx("button",{onClick:()=>{tt(!1),Ee(null),Br()},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})]})}),Le&&rt!==null&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-5xl w-full max-h-[90vh] flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-700",children:[c.jsxs("h2",{className:"text-xl font-bold text-white",children:["Edit Speakers (",wt.length,"/7)"]}),c.jsx("button",{onClick:()=>{Me(!1),Nt(null),Br()},className:"text-slate-400 hover:text-white text-xl",children:""})]}),c.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[c.jsx("div",{className:"mb-6",children:c.jsxs("button",{onClick:Na,disabled:wt.length>=7,className:"px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors",children:["+ Add Speaker ",wt.length<7&&`(${7-wt.length} slots remaining)`]})}),c.jsxs("div",{className:"space-y-4 mb-6",children:[wt.sort((h,E)=>h.slot-E.slot).map(h=>c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Speaker ",h.slot]}),c.jsx("button",{onClick:()=>Hd(h.id),className:"w-8 h-8 bg-red-600 hover:bg-red-500 text-white rounded flex items-center justify-center transition-colors",title:"Remove Speaker",children:""})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Slot Number"}),c.jsx("select",{value:h.slot,onChange:E=>zd(h.id,parseInt(E.target.value)),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[1,2,3,4,5,6,7].map(E=>{const C=wt.some(P=>P.id!==h.id&&P.slot===E);return c.jsxs("option",{value:E,className:C?"bg-yellow-600 text-white":"bg-slate-600 text-white",children:[E," ",C?"(Used)":""]},E)})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Location"}),c.jsxs("select",{value:h.location,onChange:E=>Js(h.id,"location",E.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[c.jsx("option",{value:"Podium",children:"Podium"}),c.jsx("option",{value:"Seat",children:"Seat"}),c.jsx("option",{value:"Moderator",children:"Moderator"}),c.jsx("option",{value:"Virtual",children:"Virtual"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Full Name"}),c.jsx("input",{type:"text",value:h.fullName,onChange:E=>Js(h.id,"fullName",E.target.value),placeholder:"Enter full name",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Title (subtext line 1)"}),c.jsx("input",{type:"text",value:h.title,onChange:E=>Js(h.id,"title",E.target.value),placeholder:"Enter title",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Organization (subtext line 2)"}),c.jsx("input",{type:"text",value:h.org,onChange:E=>Js(h.id,"org",E.target.value),placeholder:"Enter organization",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Photo Link"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"url",value:h.photoLink,onChange:E=>Js(h.id,"photoLink",E.target.value),placeholder:"Enter photo URL",className:"flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"}),h.photoLink&&c.jsx("div",{className:"flex-shrink-0",children:c.jsx("img",{src:h.photoLink,alt:h.fullName,className:"w-12 h-12 rounded object-cover border-2 border-slate-500 -mt-2.5",onError:E=>{E.currentTarget.style.display="none"}})})]})]})]})]},h.id)),wt.length===0&&c.jsx("div",{className:"text-center py-8 text-slate-400",children:'No speakers added yet. Click "Add Speaker" to get started.'})]})]}),c.jsx("div",{className:"border-t border-slate-700 p-6",children:c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:hi,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"}),c.jsx("button",{onClick:()=>{Me(!1),Nt(null),Br()},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})})]})}),Wt&&Ft!==null&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Edit Assets"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-white",children:"Assets List"}),c.jsx("button",{onClick:xl,className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:"+ Add Asset"})]}),c.jsx("div",{id:"assets-list",className:"space-y-3"})]}),c.jsxs("div",{className:"flex gap-3 mt-6",children:[c.jsx("button",{onClick:Wd,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"}),c.jsx("button",{onClick:()=>{Dt(!1),xt(null),Br()},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})]})}),Et&&bt!==null&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Assets List"}),c.jsx("button",{onClick:()=>{Ze(!1),ur(null)},className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:"Close"})]}),c.jsx("div",{className:"space-y-4",children:(()=>{const h=T.find(C=>C.id===bt);if(!h||!h.assets)return c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-slate-400 text-lg",children:"No assets available for this item."})});let E=[];if(h.assets.includes("||"))E=h.assets.split("||").filter(P=>P.trim()).map(P=>{if(P.includes("|")){const[Q,ce]=P.split("|").map(me=>me.trim());return{name:Q||"Unnamed Asset",url:ce||""}}else return{name:P.trim(),url:""}});else if(h.assets.includes("|")){const[C,P]=h.assets.split("|").map(Q=>Q.trim());E=[{name:C||"Unnamed Asset",url:P||""}]}else try{const C=JSON.parse(h.assets);Array.isArray(C)?E=C.map(P=>({name:P.name||"Unnamed Asset",url:P.link||P.url||""})):E=[{name:C.name||"Unnamed Asset",url:C.link||C.url||""}]}catch{E=[{name:h.assets.trim(),url:""}]}return E.length===0?c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-slate-400 text-lg",children:"No assets available for this item."})}):c.jsx("div",{className:"space-y-4",children:c.jsx("div",{className:"max-h-96 overflow-y-auto space-y-3 pr-2",children:E.map((C,P)=>c.jsx("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"text-white font-semibold text-lg",children:C.name}),C.url&&c.jsx("div",{children:c.jsx("a",{href:C.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline break-all text-sm",children:C.url})})]})},P))})})})()})]})}),kt&&$r!==null&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-5xl w-full max-h-[90vh] flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-700",children:[c.jsxs("h2",{className:"text-xl font-bold text-white",children:["Edit Participants (",wr.length,"/7)"]}),c.jsx("button",{onClick:()=>{dr(!1),Es(null)},className:"text-slate-400 hover:text-white text-xl",children:""})]}),c.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[c.jsx("div",{className:"mb-6",children:c.jsxs("button",{onClick:vl,disabled:wr.length>=7,className:"px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors",children:["+ Add Speaker ",wr.length<7&&`(${7-wr.length} slots remaining)`]})}),c.jsxs("div",{className:"space-y-4",children:[wr.sort((h,E)=>h.slot-E.slot).map(h=>c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Speaker ",h.slot]}),c.jsx("button",{onClick:()=>Uc(h.id),className:"w-8 h-8 bg-red-600 hover:bg-red-500 text-white rounded flex items-center justify-center transition-colors",title:"Remove Speaker",children:""})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Slot Number"}),c.jsx("select",{value:h.slot,onChange:E=>Vc(h.id,parseInt(E.target.value)),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[1,2,3,4,5,6,7].map(E=>{const C=wr.some(P=>P.id!==h.id&&P.slot===E);return c.jsxs("option",{value:E,className:C?"bg-yellow-600 text-white":"bg-slate-600 text-white",children:[E," ",C?"(Used)":""]},E)})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Location"}),c.jsxs("select",{value:h.location,onChange:E=>qs(h.id,"location",E.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[c.jsx("option",{value:"Podium",children:"Podium"}),c.jsx("option",{value:"Seat",children:"Seat"}),c.jsx("option",{value:"Moderator",children:"Moderator"}),c.jsx("option",{value:"Virtual",children:"Virtual"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Full Name"}),c.jsx("input",{type:"text",value:h.fullName,onChange:E=>qs(h.id,"fullName",E.target.value),placeholder:"Enter full name",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Title"}),c.jsx("input",{type:"text",value:h.title,onChange:E=>qs(h.id,"title",E.target.value),placeholder:"Enter title/position",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Organization"}),c.jsx("input",{type:"text",value:h.org,onChange:E=>qs(h.id,"org",E.target.value),placeholder:"Enter organization",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Speaker Photo Link"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"url",value:h.photoLink,onChange:E=>qs(h.id,"photoLink",E.target.value),placeholder:"Enter photo URL",className:"flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"}),h.photoLink&&c.jsx("div",{className:"flex-shrink-0",children:c.jsx("img",{src:h.photoLink,alt:h.fullName,className:"w-12 h-12 rounded object-cover border-2 border-slate-500 -mt-2.5",onError:E=>{E.target.style.display="none"}})})]})]})]})]},h.id)),wr.length===0&&c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-slate-400 text-lg mb-4",children:"No speakers added yet"}),c.jsx("button",{onClick:vl,className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Add Your First Speaker"})]})]})]}),c.jsx("div",{className:"border-t border-slate-700 p-6",children:c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:Bc,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"}),c.jsx("button",{onClick:()=>{dr(!1),Es(null)},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})})]})}),tr&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 max-w-md w-full",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:"Send Message to Full Screen Timer"}),c.jsx("button",{onClick:()=>Wn(!1),className:"text-slate-400 hover:text-white transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Quick Presets"}),c.jsx("div",{className:"grid grid-cols-2 gap-2",children:["Break in 5 minutes","Technical difficulties","Starting soon","Please wait","Break time","Resuming shortly","Stall / Stretch Time","Wrap Up Please"].map(h=>c.jsx("button",{onClick:()=>un(h),className:"px-3 py-2 bg-slate-700 hover:bg-slate-600 border border-slate-600 rounded text-white text-sm transition-colors text-left",children:h},h))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Custom Message"}),c.jsx("textarea",{value:Kr,onChange:h=>un(h.target.value),placeholder:"Enter custom message to display on full screen timer...",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm h-24 resize-none"})]}),Kr&&c.jsx("div",{className:"p-3 bg-slate-700 rounded-lg",children:c.jsxs("div",{className:"text-slate-300 text-sm",children:[c.jsx("strong",{children:"Message Preview:"})," ",Kr]})})]}),c.jsxs("div",{className:"flex gap-3 mt-6",children:[c.jsx("button",{onClick:async()=>{if(!(!Kr.trim()||!e?.id))try{const E=(await qe.getTimerMessagesForEvent(e.id)).filter(Q=>Q.enabled);for(const Q of E)await qe.disableTimerMessage(Q.id),console.log(" Disabled existing message:",Q.id);const C={event_id:e.id,message:Kr.trim(),enabled:!0,sent_by:s?.id,sent_by_name:s?.user_metadata?.full_name||s?.email||"Unknown User",sent_by_role:l||"VIEWER",message_type:"general",priority:2},P=await qe.saveTimerMessage(C);if(!P){console.error(" Failed to save message to Supabase"),alert("Failed to save message. Please try again.");return}console.log(" New message created in Supabase:",P),va(!0),Pe&&!Pe.closed&&Pe.postMessage({type:"MESSAGE_UPDATE",message:Kr,enabled:!0},"*"),un(""),Wn(!1)}catch(h){console.error(" Error saving message:",h),alert("Error saving message. Please try again.")}},className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded transition-colors",disabled:!Kr.trim()||!e?.id,children:"Send & Activate Message"}),c.jsx("button",{onClick:()=>Wn(!1),className:"flex-1 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors",children:"Cancel"})]})]})}),rr&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg max-w-md w-full max-h-[80vh] flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-600",children:[c.jsx("h2",{className:"text-lg font-bold text-white",children:"Filter Columns"}),c.jsx("button",{onClick:()=>sl(!1),className:"text-slate-400 hover:text-white text-xl",children:""})]}),c.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:c.jsxs("div",{className:"space-y-3",children:[c.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Select which columns to display in the schedule:"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:pt.start,onChange:h=>Xr(E=>({...E,start:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Start Time"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:pt.programType,onChange:h=>Xr(E=>({...E,programType:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Program Type"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:pt.duration,onChange:h=>Xr(E=>({...E,duration:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Duration"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:pt.segmentName,onChange:h=>Xr(E=>({...E,segmentName:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Segment Name"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:pt.shotType,onChange:h=>Xr(E=>({...E,shotType:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Shot Type"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:pt.pptQA,onChange:h=>Xr(E=>({...E,pptQA:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"PPT/Q&A"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:pt.notes,onChange:h=>Xr(E=>({...E,notes:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Notes"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:pt.assets,onChange:h=>Xr(E=>({...E,assets:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Assets"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:pt.speakers,onChange:h=>Xr(E=>({...E,speakers:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Speakers"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:pt.public,onChange:h=>Xr(E=>({...E,public:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Public"})]}),H.map((h,E)=>c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:zs[h.id]!==!1,onChange:C=>Hn(P=>({...P,[h.id]:C.target.checked})),className:"rounded"}),c.jsxs("span",{className:"text-white",children:[h.name,c.jsx("span",{className:"text-slate-400 text-xs ml-2",children:"(Custom)"})]})]},h.id))]})]})}),c.jsx("div",{className:"p-4 border-t border-slate-600",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>{Xr({start:!0,programType:!0,duration:!0,segmentName:!0,shotType:!0,pptQA:!0,notes:!0,assets:!0,participants:!1,speakers:!0,public:!0,custom:!0});const h={};H.forEach(E=>{h[E.id]=!0}),Hn(h)},className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors text-sm",children:"Show All"}),c.jsx("button",{onClick:()=>{Xr({start:!1,programType:!1,duration:!1,segmentName:!1,shotType:!1,pptQA:!1,notes:!1,assets:!1,participants:!1,speakers:!1,public:!1,custom:!1});const h={};H.forEach(E=>{h[E.id]=!1}),Hn(h)},className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors text-sm",children:"Hide All"}),c.jsx("button",{onClick:()=>sl(!1),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded transition-colors text-sm",children:"Apply Filters"})]})})]})}),_a&&Sa&&c.jsx("div",{className:"fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50",children:c.jsxs("div",{className:`px-6 py-4 rounded-lg shadow-lg border-2 flex items-center gap-3 ${Gn==="early"?"bg-yellow-600 border-yellow-500 text-yellow-100":Gn==="late"?"bg-red-600 border-red-500 text-red-100":"bg-green-600 border-green-500 text-green-100"}`,children:[c.jsx("div",{className:"text-3xl flex-shrink-0",children:Gn==="early"?"":Gn==="late"?"":""}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"font-bold text-lg mb-1",children:Gn==="early"?"EARLY":Gn==="late"?"RUNNING LATE":"ON TIME"}),c.jsxs("div",{className:"text-base font-medium",children:[c.jsx("span",{className:"text-2xl font-bold",children:On>=60?`${Math.floor(On/60)}h ${On%60}m`:`${On}m`}),Gn==="early"?` before ${Object.keys(dt).length>0?(T.find(h=>h.id===parseInt(Object.keys(dt)[0]))?.customFields.cue||"CUE").replace(/CUE(\d+)/,"CUE $1"):"CUE"} start`:Gn==="late"?` after ${Object.keys(dt).length>0?(T.find(h=>h.id===parseInt(Object.keys(dt)[0]))?.customFields.cue||"CUE").replace(/CUE(\d+)/,"CUE $1"):"CUE"} start`:" - Timing is on track"]})]}),c.jsx("button",{onClick:()=>ls(!1),className:"ml-4 text-xl hover:opacity-70 transition-opacity",children:""})]})}),c.jsx(uS,{isOpen:jd,onClose:()=>Rc(!1),event:e}),c.jsx(dS,{isOpen:qi,onClose:()=>ii(!1),onSelectFullscreenTimer:Xd,onSelectClock:qd}),Ts&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-8 w-full max-w-7xl max-h-[95vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Backup Management"}),c.jsx("button",{onClick:()=>ya(!1),className:"text-slate-400 hover:text-white text-2xl font-bold",children:""})]}),c.jsx("div",{className:"bg-blue-900 border border-blue-600 rounded-lg p-4 mb-6",children:c.jsxs("div",{className:"flex items-start",children:[c.jsx("div",{className:"text-blue-400 text-xl mr-3",children:""}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-blue-200 font-semibold mb-1",children:"Manual Backup Only"}),c.jsx("p",{className:"text-blue-100 text-sm",children:'Automatic backups have been disabled to prevent interference with the main run of show. Use the " Create Backup" button in the main interface to create backups when needed.'})]})]})}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Filter & Search"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-base font-medium mb-3",children:"Search by Event Name"}),c.jsx("input",{type:"text",placeholder:"Filter by event name...",className:"w-full px-4 py-3 bg-slate-600 border border-slate-500 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-base",onChange:h=>{}})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-base font-medium mb-3",children:"Filter by Date"}),c.jsx("input",{type:"date",className:"w-full px-4 py-3 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:border-blue-500 text-base",onChange:h=>{}})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-base font-medium mb-3",children:"Sort by"}),c.jsxs("select",{className:"w-full px-4 py-3 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:border-blue-500 text-base",children:[c.jsx("option",{value:"newest",children:"Newest First"}),c.jsx("option",{value:"oldest",children:"Oldest First"}),c.jsx("option",{value:"event",children:"Event Name"}),c.jsx("option",{value:"type",children:"Backup Type"})]})]})]})]}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 flex-1 overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h3",{className:"text-xl font-semibold text-white",children:"Available Backups"}),c.jsx("button",{onClick:io,className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white text-base font-medium rounded-lg transition-colors",children:" Refresh"})]}),c.jsx("div",{className:"flex-1 overflow-y-auto",children:Ji.length===0?c.jsx("div",{className:"text-slate-400 text-center py-12 text-lg",children:'No backups available. Use the " Create Backup" button in the main interface to create a manual backup.'}):c.jsx("div",{className:"space-y-4",children:Ji.map(h=>c.jsxs("div",{className:"bg-slate-600 p-6 rounded-lg flex justify-between items-center hover:bg-slate-500 transition-colors",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"text-white font-semibold text-xl mb-2 flex items-center gap-3",children:[h.backup_name,c.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${h.backup_type==="auto"?"bg-blue-600 text-blue-100":"bg-green-600 text-green-100"}`,children:h.backup_type})]}),c.jsxs("div",{className:"text-slate-400 text-sm",children:[c.jsx("strong",{children:"Event Date:"})," ",h.event_data?.date?new Date(h.event_data.date).toLocaleDateString():"N/A"," ",c.jsx("strong",{children:" Schedule Items:"})," ",h.schedule_data?.length||0," ",c.jsx("strong",{children:" Custom Columns:"})," ",h.custom_columns_data?.length||0]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:()=>Kc(h),className:"px-6 py-3 bg-green-600 hover:bg-green-500 text-white text-base font-medium rounded-lg transition-colors",title:"Preview and load this backup",children:" Load/Overwrite"}),c.jsx("button",{onClick:()=>_l(h.id),className:"px-5 py-3 bg-red-600 hover:bg-red-500 text-white text-base font-medium rounded-lg transition-colors",title:"Delete this backup",children:" Delete"})]})]},h.id))})})]})]})}),Rd&&Tt&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-8 w-full max-w-2xl",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Confirm Backup Restore"}),c.jsx("button",{onClick:()=>wa(!1),className:"text-slate-400 hover:text-white text-2xl font-bold",children:""})]}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Backup Details"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Backup Name:"}),c.jsx("span",{className:"text-white font-medium",children:Tt.backup_name})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Event:"}),c.jsx("span",{className:"text-white font-medium",children:Tt.event_data?.name||"Unknown"})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Date:"}),c.jsx("span",{className:"text-white font-medium",children:new Date(Tt.backup_timestamp).toLocaleString()})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Type:"}),c.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${Tt.backup_type==="auto"?"bg-blue-600 text-blue-100":"bg-green-600 text-green-100"}`,children:Tt.backup_type})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Schedule Items:"}),c.jsx("span",{className:"text-white font-medium",children:Tt.schedule_data?.length||0})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Custom Columns:"}),c.jsx("span",{className:"text-white font-medium",children:Tt.custom_columns_data?.length||0})]})]})]}),c.jsx("div",{className:"bg-yellow-900 border border-yellow-600 rounded-lg p-4 mb-6",children:c.jsxs("div",{className:"flex items-start",children:[c.jsx("div",{className:"text-yellow-400 text-xl mr-3",children:""}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-yellow-200 font-semibold mb-2",children:"Warning"}),c.jsx("p",{className:"text-yellow-100 text-sm",children:"This will completely overwrite your current run of show data with the backup data. This action cannot be undone. Make sure you want to proceed."})]})]})}),c.jsxs("div",{className:"flex justify-end space-x-4",children:[c.jsx("button",{onClick:()=>wa(!1),className:"px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white text-base font-medium rounded-lg transition-colors",children:"Cancel"}),c.jsx("button",{onClick:Xc,className:"px-6 py-3 bg-green-600 hover:bg-green-500 text-white text-base font-medium rounded-lg transition-colors",children:" Confirm Restore"})]})]})}),c.jsx(hj,{isOpen:Ad,onClose:()=>Ic(!1),onImport:Jc,onDeleteAll:co})]}):c.jsx("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-2xl font-bold mb-4",children:"No Event Selected"}),c.jsx("button",{onClick:()=>r("/"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded",children:"Back to Event List"})]})})},gj=({isRunning:t=!1,elapsedTime:r=0,totalDuration:e=0,onClose:n,message:s="",messageEnabled:o=!1,itemId:l,eventId:u,mainTimer:f=null,secondaryTimer:m=null})=>{const[p,v]=R.useState({elapsed:r,total:e}),[w,_]=R.useState(new Date),[k,b]=R.useState(!1),[y,L]=R.useState(null),[G,j]=R.useState(!1),[F,ue]=R.useState(!1),[D,V]=R.useState(null),[ee,T]=R.useState(null),[O,H]=R.useState(0),[U,X]=R.useState(null),[ve,we]=R.useState(null),[Ne,he]=R.useState(null),[ae,K]=R.useState(null),[oe,A]=R.useState(new Set);R.useEffect(()=>{m&&console.log(" Secondary timer prop updated:",{secondaryTimer:m,supabaseOnly:F,hasSecondaryTimer:!!m})},[m,F]),R.useEffect(()=>{if(F&&D?.activeTimer){const te=D.activeTimer;if(te.is_running&&te.is_active){const fe=new Date,I=new Date(te.started_at),le=Math.floor((fe.getTime()-I.getTime())/1e3),se=te.duration_seconds||0;v({elapsed:le,total:se})}else v({elapsed:0,total:te.duration_seconds||0})}else v({elapsed:r,total:e})},[r,e,F,D]),R.useEffect(()=>{const te=setInterval(()=>{_(new Date)},1e3);return()=>clearInterval(te)},[]),R.useEffect(()=>{const te=()=>{b(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",te),()=>document.removeEventListener("fullscreenchange",te)},[]),R.useEffect(()=>{if(!u)return;const te=async()=>{j(!0);try{const I=await qe.getTimerMessage(u);L(I),console.log(" Loaded timer message from Supabase:",I)}catch(I){console.error(" Error loading timer message:",I)}finally{j(!1)}};te();const fe=setInterval(te,5e3);return()=>clearInterval(fe)},[u]),R.useEffect(()=>{if(!F||!u){if(ee&&(clearInterval(ee),T(null)),X(null),we(null),he(null),U){const I=parseInt(U.split("_")[0]);ar.stopMonitoring(I)}ae&&(clearInterval(ae),K(null)),A(new Set);return}const te=async()=>{try{console.log(" Fetching hybrid timer data from Supabase...");const I=await qe.getHybridTimerData(u);if(V(I),console.log(" Hybrid timer data updated:",I),I?.secondaryTimer?console.log(" Secondary timer data:",I.secondaryTimer):console.log(" No secondary timer data found"),I?.subCueTimers&&I.subCueTimers.length>0?(console.log(" Sub-cue timers data:",I.subCueTimers),console.log(" First sub-cue timer structure:",I.subCueTimers[0])):console.log(" No sub-cue timers data found"),I?.secondaryTimer&&console.log(" Secondary timer data (from sub-cue fallback):",I.secondaryTimer),I?.activeTimer&&console.log(" Active timer data for CUE display:",{cue_display:I.activeTimer.cue_display,cue:I.activeTimer.cue,item_id:I.activeTimer.item_id,allFields:Object.keys(I.activeTimer),fullData:I.activeTimer}),I?.lastLoadedCue&&console.log(" Last loaded cue data:",{cue:I.lastLoadedCue.cue,cue_display:I.lastLoadedCue.cue_display,segment_name:I.lastLoadedCue.segment_name,allFields:Object.keys(I.lastLoadedCue),fullData:I.lastLoadedCue}),I?.cueData?console.log(" CUE data from schedule/items table:",{allFields:Object.keys(I.cueData),fullData:I.cueData}):console.log(" No CUE data found from schedule/items tables"),I?.activeTimer&&console.log(" Full active timer data structure:",I.activeTimer),I?.activeTimer&&F){const le=`${I.activeTimer.item_id}_${I.activeTimer.started_at}`,se=I.activeTimer.item_id;U&&U!==le&&(console.log(" Active timer changed - stopping secondary timer"),console.log(" Previous timer:",U),console.log(" New timer:",le),V(Ie=>({...Ie,secondaryTimer:null}))),ve&&ve!==se&&(console.log(" New cue loaded - stopping secondary timer"),console.log(" Previous item_id:",ve),console.log(" New item_id:",se),V(Ie=>({...Ie,secondaryTimer:null})));const z=I.activeTimer.started_at;if(Ne&&Ne!==z&&(console.log(" Timer start time changed - restarting local timer"),console.log(" Previous start time:",Ne),console.log(" New start time:",z)),I.activeTimer.is_running&&I.activeTimer.is_active&&I.activeTimer.started_at){const Ie=new Date(I.activeTimer.started_at),Fe=I.activeTimer.duration_seconds;console.log(` Starting drift detection for timer ${se} with duration ${Fe}s`),ar.stopMonitoring(se),ar.startMonitoring(se,Ie,Fe,tt=>{console.log(` DriftDetector: Syncing timer ${se} with server elapsed: ${tt}s`),A(Ve=>new Set(Ve).add(se))});const Ye=setInterval(async()=>{try{console.log(` DriftDetector: Starting periodic sync for timer ${se}`),await ar.forceSync(se,async()=>{const Ve=(await qe.getActiveTimer(u))?.elapsed_seconds||0;return console.log(` DriftDetector: Server returned elapsed: ${Ve}s for timer ${se}`),Ve})}catch(tt){console.warn(` DriftDetector: Failed to sync timer ${se}:`,tt)}},3e4);K(Ye)}X(le),we(se),he(z)}else if(!I?.activeTimer&&U&&F){if(console.log(" Active timer stopped - stopping secondary timer and drift detection"),V(le=>({...le,secondaryTimer:null})),U){const le=parseInt(U.split("_")[0]);ar.stopMonitoring(le),A(se=>{const z=new Set(se);return z.delete(le),z})}ae&&(clearInterval(ae),K(null)),X(null),we(null),he(null)}}catch(I){console.error(" Error fetching hybrid timer data:",I)}};te();const fe=setInterval(te,3e3);return T(fe),()=>{clearInterval(fe),T(null)}},[F,u]),R.useEffect(()=>{if(!F||!D?.secondaryTimer)return;const te=setInterval(()=>{H(fe=>fe+1)},1e3);return()=>clearInterval(te)},[F,D?.secondaryTimer]),R.useEffect(()=>{if(!F||!D?.activeTimer)return;const te=D.activeTimer,fe=te.item_id;if(te.is_running&&te.is_active&&te.started_at){const I=new Date(te.started_at),le=te.duration_seconds;console.log(` Starting continuous local timer for ${fe} with duration ${le}s, start time: ${I.toISOString()}`);const se=setInterval(()=>{const z=new Date,Ie=Math.floor((z.getTime()-I.getTime())/1e3);v(Fe=>({...Fe,elapsed:Ie,total:le})),ar.updateLocalElapsed(fe,Ie),Ie<=10&&console.log(` Timer ${fe}: Continuous elapsed=${Ie}s, Start=${I.toISOString()}, Now=${z.toISOString()}`)},1e3);return()=>{console.log(` Stopping continuous local timer for ${fe}`),clearInterval(se)}}},[F,D?.activeTimer,Ne]),R.useEffect(()=>()=>{console.log(" Cleaning up drift detector on component unmount"),ar.destroy(),ae&&clearInterval(ae)},[]);const N=te=>{const fe=te<0,I=Math.abs(te),le=Math.floor(I/3600),se=Math.floor(I%3600/60),z=Math.floor(I%60),Ie=fe?"-":"";return le===0?`${Ie}${se.toString().padStart(2,"0")}:${z.toString().padStart(2,"0")}`:`${Ie}${le.toString().padStart(2,"0")}:${se.toString().padStart(2,"0")}:${z.toString().padStart(2,"0")}`},B=te=>te.toLocaleTimeString("en-US",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}),q=()=>{const te=p,fe=te.total-te.elapsed;if(F&&D?.activeTimer){const I=D.activeTimer;if(!I.is_running||!I.is_active)return te.total}return fe},ne=()=>{const te=p,fe=te.total-te.elapsed;if(F&&D?.activeTimer){const I=D.activeTimer;if(!I.is_running||!I.is_active)return 100}return te.total>0?fe/te.total*100:0},pe=()=>{const te=p,fe=te.total-te.elapsed;if(F&&D?.activeTimer){const I=D.activeTimer;if(!I.is_running||!I.is_active)return"#6b7280"}return fe>120?"#10b981":fe>30?"#f59e0b":"#ef4444"};return c.jsxs("div",{className:"fixed inset-0 bg-black text-white overflow-hidden flex flex-col items-center justify-center",style:{padding:0,margin:0},children:[c.jsxs("div",{className:"absolute top-10 left-10 text-3xl font-mono text-white",children:[c.jsx("div",{className:"text-slate-400 text-lg mb-1",children:"CURRENT TIME"}),c.jsx("div",{className:"text-white",children:B(w)})]}),c.jsxs("div",{className:"fixed top-10 right-10 text-3xl font-mono text-white z-50 w-80 text-right",children:[c.jsx("div",{className:"text-slate-400 text-lg mb-1",children:"CURRENT CUE"}),c.jsxs("div",{className:"text-white flex items-center justify-end gap-3 whitespace-nowrap",children:[c.jsx("span",{children:(()=>{if(F&&D?.activeTimer){const te=D.activeTimer,fe=D?.lastLoadedCue,I=D?.cueData;if(te.cue_is)return console.log(" Using CUE data from active timer cue_is:",te.cue_is),te.cue_is;if(I){console.log(" CUE data structure:",I),console.log(" CUE data fields:",Object.keys(I));const se=I.customFields?.cue||I.cue||I.cue_display||I.name||I.title;if(I.segmentName||I.segment_name||I.segment,se)return console.log(" Found CUE display:",se),se}const le=te.cue_display||te.cue;if(te.segment_name||te.segmentName,le)return le;if(fe){const se=fe.cue_display||fe.cue;if(fe.segment_name||fe.segmentName,se)return se}return te.item_id?`CUE ${te.item_id.toString().slice(-4)}`:"No CUE"}return f?f.cue.includes("CUE")?f.cue.replace(/CUE(\d+)/,"CUE $1"):`CUE ${f.cue}`:"No CUE"})()}),l&&c.jsx(xh,{itemId:l,className:"flex-shrink-0"})]})]}),!k&&F&&D?.activeTimer&&c.jsx("div",{className:"absolute bottom-10 left-10 text-center",children:c.jsx("div",{className:`text-lg font-bold px-4 py-2 rounded-lg ${D.activeTimer.is_running&&D.activeTimer.is_active?"bg-green-600 text-white":"bg-gray-600 text-white"}`,children:D.activeTimer.is_running&&D.activeTimer.is_active?" TIMER RUNNING":" TIMER STOPPED"})}),!k&&c.jsxs("div",{className:"absolute top-10 left-1/2 transform -translate-x-1/2 flex gap-3 z-50",children:[c.jsx("button",{onClick:()=>{document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-bold text-lg transition-colors",children:"FULL SCREEN"}),!k&&c.jsx("button",{onClick:()=>ue(!F),className:`px-4 py-2 rounded-lg font-bold text-lg transition-colors ${F?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-600 hover:bg-gray-700 text-white"}`,children:"SUPABASE ONLY"})]}),(()=>{if(F){const te=D?.timerMessage||y;return te&&te.enabled}return o&&s||y&&y.enabled})()&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{transform:"translateY(-40px)"},children:c.jsx("div",{className:"font-bold text-white bg-black bg-opacity-50 rounded-lg border-4 border-white text-center flex items-center justify-center",style:{width:"80vw",minHeight:"50vh",maxHeight:"70vh",lineHeight:"1.2",whiteSpace:"pre-line",overflow:"visible",padding:"30px",display:"flex",alignItems:"center",justifyContent:"center",wordWrap:"break-word"},children:(()=>{const te=F?D?.timerMessage?.message||y?.message||"":y?.message||s,fe=te.split(" ");let I;if(fe.length<=3)I=te;else if(fe.length<=6){const z=Math.ceil(fe.length/2);I=fe.slice(0,z).join(" ")+`
`+fe.slice(z).join(" ")}else if(fe.length<=10){const z=Math.ceil(fe.length/3);I=fe.slice(0,z).join(" ")+`
`+fe.slice(z,z*2).join(" ")+`
`+fe.slice(z*2).join(" ")}else{const z=Math.ceil(fe.length/4);I=fe.slice(0,z).join(" ")+`
`+fe.slice(z,z*2).join(" ")+`
`+fe.slice(z*2,z*3).join(" ")+`
`+fe.slice(z*3).join(" ")}let le;const se=/[gjpqy]/.test(te.toLowerCase());return fe.length<=3?le=se?"clamp(3rem, 12vw, 16rem)":"clamp(3.5rem, 13.5vw, 18rem)":fe.length<=6?le=se?"clamp(1.9rem, 8vw, 12rem)":"clamp(2.25rem, 9vw, 13.5rem)":fe.length<=10?le=se?"clamp(1.4rem, 6vw, 9rem)":"clamp(1.6rem, 7vw, 10.5rem)":le=se?"clamp(0.9rem, 4vw, 6rem)":"clamp(1.1rem, 5vw, 7rem)",c.jsx("div",{style:{fontSize:le},children:I})})()})}),(()=>{if(F){const te=D?.secondaryTimer;if(!te)return!1;if(!te.is_running)return console.log(" Sub-cue timer not running - hiding"),!1;if(te.is_running&&te.is_active){const fe=new Date,I=new Date(te.started_at||te.created_at),le=Math.floor((fe.getTime()-I.getTime())/1e3),se=te.duration_seconds||te.duration||0;if(Math.max(0,se-le)<=0)return!1}return!0}else return!!m})()&&c.jsxs("div",{className:`absolute animate-in fade-in duration-500 ${(F?y&&y.enabled:o&&s||y&&y.enabled)?"bottom-20 right-1/3 transform translate-x-1/2 flex flex-col items-center":"inset-0 flex flex-col items-center justify-center"}`,style:{marginTop:(F?y&&y.enabled:o&&s||y&&y.enabled)?"0":"-80px"},children:[c.jsx("div",{className:`absolute left-1/2 transform -translate-x-1/2 text-orange-400 font-bold animate-in slide-in-from-top duration-500 ${F?y&&y.enabled?"text-lg md:text-xl lg:text-2xl":"text-xl md:text-2xl lg:text-3xl":o&&s||y&&y.enabled?"text-lg md:text-xl lg:text-2xl":"text-xl md:text-2xl lg:text-3xl"} whitespace-nowrap ${(F?y&&y.enabled:o&&s||y&&y.enabled)?"bottom-20 left-1/2 transform -translate-x-1/2":""}`,style:{lineHeight:"1.2",...F?y&&y.enabled?{bottom:"calc(5rem - 25px)"}:{top:"calc(50% - 150px)"}:o&&s||y&&y.enabled?{bottom:"calc(5rem - 25px)"}:{top:"calc(50% - 150px)"}},children:(()=>{const te=F?D?.secondaryTimer:m;if(!te)return"";if(F)return(te.cue_display||te.cue||te.cue_is||"").replace(/CUE(\d+)/,"CUE $1");{const fe=te.cue||"";return fe.includes("CUE")?fe.replace(/CUE(\d+)/,"CUE $1"):`CUE ${fe}`}})()}),c.jsx("div",{className:`text-orange-400 font-mono font-bold animate-in zoom-in duration-500 ${(()=>{const te=F?D?.secondaryTimer:m;if(!te)return"text-3xl md:text-4xl lg:text-5xl";let fe=0;if(F)if(te.is_running&&te.is_active){const le=new Date,se=new Date(te.started_at||te.created_at),z=Math.floor((le.getTime()-se.getTime())/1e3),Ie=te.duration_seconds||te.duration||0;fe=Math.max(0,Ie-z)}else fe=te.duration_seconds||te.duration||0;else fe=te.remaining||0;const I=Math.floor(fe/3600);if(F){const le=D?.timerMessage||y;if(le&&le.enabled)return"text-3xl md:text-4xl lg:text-5xl"}else if(o&&s||y&&y.enabled)return"text-3xl md:text-4xl lg:text-5xl";return I===0?"text-[15rem] md:text-[16.875rem] lg:text-[22.5rem]":"text-[12rem] md:text-[13.5rem] lg:text-[18rem]"})()}`,style:{lineHeight:"1"},children:(()=>{const te=F?D?.secondaryTimer:m;if(!te)return"00:00";let fe=0;if(F)if(te.is_running&&te.is_active){const z=new Date,Ie=new Date(te.started_at||te.created_at),Fe=Math.floor((z.getTime()-Ie.getTime())/1e3),Ye=te.duration_seconds||te.duration||0;fe=Math.max(0,Ye-Fe)}else fe=te.duration_seconds||te.duration||0;else fe=te.remaining||0;const I=Math.floor(fe/3600),le=Math.floor(fe%3600/60),se=fe%60;return I===0?`${le.toString().padStart(2,"0")}:${se.toString().padStart(2,"0")}`:`${I.toString().padStart(2,"0")}:${le.toString().padStart(2,"0")}:${se.toString().padStart(2,"0")}`})()})]}),(()=>{let te=!1;if(F){const I=D?.secondaryTimer;if(I)if(I.is_running&&I.is_active){const le=new Date,se=new Date(I.started_at||I.created_at),z=Math.floor((le.getTime()-se.getTime())/1e3),Ie=I.duration_seconds||I.duration||0;te=Math.max(0,Ie-z)>0}else te=!0}else te=!!m;const fe=F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled;return te&&fe})()&&c.jsxs("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/3 transform -translate-x-1/2",children:[q()<0&&c.jsx("div",{className:"mb-2",children:c.jsx("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"})}),c.jsx("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:pe()},children:N(q())})]}),(()=>{let te=!1;if(F){const I=D?.secondaryTimer;if(I)if(!I.is_running)te=!1;else if(I.is_running&&I.is_active){const le=new Date,se=new Date(I.started_at||I.created_at),z=Math.floor((le.getTime()-se.getTime())/1e3),Ie=I.duration_seconds||I.duration||0;te=Math.max(0,Ie-z)>0}else te=!0}else te=!!m;const fe=F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled;return te&&fe})()&&c.jsx("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${Math.min(100,Math.max(0,q()/(e||1)*100))}%`,backgroundColor:pe()}})})}),(()=>{let te=!1;if(F){const I=D?.secondaryTimer;if(I)if(!I.is_running)te=!1;else if(I.is_running&&I.is_active){const le=new Date,se=new Date(I.started_at||I.created_at),z=Math.floor((le.getTime()-se.getTime())/1e3),Ie=I.duration_seconds||I.duration||0;te=Math.max(0,Ie-z)>0}else te=!0}else te=!!m;const fe=F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled;return!te&&!fe})()&&c.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center",children:[q()<0&&c.jsx("div",{className:"mb-[-50px]",children:c.jsx("div",{className:"font-bold text-red-500 text-5xl",children:"OVER TIME"})}),c.jsx("div",{className:"text-center",children:c.jsx("div",{className:`font-mono font-bold ${(()=>{const te=q();return Math.floor(Math.abs(te)/3600)===0?"text-[15rem] md:text-[16.875rem] lg:text-[22.5rem]":"text-[12rem] md:text-[13.5rem] lg:text-[18rem]"})()}`,style:{color:pe()},children:N(q())})}),c.jsx("div",{className:"w-full max-w-5xl mt-0",children:c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-8",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${ne()}%`,background:pe()}})})})]}),(()=>{let te=!1;if(F){const I=D?.secondaryTimer;if(I)if(!I.is_running)te=!1;else if(I.is_running&&I.is_active){const le=new Date,se=new Date(I.started_at||I.created_at),z=Math.floor((le.getTime()-se.getTime())/1e3),Ie=I.duration_seconds||I.duration||0;te=Math.max(0,Ie-z)>0}else te=!0}else te=!!m;return(F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled)&&!te})()&&c.jsxs("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/2 transform -translate-x-1/2",children:[q()<0&&c.jsx("div",{className:"mb-2",children:c.jsx("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"})}),c.jsx("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:pe()},children:N(q())})]}),(()=>{let te=!1;if(F){const I=D?.secondaryTimer;if(I)if(!I.is_running)te=!1;else if(I.is_running&&I.is_active){const le=new Date,se=new Date(I.started_at||I.created_at),z=Math.floor((le.getTime()-se.getTime())/1e3),Ie=I.duration_seconds||I.duration||0;te=Math.max(0,Ie-z)>0}else te=!0}else te=!!m;const fe=F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled;return te&&!fe})()&&c.jsxs("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/2 transform -translate-x-1/2",children:[q()<0&&c.jsx("div",{className:"mb-2",children:c.jsx("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"})}),c.jsx("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:pe()},children:N(q())})]}),(()=>{let te=!1;if(F){const I=D?.secondaryTimer;if(I)if(!I.is_running)te=!1;else if(I.is_running&&I.is_active){const le=new Date,se=new Date(I.started_at||I.created_at),z=Math.floor((le.getTime()-se.getTime())/1e3),Ie=I.duration_seconds||I.duration||0;te=Math.max(0,Ie-z)>0}else te=!0}else te=!!m;return(F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled)&&!te})()&&c.jsx("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${ne()}%`,background:pe()}})})}),(()=>{let te=!1;if(F){const I=D?.secondaryTimer;if(I)if(!I.is_running)te=!1;else if(I.is_running&&I.is_active){const le=new Date,se=new Date(I.started_at||I.created_at),z=Math.floor((le.getTime()-se.getTime())/1e3),Ie=I.duration_seconds||I.duration||0;te=Math.max(0,Ie-z)>0}else te=!0}else te=!!m;const fe=F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled;return te&&!fe})()&&c.jsx("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${ne()}%`,background:pe()}})})})]})},pj=()=>{const t=an();ti();const r=t.state||{},[e,n]=R.useState(r.isRunning||!1),[s,o]=R.useState(r.elapsedTime||0),[l,u]=R.useState(r.totalDuration||0),[f,m]=R.useState(""),[p,v]=R.useState(!1),[w,_]=R.useState(null),[k,b]=R.useState(r.itemId||null),[y,L]=R.useState(r.eventId||null),[G,j]=R.useState(r.mainTimer||null),[F,ue]=R.useState(r.secondaryTimer||null);R.useEffect(()=>{const V=ee=>{switch(ee.key){case"Escape":window.close();break;case" ":ee.preventDefault(),n(!e);break;case"r":case"R":(ee.ctrlKey||ee.metaKey)&&(ee.preventDefault(),o(0),n(!1));break;case"+":case"=":(ee.ctrlKey||ee.metaKey)&&ee.preventDefault();break;case"-":(ee.ctrlKey||ee.metaKey)&&ee.preventDefault();break}};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[e]);const D=async()=>{if(y&&(p||w))try{const ee=(await qe.getTimerMessagesForEvent(y)).find(T=>T.enabled);ee&&(await qe.disableTimerMessage(ee.id),console.log(" Message disabled in Supabase on close"))}catch(V){console.error(" Error clearing message on close:",V)}window.close()};return R.useEffect(()=>{if(!y)return;const V=async()=>{try{const T=await qe.getTimerMessage(y);_(T),console.log(" Loaded timer message from Supabase:",T)}catch(T){console.error(" Error loading timer message:",T)}};V();const ee=setInterval(V,5e3);return()=>clearInterval(ee)},[y]),R.useEffect(()=>{const V=ee=>{if(ee.data.type==="TIMER_UPDATE"){const{isRunning:T,elapsedTime:O,totalDuration:H,eventId:U,itemId:X,mainTimer:ve,secondaryTimer:we}=ee.data;T!==void 0&&n(T),O!==void 0&&o(O),H!==void 0&&u(H),U!==void 0&&L(U),X!==void 0&&b(X),ve!==void 0&&j(ve),we!==void 0&&ue(we)}else if(ee.data.type==="MESSAGE_UPDATE"){const{message:T,enabled:O}=ee.data;T!==void 0&&m(T),O!==void 0&&v(O)}};return window.addEventListener("message",V),()=>window.removeEventListener("message",V)},[]),c.jsx(gj,{isRunning:e,elapsedTime:s,totalDuration:l,onClose:D,message:f,messageEnabled:p,itemId:k,eventId:y,supabaseMessage:w,mainTimer:G,secondaryTimer:F})},xj=({isRunning:t=!1,elapsedTime:r=0,totalDuration:e=0,onClose:n,message:s="",messageEnabled:o=!1,itemId:l,eventId:u,mainTimer:f=null,secondaryTimer:m=null})=>{const[p,v]=R.useState({elapsed:r,total:e}),[w,_]=R.useState(new Date),[k,b]=R.useState(!1),[y,L]=R.useState(null),[G,j]=R.useState(!1),[F,ue]=R.useState(!0),[D,V]=R.useState(null),[ee,T]=R.useState(null),[O,H]=R.useState(0),[U,X]=R.useState(null),[ve,we]=R.useState(null),[Ne,he]=R.useState(null),[ae,K]=R.useState(null),[oe,A]=R.useState(null),[N,B]=R.useState(new Set);R.useEffect(()=>{if(F&&D?.activeTimer){const I=D.activeTimer;if(I.is_running&&I.is_active){const le=new Date,se=new Date(I.started_at),z=Math.floor((le.getTime()-se.getTime())/1e3),Ie=I.duration_seconds||0;v({elapsed:z,total:Ie})}else v({elapsed:0,total:I.duration_seconds||0})}else v({elapsed:r,total:e})},[r,e,F,D]),R.useEffect(()=>{const I=setInterval(()=>{_(new Date)},1e3);return()=>clearInterval(I)},[]),R.useEffect(()=>{if(!t)return;const I=setInterval(()=>{v(le=>({...le,elapsed:le.elapsed+1}))},1e3);return()=>clearInterval(I)},[t]),R.useEffect(()=>{const I=()=>{b(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",I),()=>document.removeEventListener("fullscreenchange",I)},[]),R.useEffect(()=>{if(!u)return;const I=async()=>{j(!0);try{const se=await qe.getTimerMessage(u);L(se),console.log(" Loaded timer message from Supabase:",se)}catch(se){console.error(" Error loading timer message:",se)}finally{j(!1)}};I();const le=setInterval(I,5e3);return()=>clearInterval(le)},[u]),R.useEffect(()=>{if(!F||!u){if(ee&&(clearInterval(ee),T(null)),we(null),he(null),K(null),ve){const se=parseInt(ve.split("_")[0]);ar.stopMonitoring(se)}oe&&(clearInterval(oe),A(null)),B(new Set);return}const I=async()=>{try{console.log(" Fetching hybrid timer data from Supabase...");const se=await qe.getHybridTimerData(u);if(V(se),console.log(" Hybrid timer data updated:",se),se?.secondaryTimer?console.log(" Secondary timer data:",se.secondaryTimer):console.log(" No secondary timer data found"),se?.subCueTimers&&se.subCueTimers.length>0?(console.log(" Sub-cue timers data:",se.subCueTimers),console.log(" First sub-cue timer structure:",se.subCueTimers[0])):console.log(" No sub-cue timers data found"),se?.secondaryTimer&&console.log(" Secondary timer data (from sub-cue fallback):",se.secondaryTimer),se?.activeTimer&&console.log(" Active timer data for CUE display:",{cue_display:se.activeTimer.cue_display,cue:se.activeTimer.cue,item_id:se.activeTimer.item_id,allFields:Object.keys(se.activeTimer),fullData:se.activeTimer}),se?.lastLoadedCue&&console.log(" Last loaded cue data:",{cue:se.lastLoadedCue.cue,cue_display:se.lastLoadedCue.cue_display,segment_name:se.lastLoadedCue.segment_name,allFields:Object.keys(se.lastLoadedCue),fullData:se.lastLoadedCue}),se?.cueData?console.log(" CUE data from schedule/items table:",{allFields:Object.keys(se.cueData),fullData:se.cueData}):console.log(" No CUE data found from schedule/items tables"),se?.activeTimer&&console.log(" Full active timer data structure:",se.activeTimer),se?.activeTimer&&F){const z=`${se.activeTimer.item_id}_${se.activeTimer.started_at}`,Ie=se.activeTimer.item_id;ve&&ve!==z&&(console.log(" Active timer changed - stopping secondary timer"),console.log(" Previous timer:",ve),console.log(" New timer:",z),V(Ye=>({...Ye,secondaryTimer:null}))),Ne&&Ne!==Ie&&(console.log(" New cue loaded - stopping secondary timer"),console.log(" Previous item_id:",Ne),console.log(" New item_id:",Ie),V(Ye=>({...Ye,secondaryTimer:null})));const Fe=se.activeTimer.started_at;if(ae&&ae!==Fe&&(console.log(" Timer start time changed - restarting local timer"),console.log(" Previous start time:",ae),console.log(" New start time:",Fe)),se.activeTimer.is_running&&se.activeTimer.is_active&&se.activeTimer.started_at){const Ye=new Date(se.activeTimer.started_at),tt=se.activeTimer.duration_seconds;console.log(` Starting drift detection for timer ${Ie} with duration ${tt}s`),ar.stopMonitoring(Ie),ar.startMonitoring(Ie,Ye,tt,Ee=>{console.log(` DriftDetector: Syncing timer ${Ie} with server elapsed: ${Ee}s`),B(Le=>new Set(Le).add(Ie))});const Ve=setInterval(async()=>{try{console.log(` DriftDetector: Starting periodic sync for timer ${Ie}`),await ar.forceSync(Ie,async()=>{const Le=(await qe.getActiveTimer(u))?.elapsed_seconds||0;return console.log(` DriftDetector: Server returned elapsed: ${Le}s for timer ${Ie}`),Le})}catch(Ee){console.warn(` DriftDetector: Failed to sync timer ${Ie}:`,Ee)}},3e4);A(Ve)}we(z),he(Ie),K(Fe)}else if(!se?.activeTimer&&ve&&F){if(console.log(" Active timer stopped - stopping secondary timer and drift detection"),V(z=>({...z,secondaryTimer:null})),ve){const z=parseInt(ve.split("_")[0]);ar.stopMonitoring(z),B(Ie=>{const Fe=new Set(Ie);return Fe.delete(z),Fe})}oe&&(clearInterval(oe),A(null)),we(null),he(null),K(null)}}catch(se){console.error(" Error fetching hybrid timer data:",se)}};I();const le=setInterval(I,1e3);return T(le),()=>{clearInterval(le),T(null)}},[F,u]),R.useEffect(()=>{if(!F||!D?.secondaryTimer)return;const I=setInterval(()=>{H(le=>le+1)},1e3);return()=>clearInterval(I)},[F,D?.secondaryTimer]),R.useEffect(()=>{if(!F||!D?.activeTimer)return;const I=D.activeTimer,le=I.item_id;if(I.is_running&&I.is_active&&I.started_at){const se=new Date(I.started_at),z=I.duration_seconds;console.log(` Starting continuous local timer for ${le} with duration ${z}s, start time: ${se.toISOString()}`);const Ie=setInterval(()=>{const Fe=new Date,Ye=Math.floor((Fe.getTime()-se.getTime())/1e3);v(tt=>({...tt,elapsed:Ye,total:z})),ar.updateLocalElapsed(le,Ye),Ye<=10&&console.log(` Timer ${le}: Continuous elapsed=${Ye}s, Start=${se.toISOString()}, Now=${Fe.toISOString()}`)},1e3);return()=>{console.log(` Stopping continuous local timer for ${le}`),clearInterval(Ie)}}},[F,D?.activeTimer,ae]),R.useEffect(()=>()=>{console.log(" Cleaning up drift detector on component unmount"),ar.destroy(),oe&&clearInterval(oe)},[]);const q=I=>{const le=I<0,se=Math.abs(I),z=Math.floor(se/3600),Ie=Math.floor(se%3600/60),Fe=Math.floor(se%60),Ye=le?"-":"";return z===0?`${Ye}${Ie.toString().padStart(2,"0")}:${Fe.toString().padStart(2,"0")}`:`${Ye}${z.toString().padStart(2,"0")}:${Ie.toString().padStart(2,"0")}:${Fe.toString().padStart(2,"0")}`},ne=I=>I.toLocaleTimeString("en-US",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}),pe=()=>{const I=p,le=I.total-I.elapsed;if(F&&D?.activeTimer){const se=D.activeTimer;if(!se.is_running||!se.is_active)return I.total}return le},te=()=>{const I=p,le=I.total-I.elapsed;if(F&&D?.activeTimer){const se=D.activeTimer;if(!se.is_running||!se.is_active)return 100}return I.total>0?le/I.total*100:0},fe=()=>{const I=p,le=I.total-I.elapsed;if(F&&D?.activeTimer){const se=D.activeTimer;if(!se.is_running||!se.is_active)return"#6b7280"}return le>120?"#10b981":le>30?"#f59e0b":"#ef4444"};return c.jsxs("div",{className:"fixed inset-0 bg-black text-white overflow-hidden flex flex-col items-center justify-center",style:{padding:0,margin:0},children:[c.jsxs("div",{className:"absolute top-10 left-10 text-3xl font-mono text-white",children:[c.jsx("div",{className:"text-slate-400 text-lg mb-1",children:"CURRENT TIME"}),c.jsx("div",{className:"text-white",children:ne(w)})]}),c.jsxs("div",{className:"fixed top-10 right-10 text-3xl font-mono text-white z-50 w-80 text-right",children:[c.jsx("div",{className:"text-slate-400 text-lg mb-1",children:"CURRENT CUE"}),c.jsxs("div",{className:"text-white flex items-center justify-end gap-3 whitespace-nowrap",children:[c.jsx("span",{children:(()=>{if(F&&D?.activeTimer){const I=D.activeTimer,le=D?.lastLoadedCue,se=D?.cueData;if(I.cue_is)return console.log(" Using CUE data from active timer cue_is:",I.cue_is),I.cue_is;if(se){console.log(" CUE data structure:",se),console.log(" CUE data fields:",Object.keys(se));const Ie=se.customFields?.cue||se.cue||se.cue_display||se.name||se.title;if(se.segmentName||se.segment_name||se.segment,Ie)return console.log(" Found CUE display:",Ie),Ie}const z=I.cue_display||I.cue;if(I.segment_name||I.segmentName,z)return z;if(le){const Ie=le.cue_display||le.cue;if(le.segment_name||le.segmentName,Ie)return Ie}return I.item_id?`CUE ${I.item_id.toString().slice(-4)}`:"No CUE"}else return"No CUE"})()}),l&&c.jsx(xh,{itemId:l,className:"flex-shrink-0"})]})]}),!k&&F&&D?.activeTimer&&c.jsx("div",{className:"absolute bottom-10 left-10 text-center",children:c.jsx("div",{className:`text-lg font-bold px-4 py-2 rounded-lg ${D.activeTimer.is_running&&D.activeTimer.is_active?"bg-green-600 text-white":"bg-gray-600 text-white"}`,children:D.activeTimer.is_running&&D.activeTimer.is_active?" TIMER RUNNING":" TIMER LOADED"})}),!k&&c.jsxs("div",{className:"absolute top-10 left-1/2 transform -translate-x-1/2 flex gap-3 z-50",children:[c.jsx("button",{onClick:()=>{document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-bold text-lg transition-colors",children:"FULL SCREEN"}),!k&&c.jsx("button",{className:"px-4 py-2 rounded-lg font-bold text-lg bg-purple-600 text-white cursor-default",disabled:!0,children:"SUPABASE ONLY"})]}),(()=>{if(F){const I=D?.timerMessage||y;return I&&I.enabled}return o&&s||y&&y.enabled})()&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{transform:"translateY(-40px)"},children:c.jsx("div",{className:"font-bold text-white bg-black bg-opacity-50 rounded-lg border-4 border-white text-center flex items-center justify-center",style:{width:"80vw",minHeight:"50vh",maxHeight:"70vh",lineHeight:"1.2",whiteSpace:"pre-line",overflow:"visible",padding:"30px",display:"flex",alignItems:"center",justifyContent:"center",wordWrap:"break-word"},children:(()=>{const I=F?D?.timerMessage?.message||y?.message||"":y?.message||s,le=I.split(" ");let se;if(le.length<=3)se=I;else if(le.length<=6){const Fe=Math.ceil(le.length/2);se=le.slice(0,Fe).join(" ")+`
`+le.slice(Fe).join(" ")}else if(le.length<=10){const Fe=Math.ceil(le.length/3);se=le.slice(0,Fe).join(" ")+`
`+le.slice(Fe,Fe*2).join(" ")+`
`+le.slice(Fe*2).join(" ")}else{const Fe=Math.ceil(le.length/4);se=le.slice(0,Fe).join(" ")+`
`+le.slice(Fe,Fe*2).join(" ")+`
`+le.slice(Fe*2,Fe*3).join(" ")+`
`+le.slice(Fe*3).join(" ")}let z;const Ie=/[gjpqy]/.test(I.toLowerCase());return le.length<=3?z=Ie?"clamp(3rem, 12vw, 16rem)":"clamp(3.5rem, 13.5vw, 18rem)":le.length<=6?z=Ie?"clamp(1.9rem, 8vw, 12rem)":"clamp(2.25rem, 9vw, 13.5rem)":le.length<=10?z=Ie?"clamp(1.4rem, 6vw, 9rem)":"clamp(1.6rem, 7vw, 10.5rem)":z=Ie?"clamp(0.9rem, 4vw, 6rem)":"clamp(1.1rem, 5vw, 7rem)",c.jsx("div",{style:{fontSize:z},children:se})})()})}),(()=>{if(F){const I=D?.secondaryTimer;if(!I)return!1;if(console.log(" Clock: Secondary timer data:",{is_running:I.is_running,is_active:I.is_active,remaining_seconds:I.remaining_seconds,duration_seconds:I.duration_seconds}),!I.is_running)return console.log(" Sub-cue timer not running - hiding"),!1;if(I.is_running&&I.is_active){const le=new Date,se=new Date(I.started_at||I.created_at),z=Math.floor((le.getTime()-se.getTime())/1e3),Ie=I.duration_seconds||I.duration||0;if(Math.max(0,Ie-z)<=0)return!1}return!0}else return!1})()&&c.jsxs("div",{className:`absolute animate-in fade-in duration-500 ${(F?y&&y.enabled:o&&s||y&&y.enabled)?"bottom-20 right-1/3 transform translate-x-1/2 flex flex-col items-center":"inset-0 flex flex-col items-center justify-center"}`,style:{marginTop:(F?y&&y.enabled:o&&s||y&&y.enabled)?"0":"-80px"},children:[c.jsx("div",{className:`absolute left-1/2 transform -translate-x-1/2 text-orange-400 font-bold animate-in slide-in-from-top duration-500 ${F?y&&y.enabled?"text-lg md:text-xl lg:text-2xl":"text-xl md:text-2xl lg:text-3xl":o&&s||y&&y.enabled?"text-lg md:text-xl lg:text-2xl":"text-xl md:text-2xl lg:text-3xl"} whitespace-nowrap ${(F?y&&y.enabled:o&&s||y&&y.enabled)?"bottom-20 left-1/2 transform -translate-x-1/2":""}`,style:{lineHeight:"1.2",...F?y&&y.enabled?{bottom:"calc(5rem - 25px)"}:{top:"calc(50% - 150px)"}:o&&s||y&&y.enabled?{bottom:"calc(5rem - 25px)"}:{top:"calc(50% - 150px)"}},children:(()=>{const I=F?D?.secondaryTimer:m;if(!I)return"";if(F){const le=I.cue_display||I.cue||I.cue_is||"",se=I.segment_name||I.segmentName||"",z=le.replace(/CUE(\d+)/,"CUE $1");return se?`${z} - ${se}`:z}else return"No CUE"})()}),c.jsx("div",{className:`text-orange-400 font-mono font-bold animate-in zoom-in duration-500 ${(()=>{const I=F?D?.secondaryTimer:m;if(!I)return"text-3xl md:text-4xl lg:text-5xl";let le=0;if(F)if(I.is_running&&I.is_active){const z=new Date,Ie=new Date(I.started_at||I.created_at),Fe=Math.floor((z.getTime()-Ie.getTime())/1e3),Ye=I.duration_seconds||I.duration||0;le=Math.max(0,Ye-Fe)}else le=I.duration_seconds||I.duration||0;else le=I.remaining||0;const se=Math.floor(le/3600);if(F){const z=D?.timerMessage||y;if(z&&z.enabled)return"text-3xl md:text-4xl lg:text-5xl"}else if(o&&s||y&&y.enabled)return"text-3xl md:text-4xl lg:text-5xl";return se===0?"text-[15rem] md:text-[16.875rem] lg:text-[22.5rem]":"text-[12rem] md:text-[13.5rem] lg:text-[18rem]"})()}`,style:{lineHeight:"1"},children:(()=>{const I=F?D?.secondaryTimer:m;if(!I)return"00:00";let le=0;if(F)if(I.is_running&&I.is_active){const Fe=new Date,Ye=new Date(I.started_at||I.created_at),tt=Math.floor((Fe.getTime()-Ye.getTime())/1e3),Ve=I.duration_seconds||I.duration||0;le=Math.max(0,Ve-tt)}else le=I.duration_seconds||I.duration||0;else le=0;const se=Math.floor(le/3600),z=Math.floor(le%3600/60),Ie=le%60;return se===0?`${z.toString().padStart(2,"0")}:${Ie.toString().padStart(2,"0")}`:`${se.toString().padStart(2,"0")}:${z.toString().padStart(2,"0")}:${Ie.toString().padStart(2,"0")}`})()})]}),(()=>{let I=!1;if(F){const se=D?.secondaryTimer;if(se)if(se.is_running&&se.is_active){const z=new Date,Ie=new Date(se.started_at||se.created_at),Fe=Math.floor((z.getTime()-Ie.getTime())/1e3),Ye=se.duration_seconds||se.duration||0;I=Math.max(0,Ye-Fe)>0}else I=!0}else I=!!m;const le=F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled;return I&&le})()&&c.jsxs("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/3 transform -translate-x-1/2",children:[pe()<0&&c.jsx("div",{className:"mb-2",children:c.jsx("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"})}),c.jsx("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:fe()},children:q(pe())})]}),(()=>{let I=!1;if(F){const se=D?.secondaryTimer;if(se)if(!se.is_running)I=!1;else if(se.is_running&&se.is_active){const z=new Date,Ie=new Date(se.started_at||se.created_at),Fe=Math.floor((z.getTime()-Ie.getTime())/1e3),Ye=se.duration_seconds||se.duration||0;I=Math.max(0,Ye-Fe)>0}else I=!0}else I=!!m;const le=F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled;return I&&le})()&&c.jsx("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${Math.min(100,Math.max(0,pe()/(e||1)*100))}%`,backgroundColor:fe()}})})}),(()=>{let I=!1;if(F){const se=D?.secondaryTimer;if(se)if(!se.is_running)I=!1;else if(se.is_running&&se.is_active){const z=new Date,Ie=new Date(se.started_at||se.created_at),Fe=Math.floor((z.getTime()-Ie.getTime())/1e3),Ye=se.duration_seconds||se.duration||0;I=Math.max(0,Ye-Fe)>0}else I=!0}else I=!!m;const le=F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled;return!I&&!le})()&&c.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center",children:[pe()<0&&c.jsx("div",{className:"mb-[-50px]",children:c.jsx("div",{className:"font-bold text-red-500 text-5xl",children:"OVER TIME"})}),c.jsx("div",{className:"text-center",children:c.jsx("div",{className:`font-mono font-bold ${(()=>{const I=pe();return Math.floor(Math.abs(I)/3600)===0?"text-[15rem] md:text-[16.875rem] lg:text-[22.5rem]":"text-[12rem] md:text-[13.5rem] lg:text-[18rem]"})()}`,style:{color:fe()},children:q(pe())})}),c.jsx("div",{className:"w-full max-w-5xl mt-0",children:c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-8",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${te()}%`,background:fe()}})})})]}),(()=>{let I=!1;if(F){const se=D?.secondaryTimer;if(se)if(!se.is_running)I=!1;else if(se.is_running&&se.is_active){const z=new Date,Ie=new Date(se.started_at||se.created_at),Fe=Math.floor((z.getTime()-Ie.getTime())/1e3),Ye=se.duration_seconds||se.duration||0;I=Math.max(0,Ye-Fe)>0}else I=!0}else I=!!m;return(F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled)&&!I})()&&c.jsxs("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/2 transform -translate-x-1/2",children:[pe()<0&&c.jsx("div",{className:"mb-2",children:c.jsx("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"})}),c.jsx("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:fe()},children:q(pe())})]}),(()=>{let I=!1;if(F){const se=D?.secondaryTimer;if(se)if(!se.is_running)I=!1;else if(se.is_running&&se.is_active){const z=new Date,Ie=new Date(se.started_at||se.created_at),Fe=Math.floor((z.getTime()-Ie.getTime())/1e3),Ye=se.duration_seconds||se.duration||0;I=Math.max(0,Ye-Fe)>0}else I=!0}else I=!!m;const le=F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled;return I&&!le})()&&c.jsxs("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/2 transform -translate-x-1/2",children:[pe()<0&&c.jsx("div",{className:"mb-2",children:c.jsx("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"})}),c.jsx("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:fe()},children:q(pe())})]}),(()=>{let I=!1;if(F){const se=D?.secondaryTimer;if(se)if(!se.is_running)I=!1;else if(se.is_running&&se.is_active){const z=new Date,Ie=new Date(se.started_at||se.created_at),Fe=Math.floor((z.getTime()-Ie.getTime())/1e3),Ye=se.duration_seconds||se.duration||0;I=Math.max(0,Ye-Fe)>0}else I=!0}else I=!!m;return(F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled)&&!I})()&&c.jsx("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${te()}%`,background:fe()}})})}),(()=>{let I=!1;if(F){const se=D?.secondaryTimer;if(se)if(!se.is_running)I=!1;else if(se.is_running&&se.is_active){const z=new Date,Ie=new Date(se.started_at||se.created_at),Fe=Math.floor((z.getTime()-Ie.getTime())/1e3),Ye=se.duration_seconds||se.duration||0;I=Math.max(0,Ye-Fe)>0}else I=!0}else I=!!m;const le=F?D?.timerMessage&&D.timerMessage.enabled||y&&y.enabled:o&&s||y&&y.enabled;return I&&!le})()&&c.jsx("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${te()}%`,background:fe()}})})})]})},vj=()=>{const t=an();ti();const[r]=Sd(),e=r.get("eventId"),n=t.state||{},[s,o]=R.useState(n.isRunning||!1),[l,u]=R.useState(n.elapsedTime||0),[f,m]=R.useState(n.totalDuration||0),[p,v]=R.useState(""),[w,_]=R.useState(!1),[k,b]=R.useState(null),[y,L]=R.useState(n.itemId||null),[G,j]=R.useState(e||n.eventId||null),[F,ue]=R.useState(!0),[D,V]=R.useState(n.mainTimer||null),[ee,T]=R.useState(n.secondaryTimer||null);R.useEffect(()=>{const H=U=>{switch(U.key){case"Escape":window.close();break;case" ":U.preventDefault(),o(!s);break;case"r":case"R":(U.ctrlKey||U.metaKey)&&(U.preventDefault(),u(0),o(!1));break;case"+":case"=":(U.ctrlKey||U.metaKey)&&U.preventDefault();break;case"-":(U.ctrlKey||U.metaKey)&&U.preventDefault();break}};return window.addEventListener("keydown",H),()=>window.removeEventListener("keydown",H)},[s]);const O=async()=>{if(G&&(w||k))try{const U=(await qe.getTimerMessagesForEvent(G)).find(X=>X.enabled);U&&(await qe.disableTimerMessage(U.id),console.log(" Message disabled in Supabase on close"))}catch(H){console.error(" Error clearing message on close:",H)}window.close()};return R.useEffect(()=>{if(!G)return;const H=async()=>{try{const X=await qe.getTimerMessage(G);b(X),console.log(" Loaded timer message from Supabase:",X)}catch(X){console.error(" Error loading timer message:",X)}};H();const U=setInterval(H,5e3);return()=>clearInterval(U)},[G]),R.useEffect(()=>{const H=U=>{if(U.data.type==="TIMER_UPDATE"){const{isRunning:X,elapsedTime:ve,totalDuration:we,eventId:Ne,itemId:he,mainTimer:ae,secondaryTimer:K}=U.data;X!==void 0&&o(X),ve!==void 0&&u(ve),we!==void 0&&m(we),Ne!==void 0&&j(Ne),he!==void 0&&L(he),ae!==void 0&&V(ae),K!==void 0&&T(K)}else if(U.data.type==="MESSAGE_UPDATE"){const{message:X,enabled:ve}=U.data;X!==void 0&&v(X),ve!==void 0&&_(ve)}};return window.addEventListener("message",H),()=>window.removeEventListener("message",H)},[]),c.jsx(xj,{isRunning:s,elapsedTime:l,totalDuration:f,onClose:O,message:p,messageEnabled:w,itemId:y,eventId:G,supabaseMessage:k,mainTimer:D,secondaryTimer:ee})},yj=()=>{const[t]=Sd(),r=t.get("eventId"),[e,n]=R.useState([]),[s,o]=R.useState(!0),[l,u]=R.useState(null),[f,m]=R.useState(null),[p,v]=R.useState("preview"),w=()=>window.location.hostname.includes("netlify.app")||window.location.hostname.includes("netlify.com")||window.location.hostname!=="localhost",_=()=>w()?`${window.location.origin}/.netlify/functions`:"http://localhost:3002",k=async T=>{try{await navigator.clipboard.writeText(T),console.log("Copied to clipboard:",T)}catch(O){console.error("Failed to copy to clipboard:",O);const H=document.createElement("textarea");H.value=T,document.body.appendChild(H),H.select(),document.execCommand("copy"),document.body.removeChild(H)}},[b,y]=R.useState(10),L=T=>{const O='<?xml version="1.0" encoding="UTF-8"?>',H=`
<data>
  <timestamp>${new Date().toISOString()}</timestamp>
  <event_id>${r||"unknown"}</event_id>
  <lower_thirds>
    ${T.map(U=>{const X=new Array(21).fill("");return U.speakers&&U.speakers.length>0&&U.speakers.forEach((ve,we)=>{if(we<7){const Ne=we*3;X[Ne]=ve.title||"",X[Ne+1]=ve.subtitle||"",X[Ne+2]=ve.photo||""}}),`
    <item>
      <id>${U.id}</id>
      <row>${T.indexOf(U)+1}</row>
      <cue><![CDATA[${U.cue||""}]]></cue>
      <program><![CDATA[${U.program||""}]]></program>
      <segment_name><![CDATA[${U.segmentName||""}]]></segment_name>
      <speaker_1_name><![CDATA[${X[0]}]]></speaker_1_name>
      <speaker_1_title_org><![CDATA[${X[1]}]]></speaker_1_title_org>
      <speaker_1_photo><![CDATA[${X[2]}]]></speaker_1_photo>
      <speaker_2_name><![CDATA[${X[3]}]]></speaker_2_name>
      <speaker_2_title_org><![CDATA[${X[4]}]]></speaker_2_title_org>
      <speaker_2_photo><![CDATA[${X[5]}]]></speaker_2_photo>
      <speaker_3_name><![CDATA[${X[6]}]]></speaker_3_name>
      <speaker_3_title_org><![CDATA[${X[7]}]]></speaker_3_title_org>
      <speaker_3_photo><![CDATA[${X[8]}]]></speaker_3_photo>
      <speaker_4_name><![CDATA[${X[9]}]]></speaker_4_name>
      <speaker_4_title_org><![CDATA[${X[10]}]]></speaker_4_title_org>
      <speaker_4_photo><![CDATA[${X[11]}]]></speaker_4_photo>
      <speaker_5_name><![CDATA[${X[12]}]]></speaker_5_name>
      <speaker_5_title_org><![CDATA[${X[13]}]]></speaker_5_title_org>
      <speaker_5_photo><![CDATA[${X[14]}]]></speaker_5_photo>
      <speaker_6_name><![CDATA[${X[15]}]]></speaker_6_name>
      <speaker_6_title_org><![CDATA[${X[16]}]]></speaker_6_title_org>
      <speaker_6_photo><![CDATA[${X[17]}]]></speaker_6_photo>
      <speaker_7_name><![CDATA[${X[18]}]]></speaker_7_name>
      <speaker_7_title_org><![CDATA[${X[19]}]]></speaker_7_title_org>
      <speaker_7_photo><![CDATA[${X[20]}]]></speaker_7_photo>
    </item>`}).join("")}
  </lower_thirds>
</data>`;return O+H},G=async()=>{try{if(o(!0),u(null),!r)throw new Error("Event ID is required");console.log(" Fetching lower thirds data for event:",r);const{data:T,error:O}=await Oe.from("run_of_show_data").select("*").eq("event_id",r).single();if(O)throw new Error(`Database error: ${O.message}`);if(!T||!T.schedule_items){n([]),m(new Date);return}const H=T.schedule_items,U=[];H.forEach((X,ve)=>{const we={id:`${X.id}-row`,title:"",subtitle:"",is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),segmentName:X.segmentName||"",cue:X.customFields?.cue||"",program:X.programType||"",speakers:[]};if(X.speakersText&&X.speakersText.trim())try{const he=JSON.parse(X.speakersText).sort((ae,K)=>ae.slot-K.slot);we.speakers=he.map(ae=>({title:ae.fullName||"",subtitle:ae.title&&ae.org?`${ae.title}
${ae.org}`:ae.title||ae.org||"",photo:ae.photoLink||""}))}catch(Ne){console.log("Error parsing speakers JSON for item:",X.id,Ne)}U.push(we)}),n(U),m(new Date)}catch(T){console.error("Error fetching lower thirds:",T),u(T instanceof Error?T.message:"Unknown error occurred")}finally{o(!1)}};R.useEffect(()=>{G()},[r]),R.useEffect(()=>{if(!r)return;const T=setInterval(()=>{G()},b*1e3);return()=>clearInterval(T)},[r,b]);const j=()=>{G()},F=()=>{const T=L(e),O=new Blob([T],{type:"application/xml"}),H=URL.createObjectURL(O),U=document.createElement("a");U.href=H,U.download=`lower_thirds_${r||"unknown"}_${Date.now()}.xml`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(H)},ue=()=>{const T=L(e);navigator.clipboard.writeText(T).then(()=>{alert("XML content copied to clipboard!")}).catch(O=>{console.error("Failed to copy to clipboard:",O),alert("Failed to copy to clipboard")})},D=T=>{let O="Row,Cue,Program,Segment Name,";return O+="Speaker 1 Name,Speaker 1 Title/Org,Speaker 1 Photo,",O+="Speaker 2 Name,Speaker 2 Title/Org,Speaker 2 Photo,",O+="Speaker 3 Name,Speaker 3 Title/Org,Speaker 3 Photo,",O+="Speaker 4 Name,Speaker 4 Title/Org,Speaker 4 Photo,",O+="Speaker 5 Name,Speaker 5 Title/Org,Speaker 5 Photo,",O+="Speaker 6 Name,Speaker 6 Title/Org,Speaker 6 Photo,",O+=`Speaker 7 Name,Speaker 7 Title/Org,Speaker 7 Photo
`,T.forEach((H,U)=>{const X=U+1,ve=H.cue||"",we=H.program||"",Ne=H.segmentName||"",he=new Array(21).fill("");H.speakers&&H.speakers.length>0&&H.speakers.forEach((K,oe)=>{if(oe<7){const A=oe*3;he[A]=K.title||"",he[A+1]=K.subtitle||"",he[A+2]=K.photo||""}});const ae=[X,`"${ve.replace(/"/g,'""')}"`,`"${we.replace(/"/g,'""')}"`,`"${Ne.replace(/"/g,'""')}"`,`"${he[0].replace(/"/g,'""')}"`,`"${he[1].replace(/"/g,'""')}"`,`"${he[2].replace(/"/g,'""')}"`,`"${he[3].replace(/"/g,'""')}"`,`"${he[4].replace(/"/g,'""')}"`,`"${he[5].replace(/"/g,'""')}"`,`"${he[6].replace(/"/g,'""')}"`,`"${he[7].replace(/"/g,'""')}"`,`"${he[8].replace(/"/g,'""')}"`,`"${he[9].replace(/"/g,'""')}"`,`"${he[10].replace(/"/g,'""')}"`,`"${he[11].replace(/"/g,'""')}"`,`"${he[12].replace(/"/g,'""')}"`,`"${he[13].replace(/"/g,'""')}"`,`"${he[14].replace(/"/g,'""')}"`,`"${he[15].replace(/"/g,'""')}"`,`"${he[16].replace(/"/g,'""')}"`,`"${he[17].replace(/"/g,'""')}"`,`"${he[18].replace(/"/g,'""')}"`,`"${he[19].replace(/"/g,'""')}"`,`"${he[20].replace(/"/g,'""')}"`].join(",");O+=ae+`
`}),O},V=()=>{const T=D(e),O=new Blob([T],{type:"text/csv"}),H=URL.createObjectURL(O),U=document.createElement("a");U.href=H,U.download=`lower_thirds_${r||"unknown"}_${Date.now()}.csv`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(H)},ee=()=>{const T=D(e);navigator.clipboard.writeText(T).then(()=>{alert("CSV content copied to clipboard!")}).catch(O=>{console.error("Failed to copy to clipboard:",O),alert("Failed to copy to clipboard")})};return c.jsx("div",{className:"min-h-screen bg-gray-900 text-white p-6",children:c.jsxs("div",{className:"max-w-6xl mx-auto",children:[c.jsxs("div",{className:"mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Lower Thirds XML Feed"}),c.jsx("p",{className:"text-gray-400",children:"Live XML data feed for VMIX integration with Supabase backend"}),r&&c.jsxs("p",{className:"text-sm text-blue-400 mt-2",children:["Event ID: ",r]})]}),c.jsx("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Refresh Interval (seconds)"}),c.jsxs("select",{value:b,onChange:T=>y(Number(T.target.value)),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2",children:[c.jsx("option",{value:5,children:"5 seconds"}),c.jsx("option",{value:10,children:"10 seconds"}),c.jsx("option",{value:30,children:"30 seconds"}),c.jsx("option",{value:60,children:"1 minute"})]})]}),c.jsx("div",{className:"flex items-end",children:c.jsx("button",{onClick:j,disabled:s,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 px-4 py-2 rounded font-medium",children:s?"Loading...":"Refresh Now"})}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:F,className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded font-medium",children:"Download XML"}),c.jsx("button",{onClick:ue,className:"bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded font-medium",children:"Copy XML"}),c.jsx("button",{onClick:V,className:"bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded font-medium",children:"Download CSV"}),c.jsx("button",{onClick:ee,className:"bg-orange-600 hover:bg-orange-700 px-4 py-2 rounded font-medium",children:"Copy CSV"})]})]})}),c.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:`w-3 h-3 rounded-full ${s?"bg-yellow-500":l?"bg-red-500":"bg-green-500"}`}),c.jsx("span",{className:"font-medium",children:s?"Loading...":l?"Error":"Connected"}),f&&c.jsxs("span",{className:"text-sm text-gray-400",children:["Last updated: ",f.toLocaleTimeString()]})]}),c.jsxs("div",{className:"text-sm text-gray-400",children:["Auto-refresh: ",b,"s"]})]}),l&&c.jsx("div",{className:"mt-2 text-red-400 text-sm",children:l})]}),c.jsxs("div",{className:"bg-gray-800 rounded-lg",children:[c.jsxs("div",{className:"flex border-b border-gray-600",children:[c.jsx("button",{onClick:()=>v("preview"),className:`px-6 py-3 font-medium text-sm transition-colors ${p==="preview"?"text-blue-400 border-b-2 border-blue-400 bg-gray-700":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:" XML Preview"}),c.jsx("button",{onClick:()=>v("instructions"),className:`px-6 py-3 font-medium text-sm transition-colors ${p==="instructions"?"text-blue-400 border-b-2 border-blue-400 bg-gray-700":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:" VMIX Instructions"})]}),c.jsxs("div",{className:"p-6",children:[p==="preview"&&c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold mb-4",children:"XML Preview"}),c.jsx("div",{className:"bg-gray-900 rounded p-4 overflow-auto max-h-96",children:c.jsx("pre",{className:"text-sm text-green-400 whitespace-pre-wrap",children:L(e)})})]}),p==="instructions"&&c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-bold mb-4 text-blue-400",children:"VMIX Integration Instructions"}),c.jsxs("div",{className:"space-y-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-blue-300 mb-2",children:"1. XML Data Source URL:"}),c.jsxs("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[c.jsxs("code",{className:"text-green-400 break-all flex-1",children:[_(),"/lower-thirds-xml?eventId=",r]}),c.jsx("button",{onClick:()=>k(`${_()}/lower-thirds-xml?eventId=${r}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-blue-300 mb-2",children:"2. CSV Data Source URL:"}),c.jsxs("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[c.jsxs("code",{className:"text-green-400 break-all flex-1",children:[_(),"/lower-thirds-csv?eventId=",r]}),c.jsx("button",{onClick:()=>k(`${_()}/lower-thirds-csv?eventId=${r}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-blue-300 mb-2",children:"3. Alternative: Direct Links (Netlify Only):"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[c.jsxs("code",{className:"text-green-400 break-all flex-1",children:[window.location.origin,"/.netlify/functions/lower-thirds-xml?eventId=",r]}),c.jsx("button",{onClick:()=>k(`${window.location.origin}/.netlify/functions/lower-thirds-xml?eventId=${r}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"})]}),c.jsxs("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[c.jsxs("code",{className:"text-green-400 break-all flex-1",children:[window.location.origin,"/.netlify/functions/lower-thirds-csv?eventId=",r]}),c.jsx("button",{onClick:()=>k(`${window.location.origin}/.netlify/functions/lower-thirds-csv?eventId=${r}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"})]})]}),c.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:[" ",c.jsx("strong",{children:"Tip:"})," These direct Netlify Function URLs work immediately without any server setup!"]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-blue-300 mb-2",children:"4. VMIX Setup:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-300",children:[c.jsx("li",{children:"Open VMIX and go to Data Sources"}),c.jsx("li",{children:"Add a new Data Source"}),c.jsx("li",{children:'Choose "XML" or "CSV" as the data type'}),c.jsx("li",{children:"Paste one of the URLs above"}),c.jsx("li",{children:"Set refresh interval to 10 seconds"}),c.jsx("li",{children:'Click "Add" to create the data source'})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-blue-300 mb-2",children:"5. XPath for XML (if needed):"}),c.jsxs("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[c.jsx("code",{className:"text-green-400",children:"/data/lower_thirds/item"}),c.jsx("button",{onClick:()=>k("/data/lower_thirds/item"),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"})]})]}),c.jsx("div",{className:"mt-4 p-3 bg-yellow-900/20 border border-yellow-500/30 rounded",children:c.jsxs("p",{className:"text-yellow-300 text-xs",children:[c.jsx("strong",{children:"Environment:"})," ",w()?"Netlify (Production)":"Local Development"]})})]})]})]})]})]})})},wj=()=>{const[t]=Sd(),r=t.get("eventId"),[e,n]=R.useState([]),[s,o]=R.useState(!0),[l,u]=R.useState(null),[f,m]=R.useState(null),[p,v]=R.useState("preview"),w=(V,ee,T)=>{if(!T)return"";try{const O=V.indexOf(ee);if(ee.isIndented)return"";let H=0;for(let K=0;K<O;K++){const oe=V[K];oe.isIndented||(H+=oe.durationHours*3600+oe.durationMinutes*60+oe.durationSeconds)}const[U,X]=T.split(":").map(Number),we=U*3600+X*60+H,Ne=we/3600%24,he=we%3600/60,ae=new Date;return ae.setHours(Ne,he,0,0),ae.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return""}},_=()=>window.location.hostname.includes("netlify.app")||window.location.hostname.includes("netlify.com")||window.location.hostname!=="localhost",k=()=>_()?`${window.location.origin}/.netlify/functions`:"http://localhost:3002",b=async V=>{try{await navigator.clipboard.writeText(V),console.log("Copied to clipboard:",V)}catch(ee){console.error("Failed to copy to clipboard:",ee);const T=document.createElement("textarea");T.value=V,document.body.appendChild(T),T.select(),document.execCommand("copy"),document.body.removeChild(T)}},y=async()=>{try{if(o(!0),u(null),!r)throw new Error("Event ID is required");console.log(" Fetching schedule data for event:",r);const{data:V,error:ee}=await Oe.from("run_of_show_data").select("*").eq("event_id",r).single();if(ee)throw new Error(`Database error: ${ee.message}`);if(!V||!V.schedule_items){n([]),m(new Date);return}const T=[],O=V.schedule_items,H=V.settings?.masterStartTime||"";O.filter(X=>X.isPublic).forEach((X,ve)=>{const we=w(O,X,H),Ne={id:`${X.id}-schedule`,title:X.segmentName||"Untitled Segment",subtitle:"",is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),segmentName:X.segmentName||"Untitled Segment",startTime:we||"No Start Time",speakers:[]};T.push(Ne)}),n(T),m(new Date)}catch(V){console.error("Error fetching schedule data:",V),u(V instanceof Error?V.message:"Unknown error occurred")}finally{o(!1)}};R.useEffect(()=>{y();const V=setInterval(y,1e4);return()=>clearInterval(V)},[r]);const L=V=>{const ee='<?xml version="1.0" encoding="UTF-8"?>',T=`
<data>
  <timestamp>${new Date().toISOString()}</timestamp>
  <event_id>${r||"unknown"}</event_id>
  <schedule>
    ${V.map(O=>`
    <item>
      <id>${O.id}</id>
      <row>${V.indexOf(O)+1}</row>
      <segment_name><![CDATA[${O.segmentName||""}]]></segment_name>
      <start_time><![CDATA[${O.startTime||""}]]></start_time>
    </item>`).join("")}
  </schedule>
</data>`;return ee+T},G=V=>{let ee=`Segment Name,Start Time
`;return V.forEach(T=>{const O=T.segmentName||"",H=T.startTime||"",U=[`"${O.replace(/"/g,'""')}"`,`"${H.replace(/"/g,'""')}"`].join(",");ee+=U+`
`}),ee},j=()=>{const V=L(e),ee=new Blob([V],{type:"application/xml"}),T=URL.createObjectURL(ee),O=document.createElement("a");O.href=T,O.download=`schedule-${r||"data"}.xml`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(T)},F=()=>{const V=G(e),ee=new Blob([V],{type:"text/csv"}),T=URL.createObjectURL(ee),O=document.createElement("a");O.href=T,O.download=`schedule-${r||"data"}.csv`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(T)},ue=()=>{const V=L(e);b(V)},D=()=>{const V=G(e);b(V)};return s?c.jsx("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-400",children:"Loading schedule data..."})]})}):c.jsx("div",{className:"min-h-screen bg-gray-900 text-white",children:c.jsx("div",{className:"container mx-auto px-4 py-8",children:c.jsxs("div",{className:"max-w-6xl mx-auto",children:[c.jsxs("div",{className:"mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Schedule XML Feed"}),c.jsxs("p",{className:"text-gray-400",children:["Live schedule data for VMIX integration",r&&c.jsxs("span",{className:"ml-2 text-blue-400",children:["(Event: ",r.slice(0,8),"...)"]})]}),f&&c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",f.toLocaleTimeString()]})]}),l&&c.jsx("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-500/30 rounded-lg",children:c.jsx("p",{className:"text-red-400",children:l})}),c.jsxs("div",{className:"mb-8 flex flex-wrap gap-4",children:[c.jsx("button",{onClick:j,className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:" Download XML"}),c.jsx("button",{onClick:ue,className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:" Copy XML"}),c.jsx("button",{onClick:F,className:"px-4 py-2 bg-purple-600 hover:bg-purple-500 text-white rounded-lg transition-colors",children:" Download CSV"}),c.jsx("button",{onClick:D,className:"px-4 py-2 bg-orange-600 hover:bg-orange-500 text-white rounded-lg transition-colors",children:" Copy CSV"})]}),c.jsxs("div",{className:"bg-gray-800 rounded-lg",children:[c.jsxs("div",{className:"flex border-b border-gray-600",children:[c.jsx("button",{onClick:()=>v("preview"),className:`px-6 py-3 font-medium text-sm transition-colors ${p==="preview"?"text-blue-400 border-b-2 border-blue-400 bg-gray-700":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:" XML Preview"}),c.jsx("button",{onClick:()=>v("instructions"),className:`px-6 py-3 font-medium text-sm transition-colors ${p==="instructions"?"text-blue-400 border-b-2 border-blue-400 bg-gray-700":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:" VMIX Instructions"})]}),c.jsxs("div",{className:"p-6",children:[p==="preview"&&c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold mb-4",children:"XML Preview"}),c.jsx("div",{className:"bg-gray-900 rounded p-4 overflow-auto max-h-96",children:c.jsx("pre",{className:"text-sm text-green-400 whitespace-pre-wrap",children:L(e)})})]}),p==="instructions"&&c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-bold mb-4 text-blue-400",children:"VMIX Integration Instructions"}),c.jsxs("div",{className:"space-y-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-blue-300 mb-2",children:"1. XML Data Source URL:"}),c.jsxs("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[c.jsxs("code",{className:"text-green-400 break-all flex-1",children:[k(),"/schedule-xml?eventId=",r]}),c.jsx("button",{onClick:()=>b(`${k()}/schedule-xml?eventId=${r}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-blue-300 mb-2",children:"2. CSV Data Source URL:"}),c.jsxs("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[c.jsxs("code",{className:"text-green-400 break-all flex-1",children:[k(),"/schedule-csv?eventId=",r]}),c.jsx("button",{onClick:()=>b(`${k()}/schedule-csv?eventId=${r}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-blue-300 mb-2",children:"3. Alternative: Direct Links (Netlify Only):"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[c.jsxs("code",{className:"text-green-400 break-all flex-1",children:[window.location.origin,"/.netlify/functions/schedule-xml?eventId=",r]}),c.jsx("button",{onClick:()=>b(`${window.location.origin}/.netlify/functions/schedule-xml?eventId=${r}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"})]}),c.jsxs("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[c.jsxs("code",{className:"text-green-400 break-all flex-1",children:[window.location.origin,"/.netlify/functions/schedule-csv?eventId=",r]}),c.jsx("button",{onClick:()=>b(`${window.location.origin}/.netlify/functions/schedule-csv?eventId=${r}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"})]})]}),c.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:[" ",c.jsx("strong",{children:"Tip:"})," These direct Netlify Function URLs work immediately without any server setup!"]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-blue-300 mb-2",children:"4. VMIX Setup:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-300",children:[c.jsx("li",{children:"Open VMIX and go to Data Sources"}),c.jsx("li",{children:"Add a new Data Source"}),c.jsx("li",{children:'Choose "XML" or "CSV" as the data type'}),c.jsx("li",{children:"Paste the URL above"}),c.jsx("li",{children:"Set refresh interval to 10 seconds"}),c.jsx("li",{children:'Click "Add" to create the data source'})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-blue-300 mb-2",children:"4. XPath for XML (if needed):"}),c.jsxs("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[c.jsx("code",{className:"text-green-400",children:"/data/schedule/item"}),c.jsx("button",{onClick:()=>b("/data/schedule/item"),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"})]})]}),c.jsx("div",{className:"mt-4 p-3 bg-yellow-900/20 border border-yellow-500/30 rounded",children:c.jsxs("p",{className:"text-yellow-300 text-xs",children:[c.jsx("strong",{children:"Environment:"})," ",_()?"Netlify (Production)":"Local Development"]})})]})]})]})]})]})})})},O1=()=>window.location.hostname.includes("netlify.app")||window.location.hostname.includes("netlify.com")||window.location.hostname!=="localhost",rd=()=>O1()?`${window.location.origin}/.netlify/functions`:"http://localhost:3002",Uo=async t=>{try{await navigator.clipboard.writeText(t),console.log("Copied to clipboard:",t)}catch(r){console.error("Failed to copy to clipboard:",r);const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}},bj=()=>{const[t]=Sd(),r=t.get("eventId"),[e,n]=R.useState([]),[s,o]=R.useState(!0),[l,u]=R.useState(null),[f,m]=R.useState(null),[p,v]=R.useState("preview"),w=async()=>{try{if(o(!0),u(null),!r)throw new Error("Event ID is required");console.log(" Fetching custom columns data for event:",r);const{data:j,error:F}=await Oe.from("run_of_show_data").select("*").eq("event_id",r).single();if(F)throw new Error(`Database error: ${F.message}`);if(!j||!j.schedule_items){n([]),m(new Date);return}const ue=j.schedule_items,D=j.custom_columns||[],V=[],ee=ue.filter(O=>O.isPublic),T=D.filter(O=>O.name).map(O=>O.name);ee.forEach((O,H)=>{const U={id:`${O.id}-custom`,row:H+1,cue:O.customFields?.cue||"CUE##",customFields:O.customFields||{}};V.push(U)}),n(V),m(new Date)}catch(j){console.error("Error fetching custom columns:",j),u(j instanceof Error?j.message:"Unknown error occurred")}finally{o(!1)}};R.useEffect(()=>{w();const j=setInterval(w,1e4);return()=>clearInterval(j)},[r]);const _=j=>{const F='<?xml version="1.0" encoding="UTF-8"?>',ue=`
<data>
  <timestamp>${new Date().toISOString()}</timestamp>
  <event_id>${r||"unknown"}</event_id>
  <custom_columns>
    ${j.map(D=>{const V=D.customFields?Object.entries(D.customFields).map(([ee,T])=>`<${ee}><![CDATA[${T||""}]]></${ee}>`).join(""):"";return`
    <item>
      <id>${D.id}</id>
      <row>${D.row||j.indexOf(D)+1}</row>
      <cue><![CDATA[${D.cue||""}]]></cue>
      ${V}
    </item>`}).join("")}
  </custom_columns>
</data>`;return F+ue},k=j=>{let F="Row,Cue,";const ue=new Set;return j.forEach(D=>{D.customFields&&Object.keys(D.customFields).forEach(V=>ue.add(V))}),ue.forEach(D=>{F+=`${D},`}),F=F.slice(0,-1)+`
`,j.forEach(D=>{const V=D.row||j.indexOf(D)+1,ee=D.cue||"",T=[V,`"${ee.replace(/"/g,'""')}"`,...Array.from(ue).map(O=>`"${(D.customFields?.[O]||"").replace(/"/g,'""')}"`)].join(",");F+=T+`
`}),F},b=()=>{const j=_(e),F=new Blob([j],{type:"application/xml"}),ue=URL.createObjectURL(F),D=document.createElement("a");D.href=ue,D.download=`custom-columns-${r||"data"}.xml`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(ue)},y=()=>{const j=_(e);Uo(j)},L=()=>{const j=k(e),F=new Blob([j],{type:"text/csv"}),ue=URL.createObjectURL(F),D=document.createElement("a");D.href=ue,D.download=`custom-columns-${r||"data"}.csv`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(ue)},G=()=>{const j=k(e);Uo(j)};return s?c.jsx("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),c.jsx("p",{className:"text-lg",children:"Loading Custom Columns Data..."})]})}):l?c.jsx("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),c.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Error Loading Data"}),c.jsx("p",{className:"text-gray-300 mb-6",children:l}),c.jsx("button",{onClick:w,className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:"Try Again"})]})}):c.jsx("div",{className:"min-h-screen bg-gray-900 text-white",children:c.jsx("div",{className:"container mx-auto px-4 py-8",children:c.jsxs("div",{className:"max-w-6xl mx-auto",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Custom Columns XML Feed"}),c.jsx("p",{className:"text-gray-300 text-lg",children:"Live XML and CSV data for VMIX integration with custom fields"}),r&&c.jsxs("p",{className:"text-blue-400 mt-2",children:["Event ID: ",r]}),f&&c.jsxs("p",{className:"text-gray-400 text-sm mt-2",children:["Last updated: ",f.toLocaleString()]})]}),c.jsxs("div",{className:"flex space-x-4 mb-6",children:[c.jsx("button",{className:`px-6 py-3 rounded-lg font-semibold transition-colors ${p==="preview"?"bg-blue-600 text-white shadow-lg":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,onClick:()=>v("preview"),children:" XML Preview"}),c.jsx("button",{className:`px-6 py-3 rounded-lg font-semibold transition-colors ${p==="instructions"?"bg-blue-600 text-white shadow-lg":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,onClick:()=>v("instructions"),children:" VMIX Instructions"})]}),p==="preview"&&c.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[c.jsx("h2",{className:"text-xl font-bold mb-4",children:"XML Preview"}),c.jsx("div",{className:"bg-gray-900 rounded p-4 overflow-auto max-h-96",children:c.jsx("pre",{className:"text-sm text-green-400 whitespace-pre-wrap",children:_(e)})}),c.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-3",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"XML Actions"}),c.jsx("button",{onClick:b,className:"w-full px-4 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors",children:" Download XML"}),c.jsx("button",{onClick:y,className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:" Copy XML"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"CSV Actions"}),c.jsx("button",{onClick:L,className:"w-full px-4 py-3 bg-yellow-600 hover:bg-yellow-500 text-white font-medium rounded-lg transition-colors",children:" Download CSV"}),c.jsx("button",{onClick:G,className:"w-full px-4 py-3 bg-purple-600 hover:bg-purple-500 text-white font-medium rounded-lg transition-colors",children:" Copy CSV"})]})]})]}),p==="instructions"&&c.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/30 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-bold mb-4 text-blue-400",children:"VMIX Integration Instructions"}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-md font-semibold mb-2 text-blue-300",children:"XML Data Source URL:"}),c.jsxs("div",{className:"bg-gray-800 rounded p-3 flex items-center space-x-2",children:[c.jsxs("code",{className:"text-green-400 flex-1 text-sm",children:[rd(),"/custom-columns-xml?eventId=",r||"YOUR_EVENT_ID"]}),c.jsx("button",{onClick:()=>Uo(`${rd()}/custom-columns-xml?eventId=${r||"YOUR_EVENT_ID"}`),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Copy"})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-md font-semibold mb-2 text-blue-300",children:"CSV Data Source URL:"}),c.jsxs("div",{className:"bg-gray-800 rounded p-3 flex items-center space-x-2",children:[c.jsxs("code",{className:"text-green-400 flex-1 text-sm",children:[rd(),"/custom-columns-csv?eventId=",r||"YOUR_EVENT_ID"]}),c.jsx("button",{onClick:()=>Uo(`${rd()}/custom-columns-csv?eventId=${r||"YOUR_EVENT_ID"}`),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Copy"})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-md font-semibold mb-2 text-blue-300",children:"Alternative: Direct Links (Netlify Only):"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"bg-gray-800 rounded p-3 flex items-center space-x-2",children:[c.jsxs("code",{className:"text-green-400 flex-1 text-sm",children:[window.location.origin,"/.netlify/functions/custom-columns-xml?eventId=",r||"YOUR_EVENT_ID"]}),c.jsx("button",{onClick:()=>Uo(`${window.location.origin}/.netlify/functions/custom-columns-xml?eventId=${r||"YOUR_EVENT_ID"}`),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Copy"})]}),c.jsxs("div",{className:"bg-gray-800 rounded p-3 flex items-center space-x-2",children:[c.jsxs("code",{className:"text-green-400 flex-1 text-sm",children:[window.location.origin,"/.netlify/functions/custom-columns-csv?eventId=",r||"YOUR_EVENT_ID"]}),c.jsx("button",{onClick:()=>Uo(`${window.location.origin}/.netlify/functions/custom-columns-csv?eventId=${r||"YOUR_EVENT_ID"}`),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Copy"})]})]}),c.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:[" ",c.jsx("strong",{children:"Tip:"})," These direct Netlify Function URLs work immediately without any server setup!"]})]}),c.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-500/30 rounded p-4",children:[c.jsx("h4",{className:"text-md font-semibold mb-2 text-yellow-300",children:"Environment:"}),c.jsx("p",{className:"text-yellow-200 text-sm",children:O1()?" Netlify Hosted":" Local Development"})]}),c.jsxs("div",{className:"bg-gray-800 rounded p-4",children:[c.jsx("h4",{className:"text-md font-semibold mb-2 text-gray-300",children:"VMIX Setup Steps:"}),c.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-300",children:[c.jsx("li",{children:"Open VMIX and go to Data Sources"}),c.jsx("li",{children:'Click "Add Data Source" and select "XML" or "CSV"'}),c.jsx("li",{children:'Paste the URL above into the "URL" field'}),c.jsx("li",{children:"Set refresh interval to 10 seconds for live updates"}),c.jsx("li",{children:"Configure your graphics to use the data fields"}),c.jsx("li",{children:"Custom fields will be available as separate columns"})]})]})]})]})]})})})},_j=()=>{const t=an();ti();const r=new URLSearchParams(t.search),e=r.get("eventId"),n=r.get("eventName"),s=t.state?.event||{id:e||"",name:n||"Current Event",date:"",location:"",schedule:[]},[o,l]=R.useState([]),[u,f]=R.useState(null),[m,p]=R.useState(!0),[v,w]=R.useState(null),[_,k]=R.useState(!1);R.useEffect(()=>{(async()=>{console.log("=== GRAPHICS LINKS PAGE INITIALIZATION ==="),console.log("Event from location.state:",t.state?.event),console.log("Event from URL params:",{eventId:e,eventName:n}),console.log("Final event object:",s);try{if(s?.id){console.log(" Loading from Supabase for event:",s.id);const H=await qe.getRunOfShowData(s.id);if(H){console.log(" Loaded from Supabase:",H),console.log("Schedule items from Supabase:",H.schedule_items?.length||0),console.log("Sample schedule item:",H.schedule_items?.[0]),l(H.schedule_items||[]),f(H.updated_at||null),p(!1);return}}console.log(" Falling back to localStorage...");let O=null;if(s?.id){const H=`runOfShowSchedule_${s.id}`;O=localStorage.getItem(H)}if(!O&&e){const H=`runOfShowSchedule_${e}`;O=localStorage.getItem(H)}if(!O){const U=Object.keys(localStorage).filter(X=>X.startsWith("runOfShowSchedule_"));if(U.length>0){const X=U[U.length-1];O=localStorage.getItem(X)}}if(O){const H=JSON.parse(O);console.log(" Loaded from localStorage:",H),l(H)}}catch(O){console.error(" Error loading initial data:",O)}finally{p(!1)}})()},[s?.id,e]),R.useEffect(()=>{if(!s?.id){console.log(" No event ID, skipping change detection");return}console.log(" Starting change detection for Graphics Links page");const T=async()=>{try{console.log(" Checking for changes in Graphics Links...");const H=await qe.checkForChanges(s.id,u??void 0);if(H.hasChanges){console.log(" Changes detected in Graphics Links:",H),k(!0);const U=await qe.loadChangesDynamically(s.id);U&&(console.log(" Loading updated data for Graphics Links:",U),console.log(" Updated schedule items:",U.schedule_items?.length||0),console.log(" Sample updated item:",U.schedule_items?.[0]),l(U.schedule_items||[]),f(U.updated_at||null),w(new Date),console.log(" Graphics Links data updated")),k(!1)}else console.log(" No changes detected in Graphics Links")}catch(H){console.error(" Error checking for changes in Graphics Links:",H)}};T();const O=setInterval(T,5e3);return()=>clearInterval(O)},[s?.id,u]),R.useEffect(()=>{const T=()=>{console.log(" localStorage changed, updating schedule...");let H=null;if(s?.id){const U=`runOfShowSchedule_${s.id}`;H=localStorage.getItem(U)}if(!H&&e){const U=`runOfShowSchedule_${e}`;H=localStorage.getItem(U)}if(!H){const X=Object.keys(localStorage).filter(ve=>ve.startsWith("runOfShowSchedule_"));if(X.length>0){const ve=X[X.length-1];H=localStorage.getItem(ve)}}if(H)try{k(!0);const U=JSON.parse(H);console.log(" Updated schedule from localStorage:",U),console.log(" Schedule items count:",U.length),console.log(" Sample item with speakers:",U.find(X=>X.speakersText)),l(U),w(new Date),k(!1)}catch(U){console.log("Error parsing updated schedule:",U),k(!1)}};window.addEventListener("storage",T),window.addEventListener("scheduleUpdated",T);const O=setInterval(()=>{console.log(" Polling for schedule changes..."),T()},1e3);return()=>{window.removeEventListener("storage",T),window.removeEventListener("scheduleUpdated",T),clearInterval(O)}},[s?.id,e]);const b=T=>{if(typeof T=="string"){let O=T.replace(/&/g,"\\u0026");return O=O.replace(/\n/g," ").replace(/\r/g," "),O=O.replace(/[\x00-\x1F\x7F]/g," "),O}else{if(Array.isArray(T))return T.map(O=>b(O));if(T!==null&&typeof T=="object"){const O={};for(const[H,U]of Object.entries(T))O[H]=b(U);return O}}return T},y=async()=>{console.log("=== GRAPHICS LINKS JSON GENERATION ==="),console.log("Using schedule from state:",o);let T="";try{if(s?.id){const he=await qe.getRunOfShowData(s.id);he?.settings?.masterStartTime&&(T=he.settings.masterStartTime,console.log("Master start time from Supabase:",T))}}catch(he){console.log("Error getting master start time from Supabase:",he)}if(!T){const ae=Object.keys(localStorage).filter(K=>K.startsWith("masterStartTime_"));if(ae.length>0){const K=ae[ae.length-1],oe=localStorage.getItem(K);oe&&(T=oe,console.log("Master start time from localStorage:",T))}}const O=he=>{const ae=o[he];if(!ae||ae.isIndented||!T)return"";let K=0;for(let te=0;te<he;te++){const fe=o[te];fe.isIndented||(K+=(fe.durationHours||0)*3600+(fe.durationMinutes||0)*60+(fe.durationSeconds||0))}const[oe,A]=T.split(":").map(Number),B=oe*3600+A*60+K,q=Math.floor(B/3600)%24,ne=Math.floor(B%3600/60),pe=new Date;return pe.setHours(q,ne,0,0),pe.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})};console.log("=== FINAL DATA SUMMARY ==="),console.log("Schedule from state:",o),console.log("Master start time:",T),console.log("=== END FINAL DATA SUMMARY ===");const H=o.filter(he=>he.isPublic===!0).map(he=>{const ae=o.findIndex(oe=>oe.id===he.id),K=O(ae);return{segmentName:he.segmentName||"Untitled Segment",startTime:K||"No Start Time"}});console.log("Public items found:",H);const U={event:s?.name||"Current Event",generated:new Date().toISOString(),schedule:H},X=b(U),ve=JSON.stringify(X,null,2),we=new Blob([ve],{type:"application/json;charset=utf-8;"}),Ne=URL.createObjectURL(we);window.open(Ne,"_blank")},L=()=>{console.log("=== GENERATING LOWER THIRDS JSON ==="),console.log("Event ID from URL:",e),console.log("Event object:",s),console.log("Using schedule from state:",o),console.log("Schedule length:",o.length),console.log("First few items:",o.slice(0,3));const T=o.filter(ae=>ae.speakersText&&ae.speakersText.trim());console.log("Items with speakers data:",T.length),console.log("Items with speakers:",T.map(ae=>({segmentName:ae.segmentName,speakersText:ae.speakersText,speakersLength:ae.speakersText?.length||0}))),o.length===0&&(console.log(" NO SCHEDULE DATA FOUND!"),console.log("Available localStorage keys:",Object.keys(localStorage)),console.log("Looking for keys with event ID:",e));const H=Object.keys(localStorage).filter(ae=>ae.startsWith("masterStartTime_"));if(H.length>0){const ae=H[H.length-1];localStorage.getItem(ae)}const U=[];o.forEach((ae,K)=>{console.log("Processing item:",ae.segmentName,"Speakers:",ae.speakersText),console.log("Item details:",{id:ae.id,segmentName:ae.segmentName,speakersText:ae.speakersText,speakersTextLength:ae.speakersText?.length||0,speakersTextType:typeof ae.speakersText});const oe={row:K+1,cue:ae.customFields.cue||"",program:ae.programType||"",segmentName:ae.segmentName||"",speaker1Name:"",speaker1TitleOrg:"",speaker1Photo:"",speaker2Name:"",speaker2TitleOrg:"",speaker2Photo:"",speaker3Name:"",speaker3TitleOrg:"",speaker3Photo:"",speaker4Name:"",speaker4TitleOrg:"",speaker4Photo:"",speaker5Name:"",speaker5TitleOrg:"",speaker5Photo:"",speaker6Name:"",speaker6TitleOrg:"",speaker6Photo:"",speaker7Name:"",speaker7TitleOrg:"",speaker7Photo:""};if(ae.speakersText&&ae.speakersText.trim())try{const A=JSON.parse(ae.speakersText);console.log("Parsed speakers array:",A),console.log("Speakers array length:",A?.length||0);const N=A.sort((B,q)=>B.slot-q.slot);console.log("Sorted speakers by slot:",N),N.forEach(B=>{const q=B.slot;if(q>=1&&q<=7){const ne=B.fullName||"",pe=B.title&&B.org?`${B.title}
${B.org}`:B.title||B.org||"",te=B.photoLink||"";oe[`speaker${q}Name`]=ne,oe[`speaker${q}TitleOrg`]=pe,oe[`speaker${q}Photo`]=te,console.log(`Set speaker ${q} (${ne}) in row ${K+1}`)}else console.log(`Speaker slot ${q} (${B.fullName}) is outside range 1-7, skipping`)})}catch(A){console.log("Error parsing speakers JSON:",A),console.log("Raw speakers data:",ae.speakersText)}else console.log("No speakers found in row:",ae.segmentName);U.push(oe)}),console.log("CUE rows with all speakers:",U);const X={event:s?.name||"Current Event",generated:new Date().toISOString(),lowerThirds:{cueRows:U,totalRows:U.length,totalSpeakers:U.reduce((ae,K)=>ae+[1,2,3,4,5,6,7].filter(oe=>K[`speaker${oe}Name`].trim()).length,0)}},ve=b(X),we=JSON.stringify(ve,null,2),Ne=new Blob([we],{type:"application/json;charset=utf-8;"}),he=URL.createObjectURL(Ne);window.open(he,"_blank"),console.log("=== END GENERATING LOWER THIRDS JSON ===")},G=()=>{const O=`${window.location.origin}/lower-thirds-live.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(O).then(()=>{alert(`Live JSON URL copied to clipboard:
${O}

Use this URL in VMIX Data Sources  JSON/XML

This URL will automatically update every 10 seconds!`)}).catch(()=>{const H=document.createElement("textarea");H.value=O,document.body.appendChild(H),H.select(),document.execCommand("copy"),document.body.removeChild(H),alert(`Live JSON URL copied to clipboard:
${O}

Use this URL in VMIX Data Sources  JSON/XML

This URL will automatically update every 10 seconds!`)})},j=()=>{const O=`${window.location.origin}/schedule-live.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(O).then(()=>{alert(`Live Schedule URL copied to clipboard:
${O}

Use this URL in VMIX Data Sources  JSON/XML

This URL will automatically update every 10 seconds!`)}).catch(()=>{const H=document.createElement("textarea");H.value=O,document.body.appendChild(H),H.select(),document.execCommand("copy"),document.body.removeChild(H),alert(`Live Schedule URL copied to clipboard:
${O}

Use this URL in VMIX Data Sources  JSON/XML

This URL will automatically update every 10 seconds!`)})},F=()=>{const O=`${window.location.origin}/custom-graphics-live.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(O).then(()=>{alert(`Live Custom Graphics JSON URL copied to clipboard:
${O}

Use this URL in VMIX Data Sources  JSON

This URL will automatically update every 10 seconds!`)}).catch(()=>{const H=document.createElement("textarea");H.value=O,document.body.appendChild(H),H.select(),document.execCommand("copy"),document.body.removeChild(H),alert(`Live Custom Graphics JSON URL copied to clipboard:
${O}

Use this URL in VMIX Data Sources  JSON

This URL will automatically update every 10 seconds!`)})},ue=()=>{const O=`${window.location.origin}/custom-graphics-live-csv.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(O).then(()=>{alert(`Live Custom Graphics CSV URL copied to clipboard:
${O}

Use this URL in VMIX Data Sources  CSV

This URL will automatically update every 10 seconds!`)}).catch(()=>{const H=document.createElement("textarea");H.value=O,document.body.appendChild(H),H.select(),document.execCommand("copy"),document.body.removeChild(H),alert(`Live Custom Graphics CSV URL copied to clipboard:
${O}

Use this URL in VMIX Data Sources  CSV

This URL will automatically update every 10 seconds!`)})},D=()=>{const O=`${window.location.origin}/lower-thirds-live-csv.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(O).then(()=>{alert(`Live CSV URL copied to clipboard:
${O}

Use this URL in VMIX Data Sources  CSV

This URL will automatically update every 10 seconds!`)}).catch(()=>{const H=document.createElement("textarea");H.value=O,document.body.appendChild(H),H.select(),document.execCommand("copy"),document.body.removeChild(H),alert(`Live CSV URL copied to clipboard:
${O}

Use this URL in VMIX Data Sources  CSV

This URL will automatically update every 10 seconds!`)})},V=()=>{const O=`${window.location.origin}/schedule-live-csv.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(O).then(()=>{alert(`Live Schedule CSV URL copied to clipboard:
${O}

Use this URL in VMIX Data Sources  CSV

This URL will automatically update every 10 seconds!`)}).catch(()=>{const H=document.createElement("textarea");H.value=O,document.body.appendChild(H),H.select(),document.execCommand("copy"),document.body.removeChild(H),alert(`Live Schedule CSV URL copied to clipboard:
${O}

Use this URL in VMIX Data Sources  CSV

This URL will automatically update every 10 seconds!`)})},ee=async()=>{console.log(" Starting generateCustomGraphicsJSON"),console.log(" Current schedule state:",o),console.log(" Schedule length:",o.length);let T="";const H=Object.keys(localStorage).filter(oe=>oe.startsWith("masterStartTime_"));if(H.length>0){const oe=H[H.length-1],A=localStorage.getItem(oe);A&&(T=A)}const U=oe=>{if(!T)return"";let A=0;for(let ne=0;ne<oe;ne++){const pe=o[ne];A+=pe.durationHours*60+pe.durationMinutes}const[N,B]=T.split(":").map(Number),q=new Date;return q.setHours(N,B+A,0,0),q.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})};let X=[];try{s?.id&&(X=(await qe.getRunOfShowData(s.id))?.custom_columns||[],console.log(" Custom columns from Supabase:",X))}catch(oe){console.log("Error getting custom columns from Supabase:",oe)}if(X.length===0&&s?.id){const oe=localStorage.getItem(`customColumns_${s.id}`);oe&&(X=JSON.parse(oe),console.log(" Custom columns from localStorage:",X))}console.log(" Final custom columns for graphics:",X),console.log(" Schedule data for graphics:",o),console.log(" Schedule length:",o.length),console.log(" Public items:",o.filter(oe=>oe.isPublic).length);const ve=o.filter(oe=>oe.isPublic).map(oe=>{const A={type:oe.segmentName||"Segment",text:oe.segmentName||"Custom Graphic",duration:`${oe.durationHours.toString().padStart(2,"0")}:${oe.durationMinutes.toString().padStart(2,"0")}:${oe.durationSeconds.toString().padStart(2,"0")}`,cue:oe.customFields.cue||"CUE##",startTime:U(o.findIndex(B=>B.id===oe.id)),notes:oe.notes||""},N={};return X.forEach(B=>{const q=oe.customFields[B.name];q&&q.trim()!==""&&(N[B.name]=q)}),{...A,...N}});console.log(" Generated custom graphics:",ve),console.log(" Custom graphics length:",ve.length);const we={event:s?.name||"Current Event",generated:new Date().toISOString(),customGraphics:ve.length>0?ve:[{type:"Title",text:"Welcome to Event",duration:"00:00:10",cue:"CUE01",startTime:"00:00:00",notes:"Opening title"},{type:"Break",text:"Commercial Break",duration:"00:02:00",cue:"CUE02",startTime:"00:15:00",notes:"Commercial break"}]},Ne=b(we),he=JSON.stringify(Ne,null,2),ae=new Blob([he],{type:"application/json;charset=utf-8;"}),K=URL.createObjectURL(ae);window.open(K,"_blank")};return c.jsxs("div",{className:"min-h-screen bg-slate-900 text-white pt-16",children:[c.jsx("div",{className:"bg-slate-800 border-b border-slate-700",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex items-center justify-between h-16",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{onClick:()=>{window.close()},className:"text-slate-300 hover:text-white transition-colors mr-6",children:" Back to Run of Show"}),c.jsx("h1",{className:"text-xl font-semibold",children:"Graphics Links"})]}),c.jsx("div",{className:"text-slate-400",children:s?.name||"Event"})]})})}),c.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:c.jsx("div",{className:"bg-blue-900 rounded-xl p-6 shadow-2xl border border-blue-700",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:" Event ID for Desktop App"}),c.jsx("p",{className:"text-blue-200 text-sm mt-1",children:"Copy this Event ID to use in the Python desktop application"})]}),c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"bg-slate-700 px-4 py-2 rounded-lg",children:c.jsx("code",{className:"text-green-400 font-mono text-lg",children:e||s?.id||"No Event ID"})}),c.jsx("button",{onClick:()=>{const T=e||s?.id;T?navigator.clipboard.writeText(T).then(()=>{alert("Event ID copied to clipboard!")}).catch(()=>{const O=document.createElement("textarea");O.value=T,document.body.appendChild(O),O.select(),document.execCommand("copy"),document.body.removeChild(O),alert("Event ID copied to clipboard!")}):alert("No Event ID available")},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:" Copy Event ID"})]})]})})}),c.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:c.jsxs("div",{className:"bg-green-900 rounded-xl p-6 shadow-2xl border border-green-700",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:" Python Desktop App"}),c.jsx("p",{className:"text-green-200 text-sm mt-1",children:"Download the Python application for generating live graphics files"})]}),c.jsx("div",{className:"flex items-center space-x-4",children:c.jsx("a",{href:"/LiveGraphicsGenerator-Python.zip",download:"LiveGraphicsGenerator-Python.zip",className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg transition-colors font-semibold",children:" Download Python App"})})]}),c.jsxs("div",{className:"mt-4 text-green-200 text-sm",children:[c.jsx("p",{children:" Generates CSV files every 10 seconds"}),c.jsx("p",{children:" No browser required - runs as desktop application"}),c.jsx("p",{children:" Easy setup with GUI interface"})]})]})}),c.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-8 shadow-2xl",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Generate JSON Files"}),m&&c.jsx("p",{className:"text-blue-400 text-sm mt-1",children:" Loading data..."}),v&&!m&&c.jsxs("p",{className:"text-green-400 text-sm mt-1",children:[" Last updated: ",v.toLocaleTimeString()]}),_&&c.jsx("p",{className:"text-blue-400 text-sm mt-1",children:" Updating data..."})]}),c.jsx("button",{onClick:async()=>{console.log(" Manual refresh triggered"),p(!0);try{if(s?.id){const O=await qe.getRunOfShowData(s.id);if(O){l(O.schedule_items||[]),f(O.updated_at||null),console.log(" Refreshed from Supabase"),alert("Data refreshed from database!");return}}let T=null;if(s?.id){const O=`runOfShowSchedule_${s.id}`;T=localStorage.getItem(O)}if(!T&&e){const O=`runOfShowSchedule_${e}`;T=localStorage.getItem(O)}if(!T){const H=Object.keys(localStorage).filter(U=>U.startsWith("runOfShowSchedule_"));if(H.length>0){const U=H[H.length-1];T=localStorage.getItem(U)}}if(T){const O=JSON.parse(T);console.log(" Manually refreshed schedule:",O),l(O),alert("Data refreshed from local storage!")}else alert("No schedule data found")}catch(T){console.error(" Error refreshing data:",T),alert("Error refreshing data")}finally{p(!1)}},className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:" Refresh Data"})]}),c.jsxs("p",{className:"text-slate-300 mb-8",children:["Click the buttons below to generate url links that VMIX can use as data sources for graphics.",c.jsx("span",{className:"text-green-400 font-medium",children:"  Live pages updates automatically when content changes! "}),`Use "Refresh Data" if changes don't appear automatically.`]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 flex flex-col",children:[c.jsx("h3",{className:"text-xl font-semibold text-white mb-4 text-center",children:"Lower Thirds"}),c.jsxs("div",{className:"space-y-3 mt-auto",children:[c.jsx("button",{onClick:L,className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:" Generate Static JSON"}),c.jsx("button",{onClick:G,className:"w-full px-4 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors",children:" Generate Live JSON URL"}),c.jsx("button",{onClick:D,className:"w-full px-4 py-3 bg-yellow-600 hover:bg-yellow-500 text-white font-medium rounded-lg transition-colors",children:" Generate Live CSV URL"}),c.jsx("button",{onClick:()=>{const T=`/lower-thirds-xml?eventId=${s.id}`;window.open(T,"_blank")},className:"w-full px-4 py-3 bg-purple-600 hover:bg-purple-500 text-white font-medium rounded-lg transition-colors",children:" Open XML Feed Page"})]})]}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 flex flex-col",children:[c.jsx("h3",{className:"text-xl font-semibold text-white mb-4 text-center",children:"Schedule"}),c.jsxs("div",{className:"space-y-3 mt-auto",children:[c.jsx("button",{onClick:async()=>{try{await y()}catch(T){console.error("Error generating schedule JSON:",T),alert("Error generating schedule JSON")}},className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:" Generate Static JSON"}),c.jsx("button",{onClick:j,className:"w-full px-4 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors",children:" Generate Live JSON URL"}),c.jsx("button",{onClick:V,className:"w-full px-4 py-3 bg-yellow-600 hover:bg-yellow-500 text-white font-medium rounded-lg transition-colors",children:" Generate Live CSV URL"}),c.jsx("button",{onClick:()=>{const T=`/schedule-xml?eventId=${s.id}`;window.open(T,"_blank")},className:"w-full px-4 py-3 bg-purple-600 hover:bg-purple-500 text-white font-medium rounded-lg transition-colors",children:" Open Schedule XML Feed"})]})]}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 flex flex-col",children:[c.jsx("h3",{className:"text-xl font-semibold text-white mb-4 text-center",children:"Custom Graphics"}),c.jsxs("div",{className:"space-y-3 mt-auto",children:[c.jsx("button",{onClick:async()=>{try{await ee()}catch(T){console.error("Error generating custom graphics JSON:",T),alert("Error generating custom graphics JSON")}},className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:" Generate Static JSON"}),c.jsx("button",{onClick:F,className:"w-full px-4 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors",children:" Generate Live JSON URL"}),c.jsx("button",{onClick:ue,className:"w-full px-4 py-3 bg-yellow-600 hover:bg-yellow-500 text-white font-medium rounded-lg transition-colors",children:" Generate Live CSV URL"}),c.jsx("button",{onClick:()=>{const T=`/custom-columns-xml?eventId=${s.id}`;window.open(T,"_blank")},className:"w-full px-4 py-3 bg-purple-600 hover:bg-purple-500 text-white font-medium rounded-lg transition-colors",children:" Open Custom Columns XML Feed"})]})]})]}),c.jsxs("div",{className:"mt-8 p-4 bg-slate-600 rounded-lg",children:[c.jsx("h4",{className:"text-white font-semibold mb-2",children:"VMIX Data Source Information"}),c.jsx("p",{className:"text-slate-300 text-sm",children:'These data sources are designed for VMIX and will include only items marked as "Public":'}),c.jsxs("ul",{className:"text-slate-300 text-sm mt-2 ml-4 list-disc",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Schedule:"})," Segment Name, Start Time (sorted by time)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Lower Thirds:"})," Speaker Names, Titles, Organizations, Segments, CUEs (up to 7 speakers per segment)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Custom Graphics:"})," Type, Text, Duration, CUE, Start Time, Notes, plus custom columns (if data exists)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"VMIX XML:"})," Native VMIX XML format with auto-refresh every 10 seconds, includes segment details and timing"]})]}),c.jsx("div",{className:"mt-4 p-3 bg-green-900 rounded-lg",children:c.jsxs("p",{className:"text-green-200 text-sm",children:[c.jsx("strong",{children:" Live Updates:"}),' Use the "Live" URLs for real-time data that automatically updates every 10 seconds in VMIX']})}),c.jsx("div",{className:"mt-4 p-3 bg-blue-900 rounded-lg",children:c.jsxs("p",{className:"text-blue-200 text-sm",children:[c.jsx("strong",{children:"VMIX Setup:"})," Copy the Live URLs and add them in VMIX Data Sources  JSON/XML/CSV. No need to save files manually!"]})}),c.jsx("div",{className:"mt-2 p-3 bg-yellow-900 rounded-lg",children:c.jsxs("p",{className:"text-yellow-200 text-sm",children:[c.jsx("strong",{children:"Format Options:"})," JSON (recommended), XML, or CSV - choose what works best with your VMIX setup"]})})]})]})})]})},Sj=()=>{const t=an();ti();const r=new URLSearchParams(t.search),e=r.get("eventId"),n=r.get("eventName"),s=t.state?.event||{id:e||"",name:n||"Current Event",date:"",location:"",schedule:[]};console.log("ReportsPage event data:",{fromState:!!t.state?.event,eventId:e,eventName:n,finalEvent:s,userRole:localStorage.getItem("currentUserRole")});const[o,l]=R.useState([]),[u,f]=R.useState(""),[m,p]=R.useState("showfile"),[v,w]=R.useState(1),[_,k]=R.useState("landscape");R.useEffect(()=>{console.log("=== REPORTS PAGE INITIALIZATION ==="),console.log("Event:",s);let ee=null;if(s?.id){const U=`runOfShowSchedule_${s.id}`;ee=localStorage.getItem(U)}if(!ee&&e){const U=`runOfShowSchedule_${e}`;ee=localStorage.getItem(U)}if(!ee){const X=Object.keys(localStorage).filter(ve=>ve.startsWith("runOfShowSchedule_"));if(X.length>0){const ve=X[X.length-1];ee=localStorage.getItem(ve)}}if(ee)try{const U=JSON.parse(ee);l(U),console.log("Schedule loaded:",U),console.log("First schedule item:",U[0]),console.log("Schedule item duration fields:",U[0]?{durationHours:U[0].durationHours,durationMinutes:U[0].durationMinutes,durationSeconds:U[0].durationSeconds}:"No items")}catch(U){console.log("Error parsing schedule:",U)}const O=Object.keys(localStorage).filter(U=>U.startsWith("masterStartTime_"));console.log("Master time keys found:",O);let H=null;if(s?.id&&(H=localStorage.getItem(`masterStartTime_${s.id}`),console.log(`Master time for event ${s.id}:`,H)),!H&&O.length>0){const U=O[O.length-1];H=localStorage.getItem(U),console.log("Latest master time key:",U,"Value:",H)}H?(f(H),console.log("Master start time set to:",H)):(console.log("No master start time found in localStorage"),f("09:00"),console.log("Set default master start time to 09:00"))},[s?.id,e]);const b=ee=>{if(!ee)return"Not set";const[T,O]=ee.split(":").map(Number),H=new Date;return H.setHours(T,O,0,0),H.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},y=(ee,T=20)=>ee?ee.length<=T?ee:ee.substring(0,T-3)+"...":"",L=ee=>{if(ee.trim().length===0)return{html:"",needsSmallText:!1};const T=ee.trim(),O=T.split(/\s+/);if(O.length<=1)return{html:T,needsSmallText:!1};const H=["Dr","Dr.","Prof","Prof.","Mr","Mr.","Mrs","Mrs.","Ms","Ms.","Hon","Hon.","Honorable","Sen","Sen.","Senator","Rep","Rep.","Representative","Gov","Gov.","Governor","Mayor","Judge","Ambassador","Amb","Amb.","General","Gen","Gen.","Admiral","Adm","Adm.","Colonel","Col","Col.","Major","Maj","Maj.","Captain","Capt","Capt.","Lieutenant","Lt","Lt.","Sergeant","Sgt","Sgt.","Chief","Commander","Comm"],U=["Jr","Jr.","Sr","Sr.","III","IV","V","Ph.D","PhD","MD","DDS","DVM","Esq","Esq.","CPA","PE","RN","LPN"];let X="",ve="",we="",Ne="",he="";H.includes(O[0])&&(X=O[0],O.shift());const ae=T.match(/\([DR]\)/i);if(ae){he=ae[0];const B=O.findIndex(q=>q.match(/\([DR]\)/i));B!==-1&&O.splice(B,1)}if(O.length>0&&U.includes(O[O.length-1])&&(Ne=O[O.length-1],O.pop()),O.length===0)return{html:T,needsSmallText:!1};if(O.length===1)ve=O[0];else{const B=O.length-1;we=O[B],ve=O.slice(0,B).join(" ")}const K=9;let oe=[X,ve].filter(Boolean).join(" "),A=[we,Ne,he].filter(Boolean).join(" ");if(oe.length>K&&ve.includes(" ")){const B=ve.split(" ");if(B.length>1){const q=B.pop(),ne=B.join(" ");oe=[X,ne].filter(Boolean).join(" "),A=[q,we,Ne,he].filter(Boolean).join(" ")}}if(oe.length>K&&ve.includes(" ")){const B=ve.split(" ");if(B.length>2){const q=B.splice(-2),ne=B.join(" ");oe=[X,ne].filter(Boolean).join(" "),A=[q.join(" "),we,Ne,he].filter(Boolean).join(" ")}}const N=oe.length>K||A.length>K;return{html:`${oe}<br/>${A}`,needsSmallText:N}},G=ee=>{if(console.log(`calculateStartTime called with index: ${ee}, masterStartTime: ${u}`),!u)return console.log("No master start time, returning empty string"),"";let T=0;for(let ve=0;ve<ee;ve++){const we=o[ve];T+=we.durationHours*60+we.durationMinutes}console.log(`Total minutes for index ${ee}: ${T}`);const[O,H]=u.split(":").map(Number),U=new Date;U.setHours(O,H+T,0,0);const X=U.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return console.log(`Calculated start time for index ${ee}: ${X}`),X},j=ee=>({"PreShow/End":"#8B5CF6","Podium Transition":"#8B4513","Panel Transition":"#404040","Sub Cue":"#F3F4F6","No Transition":"#059669",Video:"#F59E0B","Panel+Remote":"#1E40AF","Remote Only":"#60A5FA",Break:"#EC4899",TBD:"#6B7280",KILLED:"#DC2626",Podium:"#FFFFFF",Panel:"#FFFFFF"})[ee]||"#D3D3D3",F=ee=>ee==="Panel Transition"||ee==="Podium Transition"||ee==="Panel"||ee==="Podium"?"#FFFFFF":j(ee),ue=()=>{const ee=m==="showfile",T=m==="speakers",O=_,H=o.filter(U=>(U.day||1)===v);if(console.log("=== GENERATING REPORT ==="),console.log("Report type:",m),console.log("Selected day:",v),console.log("Total schedule items:",o.length),console.log("Filtered schedule items:",H.length),console.log("Sample item:",H[0]),console.log("Master start time:",u),H.length>0){const U=o.findIndex(ve=>ve.id===H[0].id),X=G(U);console.log("Test start time calculation:",{testIndex:U,testStartTime:X,item:H[0].segmentName})}if(ee){let U=`
        <!DOCTYPE html>
        <html>
        <head>
          <title>ROS Show File - ${s?.name||"Event"}</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 0; 
              padding: 15px;
              font-size: 11px;
              line-height: 1.3;
              background: white;
            }
            @media print {
              body { 
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
              * {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
            }
            .header { 
              text-align: center; 
              margin-bottom: 15px; 
            }
            .header h1 { 
              font-size: 16px; 
              margin: 0; 
              color: #000;
              font-weight: normal;
            }
            .header h2 { 
              font-size: 12px; 
              margin: 3px 0 0 0; 
              color: #333; 
              font-weight: normal;
            }
            .event-info { 
              background: #f5f5f5; 
              padding: 8px; 
              margin-bottom: 12px; 
              font-size: 10px;
              border: 1px solid #ddd;
            }
            .section { 
              margin-bottom: 8px; 
              border: 1px solid #000;
              page-break-inside: avoid;
            }
            .section-header { 
              padding: 6px 8px; 
              font-weight: normal; 
              font-size: 11px;
              color: white;
              background: #366092;
              border-bottom: 1px solid #000;
            }
            .section-content { 
              padding: 0; 
              background: white;
            }
            .modal-table { 
              width: 100%;
              border-collapse: collapse;
              border: 2px solid #000;
              background: white;
            }
            .modal-table td { 
              border: 1px solid #000; 
              padding: 6px 8px; 
              background: white;
              vertical-align: top;
            }
            .modal-table .header-cell { 
              background: #d9d9d9; 
              font-weight: normal; 
              text-align: center;
              font-size: 10px;
              width: 70px;
              min-width: 70px;
            }
            .modal-table .segment-cell { 
              min-width: 180px;
              max-width: 250px;
              word-wrap: break-word;
              font-size: 11px;
            }
            .modal-table .notes-cell { 
              background: #f0f0f0; 
              min-height: 35px;
              min-width: 200px;
              font-size: 10px;
            }
            .modal-table         .participants-cell { 
          background: #f0f0f0; 
          min-height: 60px;
          min-width: 600px;
          width: 600px;
          max-width: 600px;
        }
            .modal-table .start-time-cell { 
              background: #e7f3ff; 
              font-weight: normal;
              font-size: 12px;
            }
            .times-cell {
              background: #e7f3ff;
              font-weight: normal;
              text-align: center;
              vertical-align: middle;
              width: 80px;
              min-width: 80px;
            }
            .times-content {
              display: flex;
              flex-direction: column;
              gap: 2px;
            }
            .start-time {
              font-size: 11px;
              font-weight: normal;
              color: #000;
            }
            .duration {
              font-size: 11px;
              font-weight: normal;
              color: #000;
            }
            .time-label {
              font-size: 9px;
              font-weight: normal;
              color: #333;
              margin-right: 4px;
            }
            .simple-table { 
              width: 100%;
              border-collapse: collapse;
              border: 1px solid #000;
              background: white;
            }
            .simple-table td { 
              border: 1px solid #000; 
              padding: 8px; 
              background: white;
              vertical-align: top;
              font-size: 11px;
            }
        .simple-table .header-cell { 
          background: #d9d9d9; 
          font-weight: normal; 
          text-align: center;
          font-size: 10px;
        }
        .stacked-header {
          width: 300px;
        }
        .stacked-cell {
          width: 300px;
          max-width: 300px;
          vertical-align: top;
          padding: 8px;
        }
        .stacked-item {
          margin-bottom: 8px;
          padding-bottom: 6px;
          border-bottom: 1px solid #e0e0e0;
          display: flex;
          flex-direction: column;
        }
        .stacked-item:last-child {
          border-bottom: none;
          margin-bottom: 0;
          padding-bottom: 0;
        }
        .stacked-label {
          font-weight: normal;
          font-size: 9px;
          color: #333;
          margin-bottom: 3px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        .stacked-value {
          font-size: 10px;
          line-height: 1.3;
          word-wrap: break-word;
          color: #000;
          padding-left: 4px;
        }
        .slot-cell {
          width: 75px;
          height: 155px;
          vertical-align: top;
          min-width: 75px;
          max-width: 75px;
        }
        .slot-container {
          height: 155px;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          padding: 4px;
        }
        .slot-top {
          display: flex;
          flex-direction: column;
          align-items: center;
        }
        .slot-name {
          font-weight: normal;
          font-size: 11px;
          line-height: 1.2;
        }
        .slot-title {
          font-size: 10px;
          line-height: 1.1;
          color: #666;
        }
        .slot-org {
          font-size: 10px;
          line-height: 1.1;
          color: #666;
        }
        .slot-photo {
          display: flex;
          align-items: center;
          justify-content: center;
          margin-top: 8px;
        }
        .slot-photo-img {
          width: 50px;
          height: 65px;
          object-fit: cover;
          border-radius: 4px;
          border: 1px solid #ccc;
          margin: 0 auto;
        }
        .slot-text {
          margin-top: 4px;
          text-align: center;
          font-size: 9px;
          line-height: 1.2;
          color: #000;
          max-height: 90px;
          overflow: hidden;
        }
        .slot-name {
          font-weight: bold;
          font-size: 8px;
          margin-bottom: 2px;
          white-space: normal;
          word-wrap: break-word;
          text-align: center;
          line-height: 1.0;
          max-height: 18px;
          overflow: hidden;
        }
        .slot-name-small {
          font-weight: bold;
          font-size: 7px;
          margin-bottom: 2px;
          white-space: normal;
          word-wrap: break-word;
          text-align: center;
          line-height: 1.0;
          max-height: 16px;
          overflow: hidden;
        }
        .slot-title {
          font-size: 8px;
          color: #333;
          margin-bottom: 2px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .slot-org {
          font-size: 8px;
          color: #666;
          margin-bottom: 2px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .slot-role {
          font-size: 8px;
          color: #000;
          font-weight: bold;
          background-color: #f0f0f0;
          border: 1px solid #ccc;
          border-radius: 3px;
          padding: 1px 3px;
          margin-top: 2px;
          white-space: normal;
          word-wrap: break-word;
          text-align: center;
          min-height: 10px;
        }
        .notes-header-row {
          background: #e0e0e0;
        }
        .notes-header-cell {
          padding: 6px 8px;
          font-size: 10px;
          font-weight: normal;
          text-align: center;
          border-top: 2px solid #ddd;
          background: #e0e0e0;
        }
        .notes-content-row {
          background: #f9f9f9;
        }
        .notes-content-cell {
          padding: 8px;
          font-size: 10px;
          line-height: 1.3;
          background: #f9f9f9;
        }
            .modal-cell .field-label { 
              font-weight: normal; 
              font-size: 11px; 
              color: #333; 
              margin-bottom: 4px;
            }
            .modal-cell .field-value { 
              font-size: 12px; 
              color: #000;
              line-height: 1.3;
            }
            .speaker-item { 
              display: flex; 
              align-items: center; 
              margin-bottom: 6px;
              padding: 6px;
              background: white;
              border: 1px solid #ddd;
              border-radius: 4px;
              box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            }
            .speaker-photo { 
              width: 40px; 
              height: 40px; 
              border-radius: 4px; 
              object-fit: cover; 
              border: 2px solid #007acc;
              margin-right: 10px;
              flex-shrink: 0;
            }
            .speaker-info { 
              flex: 1;
            }
            .speaker-badges { 
              display: flex; 
              gap: 4px;
              margin-bottom: 3px;
            }
            .speaker-name { 
              font-weight: normal; 
              font-size: 11px; 
              color: #000;
              margin-bottom: 2px;
            }
            .slot-badge { 
              background: #007acc; 
              color: white; 
              padding: 2px 6px; 
              border-radius: 6px; 
              font-size: 8px; 
              font-weight: normal;
            }
            .location-badge { 
              background: #28a745; 
              color: white; 
              padding: 2px 6px; 
              border-radius: 6px; 
              font-size: 8px; 
              font-weight: normal;
            }
            .speaker-title { 
              color: #666; 
              font-size: 10px;
              margin-bottom: 1px;
            }
            .speaker-org { 
              color: #888; 
              font-size: 9px;
            }
            .footer { 
              margin-top: 40px; 
              text-align: center; 
              color: #666; 
              font-size: 12px;
              border-top: 1px solid #ddd;
              padding-top: 20px;
            }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
              @page { 
                size: A4 ${O}; 
                margin: 0.2in; 
              }
              .section { 
                page-break-inside: avoid;
              }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>ROS SHOW FILE</h1>
            <h2>${s?.name||"Event"}${s?.numberOfDays&&s.numberOfDays>1?` - Day ${v}`:""}</h2>
          </div>
          
      `;return H.forEach((X,ve)=>{const we=o.findIndex(N=>N.id===X.id),Ne=G(we),he=`${X.durationHours.toString().padStart(2,"0")}:${X.durationMinutes.toString().padStart(2,"0")}:${X.durationSeconds.toString().padStart(2,"0")}`,ae=j(X.programType||"");console.log(`SHOW FILE - Item ${ve} (${X.segmentName}):`,{originalIndex:we,startTime:Ne,duration:he,masterStartTime:u,itemId:X.id});let K=[];if(X.speakersText)try{K=JSON.parse(X.speakersText),console.log(`Speakers parsed for item ${ve} (${X.segmentName}):`,K),K.forEach((N,B)=>{console.log(`  Speaker ${B+1}:`,{fullName:N.fullName,photoLink:N.photoLink,photoUrl:N.photoUrl,hasPhoto:!!(N.photoLink||N.photoUrl)})})}catch(N){console.log(`Error parsing speakers for item ${ve}:`,N),K=[{fullName:X.speakersText,title:"",org:"",photoLink:""}]}else console.log(`No speakersText for item ${ve}:`,X.segmentName);let oe="";X.hasPPT&&X.hasQA?oe="PPT + Q&A":X.hasPPT?oe="PPT":X.hasQA?oe="Q&A":oe="None",U+=`
          <div class="section">
            <div class="section-content">
              <table class="simple-table">
                <tr>
                  <td class="header-cell">CUE</td>
                  <td class="header-cell">TIME</td>
                  <td class="header-cell stacked-header">SEGMENT INFO</td>
                  <td class="header-cell">SLOT 1</td>
                  <td class="header-cell">SLOT 2</td>
                  <td class="header-cell">SLOT 3</td>
                  <td class="header-cell">SLOT 4</td>
                  <td class="header-cell">SLOT 5</td>
                  <td class="header-cell">SLOT 6</td>
                  <td class="header-cell">SLOT 7</td>
                </tr>
                <tr>
                  <td>
                    <div style="margin-bottom: 4px;">${X.customFields.cue||`CUE ${ve+1}`}</div>
                    <div style="background-color: ${ae}; color: ${X.programType==="Sub Cue"?"black":"white"}; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: normal; display: inline-block; ${X.programType==="Sub Cue"?"border: 1px solid #000000;":""}">${X.programType||"Unknown"}</div>
                  </td>
                  <td class="times-cell">
                    <div class="times-content">
                      <div class="start-time">
                        <span class="time-label">Start:</span> ${Ne}
                      </div>
                      <div class="duration">
                        <span class="time-label">Dur:</span> ${he}
                      </div>
                    </div>
                  </td>
                  <td class="stacked-cell">
                    <div class="stacked-item">
                      <div class="stacked-label">SEGMENT:</div>
                      <div class="stacked-value">${X.segmentName||"Untitled Segment"}</div>
                    </div>
                    <div class="stacked-item">
                      <div class="stacked-label">SHOT:</div>
                      <div class="stacked-value">${X.shotType||"Not specified"}</div>
                    </div>
                    <div class="stacked-item">
                      <div class="stacked-label">PPT/Q&A:</div>
                      <div class="stacked-value">${oe}</div>
                    </div>
                  </td>
        `;const A=["","","","","","",""];K.length>0&&K.forEach((N,B)=>{const q=N.fullName||N.name||"Unknown",ne=N.title||"",pe=N.org||"",te=N.slot||1,fe=N.location||"Podium",I=N.photoLink||N.photoUrl||"",le=y(ne,15),se=y(pe,15);console.log(`    Processing speaker ${B+1} (${q}): photoLink="${I}"`);const z=L(q),Ie=z.needsSmallText?"slot-name-small":"slot-name";let Fe=`
              <div class="slot-container">
                <div class="slot-top">
                  <div class="slot-photo">${I?`<img src="${I}" alt="${q}" class="slot-photo-img" />`:""}</div>
                  <div class="slot-text">
                    <div class="${Ie}">${z.html}</div>
                    <div class="slot-title">${le}...</div>
                    <div class="slot-org">${se}...</div>
                  </div>
                </div>
                <div class="slot-role">${fe}</div>
              </div>
            `;const Ye=Math.min(te-1,6);Ye>=0&&Ye<7&&(A[Ye]=Fe)});for(let N=0;N<7;N++)U+=`<td class="slot-cell">${A[N]||""}</td>`;U+=`
                </tr>
                <tr class="notes-header-row">
                  <td colspan="11" class="notes-header-cell">NOTES</td>
                </tr>
                <tr class="notes-content-row">
                  <td colspan="11" class="notes-content-cell">${X.notes||"None"}</td>
                </tr>
              </table>
            </div>
          </div>
        `}),U+=`
          <div class="footer">
            <p>Generated: ${new Date().toLocaleString()} | Run of Show Application</p>
          </div>
        </body>
        </html>
      `,U}else if(T){let U=`
        <!DOCTYPE html>
        <html>
        <head>
          <title>ROS Show File - ${s?.name||"Event"}</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 0; 
              padding: 15px;
              font-size: 11px;
              line-height: 1.3;
              background: white;
            }
            @media print {
              body { 
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
              * {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
            }
            .header { 
              text-align: center; 
              margin-bottom: 15px; 
            }
            .header h1 { 
              font-size: 16px; 
              margin: 0; 
              color: #000;
              font-weight: normal;
            }
            .header h2 { 
              font-size: 12px; 
              margin: 3px 0 0 0; 
              color: #333; 
              font-weight: normal;
            }
            .event-info { 
              background: #f5f5f5; 
              padding: 8px; 
              margin-bottom: 12px; 
              font-size: 10px;
              border: 1px solid #ddd;
            }
            .section { 
              margin-bottom: 8px; 
              border: 1px solid #000;
              page-break-inside: avoid;
            }
            .section-header { 
              padding: 6px 8px; 
              font-weight: normal; 
              font-size: 11px;
              color: white;
              background: #366092;
              border-bottom: 1px solid #000;
            }
            .section-content { 
              padding: 0; 
              background: white;
            }
            .modal-table { 
              width: 100%;
              border-collapse: collapse;
              border: 2px solid #000;
              background: white;
            }
            .modal-table td { 
              border: 1px solid #000; 
              padding: 6px 8px; 
              background: white;
              vertical-align: top;
            }
            .modal-table .header-cell { 
              background: #d9d9d9; 
              font-weight: normal; 
              text-align: center;
              font-size: 10px;
              width: 70px;
              min-width: 70px;
            }
            .modal-table .segment-cell { 
              min-width: 180px;
              max-width: 250px;
              word-wrap: break-word;
              font-size: 11px;
            }
            .modal-table .notes-cell { 
              background: #f0f0f0; 
              min-height: 35px;
              min-width: 200px;
              font-size: 10px;
            }
            .modal-table         .participants-cell { 
          background: #f0f0f0; 
          min-height: 60px;
          min-width: 600px;
          width: 600px;
          max-width: 600px;
        }
            .modal-table .start-time-cell { 
              background: #e7f3ff; 
              font-weight: normal;
              font-size: 12px;
            }
            .times-cell {
              background: #e7f3ff;
              font-weight: normal;
              text-align: center;
              vertical-align: middle;
              width: 80px;
              min-width: 80px;
            }
            .times-content {
              display: flex;
              flex-direction: column;
              gap: 2px;
            }
            .start-time {
              font-size: 11px;
              font-weight: normal;
              color: #000;
            }
            .duration {
              font-size: 11px;
              font-weight: normal;
              color: #000;
            }
            .time-label {
              font-size: 9px;
              font-weight: normal;
              color: #333;
              margin-right: 4px;
            }
            .simple-table { 
              width: 100%;
              border-collapse: collapse;
              border: 1px solid #000;
              background: white;
            }
            .simple-table td { 
              border: 1px solid #000; 
              padding: 8px; 
              background: white;
              vertical-align: top;
              font-size: 11px;
            }
        .simple-table .header-cell { 
          background: #d9d9d9; 
          font-weight: normal; 
          text-align: center;
          font-size: 10px;
        }
        .stacked-header {
          width: 300px;
        }
        .stacked-cell {
          width: 300px;
          max-width: 300px;
          vertical-align: top;
          padding: 8px;
        }
        .stacked-item {
          margin-bottom: 8px;
          padding-bottom: 6px;
          border-bottom: 1px solid #e0e0e0;
          display: flex;
          flex-direction: column;
        }
        .stacked-item:last-child {
          border-bottom: none;
          margin-bottom: 0;
          padding-bottom: 0;
        }
        .stacked-label {
          font-weight: normal;
          font-size: 9px;
          color: #333;
          margin-bottom: 3px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        .stacked-value {
          font-size: 10px;
          line-height: 1.3;
          word-wrap: break-word;
          color: #000;
          padding-left: 4px;
        }
        .slot-cell {
          width: 75px;
          height: 155px;
          vertical-align: top;
          min-width: 75px;
          max-width: 75px;
        }
        .slot-container {
          height: 155px;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          padding: 4px;
        }
        .slot-top {
          display: flex;
          flex-direction: column;
          align-items: center;
        }
        .slot-name {
          font-weight: normal;
          font-size: 11px;
          line-height: 1.2;
        }
        .slot-title {
          font-size: 10px;
          line-height: 1.1;
          color: #666;
        }
        .slot-org {
          font-size: 10px;
          line-height: 1.1;
          color: #666;
        }
        .slot-photo {
          display: flex;
          align-items: center;
          justify-content: center;
          margin-top: 8px;
        }
        .slot-photo-img {
          width: 50px;
          height: 65px;
          object-fit: cover;
          border-radius: 4px;
          border: 1px solid #ccc;
          margin: 0 auto;
        }
        .slot-text {
          margin-top: 4px;
          text-align: center;
          font-size: 9px;
          line-height: 1.2;
          color: #000;
          max-height: 90px;
          overflow: hidden;
        }
        .slot-name {
          font-weight: bold;
          font-size: 8px;
          margin-bottom: 2px;
          white-space: normal;
          word-wrap: break-word;
          text-align: center;
          line-height: 1.0;
          max-height: 18px;
          overflow: hidden;
        }
        .slot-name-small {
          font-weight: bold;
          font-size: 7px;
          margin-bottom: 2px;
          white-space: normal;
          word-wrap: break-word;
          text-align: center;
          line-height: 1.0;
          max-height: 16px;
          overflow: hidden;
        }
        .slot-title {
          font-size: 8px;
          color: #333;
          margin-bottom: 2px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .slot-org {
          font-size: 8px;
          color: #666;
          margin-bottom: 2px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .slot-role {
          font-size: 8px;
          color: #000;
          font-weight: bold;
          background-color: #f0f0f0;
          border: 1px solid #ccc;
          border-radius: 3px;
          padding: 1px 3px;
          margin-top: 2px;
          white-space: normal;
          word-wrap: break-word;
          text-align: center;
          min-height: 10px;
        }
        .notes-header-row {
          background: #e0e0e0;
        }
        .notes-header-cell {
          padding: 6px 8px;
          font-size: 10px;
          font-weight: normal;
          text-align: center;
          border-top: 2px solid #ddd;
          background: #e0e0e0;
        }
        .notes-content-row {
          background: #f9f9f9;
        }
        .notes-content-cell {
          padding: 8px;
          font-size: 10px;
          line-height: 1.3;
          background: #f9f9f9;
        }
            .modal-cell .field-label { 
              font-weight: normal; 
              font-size: 11px; 
              color: #333; 
              margin-bottom: 4px;
            }
            .modal-cell .field-value { 
              font-size: 12px; 
              color: #000;
              line-height: 1.3;
            }
            .speaker-item { 
              display: flex; 
              align-items: center; 
              margin-bottom: 6px;
              padding: 6px;
              background: white;
              border: 1px solid #ddd;
              border-radius: 4px;
              box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            }
            .speaker-photo { 
              width: 40px; 
              height: 40px; 
              border-radius: 4px; 
              object-fit: cover; 
              border: 2px solid #007acc;
              margin-right: 10px;
              flex-shrink: 0;
            }
            .speaker-info { 
              flex: 1;
            }
            .speaker-badges { 
              display: flex; 
              gap: 4px;
              margin-bottom: 3px;
            }
            .speaker-name { 
              font-weight: normal; 
              font-size: 11px; 
              color: #000;
              margin-bottom: 2px;
            }
            .slot-badge { 
              background: #007acc; 
              color: white; 
              padding: 2px 6px; 
              border-radius: 6px; 
              font-size: 8px; 
              font-weight: normal;
            }
            .location-badge { 
              background: #28a745; 
              color: white; 
              padding: 2px 6px; 
              border-radius: 6px; 
              font-size: 8px; 
              font-weight: normal;
            }
            .speaker-title { 
              color: #666; 
              font-size: 10px;
              margin-bottom: 1px;
            }
            .speaker-org { 
              color: #888; 
              font-size: 9px;
            }
            .footer { 
              margin-top: 40px; 
              text-align: center; 
              color: #666; 
              font-size: 12px;
              border-top: 1px solid #ddd;
              padding-top: 20px;
            }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
              @page { 
                size: A4 ${O}; 
                margin: 0.2in; 
              }
              .section { 
                page-break-inside: avoid;
              }
            }
            /* Speaker subtext styling - smaller font for titles and organizations */
            .speaker-subtext {
              font-size: 10px;
              color: #000;
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>ROS SPEAKERS</h1>
            <h2>${s?.name||"Event"}${s?.numberOfDays&&s.numberOfDays>1?` - Day ${v}`:""}</h2>
          </div>
          
      `;return H.forEach((X,ve)=>{const we=o.findIndex(B=>B.id===X.id),Ne=G(we),he=`${X.durationHours.toString().padStart(2,"0")}:${X.durationMinutes.toString().padStart(2,"0")}:${X.durationSeconds.toString().padStart(2,"0")}`,ae=j(X.programType||"");console.log(`SPEAKERS - Item ${ve} (${X.segmentName}):`,{originalIndex:we,startTime:Ne,duration:he,masterStartTime:u,itemId:X.id});let K=[];if(X.speakersText)try{K=JSON.parse(X.speakersText),console.log(`Speakers parsed for item ${ve}:`,K)}catch(B){console.log(`Error parsing speakers for item ${ve}:`,B),K=[{fullName:X.speakersText,title:"",org:"",photoLink:""}]}else console.log(`No speakersText for item ${ve}:`,X.segmentName);let oe="";X.hasPPT&&X.hasQA?oe="PPT + Q&A":X.hasPPT?oe="PPT":X.hasQA?oe="Q&A":oe="None",U+=`
          <div class="section">
            <div class="section-content">
              <table class="simple-table">
                <tr>
                  <td class="header-cell">CUE & TIME</td>
                  <td class="header-cell stacked-header">SEGMENT INFO</td>
                  <td class="header-cell">PARTICIPANTS</td>
                  <td class="header-cell">SLOT 1</td>
                  <td class="header-cell">SLOT 2</td>
                  <td class="header-cell">SLOT 3</td>
                  <td class="header-cell">SLOT 4</td>
                  <td class="header-cell">SLOT 5</td>
                  <td class="header-cell">SLOT 6</td>
                  <td class="header-cell">SLOT 7</td>
                </tr>
                <tr>
                  <td class="times-cell">
                    <div style="margin-bottom: 4px; font-weight: bold;">${X.customFields.cue||`CUE ${ve+1}`}</div>
                    <div style="background-color: ${ae}; color: ${X.programType==="Sub Cue"?"black":"white"}; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: normal; display: inline-block; ${X.programType==="Sub Cue"?"border: 1px solid #000000;":""}">${X.programType||"Unknown"}</div>
                    <div class="times-content" style="margin-top: 6px;">
                      <div class="start-time">
                        <span class="time-label">Start:</span> ${Ne}
                      </div>
                      <div class="duration">
                        <span class="time-label">Dur:</span> ${he}
                      </div>
                    </div>
                  </td>
                  <td class="stacked-cell">
                    <div class="stacked-item">
                      <div class="stacked-label">SEGMENT:</div>
                      <div class="stacked-value">${X.segmentName||"Untitled Segment"}</div>
                    </div>
                    <div class="stacked-item">
                      <div class="stacked-label">SHOT:</div>
                      <div class="stacked-value">${X.shotType||"Not specified"}</div>
                    </div>
                    <div class="stacked-item">
                      <div class="stacked-label">PPT/Q&A:</div>
                      <div class="stacked-value">${oe}</div>
                    </div>
                  </td>
                  <td class="participants-cell">
        `;let A="";K.length>0&&(A=K.map(B=>{const q=B.fullName||B.name||B,ne=B.title||"",pe=B.org||"",te=B.location||"Podium",fe=B.slot||1;let le=`<strong>${te==="Podium"?"P":te==="Seat"?"S":"V"}${fe} - ${q}</strong>`;if(ne||pe){const se=[ne,pe].filter(Boolean).join(", ");le+=`<br><span class="speaker-subtext">${se}</span>`}return le}).join("<br><br>")),U+=A||"No speakers assigned",U+=`
                  </td>
        `;const N=["","","","","","",""];K.length>0&&K.forEach((B,q)=>{const ne=B.fullName||B.name||"Unknown",pe=B.title||"",te=B.org||"",fe=B.slot||1,I=B.location||"Podium",le=B.photoLink||B.photoUrl||"";y(pe,15),y(te,15),console.log(`    Processing speaker ${q+1} (${ne}): photoLink="${le}"`);let se=`
              <div class="slot-container">
                <div class="slot-top">
                  <div class="slot-photo">${le?`<img src="${le}" alt="${ne}" class="slot-photo-img" />`:""}</div>
                </div>
                <div class="slot-role">${I}</div>
              </div>
            `;const z=Math.min(fe-1,6);z>=0&&z<7&&(N[z]=se)});for(let B=0;B<7;B++)U+=`<td class="slot-cell">${N[B]||""}</td>`;U+=`
                </tr>
                <tr class="notes-header-row">
                  <td colspan="11" class="notes-header-cell">NOTES</td>
                </tr>
                <tr class="notes-content-row">
                  <td colspan="11" class="notes-content-cell">${X.notes||"None"}</td>
                </tr>
              </table>
            </div>
          </div>
        `}),U+=`
          <div class="footer">
            <p>Generated: ${new Date().toLocaleString()} | Run of Show Application</p>
          </div>
        </body>
        </html>
      `,U}else{let U=`
        <!DOCTYPE html>
        <html>
        <head>
          <title>Run of Show Report - ${s?.name||"Event"}</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 20px; 
              font-size: 14px;
            }
            .header { 
              text-align: center; 
              margin-bottom: 30px; 
            }
            .header h1 { 
              font-size: 24px; 
              margin: 0; 
            }
            .header h2 { 
              font-size: 18px; 
              margin: 5px 0 0 0; 
              color: #666; 
            }
            .event-info { 
              background: #f5f5f5; 
              padding: 15px; 
              border-radius: 5px; 
              margin-bottom: 20px; 
              font-size: 12px;
            }
            table { 
              width: 100%; 
              border-collapse: collapse; 
              margin-top: 20px; 
            }
            th, td { 
              border: 1px solid #ddd; 
              padding: 8px; 
              text-align: left; 
              font-size: 12px;
            }
            /* Column width specifications */
            th:nth-child(1), td:nth-child(1) { width: 8%; }  /* CUE */
            th:nth-child(2), td:nth-child(2) { width: 8%; } /* START */
            th:nth-child(3), td:nth-child(3) { width: 8%; } /* DURATION */
            th:nth-child(4), td:nth-child(4) { width: 20%; } /* SEGMENT */
            th:nth-child(5), td:nth-child(5) { width: 10%; } /* SHOT/PPT */
            th:nth-child(6), td:nth-child(6) { width: 26%; } /* PARTICIPANTS */
            th:nth-child(7), td:nth-child(7) { width: 20%; } /* NOTES */
            
            /* Speaker subtext styling - smaller font for titles and organizations */
            .speaker-subtext {
              font-size: 10px;
              color: #000;
            }
            th { 
              background-color: #f2f2f2; 
              font-weight: normal; 
            }
            tr { 
              -webkit-print-color-adjust: exact !important;
              color-adjust: exact !important;
              print-color-adjust: exact !important;
            }
            .footer { 
              margin-top: 30px; 
              text-align: center; 
              color: #666; 
              font-size: 12px;
            }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
              @page { 
                size: A4 ${O}; 
                margin: 0.2in; 
              }
              tr { 
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>RUN OF SHOW REPORT</h1>
            <h2>${s?.name||"Event"}${s?.numberOfDays&&s.numberOfDays>1?` - Day ${v}`:""}</h2>
            <h3>ROS CONDENSED</h3>
          </div>
          
          <div class="event-info">
            <p><strong>Event:</strong> ${s?.name||"Current Event"} | 
               <strong>Date:</strong> ${s?.date||"Not specified"} | 
               <strong>Location:</strong> ${s?.location||"Not specified"} | 
               <strong>Start Time:</strong> ${u||"Not set"} | 
               <strong>Total Items:</strong> ${o.length}</p>
          </div>
          
          <table>
            <thead>
              <tr>
                <th>CUE</th>
                <th>START</th>
                <th>DURATION</th>
                <th>SEGMENT</th>
                <th>SHOT/PPT</th>
                <th>PARTICIPANTS</th>
                <th>NOTES</th>
              </tr>
            </thead>
            <tbody>
      `;return H.forEach((X,ve)=>{const we=o.findIndex(B=>B.id===X.id),Ne=G(we),he=`${X.durationHours.toString().padStart(2,"0")}:${X.durationMinutes.toString().padStart(2,"0")}:${X.durationSeconds.toString().padStart(2,"0")}`;j(X.programType||"");let ae="";if(X.speakersText)try{ae=JSON.parse(X.speakersText).map(q=>{const ne=q.fullName||q.name||q,pe=q.title||"",te=q.org||"",fe=q.location||"Podium",I=q.slot||1;let se=`<strong>${fe==="Podium"?"P":fe==="Seat"?"S":"V"}${I} - ${ne}</strong>`;if(pe||te){const z=[pe,te].filter(Boolean).join(", ");se+=`<br><span class="speaker-subtext">${z}</span>`}return se}).join("<br><br>")}catch{ae=X.speakersText}let K="";const oe=X.shotType||"";let A="";X.hasPPT&&X.hasQA?A="PPT + Q&A":X.hasPPT?A="PPT":X.hasQA?A="Q&A":A="",oe&&A?K=`${oe} | ${A}`:oe?K=oe:A?K=A:K="";let N="";if(X.notes){const B=X.notes.replace(/<[^>]*>/g,"").trim();B&&B.length>0&&B!=="None"&&B!=="null"&&B!=="undefined"&&(N=B)}U+=`
          <tr style="background-color: ${F(X.programType)};">
            <td>${X.programType==="Sub Cue"?`<span style="background-color: #9CA3AF; color: white; padding: 2px 6px; border-radius: 4px; font-weight: bold;">${X.customFields?.cue||""}</span>`:X.programType==="Podium"||X.programType==="Podium Transition"?`<span style="background-color: #8B4513; color: white; padding: 2px 6px; border-radius: 4px; font-weight: bold;">${X.customFields?.cue||""}</span>`:X.programType==="Panel"||X.programType==="Panel Transition"?`<span style="background-color: #404040; color: white; padding: 2px 6px; border-radius: 4px; font-weight: bold;">${X.customFields?.cue||""}</span>`:X.customFields?.cue||""}</td>
            <td>${Ne}</td>
            <td>${he}</td>
            <td>${X.segmentName||"Untitled Segment"}</td>
            <td>${K}</td>
            <td style="white-space: pre-line;">${ae}</td>
            <td style="white-space: pre-line; font-size: 12px;">${N}</td>
          </tr>
        `}),U+=`
            </tbody>
          </table>
          
          <div class="footer">
            <p>Generated: ${new Date().toLocaleString()} | Run of Show Application</p>
          </div>
        </body>
        </html>
      `,U}},D=()=>{const ee=ue(),T=window.open("","_blank");T&&(T.document.write(ee),T.document.close(),T.focus(),T.print())},V=()=>{const ee=ue(),T=new Blob([ee],{type:"text/html"}),O=URL.createObjectURL(T),H=document.createElement("a");H.href=O,H.download=`ros-${m==="showfile"?"show-file":m==="speakers"?"speakers":"condensed"}${s?.numberOfDays&&s.numberOfDays>1?`-day-${v}`:""}-${s?.name?.replace(/\s+/g,"-")||"event"}-${new Date().toISOString().split("T")[0]}.html`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(O)};return c.jsxs("div",{className:"min-h-screen bg-slate-900 text-white pt-16",children:[c.jsx("div",{className:"bg-slate-800 border-b border-slate-700",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex items-center justify-between h-16",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{onClick:()=>{window.close()},className:"text-slate-300 hover:text-white transition-colors mr-6",children:" Back to Run of Show"}),c.jsx("h1",{className:"text-xl font-semibold",children:"Reports and Printing"})]}),c.jsx("div",{className:"text-slate-400",children:s?.name||"Event"})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-8 shadow-2xl",children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Generate Reports"}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 mb-8",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Report Options"}),c.jsx("div",{className:"relative",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Report Type"}),c.jsxs("select",{value:m,onChange:ee=>p(ee.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"showfile",children:"ROS Show File"}),c.jsx("option",{value:"condensed",children:"ROS CONDENSED"}),c.jsx("option",{value:"speakers",children:"ROS Speakers"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Print Orientation"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("label",{className:`flex items-center justify-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${_==="portrait"?"border-blue-500 bg-blue-500/20 text-blue-300":"border-slate-500 bg-slate-600/50 text-slate-300 hover:border-slate-400 hover:bg-slate-600/70"}`,children:[c.jsx("input",{type:"radio",name:"orientation",value:"portrait",checked:_==="portrait",onChange:ee=>k(ee.target.value),className:"sr-only"}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsxs("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[c.jsx("rect",{x:"3",y:"3",width:"18",height:"24",rx:"2",strokeWidth:"2"}),c.jsx("path",{d:"M8 7h8M8 11h8M8 15h4",strokeWidth:"1.5"})]}),c.jsx("span",{className:"text-sm font-medium",children:"Portrait"})]})]}),c.jsxs("label",{className:`flex items-center justify-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${_==="landscape"?"border-blue-500 bg-blue-500/20 text-blue-300":"border-slate-500 bg-slate-600/50 text-slate-300 hover:border-slate-400 hover:bg-slate-600/70"}`,children:[c.jsx("input",{type:"radio",name:"orientation",value:"landscape",checked:_==="landscape",onChange:ee=>k(ee.target.value),className:"sr-only"}),c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsxs("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[c.jsx("rect",{x:"3",y:"3",width:"24",height:"18",rx:"2",strokeWidth:"2"}),c.jsx("path",{d:"M7 8h10M7 12h10M7 16h6",strokeWidth:"1.5"})]}),c.jsx("span",{className:"text-sm font-medium",children:"Landscape"})]})]})]}),c.jsx("p",{className:"text-xs text-slate-400 mt-2",children:_==="landscape"?"Recommended for tables and wide content":"Better for text-heavy documents"})]}),s?.numberOfDays&&s.numberOfDays>1&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Select Day"}),c.jsx("select",{value:v,onChange:ee=>w(parseInt(ee.target.value)),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:Array.from({length:s.numberOfDays},(ee,T)=>c.jsxs("option",{value:T+1,children:["Day ",T+1]},T+1))})]})]}),c.jsx("div",{className:"flex items-center justify-center h-full",children:c.jsxs("div",{className:"bg-slate-600/30 rounded-lg p-4 border border-slate-500 w-full max-w-md",children:[c.jsx("h4",{className:"text-lg font-semibold text-white mb-3 text-center",children:"Report Format Information"}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("p",{children:[c.jsx("span",{className:"text-blue-300 text-base",children:" ROS Show File:"})," Section-based format with speaker photos"]}),c.jsxs("p",{children:[c.jsx("span",{className:"text-green-300 text-base",children:" ROS CONDENSED:"})," Table format with all information"]}),c.jsxs("p",{children:[c.jsx("span",{className:"text-orange-300 text-base",children:" ROS Speakers:"})," Table format with dedicated speaker column"]}),c.jsxs("p",{children:[c.jsx("span",{className:"text-purple-300 text-base",children:" Color Coding:"})," Sections colored by program type"]})]})]})})]})})]}),c.jsxs("div",{className:"flex flex-wrap gap-4",children:[c.jsxs("button",{onClick:D,className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Report"]}),c.jsxs("button",{onClick:V,className:"px-6 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download Report"]})]}),c.jsxs("div",{className:"mt-8",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Report Preview"}),c.jsx("div",{className:"bg-slate-700 rounded-lg p-4 max-h-96 overflow-y-auto",children:c.jsxs("div",{className:"text-slate-300 text-sm",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Event:"})," ",s?.name||"Current Event"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Total Items:"})," ",o.length,s?.numberOfDays&&s.numberOfDays>1?` | <strong>Day ${v} Items:</strong> ${o.filter(ee=>(ee.day||1)===v).length}`:""]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Master Start Time:"})," ",b(u)]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Report Type:"})," ",m==="showfile"?"ROS Show File":m==="speakers"?"ROS Speakers":"ROS CONDENSED"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Format:"})," ",m==="showfile"?"Section-based with speaker photos":m==="speakers"?"Table format with dedicated speaker column":"Table format"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Orientation:"})," ",_==="landscape"?"Landscape (recommended for tables)":"Portrait"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Color Coding:"})," Sections colored by program type"]})]})})]})]})})]})},Ej=()=>{const t=an(),r=new URLSearchParams(t.search),e=r.get("eventId"),n=r.get("eventName"),s=r.get("eventDate"),o=r.get("eventLocation"),l=t.state?.event||{id:e||"",name:n||"Current Event",date:s||"",location:o||"",numberOfDays:1},[u,f]=R.useState([]),[m,p]=R.useState(new Date),[v,w]=R.useState(!0),[_,k]=R.useState(null),[b,y]=R.useState(null),[L,G]=R.useState({}),[j,F]=R.useState(null),[ue,D]=R.useState({}),[V,ee]=R.useState("09:00"),[T,O]=R.useState({}),H=ae=>{if(console.log(` calculateStartTime called for index ${ae}:`,{masterStartTime:V,scheduleLength:u.length}),!V)return console.log(" No master start time, returning empty string"),"";let K=0;for(let I=0;I<ae;I++){const le=u[I];if(!le){console.log(`  Item ${I}: undefined/null item, skipping`);continue}const se=le.durationHours||0,z=le.durationMinutes||0,Ie=se*60+z;K+=Ie,console.log(`  Item ${I} (${le.segmentName||"Unknown"}): ${se}h ${z}m = ${Ie} total minutes`)}const[oe,A]=V.split(":").map(Number),N=oe*60+A,B=N+K,q=Math.floor(B/60),ne=B%60,pe=q>=12?"PM":"AM";let te=q;q>12&&(te=q-12),q===0&&(te=12);const fe=`${te}:${ne.toString().padStart(2,"0")} ${pe}`;return console.log(` calculateStartTime result for index ${ae}:`,{masterStartTime:V,totalMinutes:K,totalStartMinutes:N,finalMinutes:B,hours:q,minutes:ne,period:pe,displayHours:te,result:fe}),fe};R.useEffect(()=>{if(l?.id){console.log(" Loading master start time for event ID:",l.id);const ae=localStorage.getItem(`masterStartTime_${l.id}`),K=localStorage.getItem(`dayStartTimes_${l.id}`);if(console.log(" Raw localStorage values:",{masterStartTime:ae,dayStartTimes:K,eventId:l.id}),ae)ee(ae),console.log(" Loaded master start time from localStorage:",ae);else{console.log(" No master start time found in localStorage for event:",l.id),console.log(" Available localStorage keys:",Object.keys(localStorage).filter(B=>B.includes("masterStartTime"))),console.log(" All localStorage keys:",Object.keys(localStorage));const oe=Object.keys(localStorage).filter(B=>B.includes("masterStartTime")).map(B=>({key:B,value:localStorage.getItem(B)}));console.log(" All master start times in localStorage:",oe);let A=null;const N=oe.find(B=>B.value&&B.value!=="09:00");N?(A=N,console.log(" Found non-default master start time:",N.value)):(A=oe.find(B=>B.value),console.log(" Using first available master start time:",A?.value)),A&&A.value?(console.log(" Setting master start time to:",A.value),ee(A.value)):(console.log(" No suitable master start time found in localStorage"),console.log(" Will try to get master start time from Supabase data..."))}K?(O(JSON.parse(K)),console.log(" Loaded day start times from localStorage:",JSON.parse(K))):console.log(" No day start times found in localStorage for event:",l.id)}},[l?.id]),R.useEffect(()=>{const ae=setInterval(()=>{p(new Date)},1e3);return()=>clearInterval(ae)},[]);const U=async()=>{if(l?.id)try{console.log(" Loading active timer for Green Room...");const ae=await qe.getActiveTimer(l.id);ae?(console.log(" Active timer found:",ae),console.log(" Timer state:",ae.timer_state),console.log(" Item ID:",ae.item_id),y(ae.item_id),F(ae.timer_state),D({[ae.item_id]:!0}),console.log(" Set loaded items:",{[ae.item_id]:!0}),G({[ae.item_id]:{elapsed:ae.elapsed_seconds||0,total:ae.duration_seconds||0,startedAt:ae.started_at?new Date(ae.started_at):null}})):(console.log(" No active timer found"),y(null),F(null),D({}),G({}))}catch(ae){console.error(" Error loading active timer:",ae)}};R.useEffect(()=>{if(!l?.id)return;U();const ae=setInterval(U,2e3);return()=>clearInterval(ae)},[l?.id]);const X=async()=>{console.log(" Green Room loadSchedule called"),console.log(" Event object:",l),console.log(" Event ID from URL params:",e),console.log(" Event ID from event object:",l?.id);const ae=l?.id||e;if(!ae){console.log(" No event ID found in event object or URL params"),k("No event selected"),w(!1);return}console.log(" Using event ID:",ae);try{console.log(" Loading schedule for Green Room..."),console.log(" Event details:",{id:ae,name:l.name,location:l.location});const K=await qe.getRunOfShowData(ae);if(console.log(" Raw data received:",K),K&&K.settings&&K.settings.masterStartTime&&V==="09:00"&&(console.log(" Found master start time in Supabase data:",K.settings.masterStartTime),ee(K.settings.masterStartTime)),K?.schedule_items){console.log(" Total schedule items found:",K.schedule_items.length);const A=K.schedule_items.map((N,B)=>{if(!N)return console.log(` Item at index ${B} is null/undefined, skipping`),null;const q=N.durationHours||0,ne=N.durationMinutes||0,pe=N.durationSeconds||0,te=q*60+ne+pe/60,fe=te>0?`${Math.round(te)} min`:"0 min",I=H(B);let le=null;if(console.log(` Calculated start time for ${N.segmentName} (index ${B}):`,{index:B,startTime:I,masterStartTime:V,duration:te,itemDurationHours:N.durationHours,itemDurationMinutes:N.durationMinutes,itemDurationSeconds:N.durationSeconds}),I&&te>0){const se=new Date(`1970-01-01 ${I}`);le=new Date(se.getTime()+te*6e4).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0})}else le="TBD";return{...N,startTime:I,endTime:le,duration:fe,isPublic:N.isPublic||!1}}).filter(N=>N!==null).filter(N=>N&&N.isPublic===!0);console.log(" Public items found after time calculation:",A.length),A.sort((N,B)=>{if(N.startTime&&N.startTime!=="TBD"&&B.startTime&&B.startTime!=="TBD"){const q=new Date(`1970-01-01 ${N.startTime}`),ne=new Date(`1970-01-01 ${B.startTime}`);return q.getTime()-ne.getTime()}return(!N.startTime||N.startTime==="TBD")&&B.startTime&&B.startTime!=="TBD"?1:N.startTime&&N.startTime!=="TBD"&&(!B.startTime||B.startTime==="TBD")?-1:0}),f(A),console.log(" Schedule loaded for Green Room:",A)}else k("No schedule data found")}catch(K){console.error(" Error loading schedule:",K),console.error(" Error details:",{message:K.message,stack:K.stack,eventId:l?.id,eventName:l?.name}),k(`Failed to load schedule data: ${K.message}`)}finally{w(!1)}};R.useEffect(()=>{X()},[l?.id]),R.useEffect(()=>{if(!l?.id)return;console.log(" Starting 20-second schedule polling for Green Room...");const ae=setInterval(()=>{console.log(" Polling for schedule changes (every 20s)..."),X()},2e4);return()=>{console.log(" Clearing 20-second schedule polling for Green Room..."),clearInterval(ae)}},[l?.id]);const ve=(()=>{const ae=b?u.findIndex(A=>String(A.id)===String(b)):-1;console.log(" Modifying schedule visibility:",{totalScheduleItems:u.length,currentIndex:ae,activeItemId:b,activeItemIdType:typeof b,scheduleItemIds:u.map(A=>({id:A.id,idType:typeof A.id,name:A.segmentName})),originalSchedule:u.map(A=>({id:A.id,name:A.segmentName,isPublic:A.isPublic}))});const K=u.map((A,N)=>ae>=0&&N<ae?{...A,isPublic:!1}:A),oe=K.filter(A=>A.isPublic===!0);return console.log(" Modified schedule:",{modifiedSchedule:K.map(A=>({id:A.id,name:A.segmentName,isPublic:A.isPublic})),visibleItems:oe.map(A=>({id:A.id,name:A.segmentName}))}),oe})(),we=()=>{if(!b||!L[b])return"No Timer";const ae=L[b];return ae.startedAt?new Date(ae.startedAt.getTime()+ae.total*1e3).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0}):"Not Started"},Ne=()=>{if(!b||!L[b])return"00:00";const ae=L[b],K=ae.total-ae.elapsed,oe=K<0,A=Math.abs(K),N=Math.floor(A/60),B=Math.floor(A%60),q=`${N.toString().padStart(2,"0")}:${B.toString().padStart(2,"0")}`;return oe?`-${q}`:q},he=()=>{if(!b||!L[b])return!1;const ae=L[b];return ae.total-ae.elapsed<0};return v?c.jsxs("div",{className:"w-full h-screen flex items-center justify-center relative",style:{aspectRatio:"9/16"},children:[c.jsxs("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover",style:{objectFit:"cover"},children:[c.jsx("source",{src:"/pointed_crop_loop.webm",type:"video/webm"}),"Your browser does not support the video tag."]}),c.jsx("div",{className:"text-white text-xl relative z-10 bg-black/50 px-4 py-2 rounded",children:"Loading Green Room..."})]}):_?c.jsxs("div",{className:"w-full h-screen flex items-center justify-center relative",style:{aspectRatio:"9/16"},children:[c.jsxs("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover",style:{objectFit:"cover"},children:[c.jsx("source",{src:"/pointed_crop_loop.webm",type:"video/webm"}),"Your browser does not support the video tag."]}),c.jsx("div",{className:"text-red-400 text-xl relative z-10 bg-black/50 px-4 py-2 rounded",children:_})]}):c.jsxs("div",{className:"w-full h-screen text-white overflow-hidden relative",style:{aspectRatio:"9/16"},children:[c.jsxs("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover",style:{objectFit:"cover"},children:[c.jsx("source",{src:"/pointed_crop_loop.webm",type:"video/webm"}),"Your browser does not support the video tag."]}),c.jsxs("div",{className:"relative z-10",children:[c.jsxs("div",{className:"p-6 flex items-center",children:[c.jsx("div",{className:"text-white font-bold flex-1 text-center",style:{fontSize:"clamp(2rem, 6vw, 4rem)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"1.1",marginRight:"20px"},children:l?.name||"Current Event"}),c.jsxs("div",{className:`rounded-lg p-4 text-center flex-shrink-0 ${he()?"bg-red-800":"bg-red-600"}`,children:[c.jsx("div",{className:"text-white text-lg font-semibold mb-2",children:he()?"OVER TIME":"Stage Timer"}),c.jsx("div",{className:`text-4xl font-bold mb-2 ${he()?"text-red-200":"text-white"}`,children:Ne()}),c.jsxs("div",{className:"text-white text-sm",children:["Expected Finish: ",we()]})]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto p-6 max-h-[calc(100vh-200px)] [&::-webkit-scrollbar]:hidden",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:c.jsx("div",{className:"space-y-4",children:ve.length===0?c.jsx("div",{className:"text-center text-gray-400 text-lg py-12",children:"No public schedule items available"}):c.jsx(c.Fragment,{children:ve.slice(0,8).map((ae,K)=>{const oe=ue[ae.id],A=j==="running"&&String(b)===String(ae.id),N=String(b)===String(ae.id);return console.log(` Item ${ae.id} (${ae.segmentName}):`,{isLoaded:oe,isRunning:A,isActive:N,timerState:j,activeItemId:b,loadedItems:ue}),c.jsxs("div",{className:`p-4 rounded-lg transition-all duration-300 ${oe?A?"bg-red-600 text-white":"bg-green-600 text-white":"bg-gray-300 text-gray-700"}`,children:[c.jsx("div",{className:"font-bold text-xl mb-2 uppercase",children:ae.segmentName}),c.jsxs("div",{className:"text-sm space-y-1",children:[c.jsxs("div",{children:["Start: ",ae.startTime]}),c.jsxs("div",{children:["End: ",ae.endTime]})]})]},ae.id)})})})})]})]})},kj=()=>{const t=an(),r=new URLSearchParams(t.search),e=r.get("eventId"),n=r.get("eventName"),s=r.get("eventDate"),o=r.get("eventLocation"),l=t.state?.event||{id:e||"",name:n||"Current Event",date:s||"",location:o||"",numberOfDays:1},[u,f]=R.useState([]),[m,p]=R.useState(new Date),[v,w]=R.useState(!0),[_,k]=R.useState(null),[b,y]=R.useState(null),[L,G]=R.useState({}),[j,F]=R.useState(null),[ue,D]=R.useState({}),[V,ee]=R.useState("09:00"),[T,O]=R.useState(20),[H,U]=R.useState(!1),[X,ve]=R.useState(!1),[we,Ne]=R.useState({}),[he,ae]=R.useState({}),[K,oe]=R.useState(!0),[A,N]=R.useState(null),B=Ee=>Ee?Ee.includes("CUE ")?Ee:Ee.replace(/^CUE(\d+)$/,"CUE $1"):"CUE",q=(Ee,Le)=>!Ee||Ee.length<=Le?Ee:Ee.substring(0,Le)+"...",ne=Ee=>{if(Ee.trim().length===0)return{html:"",needsSmallText:!1};const Le=Ee.trim(),Me=Le.split(/\s+/);if(Me.length<=1)return{html:Le,needsSmallText:!1};const rt=["Dr","Dr.","Prof","Prof.","Mr","Mr.","Mrs","Mrs.","Ms","Ms.","Hon","Hon.","Honorable","Sen","Sen.","Senator","Rep","Rep.","Representative","Gov","Gov.","Governor","Mayor","Judge","Ambassador","Amb","Amb.","General","Gen","Gen.","Admiral","Adm","Adm.","Colonel","Col","Col.","Major","Maj","Maj.","Captain","Capt","Capt.","Lieutenant","Lt","Lt.","Sergeant","Sgt","Sgt.","Chief","Commander","Comm"],Nt=["Jr","Jr.","Sr","Sr.","III","IV","V","Ph.D","PhD","MD","DDS","DVM","Esq","Esq.","CPA","PE","RN","LPN"];let wt="",ft="",Wt="",Dt="",Ft="";rt.includes(Me[0])&&(wt=Me[0],Me.shift());const xt=Le.match(/\([DR]\)/i);if(xt){Ft=xt[0];const kt=Me.findIndex(dr=>dr.match(/\([DR]\)/i));kt!==-1&&Me.splice(kt,1)}if(Me.length>0&&Nt.includes(Me[Me.length-1])&&(Dt=Me[Me.length-1],Me.pop()),Me.length===0)return{html:Le,needsSmallText:!1};if(Me.length===1)ft=Me[0];else{const kt=Me.length-1;Wt=Me[kt],ft=Me.slice(0,kt).join(" ")}const Et=12;let Ze=[wt,ft].filter(Boolean).join(" "),bt=[Wt,Dt,Ft].filter(Boolean).join(" ");if(Ze.length>Et&&ft.includes(" ")){const kt=ft.split(" ");if(kt.length>1){const dr=kt.pop(),$r=kt.join(" ");Ze=[wt,$r].filter(Boolean).join(" "),bt=[dr,Wt,Dt,Ft].filter(Boolean).join(" ")}}if(Ze.length>Et&&ft.includes(" ")){const kt=ft.split(" ");if(kt.length>2){const dr=kt.splice(-2),$r=kt.join(" ");Ze=[wt,$r].filter(Boolean).join(" "),bt=[dr.join(" "),Wt,Dt,Ft].filter(Boolean).join(" ")}}const ur=Ze.length>Et||bt.length>Et;return{html:`${Ze}<br/>${bt}`,needsSmallText:ur}},pe=Ee=>{if(isNaN(Ee)||Ee===void 0||Ee===null)return console.warn(" formatTime received invalid value:",Ee),"00:00:00";const Le=Ee<0,Me=Math.abs(Ee),rt=Math.floor(Me/3600),Nt=Math.floor(Me%3600/60),wt=Math.floor(Me%60);return`${Le?"-":""}${rt.toString().padStart(2,"0")}:${Nt.toString().padStart(2,"0")}:${wt.toString().padStart(2,"0")}`},te=()=>{const Ee=Object.keys(he);if(Ee.length>0){const Le=parseInt(Ee[0]);if(L[Le]){const Me=L[Le];return Me.total-Me.elapsed}}if(b&&L[b]){const Le=L[b];return Le.total-Le.elapsed}return 0},fe=()=>{const Ee=Object.keys(he);if(Ee.length>0){const Le=parseInt(Ee[0]);if(L[Le]){const Me=L[Le],rt=Me.total-Me.elapsed;return Me.total>0?rt/Me.total*100:0}}if(b&&L[b]){const Le=L[b],Me=Le.total-Le.elapsed;return Le.total>0?Me/Le.total*100:0}return 0},I=()=>{const Ee=Object.keys(he);if(Ee.length>0){const Le=parseInt(Ee[0]);if(L[Le]){const Me=L[Le],rt=Me.total-Me.elapsed;return rt>120?"#10b981":rt>30?"#f59e0b":"#ef4444"}}if(b&&L[b]){const Le=L[b],Me=Le.total-Le.elapsed;return Me>120?"#10b981":Me>30?"#f59e0b":"#ef4444"}return"#10b981"},le=()=>{const Ee=Object.keys(he);if(Ee.length>0){const Le=parseInt(Ee[0]);if(L[Le]){const Me=L[Le],rt=Me.total-Me.elapsed;return rt>120?"#10b981":rt>30?"#f59e0b":"#ef4444"}}if(b&&L[b]){const Le=L[b],Me=Le.total-Le.elapsed;return Me>120?"#10b981":Me>30?"#f59e0b":"#ef4444"}return"#10b981"};console.log(" PhotoView Status Debug:",{activeTimersKeys:Object.keys(he),activeTimers:he,activeItemId:b,timerProgress:b?L[b]:null,scheduleLength:u.length,runningItem:Object.keys(he).length>0?u.find(Ee=>he[Ee.id]):null,loadedItem:b?u.find(Ee=>Ee.id===b):null,loadedItemCue:b?u.find(Ee=>Ee.id===b)?.customFields?.cue:null,allItemsCues:u.map(Ee=>({id:Ee.id,cue:Ee.customFields?.cue})),secondaryTimer:A,secondaryTimerActive:A?.isActive,secondaryTimerCue:A?.cue});const se=Ee=>{if(isNaN(Ee)||Ee===void 0||Ee===null)return"00:00";const Le=Ee<0,Me=Math.abs(Ee),rt=Math.floor(Me/3600),Nt=Math.floor(Me%3600/60),wt=Me%60,ft=Le?"-":"";return rt>0?`${ft}${rt.toString().padStart(2,"0")}:${Nt.toString().padStart(2,"0")}:${wt.toString().padStart(2,"0")}`:`${ft}${Nt.toString().padStart(2,"0")}:${wt.toString().padStart(2,"0")}`},z=Ee=>{if(!V)return"";let Le=0;for(let Et=0;Et<Ee;Et++){const Ze=u[Et],bt=Ze.durationHours*60+Ze.durationMinutes;Le+=bt}const[Me,rt]=V.split(":").map(Number),wt=Me*60+rt+Le,ft=Math.floor(wt/60),Wt=wt%60,Dt=ft>=12?"PM":"AM";let Ft=ft;return ft>12&&(Ft=ft-12),ft===0&&(Ft=12),`${Ft}:${Wt.toString().padStart(2,"0")} ${Dt}`};R.useEffect(()=>{if(l?.id){const Ee=localStorage.getItem(`masterStartTime_${l.id}`);Ee&&ee(Ee)}},[l?.id]),R.useEffect(()=>{const Ee=setInterval(()=>{p(new Date)},1e3);return()=>clearInterval(Ee)},[]),R.useEffect(()=>{if(X||H)return;const Ee=setInterval(()=>{O(Le=>Le<=1?(U(!0),setTimeout(()=>{U(!1),O(20)},3e3),0):Le-1)},1e3);return()=>clearInterval(Ee)},[X,H]);const Ie=async()=>{if(l?.id){console.log(" Polling for sub-cue timer...");try{const{data:Ee}=await qe.hasActiveSubCueTimer(l.id);if(!Ee){console.log(" No active sub-cue timer found, clearing local state"),N(null);return}const{data:Le,error:Me}=await qe.getActiveSubCueTimer(l.id);if(console.log(" Sub-cue timer data from Supabase:",Le),Me){console.error(" Error loading sub-cue timer:",Me);return}if(Le&&Le.is_active&&Le.is_running){console.log(" Sub-cue timer loaded:",Le.item_id,"Duration:",Le.duration_seconds,"s","Active:",Le.is_active,"Running:",Le.is_running);const rt=parseInt(Le.item_id),Nt=new Date(Le.started_at),ft=Math.floor((new Date().getTime()-Nt.getTime())/1e3),Wt=Math.max(0,Le.duration_seconds-ft),Dt=u.find(Ft=>Ft.id===rt);N({itemId:rt,remaining:Wt,duration:Le.duration_seconds,isActive:!0,startedAt:Nt,timerState:"running",cue:Dt?.customFields?.cue||"CUE",segmentName:Dt?.segmentName||""}),console.log(" Set secondaryTimer state for PhotoView:",{itemId:rt,remaining:Wt,duration:Le.duration_seconds,cue:Dt?.customFields?.cue||"CUE",segmentName:Dt?.segmentName||""})}else console.log(" Sub-cue timer found but not active or not running, clearing local state"),N(null)}catch(Ee){console.error(" Error loading sub-cue timer:",Ee),N(null)}}},Fe=async()=>{if(l?.id)try{console.log(" Loading active timer for PhotoView...");const Ee=await qe.getActiveTimer(l.id);if(Ee){console.log(" Active timer found:",Ee),console.log(" Timer state:",Ee.timer_state),console.log(" Item ID:",Ee.item_id),y(parseInt(Ee.item_id)),F(Ee.timer_state),D({[parseInt(Ee.item_id)]:!0}),Ee.timer_state==="running"?ae({[parseInt(Ee.item_id)]:!0}):ae({});const Le=Ee.elapsed_seconds||0,Me=Ee.started_at?new Date(Ee.started_at):null;G({[parseInt(Ee.item_id)]:{elapsed:Le,total:Ee.duration_seconds||0,startedAt:Me}})}else console.log(" No active timer found"),y(null),F(null),D({}),G({}),ae({}),N(null),Ne({})}catch(Ee){console.error(" Error loading active timer:",Ee)}};R.useEffect(()=>{if(!l?.id)return;Fe();const Ee=setInterval(Fe,1e3);return()=>clearInterval(Ee)},[l?.id]),R.useEffect(()=>{if(!l?.id)return;const Ee=async()=>{try{await Ie()}catch(Me){console.warn(" Error syncing sub-cue timers:",Me)}};Ee();const Le=setInterval(Ee,1e3);return()=>clearInterval(Le)},[l?.id,u]),R.useEffect(()=>{if(!A)return;const Ee=setInterval(()=>{N(Le=>{if(!Le)return null;const Me=Le.startedAt?.getTime()||Date.now(),rt=Math.floor((Date.now()-Me)/1e3),Nt=Math.max(0,Le.duration-rt);return{...Le,remaining:Nt}})},1e3);return()=>clearInterval(Ee)},[A]),R.useEffect(()=>{(async()=>{if(console.log("=== PHOTO VIEW PAGE INITIALIZATION ==="),!l?.id&&!e){k("No event selected"),w(!1);return}try{if(l?.id||e){console.log(" Loading from Supabase for event:",l?.id||e);const Me=await qe.getRunOfShowData(l?.id||e);if(Me?.schedule_items){console.log(" Loaded from Supabase:",Me);const rt=Me.schedule_items.map(Nt=>({...Nt,isPublic:Nt.isPublic||!1}));f(rt),w(!1);return}}console.log(" Falling back to localStorage...");let Le=null;if(l?.id||e){const Me=`runOfShowSchedule_${l?.id||e}`;Le=localStorage.getItem(Me)}if(!Le){const rt=Object.keys(localStorage).filter(Nt=>Nt.startsWith("runOfShowSchedule_"));if(rt.length>0){const Nt=rt[rt.length-1];Le=localStorage.getItem(Nt)}}if(Le){const Me=JSON.parse(Le);console.log(" Loaded from localStorage:",Me),f(Me)}else console.log(" No schedule data found, creating sample data for testing"),f([{id:1,day:1,programType:"PreShow/End",shotType:"Wide",segmentName:"Welcome & Opening",durationHours:0,durationMinutes:5,durationSeconds:0,notes:"Welcome everyone to the event",assets:"",speakers:"",speakersText:"",hasPPT:!0,hasQA:!1,timerId:"",customFields:{cue:"CUE1"},isPublic:!0},{id:2,day:1,programType:"Podium Transition",shotType:"Medium",segmentName:"Keynote Speaker",durationHours:0,durationMinutes:15,durationSeconds:0,notes:"Main keynote presentation",assets:"",speakers:"",speakersText:"",hasPPT:!0,hasQA:!0,timerId:"",customFields:{cue:"CUE2"},isPublic:!0},{id:3,day:1,programType:"Panel Transition",shotType:"Two Shot",segmentName:"Panel Discussion",durationHours:0,durationMinutes:30,durationSeconds:0,notes:"Interactive panel discussion",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!0,timerId:"",customFields:{cue:"CUE3"},isPublic:!0}]),console.log(" Using sample data for testing")}catch(Le){console.error(" Error loading schedule:",Le),k("Failed to load schedule data")}finally{w(!1)}})()},[l?.id,e]);const tt=(()=>{if(console.log(" getPreviewItems called"),console.log("Schedule length:",u.length),console.log("Active item ID:",b),console.log("Active item ID type:",typeof b),u.length===0)return console.log("No schedule items available"),[];const Ee=b?u.findIndex(rt=>String(rt.id)===String(b)):-1;if(console.log("Current index:",Ee),Ee===-1)return console.log("No active item or not found, showing first 3 items"),u.slice(0,3);const Le=Math.min(Ee+3,u.length),Me=u.slice(Ee,Le);return console.log("Showing items from index",Ee,"to",Le-1,":",Me.length,"items"),console.log("Items:",Me.map(rt=>({id:rt.id,name:rt.segmentName}))),Me})();console.log("Preview items:",tt);const Ve={"Podium Transition":"#8B4513","Panel Transition":"#404040","Sub Cue":"#F3F4F6","No Transition":"#059669",Video:"#F59E0B","Panel+Remote":"#1E40AF","Remote Only":"#60A5FA",Break:"#EC4899",TBD:"#6B7280",KILLED:"#DC2626",Podium:"#8B4513",Panel:"#404040","PreShow/End":"#8B5CF6"};return v?c.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:c.jsx("div",{className:"text-white text-xl",children:"Loading PhotoView..."})}):_?c.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:c.jsx("div",{className:"text-red-400 text-xl",children:_})}):c.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-6",children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex justify-between items-start mb-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold",children:l?.name||"Current Event"}),c.jsx("div",{className:"text-sm text-gray-300 mt-1",children:m.toLocaleTimeString()}),c.jsx("button",{onClick:()=>oe(!K),className:`mt-2 px-2 py-1 text-xs rounded border transition-colors ${K?"bg-blue-600 border-blue-500 text-white":"bg-slate-700 border-slate-600 text-gray-300 hover:bg-slate-600"}`,children:K?"Hide Notes":"Show Notes"})]}),c.jsxs("div",{className:"flex items-center space-x-6",children:[c.jsx("div",{className:"text-center",children:Object.keys(he).length>0?c.jsxs("div",{className:"text-lg text-green-400 font-bold",children:["RUNNING - ",B(u.find(Ee=>he[Ee.id])?.customFields.cue),A&&A.isActive&&c.jsxs("div",{className:"text-lg text-orange-400 mt-0.5 font-bold",children:[B(A.cue)," - ",se(A.remaining)]})]}):b&&L[b]?c.jsxs("div",{className:"text-lg text-yellow-400 font-bold",children:["LOADED - ",B(u.find(Ee=>Ee.id===b)?.customFields.cue)]}):c.jsx("div",{className:"text-lg text-slate-300 font-bold",children:"No CUE Selected"})}),c.jsx("div",{className:"relative",children:c.jsx("div",{className:"text-3xl font-mono bg-slate-800 px-6 py-3 rounded-lg border border-slate-600",style:{color:le()},children:pe(te())})})]})]}),b&&L[b]&&c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border border-slate-600 relative h-2",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${fe()}%`,background:I()}})})]}),c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsx("div",{className:"bg-slate-700 border border-slate-600",children:c.jsxs("div",{className:"grid grid-cols-11 gap-0",children:[c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"CUE"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"TIME"}),c.jsx("div",{className:"col-span-2 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SEGMENT INFO"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 1"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 2"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 3"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 4"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 5"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 6"}),c.jsx("div",{className:"col-span-1 bg-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 7"})]})}),tt.length===0?c.jsx("div",{className:"text-center text-gray-400 text-xl py-12 bg-slate-800 border border-slate-600 border-t-0",children:"No schedule items available"}):tt.map((Ee,Le)=>{const Me=String(b)===String(Ee.id);ue[Ee.id];const rt=j==="running"&&Me,Nt=Ee.isIndented||!1,wt=u.findIndex(xt=>xt.id===Ee.id),ft=z(wt),Wt=`${Ee.durationHours.toString().padStart(2,"0")}:${Ee.durationMinutes.toString().padStart(2,"0")}:${Ee.durationSeconds.toString().padStart(2,"0")}`,Dt=[];Ee.hasPPT&&Dt.push("PPT"),Ee.hasQA&&Dt.push("Q&A");const Ft=Dt.length>0?Dt.join("/"):"None";return c.jsxs("div",{className:`${Nt?"border-4 border-orange-400":Me?rt?"border-4 border-green-400":"border-4 border-blue-400":"border border-slate-600"}`,children:[c.jsxs("div",{className:`grid grid-cols-11 gap-0 ${Nt?"bg-amber-950":Me?rt?"bg-green-950":"bg-blue-950":"bg-slate-900"}`,style:{minHeight:"200px"},children:[c.jsx("div",{className:"col-span-1 border-r border-slate-600 p-3 flex flex-col justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-lg font-bold mb-3 text-white",children:Ee.customFields?.cue||`CUE ${wt+1}`}),c.jsx("div",{className:"inline-block px-2 py-1 rounded text-xs font-medium text-white border shadow-lg",style:{backgroundColor:Ve[Ee.programType]||"#6B7280",color:Ee.programType==="Sub Cue"?"black":"white",borderColor:Ee.programType==="Sub Cue"?"black":"transparent"},children:Ee.programType||"Unknown"})]})}),c.jsx("div",{className:"col-span-1 border-r border-slate-600 p-3 flex flex-col justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"START TIME"}),c.jsx("div",{className:"text-lg font-bold text-white",children:ft||"No Time"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"DURATION"}),c.jsx("div",{className:"text-base font-bold text-white",children:Wt})]})]})}),c.jsx("div",{className:"col-span-2 border-r border-slate-600 p-3 flex flex-col justify-center",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"SEGMENT NAME"}),c.jsx("div",{className:"text-lg font-bold text-white",children:Ee.segmentName||"Untitled Segment"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"SHOT TYPE"}),c.jsx("div",{className:"text-sm font-bold text-white",children:Ee.shotType||"Not specified"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"PPT/Q&A"}),c.jsx("div",{className:"text-sm font-bold text-white",children:Ft})]})]})}),[1,2,3,4,5,6,7].map(xt=>{let Et=null;if(Ee.speakersText)try{const Ze=JSON.parse(Ee.speakersText);Array.isArray(Ze)&&(Et=Ze.find(bt=>bt.slot===xt))}catch(Ze){console.log("Error parsing speakers:",Ze)}return c.jsx("div",{className:`col-span-1 ${xt<7?"border-r border-slate-600":""} p-3 flex flex-col justify-center`,children:Et?c.jsxs("div",{className:"text-center h-full flex flex-col justify-center",children:[Et.photoLink&&c.jsx("div",{className:"mb-3 flex justify-center",children:c.jsx("img",{src:Et.photoLink,alt:Et.fullName,className:"w-24 h-32 rounded-lg object-cover border-2 border-slate-400 shadow-lg",style:{objectFit:"cover",objectPosition:"center top"},onError:Ze=>{Ze.currentTarget.style.display="none"}})}),(()=>{const Ze=ne(Et.fullName||"Unnamed");return c.jsx("div",{className:`font-bold text-white mb-2 leading-tight ${Ze.needsSmallText?"text-sm":"text-base"}`,dangerouslySetInnerHTML:{__html:Ze.html}})})(),(Et.title||Et.org)&&c.jsx("div",{className:"text-xs text-gray-300 mb-1 leading-tight",children:(()=>{const Ze=Et.title||"",bt=Et.org||"",ur=Ze&&bt?`${Ze}, ${bt}`:Ze||bt;return q(ur,20)})()}),c.jsx("div",{className:"text-xs text-gray-300 font-medium bg-slate-700 px-2 py-1 rounded",children:Et.location==="Podium"?"Podium":Et.location==="Seat"?"Seat":Et.location==="Virtual"?"Virtual":Et.location==="Moderator"?"Moderator":Et.location||"Unknown"})]}):c.jsx("div",{className:"text-center text-xs text-gray-500 h-full flex items-center justify-center",children:c.jsx("div",{className:"text-gray-600",children:"Empty"})})},xt)})]}),K&&(()=>{const xt=Ee.notes?Ee.notes.replace(/<[^>]*>/g,"").trim():"";return console.log("Notes debug for item:",{hasNotes:!!Ee.notes,notesValue:Ee.notes,cleanNotes:xt,cleanLength:xt.length,willShow:xt&&xt.length>0}),xt&&xt.length>0&&xt!=="None"&&xt!=="null"&&xt!=="undefined"})()&&c.jsxs("div",{className:`border-t border-slate-600 p-4 ${Nt?"bg-amber-950":Me?rt?"bg-green-950":"bg-blue-950":"bg-slate-800"}`,children:[c.jsx("div",{className:"text-gray-400 text-sm mb-2 font-bold",children:"NOTES:"}),c.jsx("div",{className:"text-sm text-white break-words leading-relaxed",style:{whiteSpace:"pre-line"},dangerouslySetInnerHTML:{__html:Ee.notes.replace(/\n/g,"<br>").replace(/\r\n/g,"<br>").replace(/\r/g,"<br>").replace(/<(?!\/?(?:br|b|strong|i|em|u|font|span|div|p|h[1-6])\b)[^>]*>/g,"")}})]}),Le<tt.length-1&&c.jsx("div",{className:"border-t-2 border-slate-500"})]},Ee.id)})]})]})};function Tj(){const t=an(),r=t.pathname==="/fullscreen-timer",e=t.pathname==="/clock",n=t.pathname==="/green-room",s=t.pathname==="/photo-view";return c.jsxs("div",{className:`App ${e?"clock-page":""}`,children:[!r&&!n&&!s&&c.jsx(Xf,{}),c.jsx(iS,{children:c.jsxs(Mg,{children:[c.jsx(ts,{path:"/",element:c.jsx(oS,{})}),c.jsx(ts,{path:"/run-of-show",element:c.jsx(mj,{})}),c.jsx(ts,{path:"/fullscreen-timer",element:c.jsx(pj,{})}),c.jsx(ts,{path:"/graphics-links",element:c.jsx(_j,{})}),c.jsx(ts,{path:"/reports",element:c.jsx(Sj,{})}),c.jsx(ts,{path:"/green-room",element:c.jsx(Ej,{})}),c.jsx(ts,{path:"/photo-view",element:c.jsx(kj,{})})]})}),c.jsxs(Mg,{children:[c.jsx(ts,{path:"/clock",element:c.jsx(vj,{})}),c.jsx(ts,{path:"/lower-thirds-xml",element:c.jsx(yj,{})}),c.jsx(ts,{path:"/schedule-xml",element:c.jsx(wj,{})}),c.jsx(ts,{path:"/custom-columns-xml",element:c.jsx(bj,{})})]})]})}function Nj(){return c.jsx(nS,{children:c.jsx(Ww,{children:c.jsx(Tj,{})})})}const Cj=Ay.createRoot(document.getElementById("root"));Cj.render(c.jsx(ad.StrictMode,{children:c.jsx(Nj,{})}));
