(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();function Jf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function my(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var r=t.default;if(typeof r=="function"){var e=function n(){var s=!1;try{s=this instanceof n}catch{}return s?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};e.prototype=r.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),e}var ef={exports:{}},Wl={},tf={exports:{}},pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vg;function gy(){if(vg)return pt;vg=1;var t=Symbol.for("react.element"),r=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function y(A){return A===null||typeof A!="object"?null:(A=v&&A[v]||A["@@iterator"],typeof A=="function"?A:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,w={};function E(A,N,L){this.props=A,this.context=N,this.refs=w,this.updater=L||S}E.prototype.isReactComponent={},E.prototype.setState=function(A,N){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,N,"setState")},E.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function F(){}F.prototype=E.prototype;function B(A,N,L){this.props=A,this.context=N,this.refs=w,this.updater=L||S}var C=B.prototype=new F;C.constructor=B,k(C,E.prototype),C.isPureReactComponent=!0;var M=Array.isArray,re=Object.prototype.hasOwnProperty,O={current:null},U={key:!0,ref:!0,__self:!0,__source:!0};function ee(A,N,L){var V,q={},ce=null,J=null;if(N!=null)for(V in N.ref!==void 0&&(J=N.ref),N.key!==void 0&&(ce=""+N.key),N)re.call(N,V)&&!U.hasOwnProperty(V)&&(q[V]=N[V]);var he=arguments.length-2;if(he===1)q.children=L;else if(1<he){for(var Y=Array(he),xe=0;xe<he;xe++)Y[xe]=arguments[xe+2];q.children=Y}if(A&&A.defaultProps)for(V in he=A.defaultProps,he)q[V]===void 0&&(q[V]=he[V]);return{$$typeof:t,type:A,key:ce,ref:J,props:q,_owner:O.current}}function I(A,N){return{$$typeof:t,type:A.type,key:N,ref:A.ref,props:A.props,_owner:A._owner}}function ie(A){return typeof A=="object"&&A!==null&&A.$$typeof===t}function oe(A){var N={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(L){return N[L]})}var X=/\/+/g;function ae(A,N){return typeof A=="object"&&A!==null&&A.key!=null?oe(""+A.key):N.toString(36)}function fe(A,N,L,V,q){var ce=typeof A;(ce==="undefined"||ce==="boolean")&&(A=null);var J=!1;if(A===null)J=!0;else switch(ce){case"string":case"number":J=!0;break;case"object":switch(A.$$typeof){case t:case r:J=!0}}if(J)return J=A,q=q(J),A=V===""?"."+ae(J,0):V,M(q)?(L="",A!=null&&(L=A.replace(X,"$&/")+"/"),fe(q,N,L,"",function(xe){return xe})):q!=null&&(ie(q)&&(q=I(q,L+(!q.key||J&&J.key===q.key?"":(""+q.key).replace(X,"$&/")+"/")+A)),N.push(q)),1;if(J=0,V=V===""?".":V+":",M(A))for(var he=0;he<A.length;he++){ce=A[he];var Y=V+ae(ce,he);J+=fe(ce,N,L,Y,q)}else if(Y=y(A),typeof Y=="function")for(A=Y.call(A),he=0;!(ce=A.next()).done;)ce=ce.value,Y=V+ae(ce,he++),J+=fe(ce,N,L,Y,q);else if(ce==="object")throw N=String(A),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.");return J}function me(A,N,L){if(A==null)return A;var V=[],q=0;return fe(A,V,"","",function(ce){return N.call(L,ce,q++)}),V}function Te(A){if(A._status===-1){var N=A._result;N=N(),N.then(function(L){(A._status===0||A._status===-1)&&(A._status=1,A._result=L)},function(L){(A._status===0||A._status===-1)&&(A._status=2,A._result=L)}),A._status===-1&&(A._status=0,A._result=N)}if(A._status===1)return A._result.default;throw A._result}var be={current:null},le={transition:null},te={ReactCurrentDispatcher:be,ReactCurrentBatchConfig:le,ReactCurrentOwner:O};function pe(){throw Error("act(...) is not supported in production builds of React.")}return pt.Children={map:me,forEach:function(A,N,L){me(A,function(){N.apply(this,arguments)},L)},count:function(A){var N=0;return me(A,function(){N++}),N},toArray:function(A){return me(A,function(N){return N})||[]},only:function(A){if(!ie(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},pt.Component=E,pt.Fragment=e,pt.Profiler=s,pt.PureComponent=B,pt.StrictMode=n,pt.Suspense=f,pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=te,pt.act=pe,pt.cloneElement=function(A,N,L){if(A==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+A+".");var V=k({},A.props),q=A.key,ce=A.ref,J=A._owner;if(N!=null){if(N.ref!==void 0&&(ce=N.ref,J=O.current),N.key!==void 0&&(q=""+N.key),A.type&&A.type.defaultProps)var he=A.type.defaultProps;for(Y in N)re.call(N,Y)&&!U.hasOwnProperty(Y)&&(V[Y]=N[Y]===void 0&&he!==void 0?he[Y]:N[Y])}var Y=arguments.length-2;if(Y===1)V.children=L;else if(1<Y){he=Array(Y);for(var xe=0;xe<Y;xe++)he[xe]=arguments[xe+2];V.children=he}return{$$typeof:t,type:A.type,key:q,ref:ce,props:V,_owner:J}},pt.createContext=function(A){return A={$$typeof:l,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},A.Provider={$$typeof:o,_context:A},A.Consumer=A},pt.createElement=ee,pt.createFactory=function(A){var N=ee.bind(null,A);return N.type=A,N},pt.createRef=function(){return{current:null}},pt.forwardRef=function(A){return{$$typeof:u,render:A}},pt.isValidElement=ie,pt.lazy=function(A){return{$$typeof:p,_payload:{_status:-1,_result:A},_init:Te}},pt.memo=function(A,N){return{$$typeof:m,type:A,compare:N===void 0?null:N}},pt.startTransition=function(A){var N=le.transition;le.transition={};try{A()}finally{le.transition=N}},pt.unstable_act=pe,pt.useCallback=function(A,N){return be.current.useCallback(A,N)},pt.useContext=function(A){return be.current.useContext(A)},pt.useDebugValue=function(){},pt.useDeferredValue=function(A){return be.current.useDeferredValue(A)},pt.useEffect=function(A,N){return be.current.useEffect(A,N)},pt.useId=function(){return be.current.useId()},pt.useImperativeHandle=function(A,N,L){return be.current.useImperativeHandle(A,N,L)},pt.useInsertionEffect=function(A,N){return be.current.useInsertionEffect(A,N)},pt.useLayoutEffect=function(A,N){return be.current.useLayoutEffect(A,N)},pt.useMemo=function(A,N){return be.current.useMemo(A,N)},pt.useReducer=function(A,N,L){return be.current.useReducer(A,N,L)},pt.useRef=function(A){return be.current.useRef(A)},pt.useState=function(A){return be.current.useState(A)},pt.useSyncExternalStore=function(A,N,L){return be.current.useSyncExternalStore(A,N,L)},pt.useTransition=function(){return be.current.useTransition()},pt.version="18.3.1",pt}var yg;function Yf(){return yg||(yg=1,tf.exports=gy()),tf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wg;function py(){if(wg)return Wl;wg=1;var t=Yf(),r=Symbol.for("react.element"),e=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(u,f,m){var p,v={},y=null,S=null;m!==void 0&&(y=""+m),f.key!==void 0&&(y=""+f.key),f.ref!==void 0&&(S=f.ref);for(p in f)n.call(f,p)&&!o.hasOwnProperty(p)&&(v[p]=f[p]);if(u&&u.defaultProps)for(p in f=u.defaultProps,f)v[p]===void 0&&(v[p]=f[p]);return{$$typeof:r,type:u,key:y,ref:S,props:v,_owner:s.current}}return Wl.Fragment=e,Wl.jsx=l,Wl.jsxs=l,Wl}var bg;function xy(){return bg||(bg=1,ef.exports=py()),ef.exports}var c=xy(),j=Yf();const ed=Jf(j);var Du={},rf={exports:{}},In={},nf={exports:{}},sf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _g;function vy(){return _g||(_g=1,(function(t){function r(le,te){var pe=le.length;le.push(te);e:for(;0<pe;){var A=pe-1>>>1,N=le[A];if(0<s(N,te))le[A]=te,le[pe]=N,pe=A;else break e}}function e(le){return le.length===0?null:le[0]}function n(le){if(le.length===0)return null;var te=le[0],pe=le.pop();if(pe!==te){le[0]=pe;e:for(var A=0,N=le.length,L=N>>>1;A<L;){var V=2*(A+1)-1,q=le[V],ce=V+1,J=le[ce];if(0>s(q,pe))ce<N&&0>s(J,q)?(le[A]=J,le[ce]=pe,A=ce):(le[A]=q,le[V]=pe,A=V);else if(ce<N&&0>s(J,pe))le[A]=J,le[ce]=pe,A=ce;else break e}}return te}function s(le,te){var pe=le.sortIndex-te.sortIndex;return pe!==0?pe:le.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var f=[],m=[],p=1,v=null,y=3,S=!1,k=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(le){for(var te=e(m);te!==null;){if(te.callback===null)n(m);else if(te.startTime<=le)n(m),te.sortIndex=te.expirationTime,r(f,te);else break;te=e(m)}}function M(le){if(w=!1,C(le),!k)if(e(f)!==null)k=!0,Te(re);else{var te=e(m);te!==null&&be(M,te.startTime-le)}}function re(le,te){k=!1,w&&(w=!1,F(ee),ee=-1),S=!0;var pe=y;try{for(C(te),v=e(f);v!==null&&(!(v.expirationTime>te)||le&&!oe());){var A=v.callback;if(typeof A=="function"){v.callback=null,y=v.priorityLevel;var N=A(v.expirationTime<=te);te=t.unstable_now(),typeof N=="function"?v.callback=N:v===e(f)&&n(f),C(te)}else n(f);v=e(f)}if(v!==null)var L=!0;else{var V=e(m);V!==null&&be(M,V.startTime-te),L=!1}return L}finally{v=null,y=pe,S=!1}}var O=!1,U=null,ee=-1,I=5,ie=-1;function oe(){return!(t.unstable_now()-ie<I)}function X(){if(U!==null){var le=t.unstable_now();ie=le;var te=!0;try{te=U(!0,le)}finally{te?ae():(O=!1,U=null)}}else O=!1}var ae;if(typeof B=="function")ae=function(){B(X)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,me=fe.port2;fe.port1.onmessage=X,ae=function(){me.postMessage(null)}}else ae=function(){E(X,0)};function Te(le){U=le,O||(O=!0,ae())}function be(le,te){ee=E(function(){le(t.unstable_now())},te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(le){le.callback=null},t.unstable_continueExecution=function(){k||S||(k=!0,Te(re))},t.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<le?Math.floor(1e3/le):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return e(f)},t.unstable_next=function(le){switch(y){case 1:case 2:case 3:var te=3;break;default:te=y}var pe=y;y=te;try{return le()}finally{y=pe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(le,te){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var pe=y;y=le;try{return te()}finally{y=pe}},t.unstable_scheduleCallback=function(le,te,pe){var A=t.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?A+pe:A):pe=A,le){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=pe+N,le={id:p++,callback:te,priorityLevel:le,startTime:pe,expirationTime:N,sortIndex:-1},pe>A?(le.sortIndex=pe,r(m,le),e(f)===null&&le===e(m)&&(w?(F(ee),ee=-1):w=!0,be(M,pe-A))):(le.sortIndex=N,r(f,le),k||S||(k=!0,Te(re))),le},t.unstable_shouldYield=oe,t.unstable_wrapCallback=function(le){var te=y;return function(){var pe=y;y=te;try{return le.apply(this,arguments)}finally{y=pe}}}})(sf)),sf}var Sg;function yy(){return Sg||(Sg=1,nf.exports=vy()),nf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eg;function wy(){if(Eg)return In;Eg=1;var t=Yf(),r=yy();function e(a){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)i+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function o(a,i){l(a,i),l(a+"Capture",i)}function l(a,i){for(s[a]=i,a=0;a<i.length;a++)n.add(i[a])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},v={};function y(a){return f.call(v,a)?!0:f.call(p,a)?!1:m.test(a)?v[a]=!0:(p[a]=!0,!1)}function S(a,i,d,g){if(d!==null&&d.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return g?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function k(a,i,d,g){if(i===null||typeof i>"u"||S(a,i,d,g))return!0;if(g)return!1;if(d!==null)switch(d.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function w(a,i,d,g,x,b,D){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=g,this.attributeNamespace=x,this.mustUseProperty=d,this.propertyName=a,this.type=i,this.sanitizeURL=b,this.removeEmptyString=D}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){E[a]=new w(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var i=a[0];E[i]=new w(i,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){E[a]=new w(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){E[a]=new w(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){E[a]=new w(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){E[a]=new w(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){E[a]=new w(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){E[a]=new w(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){E[a]=new w(a,5,!1,a.toLowerCase(),null,!1,!1)});var F=/[\-:]([a-z])/g;function B(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var i=a.replace(F,B);E[i]=new w(i,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var i=a.replace(F,B);E[i]=new w(i,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var i=a.replace(F,B);E[i]=new w(i,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){E[a]=new w(a,1,!1,a.toLowerCase(),null,!1,!1)}),E.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){E[a]=new w(a,1,!1,a.toLowerCase(),null,!0,!0)});function C(a,i,d,g){var x=E.hasOwnProperty(i)?E[i]:null;(x!==null?x.type!==0:g||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(k(i,d,x,g)&&(d=null),g||x===null?y(i)&&(d===null?a.removeAttribute(i):a.setAttribute(i,""+d)):x.mustUseProperty?a[x.propertyName]=d===null?x.type===3?!1:"":d:(i=x.attributeName,g=x.attributeNamespace,d===null?a.removeAttribute(i):(x=x.type,d=x===3||x===4&&d===!0?"":""+d,g?a.setAttributeNS(g,i,d):a.setAttribute(i,d))))}var M=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,re=Symbol.for("react.element"),O=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),ee=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),ie=Symbol.for("react.provider"),oe=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),fe=Symbol.for("react.suspense_list"),me=Symbol.for("react.memo"),Te=Symbol.for("react.lazy"),be=Symbol.for("react.offscreen"),le=Symbol.iterator;function te(a){return a===null||typeof a!="object"?null:(a=le&&a[le]||a["@@iterator"],typeof a=="function"?a:null)}var pe=Object.assign,A;function N(a){if(A===void 0)try{throw Error()}catch(d){var i=d.stack.trim().match(/\n( *(at )?)/);A=i&&i[1]||""}return`
`+A+a}var L=!1;function V(a,i){if(!a||L)return"";L=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(Ce){var g=Ce}Reflect.construct(a,[],i)}else{try{i.call()}catch(Ce){g=Ce}a.call(i.prototype)}else{try{throw Error()}catch(Ce){g=Ce}a()}}catch(Ce){if(Ce&&g&&typeof Ce.stack=="string"){for(var x=Ce.stack.split(`
`),b=g.stack.split(`
`),D=x.length-1,se=b.length-1;1<=D&&0<=se&&x[D]!==b[se];)se--;for(;1<=D&&0<=se;D--,se--)if(x[D]!==b[se]){if(D!==1||se!==1)do if(D--,se--,0>se||x[D]!==b[se]){var de=`
`+x[D].replace(" at new "," at ");return a.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",a.displayName)),de}while(1<=D&&0<=se);break}}}finally{L=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?N(a):""}function q(a){switch(a.tag){case 5:return N(a.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return a=V(a.type,!1),a;case 11:return a=V(a.type.render,!1),a;case 1:return a=V(a.type,!0),a;default:return""}}function ce(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case U:return"Fragment";case O:return"Portal";case I:return"Profiler";case ee:return"StrictMode";case ae:return"Suspense";case fe:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case oe:return(a.displayName||"Context")+".Consumer";case ie:return(a._context.displayName||"Context")+".Provider";case X:var i=a.render;return a=a.displayName,a||(a=i.displayName||i.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case me:return i=a.displayName||null,i!==null?i:ce(a.type)||"Memo";case Te:i=a._payload,a=a._init;try{return ce(a(i))}catch{}}return null}function J(a){var i=a.type;switch(a.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=i.render,a=a.displayName||a.name||"",i.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ce(i);case 8:return i===ee?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function he(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Y(a){var i=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function xe(a){var i=Y(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,i),g=""+a[i];if(!a.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var x=d.get,b=d.set;return Object.defineProperty(a,i,{configurable:!0,get:function(){return x.call(this)},set:function(D){g=""+D,b.call(this,D)}}),Object.defineProperty(a,i,{enumerable:d.enumerable}),{getValue:function(){return g},setValue:function(D){g=""+D},stopTracking:function(){a._valueTracker=null,delete a[i]}}}}function Pe(a){a._valueTracker||(a._valueTracker=xe(a))}function K(a){if(!a)return!1;var i=a._valueTracker;if(!i)return!0;var d=i.getValue(),g="";return a&&(g=Y(a)?a.checked?"true":"false":a.value),a=g,a!==d?(i.setValue(a),!0):!1}function Xe(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function we(a,i){var d=i.checked;return pe({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function Fe(a,i){var d=i.defaultValue==null?"":i.defaultValue,g=i.checked!=null?i.checked:i.defaultChecked;d=he(i.value!=null?i.value:d),a._wrapperState={initialChecked:g,initialValue:d,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Oe(a,i){i=i.checked,i!=null&&C(a,"checked",i,!1)}function Ae(a,i){Oe(a,i);var d=he(i.value),g=i.type;if(d!=null)g==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(g==="submit"||g==="reset"){a.removeAttribute("value");return}i.hasOwnProperty("value")?St(a,i.type,d):i.hasOwnProperty("defaultValue")&&St(a,i.type,he(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(a.defaultChecked=!!i.defaultChecked)}function at(a,i,d){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var g=i.type;if(!(g!=="submit"&&g!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+a._wrapperState.initialValue,d||i===a.value||(a.value=i),a.defaultValue=i}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function St(a,i,d){(i!=="number"||Xe(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var wt=Array.isArray;function Et(a,i,d,g){if(a=a.options,i){i={};for(var x=0;x<d.length;x++)i["$"+d[x]]=!0;for(d=0;d<a.length;d++)x=i.hasOwnProperty("$"+a[d].value),a[d].selected!==x&&(a[d].selected=x),x&&g&&(a[d].defaultSelected=!0)}else{for(d=""+he(d),i=null,x=0;x<a.length;x++){if(a[x].value===d){a[x].selected=!0,g&&(a[x].defaultSelected=!0);return}i!==null||a[x].disabled||(i=a[x])}i!==null&&(i.selected=!0)}}function Vt(a,i){if(i.dangerouslySetInnerHTML!=null)throw Error(e(91));return pe({},i,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function kt(a,i){var d=i.value;if(d==null){if(d=i.children,i=i.defaultValue,d!=null){if(i!=null)throw Error(e(92));if(wt(d)){if(1<d.length)throw Error(e(93));d=d[0]}i=d}i==null&&(i=""),d=i}a._wrapperState={initialValue:he(d)}}function Ct(a,i){var d=he(i.value),g=he(i.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),i.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),g!=null&&(a.defaultValue=""+g)}function At(a){var i=a.textContent;i===a._wrapperState.initialValue&&i!==""&&i!==null&&(a.value=i)}function Ht(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zt(a,i){return a==null||a==="http://www.w3.org/1999/xhtml"?Ht(i):a==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var qt,an=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,d,g,x){MSApp.execUnsafeLocalFunction(function(){return a(i,d,g,x)})}:a})(function(a,i){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=i;else{for(qt=qt||document.createElement("div"),qt.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=qt.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;i.firstChild;)a.appendChild(i.firstChild)}});function ct(a,i){if(i){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=i;return}}a.textContent=i}var Lt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dr=["Webkit","ms","Moz","O"];Object.keys(Lt).forEach(function(a){Dr.forEach(function(i){i=i+a.charAt(0).toUpperCase()+a.substring(1),Lt[i]=Lt[a]})});function Wt(a,i,d){return i==null||typeof i=="boolean"||i===""?"":d||typeof i!="number"||i===0||Lt.hasOwnProperty(a)&&Lt[a]?(""+i).trim():i+"px"}function on(a,i){a=a.style;for(var d in i)if(i.hasOwnProperty(d)){var g=d.indexOf("--")===0,x=Wt(d,i[d],g);d==="float"&&(d="cssFloat"),g?a.setProperty(d,x):a[d]=x}}var Fn=pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ws(a,i){if(i){if(Fn[a]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(e(137,a));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(e(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(e(61))}if(i.style!=null&&typeof i.style!="object")throw Error(e(62))}}function vr(a,i){if(a.indexOf("-")===-1)return typeof i.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pr=null;function it(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Gr=null,Lr=null,bn=null;function bt(a){if(a=Cl(a)){if(typeof Gr!="function")throw Error(e(280));var i=a.stateNode;i&&(i=Jc(i),Gr(a.stateNode,a.type,i))}}function ln(a){Lr?bn?bn.push(a):bn=[a]:Lr=a}function ni(){if(Lr){var a=Lr,i=bn;if(bn=Lr=null,bt(a),i)for(a=0;a<i.length;a++)bt(i[a])}}function _n(a,i){return a(i)}function zt(){}var Sn=!1;function $s(a,i,d){if(Sn)return a(i,d);Sn=!0;try{return _n(a,i,d)}finally{Sn=!1,(Lr!==null||bn!==null)&&(zt(),ni())}}function bs(a,i){var d=a.stateNode;if(d===null)return null;var g=Jc(d);if(g===null)return null;d=g[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(a=a.type,g=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!g;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(e(231,i,typeof d));return d}var pa=!1;if(u)try{var ss={};Object.defineProperty(ss,"passive",{get:function(){pa=!0}}),window.addEventListener("test",ss,ss),window.removeEventListener("test",ss,ss)}catch{pa=!1}function Ac(a,i,d,g,x,b,D,se,de){var Ce=Array.prototype.slice.call(arguments,3);try{i.apply(d,Ce)}catch($e){this.onError($e)}}var zn=!1,si=null,P=!1,W=null,z={onError:function(a){zn=!0,si=a}};function H(a,i,d,g,x,b,D,se,de){zn=!1,si=null,Ac.apply(z,arguments)}function Q(a,i,d,g,x,b,D,se,de){if(H.apply(this,arguments),zn){if(zn){var Ce=si;zn=!1,si=null}else throw Error(e(198));P||(P=!0,W=Ce)}}function Z(a){var i=a,d=a;if(a.alternate)for(;i.return;)i=i.return;else{a=i;do i=a,(i.flags&4098)!==0&&(d=i.return),a=i.return;while(a)}return i.tag===3?d:null}function ve(a){if(a.tag===13){var i=a.memoizedState;if(i===null&&(a=a.alternate,a!==null&&(i=a.memoizedState)),i!==null)return i.dehydrated}return null}function Ie(a){if(Z(a)!==a)throw Error(e(188))}function _e(a){var i=a.alternate;if(!i){if(i=Z(a),i===null)throw Error(e(188));return i!==a?null:a}for(var d=a,g=i;;){var x=d.return;if(x===null)break;var b=x.alternate;if(b===null){if(g=x.return,g!==null){d=g;continue}break}if(x.child===b.child){for(b=x.child;b;){if(b===d)return Ie(x),a;if(b===g)return Ie(x),i;b=b.sibling}throw Error(e(188))}if(d.return!==g.return)d=x,g=b;else{for(var D=!1,se=x.child;se;){if(se===d){D=!0,d=x,g=b;break}if(se===g){D=!0,g=x,d=b;break}se=se.sibling}if(!D){for(se=b.child;se;){if(se===d){D=!0,d=b,g=x;break}if(se===g){D=!0,g=b,d=x;break}se=se.sibling}if(!D)throw Error(e(189))}}if(d.alternate!==g)throw Error(e(190))}if(d.tag!==3)throw Error(e(188));return d.stateNode.current===d?a:i}function Ee(a){return a=_e(a),a!==null?ke(a):null}function ke(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var i=ke(a);if(i!==null)return i;a=a.sibling}return null}var Be=r.unstable_scheduleCallback,He=r.unstable_cancelCallback,Je=r.unstable_shouldYield,Me=r.unstable_requestPaint,De=r.unstable_now,ut=r.unstable_getCurrentPriorityLevel,Mt=r.unstable_ImmediatePriority,Dt=r.unstable_UserBlockingPriority,Ut=r.unstable_NormalPriority,Gn=r.unstable_LowPriority,as=r.unstable_IdlePriority,Dn=null,dr=null;function Bs(a){if(dr&&typeof dr.onCommitFiberRoot=="function")try{dr.onCommitFiberRoot(Dn,a,void 0,(a.current.flags&128)===128)}catch{}}var rr=Math.clz32?Math.clz32:ll,Rc=Math.log,to=Math.LN2;function ll(a){return a>>>=0,a===0?32:31-(Rc(a)/to|0)|0}var ro=64,ai=4194304;function xa(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ii(a,i){var d=a.pendingLanes;if(d===0)return 0;var g=0,x=a.suspendedLanes,b=a.pingedLanes,D=d&268435455;if(D!==0){var se=D&~x;se!==0?g=xa(se):(b&=D,b!==0&&(g=xa(b)))}else D=d&~x,D!==0?g=xa(D):b!==0&&(g=xa(b));if(g===0)return 0;if(i!==0&&i!==g&&(i&x)===0&&(x=g&-g,b=i&-i,x>=b||x===16&&(b&4194240)!==0))return i;if((g&4)!==0&&(g|=d&16),i=a.entangledLanes,i!==0)for(a=a.entanglements,i&=g;0<i;)d=31-rr(i),x=1<<d,g|=a[d],i&=~x;return g}function Dh(a,i){switch(a){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cl(a,i){for(var d=a.suspendedLanes,g=a.pingedLanes,x=a.expirationTimes,b=a.pendingLanes;0<b;){var D=31-rr(b),se=1<<D,de=x[D];de===-1?((se&d)===0||(se&g)!==0)&&(x[D]=Dh(se,i)):de<=i&&(a.expiredLanes|=se),b&=~se}}function ul(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function oi(){var a=ro;return ro<<=1,(ro&4194240)===0&&(ro=64),a}function cn(a){for(var i=[],d=0;31>d;d++)i.push(a);return i}function va(a,i,d){a.pendingLanes|=i,i!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,i=31-rr(i),a[i]=d}function Vs(a,i){var d=a.pendingLanes&~i;a.pendingLanes=i,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=i,a.mutableReadLanes&=i,a.entangledLanes&=i,i=a.entanglements;var g=a.eventTimes;for(a=a.expirationTimes;0<d;){var x=31-rr(d),b=1<<x;i[x]=0,g[x]=-1,a[x]=-1,d&=~b}}function dl(a,i){var d=a.entangledLanes|=i;for(a=a.entanglements;d;){var g=31-rr(d),x=1<<g;x&i|a[g]&i&&(a[g]|=i),d&=~x}}var Rt=0;function Ic(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var ft,Kr,li,no,xt,fl=!1,Ws=[],_s=null,fr=null,is=null,ya=new Map,Pn=new Map,yr=[],Oc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hs(a,i){switch(a){case"focusin":case"focusout":_s=null;break;case"dragenter":case"dragleave":fr=null;break;case"mouseover":case"mouseout":is=null;break;case"pointerover":case"pointerout":ya.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pn.delete(i.pointerId)}}function wa(a,i,d,g,x,b){return a===null||a.nativeEvent!==b?(a={blockedOn:i,domEventName:d,eventSystemFlags:g,nativeEvent:b,targetContainers:[x]},i!==null&&(i=Cl(i),i!==null&&Kr(i)),a):(a.eventSystemFlags|=g,i=a.targetContainers,x!==null&&i.indexOf(x)===-1&&i.push(x),a)}function ci(a,i,d,g,x){switch(i){case"focusin":return _s=wa(_s,a,i,d,g,x),!0;case"dragenter":return fr=wa(fr,a,i,d,g,x),!0;case"mouseover":return is=wa(is,a,i,d,g,x),!0;case"pointerover":var b=x.pointerId;return ya.set(b,wa(ya.get(b)||null,a,i,d,g,x)),!0;case"gotpointercapture":return b=x.pointerId,Pn.set(b,wa(Pn.get(b)||null,a,i,d,g,x)),!0}return!1}function jc(a){var i=Si(a.target);if(i!==null){var d=Z(i);if(d!==null){if(i=d.tag,i===13){if(i=ve(d),i!==null){a.blockedOn=i,xt(a.priority,function(){li(d)});return}}else if(i===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function ui(a){if(a.blockedOn!==null)return!1;for(var i=a.targetContainers;0<i.length;){var d=_a(a.domEventName,a.eventSystemFlags,i[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var g=new d.constructor(d.type,d);Pr=g,d.target.dispatchEvent(g),Pr=null}else return i=Cl(d),i!==null&&Kr(i),a.blockedOn=d,!1;i.shift()}return!0}function zs(a,i,d){ui(a)&&d.delete(i)}function Ss(){fl=!1,_s!==null&&ui(_s)&&(_s=null),fr!==null&&ui(fr)&&(fr=null),is!==null&&ui(is)&&(is=null),ya.forEach(zs),Pn.forEach(zs)}function Es(a,i){a.blockedOn===i&&(a.blockedOn=null,fl||(fl=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ss)))}function di(a){function i(x){return Es(x,a)}if(0<Ws.length){Es(Ws[0],a);for(var d=1;d<Ws.length;d++){var g=Ws[d];g.blockedOn===a&&(g.blockedOn=null)}}for(_s!==null&&Es(_s,a),fr!==null&&Es(fr,a),is!==null&&Es(is,a),ya.forEach(i),Pn.forEach(i),d=0;d<yr.length;d++)g=yr[d],g.blockedOn===a&&(g.blockedOn=null);for(;0<yr.length&&(d=yr[0],d.blockedOn===null);)jc(d),d.blockedOn===null&&yr.shift()}var un=M.ReactCurrentBatchConfig,ba=!0;function so(a,i,d,g){var x=Rt,b=un.transition;un.transition=null;try{Rt=1,hl(a,i,d,g)}finally{Rt=x,un.transition=b}}function Sd(a,i,d,g){var x=Rt,b=un.transition;un.transition=null;try{Rt=4,hl(a,i,d,g)}finally{Rt=x,un.transition=b}}function hl(a,i,d,g){if(ba){var x=_a(a,i,d,g);if(x===null)bi(a,i,g,fi,d),Hs(a,g);else if(ci(x,a,i,d,g))g.stopPropagation();else if(Hs(a,g),i&4&&-1<Oc.indexOf(a)){for(;x!==null;){var b=Cl(x);if(b!==null&&ft(b),b=_a(a,i,d,g),b===null&&bi(a,i,g,fi,d),b===x)break;x=b}x!==null&&g.stopPropagation()}else bi(a,i,g,null,d)}}var fi=null;function _a(a,i,d,g){if(fi=null,a=it(g),a=Si(a),a!==null)if(i=Z(a),i===null)a=null;else if(d=i.tag,d===13){if(a=ve(i),a!==null)return a;a=null}else if(d===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;a=null}else i!==a&&(a=null);return fi=a,null}function Gs(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ut()){case Mt:return 1;case Dt:return 4;case Ut:case Gn:return 16;case as:return 536870912;default:return 16}default:return 16}}var dn=null,Sa=null,ao=null;function hi(){if(ao)return ao;var a,i=Sa,d=i.length,g,x="value"in dn?dn.value:dn.textContent,b=x.length;for(a=0;a<d&&i[a]===x[a];a++);var D=d-a;for(g=1;g<=D&&i[d-g]===x[b-g];g++);return ao=x.slice(a,1<g?1-g:void 0)}function io(a){var i=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&i===13&&(a=13)):a=i,a===10&&(a=13),32<=a||a===13?a:0}function Ks(){return!0}function Xs(){return!1}function vt(a){function i(d,g,x,b,D){this._reactName=d,this._targetInst=x,this.type=g,this.nativeEvent=b,this.target=D,this.currentTarget=null;for(var se in a)a.hasOwnProperty(se)&&(d=a[se],this[se]=d?d(b):b[se]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Ks:Xs,this.isPropagationStopped=Xs,this}return pe(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Ks)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Ks)},persist:function(){},isPersistent:Ks}),i}var hr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ea=vt(hr),ka=pe({},hr,{view:0,detail:0}),Mr=vt(ka),ml,mi,qs,oo=pe({},ka,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fo,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==qs&&(qs&&a.type==="mousemove"?(ml=a.screenX-qs.screenX,mi=a.screenY-qs.screenY):mi=ml=0,qs=a),ml)},movementY:function(a){return"movementY"in a?a.movementY:mi}}),gl=vt(oo),Ed=pe({},oo,{dataTransfer:0}),kd=vt(Ed),lo=pe({},ka,{relatedTarget:0}),pl=vt(lo),Td=pe({},hr,{animationName:0,elapsedTime:0,pseudoElement:0}),Nd=vt(Td),Cd=pe({},hr,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),co=vt(Cd),xl=pe({},hr,{data:0}),uo=vt(xl),Ad={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wr(a){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(a):(a=Pt[a])?!!i[a]:!1}function fo(){return wr}var ho=pe({},ka,{key:function(a){if(a.key){var i=Ad[a.key]||a.key;if(i!=="Unidentified")return i}return a.type==="keypress"?(a=io(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Rd[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fo,charCode:function(a){return a.type==="keypress"?io(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?io(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),En=vt(ho),Fc=pe({},oo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vl=vt(Fc),$t=pe({},ka,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fo}),Id=vt($t),Od=pe({},hr,{propertyName:0,elapsedTime:0,pseudoElement:0}),jd=vt(Od),Dc=pe({},oo,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Pc=vt(Dc),Fd=[9,13,27,32],ks=u&&"CompositionEvent"in window,gi=null;u&&"documentMode"in document&&(gi=document.documentMode);var Dd=u&&"TextEvent"in window&&!gi,Lc=u&&(!ks||gi&&8<gi&&11>=gi),Ts=" ",Mc=!1;function Uc(a,i){switch(a){case"keyup":return Fd.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yl(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ns=!1;function $c(a,i){switch(a){case"compositionend":return yl(i);case"keypress":return i.which!==32?null:(Mc=!0,Ts);case"textInput":return a=i.data,a===Ts&&Mc?null:a;default:return null}}function Pd(a,i){if(Ns)return a==="compositionend"||!ks&&Uc(a,i)?(a=hi(),ao=Sa=dn=null,Ns=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Lc&&i.locale!=="ko"?null:i.data;default:return null}}var Ld={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ta(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i==="input"?!!Ld[a.type]:i==="textarea"}function Bc(a,i,d,g){ln(g),i=po(i,"onChange"),0<i.length&&(d=new Ea("onChange","change",null,d,g),a.push({event:d,listeners:i}))}var pi=null,xi=null;function Md(a){Mn(a,0)}function Js(a){var i=vo(a);if(K(i))return a}function Vc(a,i){if(a==="change")return i}var wl=!1;if(u){var bl;if(u){var kn="oninput"in document;if(!kn){var Wc=document.createElement("div");Wc.setAttribute("oninput","return;"),kn=typeof Wc.oninput=="function"}bl=kn}else bl=!1;wl=bl&&(!document.documentMode||9<document.documentMode)}function Hc(){pi&&(pi.detachEvent("onpropertychange",_l),xi=pi=null)}function _l(a){if(a.propertyName==="value"&&Js(xi)){var i=[];Bc(i,xi,a,it(a)),$s(Md,i)}}function Sl(a,i,d){a==="focusin"?(Hc(),pi=i,xi=d,pi.attachEvent("onpropertychange",_l)):a==="focusout"&&Hc()}function Ud(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Js(xi)}function $d(a,i){if(a==="click")return Js(i)}function Bd(a,i){if(a==="input"||a==="change")return Js(i)}function Vd(a,i){return a===i&&(a!==0||1/a===1/i)||a!==a&&i!==i}var Ln=typeof Object.is=="function"?Object.is:Vd;function vi(a,i){if(Ln(a,i))return!0;if(typeof a!="object"||a===null||typeof i!="object"||i===null)return!1;var d=Object.keys(a),g=Object.keys(i);if(d.length!==g.length)return!1;for(g=0;g<d.length;g++){var x=d[g];if(!f.call(i,x)||!Ln(a[x],i[x]))return!1}return!0}function El(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function zc(a,i){var d=El(a);a=0;for(var g;d;){if(d.nodeType===3){if(g=a+d.textContent.length,a<=i&&g>=i)return{node:d,offset:i-a};a=g}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=El(d)}}function Jt(a,i){return a&&i?a===i?!0:a&&a.nodeType===3?!1:i&&i.nodeType===3?Jt(a,i.parentNode):"contains"in a?a.contains(i):a.compareDocumentPosition?!!(a.compareDocumentPosition(i)&16):!1:!1}function kl(){for(var a=window,i=Xe();i instanceof a.HTMLIFrameElement;){try{var d=typeof i.contentWindow.location.href=="string"}catch{d=!1}if(d)a=i.contentWindow;else break;i=Xe(a.document)}return i}function Ys(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i&&(i==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||i==="textarea"||a.contentEditable==="true")}function Wd(a){var i=kl(),d=a.focusedElem,g=a.selectionRange;if(i!==d&&d&&d.ownerDocument&&Jt(d.ownerDocument.documentElement,d)){if(g!==null&&Ys(d)){if(i=g.start,a=g.end,a===void 0&&(a=i),"selectionStart"in d)d.selectionStart=i,d.selectionEnd=Math.min(a,d.value.length);else if(a=(i=d.ownerDocument||document)&&i.defaultView||window,a.getSelection){a=a.getSelection();var x=d.textContent.length,b=Math.min(g.start,x);g=g.end===void 0?b:Math.min(g.end,x),!a.extend&&b>g&&(x=g,g=b,b=x),x=zc(d,b);var D=zc(d,g);x&&D&&(a.rangeCount!==1||a.anchorNode!==x.node||a.anchorOffset!==x.offset||a.focusNode!==D.node||a.focusOffset!==D.offset)&&(i=i.createRange(),i.setStart(x.node,x.offset),a.removeAllRanges(),b>g?(a.addRange(i),a.extend(D.node,D.offset)):(i.setEnd(D.node,D.offset),a.addRange(i)))}}for(i=[],a=d;a=a.parentNode;)a.nodeType===1&&i.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<i.length;d++)a=i[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var Hd=u&&"documentMode"in document&&11>=document.documentMode,Na=null,Tl=null,yi=null,mo=!1;function Gc(a,i,d){var g=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;mo||Na==null||Na!==Xe(g)||(g=Na,"selectionStart"in g&&Ys(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),yi&&vi(yi,g)||(yi=g,g=po(Tl,"onSelect"),0<g.length&&(i=new Ea("onSelect","select",null,i,d),a.push({event:i,listeners:g}),i.target=Na)))}function Ca(a,i){var d={};return d[a.toLowerCase()]=i.toLowerCase(),d["Webkit"+a]="webkit"+i,d["Moz"+a]="moz"+i,d}var Ur={animationend:Ca("Animation","AnimationEnd"),animationiteration:Ca("Animation","AnimationIteration"),animationstart:Ca("Animation","AnimationStart"),transitionend:Ca("Transition","TransitionEnd")},h={},_={};u&&(_=document.createElement("div").style,"AnimationEvent"in window||(delete Ur.animationend.animation,delete Ur.animationiteration.animation,delete Ur.animationstart.animation),"TransitionEvent"in window||delete Ur.transitionend.transition);function T(a){if(h[a])return h[a];if(!Ur[a])return a;var i=Ur[a],d;for(d in i)if(i.hasOwnProperty(d)&&d in _)return h[a]=i[d];return a}var R=T("animationend"),G=T("animationiteration"),ne=T("animationstart"),ue=T("transitionend"),Ne=new Map,Re="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function We(a,i){Ne.set(a,i),o(i,[a])}for(var Ke=0;Ke<Re.length;Ke++){var Ue=Re[Ke],qe=Ue.toLowerCase(),ot=Ue[0].toUpperCase()+Ue.slice(1);We(qe,"on"+ot)}We(R,"onAnimationEnd"),We(G,"onAnimationIteration"),We(ne,"onAnimationStart"),We("dblclick","onDoubleClick"),We("focusin","onFocus"),We("focusout","onBlur"),We(ue,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jt="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yt=new Set("cancel close invalid load scroll toggle".split(" ").concat(jt));function fn(a,i,d){var g=a.type||"unknown-event";a.currentTarget=d,Q(g,i,void 0,a),a.currentTarget=null}function Mn(a,i){i=(i&4)!==0;for(var d=0;d<a.length;d++){var g=a[d],x=g.event;g=g.listeners;e:{var b=void 0;if(i)for(var D=g.length-1;0<=D;D--){var se=g[D],de=se.instance,Ce=se.currentTarget;if(se=se.listener,de!==b&&x.isPropagationStopped())break e;fn(x,se,Ce),b=de}else for(D=0;D<g.length;D++){if(se=g[D],de=se.instance,Ce=se.currentTarget,se=se.listener,de!==b&&x.isPropagationStopped())break e;fn(x,se,Ce),b=de}}}if(P)throw a=W,P=!1,W=null,a}function Bt(a,i){var d=i[Jd];d===void 0&&(d=i[Jd]=new Set);var g=a+"__bubble";d.has(g)||(Kc(i,a,2,!1),d.add(g))}function Aa(a,i,d){var g=0;i&&(g|=4),Kc(d,a,g,i)}var go="_reactListening"+Math.random().toString(36).slice(2);function wi(a){if(!a[go]){a[go]=!0,n.forEach(function(d){d!=="selectionchange"&&(Yt.has(d)||Aa(d,!1,a),Aa(d,!0,a))});var i=a.nodeType===9?a:a.ownerDocument;i===null||i[go]||(i[go]=!0,Aa("selectionchange",!1,i))}}function Kc(a,i,d,g){switch(Gs(i)){case 1:var x=so;break;case 4:x=Sd;break;default:x=hl}d=x.bind(null,i,d,a),x=void 0,!pa||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(x=!0),g?x!==void 0?a.addEventListener(i,d,{capture:!0,passive:x}):a.addEventListener(i,d,!0):x!==void 0?a.addEventListener(i,d,{passive:x}):a.addEventListener(i,d,!1)}function bi(a,i,d,g,x){var b=g;if((i&1)===0&&(i&2)===0&&g!==null)e:for(;;){if(g===null)return;var D=g.tag;if(D===3||D===4){var se=g.stateNode.containerInfo;if(se===x||se.nodeType===8&&se.parentNode===x)break;if(D===4)for(D=g.return;D!==null;){var de=D.tag;if((de===3||de===4)&&(de=D.stateNode.containerInfo,de===x||de.nodeType===8&&de.parentNode===x))return;D=D.return}for(;se!==null;){if(D=Si(se),D===null)return;if(de=D.tag,de===5||de===6){g=b=D;continue e}se=se.parentNode}}g=g.return}$s(function(){var Ce=b,$e=it(d),Ve=[];e:{var Le=Ne.get(a);if(Le!==void 0){var Ye=Ea,Ze=a;switch(a){case"keypress":if(io(d)===0)break e;case"keydown":case"keyup":Ye=En;break;case"focusin":Ze="focus",Ye=pl;break;case"focusout":Ze="blur",Ye=pl;break;case"beforeblur":case"afterblur":Ye=pl;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ye=gl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ye=kd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ye=Id;break;case R:case G:case ne:Ye=Nd;break;case ue:Ye=jd;break;case"scroll":Ye=Mr;break;case"wheel":Ye=Pc;break;case"copy":case"cut":case"paste":Ye=co;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ye=vl}var et=(i&4)!==0,cr=!et&&a==="scroll",ye=et?Le!==null?Le+"Capture":null:Le;et=[];for(var ge=Ce,Se;ge!==null;){Se=ge;var ze=Se.stateNode;if(Se.tag===5&&ze!==null&&(Se=ze,ye!==null&&(ze=bs(ge,ye),ze!=null&&et.push(_i(ge,ze,Se)))),cr)break;ge=ge.return}0<et.length&&(Le=new Ye(Le,Ze,null,d,$e),Ve.push({event:Le,listeners:et}))}}if((i&7)===0){e:{if(Le=a==="mouseover"||a==="pointerover",Ye=a==="mouseout"||a==="pointerout",Le&&d!==Pr&&(Ze=d.relatedTarget||d.fromElement)&&(Si(Ze)||Ze[Qs]))break e;if((Ye||Le)&&(Le=$e.window===$e?$e:(Le=$e.ownerDocument)?Le.defaultView||Le.parentWindow:window,Ye?(Ze=d.relatedTarget||d.toElement,Ye=Ce,Ze=Ze?Si(Ze):null,Ze!==null&&(cr=Z(Ze),Ze!==cr||Ze.tag!==5&&Ze.tag!==6)&&(Ze=null)):(Ye=null,Ze=Ce),Ye!==Ze)){if(et=gl,ze="onMouseLeave",ye="onMouseEnter",ge="mouse",(a==="pointerout"||a==="pointerover")&&(et=vl,ze="onPointerLeave",ye="onPointerEnter",ge="pointer"),cr=Ye==null?Le:vo(Ye),Se=Ze==null?Le:vo(Ze),Le=new et(ze,ge+"leave",Ye,d,$e),Le.target=cr,Le.relatedTarget=Se,ze=null,Si($e)===Ce&&(et=new et(ye,ge+"enter",Ze,d,$e),et.target=Se,et.relatedTarget=cr,ze=et),cr=ze,Ye&&Ze)t:{for(et=Ye,ye=Ze,ge=0,Se=et;Se;Se=Ra(Se))ge++;for(Se=0,ze=ye;ze;ze=Ra(ze))Se++;for(;0<ge-Se;)et=Ra(et),ge--;for(;0<Se-ge;)ye=Ra(ye),Se--;for(;ge--;){if(et===ye||ye!==null&&et===ye.alternate)break t;et=Ra(et),ye=Ra(ye)}et=null}else et=null;Ye!==null&&Ph(Ve,Le,Ye,et,!1),Ze!==null&&cr!==null&&Ph(Ve,cr,Ze,et,!0)}}e:{if(Le=Ce?vo(Ce):window,Ye=Le.nodeName&&Le.nodeName.toLowerCase(),Ye==="select"||Ye==="input"&&Le.type==="file")var tt=Vc;else if(Ta(Le))if(wl)tt=Bd;else{tt=Ud;var nt=Sl}else(Ye=Le.nodeName)&&Ye.toLowerCase()==="input"&&(Le.type==="checkbox"||Le.type==="radio")&&(tt=$d);if(tt&&(tt=tt(a,Ce))){Bc(Ve,tt,d,$e);break e}nt&&nt(a,Le,Ce),a==="focusout"&&(nt=Le._wrapperState)&&nt.controlled&&Le.type==="number"&&St(Le,"number",Le.value)}switch(nt=Ce?vo(Ce):window,a){case"focusin":(Ta(nt)||nt.contentEditable==="true")&&(Na=nt,Tl=Ce,yi=null);break;case"focusout":yi=Tl=Na=null;break;case"mousedown":mo=!0;break;case"contextmenu":case"mouseup":case"dragend":mo=!1,Gc(Ve,d,$e);break;case"selectionchange":if(Hd)break;case"keydown":case"keyup":Gc(Ve,d,$e)}var st;if(ks)e:{switch(a){case"compositionstart":var dt="onCompositionStart";break e;case"compositionend":dt="onCompositionEnd";break e;case"compositionupdate":dt="onCompositionUpdate";break e}dt=void 0}else Ns?Uc(a,d)&&(dt="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(dt="onCompositionStart");dt&&(Lc&&d.locale!=="ko"&&(Ns||dt!=="onCompositionStart"?dt==="onCompositionEnd"&&Ns&&(st=hi()):(dn=$e,Sa="value"in dn?dn.value:dn.textContent,Ns=!0)),nt=po(Ce,dt),0<nt.length&&(dt=new uo(dt,a,null,d,$e),Ve.push({event:dt,listeners:nt}),st?dt.data=st:(st=yl(d),st!==null&&(dt.data=st)))),(st=Dd?$c(a,d):Pd(a,d))&&(Ce=po(Ce,"onBeforeInput"),0<Ce.length&&($e=new uo("onBeforeInput","beforeinput",null,d,$e),Ve.push({event:$e,listeners:Ce}),$e.data=st))}Mn(Ve,i)})}function _i(a,i,d){return{instance:a,listener:i,currentTarget:d}}function po(a,i){for(var d=i+"Capture",g=[];a!==null;){var x=a,b=x.stateNode;x.tag===5&&b!==null&&(x=b,b=bs(a,d),b!=null&&g.unshift(_i(a,b,x)),b=bs(a,i),b!=null&&g.push(_i(a,b,x))),a=a.return}return g}function Ra(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function Ph(a,i,d,g,x){for(var b=i._reactName,D=[];d!==null&&d!==g;){var se=d,de=se.alternate,Ce=se.stateNode;if(de!==null&&de===g)break;se.tag===5&&Ce!==null&&(se=Ce,x?(de=bs(d,b),de!=null&&D.unshift(_i(d,de,se))):x||(de=bs(d,b),de!=null&&D.push(_i(d,de,se)))),d=d.return}D.length!==0&&a.push({event:i,listeners:D})}var T1=/\r\n?/g,N1=/\u0000|\uFFFD/g;function Lh(a){return(typeof a=="string"?a:""+a).replace(T1,`
`).replace(N1,"")}function Xc(a,i,d){if(i=Lh(i),Lh(a)!==i&&d)throw Error(e(425))}function qc(){}var zd=null,Gd=null;function Kd(a,i){return a==="textarea"||a==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Xd=typeof setTimeout=="function"?setTimeout:void 0,C1=typeof clearTimeout=="function"?clearTimeout:void 0,Mh=typeof Promise=="function"?Promise:void 0,A1=typeof queueMicrotask=="function"?queueMicrotask:typeof Mh<"u"?function(a){return Mh.resolve(null).then(a).catch(R1)}:Xd;function R1(a){setTimeout(function(){throw a})}function qd(a,i){var d=i,g=0;do{var x=d.nextSibling;if(a.removeChild(d),x&&x.nodeType===8)if(d=x.data,d==="/$"){if(g===0){a.removeChild(x),di(i);return}g--}else d!=="$"&&d!=="$?"&&d!=="$!"||g++;d=x}while(d);di(i)}function Ia(a){for(;a!=null;a=a.nextSibling){var i=a.nodeType;if(i===1||i===3)break;if(i===8){if(i=a.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return a}function Uh(a){a=a.previousSibling;for(var i=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(i===0)return a;i--}else d==="/$"&&i++}a=a.previousSibling}return null}var xo=Math.random().toString(36).slice(2),Cs="__reactFiber$"+xo,Nl="__reactProps$"+xo,Qs="__reactContainer$"+xo,Jd="__reactEvents$"+xo,I1="__reactListeners$"+xo,O1="__reactHandles$"+xo;function Si(a){var i=a[Cs];if(i)return i;for(var d=a.parentNode;d;){if(i=d[Qs]||d[Cs]){if(d=i.alternate,i.child!==null||d!==null&&d.child!==null)for(a=Uh(a);a!==null;){if(d=a[Cs])return d;a=Uh(a)}return i}a=d,d=a.parentNode}return null}function Cl(a){return a=a[Cs]||a[Qs],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function vo(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(e(33))}function Jc(a){return a[Nl]||null}var Yd=[],yo=-1;function Oa(a){return{current:a}}function Qt(a){0>yo||(a.current=Yd[yo],Yd[yo]=null,yo--)}function Gt(a,i){yo++,Yd[yo]=a.current,a.current=i}var ja={},Xr=Oa(ja),Tn=Oa(!1),Ei=ja;function wo(a,i){var d=a.type.contextTypes;if(!d)return ja;var g=a.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===i)return g.__reactInternalMemoizedMaskedChildContext;var x={},b;for(b in d)x[b]=i[b];return g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=i,a.__reactInternalMemoizedMaskedChildContext=x),x}function Nn(a){return a=a.childContextTypes,a!=null}function Yc(){Qt(Tn),Qt(Xr)}function $h(a,i,d){if(Xr.current!==ja)throw Error(e(168));Gt(Xr,i),Gt(Tn,d)}function Bh(a,i,d){var g=a.stateNode;if(i=i.childContextTypes,typeof g.getChildContext!="function")return d;g=g.getChildContext();for(var x in g)if(!(x in i))throw Error(e(108,J(a)||"Unknown",x));return pe({},d,g)}function Qc(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||ja,Ei=Xr.current,Gt(Xr,a),Gt(Tn,Tn.current),!0}function Vh(a,i,d){var g=a.stateNode;if(!g)throw Error(e(169));d?(a=Bh(a,i,Ei),g.__reactInternalMemoizedMergedChildContext=a,Qt(Tn),Qt(Xr),Gt(Xr,a)):Qt(Tn),Gt(Tn,d)}var Zs=null,Zc=!1,Qd=!1;function Wh(a){Zs===null?Zs=[a]:Zs.push(a)}function j1(a){Zc=!0,Wh(a)}function Fa(){if(!Qd&&Zs!==null){Qd=!0;var a=0,i=Rt;try{var d=Zs;for(Rt=1;a<d.length;a++){var g=d[a];do g=g(!0);while(g!==null)}Zs=null,Zc=!1}catch(x){throw Zs!==null&&(Zs=Zs.slice(a+1)),Be(Mt,Fa),x}finally{Rt=i,Qd=!1}}return null}var bo=[],_o=0,eu=null,tu=0,Kn=[],Xn=0,ki=null,ea=1,ta="";function Ti(a,i){bo[_o++]=tu,bo[_o++]=eu,eu=a,tu=i}function Hh(a,i,d){Kn[Xn++]=ea,Kn[Xn++]=ta,Kn[Xn++]=ki,ki=a;var g=ea;a=ta;var x=32-rr(g)-1;g&=~(1<<x),d+=1;var b=32-rr(i)+x;if(30<b){var D=x-x%5;b=(g&(1<<D)-1).toString(32),g>>=D,x-=D,ea=1<<32-rr(i)+x|d<<x|g,ta=b+a}else ea=1<<b|d<<x|g,ta=a}function Zd(a){a.return!==null&&(Ti(a,1),Hh(a,1,0))}function e0(a){for(;a===eu;)eu=bo[--_o],bo[_o]=null,tu=bo[--_o],bo[_o]=null;for(;a===ki;)ki=Kn[--Xn],Kn[Xn]=null,ta=Kn[--Xn],Kn[Xn]=null,ea=Kn[--Xn],Kn[Xn]=null}var Un=null,$n=null,er=!1,os=null;function zh(a,i){var d=Qn(5,null,null,0);d.elementType="DELETED",d.stateNode=i,d.return=a,i=a.deletions,i===null?(a.deletions=[d],a.flags|=16):i.push(d)}function Gh(a,i){switch(a.tag){case 5:var d=a.type;return i=i.nodeType!==1||d.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(a.stateNode=i,Un=a,$n=Ia(i.firstChild),!0):!1;case 6:return i=a.pendingProps===""||i.nodeType!==3?null:i,i!==null?(a.stateNode=i,Un=a,$n=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(d=ki!==null?{id:ea,overflow:ta}:null,a.memoizedState={dehydrated:i,treeContext:d,retryLane:1073741824},d=Qn(18,null,null,0),d.stateNode=i,d.return=a,a.child=d,Un=a,$n=null,!0):!1;default:return!1}}function t0(a){return(a.mode&1)!==0&&(a.flags&128)===0}function r0(a){if(er){var i=$n;if(i){var d=i;if(!Gh(a,i)){if(t0(a))throw Error(e(418));i=Ia(d.nextSibling);var g=Un;i&&Gh(a,i)?zh(g,d):(a.flags=a.flags&-4097|2,er=!1,Un=a)}}else{if(t0(a))throw Error(e(418));a.flags=a.flags&-4097|2,er=!1,Un=a}}}function Kh(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Un=a}function ru(a){if(a!==Un)return!1;if(!er)return Kh(a),er=!0,!1;var i;if((i=a.tag!==3)&&!(i=a.tag!==5)&&(i=a.type,i=i!=="head"&&i!=="body"&&!Kd(a.type,a.memoizedProps)),i&&(i=$n)){if(t0(a))throw Xh(),Error(e(418));for(;i;)zh(a,i),i=Ia(i.nextSibling)}if(Kh(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(e(317));e:{for(a=a.nextSibling,i=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(i===0){$n=Ia(a.nextSibling);break e}i--}else d!=="$"&&d!=="$!"&&d!=="$?"||i++}a=a.nextSibling}$n=null}}else $n=Un?Ia(a.stateNode.nextSibling):null;return!0}function Xh(){for(var a=$n;a;)a=Ia(a.nextSibling)}function So(){$n=Un=null,er=!1}function n0(a){os===null?os=[a]:os.push(a)}var F1=M.ReactCurrentBatchConfig;function Al(a,i,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(e(309));var g=d.stateNode}if(!g)throw Error(e(147,a));var x=g,b=""+a;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===b?i.ref:(i=function(D){var se=x.refs;D===null?delete se[b]:se[b]=D},i._stringRef=b,i)}if(typeof a!="string")throw Error(e(284));if(!d._owner)throw Error(e(290,a))}return a}function nu(a,i){throw a=Object.prototype.toString.call(i),Error(e(31,a==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":a))}function qh(a){var i=a._init;return i(a._payload)}function Jh(a){function i(ye,ge){if(a){var Se=ye.deletions;Se===null?(ye.deletions=[ge],ye.flags|=16):Se.push(ge)}}function d(ye,ge){if(!a)return null;for(;ge!==null;)i(ye,ge),ge=ge.sibling;return null}function g(ye,ge){for(ye=new Map;ge!==null;)ge.key!==null?ye.set(ge.key,ge):ye.set(ge.index,ge),ge=ge.sibling;return ye}function x(ye,ge){return ye=Va(ye,ge),ye.index=0,ye.sibling=null,ye}function b(ye,ge,Se){return ye.index=Se,a?(Se=ye.alternate,Se!==null?(Se=Se.index,Se<ge?(ye.flags|=2,ge):Se):(ye.flags|=2,ge)):(ye.flags|=1048576,ge)}function D(ye){return a&&ye.alternate===null&&(ye.flags|=2),ye}function se(ye,ge,Se,ze){return ge===null||ge.tag!==6?(ge=X0(Se,ye.mode,ze),ge.return=ye,ge):(ge=x(ge,Se),ge.return=ye,ge)}function de(ye,ge,Se,ze){var tt=Se.type;return tt===U?$e(ye,ge,Se.props.children,ze,Se.key):ge!==null&&(ge.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===Te&&qh(tt)===ge.type)?(ze=x(ge,Se.props),ze.ref=Al(ye,ge,Se),ze.return=ye,ze):(ze=Nu(Se.type,Se.key,Se.props,null,ye.mode,ze),ze.ref=Al(ye,ge,Se),ze.return=ye,ze)}function Ce(ye,ge,Se,ze){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==Se.containerInfo||ge.stateNode.implementation!==Se.implementation?(ge=q0(Se,ye.mode,ze),ge.return=ye,ge):(ge=x(ge,Se.children||[]),ge.return=ye,ge)}function $e(ye,ge,Se,ze,tt){return ge===null||ge.tag!==7?(ge=Fi(Se,ye.mode,ze,tt),ge.return=ye,ge):(ge=x(ge,Se),ge.return=ye,ge)}function Ve(ye,ge,Se){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return ge=X0(""+ge,ye.mode,Se),ge.return=ye,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case re:return Se=Nu(ge.type,ge.key,ge.props,null,ye.mode,Se),Se.ref=Al(ye,null,ge),Se.return=ye,Se;case O:return ge=q0(ge,ye.mode,Se),ge.return=ye,ge;case Te:var ze=ge._init;return Ve(ye,ze(ge._payload),Se)}if(wt(ge)||te(ge))return ge=Fi(ge,ye.mode,Se,null),ge.return=ye,ge;nu(ye,ge)}return null}function Le(ye,ge,Se,ze){var tt=ge!==null?ge.key:null;if(typeof Se=="string"&&Se!==""||typeof Se=="number")return tt!==null?null:se(ye,ge,""+Se,ze);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case re:return Se.key===tt?de(ye,ge,Se,ze):null;case O:return Se.key===tt?Ce(ye,ge,Se,ze):null;case Te:return tt=Se._init,Le(ye,ge,tt(Se._payload),ze)}if(wt(Se)||te(Se))return tt!==null?null:$e(ye,ge,Se,ze,null);nu(ye,Se)}return null}function Ye(ye,ge,Se,ze,tt){if(typeof ze=="string"&&ze!==""||typeof ze=="number")return ye=ye.get(Se)||null,se(ge,ye,""+ze,tt);if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case re:return ye=ye.get(ze.key===null?Se:ze.key)||null,de(ge,ye,ze,tt);case O:return ye=ye.get(ze.key===null?Se:ze.key)||null,Ce(ge,ye,ze,tt);case Te:var nt=ze._init;return Ye(ye,ge,Se,nt(ze._payload),tt)}if(wt(ze)||te(ze))return ye=ye.get(Se)||null,$e(ge,ye,ze,tt,null);nu(ge,ze)}return null}function Ze(ye,ge,Se,ze){for(var tt=null,nt=null,st=ge,dt=ge=0,Ir=null;st!==null&&dt<Se.length;dt++){st.index>dt?(Ir=st,st=null):Ir=st.sibling;var Ft=Le(ye,st,Se[dt],ze);if(Ft===null){st===null&&(st=Ir);break}a&&st&&Ft.alternate===null&&i(ye,st),ge=b(Ft,ge,dt),nt===null?tt=Ft:nt.sibling=Ft,nt=Ft,st=Ir}if(dt===Se.length)return d(ye,st),er&&Ti(ye,dt),tt;if(st===null){for(;dt<Se.length;dt++)st=Ve(ye,Se[dt],ze),st!==null&&(ge=b(st,ge,dt),nt===null?tt=st:nt.sibling=st,nt=st);return er&&Ti(ye,dt),tt}for(st=g(ye,st);dt<Se.length;dt++)Ir=Ye(st,ye,dt,Se[dt],ze),Ir!==null&&(a&&Ir.alternate!==null&&st.delete(Ir.key===null?dt:Ir.key),ge=b(Ir,ge,dt),nt===null?tt=Ir:nt.sibling=Ir,nt=Ir);return a&&st.forEach(function(Wa){return i(ye,Wa)}),er&&Ti(ye,dt),tt}function et(ye,ge,Se,ze){var tt=te(Se);if(typeof tt!="function")throw Error(e(150));if(Se=tt.call(Se),Se==null)throw Error(e(151));for(var nt=tt=null,st=ge,dt=ge=0,Ir=null,Ft=Se.next();st!==null&&!Ft.done;dt++,Ft=Se.next()){st.index>dt?(Ir=st,st=null):Ir=st.sibling;var Wa=Le(ye,st,Ft.value,ze);if(Wa===null){st===null&&(st=Ir);break}a&&st&&Wa.alternate===null&&i(ye,st),ge=b(Wa,ge,dt),nt===null?tt=Wa:nt.sibling=Wa,nt=Wa,st=Ir}if(Ft.done)return d(ye,st),er&&Ti(ye,dt),tt;if(st===null){for(;!Ft.done;dt++,Ft=Se.next())Ft=Ve(ye,Ft.value,ze),Ft!==null&&(ge=b(Ft,ge,dt),nt===null?tt=Ft:nt.sibling=Ft,nt=Ft);return er&&Ti(ye,dt),tt}for(st=g(ye,st);!Ft.done;dt++,Ft=Se.next())Ft=Ye(st,ye,dt,Ft.value,ze),Ft!==null&&(a&&Ft.alternate!==null&&st.delete(Ft.key===null?dt:Ft.key),ge=b(Ft,ge,dt),nt===null?tt=Ft:nt.sibling=Ft,nt=Ft);return a&&st.forEach(function(hy){return i(ye,hy)}),er&&Ti(ye,dt),tt}function cr(ye,ge,Se,ze){if(typeof Se=="object"&&Se!==null&&Se.type===U&&Se.key===null&&(Se=Se.props.children),typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case re:e:{for(var tt=Se.key,nt=ge;nt!==null;){if(nt.key===tt){if(tt=Se.type,tt===U){if(nt.tag===7){d(ye,nt.sibling),ge=x(nt,Se.props.children),ge.return=ye,ye=ge;break e}}else if(nt.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===Te&&qh(tt)===nt.type){d(ye,nt.sibling),ge=x(nt,Se.props),ge.ref=Al(ye,nt,Se),ge.return=ye,ye=ge;break e}d(ye,nt);break}else i(ye,nt);nt=nt.sibling}Se.type===U?(ge=Fi(Se.props.children,ye.mode,ze,Se.key),ge.return=ye,ye=ge):(ze=Nu(Se.type,Se.key,Se.props,null,ye.mode,ze),ze.ref=Al(ye,ge,Se),ze.return=ye,ye=ze)}return D(ye);case O:e:{for(nt=Se.key;ge!==null;){if(ge.key===nt)if(ge.tag===4&&ge.stateNode.containerInfo===Se.containerInfo&&ge.stateNode.implementation===Se.implementation){d(ye,ge.sibling),ge=x(ge,Se.children||[]),ge.return=ye,ye=ge;break e}else{d(ye,ge);break}else i(ye,ge);ge=ge.sibling}ge=q0(Se,ye.mode,ze),ge.return=ye,ye=ge}return D(ye);case Te:return nt=Se._init,cr(ye,ge,nt(Se._payload),ze)}if(wt(Se))return Ze(ye,ge,Se,ze);if(te(Se))return et(ye,ge,Se,ze);nu(ye,Se)}return typeof Se=="string"&&Se!==""||typeof Se=="number"?(Se=""+Se,ge!==null&&ge.tag===6?(d(ye,ge.sibling),ge=x(ge,Se),ge.return=ye,ye=ge):(d(ye,ge),ge=X0(Se,ye.mode,ze),ge.return=ye,ye=ge),D(ye)):d(ye,ge)}return cr}var Eo=Jh(!0),Yh=Jh(!1),su=Oa(null),au=null,ko=null,s0=null;function a0(){s0=ko=au=null}function i0(a){var i=su.current;Qt(su),a._currentValue=i}function o0(a,i,d){for(;a!==null;){var g=a.alternate;if((a.childLanes&i)!==i?(a.childLanes|=i,g!==null&&(g.childLanes|=i)):g!==null&&(g.childLanes&i)!==i&&(g.childLanes|=i),a===d)break;a=a.return}}function To(a,i){au=a,s0=ko=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&i)!==0&&(Cn=!0),a.firstContext=null)}function qn(a){var i=a._currentValue;if(s0!==a)if(a={context:a,memoizedValue:i,next:null},ko===null){if(au===null)throw Error(e(308));ko=a,au.dependencies={lanes:0,firstContext:a}}else ko=ko.next=a;return i}var Ni=null;function l0(a){Ni===null?Ni=[a]:Ni.push(a)}function Qh(a,i,d,g){var x=i.interleaved;return x===null?(d.next=d,l0(i)):(d.next=x.next,x.next=d),i.interleaved=d,ra(a,g)}function ra(a,i){a.lanes|=i;var d=a.alternate;for(d!==null&&(d.lanes|=i),d=a,a=a.return;a!==null;)a.childLanes|=i,d=a.alternate,d!==null&&(d.childLanes|=i),d=a,a=a.return;return d.tag===3?d.stateNode:null}var Da=!1;function c0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zh(a,i){a=a.updateQueue,i.updateQueue===a&&(i.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function na(a,i){return{eventTime:a,lane:i,tag:0,payload:null,callback:null,next:null}}function Pa(a,i,d){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,(It&2)!==0){var x=g.pending;return x===null?i.next=i:(i.next=x.next,x.next=i),g.pending=i,ra(a,d)}return x=g.interleaved,x===null?(i.next=i,l0(g)):(i.next=x.next,x.next=i),g.interleaved=i,ra(a,d)}function iu(a,i,d){if(i=i.updateQueue,i!==null&&(i=i.shared,(d&4194240)!==0)){var g=i.lanes;g&=a.pendingLanes,d|=g,i.lanes=d,dl(a,d)}}function em(a,i){var d=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,d===g)){var x=null,b=null;if(d=d.firstBaseUpdate,d!==null){do{var D={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};b===null?x=b=D:b=b.next=D,d=d.next}while(d!==null);b===null?x=b=i:b=b.next=i}else x=b=i;d={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:b,shared:g.shared,effects:g.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=i:a.next=i,d.lastBaseUpdate=i}function ou(a,i,d,g){var x=a.updateQueue;Da=!1;var b=x.firstBaseUpdate,D=x.lastBaseUpdate,se=x.shared.pending;if(se!==null){x.shared.pending=null;var de=se,Ce=de.next;de.next=null,D===null?b=Ce:D.next=Ce,D=de;var $e=a.alternate;$e!==null&&($e=$e.updateQueue,se=$e.lastBaseUpdate,se!==D&&(se===null?$e.firstBaseUpdate=Ce:se.next=Ce,$e.lastBaseUpdate=de))}if(b!==null){var Ve=x.baseState;D=0,$e=Ce=de=null,se=b;do{var Le=se.lane,Ye=se.eventTime;if((g&Le)===Le){$e!==null&&($e=$e.next={eventTime:Ye,lane:0,tag:se.tag,payload:se.payload,callback:se.callback,next:null});e:{var Ze=a,et=se;switch(Le=i,Ye=d,et.tag){case 1:if(Ze=et.payload,typeof Ze=="function"){Ve=Ze.call(Ye,Ve,Le);break e}Ve=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=et.payload,Le=typeof Ze=="function"?Ze.call(Ye,Ve,Le):Ze,Le==null)break e;Ve=pe({},Ve,Le);break e;case 2:Da=!0}}se.callback!==null&&se.lane!==0&&(a.flags|=64,Le=x.effects,Le===null?x.effects=[se]:Le.push(se))}else Ye={eventTime:Ye,lane:Le,tag:se.tag,payload:se.payload,callback:se.callback,next:null},$e===null?(Ce=$e=Ye,de=Ve):$e=$e.next=Ye,D|=Le;if(se=se.next,se===null){if(se=x.shared.pending,se===null)break;Le=se,se=Le.next,Le.next=null,x.lastBaseUpdate=Le,x.shared.pending=null}}while(!0);if($e===null&&(de=Ve),x.baseState=de,x.firstBaseUpdate=Ce,x.lastBaseUpdate=$e,i=x.shared.interleaved,i!==null){x=i;do D|=x.lane,x=x.next;while(x!==i)}else b===null&&(x.shared.lanes=0);Ri|=D,a.lanes=D,a.memoizedState=Ve}}function tm(a,i,d){if(a=i.effects,i.effects=null,a!==null)for(i=0;i<a.length;i++){var g=a[i],x=g.callback;if(x!==null){if(g.callback=null,g=d,typeof x!="function")throw Error(e(191,x));x.call(g)}}}var Rl={},As=Oa(Rl),Il=Oa(Rl),Ol=Oa(Rl);function Ci(a){if(a===Rl)throw Error(e(174));return a}function u0(a,i){switch(Gt(Ol,i),Gt(Il,a),Gt(As,Rl),a=i.nodeType,a){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Zt(null,"");break;default:a=a===8?i.parentNode:i,i=a.namespaceURI||null,a=a.tagName,i=Zt(i,a)}Qt(As),Gt(As,i)}function No(){Qt(As),Qt(Il),Qt(Ol)}function rm(a){Ci(Ol.current);var i=Ci(As.current),d=Zt(i,a.type);i!==d&&(Gt(Il,a),Gt(As,d))}function d0(a){Il.current===a&&(Qt(As),Qt(Il))}var nr=Oa(0);function lu(a){for(var i=a;i!==null;){if(i.tag===13){var d=i.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var f0=[];function h0(){for(var a=0;a<f0.length;a++)f0[a]._workInProgressVersionPrimary=null;f0.length=0}var cu=M.ReactCurrentDispatcher,m0=M.ReactCurrentBatchConfig,Ai=0,sr=null,br=null,Ar=null,uu=!1,jl=!1,Fl=0,D1=0;function qr(){throw Error(e(321))}function g0(a,i){if(i===null)return!1;for(var d=0;d<i.length&&d<a.length;d++)if(!Ln(a[d],i[d]))return!1;return!0}function p0(a,i,d,g,x,b){if(Ai=b,sr=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,cu.current=a===null||a.memoizedState===null?U1:$1,a=d(g,x),jl){b=0;do{if(jl=!1,Fl=0,25<=b)throw Error(e(301));b+=1,Ar=br=null,i.updateQueue=null,cu.current=B1,a=d(g,x)}while(jl)}if(cu.current=hu,i=br!==null&&br.next!==null,Ai=0,Ar=br=sr=null,uu=!1,i)throw Error(e(300));return a}function x0(){var a=Fl!==0;return Fl=0,a}function Rs(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ar===null?sr.memoizedState=Ar=a:Ar=Ar.next=a,Ar}function Jn(){if(br===null){var a=sr.alternate;a=a!==null?a.memoizedState:null}else a=br.next;var i=Ar===null?sr.memoizedState:Ar.next;if(i!==null)Ar=i,br=a;else{if(a===null)throw Error(e(310));br=a,a={memoizedState:br.memoizedState,baseState:br.baseState,baseQueue:br.baseQueue,queue:br.queue,next:null},Ar===null?sr.memoizedState=Ar=a:Ar=Ar.next=a}return Ar}function Dl(a,i){return typeof i=="function"?i(a):i}function v0(a){var i=Jn(),d=i.queue;if(d===null)throw Error(e(311));d.lastRenderedReducer=a;var g=br,x=g.baseQueue,b=d.pending;if(b!==null){if(x!==null){var D=x.next;x.next=b.next,b.next=D}g.baseQueue=x=b,d.pending=null}if(x!==null){b=x.next,g=g.baseState;var se=D=null,de=null,Ce=b;do{var $e=Ce.lane;if((Ai&$e)===$e)de!==null&&(de=de.next={lane:0,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null}),g=Ce.hasEagerState?Ce.eagerState:a(g,Ce.action);else{var Ve={lane:$e,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null};de===null?(se=de=Ve,D=g):de=de.next=Ve,sr.lanes|=$e,Ri|=$e}Ce=Ce.next}while(Ce!==null&&Ce!==b);de===null?D=g:de.next=se,Ln(g,i.memoizedState)||(Cn=!0),i.memoizedState=g,i.baseState=D,i.baseQueue=de,d.lastRenderedState=g}if(a=d.interleaved,a!==null){x=a;do b=x.lane,sr.lanes|=b,Ri|=b,x=x.next;while(x!==a)}else x===null&&(d.lanes=0);return[i.memoizedState,d.dispatch]}function y0(a){var i=Jn(),d=i.queue;if(d===null)throw Error(e(311));d.lastRenderedReducer=a;var g=d.dispatch,x=d.pending,b=i.memoizedState;if(x!==null){d.pending=null;var D=x=x.next;do b=a(b,D.action),D=D.next;while(D!==x);Ln(b,i.memoizedState)||(Cn=!0),i.memoizedState=b,i.baseQueue===null&&(i.baseState=b),d.lastRenderedState=b}return[b,g]}function nm(){}function sm(a,i){var d=sr,g=Jn(),x=i(),b=!Ln(g.memoizedState,x);if(b&&(g.memoizedState=x,Cn=!0),g=g.queue,w0(om.bind(null,d,g,a),[a]),g.getSnapshot!==i||b||Ar!==null&&Ar.memoizedState.tag&1){if(d.flags|=2048,Pl(9,im.bind(null,d,g,x,i),void 0,null),Rr===null)throw Error(e(349));(Ai&30)!==0||am(d,i,x)}return x}function am(a,i,d){a.flags|=16384,a={getSnapshot:i,value:d},i=sr.updateQueue,i===null?(i={lastEffect:null,stores:null},sr.updateQueue=i,i.stores=[a]):(d=i.stores,d===null?i.stores=[a]:d.push(a))}function im(a,i,d,g){i.value=d,i.getSnapshot=g,lm(i)&&cm(a)}function om(a,i,d){return d(function(){lm(i)&&cm(a)})}function lm(a){var i=a.getSnapshot;a=a.value;try{var d=i();return!Ln(a,d)}catch{return!0}}function cm(a){var i=ra(a,1);i!==null&&ds(i,a,1,-1)}function um(a){var i=Rs();return typeof a=="function"&&(a=a()),i.memoizedState=i.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dl,lastRenderedState:a},i.queue=a,a=a.dispatch=M1.bind(null,sr,a),[i.memoizedState,a]}function Pl(a,i,d,g){return a={tag:a,create:i,destroy:d,deps:g,next:null},i=sr.updateQueue,i===null?(i={lastEffect:null,stores:null},sr.updateQueue=i,i.lastEffect=a.next=a):(d=i.lastEffect,d===null?i.lastEffect=a.next=a:(g=d.next,d.next=a,a.next=g,i.lastEffect=a)),a}function dm(){return Jn().memoizedState}function du(a,i,d,g){var x=Rs();sr.flags|=a,x.memoizedState=Pl(1|i,d,void 0,g===void 0?null:g)}function fu(a,i,d,g){var x=Jn();g=g===void 0?null:g;var b=void 0;if(br!==null){var D=br.memoizedState;if(b=D.destroy,g!==null&&g0(g,D.deps)){x.memoizedState=Pl(i,d,b,g);return}}sr.flags|=a,x.memoizedState=Pl(1|i,d,b,g)}function fm(a,i){return du(8390656,8,a,i)}function w0(a,i){return fu(2048,8,a,i)}function hm(a,i){return fu(4,2,a,i)}function mm(a,i){return fu(4,4,a,i)}function gm(a,i){if(typeof i=="function")return a=a(),i(a),function(){i(null)};if(i!=null)return a=a(),i.current=a,function(){i.current=null}}function pm(a,i,d){return d=d!=null?d.concat([a]):null,fu(4,4,gm.bind(null,i,a),d)}function b0(){}function xm(a,i){var d=Jn();i=i===void 0?null:i;var g=d.memoizedState;return g!==null&&i!==null&&g0(i,g[1])?g[0]:(d.memoizedState=[a,i],a)}function vm(a,i){var d=Jn();i=i===void 0?null:i;var g=d.memoizedState;return g!==null&&i!==null&&g0(i,g[1])?g[0]:(a=a(),d.memoizedState=[a,i],a)}function ym(a,i,d){return(Ai&21)===0?(a.baseState&&(a.baseState=!1,Cn=!0),a.memoizedState=d):(Ln(d,i)||(d=oi(),sr.lanes|=d,Ri|=d,a.baseState=!0),i)}function P1(a,i){var d=Rt;Rt=d!==0&&4>d?d:4,a(!0);var g=m0.transition;m0.transition={};try{a(!1),i()}finally{Rt=d,m0.transition=g}}function wm(){return Jn().memoizedState}function L1(a,i,d){var g=$a(a);if(d={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null},bm(a))_m(i,d);else if(d=Qh(a,i,d,g),d!==null){var x=mn();ds(d,a,g,x),Sm(d,i,g)}}function M1(a,i,d){var g=$a(a),x={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null};if(bm(a))_m(i,x);else{var b=a.alternate;if(a.lanes===0&&(b===null||b.lanes===0)&&(b=i.lastRenderedReducer,b!==null))try{var D=i.lastRenderedState,se=b(D,d);if(x.hasEagerState=!0,x.eagerState=se,Ln(se,D)){var de=i.interleaved;de===null?(x.next=x,l0(i)):(x.next=de.next,de.next=x),i.interleaved=x;return}}catch{}finally{}d=Qh(a,i,x,g),d!==null&&(x=mn(),ds(d,a,g,x),Sm(d,i,g))}}function bm(a){var i=a.alternate;return a===sr||i!==null&&i===sr}function _m(a,i){jl=uu=!0;var d=a.pending;d===null?i.next=i:(i.next=d.next,d.next=i),a.pending=i}function Sm(a,i,d){if((d&4194240)!==0){var g=i.lanes;g&=a.pendingLanes,d|=g,i.lanes=d,dl(a,d)}}var hu={readContext:qn,useCallback:qr,useContext:qr,useEffect:qr,useImperativeHandle:qr,useInsertionEffect:qr,useLayoutEffect:qr,useMemo:qr,useReducer:qr,useRef:qr,useState:qr,useDebugValue:qr,useDeferredValue:qr,useTransition:qr,useMutableSource:qr,useSyncExternalStore:qr,useId:qr,unstable_isNewReconciler:!1},U1={readContext:qn,useCallback:function(a,i){return Rs().memoizedState=[a,i===void 0?null:i],a},useContext:qn,useEffect:fm,useImperativeHandle:function(a,i,d){return d=d!=null?d.concat([a]):null,du(4194308,4,gm.bind(null,i,a),d)},useLayoutEffect:function(a,i){return du(4194308,4,a,i)},useInsertionEffect:function(a,i){return du(4,2,a,i)},useMemo:function(a,i){var d=Rs();return i=i===void 0?null:i,a=a(),d.memoizedState=[a,i],a},useReducer:function(a,i,d){var g=Rs();return i=d!==void 0?d(i):i,g.memoizedState=g.baseState=i,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:i},g.queue=a,a=a.dispatch=L1.bind(null,sr,a),[g.memoizedState,a]},useRef:function(a){var i=Rs();return a={current:a},i.memoizedState=a},useState:um,useDebugValue:b0,useDeferredValue:function(a){return Rs().memoizedState=a},useTransition:function(){var a=um(!1),i=a[0];return a=P1.bind(null,a[1]),Rs().memoizedState=a,[i,a]},useMutableSource:function(){},useSyncExternalStore:function(a,i,d){var g=sr,x=Rs();if(er){if(d===void 0)throw Error(e(407));d=d()}else{if(d=i(),Rr===null)throw Error(e(349));(Ai&30)!==0||am(g,i,d)}x.memoizedState=d;var b={value:d,getSnapshot:i};return x.queue=b,fm(om.bind(null,g,b,a),[a]),g.flags|=2048,Pl(9,im.bind(null,g,b,d,i),void 0,null),d},useId:function(){var a=Rs(),i=Rr.identifierPrefix;if(er){var d=ta,g=ea;d=(g&~(1<<32-rr(g)-1)).toString(32)+d,i=":"+i+"R"+d,d=Fl++,0<d&&(i+="H"+d.toString(32)),i+=":"}else d=D1++,i=":"+i+"r"+d.toString(32)+":";return a.memoizedState=i},unstable_isNewReconciler:!1},$1={readContext:qn,useCallback:xm,useContext:qn,useEffect:w0,useImperativeHandle:pm,useInsertionEffect:hm,useLayoutEffect:mm,useMemo:vm,useReducer:v0,useRef:dm,useState:function(){return v0(Dl)},useDebugValue:b0,useDeferredValue:function(a){var i=Jn();return ym(i,br.memoizedState,a)},useTransition:function(){var a=v0(Dl)[0],i=Jn().memoizedState;return[a,i]},useMutableSource:nm,useSyncExternalStore:sm,useId:wm,unstable_isNewReconciler:!1},B1={readContext:qn,useCallback:xm,useContext:qn,useEffect:w0,useImperativeHandle:pm,useInsertionEffect:hm,useLayoutEffect:mm,useMemo:vm,useReducer:y0,useRef:dm,useState:function(){return y0(Dl)},useDebugValue:b0,useDeferredValue:function(a){var i=Jn();return br===null?i.memoizedState=a:ym(i,br.memoizedState,a)},useTransition:function(){var a=y0(Dl)[0],i=Jn().memoizedState;return[a,i]},useMutableSource:nm,useSyncExternalStore:sm,useId:wm,unstable_isNewReconciler:!1};function ls(a,i){if(a&&a.defaultProps){i=pe({},i),a=a.defaultProps;for(var d in a)i[d]===void 0&&(i[d]=a[d]);return i}return i}function _0(a,i,d,g){i=a.memoizedState,d=d(g,i),d=d==null?i:pe({},i,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var mu={isMounted:function(a){return(a=a._reactInternals)?Z(a)===a:!1},enqueueSetState:function(a,i,d){a=a._reactInternals;var g=mn(),x=$a(a),b=na(g,x);b.payload=i,d!=null&&(b.callback=d),i=Pa(a,b,x),i!==null&&(ds(i,a,x,g),iu(i,a,x))},enqueueReplaceState:function(a,i,d){a=a._reactInternals;var g=mn(),x=$a(a),b=na(g,x);b.tag=1,b.payload=i,d!=null&&(b.callback=d),i=Pa(a,b,x),i!==null&&(ds(i,a,x,g),iu(i,a,x))},enqueueForceUpdate:function(a,i){a=a._reactInternals;var d=mn(),g=$a(a),x=na(d,g);x.tag=2,i!=null&&(x.callback=i),i=Pa(a,x,g),i!==null&&(ds(i,a,g,d),iu(i,a,g))}};function Em(a,i,d,g,x,b,D){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,b,D):i.prototype&&i.prototype.isPureReactComponent?!vi(d,g)||!vi(x,b):!0}function km(a,i,d){var g=!1,x=ja,b=i.contextType;return typeof b=="object"&&b!==null?b=qn(b):(x=Nn(i)?Ei:Xr.current,g=i.contextTypes,b=(g=g!=null)?wo(a,x):ja),i=new i(d,b),a.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=mu,a.stateNode=i,i._reactInternals=a,g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=x,a.__reactInternalMemoizedMaskedChildContext=b),i}function Tm(a,i,d,g){a=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(d,g),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(d,g),i.state!==a&&mu.enqueueReplaceState(i,i.state,null)}function S0(a,i,d,g){var x=a.stateNode;x.props=d,x.state=a.memoizedState,x.refs={},c0(a);var b=i.contextType;typeof b=="object"&&b!==null?x.context=qn(b):(b=Nn(i)?Ei:Xr.current,x.context=wo(a,b)),x.state=a.memoizedState,b=i.getDerivedStateFromProps,typeof b=="function"&&(_0(a,i,b,d),x.state=a.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(i=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),i!==x.state&&mu.enqueueReplaceState(x,x.state,null),ou(a,d,x,g),x.state=a.memoizedState),typeof x.componentDidMount=="function"&&(a.flags|=4194308)}function Co(a,i){try{var d="",g=i;do d+=q(g),g=g.return;while(g);var x=d}catch(b){x=`
Error generating stack: `+b.message+`
`+b.stack}return{value:a,source:i,stack:x,digest:null}}function E0(a,i,d){return{value:a,source:null,stack:d??null,digest:i??null}}function k0(a,i){try{console.error(i.value)}catch(d){setTimeout(function(){throw d})}}var V1=typeof WeakMap=="function"?WeakMap:Map;function Nm(a,i,d){d=na(-1,d),d.tag=3,d.payload={element:null};var g=i.value;return d.callback=function(){bu||(bu=!0,$0=g),k0(a,i)},d}function Cm(a,i,d){d=na(-1,d),d.tag=3;var g=a.type.getDerivedStateFromError;if(typeof g=="function"){var x=i.value;d.payload=function(){return g(x)},d.callback=function(){k0(a,i)}}var b=a.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(d.callback=function(){k0(a,i),typeof g!="function"&&(Ma===null?Ma=new Set([this]):Ma.add(this));var D=i.stack;this.componentDidCatch(i.value,{componentStack:D!==null?D:""})}),d}function Am(a,i,d){var g=a.pingCache;if(g===null){g=a.pingCache=new V1;var x=new Set;g.set(i,x)}else x=g.get(i),x===void 0&&(x=new Set,g.set(i,x));x.has(d)||(x.add(d),a=ry.bind(null,a,i,d),i.then(a,a))}function Rm(a){do{var i;if((i=a.tag===13)&&(i=a.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return a;a=a.return}while(a!==null);return null}function Im(a,i,d,g,x){return(a.mode&1)===0?(a===i?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(i=na(-1,1),i.tag=2,Pa(d,i,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=x,a)}var W1=M.ReactCurrentOwner,Cn=!1;function hn(a,i,d,g){i.child=a===null?Yh(i,null,d,g):Eo(i,a.child,d,g)}function Om(a,i,d,g,x){d=d.render;var b=i.ref;return To(i,x),g=p0(a,i,d,g,b,x),d=x0(),a!==null&&!Cn?(i.updateQueue=a.updateQueue,i.flags&=-2053,a.lanes&=~x,sa(a,i,x)):(er&&d&&Zd(i),i.flags|=1,hn(a,i,g,x),i.child)}function jm(a,i,d,g,x){if(a===null){var b=d.type;return typeof b=="function"&&!K0(b)&&b.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(i.tag=15,i.type=b,Fm(a,i,b,g,x)):(a=Nu(d.type,null,g,i,i.mode,x),a.ref=i.ref,a.return=i,i.child=a)}if(b=a.child,(a.lanes&x)===0){var D=b.memoizedProps;if(d=d.compare,d=d!==null?d:vi,d(D,g)&&a.ref===i.ref)return sa(a,i,x)}return i.flags|=1,a=Va(b,g),a.ref=i.ref,a.return=i,i.child=a}function Fm(a,i,d,g,x){if(a!==null){var b=a.memoizedProps;if(vi(b,g)&&a.ref===i.ref)if(Cn=!1,i.pendingProps=g=b,(a.lanes&x)!==0)(a.flags&131072)!==0&&(Cn=!0);else return i.lanes=a.lanes,sa(a,i,x)}return T0(a,i,d,g,x)}function Dm(a,i,d){var g=i.pendingProps,x=g.children,b=a!==null?a.memoizedState:null;if(g.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Gt(Ro,Bn),Bn|=d;else{if((d&1073741824)===0)return a=b!==null?b.baseLanes|d:d,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:a,cachePool:null,transitions:null},i.updateQueue=null,Gt(Ro,Bn),Bn|=a,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=b!==null?b.baseLanes:d,Gt(Ro,Bn),Bn|=g}else b!==null?(g=b.baseLanes|d,i.memoizedState=null):g=d,Gt(Ro,Bn),Bn|=g;return hn(a,i,x,d),i.child}function Pm(a,i){var d=i.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(i.flags|=512,i.flags|=2097152)}function T0(a,i,d,g,x){var b=Nn(d)?Ei:Xr.current;return b=wo(i,b),To(i,x),d=p0(a,i,d,g,b,x),g=x0(),a!==null&&!Cn?(i.updateQueue=a.updateQueue,i.flags&=-2053,a.lanes&=~x,sa(a,i,x)):(er&&g&&Zd(i),i.flags|=1,hn(a,i,d,x),i.child)}function Lm(a,i,d,g,x){if(Nn(d)){var b=!0;Qc(i)}else b=!1;if(To(i,x),i.stateNode===null)pu(a,i),km(i,d,g),S0(i,d,g,x),g=!0;else if(a===null){var D=i.stateNode,se=i.memoizedProps;D.props=se;var de=D.context,Ce=d.contextType;typeof Ce=="object"&&Ce!==null?Ce=qn(Ce):(Ce=Nn(d)?Ei:Xr.current,Ce=wo(i,Ce));var $e=d.getDerivedStateFromProps,Ve=typeof $e=="function"||typeof D.getSnapshotBeforeUpdate=="function";Ve||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(se!==g||de!==Ce)&&Tm(i,D,g,Ce),Da=!1;var Le=i.memoizedState;D.state=Le,ou(i,g,D,x),de=i.memoizedState,se!==g||Le!==de||Tn.current||Da?(typeof $e=="function"&&(_0(i,d,$e,g),de=i.memoizedState),(se=Da||Em(i,d,se,g,Le,de,Ce))?(Ve||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(i.flags|=4194308)):(typeof D.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=g,i.memoizedState=de),D.props=g,D.state=de,D.context=Ce,g=se):(typeof D.componentDidMount=="function"&&(i.flags|=4194308),g=!1)}else{D=i.stateNode,Zh(a,i),se=i.memoizedProps,Ce=i.type===i.elementType?se:ls(i.type,se),D.props=Ce,Ve=i.pendingProps,Le=D.context,de=d.contextType,typeof de=="object"&&de!==null?de=qn(de):(de=Nn(d)?Ei:Xr.current,de=wo(i,de));var Ye=d.getDerivedStateFromProps;($e=typeof Ye=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(se!==Ve||Le!==de)&&Tm(i,D,g,de),Da=!1,Le=i.memoizedState,D.state=Le,ou(i,g,D,x);var Ze=i.memoizedState;se!==Ve||Le!==Ze||Tn.current||Da?(typeof Ye=="function"&&(_0(i,d,Ye,g),Ze=i.memoizedState),(Ce=Da||Em(i,d,Ce,g,Le,Ze,de)||!1)?($e||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(g,Ze,de),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(g,Ze,de)),typeof D.componentDidUpdate=="function"&&(i.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof D.componentDidUpdate!="function"||se===a.memoizedProps&&Le===a.memoizedState||(i.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||se===a.memoizedProps&&Le===a.memoizedState||(i.flags|=1024),i.memoizedProps=g,i.memoizedState=Ze),D.props=g,D.state=Ze,D.context=de,g=Ce):(typeof D.componentDidUpdate!="function"||se===a.memoizedProps&&Le===a.memoizedState||(i.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||se===a.memoizedProps&&Le===a.memoizedState||(i.flags|=1024),g=!1)}return N0(a,i,d,g,b,x)}function N0(a,i,d,g,x,b){Pm(a,i);var D=(i.flags&128)!==0;if(!g&&!D)return x&&Vh(i,d,!1),sa(a,i,b);g=i.stateNode,W1.current=i;var se=D&&typeof d.getDerivedStateFromError!="function"?null:g.render();return i.flags|=1,a!==null&&D?(i.child=Eo(i,a.child,null,b),i.child=Eo(i,null,se,b)):hn(a,i,se,b),i.memoizedState=g.state,x&&Vh(i,d,!0),i.child}function Mm(a){var i=a.stateNode;i.pendingContext?$h(a,i.pendingContext,i.pendingContext!==i.context):i.context&&$h(a,i.context,!1),u0(a,i.containerInfo)}function Um(a,i,d,g,x){return So(),n0(x),i.flags|=256,hn(a,i,d,g),i.child}var C0={dehydrated:null,treeContext:null,retryLane:0};function A0(a){return{baseLanes:a,cachePool:null,transitions:null}}function $m(a,i,d){var g=i.pendingProps,x=nr.current,b=!1,D=(i.flags&128)!==0,se;if((se=D)||(se=a!==null&&a.memoizedState===null?!1:(x&2)!==0),se?(b=!0,i.flags&=-129):(a===null||a.memoizedState!==null)&&(x|=1),Gt(nr,x&1),a===null)return r0(i),a=i.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((i.mode&1)===0?i.lanes=1:a.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(D=g.children,a=g.fallback,b?(g=i.mode,b=i.child,D={mode:"hidden",children:D},(g&1)===0&&b!==null?(b.childLanes=0,b.pendingProps=D):b=Cu(D,g,0,null),a=Fi(a,g,d,null),b.return=i,a.return=i,b.sibling=a,i.child=b,i.child.memoizedState=A0(d),i.memoizedState=C0,a):R0(i,D));if(x=a.memoizedState,x!==null&&(se=x.dehydrated,se!==null))return H1(a,i,D,g,se,x,d);if(b){b=g.fallback,D=i.mode,x=a.child,se=x.sibling;var de={mode:"hidden",children:g.children};return(D&1)===0&&i.child!==x?(g=i.child,g.childLanes=0,g.pendingProps=de,i.deletions=null):(g=Va(x,de),g.subtreeFlags=x.subtreeFlags&14680064),se!==null?b=Va(se,b):(b=Fi(b,D,d,null),b.flags|=2),b.return=i,g.return=i,g.sibling=b,i.child=g,g=b,b=i.child,D=a.child.memoizedState,D=D===null?A0(d):{baseLanes:D.baseLanes|d,cachePool:null,transitions:D.transitions},b.memoizedState=D,b.childLanes=a.childLanes&~d,i.memoizedState=C0,g}return b=a.child,a=b.sibling,g=Va(b,{mode:"visible",children:g.children}),(i.mode&1)===0&&(g.lanes=d),g.return=i,g.sibling=null,a!==null&&(d=i.deletions,d===null?(i.deletions=[a],i.flags|=16):d.push(a)),i.child=g,i.memoizedState=null,g}function R0(a,i){return i=Cu({mode:"visible",children:i},a.mode,0,null),i.return=a,a.child=i}function gu(a,i,d,g){return g!==null&&n0(g),Eo(i,a.child,null,d),a=R0(i,i.pendingProps.children),a.flags|=2,i.memoizedState=null,a}function H1(a,i,d,g,x,b,D){if(d)return i.flags&256?(i.flags&=-257,g=E0(Error(e(422))),gu(a,i,D,g)):i.memoizedState!==null?(i.child=a.child,i.flags|=128,null):(b=g.fallback,x=i.mode,g=Cu({mode:"visible",children:g.children},x,0,null),b=Fi(b,x,D,null),b.flags|=2,g.return=i,b.return=i,g.sibling=b,i.child=g,(i.mode&1)!==0&&Eo(i,a.child,null,D),i.child.memoizedState=A0(D),i.memoizedState=C0,b);if((i.mode&1)===0)return gu(a,i,D,null);if(x.data==="$!"){if(g=x.nextSibling&&x.nextSibling.dataset,g)var se=g.dgst;return g=se,b=Error(e(419)),g=E0(b,g,void 0),gu(a,i,D,g)}if(se=(D&a.childLanes)!==0,Cn||se){if(g=Rr,g!==null){switch(D&-D){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}x=(x&(g.suspendedLanes|D))!==0?0:x,x!==0&&x!==b.retryLane&&(b.retryLane=x,ra(a,x),ds(g,a,x,-1))}return G0(),g=E0(Error(e(421))),gu(a,i,D,g)}return x.data==="$?"?(i.flags|=128,i.child=a.child,i=ny.bind(null,a),x._reactRetry=i,null):(a=b.treeContext,$n=Ia(x.nextSibling),Un=i,er=!0,os=null,a!==null&&(Kn[Xn++]=ea,Kn[Xn++]=ta,Kn[Xn++]=ki,ea=a.id,ta=a.overflow,ki=i),i=R0(i,g.children),i.flags|=4096,i)}function Bm(a,i,d){a.lanes|=i;var g=a.alternate;g!==null&&(g.lanes|=i),o0(a.return,i,d)}function I0(a,i,d,g,x){var b=a.memoizedState;b===null?a.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:g,tail:d,tailMode:x}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=g,b.tail=d,b.tailMode=x)}function Vm(a,i,d){var g=i.pendingProps,x=g.revealOrder,b=g.tail;if(hn(a,i,g.children,d),g=nr.current,(g&2)!==0)g=g&1|2,i.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=i.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Bm(a,d,i);else if(a.tag===19)Bm(a,d,i);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}if(Gt(nr,g),(i.mode&1)===0)i.memoizedState=null;else switch(x){case"forwards":for(d=i.child,x=null;d!==null;)a=d.alternate,a!==null&&lu(a)===null&&(x=d),d=d.sibling;d=x,d===null?(x=i.child,i.child=null):(x=d.sibling,d.sibling=null),I0(i,!1,x,d,b);break;case"backwards":for(d=null,x=i.child,i.child=null;x!==null;){if(a=x.alternate,a!==null&&lu(a)===null){i.child=x;break}a=x.sibling,x.sibling=d,d=x,x=a}I0(i,!0,d,null,b);break;case"together":I0(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function pu(a,i){(i.mode&1)===0&&a!==null&&(a.alternate=null,i.alternate=null,i.flags|=2)}function sa(a,i,d){if(a!==null&&(i.dependencies=a.dependencies),Ri|=i.lanes,(d&i.childLanes)===0)return null;if(a!==null&&i.child!==a.child)throw Error(e(153));if(i.child!==null){for(a=i.child,d=Va(a,a.pendingProps),i.child=d,d.return=i;a.sibling!==null;)a=a.sibling,d=d.sibling=Va(a,a.pendingProps),d.return=i;d.sibling=null}return i.child}function z1(a,i,d){switch(i.tag){case 3:Mm(i),So();break;case 5:rm(i);break;case 1:Nn(i.type)&&Qc(i);break;case 4:u0(i,i.stateNode.containerInfo);break;case 10:var g=i.type._context,x=i.memoizedProps.value;Gt(su,g._currentValue),g._currentValue=x;break;case 13:if(g=i.memoizedState,g!==null)return g.dehydrated!==null?(Gt(nr,nr.current&1),i.flags|=128,null):(d&i.child.childLanes)!==0?$m(a,i,d):(Gt(nr,nr.current&1),a=sa(a,i,d),a!==null?a.sibling:null);Gt(nr,nr.current&1);break;case 19:if(g=(d&i.childLanes)!==0,(a.flags&128)!==0){if(g)return Vm(a,i,d);i.flags|=128}if(x=i.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Gt(nr,nr.current),g)break;return null;case 22:case 23:return i.lanes=0,Dm(a,i,d)}return sa(a,i,d)}var Wm,O0,Hm,zm;Wm=function(a,i){for(var d=i.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===i)break;for(;d.sibling===null;){if(d.return===null||d.return===i)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},O0=function(){},Hm=function(a,i,d,g){var x=a.memoizedProps;if(x!==g){a=i.stateNode,Ci(As.current);var b=null;switch(d){case"input":x=we(a,x),g=we(a,g),b=[];break;case"select":x=pe({},x,{value:void 0}),g=pe({},g,{value:void 0}),b=[];break;case"textarea":x=Vt(a,x),g=Vt(a,g),b=[];break;default:typeof x.onClick!="function"&&typeof g.onClick=="function"&&(a.onclick=qc)}ws(d,g);var D;d=null;for(Ce in x)if(!g.hasOwnProperty(Ce)&&x.hasOwnProperty(Ce)&&x[Ce]!=null)if(Ce==="style"){var se=x[Ce];for(D in se)se.hasOwnProperty(D)&&(d||(d={}),d[D]="")}else Ce!=="dangerouslySetInnerHTML"&&Ce!=="children"&&Ce!=="suppressContentEditableWarning"&&Ce!=="suppressHydrationWarning"&&Ce!=="autoFocus"&&(s.hasOwnProperty(Ce)?b||(b=[]):(b=b||[]).push(Ce,null));for(Ce in g){var de=g[Ce];if(se=x?.[Ce],g.hasOwnProperty(Ce)&&de!==se&&(de!=null||se!=null))if(Ce==="style")if(se){for(D in se)!se.hasOwnProperty(D)||de&&de.hasOwnProperty(D)||(d||(d={}),d[D]="");for(D in de)de.hasOwnProperty(D)&&se[D]!==de[D]&&(d||(d={}),d[D]=de[D])}else d||(b||(b=[]),b.push(Ce,d)),d=de;else Ce==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,se=se?se.__html:void 0,de!=null&&se!==de&&(b=b||[]).push(Ce,de)):Ce==="children"?typeof de!="string"&&typeof de!="number"||(b=b||[]).push(Ce,""+de):Ce!=="suppressContentEditableWarning"&&Ce!=="suppressHydrationWarning"&&(s.hasOwnProperty(Ce)?(de!=null&&Ce==="onScroll"&&Bt("scroll",a),b||se===de||(b=[])):(b=b||[]).push(Ce,de))}d&&(b=b||[]).push("style",d);var Ce=b;(i.updateQueue=Ce)&&(i.flags|=4)}},zm=function(a,i,d,g){d!==g&&(i.flags|=4)};function Ll(a,i){if(!er)switch(a.tailMode){case"hidden":i=a.tail;for(var d=null;i!==null;)i.alternate!==null&&(d=i),i=i.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?i||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function Jr(a){var i=a.alternate!==null&&a.alternate.child===a.child,d=0,g=0;if(i)for(var x=a.child;x!==null;)d|=x.lanes|x.childLanes,g|=x.subtreeFlags&14680064,g|=x.flags&14680064,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)d|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=g,a.childLanes=d,i}function G1(a,i,d){var g=i.pendingProps;switch(e0(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jr(i),null;case 1:return Nn(i.type)&&Yc(),Jr(i),null;case 3:return g=i.stateNode,No(),Qt(Tn),Qt(Xr),h0(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(a===null||a.child===null)&&(ru(i)?i.flags|=4:a===null||a.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,os!==null&&(W0(os),os=null))),O0(a,i),Jr(i),null;case 5:d0(i);var x=Ci(Ol.current);if(d=i.type,a!==null&&i.stateNode!=null)Hm(a,i,d,g,x),a.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!g){if(i.stateNode===null)throw Error(e(166));return Jr(i),null}if(a=Ci(As.current),ru(i)){g=i.stateNode,d=i.type;var b=i.memoizedProps;switch(g[Cs]=i,g[Nl]=b,a=(i.mode&1)!==0,d){case"dialog":Bt("cancel",g),Bt("close",g);break;case"iframe":case"object":case"embed":Bt("load",g);break;case"video":case"audio":for(x=0;x<jt.length;x++)Bt(jt[x],g);break;case"source":Bt("error",g);break;case"img":case"image":case"link":Bt("error",g),Bt("load",g);break;case"details":Bt("toggle",g);break;case"input":Fe(g,b),Bt("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!b.multiple},Bt("invalid",g);break;case"textarea":kt(g,b),Bt("invalid",g)}ws(d,b),x=null;for(var D in b)if(b.hasOwnProperty(D)){var se=b[D];D==="children"?typeof se=="string"?g.textContent!==se&&(b.suppressHydrationWarning!==!0&&Xc(g.textContent,se,a),x=["children",se]):typeof se=="number"&&g.textContent!==""+se&&(b.suppressHydrationWarning!==!0&&Xc(g.textContent,se,a),x=["children",""+se]):s.hasOwnProperty(D)&&se!=null&&D==="onScroll"&&Bt("scroll",g)}switch(d){case"input":Pe(g),at(g,b,!0);break;case"textarea":Pe(g),At(g);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(g.onclick=qc)}g=x,i.updateQueue=g,g!==null&&(i.flags|=4)}else{D=x.nodeType===9?x:x.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Ht(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=D.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof g.is=="string"?a=D.createElement(d,{is:g.is}):(a=D.createElement(d),d==="select"&&(D=a,g.multiple?D.multiple=!0:g.size&&(D.size=g.size))):a=D.createElementNS(a,d),a[Cs]=i,a[Nl]=g,Wm(a,i,!1,!1),i.stateNode=a;e:{switch(D=vr(d,g),d){case"dialog":Bt("cancel",a),Bt("close",a),x=g;break;case"iframe":case"object":case"embed":Bt("load",a),x=g;break;case"video":case"audio":for(x=0;x<jt.length;x++)Bt(jt[x],a);x=g;break;case"source":Bt("error",a),x=g;break;case"img":case"image":case"link":Bt("error",a),Bt("load",a),x=g;break;case"details":Bt("toggle",a),x=g;break;case"input":Fe(a,g),x=we(a,g),Bt("invalid",a);break;case"option":x=g;break;case"select":a._wrapperState={wasMultiple:!!g.multiple},x=pe({},g,{value:void 0}),Bt("invalid",a);break;case"textarea":kt(a,g),x=Vt(a,g),Bt("invalid",a);break;default:x=g}ws(d,x),se=x;for(b in se)if(se.hasOwnProperty(b)){var de=se[b];b==="style"?on(a,de):b==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,de!=null&&an(a,de)):b==="children"?typeof de=="string"?(d!=="textarea"||de!=="")&&ct(a,de):typeof de=="number"&&ct(a,""+de):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(s.hasOwnProperty(b)?de!=null&&b==="onScroll"&&Bt("scroll",a):de!=null&&C(a,b,de,D))}switch(d){case"input":Pe(a),at(a,g,!1);break;case"textarea":Pe(a),At(a);break;case"option":g.value!=null&&a.setAttribute("value",""+he(g.value));break;case"select":a.multiple=!!g.multiple,b=g.value,b!=null?Et(a,!!g.multiple,b,!1):g.defaultValue!=null&&Et(a,!!g.multiple,g.defaultValue,!0);break;default:typeof x.onClick=="function"&&(a.onclick=qc)}switch(d){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Jr(i),null;case 6:if(a&&i.stateNode!=null)zm(a,i,a.memoizedProps,g);else{if(typeof g!="string"&&i.stateNode===null)throw Error(e(166));if(d=Ci(Ol.current),Ci(As.current),ru(i)){if(g=i.stateNode,d=i.memoizedProps,g[Cs]=i,(b=g.nodeValue!==d)&&(a=Un,a!==null))switch(a.tag){case 3:Xc(g.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Xc(g.nodeValue,d,(a.mode&1)!==0)}b&&(i.flags|=4)}else g=(d.nodeType===9?d:d.ownerDocument).createTextNode(g),g[Cs]=i,i.stateNode=g}return Jr(i),null;case 13:if(Qt(nr),g=i.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(er&&$n!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Xh(),So(),i.flags|=98560,b=!1;else if(b=ru(i),g!==null&&g.dehydrated!==null){if(a===null){if(!b)throw Error(e(318));if(b=i.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(e(317));b[Cs]=i}else So(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Jr(i),b=!1}else os!==null&&(W0(os),os=null),b=!0;if(!b)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=d,i):(g=g!==null,g!==(a!==null&&a.memoizedState!==null)&&g&&(i.child.flags|=8192,(i.mode&1)!==0&&(a===null||(nr.current&1)!==0?_r===0&&(_r=3):G0())),i.updateQueue!==null&&(i.flags|=4),Jr(i),null);case 4:return No(),O0(a,i),a===null&&wi(i.stateNode.containerInfo),Jr(i),null;case 10:return i0(i.type._context),Jr(i),null;case 17:return Nn(i.type)&&Yc(),Jr(i),null;case 19:if(Qt(nr),b=i.memoizedState,b===null)return Jr(i),null;if(g=(i.flags&128)!==0,D=b.rendering,D===null)if(g)Ll(b,!1);else{if(_r!==0||a!==null&&(a.flags&128)!==0)for(a=i.child;a!==null;){if(D=lu(a),D!==null){for(i.flags|=128,Ll(b,!1),g=D.updateQueue,g!==null&&(i.updateQueue=g,i.flags|=4),i.subtreeFlags=0,g=d,d=i.child;d!==null;)b=d,a=g,b.flags&=14680066,D=b.alternate,D===null?(b.childLanes=0,b.lanes=a,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=D.childLanes,b.lanes=D.lanes,b.child=D.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=D.memoizedProps,b.memoizedState=D.memoizedState,b.updateQueue=D.updateQueue,b.type=D.type,a=D.dependencies,b.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return Gt(nr,nr.current&1|2),i.child}a=a.sibling}b.tail!==null&&De()>Io&&(i.flags|=128,g=!0,Ll(b,!1),i.lanes=4194304)}else{if(!g)if(a=lu(D),a!==null){if(i.flags|=128,g=!0,d=a.updateQueue,d!==null&&(i.updateQueue=d,i.flags|=4),Ll(b,!0),b.tail===null&&b.tailMode==="hidden"&&!D.alternate&&!er)return Jr(i),null}else 2*De()-b.renderingStartTime>Io&&d!==1073741824&&(i.flags|=128,g=!0,Ll(b,!1),i.lanes=4194304);b.isBackwards?(D.sibling=i.child,i.child=D):(d=b.last,d!==null?d.sibling=D:i.child=D,b.last=D)}return b.tail!==null?(i=b.tail,b.rendering=i,b.tail=i.sibling,b.renderingStartTime=De(),i.sibling=null,d=nr.current,Gt(nr,g?d&1|2:d&1),i):(Jr(i),null);case 22:case 23:return z0(),g=i.memoizedState!==null,a!==null&&a.memoizedState!==null!==g&&(i.flags|=8192),g&&(i.mode&1)!==0?(Bn&1073741824)!==0&&(Jr(i),i.subtreeFlags&6&&(i.flags|=8192)):Jr(i),null;case 24:return null;case 25:return null}throw Error(e(156,i.tag))}function K1(a,i){switch(e0(i),i.tag){case 1:return Nn(i.type)&&Yc(),a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 3:return No(),Qt(Tn),Qt(Xr),h0(),a=i.flags,(a&65536)!==0&&(a&128)===0?(i.flags=a&-65537|128,i):null;case 5:return d0(i),null;case 13:if(Qt(nr),a=i.memoizedState,a!==null&&a.dehydrated!==null){if(i.alternate===null)throw Error(e(340));So()}return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 19:return Qt(nr),null;case 4:return No(),null;case 10:return i0(i.type._context),null;case 22:case 23:return z0(),null;case 24:return null;default:return null}}var xu=!1,Yr=!1,X1=typeof WeakSet=="function"?WeakSet:Set,Qe=null;function Ao(a,i){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(g){ir(a,i,g)}else d.current=null}function j0(a,i,d){try{d()}catch(g){ir(a,i,g)}}var Gm=!1;function q1(a,i){if(zd=ba,a=kl(),Ys(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var g=d.getSelection&&d.getSelection();if(g&&g.rangeCount!==0){d=g.anchorNode;var x=g.anchorOffset,b=g.focusNode;g=g.focusOffset;try{d.nodeType,b.nodeType}catch{d=null;break e}var D=0,se=-1,de=-1,Ce=0,$e=0,Ve=a,Le=null;t:for(;;){for(var Ye;Ve!==d||x!==0&&Ve.nodeType!==3||(se=D+x),Ve!==b||g!==0&&Ve.nodeType!==3||(de=D+g),Ve.nodeType===3&&(D+=Ve.nodeValue.length),(Ye=Ve.firstChild)!==null;)Le=Ve,Ve=Ye;for(;;){if(Ve===a)break t;if(Le===d&&++Ce===x&&(se=D),Le===b&&++$e===g&&(de=D),(Ye=Ve.nextSibling)!==null)break;Ve=Le,Le=Ve.parentNode}Ve=Ye}d=se===-1||de===-1?null:{start:se,end:de}}else d=null}d=d||{start:0,end:0}}else d=null;for(Gd={focusedElem:a,selectionRange:d},ba=!1,Qe=i;Qe!==null;)if(i=Qe,a=i.child,(i.subtreeFlags&1028)!==0&&a!==null)a.return=i,Qe=a;else for(;Qe!==null;){i=Qe;try{var Ze=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Ze!==null){var et=Ze.memoizedProps,cr=Ze.memoizedState,ye=i.stateNode,ge=ye.getSnapshotBeforeUpdate(i.elementType===i.type?et:ls(i.type,et),cr);ye.__reactInternalSnapshotBeforeUpdate=ge}break;case 3:var Se=i.stateNode.containerInfo;Se.nodeType===1?Se.textContent="":Se.nodeType===9&&Se.documentElement&&Se.removeChild(Se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(e(163))}}catch(ze){ir(i,i.return,ze)}if(a=i.sibling,a!==null){a.return=i.return,Qe=a;break}Qe=i.return}return Ze=Gm,Gm=!1,Ze}function Ml(a,i,d){var g=i.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var x=g=g.next;do{if((x.tag&a)===a){var b=x.destroy;x.destroy=void 0,b!==void 0&&j0(i,d,b)}x=x.next}while(x!==g)}}function vu(a,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var d=i=i.next;do{if((d.tag&a)===a){var g=d.create;d.destroy=g()}d=d.next}while(d!==i)}}function F0(a){var i=a.ref;if(i!==null){var d=a.stateNode;switch(a.tag){case 5:a=d;break;default:a=d}typeof i=="function"?i(a):i.current=a}}function Km(a){var i=a.alternate;i!==null&&(a.alternate=null,Km(i)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(i=a.stateNode,i!==null&&(delete i[Cs],delete i[Nl],delete i[Jd],delete i[I1],delete i[O1])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function Xm(a){return a.tag===5||a.tag===3||a.tag===4}function qm(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Xm(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function D0(a,i,d){var g=a.tag;if(g===5||g===6)a=a.stateNode,i?d.nodeType===8?d.parentNode.insertBefore(a,i):d.insertBefore(a,i):(d.nodeType===8?(i=d.parentNode,i.insertBefore(a,d)):(i=d,i.appendChild(a)),d=d._reactRootContainer,d!=null||i.onclick!==null||(i.onclick=qc));else if(g!==4&&(a=a.child,a!==null))for(D0(a,i,d),a=a.sibling;a!==null;)D0(a,i,d),a=a.sibling}function P0(a,i,d){var g=a.tag;if(g===5||g===6)a=a.stateNode,i?d.insertBefore(a,i):d.appendChild(a);else if(g!==4&&(a=a.child,a!==null))for(P0(a,i,d),a=a.sibling;a!==null;)P0(a,i,d),a=a.sibling}var $r=null,cs=!1;function La(a,i,d){for(d=d.child;d!==null;)Jm(a,i,d),d=d.sibling}function Jm(a,i,d){if(dr&&typeof dr.onCommitFiberUnmount=="function")try{dr.onCommitFiberUnmount(Dn,d)}catch{}switch(d.tag){case 5:Yr||Ao(d,i);case 6:var g=$r,x=cs;$r=null,La(a,i,d),$r=g,cs=x,$r!==null&&(cs?(a=$r,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):$r.removeChild(d.stateNode));break;case 18:$r!==null&&(cs?(a=$r,d=d.stateNode,a.nodeType===8?qd(a.parentNode,d):a.nodeType===1&&qd(a,d),di(a)):qd($r,d.stateNode));break;case 4:g=$r,x=cs,$r=d.stateNode.containerInfo,cs=!0,La(a,i,d),$r=g,cs=x;break;case 0:case 11:case 14:case 15:if(!Yr&&(g=d.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){x=g=g.next;do{var b=x,D=b.destroy;b=b.tag,D!==void 0&&((b&2)!==0||(b&4)!==0)&&j0(d,i,D),x=x.next}while(x!==g)}La(a,i,d);break;case 1:if(!Yr&&(Ao(d,i),g=d.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=d.memoizedProps,g.state=d.memoizedState,g.componentWillUnmount()}catch(se){ir(d,i,se)}La(a,i,d);break;case 21:La(a,i,d);break;case 22:d.mode&1?(Yr=(g=Yr)||d.memoizedState!==null,La(a,i,d),Yr=g):La(a,i,d);break;default:La(a,i,d)}}function Ym(a){var i=a.updateQueue;if(i!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new X1),i.forEach(function(g){var x=sy.bind(null,a,g);d.has(g)||(d.add(g),g.then(x,x))})}}function us(a,i){var d=i.deletions;if(d!==null)for(var g=0;g<d.length;g++){var x=d[g];try{var b=a,D=i,se=D;e:for(;se!==null;){switch(se.tag){case 5:$r=se.stateNode,cs=!1;break e;case 3:$r=se.stateNode.containerInfo,cs=!0;break e;case 4:$r=se.stateNode.containerInfo,cs=!0;break e}se=se.return}if($r===null)throw Error(e(160));Jm(b,D,x),$r=null,cs=!1;var de=x.alternate;de!==null&&(de.return=null),x.return=null}catch(Ce){ir(x,i,Ce)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Qm(i,a),i=i.sibling}function Qm(a,i){var d=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(us(i,a),Is(a),g&4){try{Ml(3,a,a.return),vu(3,a)}catch(et){ir(a,a.return,et)}try{Ml(5,a,a.return)}catch(et){ir(a,a.return,et)}}break;case 1:us(i,a),Is(a),g&512&&d!==null&&Ao(d,d.return);break;case 5:if(us(i,a),Is(a),g&512&&d!==null&&Ao(d,d.return),a.flags&32){var x=a.stateNode;try{ct(x,"")}catch(et){ir(a,a.return,et)}}if(g&4&&(x=a.stateNode,x!=null)){var b=a.memoizedProps,D=d!==null?d.memoizedProps:b,se=a.type,de=a.updateQueue;if(a.updateQueue=null,de!==null)try{se==="input"&&b.type==="radio"&&b.name!=null&&Oe(x,b),vr(se,D);var Ce=vr(se,b);for(D=0;D<de.length;D+=2){var $e=de[D],Ve=de[D+1];$e==="style"?on(x,Ve):$e==="dangerouslySetInnerHTML"?an(x,Ve):$e==="children"?ct(x,Ve):C(x,$e,Ve,Ce)}switch(se){case"input":Ae(x,b);break;case"textarea":Ct(x,b);break;case"select":var Le=x._wrapperState.wasMultiple;x._wrapperState.wasMultiple=!!b.multiple;var Ye=b.value;Ye!=null?Et(x,!!b.multiple,Ye,!1):Le!==!!b.multiple&&(b.defaultValue!=null?Et(x,!!b.multiple,b.defaultValue,!0):Et(x,!!b.multiple,b.multiple?[]:"",!1))}x[Nl]=b}catch(et){ir(a,a.return,et)}}break;case 6:if(us(i,a),Is(a),g&4){if(a.stateNode===null)throw Error(e(162));x=a.stateNode,b=a.memoizedProps;try{x.nodeValue=b}catch(et){ir(a,a.return,et)}}break;case 3:if(us(i,a),Is(a),g&4&&d!==null&&d.memoizedState.isDehydrated)try{di(i.containerInfo)}catch(et){ir(a,a.return,et)}break;case 4:us(i,a),Is(a);break;case 13:us(i,a),Is(a),x=a.child,x.flags&8192&&(b=x.memoizedState!==null,x.stateNode.isHidden=b,!b||x.alternate!==null&&x.alternate.memoizedState!==null||(U0=De())),g&4&&Ym(a);break;case 22:if($e=d!==null&&d.memoizedState!==null,a.mode&1?(Yr=(Ce=Yr)||$e,us(i,a),Yr=Ce):us(i,a),Is(a),g&8192){if(Ce=a.memoizedState!==null,(a.stateNode.isHidden=Ce)&&!$e&&(a.mode&1)!==0)for(Qe=a,$e=a.child;$e!==null;){for(Ve=Qe=$e;Qe!==null;){switch(Le=Qe,Ye=Le.child,Le.tag){case 0:case 11:case 14:case 15:Ml(4,Le,Le.return);break;case 1:Ao(Le,Le.return);var Ze=Le.stateNode;if(typeof Ze.componentWillUnmount=="function"){g=Le,d=Le.return;try{i=g,Ze.props=i.memoizedProps,Ze.state=i.memoizedState,Ze.componentWillUnmount()}catch(et){ir(g,d,et)}}break;case 5:Ao(Le,Le.return);break;case 22:if(Le.memoizedState!==null){tg(Ve);continue}}Ye!==null?(Ye.return=Le,Qe=Ye):tg(Ve)}$e=$e.sibling}e:for($e=null,Ve=a;;){if(Ve.tag===5){if($e===null){$e=Ve;try{x=Ve.stateNode,Ce?(b=x.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(se=Ve.stateNode,de=Ve.memoizedProps.style,D=de!=null&&de.hasOwnProperty("display")?de.display:null,se.style.display=Wt("display",D))}catch(et){ir(a,a.return,et)}}}else if(Ve.tag===6){if($e===null)try{Ve.stateNode.nodeValue=Ce?"":Ve.memoizedProps}catch(et){ir(a,a.return,et)}}else if((Ve.tag!==22&&Ve.tag!==23||Ve.memoizedState===null||Ve===a)&&Ve.child!==null){Ve.child.return=Ve,Ve=Ve.child;continue}if(Ve===a)break e;for(;Ve.sibling===null;){if(Ve.return===null||Ve.return===a)break e;$e===Ve&&($e=null),Ve=Ve.return}$e===Ve&&($e=null),Ve.sibling.return=Ve.return,Ve=Ve.sibling}}break;case 19:us(i,a),Is(a),g&4&&Ym(a);break;case 21:break;default:us(i,a),Is(a)}}function Is(a){var i=a.flags;if(i&2){try{e:{for(var d=a.return;d!==null;){if(Xm(d)){var g=d;break e}d=d.return}throw Error(e(160))}switch(g.tag){case 5:var x=g.stateNode;g.flags&32&&(ct(x,""),g.flags&=-33);var b=qm(a);P0(a,b,x);break;case 3:case 4:var D=g.stateNode.containerInfo,se=qm(a);D0(a,se,D);break;default:throw Error(e(161))}}catch(de){ir(a,a.return,de)}a.flags&=-3}i&4096&&(a.flags&=-4097)}function J1(a,i,d){Qe=a,Zm(a)}function Zm(a,i,d){for(var g=(a.mode&1)!==0;Qe!==null;){var x=Qe,b=x.child;if(x.tag===22&&g){var D=x.memoizedState!==null||xu;if(!D){var se=x.alternate,de=se!==null&&se.memoizedState!==null||Yr;se=xu;var Ce=Yr;if(xu=D,(Yr=de)&&!Ce)for(Qe=x;Qe!==null;)D=Qe,de=D.child,D.tag===22&&D.memoizedState!==null?rg(x):de!==null?(de.return=D,Qe=de):rg(x);for(;b!==null;)Qe=b,Zm(b),b=b.sibling;Qe=x,xu=se,Yr=Ce}eg(a)}else(x.subtreeFlags&8772)!==0&&b!==null?(b.return=x,Qe=b):eg(a)}}function eg(a){for(;Qe!==null;){var i=Qe;if((i.flags&8772)!==0){var d=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Yr||vu(5,i);break;case 1:var g=i.stateNode;if(i.flags&4&&!Yr)if(d===null)g.componentDidMount();else{var x=i.elementType===i.type?d.memoizedProps:ls(i.type,d.memoizedProps);g.componentDidUpdate(x,d.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var b=i.updateQueue;b!==null&&tm(i,b,g);break;case 3:var D=i.updateQueue;if(D!==null){if(d=null,i.child!==null)switch(i.child.tag){case 5:d=i.child.stateNode;break;case 1:d=i.child.stateNode}tm(i,D,d)}break;case 5:var se=i.stateNode;if(d===null&&i.flags&4){d=se;var de=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":de.autoFocus&&d.focus();break;case"img":de.src&&(d.src=de.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var Ce=i.alternate;if(Ce!==null){var $e=Ce.memoizedState;if($e!==null){var Ve=$e.dehydrated;Ve!==null&&di(Ve)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(e(163))}Yr||i.flags&512&&F0(i)}catch(Le){ir(i,i.return,Le)}}if(i===a){Qe=null;break}if(d=i.sibling,d!==null){d.return=i.return,Qe=d;break}Qe=i.return}}function tg(a){for(;Qe!==null;){var i=Qe;if(i===a){Qe=null;break}var d=i.sibling;if(d!==null){d.return=i.return,Qe=d;break}Qe=i.return}}function rg(a){for(;Qe!==null;){var i=Qe;try{switch(i.tag){case 0:case 11:case 15:var d=i.return;try{vu(4,i)}catch(de){ir(i,d,de)}break;case 1:var g=i.stateNode;if(typeof g.componentDidMount=="function"){var x=i.return;try{g.componentDidMount()}catch(de){ir(i,x,de)}}var b=i.return;try{F0(i)}catch(de){ir(i,b,de)}break;case 5:var D=i.return;try{F0(i)}catch(de){ir(i,D,de)}}}catch(de){ir(i,i.return,de)}if(i===a){Qe=null;break}var se=i.sibling;if(se!==null){se.return=i.return,Qe=se;break}Qe=i.return}}var Y1=Math.ceil,yu=M.ReactCurrentDispatcher,L0=M.ReactCurrentOwner,Yn=M.ReactCurrentBatchConfig,It=0,Rr=null,mr=null,Br=0,Bn=0,Ro=Oa(0),_r=0,Ul=null,Ri=0,wu=0,M0=0,$l=null,An=null,U0=0,Io=1/0,aa=null,bu=!1,$0=null,Ma=null,_u=!1,Ua=null,Su=0,Bl=0,B0=null,Eu=-1,ku=0;function mn(){return(It&6)!==0?De():Eu!==-1?Eu:Eu=De()}function $a(a){return(a.mode&1)===0?1:(It&2)!==0&&Br!==0?Br&-Br:F1.transition!==null?(ku===0&&(ku=oi()),ku):(a=Rt,a!==0||(a=window.event,a=a===void 0?16:Gs(a.type)),a)}function ds(a,i,d,g){if(50<Bl)throw Bl=0,B0=null,Error(e(185));va(a,d,g),((It&2)===0||a!==Rr)&&(a===Rr&&((It&2)===0&&(wu|=d),_r===4&&Ba(a,Br)),Rn(a,g),d===1&&It===0&&(i.mode&1)===0&&(Io=De()+500,Zc&&Fa()))}function Rn(a,i){var d=a.callbackNode;cl(a,i);var g=ii(a,a===Rr?Br:0);if(g===0)d!==null&&He(d),a.callbackNode=null,a.callbackPriority=0;else if(i=g&-g,a.callbackPriority!==i){if(d!=null&&He(d),i===1)a.tag===0?j1(sg.bind(null,a)):Wh(sg.bind(null,a)),A1(function(){(It&6)===0&&Fa()}),d=null;else{switch(Ic(g)){case 1:d=Mt;break;case 4:d=Dt;break;case 16:d=Ut;break;case 536870912:d=as;break;default:d=Ut}d=fg(d,ng.bind(null,a))}a.callbackPriority=i,a.callbackNode=d}}function ng(a,i){if(Eu=-1,ku=0,(It&6)!==0)throw Error(e(327));var d=a.callbackNode;if(Oo()&&a.callbackNode!==d)return null;var g=ii(a,a===Rr?Br:0);if(g===0)return null;if((g&30)!==0||(g&a.expiredLanes)!==0||i)i=Tu(a,g);else{i=g;var x=It;It|=2;var b=ig();(Rr!==a||Br!==i)&&(aa=null,Io=De()+500,Oi(a,i));do try{ey();break}catch(se){ag(a,se)}while(!0);a0(),yu.current=b,It=x,mr!==null?i=0:(Rr=null,Br=0,i=_r)}if(i!==0){if(i===2&&(x=ul(a),x!==0&&(g=x,i=V0(a,x))),i===1)throw d=Ul,Oi(a,0),Ba(a,g),Rn(a,De()),d;if(i===6)Ba(a,g);else{if(x=a.current.alternate,(g&30)===0&&!Q1(x)&&(i=Tu(a,g),i===2&&(b=ul(a),b!==0&&(g=b,i=V0(a,b))),i===1))throw d=Ul,Oi(a,0),Ba(a,g),Rn(a,De()),d;switch(a.finishedWork=x,a.finishedLanes=g,i){case 0:case 1:throw Error(e(345));case 2:ji(a,An,aa);break;case 3:if(Ba(a,g),(g&130023424)===g&&(i=U0+500-De(),10<i)){if(ii(a,0)!==0)break;if(x=a.suspendedLanes,(x&g)!==g){mn(),a.pingedLanes|=a.suspendedLanes&x;break}a.timeoutHandle=Xd(ji.bind(null,a,An,aa),i);break}ji(a,An,aa);break;case 4:if(Ba(a,g),(g&4194240)===g)break;for(i=a.eventTimes,x=-1;0<g;){var D=31-rr(g);b=1<<D,D=i[D],D>x&&(x=D),g&=~b}if(g=x,g=De()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*Y1(g/1960))-g,10<g){a.timeoutHandle=Xd(ji.bind(null,a,An,aa),g);break}ji(a,An,aa);break;case 5:ji(a,An,aa);break;default:throw Error(e(329))}}}return Rn(a,De()),a.callbackNode===d?ng.bind(null,a):null}function V0(a,i){var d=$l;return a.current.memoizedState.isDehydrated&&(Oi(a,i).flags|=256),a=Tu(a,i),a!==2&&(i=An,An=d,i!==null&&W0(i)),a}function W0(a){An===null?An=a:An.push.apply(An,a)}function Q1(a){for(var i=a;;){if(i.flags&16384){var d=i.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var g=0;g<d.length;g++){var x=d[g],b=x.getSnapshot;x=x.value;try{if(!Ln(b(),x))return!1}catch{return!1}}}if(d=i.child,i.subtreeFlags&16384&&d!==null)d.return=i,i=d;else{if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ba(a,i){for(i&=~M0,i&=~wu,a.suspendedLanes|=i,a.pingedLanes&=~i,a=a.expirationTimes;0<i;){var d=31-rr(i),g=1<<d;a[d]=-1,i&=~g}}function sg(a){if((It&6)!==0)throw Error(e(327));Oo();var i=ii(a,0);if((i&1)===0)return Rn(a,De()),null;var d=Tu(a,i);if(a.tag!==0&&d===2){var g=ul(a);g!==0&&(i=g,d=V0(a,g))}if(d===1)throw d=Ul,Oi(a,0),Ba(a,i),Rn(a,De()),d;if(d===6)throw Error(e(345));return a.finishedWork=a.current.alternate,a.finishedLanes=i,ji(a,An,aa),Rn(a,De()),null}function H0(a,i){var d=It;It|=1;try{return a(i)}finally{It=d,It===0&&(Io=De()+500,Zc&&Fa())}}function Ii(a){Ua!==null&&Ua.tag===0&&(It&6)===0&&Oo();var i=It;It|=1;var d=Yn.transition,g=Rt;try{if(Yn.transition=null,Rt=1,a)return a()}finally{Rt=g,Yn.transition=d,It=i,(It&6)===0&&Fa()}}function z0(){Bn=Ro.current,Qt(Ro)}function Oi(a,i){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,C1(d)),mr!==null)for(d=mr.return;d!==null;){var g=d;switch(e0(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Yc();break;case 3:No(),Qt(Tn),Qt(Xr),h0();break;case 5:d0(g);break;case 4:No();break;case 13:Qt(nr);break;case 19:Qt(nr);break;case 10:i0(g.type._context);break;case 22:case 23:z0()}d=d.return}if(Rr=a,mr=a=Va(a.current,null),Br=Bn=i,_r=0,Ul=null,M0=wu=Ri=0,An=$l=null,Ni!==null){for(i=0;i<Ni.length;i++)if(d=Ni[i],g=d.interleaved,g!==null){d.interleaved=null;var x=g.next,b=d.pending;if(b!==null){var D=b.next;b.next=x,g.next=D}d.pending=g}Ni=null}return a}function ag(a,i){do{var d=mr;try{if(a0(),cu.current=hu,uu){for(var g=sr.memoizedState;g!==null;){var x=g.queue;x!==null&&(x.pending=null),g=g.next}uu=!1}if(Ai=0,Ar=br=sr=null,jl=!1,Fl=0,L0.current=null,d===null||d.return===null){_r=1,Ul=i,mr=null;break}e:{var b=a,D=d.return,se=d,de=i;if(i=Br,se.flags|=32768,de!==null&&typeof de=="object"&&typeof de.then=="function"){var Ce=de,$e=se,Ve=$e.tag;if(($e.mode&1)===0&&(Ve===0||Ve===11||Ve===15)){var Le=$e.alternate;Le?($e.updateQueue=Le.updateQueue,$e.memoizedState=Le.memoizedState,$e.lanes=Le.lanes):($e.updateQueue=null,$e.memoizedState=null)}var Ye=Rm(D);if(Ye!==null){Ye.flags&=-257,Im(Ye,D,se,b,i),Ye.mode&1&&Am(b,Ce,i),i=Ye,de=Ce;var Ze=i.updateQueue;if(Ze===null){var et=new Set;et.add(de),i.updateQueue=et}else Ze.add(de);break e}else{if((i&1)===0){Am(b,Ce,i),G0();break e}de=Error(e(426))}}else if(er&&se.mode&1){var cr=Rm(D);if(cr!==null){(cr.flags&65536)===0&&(cr.flags|=256),Im(cr,D,se,b,i),n0(Co(de,se));break e}}b=de=Co(de,se),_r!==4&&(_r=2),$l===null?$l=[b]:$l.push(b),b=D;do{switch(b.tag){case 3:b.flags|=65536,i&=-i,b.lanes|=i;var ye=Nm(b,de,i);em(b,ye);break e;case 1:se=de;var ge=b.type,Se=b.stateNode;if((b.flags&128)===0&&(typeof ge.getDerivedStateFromError=="function"||Se!==null&&typeof Se.componentDidCatch=="function"&&(Ma===null||!Ma.has(Se)))){b.flags|=65536,i&=-i,b.lanes|=i;var ze=Cm(b,se,i);em(b,ze);break e}}b=b.return}while(b!==null)}lg(d)}catch(tt){i=tt,mr===d&&d!==null&&(mr=d=d.return);continue}break}while(!0)}function ig(){var a=yu.current;return yu.current=hu,a===null?hu:a}function G0(){(_r===0||_r===3||_r===2)&&(_r=4),Rr===null||(Ri&268435455)===0&&(wu&268435455)===0||Ba(Rr,Br)}function Tu(a,i){var d=It;It|=2;var g=ig();(Rr!==a||Br!==i)&&(aa=null,Oi(a,i));do try{Z1();break}catch(x){ag(a,x)}while(!0);if(a0(),It=d,yu.current=g,mr!==null)throw Error(e(261));return Rr=null,Br=0,_r}function Z1(){for(;mr!==null;)og(mr)}function ey(){for(;mr!==null&&!Je();)og(mr)}function og(a){var i=dg(a.alternate,a,Bn);a.memoizedProps=a.pendingProps,i===null?lg(a):mr=i,L0.current=null}function lg(a){var i=a;do{var d=i.alternate;if(a=i.return,(i.flags&32768)===0){if(d=G1(d,i,Bn),d!==null){mr=d;return}}else{if(d=K1(d,i),d!==null){d.flags&=32767,mr=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{_r=6,mr=null;return}}if(i=i.sibling,i!==null){mr=i;return}mr=i=a}while(i!==null);_r===0&&(_r=5)}function ji(a,i,d){var g=Rt,x=Yn.transition;try{Yn.transition=null,Rt=1,ty(a,i,d,g)}finally{Yn.transition=x,Rt=g}return null}function ty(a,i,d,g){do Oo();while(Ua!==null);if((It&6)!==0)throw Error(e(327));d=a.finishedWork;var x=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(e(177));a.callbackNode=null,a.callbackPriority=0;var b=d.lanes|d.childLanes;if(Vs(a,b),a===Rr&&(mr=Rr=null,Br=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||_u||(_u=!0,fg(Ut,function(){return Oo(),null})),b=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||b){b=Yn.transition,Yn.transition=null;var D=Rt;Rt=1;var se=It;It|=4,L0.current=null,q1(a,d),Qm(d,a),Wd(Gd),ba=!!zd,Gd=zd=null,a.current=d,J1(d),Me(),It=se,Rt=D,Yn.transition=b}else a.current=d;if(_u&&(_u=!1,Ua=a,Su=x),b=a.pendingLanes,b===0&&(Ma=null),Bs(d.stateNode),Rn(a,De()),i!==null)for(g=a.onRecoverableError,d=0;d<i.length;d++)x=i[d],g(x.value,{componentStack:x.stack,digest:x.digest});if(bu)throw bu=!1,a=$0,$0=null,a;return(Su&1)!==0&&a.tag!==0&&Oo(),b=a.pendingLanes,(b&1)!==0?a===B0?Bl++:(Bl=0,B0=a):Bl=0,Fa(),null}function Oo(){if(Ua!==null){var a=Ic(Su),i=Yn.transition,d=Rt;try{if(Yn.transition=null,Rt=16>a?16:a,Ua===null)var g=!1;else{if(a=Ua,Ua=null,Su=0,(It&6)!==0)throw Error(e(331));var x=It;for(It|=4,Qe=a.current;Qe!==null;){var b=Qe,D=b.child;if((Qe.flags&16)!==0){var se=b.deletions;if(se!==null){for(var de=0;de<se.length;de++){var Ce=se[de];for(Qe=Ce;Qe!==null;){var $e=Qe;switch($e.tag){case 0:case 11:case 15:Ml(8,$e,b)}var Ve=$e.child;if(Ve!==null)Ve.return=$e,Qe=Ve;else for(;Qe!==null;){$e=Qe;var Le=$e.sibling,Ye=$e.return;if(Km($e),$e===Ce){Qe=null;break}if(Le!==null){Le.return=Ye,Qe=Le;break}Qe=Ye}}}var Ze=b.alternate;if(Ze!==null){var et=Ze.child;if(et!==null){Ze.child=null;do{var cr=et.sibling;et.sibling=null,et=cr}while(et!==null)}}Qe=b}}if((b.subtreeFlags&2064)!==0&&D!==null)D.return=b,Qe=D;else e:for(;Qe!==null;){if(b=Qe,(b.flags&2048)!==0)switch(b.tag){case 0:case 11:case 15:Ml(9,b,b.return)}var ye=b.sibling;if(ye!==null){ye.return=b.return,Qe=ye;break e}Qe=b.return}}var ge=a.current;for(Qe=ge;Qe!==null;){D=Qe;var Se=D.child;if((D.subtreeFlags&2064)!==0&&Se!==null)Se.return=D,Qe=Se;else e:for(D=ge;Qe!==null;){if(se=Qe,(se.flags&2048)!==0)try{switch(se.tag){case 0:case 11:case 15:vu(9,se)}}catch(tt){ir(se,se.return,tt)}if(se===D){Qe=null;break e}var ze=se.sibling;if(ze!==null){ze.return=se.return,Qe=ze;break e}Qe=se.return}}if(It=x,Fa(),dr&&typeof dr.onPostCommitFiberRoot=="function")try{dr.onPostCommitFiberRoot(Dn,a)}catch{}g=!0}return g}finally{Rt=d,Yn.transition=i}}return!1}function cg(a,i,d){i=Co(d,i),i=Nm(a,i,1),a=Pa(a,i,1),i=mn(),a!==null&&(va(a,1,i),Rn(a,i))}function ir(a,i,d){if(a.tag===3)cg(a,a,d);else for(;i!==null;){if(i.tag===3){cg(i,a,d);break}else if(i.tag===1){var g=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Ma===null||!Ma.has(g))){a=Co(d,a),a=Cm(i,a,1),i=Pa(i,a,1),a=mn(),i!==null&&(va(i,1,a),Rn(i,a));break}}i=i.return}}function ry(a,i,d){var g=a.pingCache;g!==null&&g.delete(i),i=mn(),a.pingedLanes|=a.suspendedLanes&d,Rr===a&&(Br&d)===d&&(_r===4||_r===3&&(Br&130023424)===Br&&500>De()-U0?Oi(a,0):M0|=d),Rn(a,i)}function ug(a,i){i===0&&((a.mode&1)===0?i=1:(i=ai,ai<<=1,(ai&130023424)===0&&(ai=4194304)));var d=mn();a=ra(a,i),a!==null&&(va(a,i,d),Rn(a,d))}function ny(a){var i=a.memoizedState,d=0;i!==null&&(d=i.retryLane),ug(a,d)}function sy(a,i){var d=0;switch(a.tag){case 13:var g=a.stateNode,x=a.memoizedState;x!==null&&(d=x.retryLane);break;case 19:g=a.stateNode;break;default:throw Error(e(314))}g!==null&&g.delete(i),ug(a,d)}var dg;dg=function(a,i,d){if(a!==null)if(a.memoizedProps!==i.pendingProps||Tn.current)Cn=!0;else{if((a.lanes&d)===0&&(i.flags&128)===0)return Cn=!1,z1(a,i,d);Cn=(a.flags&131072)!==0}else Cn=!1,er&&(i.flags&1048576)!==0&&Hh(i,tu,i.index);switch(i.lanes=0,i.tag){case 2:var g=i.type;pu(a,i),a=i.pendingProps;var x=wo(i,Xr.current);To(i,d),x=p0(null,i,g,a,x,d);var b=x0();return i.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Nn(g)?(b=!0,Qc(i)):b=!1,i.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,c0(i),x.updater=mu,i.stateNode=x,x._reactInternals=i,S0(i,g,a,d),i=N0(null,i,g,!0,b,d)):(i.tag=0,er&&b&&Zd(i),hn(null,i,x,d),i=i.child),i;case 16:g=i.elementType;e:{switch(pu(a,i),a=i.pendingProps,x=g._init,g=x(g._payload),i.type=g,x=i.tag=iy(g),a=ls(g,a),x){case 0:i=T0(null,i,g,a,d);break e;case 1:i=Lm(null,i,g,a,d);break e;case 11:i=Om(null,i,g,a,d);break e;case 14:i=jm(null,i,g,ls(g.type,a),d);break e}throw Error(e(306,g,""))}return i;case 0:return g=i.type,x=i.pendingProps,x=i.elementType===g?x:ls(g,x),T0(a,i,g,x,d);case 1:return g=i.type,x=i.pendingProps,x=i.elementType===g?x:ls(g,x),Lm(a,i,g,x,d);case 3:e:{if(Mm(i),a===null)throw Error(e(387));g=i.pendingProps,b=i.memoizedState,x=b.element,Zh(a,i),ou(i,g,null,d);var D=i.memoizedState;if(g=D.element,b.isDehydrated)if(b={element:g,isDehydrated:!1,cache:D.cache,pendingSuspenseBoundaries:D.pendingSuspenseBoundaries,transitions:D.transitions},i.updateQueue.baseState=b,i.memoizedState=b,i.flags&256){x=Co(Error(e(423)),i),i=Um(a,i,g,d,x);break e}else if(g!==x){x=Co(Error(e(424)),i),i=Um(a,i,g,d,x);break e}else for($n=Ia(i.stateNode.containerInfo.firstChild),Un=i,er=!0,os=null,d=Yh(i,null,g,d),i.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(So(),g===x){i=sa(a,i,d);break e}hn(a,i,g,d)}i=i.child}return i;case 5:return rm(i),a===null&&r0(i),g=i.type,x=i.pendingProps,b=a!==null?a.memoizedProps:null,D=x.children,Kd(g,x)?D=null:b!==null&&Kd(g,b)&&(i.flags|=32),Pm(a,i),hn(a,i,D,d),i.child;case 6:return a===null&&r0(i),null;case 13:return $m(a,i,d);case 4:return u0(i,i.stateNode.containerInfo),g=i.pendingProps,a===null?i.child=Eo(i,null,g,d):hn(a,i,g,d),i.child;case 11:return g=i.type,x=i.pendingProps,x=i.elementType===g?x:ls(g,x),Om(a,i,g,x,d);case 7:return hn(a,i,i.pendingProps,d),i.child;case 8:return hn(a,i,i.pendingProps.children,d),i.child;case 12:return hn(a,i,i.pendingProps.children,d),i.child;case 10:e:{if(g=i.type._context,x=i.pendingProps,b=i.memoizedProps,D=x.value,Gt(su,g._currentValue),g._currentValue=D,b!==null)if(Ln(b.value,D)){if(b.children===x.children&&!Tn.current){i=sa(a,i,d);break e}}else for(b=i.child,b!==null&&(b.return=i);b!==null;){var se=b.dependencies;if(se!==null){D=b.child;for(var de=se.firstContext;de!==null;){if(de.context===g){if(b.tag===1){de=na(-1,d&-d),de.tag=2;var Ce=b.updateQueue;if(Ce!==null){Ce=Ce.shared;var $e=Ce.pending;$e===null?de.next=de:(de.next=$e.next,$e.next=de),Ce.pending=de}}b.lanes|=d,de=b.alternate,de!==null&&(de.lanes|=d),o0(b.return,d,i),se.lanes|=d;break}de=de.next}}else if(b.tag===10)D=b.type===i.type?null:b.child;else if(b.tag===18){if(D=b.return,D===null)throw Error(e(341));D.lanes|=d,se=D.alternate,se!==null&&(se.lanes|=d),o0(D,d,i),D=b.sibling}else D=b.child;if(D!==null)D.return=b;else for(D=b;D!==null;){if(D===i){D=null;break}if(b=D.sibling,b!==null){b.return=D.return,D=b;break}D=D.return}b=D}hn(a,i,x.children,d),i=i.child}return i;case 9:return x=i.type,g=i.pendingProps.children,To(i,d),x=qn(x),g=g(x),i.flags|=1,hn(a,i,g,d),i.child;case 14:return g=i.type,x=ls(g,i.pendingProps),x=ls(g.type,x),jm(a,i,g,x,d);case 15:return Fm(a,i,i.type,i.pendingProps,d);case 17:return g=i.type,x=i.pendingProps,x=i.elementType===g?x:ls(g,x),pu(a,i),i.tag=1,Nn(g)?(a=!0,Qc(i)):a=!1,To(i,d),km(i,g,x),S0(i,g,x,d),N0(null,i,g,!0,a,d);case 19:return Vm(a,i,d);case 22:return Dm(a,i,d)}throw Error(e(156,i.tag))};function fg(a,i){return Be(a,i)}function ay(a,i,d,g){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qn(a,i,d,g){return new ay(a,i,d,g)}function K0(a){return a=a.prototype,!(!a||!a.isReactComponent)}function iy(a){if(typeof a=="function")return K0(a)?1:0;if(a!=null){if(a=a.$$typeof,a===X)return 11;if(a===me)return 14}return 2}function Va(a,i){var d=a.alternate;return d===null?(d=Qn(a.tag,i,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=i,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,i=a.dependencies,d.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function Nu(a,i,d,g,x,b){var D=2;if(g=a,typeof a=="function")K0(a)&&(D=1);else if(typeof a=="string")D=5;else e:switch(a){case U:return Fi(d.children,x,b,i);case ee:D=8,x|=8;break;case I:return a=Qn(12,d,i,x|2),a.elementType=I,a.lanes=b,a;case ae:return a=Qn(13,d,i,x),a.elementType=ae,a.lanes=b,a;case fe:return a=Qn(19,d,i,x),a.elementType=fe,a.lanes=b,a;case be:return Cu(d,x,b,i);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case ie:D=10;break e;case oe:D=9;break e;case X:D=11;break e;case me:D=14;break e;case Te:D=16,g=null;break e}throw Error(e(130,a==null?a:typeof a,""))}return i=Qn(D,d,i,x),i.elementType=a,i.type=g,i.lanes=b,i}function Fi(a,i,d,g){return a=Qn(7,a,g,i),a.lanes=d,a}function Cu(a,i,d,g){return a=Qn(22,a,g,i),a.elementType=be,a.lanes=d,a.stateNode={isHidden:!1},a}function X0(a,i,d){return a=Qn(6,a,null,i),a.lanes=d,a}function q0(a,i,d){return i=Qn(4,a.children!==null?a.children:[],a.key,i),i.lanes=d,i.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},i}function oy(a,i,d,g,x){this.tag=i,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cn(0),this.expirationTimes=cn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cn(0),this.identifierPrefix=g,this.onRecoverableError=x,this.mutableSourceEagerHydrationData=null}function J0(a,i,d,g,x,b,D,se,de){return a=new oy(a,i,d,se,de),i===1?(i=1,b===!0&&(i|=8)):i=0,b=Qn(3,null,null,i),a.current=b,b.stateNode=a,b.memoizedState={element:g,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},c0(b),a}function ly(a,i,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:O,key:g==null?null:""+g,children:a,containerInfo:i,implementation:d}}function hg(a){if(!a)return ja;a=a._reactInternals;e:{if(Z(a)!==a||a.tag!==1)throw Error(e(170));var i=a;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Nn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(e(171))}if(a.tag===1){var d=a.type;if(Nn(d))return Bh(a,d,i)}return i}function mg(a,i,d,g,x,b,D,se,de){return a=J0(d,g,!0,a,x,b,D,se,de),a.context=hg(null),d=a.current,g=mn(),x=$a(d),b=na(g,x),b.callback=i??null,Pa(d,b,x),a.current.lanes=x,va(a,x,g),Rn(a,g),a}function Au(a,i,d,g){var x=i.current,b=mn(),D=$a(x);return d=hg(d),i.context===null?i.context=d:i.pendingContext=d,i=na(b,D),i.payload={element:a},g=g===void 0?null:g,g!==null&&(i.callback=g),a=Pa(x,i,D),a!==null&&(ds(a,x,D,b),iu(a,x,D)),D}function Ru(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function gg(a,i){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<i?d:i}}function Y0(a,i){gg(a,i),(a=a.alternate)&&gg(a,i)}function cy(){return null}var pg=typeof reportError=="function"?reportError:function(a){console.error(a)};function Q0(a){this._internalRoot=a}Iu.prototype.render=Q0.prototype.render=function(a){var i=this._internalRoot;if(i===null)throw Error(e(409));Au(a,i,null,null)},Iu.prototype.unmount=Q0.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var i=a.containerInfo;Ii(function(){Au(null,a,null,null)}),i[Qs]=null}};function Iu(a){this._internalRoot=a}Iu.prototype.unstable_scheduleHydration=function(a){if(a){var i=no();a={blockedOn:null,target:a,priority:i};for(var d=0;d<yr.length&&i!==0&&i<yr[d].priority;d++);yr.splice(d,0,a),d===0&&jc(a)}};function Z0(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Ou(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function xg(){}function uy(a,i,d,g,x){if(x){if(typeof g=="function"){var b=g;g=function(){var Ce=Ru(D);b.call(Ce)}}var D=mg(i,g,a,0,null,!1,!1,"",xg);return a._reactRootContainer=D,a[Qs]=D.current,wi(a.nodeType===8?a.parentNode:a),Ii(),D}for(;x=a.lastChild;)a.removeChild(x);if(typeof g=="function"){var se=g;g=function(){var Ce=Ru(de);se.call(Ce)}}var de=J0(a,0,!1,null,null,!1,!1,"",xg);return a._reactRootContainer=de,a[Qs]=de.current,wi(a.nodeType===8?a.parentNode:a),Ii(function(){Au(i,de,d,g)}),de}function ju(a,i,d,g,x){var b=d._reactRootContainer;if(b){var D=b;if(typeof x=="function"){var se=x;x=function(){var de=Ru(D);se.call(de)}}Au(i,D,a,x)}else D=uy(d,i,a,x,g);return Ru(D)}ft=function(a){switch(a.tag){case 3:var i=a.stateNode;if(i.current.memoizedState.isDehydrated){var d=xa(i.pendingLanes);d!==0&&(dl(i,d|1),Rn(i,De()),(It&6)===0&&(Io=De()+500,Fa()))}break;case 13:Ii(function(){var g=ra(a,1);if(g!==null){var x=mn();ds(g,a,1,x)}}),Y0(a,1)}},Kr=function(a){if(a.tag===13){var i=ra(a,134217728);if(i!==null){var d=mn();ds(i,a,134217728,d)}Y0(a,134217728)}},li=function(a){if(a.tag===13){var i=$a(a),d=ra(a,i);if(d!==null){var g=mn();ds(d,a,i,g)}Y0(a,i)}},no=function(){return Rt},xt=function(a,i){var d=Rt;try{return Rt=a,i()}finally{Rt=d}},Gr=function(a,i,d){switch(i){case"input":if(Ae(a,d),i=d.name,d.type==="radio"&&i!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<d.length;i++){var g=d[i];if(g!==a&&g.form===a.form){var x=Jc(g);if(!x)throw Error(e(90));K(g),Ae(g,x)}}}break;case"textarea":Ct(a,d);break;case"select":i=d.value,i!=null&&Et(a,!!d.multiple,i,!1)}},_n=H0,zt=Ii;var dy={usingClientEntryPoint:!1,Events:[Cl,vo,Jc,ln,ni,H0]},Vl={findFiberByHostInstance:Si,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fy={bundleType:Vl.bundleType,version:Vl.version,rendererPackageName:Vl.rendererPackageName,rendererConfig:Vl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Ee(a),a===null?null:a.stateNode},findFiberByHostInstance:Vl.findFiberByHostInstance||cy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fu.isDisabled&&Fu.supportsFiber)try{Dn=Fu.inject(fy),dr=Fu}catch{}}return In.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dy,In.createPortal=function(a,i){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Z0(i))throw Error(e(200));return ly(a,i,null,d)},In.createRoot=function(a,i){if(!Z0(a))throw Error(e(299));var d=!1,g="",x=pg;return i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(g=i.identifierPrefix),i.onRecoverableError!==void 0&&(x=i.onRecoverableError)),i=J0(a,1,!1,null,null,d,!1,g,x),a[Qs]=i.current,wi(a.nodeType===8?a.parentNode:a),new Q0(i)},In.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var i=a._reactInternals;if(i===void 0)throw typeof a.render=="function"?Error(e(188)):(a=Object.keys(a).join(","),Error(e(268,a)));return a=Ee(i),a=a===null?null:a.stateNode,a},In.flushSync=function(a){return Ii(a)},In.hydrate=function(a,i,d){if(!Ou(i))throw Error(e(200));return ju(null,a,i,!0,d)},In.hydrateRoot=function(a,i,d){if(!Z0(a))throw Error(e(405));var g=d!=null&&d.hydratedSources||null,x=!1,b="",D=pg;if(d!=null&&(d.unstable_strictMode===!0&&(x=!0),d.identifierPrefix!==void 0&&(b=d.identifierPrefix),d.onRecoverableError!==void 0&&(D=d.onRecoverableError)),i=mg(i,null,a,1,d??null,x,!1,b,D),a[Qs]=i.current,wi(a),g)for(a=0;a<g.length;a++)d=g[a],x=d._getVersion,x=x(d._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[d,x]:i.mutableSourceEagerHydrationData.push(d,x);return new Iu(i)},In.render=function(a,i,d){if(!Ou(i))throw Error(e(200));return ju(null,a,i,!1,d)},In.unmountComponentAtNode=function(a){if(!Ou(a))throw Error(e(40));return a._reactRootContainer?(Ii(function(){ju(null,null,a,!1,function(){a._reactRootContainer=null,a[Qs]=null})}),!0):!1},In.unstable_batchedUpdates=H0,In.unstable_renderSubtreeIntoContainer=function(a,i,d,g){if(!Ou(d))throw Error(e(200));if(a==null||a._reactInternals===void 0)throw Error(e(38));return ju(a,i,d,!1,g)},In.version="18.3.1-next-f1338f8080-20240426",In}var kg;function by(){if(kg)return rf.exports;kg=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}return t(),rf.exports=wy(),rf.exports}var Tg;function _y(){if(Tg)return Du;Tg=1;var t=by();return Du.createRoot=t.createRoot,Du.hydrateRoot=t.hydrateRoot,Du}var Sy=_y();const Ey=Jf(Sy);/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Ng="popstate";function ky(t={}){function r(n,s){let{pathname:o,search:l,hash:u}=n.location;return Tf("",{pathname:o,search:l,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function e(n,s){return typeof s=="string"?s:lc(s)}return Ny(r,e,null,t)}function ar(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function Ds(t,r){if(!t){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function Ty(){return Math.random().toString(36).substring(2,10)}function Cg(t,r){return{usr:t.state,key:t.key,idx:r}}function Tf(t,r,e=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof r=="string"?el(r):r,state:e,key:r&&r.key||n||Ty()}}function lc({pathname:t="/",search:r="",hash:e=""}){return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),e&&e!=="#"&&(t+=e.charAt(0)==="#"?e:"#"+e),t}function el(t){let r={};if(t){let e=t.indexOf("#");e>=0&&(r.hash=t.substring(e),t=t.substring(0,e));let n=t.indexOf("?");n>=0&&(r.search=t.substring(n),t=t.substring(0,n)),t&&(r.pathname=t)}return r}function Ny(t,r,e,n={}){let{window:s=document.defaultView,v5Compat:o=!1}=n,l=s.history,u="POP",f=null,m=p();m==null&&(m=0,l.replaceState({...l.state,idx:m},""));function p(){return(l.state||{idx:null}).idx}function v(){u="POP";let E=p(),F=E==null?null:E-m;m=E,f&&f({action:u,location:w.location,delta:F})}function y(E,F){u="PUSH";let B=Tf(w.location,E,F);m=p()+1;let C=Cg(B,m),M=w.createHref(B);try{l.pushState(C,"",M)}catch(re){if(re instanceof DOMException&&re.name==="DataCloneError")throw re;s.location.assign(M)}o&&f&&f({action:u,location:w.location,delta:1})}function S(E,F){u="REPLACE";let B=Tf(w.location,E,F);m=p();let C=Cg(B,m),M=w.createHref(B);l.replaceState(C,"",M),o&&f&&f({action:u,location:w.location,delta:0})}function k(E){return Cy(E)}let w={get action(){return u},get location(){return t(s,l)},listen(E){if(f)throw new Error("A history only accepts one active listener");return s.addEventListener(Ng,v),f=E,()=>{s.removeEventListener(Ng,v),f=null}},createHref(E){return r(s,E)},createURL:k,encodeLocation(E){let F=k(E);return{pathname:F.pathname,search:F.search,hash:F.hash}},push:y,replace:S,go(E){return l.go(E)}};return w}function Cy(t,r=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),ar(e,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:lc(t);return n=n.replace(/ $/,"%20"),!r&&n.startsWith("//")&&(n=e+n),new URL(n,e)}function ox(t,r,e="/"){return Ay(t,r,e,!1)}function Ay(t,r,e,n){let s=typeof r=="string"?el(r):r,o=fa(s.pathname||"/",e);if(o==null)return null;let l=lx(t);Ry(l);let u=null;for(let f=0;u==null&&f<l.length;++f){let m=By(o);u=Uy(l[f],m,n)}return u}function lx(t,r=[],e=[],n="",s=!1){let o=(l,u,f=s,m)=>{let p={relativePath:m===void 0?l.path||"":m,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&f)return;ar(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let v=ca([n,p.relativePath]),y=e.concat(p);l.children&&l.children.length>0&&(ar(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),lx(l.children,r,y,v,f)),!(l.path==null&&!l.index)&&r.push({path:v,score:Ly(v,l.index),routesMeta:y})};return t.forEach((l,u)=>{if(l.path===""||!l.path?.includes("?"))o(l,u);else for(let f of cx(l.path))o(l,u,!0,f)}),r}function cx(t){let r=t.split("/");if(r.length===0)return[];let[e,...n]=r,s=e.endsWith("?"),o=e.replace(/\?$/,"");if(n.length===0)return s?[o,""]:[o];let l=cx(n.join("/")),u=[];return u.push(...l.map(f=>f===""?o:[o,f].join("/"))),s&&u.push(...l),u.map(f=>t.startsWith("/")&&f===""?"/":f)}function Ry(t){t.sort((r,e)=>r.score!==e.score?e.score-r.score:My(r.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}var Iy=/^:[\w-]+$/,Oy=3,jy=2,Fy=1,Dy=10,Py=-2,Ag=t=>t==="*";function Ly(t,r){let e=t.split("/"),n=e.length;return e.some(Ag)&&(n+=Py),r&&(n+=jy),e.filter(s=>!Ag(s)).reduce((s,o)=>s+(Iy.test(o)?Oy:o===""?Fy:Dy),n)}function My(t,r){return t.length===r.length&&t.slice(0,-1).every((n,s)=>n===r[s])?t[t.length-1]-r[r.length-1]:0}function Uy(t,r,e=!1){let{routesMeta:n}=t,s={},o="/",l=[];for(let u=0;u<n.length;++u){let f=n[u],m=u===n.length-1,p=o==="/"?r:r.slice(o.length)||"/",v=td({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},p),y=f.route;if(!v&&m&&e&&!n[n.length-1].route.index&&(v=td({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!v)return null;Object.assign(s,v.params),l.push({params:s,pathname:ca([o,v.pathname]),pathnameBase:zy(ca([o,v.pathnameBase])),route:y}),v.pathnameBase!=="/"&&(o=ca([o,v.pathnameBase]))}return l}function td(t,r){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[e,n]=$y(t.path,t.caseSensitive,t.end),s=r.match(e);if(!s)return null;let o=s[0],l=o.replace(/(.)\/+$/,"$1"),u=s.slice(1);return{params:n.reduce((m,{paramName:p,isOptional:v},y)=>{if(p==="*"){let k=u[y]||"";l=o.slice(0,o.length-k.length).replace(/(.)\/+$/,"$1")}const S=u[y];return v&&!S?m[p]=void 0:m[p]=(S||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:l,pattern:t}}function $y(t,r=!1,e=!0){Ds(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,f)=>(n.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,r?void 0:"i"),n]}function By(t){try{return t.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return Ds(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),t}}function fa(t,r){if(r==="/")return t;if(!t.toLowerCase().startsWith(r.toLowerCase()))return null;let e=r.endsWith("/")?r.length-1:r.length,n=t.charAt(e);return n&&n!=="/"?null:t.slice(e)||"/"}function Vy(t,r="/"){let{pathname:e,search:n="",hash:s=""}=typeof t=="string"?el(t):t;return{pathname:e?e.startsWith("/")?e:Wy(e,r):r,search:Gy(n),hash:Ky(s)}}function Wy(t,r){let e=r.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?e.length>1&&e.pop():s!=="."&&e.push(s)}),e.length>1?e.join("/"):"/"}function af(t,r,e,n){return`Cannot include a '${t}' character in a manually specified \`to.${r}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Hy(t){return t.filter((r,e)=>e===0||r.route.path&&r.route.path.length>0)}function ux(t){let r=Hy(t);return r.map((e,n)=>n===r.length-1?e.pathname:e.pathnameBase)}function dx(t,r,e,n=!1){let s;typeof t=="string"?s=el(t):(s={...t},ar(!s.pathname||!s.pathname.includes("?"),af("?","pathname","search",s)),ar(!s.pathname||!s.pathname.includes("#"),af("#","pathname","hash",s)),ar(!s.search||!s.search.includes("#"),af("#","search","hash",s)));let o=t===""||s.pathname==="",l=o?"/":s.pathname,u;if(l==null)u=e;else{let v=r.length-1;if(!n&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),v-=1;s.pathname=y.join("/")}u=v>=0?r[v]:"/"}let f=Vy(s,u),m=l&&l!=="/"&&l.endsWith("/"),p=(o||l===".")&&e.endsWith("/");return!f.pathname.endsWith("/")&&(m||p)&&(f.pathname+="/"),f}var ca=t=>t.join("/").replace(/\/\/+/g,"/"),zy=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Gy=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Ky=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Xy(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var fx=["POST","PUT","PATCH","DELETE"];new Set(fx);var qy=["GET",...fx];new Set(qy);var tl=j.createContext(null);tl.displayName="DataRouter";var pd=j.createContext(null);pd.displayName="DataRouterState";j.createContext(!1);var hx=j.createContext({isTransitioning:!1});hx.displayName="ViewTransition";var Jy=j.createContext(new Map);Jy.displayName="Fetchers";var Yy=j.createContext(null);Yy.displayName="Await";var Ls=j.createContext(null);Ls.displayName="Navigation";var yc=j.createContext(null);yc.displayName="Location";var ma=j.createContext({outlet:null,matches:[],isDataRoute:!1});ma.displayName="Route";var Qf=j.createContext(null);Qf.displayName="RouteError";function Qy(t,{relative:r}={}){ar(wc(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:n}=j.useContext(Ls),{hash:s,pathname:o,search:l}=bc(t,{relative:r}),u=o;return e!=="/"&&(u=o==="/"?e:ca([e,o])),n.createHref({pathname:u,search:l,hash:s})}function wc(){return j.useContext(yc)!=null}function jn(){return ar(wc(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(yc).location}var mx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function gx(t){j.useContext(Ls).static||j.useLayoutEffect(t)}function rl(){let{isDataRoute:t}=j.useContext(ma);return t?dw():Zy()}function Zy(){ar(wc(),"useNavigate() may be used only in the context of a <Router> component.");let t=j.useContext(tl),{basename:r,navigator:e}=j.useContext(Ls),{matches:n}=j.useContext(ma),{pathname:s}=jn(),o=JSON.stringify(ux(n)),l=j.useRef(!1);return gx(()=>{l.current=!0}),j.useCallback((f,m={})=>{if(Ds(l.current,mx),!l.current)return;if(typeof f=="number"){e.go(f);return}let p=dx(f,JSON.parse(o),s,m.relative==="path");t==null&&r!=="/"&&(p.pathname=p.pathname==="/"?r:ca([r,p.pathname])),(m.replace?e.replace:e.push)(p,m.state,m)},[r,e,o,s,t])}j.createContext(null);function bc(t,{relative:r}={}){let{matches:e}=j.useContext(ma),{pathname:n}=jn(),s=JSON.stringify(ux(e));return j.useMemo(()=>dx(t,JSON.parse(s),n,r==="path"),[t,s,n,r])}function ew(t,r){return px(t,r)}function px(t,r,e,n,s){ar(wc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=j.useContext(Ls),{matches:l}=j.useContext(ma),u=l[l.length-1],f=u?u.params:{},m=u?u.pathname:"/",p=u?u.pathnameBase:"/",v=u&&u.route;{let B=v&&v.path||"";xx(m,!v||B.endsWith("*")||B.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${B}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${B}"> to <Route path="${B==="/"?"*":`${B}/*`}">.`)}let y=jn(),S;if(r){let B=typeof r=="string"?el(r):r;ar(p==="/"||B.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${B.pathname}" was given in the \`location\` prop.`),S=B}else S=y;let k=S.pathname||"/",w=k;if(p!=="/"){let B=p.replace(/^\//,"").split("/");w="/"+k.replace(/^\//,"").split("/").slice(B.length).join("/")}let E=ox(t,{pathname:w});Ds(v||E!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),Ds(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let F=aw(E&&E.map(B=>Object.assign({},B,{params:Object.assign({},f,B.params),pathname:ca([p,o.encodeLocation?o.encodeLocation(B.pathname).pathname:B.pathname]),pathnameBase:B.pathnameBase==="/"?p:ca([p,o.encodeLocation?o.encodeLocation(B.pathnameBase).pathname:B.pathnameBase])})),l,e,n,s);return r&&F?j.createElement(yc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},F):F}function tw(){let t=uw(),r=Xy(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),e=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",t),l=j.createElement(j.Fragment,null,j.createElement("p",null,"💿 Hey developer 👋"),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:o},"ErrorBoundary")," or"," ",j.createElement("code",{style:o},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},r),e?j.createElement("pre",{style:s},e):null,l)}var rw=j.createElement(tw,null),nw=class extends j.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){this.props.unstable_onError?this.props.unstable_onError(t,r):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?j.createElement(ma.Provider,{value:this.props.routeContext},j.createElement(Qf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function sw({routeContext:t,match:r,children:e}){let n=j.useContext(tl);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),j.createElement(ma.Provider,{value:t},e)}function aw(t,r=[],e=null,n=null,s=null){if(t==null){if(!e)return null;if(e.errors)t=e.matches;else if(r.length===0&&!e.initialized&&e.matches.length>0)t=e.matches;else return null}let o=t,l=e?.errors;if(l!=null){let m=o.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);ar(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),o=o.slice(0,Math.min(o.length,m+1))}let u=!1,f=-1;if(e)for(let m=0;m<o.length;m++){let p=o[m];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(f=m),p.route.id){let{loaderData:v,errors:y}=e,S=p.route.loader&&!v.hasOwnProperty(p.route.id)&&(!y||y[p.route.id]===void 0);if(p.route.lazy||S){u=!0,f>=0?o=o.slice(0,f+1):o=[o[0]];break}}}return o.reduceRight((m,p,v)=>{let y,S=!1,k=null,w=null;e&&(y=l&&p.route.id?l[p.route.id]:void 0,k=p.route.errorElement||rw,u&&(f<0&&v===0?(xx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),S=!0,w=null):f===v&&(S=!0,w=p.route.hydrateFallbackElement||null)));let E=r.concat(o.slice(0,v+1)),F=()=>{let B;return y?B=k:S?B=w:p.route.Component?B=j.createElement(p.route.Component,null):p.route.element?B=p.route.element:B=m,j.createElement(sw,{match:p,routeContext:{outlet:m,matches:E,isDataRoute:e!=null},children:B})};return e&&(p.route.ErrorBoundary||p.route.errorElement||v===0)?j.createElement(nw,{location:e.location,revalidation:e.revalidation,component:k,error:y,children:F(),routeContext:{outlet:null,matches:E,isDataRoute:!0},unstable_onError:n}):F()},null)}function Zf(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function iw(t){let r=j.useContext(tl);return ar(r,Zf(t)),r}function ow(t){let r=j.useContext(pd);return ar(r,Zf(t)),r}function lw(t){let r=j.useContext(ma);return ar(r,Zf(t)),r}function eh(t){let r=lw(t),e=r.matches[r.matches.length-1];return ar(e.route.id,`${t} can only be used on routes that contain a unique "id"`),e.route.id}function cw(){return eh("useRouteId")}function uw(){let t=j.useContext(Qf),r=ow("useRouteError"),e=eh("useRouteError");return t!==void 0?t:r.errors?.[e]}function dw(){let{router:t}=iw("useNavigate"),r=eh("useNavigate"),e=j.useRef(!1);return gx(()=>{e.current=!0}),j.useCallback(async(s,o={})=>{Ds(e.current,mx),e.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:r,...o}))},[t,r])}var Rg={};function xx(t,r,e){!r&&!Rg[t]&&(Rg[t]=!0,Ds(!1,e))}j.memo(fw);function fw({routes:t,future:r,state:e,unstable_onError:n}){return px(t,void 0,e,n,r)}function Ga(t){ar(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function hw({basename:t="/",children:r=null,location:e,navigationType:n="POP",navigator:s,static:o=!1}){ar(!wc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),u=j.useMemo(()=>({basename:l,navigator:s,static:o,future:{}}),[l,s,o]);typeof e=="string"&&(e=el(e));let{pathname:f="/",search:m="",hash:p="",state:v=null,key:y="default"}=e,S=j.useMemo(()=>{let k=fa(f,l);return k==null?null:{location:{pathname:k,search:m,hash:p,state:v,key:y},navigationType:n}},[l,f,m,p,v,y,n]);return Ds(S!=null,`<Router basename="${l}"> is not able to match the URL "${f}${m}${p}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:j.createElement(Ls.Provider,{value:u},j.createElement(yc.Provider,{children:r,value:S}))}function mw({children:t,location:r}){return ew(Nf(t),r)}function Nf(t,r=[]){let e=[];return j.Children.forEach(t,(n,s)=>{if(!j.isValidElement(n))return;let o=[...r,s];if(n.type===j.Fragment){e.push.apply(e,Nf(n.props.children,o));return}ar(n.type===Ga,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ar(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Nf(n.props.children,o)),e.push(l)}),e}var Qu="get",Zu="application/x-www-form-urlencoded";function xd(t){return t!=null&&typeof t.tagName=="string"}function gw(t){return xd(t)&&t.tagName.toLowerCase()==="button"}function pw(t){return xd(t)&&t.tagName.toLowerCase()==="form"}function xw(t){return xd(t)&&t.tagName.toLowerCase()==="input"}function vw(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function yw(t,r){return t.button===0&&(!r||r==="_self")&&!vw(t)}var Pu=null;function ww(){if(Pu===null)try{new FormData(document.createElement("form"),0),Pu=!1}catch{Pu=!0}return Pu}var bw=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function of(t){return t!=null&&!bw.has(t)?(Ds(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Zu}"`),null):t}function _w(t,r){let e,n,s,o,l;if(pw(t)){let u=t.getAttribute("action");n=u?fa(u,r):null,e=t.getAttribute("method")||Qu,s=of(t.getAttribute("enctype"))||Zu,o=new FormData(t)}else if(gw(t)||xw(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||u.getAttribute("action");if(n=f?fa(f,r):null,e=t.getAttribute("formmethod")||u.getAttribute("method")||Qu,s=of(t.getAttribute("formenctype"))||of(u.getAttribute("enctype"))||Zu,o=new FormData(u,t),!ww()){let{name:m,type:p,value:v}=t;if(p==="image"){let y=m?`${m}.`:"";o.append(`${y}x`,"0"),o.append(`${y}y`,"0")}else m&&o.append(m,v)}}else{if(xd(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Qu,n=null,s=Zu,l=t}return o&&s==="text/plain"&&(l=o,o=void 0),{action:n,method:e.toLowerCase(),encType:s,formData:o,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function th(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function Sw(t,r,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${e}`:r&&fa(n.pathname,r)==="/"?n.pathname=`${r.replace(/\/$/,"")}/_root.${e}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${e}`,n}async function Ew(t,r){if(t.id in r)return r[t.id];try{let e=await import(t.module);return r[t.id]=e,e}catch(e){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function kw(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function Tw(t,r,e){let n=await Promise.all(t.map(async s=>{let o=r.routes[s.route.id];if(o){let l=await Ew(o,e);return l.links?l.links():[]}return[]}));return Rw(n.flat(1).filter(kw).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Ig(t,r,e,n,s,o){let l=(f,m)=>e[m]?f.route.id!==e[m].route.id:!0,u=(f,m)=>e[m].pathname!==f.pathname||e[m].route.path?.endsWith("*")&&e[m].params["*"]!==f.params["*"];return o==="assets"?r.filter((f,m)=>l(f,m)||u(f,m)):o==="data"?r.filter((f,m)=>{let p=n.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(l(f,m)||u(f,m))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function Nw(t,r,{includeHydrateFallback:e}={}){return Cw(t.map(n=>{let s=r.routes[n.route.id];if(!s)return[];let o=[s.module];return s.clientActionModule&&(o=o.concat(s.clientActionModule)),s.clientLoaderModule&&(o=o.concat(s.clientLoaderModule)),e&&s.hydrateFallbackModule&&(o=o.concat(s.hydrateFallbackModule)),s.imports&&(o=o.concat(s.imports)),o}).flat(1))}function Cw(t){return[...new Set(t)]}function Aw(t){let r={},e=Object.keys(t).sort();for(let n of e)r[n]=t[n];return r}function Rw(t,r){let e=new Set;return new Set(r),t.reduce((n,s)=>{let o=JSON.stringify(Aw(s));return e.has(o)||(e.add(o),n.push({key:o,link:s})),n},[])}function vx(){let t=j.useContext(tl);return th(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Iw(){let t=j.useContext(pd);return th(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var rh=j.createContext(void 0);rh.displayName="FrameworkContext";function yx(){let t=j.useContext(rh);return th(t,"You must render this element inside a <HydratedRouter> element"),t}function Ow(t,r){let e=j.useContext(rh),[n,s]=j.useState(!1),[o,l]=j.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:m,onMouseLeave:p,onTouchStart:v}=r,y=j.useRef(null);j.useEffect(()=>{if(t==="render"&&l(!0),t==="viewport"){let w=F=>{F.forEach(B=>{l(B.isIntersecting)})},E=new IntersectionObserver(w,{threshold:.5});return y.current&&E.observe(y.current),()=>{E.disconnect()}}},[t]),j.useEffect(()=>{if(n){let w=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(w)}}},[n]);let S=()=>{s(!0)},k=()=>{s(!1),l(!1)};return e?t!=="intent"?[o,y,{}]:[o,y,{onFocus:Hl(u,S),onBlur:Hl(f,k),onMouseEnter:Hl(m,S),onMouseLeave:Hl(p,k),onTouchStart:Hl(v,S)}]:[!1,y,{}]}function Hl(t,r){return e=>{t&&t(e),e.defaultPrevented||r(e)}}function jw({page:t,...r}){let{router:e}=vx(),n=j.useMemo(()=>ox(e.routes,t,e.basename),[e.routes,t,e.basename]);return n?j.createElement(Dw,{page:t,matches:n,...r}):null}function Fw(t){let{manifest:r,routeModules:e}=yx(),[n,s]=j.useState([]);return j.useEffect(()=>{let o=!1;return Tw(t,r,e).then(l=>{o||s(l)}),()=>{o=!0}},[t,r,e]),n}function Dw({page:t,matches:r,...e}){let n=jn(),{manifest:s,routeModules:o}=yx(),{basename:l}=vx(),{loaderData:u,matches:f}=Iw(),m=j.useMemo(()=>Ig(t,r,f,s,n,"data"),[t,r,f,s,n]),p=j.useMemo(()=>Ig(t,r,f,s,n,"assets"),[t,r,f,s,n]),v=j.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let k=new Set,w=!1;if(r.forEach(F=>{let B=s.routes[F.route.id];!B||!B.hasLoader||(!m.some(C=>C.route.id===F.route.id)&&F.route.id in u&&o[F.route.id]?.shouldRevalidate||B.hasClientLoader?w=!0:k.add(F.route.id))}),k.size===0)return[];let E=Sw(t,l,"data");return w&&k.size>0&&E.searchParams.set("_routes",r.filter(F=>k.has(F.route.id)).map(F=>F.route.id).join(",")),[E.pathname+E.search]},[l,u,n,s,m,r,t,o]),y=j.useMemo(()=>Nw(p,s),[p,s]),S=Fw(p);return j.createElement(j.Fragment,null,v.map(k=>j.createElement("link",{key:k,rel:"prefetch",as:"fetch",href:k,...e})),y.map(k=>j.createElement("link",{key:k,rel:"modulepreload",href:k,...e})),S.map(({key:k,link:w})=>j.createElement("link",{key:k,nonce:e.nonce,...w})))}function Pw(...t){return r=>{t.forEach(e=>{typeof e=="function"?e(r):e!=null&&(e.current=r)})}}var wx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{wx&&(window.__reactRouterVersion="7.8.2")}catch{}function Lw({basename:t,children:r,window:e}){let n=j.useRef();n.current==null&&(n.current=ky({window:e,v5Compat:!0}));let s=n.current,[o,l]=j.useState({action:s.action,location:s.location}),u=j.useCallback(f=>{j.startTransition(()=>l(f))},[l]);return j.useLayoutEffect(()=>s.listen(u),[s,u]),j.createElement(hw,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:s})}var bx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_x=j.forwardRef(function({onClick:r,discover:e="render",prefetch:n="none",relative:s,reloadDocument:o,replace:l,state:u,target:f,to:m,preventScrollReset:p,viewTransition:v,...y},S){let{basename:k}=j.useContext(Ls),w=typeof m=="string"&&bx.test(m),E,F=!1;if(typeof m=="string"&&w&&(E=m,wx))try{let I=new URL(window.location.href),ie=m.startsWith("//")?new URL(I.protocol+m):new URL(m),oe=fa(ie.pathname,k);ie.origin===I.origin&&oe!=null?m=oe+ie.search+ie.hash:F=!0}catch{Ds(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let B=Qy(m,{relative:s}),[C,M,re]=Ow(n,y),O=Bw(m,{replace:l,state:u,target:f,preventScrollReset:p,relative:s,viewTransition:v});function U(I){r&&r(I),I.defaultPrevented||O(I)}let ee=j.createElement("a",{...y,...re,href:E||B,onClick:F||o?r:U,ref:Pw(S,M),target:f,"data-discover":!w&&e==="render"?"true":void 0});return C&&!w?j.createElement(j.Fragment,null,ee,j.createElement(jw,{page:B})):ee});_x.displayName="Link";var Mw=j.forwardRef(function({"aria-current":r="page",caseSensitive:e=!1,className:n="",end:s=!1,style:o,to:l,viewTransition:u,children:f,...m},p){let v=bc(l,{relative:m.relative}),y=jn(),S=j.useContext(pd),{navigator:k,basename:w}=j.useContext(Ls),E=S!=null&&Gw(v)&&u===!0,F=k.encodeLocation?k.encodeLocation(v).pathname:v.pathname,B=y.pathname,C=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;e||(B=B.toLowerCase(),C=C?C.toLowerCase():null,F=F.toLowerCase()),C&&w&&(C=fa(C,w)||C);const M=F!=="/"&&F.endsWith("/")?F.length-1:F.length;let re=B===F||!s&&B.startsWith(F)&&B.charAt(M)==="/",O=C!=null&&(C===F||!s&&C.startsWith(F)&&C.charAt(F.length)==="/"),U={isActive:re,isPending:O,isTransitioning:E},ee=re?r:void 0,I;typeof n=="function"?I=n(U):I=[n,re?"active":null,O?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let ie=typeof o=="function"?o(U):o;return j.createElement(_x,{...m,"aria-current":ee,className:I,ref:p,style:ie,to:l,viewTransition:u},typeof f=="function"?f(U):f)});Mw.displayName="NavLink";var Uw=j.forwardRef(({discover:t="render",fetcherKey:r,navigate:e,reloadDocument:n,replace:s,state:o,method:l=Qu,action:u,onSubmit:f,relative:m,preventScrollReset:p,viewTransition:v,...y},S)=>{let k=Hw(),w=zw(u,{relative:m}),E=l.toLowerCase()==="get"?"get":"post",F=typeof u=="string"&&bx.test(u),B=C=>{if(f&&f(C),C.defaultPrevented)return;C.preventDefault();let M=C.nativeEvent.submitter,re=M?.getAttribute("formmethod")||l;k(M||C.currentTarget,{fetcherKey:r,method:re,navigate:e,replace:s,state:o,relative:m,preventScrollReset:p,viewTransition:v})};return j.createElement("form",{ref:S,method:E,action:w,onSubmit:n?f:B,...y,"data-discover":!F&&t==="render"?"true":void 0})});Uw.displayName="Form";function $w(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Sx(t){let r=j.useContext(tl);return ar(r,$w(t)),r}function Bw(t,{target:r,replace:e,state:n,preventScrollReset:s,relative:o,viewTransition:l}={}){let u=rl(),f=jn(),m=bc(t,{relative:o});return j.useCallback(p=>{if(yw(p,r)){p.preventDefault();let v=e!==void 0?e:lc(f)===lc(m);u(t,{replace:v,state:n,preventScrollReset:s,relative:o,viewTransition:l})}},[f,u,m,e,n,r,t,s,o,l])}var Vw=0,Ww=()=>`__${String(++Vw)}__`;function Hw(){let{router:t}=Sx("useSubmit"),{basename:r}=j.useContext(Ls),e=cw();return j.useCallback(async(n,s={})=>{let{action:o,method:l,encType:u,formData:f,body:m}=_w(n,r);if(s.navigate===!1){let p=s.fetcherKey||Ww();await t.fetch(p,e,s.action||o,{preventScrollReset:s.preventScrollReset,formData:f,body:m,formMethod:s.method||l,formEncType:s.encType||u,flushSync:s.flushSync})}else await t.navigate(s.action||o,{preventScrollReset:s.preventScrollReset,formData:f,body:m,formMethod:s.method||l,formEncType:s.encType||u,replace:s.replace,state:s.state,fromRouteId:e,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,r,e])}function zw(t,{relative:r}={}){let{basename:e}=j.useContext(Ls),n=j.useContext(ma);ar(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),o={...bc(t||".",{relative:r})},l=jn();if(t==null){o.search=l.search;let u=new URLSearchParams(o.search),f=u.getAll("index");if(f.some(p=>p==="")){u.delete("index"),f.filter(v=>v).forEach(v=>u.append("index",v));let p=u.toString();o.search=p?`?${p}`:""}}return(!t||t===".")&&s.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(o.pathname=o.pathname==="/"?e:ca([e,o.pathname])),lc(o)}function Gw(t,{relative:r}={}){let e=j.useContext(hx);ar(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Sx("useViewTransitionState"),s=bc(t,{relative:r});if(!e.isTransitioning)return!1;let o=fa(e.currentLocation.pathname,n)||e.currentLocation.pathname,l=fa(e.nextLocation.pathname,n)||e.nextLocation.pathname;return td(s.pathname,l)!=null||td(s.pathname,o)!=null}const Kw="modulepreload",Xw=function(t){return"/"+t},Og={},nl=function(r,e,n){let s=Promise.resolve();if(e&&e.length>0){let m=function(p){return Promise.all(p.map(v=>Promise.resolve(v).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};var l=m;document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=u?.nonce||u?.getAttribute("nonce");s=m(e.map(p=>{if(p=Xw(p),p in Og)return;Og[p]=!0;const v=p.endsWith(".css"),y=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${y}`))return;const S=document.createElement("link");if(S.rel=v?"stylesheet":Kw,v||(S.as="script"),S.crossOrigin="",S.href=p,f&&S.setAttribute("nonce",f),document.head.appendChild(S),v)return new Promise((k,w)=>{S.addEventListener("load",k),S.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return s.then(u=>{for(const f of u||[])f.status==="rejected"&&o(f.reason);return r().catch(o)})},qw=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>nl(async()=>{const{default:n}=await Promise.resolve().then(()=>sl);return{default:n}},[]).then(({default:n})=>n(...e)):r=fetch,(...e)=>r(...e)};class nh extends Error{constructor(r,e="FunctionsError",n){super(r),this.name=e,this.context=n}}class Jw extends nh{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class jg extends nh{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class Fg extends nh{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var Cf;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Cf||(Cf={}));var Yw=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};class Qw{constructor(r,{headers:e={},customFetch:n,region:s=Cf.Any}={}){this.url=r,this.headers=e,this.region=s,this.fetch=qw(n)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,e={}){var n;return Yw(this,void 0,void 0,function*(){try{const{headers:s,method:o,body:l}=e;let u={},{region:f}=e;f||(f=this.region);const m=new URL(`${this.url}/${r}`);f&&f!=="any"&&(u["x-region"]=f,m.searchParams.set("forceFunctionRegion",f));let p;l&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",p=l):typeof l=="string"?(u["Content-Type"]="text/plain",p=l):typeof FormData<"u"&&l instanceof FormData?p=l:(u["Content-Type"]="application/json",p=JSON.stringify(l)));const v=yield this.fetch(m.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),s),body:p}).catch(w=>{throw new Jw(w)}),y=v.headers.get("x-relay-error");if(y&&y==="true")throw new jg(v);if(!v.ok)throw new Fg(v);let S=((n=v.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),k;return S==="application/json"?k=yield v.json():S==="application/octet-stream"?k=yield v.blob():S==="text/event-stream"?k=v:S==="multipart/form-data"?k=yield v.formData():k=yield v.text(),{data:k,error:null,response:v}}catch(s){return{data:null,error:s,response:s instanceof Fg||s instanceof jg?s.context:void 0}}})}}var Or={},jo={},Fo={},Do={},Po={},Lo={},Zw=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Yo=Zw();const eb=Yo.fetch,Ex=Yo.fetch.bind(Yo),kx=Yo.Headers,tb=Yo.Request,rb=Yo.Response,sl=Object.freeze(Object.defineProperty({__proto__:null,Headers:kx,Request:tb,Response:rb,default:Ex,fetch:eb},Symbol.toStringTag,{value:"Module"})),nb=my(sl);var Lu={},Dg;function Tx(){if(Dg)return Lu;Dg=1,Object.defineProperty(Lu,"__esModule",{value:!0});class t extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}return Lu.default=t,Lu}var Pg;function Nx(){if(Pg)return Lo;Pg=1;var t=Lo&&Lo.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Lo,"__esModule",{value:!0});const r=t(nb),e=t(Tx());class n{constructor(o){var l,u;this.shouldThrowOnError=!1,this.method=o.method,this.url=o.url,this.headers=new Headers(o.headers),this.schema=o.schema,this.body=o.body,this.shouldThrowOnError=(l=o.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=o.signal,this.isMaybeSingle=(u=o.isMaybeSingle)!==null&&u!==void 0?u:!1,o.fetch?this.fetch=o.fetch:typeof fetch>"u"?this.fetch=r.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(o,l){return this.headers=new Headers(this.headers),this.headers.set(o,l),this}then(o,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const u=this.fetch;let f=u(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async m=>{var p,v,y,S;let k=null,w=null,E=null,F=m.status,B=m.statusText;if(m.ok){if(this.method!=="HEAD"){const O=await m.text();O===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((p=this.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?w=O:w=JSON.parse(O))}const M=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),re=(y=m.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");M&&re&&re.length>1&&(E=parseInt(re[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(k={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,E=null,F=406,B="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const M=await m.text();try{k=JSON.parse(M),Array.isArray(k)&&m.status===404&&(w=[],k=null,F=200,B="OK")}catch{m.status===404&&M===""?(F=204,B="No Content"):k={message:M}}if(k&&this.isMaybeSingle&&(!((S=k?.details)===null||S===void 0)&&S.includes("0 rows"))&&(k=null,F=200,B="OK"),k&&this.shouldThrowOnError)throw new e.default(k)}return{error:k,data:w,count:E,status:F,statusText:B}});return this.shouldThrowOnError||(f=f.catch(m=>{var p,v,y;return{error:{message:`${(p=m?.name)!==null&&p!==void 0?p:"FetchError"}: ${m?.message}`,details:`${(v=m?.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(y=m?.code)!==null&&y!==void 0?y:""}`},data:null,count:null,status:0,statusText:""}})),f.then(o,l)}returns(){return this}overrideTypes(){return this}}return Lo.default=n,Lo}var Lg;function Cx(){if(Lg)return Po;Lg=1;var t=Po&&Po.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Po,"__esModule",{value:!0});const r=t(Nx());class e extends r.default{select(s){let o=!1;const l=(s??"*").split("").map(u=>/\s/.test(u)&&!o?"":(u==='"'&&(o=!o),u)).join("");return this.url.searchParams.set("select",l),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:o=!0,nullsFirst:l,foreignTable:u,referencedTable:f=u}={}){const m=f?`${f}.order`:"order",p=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${p?`${p},`:""}${s}.${o?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:o,referencedTable:l=o}={}){const u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(u,`${s}`),this}range(s,o,{foreignTable:l,referencedTable:u=l}={}){const f=typeof u>"u"?"offset":`${u}.offset`,m=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(f,`${s}`),this.url.searchParams.set(m,`${o-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:o=!1,settings:l=!1,buffers:u=!1,wal:f=!1,format:m="text"}={}){var p;const v=[s?"analyze":null,o?"verbose":null,l?"settings":null,u?"buffers":null,f?"wal":null].filter(Boolean).join("|"),y=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${y}"; options=${v};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Po.default=e,Po}var Mg;function sh(){if(Mg)return Do;Mg=1;var t=Do&&Do.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Do,"__esModule",{value:!0});const r=t(Cx());class e extends r.default{eq(s,o){return this.url.searchParams.append(s,`eq.${o}`),this}neq(s,o){return this.url.searchParams.append(s,`neq.${o}`),this}gt(s,o){return this.url.searchParams.append(s,`gt.${o}`),this}gte(s,o){return this.url.searchParams.append(s,`gte.${o}`),this}lt(s,o){return this.url.searchParams.append(s,`lt.${o}`),this}lte(s,o){return this.url.searchParams.append(s,`lte.${o}`),this}like(s,o){return this.url.searchParams.append(s,`like.${o}`),this}likeAllOf(s,o){return this.url.searchParams.append(s,`like(all).{${o.join(",")}}`),this}likeAnyOf(s,o){return this.url.searchParams.append(s,`like(any).{${o.join(",")}}`),this}ilike(s,o){return this.url.searchParams.append(s,`ilike.${o}`),this}ilikeAllOf(s,o){return this.url.searchParams.append(s,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(s,o){return this.url.searchParams.append(s,`ilike(any).{${o.join(",")}}`),this}is(s,o){return this.url.searchParams.append(s,`is.${o}`),this}in(s,o){const l=Array.from(new Set(o)).map(u=>typeof u=="string"&&new RegExp("[,()]").test(u)?`"${u}"`:`${u}`).join(",");return this.url.searchParams.append(s,`in.(${l})`),this}contains(s,o){return typeof o=="string"?this.url.searchParams.append(s,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(s,`cs.{${o.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(o)}`),this}containedBy(s,o){return typeof o=="string"?this.url.searchParams.append(s,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(s,`cd.{${o.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(o)}`),this}rangeGt(s,o){return this.url.searchParams.append(s,`sr.${o}`),this}rangeGte(s,o){return this.url.searchParams.append(s,`nxl.${o}`),this}rangeLt(s,o){return this.url.searchParams.append(s,`sl.${o}`),this}rangeLte(s,o){return this.url.searchParams.append(s,`nxr.${o}`),this}rangeAdjacent(s,o){return this.url.searchParams.append(s,`adj.${o}`),this}overlaps(s,o){return typeof o=="string"?this.url.searchParams.append(s,`ov.${o}`):this.url.searchParams.append(s,`ov.{${o.join(",")}}`),this}textSearch(s,o,{config:l,type:u}={}){let f="";u==="plain"?f="pl":u==="phrase"?f="ph":u==="websearch"&&(f="w");const m=l===void 0?"":`(${l})`;return this.url.searchParams.append(s,`${f}fts${m}.${o}`),this}match(s){return Object.entries(s).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(s,o,l){return this.url.searchParams.append(s,`not.${o}.${l}`),this}or(s,{foreignTable:o,referencedTable:l=o}={}){const u=l?`${l}.or`:"or";return this.url.searchParams.append(u,`(${s})`),this}filter(s,o,l){return this.url.searchParams.append(s,`${o}.${l}`),this}}return Do.default=e,Do}var Ug;function Ax(){if(Ug)return Fo;Ug=1;var t=Fo&&Fo.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Fo,"__esModule",{value:!0});const r=t(sh());class e{constructor(s,{headers:o={},schema:l,fetch:u}){this.url=s,this.headers=new Headers(o),this.schema=l,this.fetch=u}select(s,{head:o=!1,count:l}={}){const u=o?"HEAD":"GET";let f=!1;const m=(s??"*").split("").map(p=>/\s/.test(p)&&!f?"":(p==='"'&&(f=!f),p)).join("");return this.url.searchParams.set("select",m),l&&this.headers.append("Prefer",`count=${l}`),new r.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:o,defaultToNull:l=!0}={}){var u;const f="POST";if(o&&this.headers.append("Prefer",`count=${o}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const m=s.reduce((p,v)=>p.concat(Object.keys(v)),[]);if(m.length>0){const p=[...new Set(m)].map(v=>`"${v}"`);this.url.searchParams.set("columns",p.join(","))}}return new r.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}upsert(s,{onConflict:o,ignoreDuplicates:l=!1,count:u,defaultToNull:f=!0}={}){var m;const p="POST";if(this.headers.append("Prefer",`resolution=${l?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),u&&this.headers.append("Prefer",`count=${u}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const v=s.reduce((y,S)=>y.concat(Object.keys(S)),[]);if(v.length>0){const y=[...new Set(v)].map(S=>`"${S}"`);this.url.searchParams.set("columns",y.join(","))}}return new r.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(s,{count:o}={}){var l;const u="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new r.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}delete({count:s}={}){var o;const l="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new r.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return Fo.default=e,Fo}var $g;function sb(){if($g)return jo;$g=1;var t=jo&&jo.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(jo,"__esModule",{value:!0});const r=t(Ax()),e=t(sh());class n{constructor(o,{headers:l={},schema:u,fetch:f}={}){this.url=o,this.headers=new Headers(l),this.schemaName=u,this.fetch=f}from(o){const l=new URL(`${this.url}/${o}`);return new r.default(l,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,l={},{head:u=!1,get:f=!1,count:m}={}){var p;let v;const y=new URL(`${this.url}/rpc/${o}`);let S;u||f?(v=u?"HEAD":"GET",Object.entries(l).filter(([w,E])=>E!==void 0).map(([w,E])=>[w,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([w,E])=>{y.searchParams.append(w,E)})):(v="POST",S=l);const k=new Headers(this.headers);return m&&k.set("Prefer",`count=${m}`),new e.default({method:v,url:y,headers:k,schema:this.schemaName,body:S,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return jo.default=n,jo}var Bg;function ab(){if(Bg)return Or;Bg=1;var t=Or&&Or.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Or,"__esModule",{value:!0}),Or.PostgrestError=Or.PostgrestBuilder=Or.PostgrestTransformBuilder=Or.PostgrestFilterBuilder=Or.PostgrestQueryBuilder=Or.PostgrestClient=void 0;const r=t(sb());Or.PostgrestClient=r.default;const e=t(Ax());Or.PostgrestQueryBuilder=e.default;const n=t(sh());Or.PostgrestFilterBuilder=n.default;const s=t(Cx());Or.PostgrestTransformBuilder=s.default;const o=t(Nx());Or.PostgrestBuilder=o.default;const l=t(Tx());return Or.PostgrestError=l.default,Or.default={PostgrestClient:r.default,PostgrestQueryBuilder:e.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:o.default,PostgrestError:l.default},Or}var ib=ab();const ob=Jf(ib),{PostgrestClient:lb,PostgrestQueryBuilder:xA,PostgrestFilterBuilder:vA,PostgrestTransformBuilder:yA,PostgrestBuilder:wA,PostgrestError:bA}=ob;class cb{static detectEnvironment(){var r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((r=navigator.userAgent)===null||r===void 0)&&r.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const e=parseInt(process.versions.node.split(".")[0]);return e>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${e} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${e} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const r=this.detectEnvironment();if(r.constructor)return r.constructor;let e=r.error||"WebSocket not supported in this environment.";throw r.workaround&&(e+=`

Suggested solution: ${r.workaround}`),new Error(e)}static createWebSocket(r,e){const n=this.getWebSocketConstructor();return new n(r,e)}static isWebSocketSupported(){try{const r=this.detectEnvironment();return r.type==="native"||r.type==="ws"}catch{return!1}}}const ub="2.15.4",db=`realtime-js/${ub}`,fb="1.0.0",Af=1e4,hb=1e3,mb=100;var Jl;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Jl||(Jl={}));var Er;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Er||(Er={}));var gs;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(gs||(gs={}));var Rf;(function(t){t.websocket="websocket"})(Rf||(Rf={}));var Ui;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ui||(Ui={}));class gb{constructor(){this.HEADER_LENGTH=1}decode(r,e){return r.constructor===ArrayBuffer?e(this._binaryDecode(r)):e(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const e=new DataView(r),n=new TextDecoder;return this._decodeBroadcast(r,e,n)}_decodeBroadcast(r,e,n){const s=e.getUint8(1),o=e.getUint8(2);let l=this.HEADER_LENGTH+2;const u=n.decode(r.slice(l,l+s));l=l+s;const f=n.decode(r.slice(l,l+o));l=l+o;const m=JSON.parse(n.decode(r.slice(l,r.byteLength)));return{ref:null,topic:u,event:f,payload:m}}}class Rx{constructor(r,e){this.callback=r,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Kt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Kt||(Kt={}));const Vg=(t,r,e={})=>{var n;const s=(n=e.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(r).reduce((o,l)=>(o[l]=pb(l,t,r,s),o),{})},pb=(t,r,e,n)=>{const s=r.find(u=>u.name===t),o=s?.type,l=e[t];return o&&!n.includes(o)?Ix(o,l):If(l)},Ix=(t,r)=>{if(t.charAt(0)==="_"){const e=t.slice(1,t.length);return wb(r,e)}switch(t){case Kt.bool:return xb(r);case Kt.float4:case Kt.float8:case Kt.int2:case Kt.int4:case Kt.int8:case Kt.numeric:case Kt.oid:return vb(r);case Kt.json:case Kt.jsonb:return yb(r);case Kt.timestamp:return bb(r);case Kt.abstime:case Kt.date:case Kt.daterange:case Kt.int4range:case Kt.int8range:case Kt.money:case Kt.reltime:case Kt.text:case Kt.time:case Kt.timestamptz:case Kt.timetz:case Kt.tsrange:case Kt.tstzrange:return If(r);default:return If(r)}},If=t=>t,xb=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},vb=t=>{if(typeof t=="string"){const r=parseFloat(t);if(!Number.isNaN(r))return r}return t},yb=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(r){return console.log(`JSON parse error: ${r}`),t}return t},wb=(t,r)=>{if(typeof t!="string")return t;const e=t.length-1,n=t[e];if(t[0]==="{"&&n==="}"){let o;const l=t.slice(1,e);try{o=JSON.parse("["+l+"]")}catch{o=l?l.split(","):[]}return o.map(u=>Ix(r,u))}return t},bb=t=>typeof t=="string"?t.replace(" ","T"):t,Ox=t=>{let r=t;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")+"/api/broadcast"};class lf{constructor(r,e,n={},s=Af){this.channel=r,this.event=e,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,e){var n;return this._hasReceived(r)&&e((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:r,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:e}){this.recHooks.filter(n=>n.status===r).forEach(n=>n.callback(e))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var Wg;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Wg||(Wg={}));class Yl{constructor(r,e){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:o,onLeave:l,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Yl.syncState(this.state,s,o,l),this.pendingDiffs.forEach(f=>{this.state=Yl.syncDiff(this.state,f,o,l)}),this.pendingDiffs=[],u()}),this.channel._on(n.diff,{},s=>{const{onJoin:o,onLeave:l,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Yl.syncDiff(this.state,s,o,l),u())}),this.onJoin((s,o,l)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:o,newPresences:l})}),this.onLeave((s,o,l)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:o,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,e,n,s){const o=this.cloneDeep(r),l=this.transformState(e),u={},f={};return this.map(o,(m,p)=>{l[m]||(f[m]=p)}),this.map(l,(m,p)=>{const v=o[m];if(v){const y=p.map(E=>E.presence_ref),S=v.map(E=>E.presence_ref),k=p.filter(E=>S.indexOf(E.presence_ref)<0),w=v.filter(E=>y.indexOf(E.presence_ref)<0);k.length>0&&(u[m]=k),w.length>0&&(f[m]=w)}else u[m]=p}),this.syncDiff(o,{joins:u,leaves:f},n,s)}static syncDiff(r,e,n,s){const{joins:o,leaves:l}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(o,(u,f)=>{var m;const p=(m=r[u])!==null&&m!==void 0?m:[];if(r[u]=this.cloneDeep(f),p.length>0){const v=r[u].map(S=>S.presence_ref),y=p.filter(S=>v.indexOf(S.presence_ref)<0);r[u].unshift(...y)}n(u,p,f)}),this.map(l,(u,f)=>{let m=r[u];if(!m)return;const p=f.map(v=>v.presence_ref);m=m.filter(v=>p.indexOf(v.presence_ref)<0),r[u]=m,s(u,m,f),m.length===0&&delete r[u]}),r}static map(r,e){return Object.getOwnPropertyNames(r).map(n=>e(n,r[n]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((e,n)=>{const s=r[n];return"metas"in s?e[n]=s.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):e[n]=s,e},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Hg;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Hg||(Hg={}));var Ql;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Ql||(Ql={}));var oa;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(oa||(oa={}));class ah{constructor(r,e={config:{}},n){this.topic=r,this.params=e,this.socket=n,this.bindings={},this.state=Er.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new lf(this,gs.join,this.params,this.timeout),this.rejoinTimer=new Rx(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Er.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Er.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Er.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Er.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Er.errored,this.rejoinTimer.scheduleTimeout())}),this._on(gs.reply,{},(s,o)=>{this._trigger(this._replyEventName(o),s)}),this.presence=new Yl(this),this.broadcastEndpointURL=Ox(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(r,e=this.timeout){var n,s,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Er.closed){const{config:{broadcast:l,presence:u,private:f}}=this.params,m=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(S=>S.filter))!==null&&s!==void 0?s:[],p=!!this.bindings[Ql.PRESENCE]&&this.bindings[Ql.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,v={},y={broadcast:l,presence:Object.assign(Object.assign({},u),{enabled:p}),postgres_changes:m,private:f};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(S=>r?.(oa.CHANNEL_ERROR,S)),this._onClose(()=>r?.(oa.CLOSED)),this.updateJoinPayload(Object.assign({config:y},v)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:S})=>{var k;if(this.socket.setAuth(),S===void 0){r?.(oa.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,E=(k=w?.length)!==null&&k!==void 0?k:0,F=[];for(let B=0;B<E;B++){const C=w[B],{filter:{event:M,schema:re,table:O,filter:U}}=C,ee=S&&S[B];if(ee&&ee.event===M&&ee.schema===re&&ee.table===O&&ee.filter===U)F.push(Object.assign(Object.assign({},C),{id:ee.id}));else{this.unsubscribe(),this.state=Er.errored,r?.(oa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=F,r&&r(oa.SUBSCRIBED);return}}).receive("error",S=>{this.state=Er.errored,r?.(oa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(S).join(", ")||"error")))}).receive("timeout",()=>{r?.(oa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,e={}){return await this.send({type:"presence",event:"track",payload:r},e.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,e,n){return this.state===Er.joined&&r===Ql.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(r,e,n)}async send(r,e={}){var n,s;if(!this._canPush()&&r.type==="broadcast"){const{event:o,payload:l}=r,f={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:l,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(n=e.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=m.body)===null||s===void 0?void 0:s.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var l,u,f;const m=this._push(r.type,r,e.timeout||this.timeout);r.type==="broadcast"&&!(!((f=(u=(l=this.params)===null||l===void 0?void 0:l.config)===null||u===void 0?void 0:u.broadcast)===null||f===void 0)&&f.ack)&&o("ok"),m.receive("ok",()=>o("ok")),m.receive("error",()=>o("error")),m.receive("timeout",()=>o("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=Er.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(gs.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new lf(this,gs.leave,{},r),n.receive("ok",()=>{e(),s("ok")}).receive("timeout",()=>{e(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Er.closed,this.bindings={}}async _fetchWithTimeout(r,e,n){const s=new AbortController,o=setTimeout(()=>s.abort(),n),l=await this.socket.fetch(r,Object.assign(Object.assign({},e),{signal:s.signal}));return clearTimeout(o),l}_push(r,e,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new lf(this,r,e,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(r){if(r.startTimeout(),this.pushBuffer.push(r),this.pushBuffer.length>mb){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(r,e,n){return e}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,e,n){var s,o;const l=r.toLocaleLowerCase(),{close:u,error:f,leave:m,join:p}=gs;if(n&&[u,f,m,p].indexOf(l)>=0&&n!==this._joinRef())return;let y=this._onMessage(l,e,n);if(e&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(S=>{var k,w,E;return((k=S.filter)===null||k===void 0?void 0:k.event)==="*"||((E=(w=S.filter)===null||w===void 0?void 0:w.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===l}).map(S=>S.callback(y,n)):(o=this.bindings[l])===null||o===void 0||o.filter(S=>{var k,w,E,F,B,C;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in S){const M=S.id,re=(k=S.filter)===null||k===void 0?void 0:k.event;return M&&((w=e.ids)===null||w===void 0?void 0:w.includes(M))&&(re==="*"||re?.toLocaleLowerCase()===((E=e.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const M=(B=(F=S?.filter)===null||F===void 0?void 0:F.event)===null||B===void 0?void 0:B.toLocaleLowerCase();return M==="*"||M===((C=e?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===l}).map(S=>{if(typeof y=="object"&&"ids"in y){const k=y.data,{schema:w,table:E,commit_timestamp:F,type:B,errors:C}=k;y=Object.assign(Object.assign({},{schema:w,table:E,commit_timestamp:F,eventType:B,new:{},old:{},errors:C}),this._getPayloadRecords(k))}S.callback(y,n)})}_isClosed(){return this.state===Er.closed}_isJoined(){return this.state===Er.joined}_isJoining(){return this.state===Er.joining}_isLeaving(){return this.state===Er.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,e,n){const s=r.toLocaleLowerCase(),o={type:s,filter:e,callback:n};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(r,e){const n=r.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var o;return!(((o=s.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&ah.isEqual(s.filter,e))})),this}static isEqual(r,e){if(Object.keys(r).length!==Object.keys(e).length)return!1;for(const n in r)if(r[n]!==e[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(gs.close,{},r)}_onError(r){this._on(gs.error,{},e=>r(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Er.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const e={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(e.new=Vg(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(e.old=Vg(r.columns,r.old_record)),e}}const cf=()=>{},Mu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},_b=[1e3,2e3,5e3,1e4],Sb=1e4,Eb=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class kb{constructor(r,e){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Af,this.transport=null,this.heartbeatIntervalMs=Mu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=cf,this.ref=0,this.reconnectTimer=null,this.logger=cf,this.conn=null,this.sendBuffer=[],this.serializer=new gb,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...l)=>nl(async()=>{const{default:u}=await Promise.resolve().then(()=>sl);return{default:u}},void 0).then(({default:u})=>u(...l)).catch(u=>{throw new Error(`Failed to load @supabase/node-fetch: ${u.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...l)=>o(...l)},!(!((n=e?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=e.params.apikey,this.endPoint=`${r}/${Rf.websocket}`,this.httpEndpoint=Ox(r),this._initializeOptions(e),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(e?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=cb.createWebSocket(this.endpointURL())}catch(r){this._setConnectionState("disconnected");const e=r.message;throw e.includes("Node.js")?new Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:fb}))}disconnect(r,e){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},r?this.conn.close(r,e??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(r){const e=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const r=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,e,n){this.logger(r,e,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Jl.connecting:return Ui.Connecting;case Jl.open:return Ui.Open;case Jl.closing:return Ui.Closing;default:return Ui.Closed}}isConnected(){return this.connectionState()===Ui.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(r,e={config:{}}){const n=`realtime:${r}`,s=this.getChannels().find(o=>o.topic===n);if(s)return s;{const o=new ah(`realtime:${r}`,e,this);return this.channels.push(o),o}}push(r){const{topic:e,event:n,payload:s,ref:o}=r,l=()=>{this.encode(r,u=>{var f;(f=this.conn)===null||f===void 0||f.send(u)})};this.log("push",`${e} ${n} (${o})`,s),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(r=null){this._authPromise=this._performAuth(r);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var r;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,(r=this.conn)===null||r===void 0||r.close(hb,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout()},Mu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let e=this.channels.find(n=>n.topic===r&&(n._isJoined()||n._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${r}"`),e.unsubscribe())}_remove(r){this.channels=this.channels.filter(e=>e.topic!==r.topic)}_onConnMessage(r){this.decode(r.data,e=>{if(e.topic==="phoenix"&&e.event==="phx_reply")try{this.heartbeatCallback(e.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:o,ref:l}=e,u=l?`(${l})`:"",f=o.status||"";this.log("receive",`${f} ${n} ${s} ${u}`.trim(),o),this.channels.filter(m=>m._isMember(n)).forEach(m=>m._trigger(s,o,l)),this._triggerStateCallbacks("message",e)})}_clearTimer(r){var e;r==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):r==="reconnect"&&((e=this.reconnectTimer)===null||e===void 0||e.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(r=>r.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(r){var e;this._setConnectionState("disconnected"),this.log("transport","close",r),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout(),this._triggerStateCallbacks("close",r)}_onConnError(r){this._setConnectionState("disconnected"),this.log("transport",`${r}`),this._triggerChanError(),this._triggerStateCallbacks("error",r)}_triggerChanError(){this.channels.forEach(r=>r._trigger(gs.error))}_appendParams(r,e){if(Object.keys(e).length===0)return r;const n=r.match(/\?/)?"&":"?",s=new URLSearchParams(e);return`${r}${n}${s}`}_workerObjectUrl(r){let e;if(r)e=r;else{const n=new Blob([Eb],{type:"application/javascript"});e=URL.createObjectURL(n)}return e}_setConnectionState(r,e=!1){this._connectionState=r,r==="connecting"?this._wasManualDisconnect=!1:r==="disconnecting"&&(this._wasManualDisconnect=e)}async _performAuth(r=null){let e;r?e=r:this.accessToken?e=await this.accessToken():e=this.accessTokenValue,this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(n=>{const s={access_token:e,version:db};e&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(gs.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(r="general"){this.setAuth().catch(e=>{this.log("error",`error setting auth in ${r}`,e)})}_triggerStateCallbacks(r,e){try{this.stateChangeCallbacks[r].forEach(n=>{try{n(e)}catch(s){this.log("error",`error in ${r} callback`,s)}})}catch(n){this.log("error",`error triggering ${r} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Rx(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Mu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(r){var e,n,s,o,l,u,f,m,p;if(this.transport=(e=r?.transport)!==null&&e!==void 0?e:null,this.timeout=(n=r?.timeout)!==null&&n!==void 0?n:Af,this.heartbeatIntervalMs=(s=r?.heartbeatIntervalMs)!==null&&s!==void 0?s:Mu.HEARTBEAT_INTERVAL,this.worker=(o=r?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(l=r?.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(u=r?.heartbeatCallback)!==null&&u!==void 0?u:cf,r?.params&&(this.params=r.params),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=r?.reconnectAfterMs)!==null&&f!==void 0?f:(v=>_b[v-1]||Sb),this.encode=(m=r?.encode)!==null&&m!==void 0?m:((v,y)=>y(JSON.stringify(v))),this.decode=(p=r?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=r?.workerUrl}}}class ih extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function kr(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Tb extends ih{constructor(r,e,n){super(r),this.name="StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Of extends ih{constructor(r,e){super(r),this.name="StorageUnknownError",this.originalError=e}}var Nb=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};const jx=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>nl(async()=>{const{default:n}=await Promise.resolve().then(()=>sl);return{default:n}},void 0).then(({default:n})=>n(...e)):r=fetch,(...e)=>r(...e)},Cb=()=>Nb(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield nl(()=>Promise.resolve().then(()=>sl),void 0)).Response:Response}),jf=t=>{if(Array.isArray(t))return t.map(e=>jf(e));if(typeof t=="function"||t!==Object(t))return t;const r={};return Object.entries(t).forEach(([e,n])=>{const s=e.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));r[s]=jf(n)}),r},Ab=t=>{if(typeof t!="object"||t===null)return!1;const r=Object.getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Ki=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};const uf=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Rb=(t,r,e)=>Ki(void 0,void 0,void 0,function*(){const n=yield Cb();t instanceof n&&!e?.noResolveJson?t.json().then(s=>{const o=t.status||500,l=s?.statusCode||o+"";r(new Tb(uf(s),o,l))}).catch(s=>{r(new Of(uf(s),s))}):r(new Of(uf(t),t))}),Ib=(t,r,e,n)=>{const s={method:t,headers:r?.headers||{}};return t==="GET"||!n?s:(Ab(n)?(s.headers=Object.assign({"Content-Type":"application/json"},r?.headers),s.body=JSON.stringify(n)):s.body=n,r?.duplex&&(s.duplex=r.duplex),Object.assign(Object.assign({},s),e))};function _c(t,r,e,n,s,o){return Ki(this,void 0,void 0,function*(){return new Promise((l,u)=>{t(e,Ib(r,n,s,o)).then(f=>{if(!f.ok)throw f;return n?.noResolveJson?f:f.json()}).then(f=>l(f)).catch(f=>Rb(f,u,n))})})}function rd(t,r,e,n){return Ki(this,void 0,void 0,function*(){return _c(t,"GET",r,e,n)})}function Fs(t,r,e,n,s){return Ki(this,void 0,void 0,function*(){return _c(t,"POST",r,n,s,e)})}function Ff(t,r,e,n,s){return Ki(this,void 0,void 0,function*(){return _c(t,"PUT",r,n,s,e)})}function Ob(t,r,e,n){return Ki(this,void 0,void 0,function*(){return _c(t,"HEAD",r,Object.assign(Object.assign({},e),{noResolveJson:!0}),n)})}function Fx(t,r,e,n,s){return Ki(this,void 0,void 0,function*(){return _c(t,"DELETE",r,n,s,e)})}var gn=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};const jb={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},zg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Fb{constructor(r,e={},n,s){this.url=r,this.headers=e,this.bucketId=n,this.fetch=jx(s)}uploadOrUpdate(r,e,n,s){return gn(this,void 0,void 0,function*(){try{let o;const l=Object.assign(Object.assign({},zg),s);let u=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(l.upsert)});const f=l.metadata;typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",l.cacheControl),f&&o.append("metadata",this.encodeMetadata(f)),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.append("cacheControl",l.cacheControl),f&&o.append("metadata",this.encodeMetadata(f))):(o=n,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType,f&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(f)))),s?.headers&&(u=Object.assign(Object.assign({},u),s.headers));const m=this._removeEmptyFolders(e),p=this._getFinalPath(m),v=yield(r=="PUT"?Ff:Fs)(this.fetch,`${this.url}/object/${p}`,o,Object.assign({headers:u},l?.duplex?{duplex:l.duplex}:{}));return{data:{path:m,id:v.Id,fullPath:v.Key},error:null}}catch(o){if(kr(o))return{data:null,error:o};throw o}})}upload(r,e,n){return gn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,e,n)})}uploadToSignedUrl(r,e,n,s){return gn(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(r),l=this._getFinalPath(o),u=new URL(this.url+`/object/upload/sign/${l}`);u.searchParams.set("token",e);try{let f;const m=Object.assign({upsert:zg.upsert},s),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&n instanceof Blob?(f=new FormData,f.append("cacheControl",m.cacheControl),f.append("",n)):typeof FormData<"u"&&n instanceof FormData?(f=n,f.append("cacheControl",m.cacheControl)):(f=n,p["cache-control"]=`max-age=${m.cacheControl}`,p["content-type"]=m.contentType);const v=yield Ff(this.fetch,u.toString(),f,{headers:p});return{data:{path:o,fullPath:v.Key},error:null}}catch(f){if(kr(f))return{data:null,error:f};throw f}})}createSignedUploadUrl(r,e){return gn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(r);const s=Object.assign({},this.headers);e?.upsert&&(s["x-upsert"]="true");const o=yield Fs(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),l=new URL(this.url+o.url),u=l.searchParams.get("token");if(!u)throw new ih("No token returned by API");return{data:{signedUrl:l.toString(),path:r,token:u},error:null}}catch(n){if(kr(n))return{data:null,error:n};throw n}})}update(r,e,n){return gn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,e,n)})}move(r,e,n){return gn(this,void 0,void 0,function*(){try{return{data:yield Fs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(kr(s))return{data:null,error:s};throw s}})}copy(r,e,n){return gn(this,void 0,void 0,function*(){try{return{data:{path:(yield Fs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(kr(s))return{data:null,error:s};throw s}})}createSignedUrl(r,e,n){return gn(this,void 0,void 0,function*(){try{let s=this._getFinalPath(r),o=yield Fs(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:e},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${l}`)},{data:o,error:null}}catch(s){if(kr(s))return{data:null,error:s};throw s}})}createSignedUrls(r,e,n){return gn(this,void 0,void 0,function*(){try{const s=yield Fs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:r},{headers:this.headers}),o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${o}`):null})),error:null}}catch(s){if(kr(s))return{data:null,error:s};throw s}})}download(r,e){return gn(this,void 0,void 0,function*(){const s=typeof e?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(e?.transform||{}),l=o?`?${o}`:"";try{const u=this._getFinalPath(r);return{data:yield(yield rd(this.fetch,`${this.url}/${s}/${u}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(u){if(kr(u))return{data:null,error:u};throw u}})}info(r){return gn(this,void 0,void 0,function*(){const e=this._getFinalPath(r);try{const n=yield rd(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:jf(n),error:null}}catch(n){if(kr(n))return{data:null,error:n};throw n}})}exists(r){return gn(this,void 0,void 0,function*(){const e=this._getFinalPath(r);try{return yield Ob(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(kr(n)&&n instanceof Of){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(r,e){const n=this._getFinalPath(r),s=[],o=e?.download?`download=${e.download===!0?"":e.download}`:"";o!==""&&s.push(o);const u=typeof e?.transform<"u"?"render/image":"object",f=this.transformOptsToQueryString(e?.transform||{});f!==""&&s.push(f);let m=s.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${n}${m}`)}}}remove(r){return gn(this,void 0,void 0,function*(){try{return{data:yield Fx(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(e){if(kr(e))return{data:null,error:e};throw e}})}list(r,e,n){return gn(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},jb),e),{prefix:r||""});return{data:yield Fs(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(kr(s))return{data:null,error:s};throw s}})}listV2(r,e){return gn(this,void 0,void 0,function*(){try{const n=Object.assign({},r);return{data:yield Fs(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},e),error:null}}catch(n){if(kr(n))return{data:null,error:n};throw n}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const e=[];return r.width&&e.push(`width=${r.width}`),r.height&&e.push(`height=${r.height}`),r.resize&&e.push(`resize=${r.resize}`),r.format&&e.push(`format=${r.format}`),r.quality&&e.push(`quality=${r.quality}`),e.join("&")}}const Db="2.11.1",Pb={"X-Client-Info":`storage-js/${Db}`};var Mo=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};class Lb{constructor(r,e={},n,s){const o=new URL(r);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href,this.headers=Object.assign(Object.assign({},Pb),e),this.fetch=jx(n)}listBuckets(){return Mo(this,void 0,void 0,function*(){try{return{data:yield rd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(kr(r))return{data:null,error:r};throw r}})}getBucket(r){return Mo(this,void 0,void 0,function*(){try{return{data:yield rd(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(e){if(kr(e))return{data:null,error:e};throw e}})}createBucket(r,e={public:!1}){return Mo(this,void 0,void 0,function*(){try{return{data:yield Fs(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(kr(n))return{data:null,error:n};throw n}})}updateBucket(r,e){return Mo(this,void 0,void 0,function*(){try{return{data:yield Ff(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(kr(n))return{data:null,error:n};throw n}})}emptyBucket(r){return Mo(this,void 0,void 0,function*(){try{return{data:yield Fs(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(kr(e))return{data:null,error:e};throw e}})}deleteBucket(r){return Mo(this,void 0,void 0,function*(){try{return{data:yield Fx(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(e){if(kr(e))return{data:null,error:e};throw e}})}}class Mb extends Lb{constructor(r,e={},n,s){super(r,e,n,s)}from(r){return new Fb(this.url,this.headers,r,this.fetch)}}const Ub="2.57.0";let zl="";typeof Deno<"u"?zl="deno":typeof document<"u"?zl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?zl="react-native":zl="node";const $b={"X-Client-Info":`supabase-js-${zl}/${Ub}`},Bb={headers:$b},Vb={schema:"public"},Wb={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Hb={};var zb=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};const Gb=t=>{let r;return t?r=t:typeof fetch>"u"?r=Ex:r=fetch,(...e)=>r(...e)},Kb=()=>typeof Headers>"u"?kx:Headers,Xb=(t,r,e)=>{const n=Gb(e),s=Kb();return(o,l)=>zb(void 0,void 0,void 0,function*(){var u;const f=(u=yield r())!==null&&u!==void 0?u:t;let m=new s(l?.headers);return m.has("apikey")||m.set("apikey",t),m.has("Authorization")||m.set("Authorization",`Bearer ${f}`),n(o,Object.assign(Object.assign({},l),{headers:m}))})};var qb=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};function Jb(t){return t.endsWith("/")?t:t+"/"}function Yb(t,r){var e,n;const{db:s,auth:o,realtime:l,global:u}=t,{db:f,auth:m,realtime:p,global:v}=r,y={db:Object.assign(Object.assign({},f),s),auth:Object.assign(Object.assign({},m),o),realtime:Object.assign(Object.assign({},p),l),storage:{},global:Object.assign(Object.assign(Object.assign({},v),u),{headers:Object.assign(Object.assign({},(e=v?.headers)!==null&&e!==void 0?e:{}),(n=u?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>qb(this,void 0,void 0,function*(){return""})};return t.accessToken?y.accessToken=t.accessToken:delete y.accessToken,y}const Dx="2.71.1",Ho=30*1e3,Df=3,df=Df*Ho,Qb="http://localhost:9999",Zb="supabase.auth.token",e_={"X-Client-Info":`gotrue-js/${Dx}`},Pf="X-Supabase-Api-Version",Px={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},t_=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,r_=600*1e3;class oh extends Error{constructor(r,e,n){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=n}}function mt(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class n_ extends oh{constructor(r,e,n){super(r,e,n),this.name="AuthApiError",this.status=e,this.code=n}}function s_(t){return mt(t)&&t.name==="AuthApiError"}class Lx extends oh{constructor(r,e){super(r),this.name="AuthUnknownError",this.originalError=e}}class ti extends oh{constructor(r,e,n,s){super(r,n,s),this.name=e,this.status=n}}class Ka extends ti{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function a_(t){return mt(t)&&t.name==="AuthSessionMissingError"}class Uu extends ti{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class $u extends ti{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class Bu extends ti{constructor(r,e=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function i_(t){return mt(t)&&t.name==="AuthImplicitGrantRedirectError"}class Gg extends ti{constructor(r,e=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Lf extends ti{constructor(r,e){super(r,"AuthRetryableFetchError",e,void 0)}}function ff(t){return mt(t)&&t.name==="AuthRetryableFetchError"}class Kg extends ti{constructor(r,e,n){super(r,"AuthWeakPasswordError",e,"weak_password"),this.reasons=n}}class Mf extends ti{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const nd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xg=` 	
\r=`.split(""),o_=(()=>{const t=new Array(128);for(let r=0;r<t.length;r+=1)t[r]=-1;for(let r=0;r<Xg.length;r+=1)t[Xg[r].charCodeAt(0)]=-2;for(let r=0;r<nd.length;r+=1)t[nd[r].charCodeAt(0)]=r;return t})();function qg(t,r,e){if(t!==null)for(r.queue=r.queue<<8|t,r.queuedBits+=8;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;e(nd[n]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;e(nd[n]),r.queuedBits-=6}}function Mx(t,r,e){const n=o_[t];if(n>-1)for(r.queue=r.queue<<6|n,r.queuedBits+=6;r.queuedBits>=8;)e(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Jg(t){const r=[],e=l=>{r.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},o=l=>{u_(l,n,e)};for(let l=0;l<t.length;l+=1)Mx(t.charCodeAt(l),s,o);return r.join("")}function l_(t,r){if(t<=127){r(t);return}else if(t<=2047){r(192|t>>6),r(128|t&63);return}else if(t<=65535){r(224|t>>12),r(128|t>>6&63),r(128|t&63);return}else if(t<=1114111){r(240|t>>18),r(128|t>>12&63),r(128|t>>6&63),r(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function c_(t,r){for(let e=0;e<t.length;e+=1){let n=t.charCodeAt(e);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(e+1)-56320&65535|s)+65536,e+=1}l_(n,r)}}function u_(t,r,e){if(r.utf8seq===0){if(t<=127){e(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){r.utf8seq=n;break}if(r.utf8seq===2)r.codepoint=t&31;else if(r.utf8seq===3)r.codepoint=t&15;else if(r.utf8seq===4)r.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|t&63,r.utf8seq-=1,r.utf8seq===0&&e(r.codepoint)}}function d_(t){const r=[],e={queue:0,queuedBits:0},n=s=>{r.push(s)};for(let s=0;s<t.length;s+=1)Mx(t.charCodeAt(s),e,n);return new Uint8Array(r)}function f_(t){const r=[];return c_(t,e=>r.push(e)),new Uint8Array(r)}function h_(t){const r=[],e={queue:0,queuedBits:0},n=s=>{r.push(s)};return t.forEach(s=>qg(s,e,n)),qg(null,e,n),r.join("")}function m_(t){return Math.round(Date.now()/1e3)+t}function g_(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const r=Math.random()*16|0;return(t=="x"?r:r&3|8).toString(16)})}const ms=()=>typeof window<"u"&&typeof document<"u",Di={tested:!1,writable:!1},Ux=()=>{if(!ms())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Di.tested)return Di.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Di.tested=!0,Di.writable=!0}catch{Di.tested=!0,Di.writable=!1}return Di.writable};function p_(t){const r={},e=new URL(t);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((s,o)=>{r[o]=s})}catch{}return e.searchParams.forEach((n,s)=>{r[s]=n}),r}const $x=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>nl(async()=>{const{default:n}=await Promise.resolve().then(()=>sl);return{default:n}},void 0).then(({default:n})=>n(...e)):r=fetch,(...e)=>r(...e)},x_=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",zo=async(t,r,e)=>{await t.setItem(r,JSON.stringify(e))},Pi=async(t,r)=>{const e=await t.getItem(r);if(!e)return null;try{return JSON.parse(e)}catch{return e}},Ha=async(t,r)=>{await t.removeItem(r)};class vd{constructor(){this.promise=new vd.promiseConstructor((r,e)=>{this.resolve=r,this.reject=e})}}vd.promiseConstructor=Promise;function hf(t){const r=t.split(".");if(r.length!==3)throw new Mf("Invalid JWT structure");for(let n=0;n<r.length;n++)if(!t_.test(r[n]))throw new Mf("JWT not in base64url format");return{header:JSON.parse(Jg(r[0])),payload:JSON.parse(Jg(r[1])),signature:d_(r[2]),raw:{header:r[0],payload:r[1]}}}async function v_(t){return await new Promise(r=>{setTimeout(()=>r(null),t)})}function y_(t,r){return new Promise((n,s)=>{(async()=>{for(let o=0;o<1/0;o++)try{const l=await t(o);if(!r(o,null,l)){n(l);return}}catch(l){if(!r(o,l)){s(l);return}}})()})}function w_(t){return("0"+t.toString(16)).substr(-2)}function b_(){const r=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=e.length;let s="";for(let o=0;o<56;o++)s+=e.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(r),Array.from(r,w_).join("")}async function __(t){const e=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",e),s=new Uint8Array(n);return Array.from(s).map(o=>String.fromCharCode(o)).join("")}async function S_(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const e=await __(t);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Uo(t,r,e=!1){const n=b_();let s=n;e&&(s+="/PASSWORD_RECOVERY"),await zo(t,`${r}-code-verifier`,s);const o=await S_(n);return[o,n===o?"plain":"s256"]}const E_=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function k_(t){const r=t.headers.get(Pf);if(!r||!r.match(E_))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function T_(t){if(!t)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(t<=r)throw new Error("JWT has expired")}function N_(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const C_=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function $o(t){if(!C_.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function mf(){const t={};return new Proxy(t,{get:(r,e)=>{if(e==="__isUserNotAvailableProxy")return!0;if(typeof e=="symbol"){const n=e.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${e}" property of the session object is not supported. Please use getUser() instead.`)},set:(r,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(r,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Yg(t){return JSON.parse(JSON.stringify(t))}var A_=function(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(e[n[s]]=t[n[s]]);return e};const Mi=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),R_=[502,503,504];async function Qg(t){var r;if(!x_(t))throw new Lf(Mi(t),0);if(R_.includes(t.status))throw new Lf(Mi(t),t.status);let e;try{e=await t.json()}catch(o){throw new Lx(Mi(o),o)}let n;const s=k_(t);if(s&&s.getTime()>=Px["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?n=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(n=e.error_code),n){if(n==="weak_password")throw new Kg(Mi(e),t.status,((r=e.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(n==="session_not_found")throw new Ka}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((o,l)=>o&&typeof l=="string",!0))throw new Kg(Mi(e),t.status,e.weak_password.reasons);throw new n_(Mi(e),t.status||500,n)}const I_=(t,r,e,n)=>{const s={method:t,headers:r?.headers||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),e))};async function yt(t,r,e,n){var s;const o=Object.assign({},n?.headers);o[Pf]||(o[Pf]=Px["2024-01-01"].name),n?.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const l=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(l.redirect_to=n.redirectTo);const u=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",f=await O_(t,r,e+u,{headers:o,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(f):{data:Object.assign({},f),error:null}}async function O_(t,r,e,n,s,o){const l=I_(r,n,s,o);let u;try{u=await t(e,Object.assign({},l))}catch(f){throw console.error(f),new Lf(Mi(f),0)}if(u.ok||await Qg(u),n?.noResolveJson)return u;try{return await u.json()}catch(f){await Qg(f)}}function ia(t){var r;let e=null;P_(t)&&(e=Object.assign({},t),t.expires_at||(e.expires_at=m_(t.expires_in)));const n=(r=t.user)!==null&&r!==void 0?r:t;return{data:{session:e,user:n},error:null}}function Zg(t){const r=ia(t);return!r.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((e,n)=>e&&typeof n=="string",!0)&&(r.data.weak_password=t.weak_password),r}function Xa(t){var r;return{data:{user:(r=t.user)!==null&&r!==void 0?r:t},error:null}}function j_(t){return{data:t,error:null}}function F_(t){const{action_link:r,email_otp:e,hashed_token:n,redirect_to:s,verification_type:o}=t,l=A_(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:r,email_otp:e,hashed_token:n,redirect_to:s,verification_type:o},f=Object.assign({},l);return{data:{properties:u,user:f},error:null}}function D_(t){return t}function P_(t){return t.access_token&&t.refresh_token&&t.expires_in}const gf=["global","local","others"];var L_=function(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(e[n[s]]=t[n[s]]);return e};class M_{constructor({url:r="",headers:e={},fetch:n}){this.url=r,this.headers=e,this.fetch=$x(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,e=gf[0]){if(gf.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${gf.join(", ")}`);try{return await yt(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(n){if(mt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(r,e={}){try{return await yt(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:Xa})}catch(n){if(mt(n))return{data:{user:null},error:n};throw n}}async generateLink(r){try{const{options:e}=r,n=L_(r,["options"]),s=Object.assign(Object.assign({},n),e);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await yt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:F_,redirectTo:e?.redirectTo})}catch(e){if(mt(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(r){try{return await yt(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:Xa})}catch(e){if(mt(e))return{data:{user:null},error:e};throw e}}async listUsers(r){var e,n,s,o,l,u,f;try{const m={nextPage:null,lastPage:0,total:0},p=await yt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(e=r?.page)===null||e===void 0?void 0:e.toString())!==null&&n!==void 0?n:"",per_page:(o=(s=r?.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:D_});if(p.error)throw p.error;const v=await p.json(),y=(l=p.headers.get("x-total-count"))!==null&&l!==void 0?l:0,S=(f=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&f!==void 0?f:[];return S.length>0&&(S.forEach(k=>{const w=parseInt(k.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(k.split(";")[1].split("=")[1]);m[`${E}Page`]=w}),m.total=parseInt(y)),{data:Object.assign(Object.assign({},v),m),error:null}}catch(m){if(mt(m))return{data:{users:[]},error:m};throw m}}async getUserById(r){$o(r);try{return await yt(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:Xa})}catch(e){if(mt(e))return{data:{user:null},error:e};throw e}}async updateUserById(r,e){$o(r);try{return await yt(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:e,headers:this.headers,xform:Xa})}catch(n){if(mt(n))return{data:{user:null},error:n};throw n}}async deleteUser(r,e=!1){$o(r);try{return await yt(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:e},xform:Xa})}catch(n){if(mt(n))return{data:{user:null},error:n};throw n}}async _listFactors(r){$o(r.userId);try{const{data:e,error:n}=await yt(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:e,error:n}}catch(e){if(mt(e))return{data:null,error:e};throw e}}async _deleteFactor(r){$o(r.userId),$o(r.id);try{return{data:await yt(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(e){if(mt(e))return{data:null,error:e};throw e}}}function ep(t={}){return{getItem:r=>t[r]||null,setItem:(r,e)=>{t[r]=e},removeItem:r=>{delete t[r]}}}function U_(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Bo={debug:!!(globalThis&&Ux()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Bx extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class $_ extends Bx{}async function B_(t,r,e){Bo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,r);const n=new globalThis.AbortController;return r>0&&setTimeout(()=>{n.abort(),Bo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Bo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await e()}finally{Bo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(r===0)throw Bo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new $_(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Bo.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await e()}}))}U_();const V_={url:Qb,storageKey:Zb,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:e_,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function tp(t,r,e){return await e()}const Vo={};class cc{constructor(r){var e,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=cc.nextInstanceID,cc.nextInstanceID+=1,this.instanceID>0&&ms()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},V_),r);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new M_({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=$x(s.fetch),this.lock=s.lock||tp,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:ms()&&(!((e=globalThis?.navigator)===null||e===void 0)&&e.locks)?this.lock=B_:this.lock=tp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:Ux()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ep(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=ep(this.memoryStorage)),ms()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}get jwks(){var r,e;return(e=(r=Vo[this.storageKey])===null||r===void 0?void 0:r.jwks)!==null&&e!==void 0?e:{keys:[]}}set jwks(r){Vo[this.storageKey]=Object.assign(Object.assign({},Vo[this.storageKey]),{jwks:r})}get jwks_cached_at(){var r,e;return(e=(r=Vo[this.storageKey])===null||r===void 0?void 0:r.cachedAt)!==null&&e!==void 0?e:Number.MIN_SAFE_INTEGER}set jwks_cached_at(r){Vo[this.storageKey]=Object.assign(Object.assign({},Vo[this.storageKey]),{cachedAt:r})}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Dx}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const e=p_(window.location.href);let n="none";if(this._isImplicitGrantCallback(e)?n="implicit":await this._isPKCECallback(e)&&(n="pkce"),ms()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:o}=await this._getSessionFromURL(e,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),i_(o)){const f=(r=o.details)===null||r===void 0?void 0:r.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:l,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",l,"redirect type",u),await this._saveSession(l),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return mt(e)?{error:e}:{error:new Lx("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var e,n,s;try{const o=await yt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(e=r?.options)===null||e===void 0?void 0:e.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=r?.options)===null||s===void 0?void 0:s.captchaToken}},xform:ia}),{data:l,error:u}=o;if(u||!l)return{data:{user:null,session:null},error:u};const f=l.session,m=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:m,session:f},error:null}}catch(o){if(mt(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(r){var e,n,s;try{let o;if("email"in r){const{email:p,password:v,options:y}=r;let S=null,k=null;this.flowType==="pkce"&&([S,k]=await Uo(this.storage,this.storageKey)),o=await yt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:p,password:v,data:(e=y?.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:S,code_challenge_method:k},xform:ia})}else if("phone"in r){const{phone:p,password:v,options:y}=r;o=await yt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:v,data:(n=y?.data)!==null&&n!==void 0?n:{},channel:(s=y?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:ia})}else throw new $u("You must provide either an email or phone number and a password");const{data:l,error:u}=o;if(u||!l)return{data:{user:null,session:null},error:u};const f=l.session,m=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:m,session:f},error:null}}catch(o){if(mt(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(r){try{let e;if("email"in r){const{email:o,password:l,options:u}=r;e=await yt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Zg})}else if("phone"in r){const{phone:o,password:l,options:u}=r;e=await yt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Zg})}else throw new $u("You must provide either an email or phone number and a password");const{data:n,error:s}=e;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Uu}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(e){if(mt(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(r){var e,n,s,o;return await this._handleProviderSignIn(r.provider,{redirectTo:(e=r.options)===null||e===void 0?void 0:e.redirectTo,scopes:(n=r.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=r.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=r.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:e}=r;if(e==="solana")return await this.signInWithSolana(r);throw new Error(`@supabase/auth-js: Unsupported chain "${e}"`)}async signInWithSolana(r){var e,n,s,o,l,u,f,m,p,v,y,S;let k,w;if("message"in r)k=r.message,w=r.signature;else{const{chain:E,wallet:F,statement:B,options:C}=r;let M;if(ms())if(typeof F=="object")M=F;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))M=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof F!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=F}const re=new URL((e=C?.url)!==null&&e!==void 0?e:window.location.href);if("signIn"in M&&M.signIn){const O=await M.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C?.signInWithSolana),{version:"1",domain:re.host,uri:re.href}),B?{statement:B}:null));let U;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")U=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)U=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in U&&"signature"in U&&(typeof U.signedMessage=="string"||U.signedMessage instanceof Uint8Array)&&U.signature instanceof Uint8Array)k=typeof U.signedMessage=="string"?U.signedMessage:new TextDecoder().decode(U.signedMessage),w=U.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in M)||typeof M.signMessage!="function"||!("publicKey"in M)||typeof M!="object"||!M.publicKey||!("toBase58"in M.publicKey)||typeof M.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");k=[`${re.host} wants you to sign in with your Solana account:`,M.publicKey.toBase58(),...B?["",B,""]:[""],"Version: 1",`URI: ${re.href}`,`Issued At: ${(s=(n=C?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((o=C?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((l=C?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((u=C?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((f=C?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((m=C?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((v=(p=C?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||v===void 0)&&v.length?["Resources",...C.signInWithSolana.resources.map(U=>`- ${U}`)]:[]].join(`
`);const O=await M.signMessage(new TextEncoder().encode(k),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=O}}try{const{data:E,error:F}=await yt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:k,signature:h_(w)},!((y=r.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(S=r.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:ia});if(F)throw F;return!E||!E.session||!E.user?{data:{user:null,session:null},error:new Uu}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),{data:Object.assign({},E),error:F})}catch(E){if(mt(E))return{data:{user:null,session:null},error:E};throw E}}async _exchangeCodeForSession(r){const e=await Pi(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(e??"").split("/");try{const{data:o,error:l}=await yt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:n},xform:ia});if(await Ha(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Uu}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:l})}catch(o){if(mt(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(r){try{const{options:e,provider:n,token:s,access_token:o,nonce:l}=r,u=await yt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:o,nonce:l,gotrue_meta_security:{captcha_token:e?.captchaToken}},xform:ia}),{data:f,error:m}=u;return m?{data:{user:null,session:null},error:m}:!f||!f.session||!f.user?{data:{user:null,session:null},error:new Uu}:(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),{data:f,error:m})}catch(e){if(mt(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(r){var e,n,s,o,l;try{if("email"in r){const{email:u,options:f}=r;let m=null,p=null;this.flowType==="pkce"&&([m,p]=await Uo(this.storage,this.storageKey));const{error:v}=await yt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(e=f?.data)!==null&&e!==void 0?e:{},create_user:(n=f?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:m,code_challenge_method:p},redirectTo:f?.emailRedirectTo});return{data:{user:null,session:null},error:v}}if("phone"in r){const{phone:u,options:f}=r,{data:m,error:p}=await yt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=f?.data)!==null&&s!==void 0?s:{},create_user:(o=f?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(l=f?.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:m?.message_id},error:p}}throw new $u("You must provide either an email or phone number.")}catch(u){if(mt(u))return{data:{user:null,session:null},error:u};throw u}}async verifyOtp(r){var e,n;try{let s,o;"options"in r&&(s=(e=r.options)===null||e===void 0?void 0:e.redirectTo,o=(n=r.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:u}=await yt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:ia});if(u)throw u;if(!l)throw new Error("An error occurred on token verification.");const f=l.session,m=l.user;return f?.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),{data:{user:m,session:f},error:null}}catch(s){if(mt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(r){var e,n,s;try{let o=null,l=null;return this.flowType==="pkce"&&([o,l]=await Uo(this.storage,this.storageKey)),await yt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(n=(e=r.options)===null||e===void 0?void 0:e.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=r?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:j_})}catch(o){if(mt(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:e},error:n}=r;if(n)throw n;if(!e)throw new Ka;const{error:s}=await yt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return{data:{user:null,session:null},error:s}})}catch(r){if(mt(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const e=`${this.url}/resend`;if("email"in r){const{email:n,type:s,options:o}=r,{error:l}=await yt(this.fetch,"POST",e,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in r){const{phone:n,type:s,options:o}=r,{data:l,error:u}=await yt(this.fetch,"POST",e,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:l?.message_id},error:u}}throw new $u("You must provide either an email or phone number and a type")}catch(e){if(mt(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(r,e){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await e()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=e();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await r(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const e=await Pi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?r=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const n=r.expires_at?r.expires_at*1e3-Date.now()<df:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",r.expires_at),!n){if(this.userStorage){const l=await Pi(this.userStorage,this.storageKey+"-user");l?.user?r.user=l.user:r.user=mf()}if(this.storage.isServer&&r.user){let l=this.suppressGetSessionWarning;r=new Proxy(r,{get:(f,m,p)=>(!l&&m==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(f,m,p))})}return{data:{session:r},error:null}}const{session:s,error:o}=await this._callRefreshToken(r.refresh_token);return o?{data:{session:null},error:o}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await yt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:Xa}):await this._useSession(async e=>{var n,s,o;const{data:l,error:u}=e;if(u)throw u;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ka}:await yt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:Xa})})}catch(e){if(mt(e))return a_(e)&&(await this._removeSession(),await Ha(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(r,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,e))}async _updateUser(r,e={}){try{return await this._useSession(async n=>{const{data:s,error:o}=n;if(o)throw o;if(!s.session)throw new Ka;const l=s.session;let u=null,f=null;this.flowType==="pkce"&&r.email!=null&&([u,f]=await Uo(this.storage,this.storageKey));const{data:m,error:p}=await yt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e?.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:u,code_challenge_method:f}),jwt:l.access_token,xform:Xa});if(p)throw p;return l.user=m.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(n){if(mt(n))return{data:{user:null},error:n};throw n}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new Ka;const e=Date.now()/1e3;let n=e,s=!0,o=null;const{payload:l}=hf(r.access_token);if(l.exp&&(n=l.exp,s=n<=e),s){const{session:u,error:f}=await this._callRefreshToken(r.refresh_token);if(f)return{data:{user:null,session:null},error:f};if(!u)return{data:{user:null,session:null},error:null};o=u}else{const{data:u,error:f}=await this._getUser(r.access_token);if(f)throw f;o={access_token:r.access_token,refresh_token:r.refresh_token,user:u.user,token_type:"bearer",expires_in:n-e,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(e){if(mt(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async e=>{var n;if(!r){const{data:l,error:u}=e;if(u)throw u;r=(n=l.session)!==null&&n!==void 0?n:void 0}if(!r?.refresh_token)throw new Ka;const{session:s,error:o}=await this._callRefreshToken(r.refresh_token);return o?{data:{user:null,session:null},error:o}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(mt(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(r,e){try{if(!ms())throw new Bu("No browser detected.");if(r.error||r.error_description||r.error_code)throw new Bu(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(e){case"implicit":if(this.flowType==="pkce")throw new Gg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Bu("Not a valid implicit grant flow url.");break;default:}if(e==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new Gg("No code detected.");const{data:B,error:C}=await this._exchangeCodeForSession(r.code);if(C)throw C;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:B.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:o,refresh_token:l,expires_in:u,expires_at:f,token_type:m}=r;if(!o||!u||!l||!m)throw new Bu("No session defined in URL");const p=Math.round(Date.now()/1e3),v=parseInt(u);let y=p+v;f&&(y=parseInt(f));const S=y-p;S*1e3<=Ho&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${v}s`);const k=y-v;p-k>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",k,y,p):p-k<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",k,y,p);const{data:w,error:E}=await this._getUser(o);if(E)throw E;const F={provider_token:n,provider_refresh_token:s,access_token:o,expires_in:v,expires_at:y,refresh_token:l,token_type:m,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:F,redirectType:r.type},error:null}}catch(n){if(mt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const e=await Pi(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&e)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async e=>{var n;const{data:s,error:o}=e;if(o)return{error:o};const l=(n=s.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:u}=await this.admin.signOut(l,r);if(u&&!(s_(u)&&(u.status===404||u.status===401||u.status===403)))return{error:u}}return r!=="others"&&(await this._removeSession(),await Ha(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const e=g_(),n={id:e,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:n}}}async _emitInitialSession(r){return await this._useSession(async e=>{var n,s;try{const{data:{session:o},error:l}=e;if(l)throw l;await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",r,"session",o)}catch(o){await((s=this.stateChangeEmitters.get(r))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",o),console.error(o)}})}async resetPasswordForEmail(r,e={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Uo(this.storage,this.storageKey,!0));try{return await yt(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(o){if(mt(o))return{data:null,error:o};throw o}}async getUserIdentities(){var r;try{const{data:e,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(r=e.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(e){if(mt(e))return{data:null,error:e};throw e}}async linkIdentity(r){var e;try{const{data:n,error:s}=await this._useSession(async o=>{var l,u,f,m,p;const{data:v,error:y}=o;if(y)throw y;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(l=r.options)===null||l===void 0?void 0:l.redirectTo,scopes:(u=r.options)===null||u===void 0?void 0:u.scopes,queryParams:(f=r.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await yt(this.fetch,"GET",S,{headers:this.headers,jwt:(p=(m=v.session)===null||m===void 0?void 0:m.access_token)!==null&&p!==void 0?p:void 0})});if(s)throw s;return ms()&&!(!((e=r.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:r.provider,url:n?.url},error:null}}catch(n){if(mt(n))return{data:{provider:r.provider,url:null},error:n};throw n}}async unlinkIdentity(r){try{return await this._useSession(async e=>{var n,s;const{data:o,error:l}=e;if(l)throw l;return await yt(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(s=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(e){if(mt(e))return{data:null,error:e};throw e}}async _refreshAccessToken(r){const e=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(e,"begin");try{const n=Date.now();return await y_(async s=>(s>0&&await v_(200*Math.pow(2,s-1)),this._debug(e,"refreshing attempt",s),await yt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:ia})),(s,o)=>{const l=200*Math.pow(2,s);return o&&ff(o)&&Date.now()+l-n<Ho})}catch(n){if(this._debug(e,"error",n),mt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(e,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,e){const n=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",e,"url",n),ms()&&!e.skipBrowserRedirect&&window.location.assign(n),{data:{provider:r,url:n},error:null}}async _recoverAndRefresh(){var r,e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Pi(this.storage,this.storageKey);if(s&&this.userStorage){let l=await Pi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:s.user},await zo(this.userStorage,this.storageKey+"-user",l)),s.user=(r=l?.user)!==null&&r!==void 0?r:mf()}else if(s&&!s.user&&!s.user){const l=await Pi(this.storage,this.storageKey+"-user");l&&l?.user?(s.user=l.user,await Ha(this.storage,this.storageKey+"-user"),await zo(this.storage,this.storageKey,s)):s.user=mf()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const o=((e=s.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<df;if(this._debug(n,`session has${o?"":" not"} expired with margin of ${df}s`),o){if(this.autoRefreshToken&&s.refresh_token){const{error:l}=await this._callRefreshToken(s.refresh_token);l&&(console.error(l),ff(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:u}=await this._getUser(s.access_token);!u&&l?.user?(s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(r){var e,n;if(!r)throw new Ka;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new vd;const{data:o,error:l}=await this._refreshAccessToken(r);if(l)throw l;if(!o.session)throw new Ka;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const u={session:o.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(o){if(this._debug(s,"error",o),mt(o)){const l={session:null,error:o};return ff(o)||await this._removeSession(),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(r,e,n=!0){const s=`#_notifyAllSubscribers(${r})`;this._debug(s,"begin",e,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:r,session:e});const o=[],l=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(r,e)}catch(f){o.push(f)}});if(await Promise.all(l),o.length>0){for(let u=0;u<o.length;u+=1)console.error(o[u]);throw o[0]}}finally{this._debug(s,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0;const e=Object.assign({},r),n=e.user&&e.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&e.user&&await zo(this.userStorage,this.storageKey+"-user",{user:e.user});const s=Object.assign({},e);delete s.user;const o=Yg(s);await zo(this.storage,this.storageKey,o)}else{const s=Yg(e);await zo(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Ha(this.storage,this.storageKey),await Ha(this.storage,this.storageKey+"-code-verifier"),await Ha(this.storage,this.storageKey+"-user"),this.userStorage&&await Ha(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&ms()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",r)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),Ho);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async e=>{const{data:{session:n}}=e;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-r)/Ho);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Ho}ms, refresh threshold is ${Df} ticks`),s<=Df&&await this._callRefreshToken(n.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof Bx)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ms()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const e=`#_onVisibilityChanged(${r})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,e,n){const s=[`provider=${encodeURIComponent(e)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[o,l]=await Uo(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(l)}`});s.push(u.toString())}if(n?.queryParams){const o=new URLSearchParams(n.queryParams);s.push(o.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${r}?${s.join("&")}`}async _unenroll(r){try{return await this._useSession(async e=>{var n;const{data:s,error:o}=e;return o?{data:null,error:o}:await yt(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(e){if(mt(e))return{data:null,error:e};throw e}}async _enroll(r){try{return await this._useSession(async e=>{var n,s;const{data:o,error:l}=e;if(l)return{data:null,error:l};const u=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:f,error:m}=await yt(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token});return m?{data:null,error:m}:(r.factorType==="totp"&&(!((s=f?.totp)===null||s===void 0)&&s.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),{data:f,error:null})})}catch(e){if(mt(e))return{data:null,error:e};throw e}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:s,error:o}=e;if(o)return{data:null,error:o};const{data:l,error:u}=await yt(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:u})})}catch(e){if(mt(e))return{data:null,error:e};throw e}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:s,error:o}=e;return o?{data:null,error:o}:await yt(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(e){if(mt(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(r){const{data:e,error:n}=await this._challenge({factorId:r.factorId});return n?{data:null,error:n}:await this._verify({factorId:r.factorId,challengeId:e.id,code:r.code})}async _listFactors(){const{data:{user:r},error:e}=await this.getUser();if(e)return{data:null,error:e};const n=r?.factors||[],s=n.filter(l=>l.factor_type==="totp"&&l.status==="verified"),o=n.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:n,totp:s,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var e,n;const{data:{session:s},error:o}=r;if(o)return{data:null,error:o};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=hf(s.access_token);let u=null;l.aal&&(u=l.aal);let f=u;((n=(e=s.user.factors)===null||e===void 0?void 0:e.filter(v=>v.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(f="aal2");const p=l.amr||[];return{data:{currentLevel:u,nextLevel:f,currentAuthenticationMethods:p},error:null}}))}async fetchJwk(r,e={keys:[]}){let n=e.keys.find(u=>u.kid===r);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(u=>u.kid===r),n&&this.jwks_cached_at+r_>s)return n;const{data:o,error:l}=await yt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=s,n=o.keys.find(u=>u.kid===r),!n)?null:n}async getClaims(r,e={}){try{let n=r;if(!n){const{data:S,error:k}=await this.getSession();if(k||!S.session)return{data:null,error:k};n=S.session.access_token}const{header:s,payload:o,signature:l,raw:{header:u,payload:f}}=hf(n);e?.allowExpired||T_(o.exp);const m=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,e?.keys?{keys:e.keys}:e?.jwks);if(!m){const{error:S}=await this.getUser(n);if(S)throw S;return{data:{claims:o,header:s,signature:l},error:null}}const p=N_(s.alg),v=await crypto.subtle.importKey("jwk",m,p,!0,["verify"]);if(!await crypto.subtle.verify(p,v,l,f_(`${u}.${f}`)))throw new Mf("Invalid JWT signature");return{data:{claims:o,header:s,signature:l},error:null}}catch(n){if(mt(n))return{data:null,error:n};throw n}}}cc.nextInstanceID=0;const W_=cc;class H_ extends W_{constructor(r){super(r)}}var z_=function(t,r,e,n){function s(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function u(p){try{m(n.next(p))}catch(v){l(v)}}function f(p){try{m(n.throw(p))}catch(v){l(v)}}function m(p){p.done?o(p.value):s(p.value).then(u,f)}m((n=n.apply(t,r||[])).next())})};class G_{constructor(r,e,n){var s,o,l;if(this.supabaseUrl=r,this.supabaseKey=e,!r)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const u=Jb(r),f=new URL(u);this.realtimeUrl=new URL("realtime/v1",f),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",f),this.storageUrl=new URL("storage/v1",f),this.functionsUrl=new URL("functions/v1",f);const m=`sb-${f.hostname.split(".")[0]}-auth-token`,p={db:Vb,realtime:Hb,auth:Object.assign(Object.assign({},Wb),{storageKey:m}),global:Bb},v=Yb(n??{},p);this.storageKey=(s=v.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(o=v.global.headers)!==null&&o!==void 0?o:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(y,S)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(S)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=v.auth)!==null&&l!==void 0?l:{},this.headers,v.global.fetch),this.fetch=Xb(e,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.rest=new lb(new URL("rest/v1",f).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new Mb(this.storageUrl.href,this.headers,this.fetch,n?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new Qw(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,e={},n={}){return this.rest.rpc(r,e,n)}channel(r,e={config:{}}){return this.realtime.channel(r,e)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,e;return z_(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(e=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:o,storageKey:l,flowType:u,lock:f,debug:m},p,v){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new H_({url:this.authUrl.href,headers:Object.assign(Object.assign({},y),p),storageKey:l,autoRefreshToken:r,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:o,flowType:u,lock:f,debug:m,fetch:v,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new kb(this.realtimeUrl.href,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,n)=>{this._handleTokenChanged(e,"CLIENT",n?.access_token)})}_handleTokenChanged(r,e,n){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:r==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const K_=(t,r,e)=>new G_(t,r,e);function X_(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}X_()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const q_="https://huqijhevmtgardkyeowa.supabase.co",Vx="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh1cWlqaGV2bXRnYXJka3llb3dhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcyNDgyNTQsImV4cCI6MjA3MjgyNDI1NH0.1G81Zif1YWQwISEGJw4XMzY89Rlvh6Jda1-j-roPZBk",je=K_(q_,Vx),rt=Vx!=="YOUR_SUPABASE_ANON_KEY",J_=Object.freeze(Object.defineProperty({__proto__:null,isSupabaseConfigured:rt,supabase:je},Symbol.toStringTag,{value:"Module"})),Wx=j.createContext(void 0),Xi=()=>{const t=j.useContext(Wx);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},Y_=({children:t})=>{const[r,e]=j.useState(null),[n,s]=j.useState(null),[o,l]=j.useState(!0);j.useEffect(()=>{je.auth.getSession().then(({data:{session:S}})=>{s(S),e(S?.user??null),l(!1)});const{data:{subscription:y}}=je.auth.onAuthStateChange((S,k)=>{s(k),e(k?.user??null),l(!1)});return()=>y.unsubscribe()},[]);const v={user:r,session:n,loading:o,signUp:async(y,S,k)=>{try{const{data:w,error:E}=await je.auth.signUp({email:y,password:S,options:{data:{full_name:k}}});if(E)return{error:E};if(w.user){const{error:F}=await je.from("user_profiles").insert([{user_id:w.user.id,full_name:k,role:"VIEWER"}]);F&&console.error("Error creating user profile:",F)}return{error:null}}catch(w){return{error:w}}},signIn:async(y,S)=>{const{error:k}=await je.auth.signInWithPassword({email:y,password:S});return{error:k}},signOut:async()=>{Object.keys(localStorage).forEach(k=>{k.startsWith("user_role_")&&localStorage.removeItem(k)});const{error:S}=await je.auth.signOut();S&&console.error("Sign out error:",S)},updateProfile:async y=>{if(!r)return{error:new Error("No user logged in")};const{error:S}=await je.from("user_profiles").update(y).eq("user_id",r.id);return{error:S}}};return c.jsx(Wx.Provider,{value:v,children:t})},Q_=({isOpen:t,onClose:r,onSuccess:e})=>{const[n,s]=j.useState(!1),[o,l]=j.useState(""),[u,f]=j.useState(""),[m,p]=j.useState(""),[v,y]=j.useState(!1),[S,k]=j.useState(null),{signUp:w,signIn:E}=Xi(),F=async M=>{M.preventDefault(),y(!0),k(null);try{let re;n?re=await w(o,u,m):re=await E(o,u),re.error?k(re.error.message||"An error occurred"):(e(),r())}catch{k("An unexpected error occurred")}finally{y(!1)}},B=()=>{l(""),f(""),p(""),k(null)},C=()=>{s(!n),B()};return t?c.jsxs("div",{className:"bg-slate-800 p-8 rounded-xl shadow-2xl max-w-md w-full border border-slate-700",children:[c.jsx("div",{className:"mb-6",children:c.jsx("h2",{className:"text-2xl font-bold text-white text-center",children:n?"Create Account":"Sign In"})}),c.jsxs("form",{onSubmit:F,className:"space-y-4",children:[n&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Full Name"}),c.jsx("input",{type:"text",value:m,onChange:M=>p(M.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",placeholder:"Enter your full name",required:n})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Email"}),c.jsx("input",{type:"email",value:o,onChange:M=>l(M.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",placeholder:"Enter your email",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Password"}),c.jsx("input",{type:"password",value:u,onChange:M=>f(M.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",placeholder:"Enter your password",required:!0,minLength:6})]}),S&&c.jsx("div",{className:"bg-red-900 border border-red-700 text-red-200 px-3 py-2 rounded text-sm",children:S}),c.jsx("button",{type:"submit",disabled:v,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors",children:v?"Loading...":n?"Create Account":"Sign In"})]}),c.jsx("div",{className:"mt-4 text-center",children:c.jsx("button",{onClick:C,className:"text-blue-400 hover:text-blue-300 text-sm",children:n?"Already have an account? Sign in":"Don't have an account? Sign up"})}),!n&&c.jsx("div",{className:"mt-3 text-center",children:c.jsx("button",{onClick:()=>{s(!0),B()},className:"text-green-400 hover:text-green-300 text-sm",children:"Create a new account"})}),n&&c.jsx("div",{className:"mt-4 p-3 bg-blue-900 rounded-lg",children:c.jsxs("p",{className:"text-blue-200 text-sm",children:[c.jsx("strong",{children:"Note:"})," After signing up, you'll be able to access the app immediately."]})})]}):null},Z_=({onClose:t})=>{const{user:r,signOut:e,updateProfile:n}=Xi(),[s,o]=j.useState(null),[l,u]=j.useState(!0),[f,m]=j.useState(!1),[p,v]=j.useState(""),[y,S]=j.useState("VIEWER"),[k,w]=j.useState(!1),E=[{value:"VIEWER",label:"Viewer (Read Only)"},{value:"OPERATOR",label:"Operator (Limited Edit)"},{value:"EDITOR",label:"Editor (Full Access)"}];j.useEffect(()=>{r&&F()},[r]);const F=async()=>{if(r)try{const{data:M,error:re}=await je.from("user_profiles").select("*").eq("user_id",r.id).single();if(re){console.log("No profile found in database, using user metadata:",re);const O={id:r.id,full_name:r.user_metadata?.full_name||r.email||"Unknown",role:r.user_metadata?.role||"VIEWER",email:r.email||"",created_at:r.created_at||new Date().toISOString()};o(O),v(O.full_name),S(O.role)}else o(M),v(M.full_name||""),S(M.role||"VIEWER")}catch(M){console.error("Error fetching profile:",M);const re={id:r.id,full_name:r.user_metadata?.full_name||r.email||"Unknown",role:r.user_metadata?.role||"VIEWER",email:r.email||"",created_at:r.created_at||new Date().toISOString()};o(re),v(re.full_name),S(re.role)}finally{u(!1)}},B=async()=>{if(r){w(!0);try{const{error:M}=await n({full_name:p,role:y});if(M)console.error("Error updating profile:",M),alert("Error updating profile");else{o(O=>O?{...O,full_name:p,role:y}:null),m(!1);const re=new URLSearchParams(window.location.search).get("eventId")||window.location.pathname.includes("/run-of-show")?"current":null;re&&localStorage.setItem(`user_role_${re}_${r.id}`,y),t&&t()}}catch(M){console.error("Error updating profile:",M),alert("Error updating profile")}finally{w(!1)}}},C=async()=>{confirm("Are you sure you want to sign out?")&&await e()};return l?c.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),"Loading..."]}):s?c.jsxs("div",{className:"bg-slate-800 p-4 rounded-lg shadow-2xl w-80 border border-slate-700",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-bold text-white",children:"Profile"}),t&&c.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:"✕"})]}),f?c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Full Name"}),c.jsx("input",{type:"text",value:p,onChange:M=>v(M.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-sm",placeholder:"Enter your full name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Role"}),c.jsx("select",{value:y,onChange:M=>S(M.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-sm",children:E.map(M=>c.jsx("option",{value:M.value,children:M.label},M.value))})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:B,disabled:k,className:"flex-1 px-3 py-2 bg-green-600 hover:bg-green-500 disabled:bg-slate-600 text-white text-sm rounded transition-colors",children:k?"Saving...":"Save"}),c.jsx("button",{onClick:()=>m(!1),className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded transition-colors",children:"Cancel"})]})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center text-white font-medium",children:(s.full_name||"U").charAt(0).toUpperCase()}),c.jsxs("div",{children:[c.jsx("div",{className:"text-white font-medium",children:s.full_name}),c.jsx("div",{className:"text-slate-400 text-sm",children:s.role}),c.jsx("div",{className:"text-slate-500 text-xs",children:r?.email})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>m(!0),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Edit Profile"}),c.jsx("button",{onClick:C,className:"px-3 py-2 bg-red-600 hover:bg-red-500 text-white text-sm rounded transition-colors",title:"Sign out",children:"Sign Out"})]})]})]}):c.jsx("div",{className:"text-slate-300",children:"Profile not found"})},Uf=()=>{const{user:t,signOut:r}=Xi(),[e,n]=j.useState(!1);return c.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-slate-800 border-b border-slate-700 px-6 py-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex items-center gap-4",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold text-lg",children:"R"})}),c.jsx("h1",{className:"text-xl font-bold text-white",children:"Run of Show"})]})}),t?c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-white font-semibold text-base",children:t.user_metadata?.full_name||t.email}),c.jsx("p",{className:"text-slate-300 text-xs",children:t.email})]}),c.jsx("button",{onClick:()=>{confirm("Are you sure you want to sign out?")&&r()},className:"px-3 py-1.5 bg-red-600 hover:bg-red-500 text-white text-sm rounded-md transition-colors",title:"Sign out",children:"Sign Out"})]}):c.jsx("div",{className:"flex items-center gap-4",children:c.jsx("div",{className:"text-slate-400 text-sm",children:"Please sign in to continue"})}),e&&c.jsx("div",{className:"absolute top-16 right-6 z-50",children:c.jsx(Z_,{onClose:()=>n(!1)})})]})})},eS=({children:t})=>{const{user:r,loading:e}=Xi(),[n,s]=ed.useState(!1);return ed.useEffect(()=>{!e&&!r?s(!0):r&&s(!1)},[r,e]),e?c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 pt-16",children:[c.jsx(Uf,{}),c.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-80px)]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),c.jsx("p",{className:"text-slate-300",children:"Loading..."})]})})]}):r?c.jsx(c.Fragment,{children:t}):c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 pt-16",children:[c.jsx(Uf,{}),c.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-80px)]",children:c.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[c.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold text-2xl",children:"R"})}),c.jsx("h1",{className:"text-4xl font-bold text-white",children:"Run of Show"})]}),c.jsx("p",{className:"text-slate-300 text-lg",children:"Please sign in to access the Run of Show application."})]}),c.jsx(Q_,{isOpen:n,onClose:()=>{},onSuccess:()=>{s(!1)}}),c.jsx("div",{className:"mt-4 text-center",children:c.jsx("button",{onClick:()=>s(!0),className:"text-blue-400 hover:text-blue-300 text-sm underline",children:"Already have an account? Sign in here"})})]})})]})},Vu=[{value:"Great Hall",label:"Great Hall",color:"bg-blue-600"},{value:"Briefing Center",label:"Briefing Center",color:"bg-green-600"},{value:"Lee Anderson",label:"Lee Anderson",color:"bg-purple-600"},{value:"Virtual Show",label:"Virtual Show",color:"bg-orange-600"},{value:"Off Site",label:"Off Site",color:"bg-red-600"}],rp=[1,2,3,4,5];class Ge{static async saveCalendarEvent(r){try{console.log("🔄 Saving calendar event to Supabase:",r);const{data:e,error:n}=await je.from("calendar_events").insert([r]).select().single();return n?(console.error("Error saving calendar event:",n),this.saveCalendarToLocalStorage(r)):(console.log("✅ Calendar event saved to Supabase:",e),e)}catch(e){return console.error("Error saving calendar event:",e),this.saveCalendarToLocalStorage(r)}}static async updateCalendarEvent(r,e){try{console.log("🔄 Updating calendar event in Supabase:",r,e);const{data:n,error:s}=await je.from("calendar_events").update({name:e.name,date:e.date,schedule_data:e.schedule_data,updated_at:new Date().toISOString()}).eq("id",r).select().single();return s?(console.error("❌ Error updating calendar event:",s),null):(console.log("✅ Calendar event updated successfully:",n),n)}catch(n){return console.error("❌ Exception updating calendar event:",n),null}}static async getCalendarEvents(){try{console.log("🔄 Loading calendar events from Supabase...");const{data:r,error:e}=await je.from("calendar_events").select("*").order("date",{ascending:!1});return e?(console.error("Error fetching calendar events:",e),this.getCalendarFromLocalStorage()):(console.log("✅ Calendar events loaded from Supabase:",r?.length||0),r||[])}catch(r){return console.error("Error fetching calendar events:",r),this.getCalendarFromLocalStorage()}}static async getCalendarEvent(r){try{const{data:e,error:n}=await je.from("calendar_events").select("*").eq("id",r).single();return n?(console.error("Error fetching calendar event:",n),this.getCalendarFromLocalStorageById(r)):e}catch(e){return console.error("Error fetching calendar event:",e),this.getCalendarFromLocalStorageById(r)}}static async deleteCalendarEvent(r){try{const{error:e}=await je.from("calendar_events").delete().eq("id",r);return e?(console.error("Error deleting calendar event:",e),this.deleteCalendarFromLocalStorage(r)):!0}catch(e){return console.error("Error deleting calendar event:",e),this.deleteCalendarFromLocalStorage(r)}}static async logChange(r,e,n,s,o,l,u,f,m,p,v,y,S,k){try{console.log("Calling log_change with parameters:",{p_event_id:r,p_user_id:e,p_user_name:n,p_user_role:s,p_action:o,p_table_name:l,p_record_id:u,p_field_name:f,p_row_number:y,p_cue_number:S});const w={p_event_id:r,p_user_id:e,p_user_name:n,p_user_role:s,p_action:o,p_table_name:l,p_record_id:u||null,p_field_name:f||null,p_old_value:m?JSON.stringify(m):null,p_new_value:p?JSON.stringify(p):null,p_description:v||null,p_metadata:k||{},p_row_number:y||null,p_cue_number:S?typeof S=="string"?parseInt(S,10):S:null};console.log("Calling log_change with cleaned parameters:",w);const{data:E,error:F}=await je.rpc("log_change",w);return F?(console.error("❌ Error logging change:",F),console.error("❌ Parameters that caused error:",w),null):(console.log("✅ Change logged:",{action:o,tableName:l,recordId:u,changeId:E}),E)}catch(w){return console.error("Error logging change:",w),null}}static async logFieldChanges(r,e,n,s,o,l,u,f){try{for(const m of u)await this.logChange(r,e,n,s,"UPDATE",o,l,m.fieldName,m.oldValue,m.newValue,f)}catch(m){console.error("Error logging field changes:",m)}}static async getChangeLog(r,e=50,n=0){try{const{data:s,error:o}=await je.rpc("get_change_log",{p_event_id:r,p_limit:e,p_offset:n});return o?(console.error("❌ Error fetching change log:",o),[]):s||[]}catch(s){return console.error("Error fetching change log:",s),[]}}static async getRecordChangeLog(r,e,n,s=20){try{const{data:o,error:l}=await je.rpc("get_record_change_log",{p_event_id:r,p_table_name:e,p_record_id:n,p_limit:s});return l?(console.error("❌ Error fetching record change log:",l),[]):o||[]}catch(o){return console.error("Error fetching record change log:",o),[]}}static async getChangeLogSummary(r){try{const{data:e,error:n}=await je.rpc("get_change_log_summary",{p_event_id:r});return n?(console.error("❌ Error fetching change log summary:",n),null):e?.[0]||null}catch(e){return console.error("Error fetching change log summary:",e),null}}static async cleanupOldChangeLogs(){try{const{data:r,error:e}=await je.rpc("cleanup_old_change_logs");return e?(console.error("❌ Error cleaning up old change logs:",e),0):(console.log("🧹 Cleaned up old change logs:",r),r||0)}catch(r){return console.error("Error cleaning up old change logs:",r),0}}static async saveRunOfShowData(r,e){try{console.log("🔄 Saving run of show data to Supabase:",{eventId:r.event_id,scheduleItemsCount:r.schedule_items?.length||0,customColumnsCount:r.custom_columns?.length||0,settingsKeys:Object.keys(r.settings||{}),userInfo:e?`${e.userName} (${e.userRole})`:"No user info"});const n=new Date().toISOString(),s={...r,last_modified_by:e?.userId,last_modified_by_name:e?.userName,last_modified_by_role:e?.userRole,updated_at:n},{data:o,error:l}=await je.from("run_of_show_data").select("*").eq("event_id",r.event_id).single();let u;if(o&&!l){console.log("📝 Updating existing record for event:",r.event_id);const f=o.last_change_at||n,{data:m,error:p}=await je.from("run_of_show_data").update({event_name:s.event_name,event_date:s.event_date,schedule_items:s.schedule_items,custom_columns:s.custom_columns,settings:s.settings,last_modified_by:s.last_modified_by,last_modified_by_name:s.last_modified_by_name,last_modified_by_role:s.last_modified_by_role,updated_at:s.updated_at,last_change_at:f}).eq("event_id",r.event_id).select().single();if(p)throw console.error("❌ Error updating run of show data:",p),p;u=m}else{console.log("➕ Inserting new record for event:",r.event_id);const f={...s,last_change_at:n},{data:m,error:p}=await je.from("run_of_show_data").insert([f]).select().single();if(p)throw console.error("❌ Error inserting run of show data:",p),p;u=m}return console.log("✅ Run of show data saved to Supabase successfully"),u}catch(n){console.error("❌ Error saving run of show data:",n),console.error("❌ Error details:",n.message,n.details,n.hint);const s={...r,last_modified_by:e?.userId,last_modified_by_name:e?.userName,last_modified_by_role:e?.userRole,updated_at:new Date().toISOString()};return this.saveRunOfShowToLocalStorage(s)}}static async updateRunOfShowData(r,e){try{console.log("🔄 Updating run of show data in Supabase for event:",r,e);const{data:n,error:s}=await je.from("run_of_show_data").update({...e,updated_at:new Date().toISOString()}).eq("event_id",r).select().single();return s?(console.error("❌ Error updating run of show data:",s),null):(console.log("✅ Run of show data updated successfully:",n),n)}catch(n){return console.error("❌ Exception updating run of show data:",n),null}}static async getRunOfShowData(r){try{console.log("🔄 Loading run of show data from Supabase for event:",r),console.log("🔍 Supabase configured:",rt),console.log("🔍 Executing Supabase query...");const{data:e,error:n}=await je.from("run_of_show_data").select("*").eq("event_id",r).single();return console.log("🔍 Supabase query completed. Error:",n),console.log("🔍 Supabase query data:",e),n?(console.error("❌ Error fetching run of show data:",n),console.error("❌ Error details:",{message:n.message,details:n.details,hint:n.hint,code:n.code}),console.log("🔄 Falling back to localStorage..."),this.getRunOfShowFromLocalStorageById(r)):(console.log("✅ Run of show data loaded from Supabase:",e?"Found":"Not found"),e&&console.log("🔍 Data structure:",{hasScheduleItems:!!e.schedule_items,scheduleItemsLength:e.schedule_items?.length||0,hasCustomColumns:!!e.custom_columns,customColumnsLength:e.custom_columns?.length||0,hasSettings:!!e.settings}),e)}catch(e){return console.error("❌ Exception in getRunOfShowData:",e),console.error("❌ Exception details:",{message:e.message,stack:e.stack,eventId:r}),console.log("🔄 Falling back to localStorage due to exception..."),this.getRunOfShowFromLocalStorageById(r)}}static async deleteRunOfShowData(r){try{const{error:e}=await je.from("run_of_show_data").delete().eq("event_id",r);return e?(console.error("Error deleting run of show data:",e),this.deleteRunOfShowFromLocalStorage(r)):!0}catch(e){return console.error("Error deleting run of show data:",e),this.deleteRunOfShowFromLocalStorage(r)}}static saveCalendarToLocalStorage(r){const e=this.getCalendarFromLocalStorage(),n={...r,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return e.unshift(n),localStorage.setItem("calendar_events",JSON.stringify(e)),console.log("✅ Calendar event saved to localStorage"),n}static getCalendarFromLocalStorage(){try{const r=localStorage.getItem("calendar_events"),e=r?JSON.parse(r):[];return console.log("✅ Calendar events loaded from localStorage:",e.length),e}catch(r){return console.error("Error reading from localStorage:",r),[]}}static getCalendarFromLocalStorageById(r){return this.getCalendarFromLocalStorage().find(n=>n.id===r)||null}static deleteCalendarFromLocalStorage(r){try{const n=this.getCalendarFromLocalStorage().filter(s=>s.id!==r);return localStorage.setItem("calendar_events",JSON.stringify(n)),!0}catch(e){return console.error("Error deleting from localStorage:",e),!1}}static saveRunOfShowToLocalStorage(r){const e=this.getAllRunOfShowFromLocalStorage(),n=new Date().toISOString(),s=e.findIndex(l=>l.event_id===r.event_id);let o;if(s>=0){const l=e[s],u=l.last_change_at||n;o={...r,id:l.id,created_at:l.created_at,updated_at:n,last_change_at:u},e[s]=o}else o={...r,id:Date.now().toString(),created_at:n,updated_at:n,last_change_at:n},e.push(o);return localStorage.setItem("run_of_show_data",JSON.stringify(e)),console.log("✅ Run of show data saved to localStorage"),o}static getAllRunOfShowFromLocalStorage(){try{const r=localStorage.getItem("run_of_show_data");return r?JSON.parse(r):[]}catch(r){return console.error("Error reading run of show data from localStorage:",r),[]}}static getRunOfShowFromLocalStorageById(r){console.log("🔄 Loading from localStorage for event:",r);const e=this.getAllRunOfShowFromLocalStorage();console.log("🔍 All localStorage data:",e);const n=e.find(s=>s.event_id===r);return console.log("🔍 Found data for event:",n?"Yes":"No"),n&&console.log("🔍 Found data structure:",{hasScheduleItems:!!n.schedule_items,scheduleItemsLength:n.schedule_items?.length||0,hasCustomColumns:!!n.custom_columns,customColumnsLength:n.custom_columns?.length||0,hasSettings:!!n.settings}),n||null}static deleteRunOfShowFromLocalStorage(r){try{const n=this.getAllRunOfShowFromLocalStorage().filter(s=>s.event_id!==r);return localStorage.setItem("run_of_show_data",JSON.stringify(n)),!0}catch(e){return console.error("Error deleting run of show data from localStorage:",e),!1}}static async checkForChanges(r,e){try{console.log("🔍 Checking for changes:",{eventId:r,localLastChangeAt:e,isSupabaseConfigured:rt});const{data:n,error:s}=await je.from("run_of_show_data").select("updated_at, last_change_at, last_modified_by, last_modified_by_name").eq("event_id",r).single();if(s||!n)return console.error("❌ Error checking for changes:",s),console.error("❌ Event ID:",r),console.error("❌ Supabase configured:",rt),{hasChanges:!1};if(console.log("🔍 Change check data:",n),!e)return{hasChanges:!0,lastChangeAt:n.last_change_at,updatedAt:n.updated_at,lastModifiedBy:n.last_modified_by,lastModifiedByName:n.last_modified_by_name};const o=e?n.updated_at!==e:!1;return console.log("🔍 Change detection:",{localLastChangeAt:e,serverUpdatedAt:n.updated_at,hasChanges:o,lastChangeAt:n.last_change_at}),{hasChanges:o,lastChangeAt:n.last_change_at,updatedAt:n.updated_at,lastModifiedBy:n.last_modified_by,lastModifiedByName:n.last_modified_by_name}}catch(n){return console.error("❌ Error checking for changes:",n),{hasChanges:!1}}}static async loadChangesDynamically(r){try{console.log("🔄 Loading changes dynamically for event:",r);const{data:e,error:n}=await je.from("run_of_show_data").select("*").eq("event_id",r).single();return n?(console.error("❌ Error loading changes:",n),null):(console.log("✅ Changes loaded successfully"),e)}catch(e){return console.error("❌ Error loading changes dynamically:",e),null}}static async saveUserSession(r,e,n,s){try{console.log("🔄 Saving authenticated user session:",{eventId:r,userId:e,username:n,role:s});const{data:o,error:l}=await je.rpc("get_or_create_user_session",{p_user_id:e,p_event_id:r,p_user_role:s});return l?(console.error("❌ Supabase error saving user session:",l),console.error("❌ Error details:",l.message,l.details,l.hint),this.saveUserSessionToLocalStorage(r,n,s)):(console.log("✅ Authenticated user session saved to Supabase:",o),!0)}catch(o){return console.error("Error saving user session:",o),this.saveUserSessionToLocalStorage(r,n,s)}}static async getCurrentUserSession(r,e){try{let n=je.from("user_sessions").select("id, event_id, user_role").eq("user_id",r);e&&(n=n.eq("event_id",e));const{data:s,error:o}=await n.order("created_at",{ascending:!1}).limit(1);return o?(console.error("❌ Error getting current user session:",o),this.getCurrentUserSessionFromLocalStorage()):s?.[0]||null}catch(n){return console.error("Error getting current user session:",n),this.getCurrentUserSessionFromLocalStorage()}}static async updateUserActivity(r){try{const{error:e}=await je.rpc("update_user_activity",{p_user_id:r});e&&console.error("❌ Error updating user activity:",e)}catch(e){console.error("Error updating user activity:",e)}}static async cleanupInactiveSessions(){try{const{data:r,error:e}=await je.rpc("cleanup_inactive_sessions");e?console.error("❌ Error cleaning up inactive sessions:",e):console.log("🧹 Cleaned up inactive sessions:",r)}catch(r){console.error("Error cleaning up inactive sessions:",r)}}static saveUserSessionToLocalStorage(r,e,n){try{const s={event_id:r,username:e,role:n,session_started_at:new Date().toISOString(),last_activity_at:new Date().toISOString(),is_active:!0};return localStorage.setItem(`current_user_session_${e}`,JSON.stringify(s)),localStorage.setItem(`user_role_${r}_${e}`,n),console.log("✅ User session saved to localStorage"),!0}catch(s){return console.error("Error saving user session to localStorage:",s),!1}}static getCurrentUserSessionFromLocalStorage(){try{const r=Object.keys(localStorage);let e=null,n=0;for(const s of r)if(s.startsWith("current_user_session_")){const o=JSON.parse(localStorage.getItem(s)||"{}");if(o.is_active&&o.last_activity_at){const l=new Date(o.last_activity_at).getTime();l>n&&(n=l,e=o)}}return e}catch(r){return console.error("Error getting current user session from localStorage:",r),null}}static async loadCue(r,e,n,s,o,l,u){try{const{data:f,error:m}=await je.rpc("load_cue_for_event",{p_event_id:r,p_item_id:e.toString(),p_user_id:n,p_duration_seconds:s,p_row_is:o||null,p_cue_is:l||null,p_timer_id:u||null});return m?(console.error("❌ Error loading CUE in Supabase:",m),console.error("❌ Error details:",m.message,m.details,m.hint),console.error("❌ Error code:",m.code),(m.code==="PGRST204"||m.message.includes("Could not find"))&&console.warn("⚠️ Timer functions do not exist. Please run the optimized-timer-schema.sql migration script first."),!1):(console.log("✅ CUE loaded in Supabase:",f),f)}catch(f){return console.error("❌ Error loading CUE:",f),!1}}static async startTimer(r,e,n,s,o,l,u,f){try{const{data:m,error:p}=await je.rpc("start_timer_for_event",{p_event_id:r,p_item_id:e.toString(),p_user_id:n,p_row_is:l||null,p_cue_is:u||null,p_timer_id:f||null});return p?(console.error("❌ Error starting timer in Supabase:",p),console.error("❌ Error details:",p.message,p.details,p.hint),console.error("❌ Error code:",p.code),!1):(console.log("✅ Timer started in Supabase (UPSERT):",m),!0)}catch(m){return console.error("Error starting timer:",m),!1}}static async stopTimer(r,e,n){try{const{data:s,error:o}=await je.from("active_timers").update({is_running:!1,is_active:!1,timer_state:"stopped"}).eq("event_id",r).select();return o?(console.error("❌ Error stopping timer in Supabase:",o),!1):(console.log("✅ Timer stopped in Supabase:",s),!0)}catch(s){return console.error("Error stopping timer:",s),!1}}static async updateTimerDuration(r,e,n){try{console.log(`🔄 Updating timer duration for event ${r}, item ${e} to ${n}s`);const{data:s,error:o}=await je.from("active_timers").update({duration_seconds:n}).eq("event_id",r).eq("item_id",e);return o?(console.error("❌ Error updating timer duration in Supabase:",o),!1):(console.log("✅ Timer duration updated in Supabase:",s),!0)}catch(s){return console.error("Error updating timer duration:",s),!1}}static async stopAllTimersForEvent(r,e){try{const{data:n,error:s}=await je.rpc("stop_timer_for_event",{p_event_id:r});return s?(console.error("❌ Error stopping all timers in Supabase:",s),!1):(console.log("✅ All timers stopped in Supabase"),!0)}catch(n){return console.error("Error stopping all timers:",n),!1}}static async getActiveTimer(r){try{const{data:e,error:n}=await je.from("active_timers").select("*").eq("event_id",r).eq("is_active",!0).single();if(n)return console.error("❌ Error getting active timer from Supabase:",n),null;if(e)if(e.timer_state==="running"&&e.started_at){const s=new Date,o=new Date(e.started_at),l=s.getTime()-o.getTime();e.elapsed_seconds=Math.floor(l/1e3)}else e.elapsed_seconds=0;return e}catch(e){return console.error("Error getting active timer:",e),null}}static subscribeToTimerChanges(r,e){return je.channel("active_timers_changes").on("postgres_changes",{event:"*",schema:"public",table:"active_timers",filter:`event_id=eq.${r}`},e).subscribe()}static async hasActiveSubCueTimer(r){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping has active sub-cue timer check"),{data:!1,error:null};const{data:e,error:n}=await je.rpc("has_active_sub_cue_timer_for_event",{p_event_id:r});return n?(console.error("❌ Error checking active sub-cue timer:",n),{data:!1,error:n}):{data:e||!1,error:null}}catch(e){return console.error("❌ Error checking active sub-cue timer:",e),{data:!1,error:e}}}static async getActiveSubCueTimer(r){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping get active sub-cue timer"),{data:null,error:null};const{data:e,error:n}=await je.rpc("get_active_sub_cue_timers_for_event",{p_event_id:r});return n?(console.error("❌ Error getting active sub-cue timer:",n),{data:null,error:n}):{data:e?.[0]||null,error:null}}catch(e){return console.error("❌ Error getting active sub-cue timer:",e),{data:null,error:e}}}static async getActiveSubCueTimers(r){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping get active sub-cue timers"),{data:null,error:null};const{data:e,error:n}=await je.rpc("get_active_sub_cue_timers_for_event",{p_event_id:r});if(n&&n.code==="PGRST204"){console.log("🔄 RPC function not found, using direct table query for sub-cue timers");const{data:s,error:o}=await je.from("sub_cue_timers").select("*").eq("event_id",r).eq("is_active",!0).eq("is_running",!0).order("created_at",{ascending:!1});return o?(console.error("❌ Error getting active sub-cue timers from table:",o),{data:null,error:o}):{data:s||[],error:null}}return n?(console.error("❌ Error getting active sub-cue timers:",n),{data:null,error:n}):{data:e||[],error:null}}catch(e){return console.error("❌ Error getting active sub-cue timers:",e),{data:null,error:e}}}static async startSubCueTimer(r,e,n,s,o,l,u){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping start sub-cue timer"),{data:null,error:null};console.log("🔄 Calling start_sub_cue_timer_for_event with params:",{p_event_id:r,p_item_id:e.toString(),p_user_id:n,p_duration_seconds:s,p_row_is:o,p_cue_is:l,p_timer_id:u}),console.log("🔄 About to call RPC function...");const{data:f,error:m}=await je.rpc("start_sub_cue_timer_for_event",{p_event_id:r,p_item_id:e.toString(),p_user_id:n,p_duration_seconds:s,p_row_is:o||null,p_cue_is:l||null,p_timer_id:u||null});return console.log("🔄 RPC response:",{data:f,error:m}),m?(console.error("❌ Error starting sub-cue timer:",m),console.error("❌ Error details:",JSON.stringify(m,null,2)),{data:null,error:m}):{data:f,error:null}}catch(f){return console.error("❌ Error starting sub-cue timer:",f),{data:null,error:f}}}static async expireCompletedSubCueTimers(){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping expire completed sub-cue timers"),{data:0,error:null};const{data:r,error:e}=await je.rpc("expire_completed_sub_cue_timers");return e?(console.error("❌ Error expiring completed sub-cue timers:",e),{data:0,error:e}):{data:r||0,error:null}}catch(r){return console.error("❌ Error expiring completed sub-cue timers:",r),{data:0,error:r}}}static async stopSubCueTimer(r,e){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping stop sub-cue timer"),{data:null,error:null};const{data:n,error:s}=await je.rpc("stop_sub_cue_timer_for_event",{p_event_id:r,p_item_id:null});return s?(console.error("❌ Error stopping sub-cue timer:",s),console.error("❌ Error details:",JSON.stringify(s,null,2)),{data:null,error:s}):{data:n,error:null}}catch(n){return console.error("❌ Error stopping sub-cue timer:",n),{data:null,error:n}}}static async getActiveSecondaryTimer(r){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping get active secondary timer"),{data:null,error:null};const{data:e,error:n}=await je.rpc("get_active_secondary_timer_for_event",{p_event_id:r});if(n&&n.code==="PGRST204"){console.log("🔄 RPC function not found, trying secondary_timers table");const{data:s,error:o}=await je.from("secondary_timers").select("*").eq("event_id",r).eq("is_active",!0).eq("is_running",!0).order("created_at",{ascending:!1}).limit(1);if(o&&(o.code==="42P01"||o.message.includes("does not exist"))){console.log("🔄 secondary_timers table not found, using sub_cue_timers as secondary timer");const{data:l,error:u}=await je.from("sub_cue_timers").select("*").eq("event_id",r).eq("is_active",!0).eq("is_running",!0).order("created_at",{ascending:!1}).limit(1);return u?(console.error("❌ Error getting sub-cue timers as secondary timer:",u),{data:null,error:u}):(console.log("✅ Using sub-cue timer as secondary timer:",l&&l.length>0?l[0]:null),{data:l&&l.length>0?l[0]:null,error:null})}return o?(console.error("❌ Error getting active secondary timer from table:",o),{data:null,error:o}):{data:s&&s.length>0?s[0]:null,error:null}}return n?(console.error("❌ Error getting active secondary timer:",n),n.code==="PGRST204"||n.message.includes("does not exist")?{data:null,error:null}:{data:null,error:n}):{data:e&&e.length>0?e[0]:null,error:null}}catch(e){return console.error("❌ Error getting active secondary timer:",e),{data:null,error:e}}}static async startSecondaryTimer(r,e,n,s){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping start secondary timer"),{data:null,error:null};const{data:o,error:l}=await je.rpc("start_secondary_timer_for_event",{p_event_id:r,p_item_id:e,p_user_id:n,p_duration_seconds:s});return l?(console.error("❌ Error starting secondary timer:",l),{data:null,error:l}):{data:o,error:null}}catch(o){return console.error("❌ Error starting secondary timer:",o),{data:null,error:o}}}static async stopSecondaryTimer(r){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping stop secondary timer"),{data:null,error:null};const{data:e,error:n}=await je.rpc("stop_secondary_timer_for_event",{p_event_id:r});return n?(console.error("❌ Error stopping secondary timer:",n),{data:null,error:n}):{data:e,error:null}}catch(e){return console.error("❌ Error stopping secondary timer:",e),{data:null,error:e}}}static async updateSecondaryTimerRemaining(r,e){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping update secondary timer remaining"),{data:null,error:null};const{data:n,error:s}=await je.rpc("update_secondary_timer_remaining",{p_event_id:r,p_remaining_seconds:e});return s?(console.error("❌ Error updating secondary timer remaining:",s),{data:null,error:s}):{data:n,error:null}}catch(n){return console.error("❌ Error updating secondary timer remaining:",n),{data:null,error:n}}}static async updateSubCueTimerRemaining(r,e,n){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping update sub-cue timer remaining"),!1;const{error:s}=await je.from("sub_cue_timers").update({remaining_seconds:n,updated_at:new Date().toISOString()}).eq("event_id",r).eq("item_id",e.toString()).eq("is_active",!0);return s?(console.error("❌ Error updating sub-cue timer remaining time:",s),!1):!0}catch(s){return console.error("Error updating sub-cue timer remaining time:",s),!1}}static async clearAllActiveTimersForEvent(r){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping clear all active timers"),!1;console.log("🔄 Clearing all active timers for event:",r);const{error:e}=await je.from("active_timers").delete().eq("event_id",r);return e?(console.error("❌ Error clearing all active timers:",e),!1):(console.log("✅ All active timers cleared for event:",r),!0)}catch(e){return console.error("❌ Error clearing all active timers:",e),!1}}static async getCompletedCues(r){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping get completed cues"),null;const{data:e,error:n}=await je.rpc("get_completed_cues_for_event",{p_event_id:r});if(n)throw n;return e}catch(e){return console.error("❌ Error getting completed cues:",e),null}}static async markCueCompleted(r,e,n,s,o,l){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping mark cue completed"),!1;console.log("🟣 Calling mark_cue_completed RPC with:",{p_event_id:r,p_item_id:e,p_user_id:s});const{data:u,error:f}=await je.from("completed_cues").insert({event_id:r,item_id:e,user_id:s,cue_id:n,user_name:o,user_role:l,completed_at:new Date().toISOString()});if(f)throw console.error("❌ Insert error:",f),console.error("❌ Error details:",f.message,f.details,f.hint),f;return console.log("✅ Cue marked as completed successfully:",{eventId:r,itemId:e,data:u}),!0}catch(u){return console.error("❌ Error marking cue as completed:",u),!1}}static async unmarkCueCompleted(r,e){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping unmark cue completed"),!1;const{data:n,error:s}=await je.rpc("unmark_cue_completed",{p_event_id:r,p_item_id:e});if(s)throw s;return console.log("✅ Cue unmarked as completed:",{eventId:r,itemId:e}),!0}catch(n){return console.error("❌ Error unmarking cue as completed:",n),!1}}static async clearCompletedCues(r){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping clear completed cues"),!1;const{data:e,error:n}=await je.rpc("clear_completed_cues_for_event",{p_event_id:r});if(n)throw n;return console.log("✅ Cleared all completed cues for event:",r),!0}catch(e){return console.error("❌ Error clearing completed cues:",e),!1}}static subscribeToTableChanges(r,e,n){try{if(!rt||!je)return console.error("❌ Supabase client not initialized"),null;const s=n?`event_id=eq.${n}`:void 0;return je.channel(`${r}_changes`).on("postgres_changes",{event:"*",schema:"public",table:r,filter:s},e).subscribe()}catch(s){return console.error(`❌ Error setting up ${r} subscription:`,s),null}}static async updateLastLoadedCue(r,e,n){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping update last loaded CUE"),{data:null,error:null};const{data:s,error:o}=await je.rpc("update_last_loaded_cue",{p_event_id:r,p_cue_id:e,p_state:n});return o?(console.error("❌ Error updating last loaded CUE:",o),{data:null,error:o}):{data:s,error:null}}catch(s){return console.error("❌ Error updating last loaded CUE:",s),{data:null,error:s}}}static async getLastLoadedCue(r){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping get last loaded CUE"),{data:null,error:null};const{data:e,error:n}=await je.rpc("get_last_loaded_cue",{p_event_id:r});if(n&&n.code==="PGRST204"){console.log("🔄 RPC function not found, using direct table query for last loaded CUE");const{data:s,error:o}=await je.from("last_loaded_cues").select("*").eq("event_id",r).order("updated_at",{ascending:!1}).limit(1);return o?(console.error("❌ Error getting last loaded CUE from table:",o),{data:null,error:o}):{data:s&&s.length>0?s[0]:null,error:null}}return n?(console.error("❌ Error getting last loaded CUE:",n),{data:null,error:n}):{data:e,error:null}}catch(e){return console.error("❌ Error getting last loaded CUE:",e),{data:null,error:e}}}static async saveTimerMessage(r){try{console.log("🔄 Saving timer message to Supabase:",r);const{data:e,error:n}=await je.from("timer_messages").insert([r]).select().single();return n?(console.error("Error saving timer message:",n),this.saveTimerMessageToLocalStorage(r)):(console.log("✅ Timer message saved to Supabase:",e),e)}catch(e){return console.error("❌ Error saving timer message:",e),this.saveTimerMessageToLocalStorage(r)}}static async getTimerMessage(r){try{const{data:e,error:n}=await je.rpc("get_latest_timer_message",{p_event_id:r});return n?(console.error("Error loading timer message:",n),this.getTimerMessageFromLocalStorage(r)):e?.[0]||null}catch(e){return console.error("❌ Error loading timer message:",e),this.getTimerMessageFromLocalStorage(r)}}static async updateTimerMessage(r,e){try{const{error:n}=await je.from("timer_messages").update(e).eq("id",r);return n?(console.error("Error updating timer message:",n),this.updateTimerMessageInLocalStorage(r,e)):!0}catch(n){return console.error("❌ Error updating timer message:",n),this.updateTimerMessageInLocalStorage(r,e)}}static async disableTimerMessage(r){return this.updateTimerMessage(r,{enabled:!1})}static async getTimerMessagesForEvent(r){try{const{data:e,error:n}=await je.from("timer_messages").select("*").eq("event_id",r).order("created_at",{ascending:!1});return n?(console.error("Error loading timer messages:",n),this.getTimerMessagesFromLocalStorage().filter(s=>s.event_id===r)):e||[]}catch(e){return console.error("❌ Error loading timer messages:",e),this.getTimerMessagesFromLocalStorage().filter(n=>n.event_id===r)}}static async getCueDataForItem(r,e){try{if(!rt||!je)return console.warn("⚠️ Supabase client not initialized, skipping get CUE data"),null;const n=["run_of_show_data","schedule","items","schedule_items","event_items","cues","schedule_data","run_of_show","ros_items","event_schedule"];for(const s of n)try{if(console.log(`🔄 Trying to fetch CUE data from table: ${s}`),s==="run_of_show_data"){const o=[()=>je.from(s).select("*").eq("event_id",r).eq("id",e).single(),()=>je.from(s).select("*").eq("event_id",r),()=>je.from(s).select("*").eq("event_id",r).eq("item_id",e).single(),()=>je.from(s).select("*").eq("event_id",r).eq("cue_id",e).single()];for(let l=0;l<o.length;l++)try{console.log(`🔄 Trying query approach ${l+1} for ${s}`);const{data:u,error:f}=await o[l]();if(!f&&u){if(console.log(`✅ Found CUE data in ${s} with approach ${l+1}:`,u),console.log("🔍 CUE data fields:",Object.keys(u)),Array.isArray(u)&&u.length>0){console.log(`🔍 Array data length: ${u.length}`),console.log("🔍 First item fields:",Object.keys(u[0]));const m=u[0];if(m.schedule_items&&Array.isArray(m.schedule_items)){console.log(`🔍 Found schedule_items with ${m.schedule_items.length} items`),console.log("🔍 First schedule item:",m.schedule_items[0]);const p=m.schedule_items.find(v=>v.id===e||v.item_id===e||v.cue_id===e);return p?(console.log("✅ Found matching schedule item:",p),p):(console.log("ℹ️ No matching schedule item found, using first schedule item"),m.schedule_items[0])}return m}return u}f&&console.log(`❌ Error with approach ${l+1} for ${s}:`,f)}catch(u){console.log(`❌ Exception with approach ${l+1} for ${s}:`,u)}}else{const{data:o,error:l}=await je.from(s).select("*").eq("event_id",r).eq("id",e).single();if(!l&&o)return console.log(`✅ Found CUE data in table: ${s}`,o),console.log("🔍 CUE data fields:",Object.keys(o)),o}}catch(o){console.log(`🔄 Table ${s} not found or error:`,o)}return console.log("🔄 No CUE data found in any table"),null}catch(n){return console.error("❌ Error getting CUE data for item:",n),null}}static async getHybridTimerData(r){try{console.log("🔄 Fetching hybrid timer data for event:",r);const[e,n,s,o,l]=await Promise.all([this.getActiveTimer(r),this.getActiveSecondaryTimer(r),this.getActiveSubCueTimers(r),this.getLastLoadedCue(r),this.getTimerMessage(r)]);let u=null;if(e&&(console.log("🔍 Active timer full data structure:",e),console.log("🔍 Active timer fields:",Object.keys(e)),e.cue_is&&(console.log("✅ Found CUE data in active timer cue_is column:",e.cue_is),u=e)),!u&&e?.last_loaded_cue_id&&(u=await this.getCueDataForItem(r,e.last_loaded_cue_id)),!u&&e?.item_id&&(u=await this.getCueDataForItem(r,e.item_id)),!u&&e?.item_id)try{console.log("🔄 Trying to find CUE data by matching item_id in run_of_show_data");const{data:p,error:v}=await je.from("run_of_show_data").select("*").eq("event_id",r);if(!v&&p&&p.length>0){console.log(`🔍 Found ${p.length} items in run_of_show_data`);const y=p.find(S=>S.id===e.item_id||S.item_id===e.item_id||S.cue_id===e.item_id);y?(console.log("✅ Found matching CUE data:",y),u=y):(console.log("ℹ️ No matching item found, using first item as fallback"),u=p[0])}}catch(p){console.log("❌ Error finding CUE data by matching:",p)}const f=n?.data||(s?.data&&s.data.length>0?s.data[0]:null),m={activeTimer:e,secondaryTimer:f,subCueTimers:s?.data||null,lastLoadedCue:o?.data||null,timerMessage:l,cueData:null};return console.log("✅ Hybrid timer data fetched:",{hasActiveTimer:!!m.activeTimer,hasSecondaryTimer:!!m.secondaryTimer,hasSubCueTimers:!!m.subCueTimers?.length,hasLastLoadedCue:!!m.lastLoadedCue,hasTimerMessage:!!m.timerMessage}),m}catch(e){return console.error("❌ Error fetching hybrid timer data:",e),null}}static saveTimerMessageToLocalStorage(r){const e=this.getTimerMessagesFromLocalStorage(),n={...r,id:`local_${Date.now()}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return e.push(n),localStorage.setItem("timer_messages",JSON.stringify(e)),n}static getTimerMessagesFromLocalStorage(){try{const r=localStorage.getItem("timer_messages");return r?JSON.parse(r):[]}catch(r){return console.error("Error loading timer messages from localStorage:",r),[]}}static getTimerMessageFromLocalStorage(r){return this.getTimerMessagesFromLocalStorage().find(n=>n.event_id===r&&n.enabled)||null}static updateTimerMessageInLocalStorage(r,e){try{const n=this.getTimerMessagesFromLocalStorage(),s=n.findIndex(o=>o.id===r);return s!==-1?(n[s]={...n[s],...e,updated_at:new Date().toISOString()},localStorage.setItem("timer_messages",JSON.stringify(n)),!0):!1}catch(n){return console.error("Error updating timer message in localStorage:",n),!1}}}const Hx=({isOpen:t,onClose:r,onRoleSelected:e,eventId:n})=>{const{user:s}=Xi(),[o,l]=j.useState("VIEWER"),[u,f]=j.useState(!1);j.useEffect(()=>{if(t&&s?.id&&n){const v=localStorage.getItem(`user_role_${n}_${s.id}`);v&&["VIEWER","EDITOR","OPERATOR"].includes(v)&&l(v)}},[t,s?.id,n]);const m=[{value:"VIEWER",label:"Viewer (Read Only)",description:"Can view but cannot edit any content",icon:"👁️"},{value:"OPERATOR",label:"Operator (Limited Edit)",description:"Can control timers and view data",icon:"🎮"},{value:"EDITOR",label:"Editor (Full Access)",description:"Can edit all content and settings",icon:"✏️"}],p=async()=>{if(!(!s||!n)){f(!0);try{await Ge.saveUserSession(n,s.id,s.user_metadata?.full_name||s.email||"Unknown",o)?(e(o),r()):alert("Failed to save user session. Please try again.")}catch(v){console.error("Error saving user session:",v),alert("Error saving user session. Please try again.")}finally{f(!1)}}};return t?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[9999] p-4",children:c.jsxs("div",{className:"bg-slate-800 p-8 rounded-xl shadow-2xl max-w-2xl w-full",children:[c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Select Your Role"}),c.jsxs("p",{className:"text-slate-300 text-lg",children:["Welcome, ",s?.user_metadata?.full_name||s?.email,"! Please select your role for this session."]})]}),c.jsx("div",{className:"space-y-4 mb-8",children:m.map(v=>c.jsxs("label",{className:`flex items-start gap-4 cursor-pointer p-4 rounded-lg border-2 transition-colors ${o===v.value?"border-blue-500 bg-blue-900/20":"border-slate-600 hover:border-blue-400"}`,children:[c.jsx("input",{type:"radio",name:"role",value:v.value,checked:o===v.value,onChange:y=>l(y.target.value),className:"w-5 h-5 text-blue-600 mt-1"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx("span",{className:"text-2xl",children:v.icon}),c.jsx("span",{className:"text-white font-bold text-lg",children:v.label})]}),c.jsx("p",{className:"text-slate-300 text-sm",children:v.description})]})]},v.value))}),c.jsxs("div",{className:"flex gap-4",children:[c.jsx("button",{onClick:p,disabled:u,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors",children:u?"Loading...":"Continue with Selected Role"}),c.jsx("button",{onClick:r,className:"px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]}),c.jsx("div",{className:"mt-4 p-3 bg-blue-900 rounded-lg",children:c.jsxs("p",{className:"text-blue-200 text-sm",children:[c.jsx("strong",{children:"Note:"})," You can change your role later from your profile menu."]})})]})}):null},tS=()=>{const t=rl(),{user:r}=Xi(),[e,n]=j.useState([]),[s,o]=j.useState("upcoming"),[l,u]=j.useState(!1),[f,m]=j.useState("all"),[p,v]=j.useState("all"),[y,S]=j.useState(""),[k,w]=j.useState(null),[E,F]=j.useState({name:"",date:"",location:"Great Hall",numberOfDays:1}),[B,C]=j.useState({name:"",date:"",location:"Great Hall",numberOfDays:1}),[M,re]=j.useState(!1),[O,U]=j.useState(null),[ee,I]=j.useState(!1);j.useEffect(()=>{ie()},[]),j.useEffect(()=>{const A=setInterval(()=>{console.log("🔄 Auto-refreshing events list..."),ie()},3e4);return()=>clearInterval(A)},[]);const ie=async()=>{try{I(!0),console.log("🔄 Loading events from Supabase...");const A=await Ge.getCalendarEvents();if(console.log("📊 Raw calendar events from Supabase:",A),A&&A.length>0){console.log("🔍 Processing calendar events:",A.length);const N=A.map((L,V)=>{console.log(`🔍 Processing event ${V}:`,{id:L.id,name:L.name,date:L.date,schedule_data:L.schedule_data,created_at:L.created_at});const q={id:L.id||Date.now().toString(),name:L.name,date:L.date,location:L.schedule_data?.location||"Great Hall",numberOfDays:L.schedule_data?.numberOfDays||1,created_at:L.created_at||new Date().toISOString(),updated_at:L.updated_at||new Date().toISOString()};return console.log(`✅ Transformed event ${V}:`,q),q});console.log("📊 All transformed events:",N),n(N),console.log("✅ Loaded events from Supabase:",N.length),console.log("📋 Final events state:",N)}else{console.log("ℹ️ No events found in Supabase, checking localStorage...");const N=localStorage.getItem("events");if(N)try{const L=JSON.parse(N);n(L),console.log("📱 Loaded events from localStorage fallback:",L.length)}catch(L){console.error("Error loading events from localStorage:",L)}else console.log("📭 No events found in either Supabase or localStorage"),n([])}}catch(A){console.error("❌ Error loading events from Supabase:",A);const N=localStorage.getItem("events");if(N)try{const L=JSON.parse(N);n(L),console.log("📱 Fallback to localStorage due to error:",L.length)}catch(L){console.error("Error parsing localStorage events:",L),n([])}else n([])}finally{I(!1)}};j.useEffect(()=>{localStorage.setItem("events",JSON.stringify(e))},[e]);const oe=async()=>{if(!B.name||!B.date||!B.location){alert("Please fill in all fields");return}const N={id:`event-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:B.name,date:B.date,location:B.location,numberOfDays:B.numberOfDays,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};u(!1),C({name:"",date:"",location:"Great Hall",numberOfDays:1}),n(L=>[...L,N]);try{console.log("💾 Saving new event to Supabase:",N);const L={name:N.name,date:N.date,schedule_data:{location:N.location,numberOfDays:N.numberOfDays,eventId:N.id}},V=await Ge.saveCalendarEvent(L);console.log("✅ Calendar event saved to Supabase:",V);const q=await Ge.saveRunOfShowData({event_id:N.id,event_name:N.name,event_date:N.date,schedule_items:[],custom_columns:[],settings:{eventName:N.name,masterStartTime:"",lastSaved:new Date().toISOString()}},{userId:r?.id||"unknown",userName:r?.user_metadata?.full_name||r?.email||"Unknown User",userRole:"EDITOR"});console.log("✅ Run of Show data created in Supabase:",q),setTimeout(()=>{console.log("🔄 Reloading events after save..."),ie()},1e3)}catch(L){console.error("❌ Error auto-saving event to Supabase:",L)}},X=async()=>{if(!k||!E.name||!E.date||!E.location){alert("Please fill in all fields");return}const A={...k,name:E.name,date:E.date,location:E.location,numberOfDays:E.numberOfDays,updated_at:new Date().toISOString()};w(null),F({name:"",date:"",location:"Great Hall",numberOfDays:1}),n(N=>N.map(L=>L.id===k.id?A:L));try{const L=(await Ge.getCalendarEvents()).find(V=>V.schedule_data?.eventId===k.id||V.name===k.name);if(L?.id){const V={name:A.name,date:A.date,schedule_data:{location:A.location,numberOfDays:A.numberOfDays,eventId:A.id}};await Ge.updateCalendarEvent(L.id,V),console.log("Calendar event updated in Supabase")}await Ge.updateRunOfShowData(k.id,{event_name:A.name,event_date:A.date,settings:{eventName:A.name,lastSaved:new Date().toISOString()}}),console.log("Run of Show data updated in Supabase")}catch(N){console.error("Error auto-updating event in Supabase:",N)}},ae=async A=>{if(window.confirm("Are you sure you want to delete this event?")){n(N=>N.filter(L=>L.id!==A));try{const N=e.find(L=>L.id===A);if(N){await Ge.deleteRunOfShowData(A),console.log("Run of Show data deleted from Supabase automatically");const V=(await Ge.getCalendarEvents()).find(q=>q.schedule_data?.eventId===A||q.name===N.name);V?.id&&(await Ge.deleteCalendarEvent(V.id),console.log("Calendar event deleted from Supabase automatically"))}}catch(N){console.error("Error auto-deleting event from Supabase:",N)}}},fe=A=>{w(A),F({name:A.name,date:A.date,location:A.location,numberOfDays:A.numberOfDays})},me=A=>{U(A),re(!0)},Te=async A=>{if(O&&r?.id){try{const N=r.user_metadata?.full_name||r.email||"Unknown";await Ge.saveUserSession(O.id,r.id,N,A),console.log("✅ Role saved to Supabase from EventListPage:",A)}catch(N){console.error("❌ Failed to save role to Supabase from EventListPage:",N)}t("/run-of-show",{state:{event:O,userRole:A}}),re(!1),U(null)}},be=A=>{const N=Vu.find(L=>L.value===A);return N?N.color:"bg-gray-600"},le=A=>{const[N,L,V]=A.split("-").map(Number);return new Date(N,L-1,V).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"America/New_York"})},pe=(()=>{console.log("🔍 Filtering events:",{totalEvents:e.length,activeTab:s,filterLocation:f,filterDays:p,searchTerm:y,events:e.map(V=>({id:V.id,name:V.name,date:V.date}))});const A=new Date,N=new Date(A.getFullYear(),A.getMonth(),A.getDate()),L=e.filter(V=>{const[q,ce,J]=V.date.split("-").map(Number),he=new Date(q,ce-1,J),Y=s==="upcoming"?he>=N:he<N,xe=f==="all"||V.location===f,Pe=p==="all"||V.numberOfDays.toString()===p,K=y===""||V.name.toLowerCase().includes(y.toLowerCase())||V.location.toLowerCase().includes(y.toLowerCase()),Xe=Y&&xe&&Pe&&K;return console.log(`🔍 Event "${V.name}" filter result:`,{dateMatch:Y,locationMatch:xe,daysMatch:Pe,searchMatch:K,passes:Xe,eventDate:he.toISOString(),now:A.toISOString()}),Xe}).sort((V,q)=>{const ce=new Date(V.date),J=new Date(q.date);return s==="upcoming"?ce.getTime()-J.getTime():J.getTime()-ce.getTime()});return console.log("📊 Filtered events result:",L.length,L.map(V=>V.name)),L})();return c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 text-slate-200 pt-16",children:[c.jsxs("div",{className:"text-center py-8",children:[c.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"📅 Event List Calendar"}),c.jsx("p",{className:"text-xl text-slate-400 mb-4",children:"Manage your events and schedules"}),r&&c.jsx("div",{className:"text-center mb-6",children:c.jsxs("p",{className:"text-white font-medium text-lg",children:["Welcome back, ",r.user_metadata?.full_name||r.email,"!"]})})]}),c.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[c.jsx("div",{className:"flex justify-center mb-8",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-1 flex",children:[c.jsx("button",{onClick:()=>o("upcoming"),className:`px-6 py-3 rounded-md font-semibold transition-colors ${s==="upcoming"?"bg-green-600 text-white":"text-slate-400 hover:text-white"}`,children:"📅 Upcoming Events"}),c.jsx("button",{onClick:()=>o("past"),className:`px-6 py-3 rounded-md font-semibold transition-colors ${s==="past"?"bg-orange-600 text-white":"text-slate-400 hover:text-white"}`,children:"📋 Past Events"})]})}),c.jsx("div",{className:"flex justify-center mb-6",children:c.jsx("div",{className:"bg-slate-800 rounded-lg p-4 w-full max-w-4xl",children:c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white font-semibold",children:"🔍 Search:"}),c.jsx("input",{type:"text",value:y,onChange:A=>S(A.target.value),placeholder:"Search events by name or location...",className:"w-80 px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white font-semibold",children:"📍 Filter by location:"}),c.jsxs("select",{value:f,onChange:A=>m(A.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:[c.jsx("option",{value:"all",children:"All Locations"}),Vu.map(A=>c.jsx("option",{value:A.value,children:A.label},A.value))]})]})]})})}),c.jsx("div",{className:"flex justify-center mb-8",children:c.jsx("button",{onClick:()=>u(!0),className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors",children:"+ Add New Event"})}),c.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 shadow-2xl",children:[ee&&c.jsx("div",{className:"text-center py-4 mb-4",children:c.jsx("div",{className:"text-blue-400 text-lg",children:"🔄 Loading events..."})}),c.jsx("div",{className:"bg-slate-800 rounded-lg overflow-hidden border border-slate-600",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-slate-700",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Event Name"}),c.jsx("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Date"}),c.jsx("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Location"}),c.jsx("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Duration"}),c.jsx("th",{className:"px-4 py-3 text-center text-slate-300 font-semibold",children:"Actions"})]})}),c.jsx("tbody",{children:pe.length===0?c.jsx("tr",{children:c.jsxs("td",{colSpan:5,className:"px-4 py-12 text-center",children:[c.jsx("div",{className:"text-6xl mb-4",children:s==="upcoming"?"📅":"📋"}),c.jsxs("h3",{className:"text-2xl font-bold text-white mb-2",children:["No ",s," events"]}),c.jsx("p",{className:"text-slate-400",children:s==="upcoming"?"Add your first upcoming event to get started!":"Past events will appear here once you have some."})]})}):pe.map(A=>c.jsxs("tr",{className:"border-b border-slate-600",children:[c.jsx("td",{className:"px-4 py-3 text-white font-medium border-r border-slate-600",children:A.name}),c.jsx("td",{className:"px-4 py-3 text-slate-300 border-r border-slate-600",children:le(A.date)}),c.jsx("td",{className:"px-4 py-3 border-r border-slate-600",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:`w-3 h-3 rounded-full ${be(A.location)}`}),c.jsx("span",{className:"text-slate-300",children:A.location})]})}),c.jsxs("td",{className:"px-4 py-3 text-slate-300 border-r border-slate-600",children:[A.numberOfDays," day",A.numberOfDays>1?"s":""]}),c.jsx("td",{className:"px-4 py-3",children:c.jsxs("div",{className:"flex gap-2 justify-center",children:[c.jsx("button",{onClick:()=>me(A),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm font-medium rounded transition-colors",children:"Launch"}),c.jsx("button",{onClick:()=>fe(A),className:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white text-sm font-medium rounded transition-colors",children:"Edit"}),c.jsx("button",{onClick:()=>ae(A.id),className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white text-sm font-medium rounded transition-colors",children:"Delete"})]})})]},A.id))})]})})})]})]}),l&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 max-w-sm w-full",children:[c.jsxs("h2",{className:"text-lg font-bold text-white mb-4",children:[c.jsx("span",{style:{filter:"brightness(0) invert(1)"},children:"📅"})," Add New Event"]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Event Name"}),c.jsx("input",{type:"text",value:B.name,onChange:A=>C(N=>({...N,name:A.target.value})),placeholder:"Enter event name",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Date"}),c.jsx("input",{type:"date",value:B.date,onChange:A=>C(N=>({...N,date:A.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",style:{colorScheme:"dark"}})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Location"}),c.jsx("select",{value:B.location,onChange:A=>C(N=>({...N,location:A.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:Vu.map(A=>c.jsx("option",{value:A.value,children:A.label},A.value))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Duration"}),c.jsx("select",{value:B.numberOfDays,onChange:A=>C(N=>({...N,numberOfDays:parseInt(A.target.value)})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:rp.map(A=>c.jsxs("option",{value:A,children:[A," day",A>1?"s":""]},A))})]})]}),c.jsxs("div",{className:"flex gap-2 mt-4",children:[c.jsx("button",{onClick:()=>{u(!1),C({name:"",date:"",location:"Great Hall",numberOfDays:1})},className:"flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded text-sm font-medium",children:"Cancel"}),c.jsx("button",{onClick:oe,className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded text-sm font-medium",children:"Add Event"})]})]})}),k&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 max-w-sm w-full",children:[c.jsxs("h2",{className:"text-lg font-bold text-white mb-4",children:[c.jsx("span",{style:{filter:"brightness(0) invert(1)"},children:"✏️"})," Edit Event"]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Event Name"}),c.jsx("input",{type:"text",value:E.name,onChange:A=>F(N=>({...N,name:A.target.value})),placeholder:"Enter event name",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Date"}),c.jsx("input",{type:"date",value:E.date,onChange:A=>F(N=>({...N,date:A.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",style:{colorScheme:"dark"}})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Location"}),c.jsx("select",{value:E.location,onChange:A=>F(N=>({...N,location:A.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:Vu.map(A=>c.jsx("option",{value:A.value,children:A.label},A.value))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Duration"}),c.jsx("select",{value:E.numberOfDays,onChange:A=>F(N=>({...N,numberOfDays:parseInt(A.target.value)})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:rp.map(A=>c.jsxs("option",{value:A,children:[A," day",A>1?"s":""]},A))})]})]}),c.jsxs("div",{className:"flex gap-2 mt-4",children:[c.jsx("button",{onClick:()=>{w(null),F({name:"",date:"",location:"Great Hall",numberOfDays:1})},className:"flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded text-sm font-medium",children:"Cancel"}),c.jsx("button",{onClick:X,className:"flex-1 px-3 py-2 bg-green-600 hover:bg-green-500 text-white rounded text-sm font-medium",children:"Update Event"})]})]})}),c.jsx(Hx,{isOpen:M,onClose:()=>{re(!1),U(null)},onRoleSelected:Te,eventId:O?.id||""})]})};class rS{constructor(){this.localChanges=[],this.syncTimer=null,this.SYNC_DELAY=5e3,this.MAX_BATCH_SIZE=10,this.MAX_SYNC_ATTEMPTS=3,this.loadLocalChanges(),this.startSyncTimer()}addChange(r){const e={...r,id:`change_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date,synced:!1};this.localChanges.push(e),this.saveLocalChanges(),console.log("📝 Change added to local buffer:",e.description),this.localChanges.filter(n=>!n.synced).length>=this.MAX_BATCH_SIZE&&this.syncChanges()}getLocalChanges(){return[...this.localChanges]}getUnsyncedChanges(){return this.localChanges.filter(r=>!r.synced)}getChangesCount(){const r=this.localChanges.length,e=this.localChanges.filter(n=>!n.synced).length;return{total:r,unsynced:e}}reloadLocalChanges(){this.loadLocalChanges(),console.log("🔄 Reloaded local changes:",this.localChanges.length)}startSyncTimer(){this.syncTimer&&clearInterval(this.syncTimer),this.syncTimer=setInterval(()=>{const r=this.getUnsyncedChanges();r.length>0&&(console.log(`🔄 Auto-syncing ${r.length} changes...`),this.syncChanges())},this.SYNC_DELAY)}stopSyncTimer(){this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null)}async syncChanges(){const r=this.getUnsyncedChanges();if(r.length===0)return!0;console.log(`🔄 Syncing ${r.length} changes to Supabase...`);try{const e=this.groupChangesByEvent(r);for(const[n,s]of e)await this.syncEventChanges(n,s);return this.localChanges=this.localChanges.map(n=>({...n,synced:!0})),this.saveLocalChanges(),console.log("✅ All changes synced successfully"),!0}catch(e){return console.error("❌ Error syncing changes:",e),!1}}groupChangesByEvent(r){const e=new Map;for(const n of r)e.has(n.eventId)||e.set(n.eventId,[]),e.get(n.eventId).push(n);return e}async syncEventChanges(r,e){console.log(`📤 Syncing ${e.length} changes for event ${r}`);const n={event_id:r,changes:e.map(o=>({id:o.id,timestamp:o.timestamp.toISOString(),user_id:o.userId,user_name:o.userName,user_role:o.userRole,action:o.action,description:o.description,details:o.details,row_number:o.rowNumber,cue_number:o.cueNumber,segment_name:o.segmentName})),created_at:new Date().toISOString(),synced:!0},{error:s}=await je.from("change_log_batches").insert([n]);if(s)throw new Error(`Failed to sync batch: ${s.message}`);for(const o of e)await Ge.logChange(o.eventId,o.userId,o.userName,o.userRole,o.action,"schedule_items",o.details?.itemId,o.details?.fieldName,o.details?.oldValue,o.details?.newValue,o.description,o.rowNumber,o.cueNumber,o.details)}loadLocalChanges(){try{const r=localStorage.getItem("runofshow_local_changes");if(r){const e=JSON.parse(r);this.localChanges=e.map(n=>({...n,timestamp:new Date(n.timestamp)})),console.log(`📂 Loaded ${this.localChanges.length} local changes from localStorage`)}else console.log("📂 No local changes found in localStorage"),this.localChanges=[]}catch(r){console.error("Error loading local changes:",r),this.localChanges=[]}}saveLocalChanges(){try{localStorage.setItem("runofshow_local_changes",JSON.stringify(this.localChanges))}catch(r){console.error("Error saving local changes:",r)}}clearLocalChanges(){this.localChanges=[],this.saveLocalChanges(),console.log("🗑️ Local changes cleared")}async clearMasterChangeLog(r){try{console.log("🗑️ Clearing master change log for event:",r);let e=0,n=[];const{data:{user:s},error:o}=await je.auth.getUser();if(console.log("🔄 Authenticated user:",s?.id,s?.email),o||!s)return console.error("❌ Authentication error:",o),{success:!1,error:"Not authenticated",deletedCount:0};console.log("🔄 Attempting to delete from change_log_batches table...");try{const{data:p,error:v}=await je.from("change_log_batches").select("id").eq("event_id",r);if(v)console.log("⚠️ Cannot access change_log_batches table:",v.message),n.push(`change_log_batches: ${v.message}`);else if(console.log(`📊 Found ${p?.length||0} batches to delete`),p&&p.length>0){const{data:y,error:S}=await je.from("change_log_batches").delete().eq("event_id",r).select("id");if(S)console.error("❌ Error deleting from change_log_batches:",S),n.push(`change_log_batches delete: ${S.message}`);else{const k=y?.length||0;console.log(`✅ Deleted ${k} batch records`),e+=k}}}catch(p){console.log("⚠️ change_log_batches table not accessible:",p),n.push(`change_log_batches: ${p.message}`)}console.log("🔄 Deleting from change_log table...");const{data:l,error:u}=await je.from("change_log").select("id").eq("event_id",r);if(u)console.error("❌ Error checking change_log records:",u),n.push(`change_log check: ${u.message}`);else if(console.log(`📊 Found ${l?.length||0} log records to delete`),l&&l.length>0){const{data:p,error:v}=await je.from("change_log").delete().eq("event_id",r).select("id");if(v)console.error("❌ Error deleting from change_log:",v),n.push(`change_log delete: ${v.message}`);else{const y=p?.length||0;console.log(`✅ Deleted ${y} log records`),e+=y}}const f=n.length===0||e>0,m=n.length>0?n.join("; "):void 0;return console.log(f?`✅ Master change log cleared: ${e} total records deleted`:`⚠️ Master change log clearing failed: ${m}`),{success:f,error:m,deletedCount:e}}catch(e){return console.error("❌ Unexpected error clearing master change log:",e),{success:!1,error:e.message||"Unexpected error",deletedCount:0}}}async getMasterChangeLog(r,e=100){try{console.log("🔄 Fetching master change log from Supabase for event:",r);const{data:n,error:s}=await je.from("change_log_batches").select("*").eq("event_id",r).order("created_at",{ascending:!1}).limit(e);if(s){console.error("❌ Error fetching change batches:",s),console.log("🔄 Falling back to regular change_log table...");const{data:u,error:f}=await je.from("change_log").select("*").eq("event_id",r).order("created_at",{ascending:!1}).limit(e);return f?(console.error("❌ Error fetching regular change log:",f),[]):(console.log("📊 Loaded regular change log:",u?.length||0,"changes"),u||[])}console.log("📊 Loaded change batches:",n?.length||0,"batches");const o=[];for(const u of n||[])if(u.changes&&Array.isArray(u.changes))for(const f of u.changes)o.push({...f,batch_id:u.id,batch_created_at:u.created_at});console.log("📊 Flattened changes from batches:",o.length,"changes");const l=o.sort((u,f)=>new Date(f.timestamp).getTime()-new Date(u.timestamp).getTime()).slice(0,e);return console.log("📊 Final sorted changes:",l.length,"changes"),l}catch(n){return console.error("❌ Error getting master change log:",n),[]}}exportChangesAsJSON(){return JSON.stringify(this.localChanges,null,2)}exportChangesAsCSV(){if(this.localChanges.length===0)return"No changes to export";const r=["Timestamp","User","Role","Action","Description","Row","Cue","Segment","Synced"],e=this.localChanges.map(n=>[n.timestamp.toISOString(),n.userName,n.userRole,n.action,n.description,n.rowNumber||"",n.cueNumber||"",n.segmentName||"",n.synced?"Yes":"No"]);return[r,...e].map(n=>n.join(",")).join(`
`)}}const Sr=new rS;window.addEventListener("beforeunload",()=>{Sr.stopSyncTimer()});class Li{static async testBackupTable(){try{console.log("🔄 Testing backup table access...");const{data:r,error:e}=await je.from("run_of_show_backups").select("id").limit(1);return e?(console.error("❌ Backup table test failed:",e),!1):(console.log("✅ Backup table is accessible"),!0)}catch(r){return console.error("❌ Backup table test error:",r),!1}}static async createBackup(r,e,n,s,o="auto",l){try{console.log(`🔄 Creating/updating ${o} backup for event: ${r}`);const{data:{user:u}}=await je.auth.getUser();if(!u)throw new Error("User not authenticated");const f=s?.name||"Unknown Event",m=s?.date?new Date(s.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],p=s?.location||null,v=new Date().toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),y=l||`${o==="auto"?"Auto Backup":"Manual Backup"} - ${v}`,{data:S,error:k}=await je.from("run_of_show_backups").select("*").eq("event_id",r).eq("event_date",m).single();if(k&&k.code!=="PGRST116")throw k;let w;if(S){console.log(`🔄 Updating existing backup for ${f} on ${m}`);const{data:E,error:F}=await je.from("run_of_show_backups").update({backup_name:y,schedule_data:e,custom_columns_data:n,event_data:s,backup_type:o,event_name:f,event_location:p,schedule_items_count:e?.length||0,custom_columns_count:n?.length||0,updated_at:new Date().toISOString()}).eq("id",S.id).select().single();if(F)throw F;w=E,console.log(`✅ Backup updated successfully: ${E.backup_name}`)}else{console.log(`🔄 Creating new backup for ${f} on ${m}`);const{data:E,error:F}=await je.from("run_of_show_backups").insert({event_id:r,backup_name:y,schedule_data:e,custom_columns_data:n,event_data:s,backup_type:o,event_name:f,event_date:m,event_location:p,schedule_items_count:e?.length||0,custom_columns_count:n?.length||0,created_by:u.id}).select().single();if(F)throw F;w=E,console.log(`✅ Backup created successfully: ${E.backup_name}`)}return w}catch(u){throw console.error("❌ Error creating/updating backup:",u),new Error(`Failed to create/update backup: ${u.message}`)}}static async getBackupsForEvent(r){try{console.log(`🔄 Fetching backups for event: ${r}`),console.log("🔄 Supabase client status:",je?"Connected":"Not connected");const{data:e,error:n}=await je.from("run_of_show_backups").select("*").eq("event_id",r).order("backup_timestamp",{ascending:!1});if(console.log("🔄 Supabase query result:",{data:e,error:n}),n)throw console.error("❌ Supabase error details:",{code:n.code,message:n.message,details:n.details,hint:n.hint}),n;return console.log(`✅ Found ${e?.length||0} backups for event: ${r}`),console.log("📊 Backup data:",e),e||[]}catch(e){throw console.error("❌ Error fetching backups:",e),console.error("❌ Error type:",typeof e),console.error("❌ Error message:",e.message),new Error(`Failed to fetch backups: ${e.message}`)}}static async getBackupsWithFilters(r={}){try{console.log("🔄 Fetching backups with filters:",r);let e=je.from("run_of_show_backups").select("*");switch(r.eventId&&(e=e.eq("event_id",r.eventId)),r.eventName&&(e=e.ilike("event_name",`%${r.eventName}%`)),r.eventDate&&(e=e.eq("event_date",r.eventDate)),r.backupType&&(e=e.eq("backup_type",r.backupType)),r.sortBy){case"oldest":e=e.order("backup_timestamp",{ascending:!0});break;case"event":e=e.order("event_name",{ascending:!0});break;case"type":e=e.order("backup_type",{ascending:!0});break;case"newest":default:e=e.order("backup_timestamp",{ascending:!1});break}r.limit&&(e=e.limit(r.limit));const{data:n,error:s}=await e;if(s)throw s;return console.log(`✅ Found ${n?.length||0} backups with filters`),n||[]}catch(e){throw console.error("❌ Error fetching backups with filters:",e),new Error(`Failed to fetch backups: ${e.message}`)}}static async restoreFromBackup(r){try{console.log(`🔄 Restoring from backup: ${r}`);const{data:e,error:n}=await je.from("run_of_show_backups").select("*").eq("id",r).single();if(n)throw n;if(!e)throw new Error("Backup not found");return console.log(`✅ Restored from backup: ${e.backup_name}`),{scheduleData:e.schedule_data||[],customColumnsData:e.custom_columns_data||[],eventData:e.event_data||{},backupName:e.backup_name,backupTimestamp:e.backup_timestamp}}catch(e){throw console.error("❌ Error restoring from backup:",e),new Error(`Failed to restore from backup: ${e.message}`)}}static async deleteBackup(r){try{console.log(`🔄 Deleting backup: ${r}`);const{error:e}=await je.from("run_of_show_backups").delete().eq("id",r);if(e)throw e;return console.log(`✅ Backup deleted successfully: ${r}`),!0}catch(e){throw console.error("❌ Error deleting backup:",e),new Error(`Failed to delete backup: ${e.message}`)}}static async getBackupStats(r){try{const e=await this.getBackupsForEvent(r),n=e.filter(l=>l.backup_type==="auto").length,s=e.filter(l=>l.backup_type==="manual").length,o=e.length>0?e[0].backup_timestamp:null;return{totalBackups:e.length,lastBackup:o,autoBackups:n,manualBackups:s}}catch(e){throw console.error("❌ Error getting backup stats:",e),new Error(`Failed to get backup stats: ${e.message}`)}}}class nS{constructor(r){this.activeTimers=new Map,this.checkInterval=null,this.syncCallbacks=new Map,this.isRunning=!1,this.config={checkInterval:3e4,maxDriftThreshold:5,forceSyncInterval:3e4,minTimerDuration:0,...r}}startMonitoring(r,e,n,s){if(console.log(`🔄 DriftDetector: Starting monitoring for timer ${r}`,{startedAt:e.toISOString(),duration:n,minDuration:this.config.minTimerDuration}),n<this.config.minTimerDuration){console.log(`⏭️ DriftDetector: Skipping timer ${r} - duration too short (${n}s < ${this.config.minTimerDuration}s)`);return}const o={itemId:r,startedAt:e,duration:n,lastSyncAt:new Date,localElapsed:0,serverElapsed:0};this.activeTimers.set(r,o),this.syncCallbacks.set(r,s),this.isRunning||this.startMonitoringLoop()}stopMonitoring(r){console.log(`🔄 DriftDetector: Stopping monitoring for timer ${r}`),this.activeTimers.delete(r),this.syncCallbacks.delete(r),this.activeTimers.size===0&&this.isRunning&&this.stopMonitoringLoop()}updateLocalElapsed(r,e){const n=this.activeTimers.get(r);n&&(n.localElapsed=e)}async forceSync(r,e){const n=this.activeTimers.get(r);if(n)try{const s=await e(),o=Math.abs(s-n.localElapsed);console.log(`🔄 DriftDetector: Force sync for timer ${r}`,{localElapsed:n.localElapsed,serverElapsed:s,drift:o.toFixed(2)}),n.serverElapsed=s,n.lastSyncAt=new Date;const l=this.syncCallbacks.get(r);l&&l(s)}catch(s){console.error(`❌ DriftDetector: Error during force sync for timer ${r}:`,s)}}startMonitoringLoop(){this.isRunning||(console.log("🔄 DriftDetector: Starting monitoring loop"),this.isRunning=!0,this.checkInterval=setInterval(()=>{this.checkAllTimers()},this.config.checkInterval))}stopMonitoringLoop(){this.isRunning&&(console.log("🔄 DriftDetector: Stopping monitoring loop"),this.isRunning=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null))}async checkAllTimers(){const r=new Date,e=[];for(const[n,s]of this.activeTimers)e.push(this.checkTimerDrift(n,s,r));await Promise.all(e)}async checkTimerDrift(r,e,n){try{const s=n.getTime()-e.lastSyncAt.getTime();if(s>=this.config.forceSyncInterval){console.log(`🔄 DriftDetector: Force sync needed for timer ${r} (${s}ms since last sync)`);return}const l=Math.floor((n.getTime()-e.startedAt.getTime())/1e3),u=Math.abs(l-e.localElapsed);u>this.config.maxDriftThreshold&&console.log(`⚠️ DriftDetector: Significant drift detected for timer ${r}`,{localElapsed:e.localElapsed,expectedElapsed:l,drift:u.toFixed(2),threshold:this.config.maxDriftThreshold})}catch(s){console.error(`❌ DriftDetector: Error checking drift for timer ${r}:`,s)}}getConfig(){return{...this.config}}updateConfig(r){this.config={...this.config,...r},console.log("🔄 DriftDetector: Configuration updated",this.config)}getStatus(){const r=new Date;return Array.from(this.activeTimers.entries()).map(([e,n])=>{const s=Math.abs(n.serverElapsed-n.localElapsed),o=r.getTime()-n.lastSyncAt.getTime();return{itemId:e,drift:s,timeSinceLastSync:o}})}getStatusForTimer(r){const e=this.activeTimers.get(r);if(!e)return{itemId:r,drift:0,timeSinceLastSync:0};const n=new Date,s=Math.abs(e.serverElapsed-e.localElapsed),o=n.getTime()-e.lastSyncAt.getTime();return{itemId:r,drift:s,timeSinceLastSync:o}}destroy(){console.log("🔄 DriftDetector: Destroying drift detector"),this.stopMonitoringLoop(),this.activeTimers.clear(),this.syncCallbacks.clear()}}const Vr=new nS,zx=({itemId:t,className:r=""})=>{const[e,n]=j.useState(null);if(j.useEffect(()=>{console.log(`🔄 DriftStatusIndicator: Starting for itemId ${t}`);const f=()=>{const p=Vr.getStatusForTimer(t);console.log(`🔄 DriftStatusIndicator: Status for itemId ${t}:`,p),p?(console.log(`🔄 DriftStatusIndicator: Found status for itemId ${t}:`,p),n({drift:p.drift,timeSinceLastSync:p.timeSinceLastSync})):(console.log(`🔄 DriftStatusIndicator: No status found for itemId ${t}`),n(null))};f();const m=setInterval(f,5e3);return()=>clearInterval(m)},[t]),!e)return console.log(`🔄 DriftStatusIndicator: No drift info for itemId ${t}, showing blue dot (starting up)`),c.jsx("div",{className:`drift-status ${r}`,children:c.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500",title:`Drift detection starting up for timer ${t}`})});const{drift:s,timeSinceLastSync:o}=e,l=s>5,u=o>6e4;return c.jsx("div",{className:`drift-status ${r}`,children:c.jsx("div",{className:`w-2 h-2 rounded-full ${l?"bg-red-500":u?"bg-yellow-500":"bg-green-500"}`,title:`Drift: ${s.toFixed(1)}s, Last sync: ${Math.round(o/1e3)}s ago`})})},sS=({isOpen:t,onClose:r,event:e,schedule:n,activeItemId:s,activeTimers:o,onLoadCue:l,onStartTimer:u,onStopTimer:f,onResetTimer:m})=>{const[p,v]=j.useState({isConnected:!1,serverPort:57121}),[y,S]=j.useState("localhost"),[k,w]=j.useState([]),[E,F]=j.useState(""),[B,C]=j.useState(""),[M,re]=j.useState(!0),[O,U]=j.useState(null),ee=j.useRef(null),I=()=>{ee.current?.scrollIntoView({behavior:"smooth"})};j.useEffect(()=>{I()},[k]);const ie=(L,V)=>{if(console.log("🎯 Handling OSC response:",L,V),L==="/cue/loaded"&&V.length>=1){const q=V[0];console.log("🎯 Cue loaded, finding item for cue ID:",q);const ce=oe(q);ce&&l?(console.log("🎯 Found item for cue, calling onLoadCue:",ce.id),l(ce.id.toString())):console.log("❌ Could not find item for cue ID:",q)}else if(L==="/timer/started")console.log("🎯 Generic timer started - controlling currently loaded cue"),u&&u("generic");else if(L==="/timer/stopped")console.log("🎯 Generic timer stopped - controlling currently loaded cue"),f&&f("generic");else if(L==="/timer/reset")console.log("🎯 Generic timer reset - using resetAllStates"),m&&m("generic");else if(L==="/subtimer/started"&&V.length>=1){const q=V[0];console.log("🎯 Sub-timer started, finding item for sub-timer ID:",q);const ce=X(q);ce&&u?(console.log("🎯 Found item for sub-timer, calling onStartTimer:",ce.id),u(ce.id.toString())):console.log("❌ Could not find item for sub-timer ID:",q)}else if(L==="/subtimer/stopped"&&V.length>=1){const q=V[0];console.log("🎯 Sub-timer stopped, finding item for sub-timer ID:",q);const ce=X(q);ce&&f?(console.log("🎯 Found item for sub-timer, calling onStopTimer:",ce.id),f(ce.id.toString())):console.log("❌ Could not find item for sub-timer ID:",q)}},oe=L=>n.length?n.find(V=>{const q=V.customFields?.cue||"";return q===L||q===`CUE ${L}`||q===`CUE${L}`}):null,X=L=>n.length?n.find(V=>V.isIndented&&(V.timerId===L||V.id.toString()===L)):null;j.useEffect(()=>t?((()=>{try{const V=new WebSocket(`ws://${y}:${p.serverPort}/osc`);V.onopen=()=>{console.log("🔌 OSC WebSocket connected"),v(q=>({...q,isConnected:!0,error:void 0})),ae({address:"/system/connected",args:[],direction:"outgoing"})},V.onmessage=q=>{try{console.log("📨 OSC WebSocket message received:",q.data);const ce=JSON.parse(q.data);ce.type==="connected"?console.log("✅ OSC Server:",ce.message):ce.type==="osc_response"?(console.log("📥 OSC Response:",ce.address,ce.args),ae({address:ce.address,args:ce.args,direction:"incoming"}),ie(ce.address,ce.args)):ce.type==="pong"&&(console.log("🏓 Pong received"),ae({address:"/pong",args:["server","alive"],direction:"incoming"}))}catch(ce){console.error("❌ Error parsing WebSocket message:",ce)}},V.onerror=q=>{console.error("❌ WebSocket error:",q),v(ce=>({...ce,isConnected:!1,error:"OSC server not running - start osc-websocket-server.js"}))},V.onclose=()=>{console.log("🔌 OSC WebSocket disconnected"),v(q=>({...q,isConnected:!1,error:"Connection closed"}))},U(V),setTimeout(()=>{V.readyState===WebSocket.OPEN?(console.log("🏓 Sending ping to OSC server..."),V.send(JSON.stringify({type:"osc",address:"/ping",args:[]}))):console.log("❌ WebSocket not ready for ping")},1e3)}catch(V){console.error("❌ Failed to initialize OSC WebSocket:",V),v(q=>({...q,isConnected:!1,error:"Failed to create WebSocket connection"}))}})(),()=>{O&&O.readyState===WebSocket.OPEN&&O.close()}):void 0,[t]);const ae=L=>{if(!M)return;const V={...L,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date};w(q=>[...q.slice(-99),V])},fe=(L,V=[])=>{if(!O||!p.isConnected){console.log("❌ OSC server not connected - cannot send message"),alert("OSC server not connected");return}try{const q={type:"osc",address:L,args:V};console.log("📤 Sending OSC message:",q),O.send(JSON.stringify(q)),ae({address:L,args:V,direction:"outgoing"})}catch(q){console.error("❌ Error sending OSC message:",q),alert("Failed to send OSC message")}},me=()=>{if(!E.trim()){alert("Please enter a cue name");return}const L=E.trim();fe(`/cue/${L}/load`,[])},Te=()=>{s?(console.log("🎯 Generic start - controlling currently loaded item:",s),fe("/timer/start",[])):alert("No cue is currently loaded. Please load a cue first.")},be=()=>{const L=Object.keys(o);if(L.length>0){const V=parseInt(L[0]);console.log("🎯 Generic stop - controlling currently running timer:",V),fe("/timer/stop",[])}else alert("No timer is currently running.")},le=()=>{console.log("🎯 Generic reset - using resetAllStates (same as Reset button)"),fe("/timer/reset",[])},te=()=>{if(!B.trim()){alert("Please enter a sub-timer ID");return}fe(`/subtimer/${B.trim()}/start`,[])},pe=()=>{if(!B.trim()){alert("Please enter a sub-timer ID");return}fe(`/subtimer/${B.trim()}/stop`,[])},A=()=>{w([])},N=L=>L.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3});return t?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h2",{className:"text-xl font-semibold text-white",children:"OSC Control Panel"}),c.jsx("button",{onClick:r,className:"text-slate-400 hover:text-white transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"flex-1 overflow-hidden",children:[c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full",children:[c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Server Configuration"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Server Host/IP"}),c.jsx("input",{type:"text",value:y,onChange:L=>S(L.target.value),placeholder:"localhost, 192.168.1.100, or your computer's IP",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Use 'localhost' for same computer, or your computer's IP address for network access"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Server Port"}),c.jsx("input",{type:"number",value:p.serverPort,onChange:L=>v(V=>({...V,serverPort:parseInt(L.target.value)||57121})),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsx("button",{onClick:()=>{p.isConnected?v(L=>({...L,isConnected:!1})):initOSC()},className:`w-full px-4 py-2 rounded-md font-medium ${p.isConnected?"bg-red-600 hover:bg-red-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:p.isConnected?"Disconnect":"Connect"})]})]}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Connection Status"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:`w-3 h-3 rounded-full ${p.isConnected?"bg-green-500":"bg-red-500"}`}),c.jsx("span",{className:"text-sm",children:p.isConnected?"Connected":"Disconnected"})]}),c.jsxs("div",{className:"text-sm text-slate-400",children:["Server: ",y,":",p.serverPort]}),c.jsxs("div",{className:"border-t border-slate-600 pt-3",children:[c.jsx("div",{className:"text-sm font-medium text-slate-300 mb-2",children:"Current State:"}),c.jsxs("div",{className:"text-xs text-slate-400 space-y-1",children:[c.jsxs("div",{children:["Loaded Cue: ",s?`Item ${s}`:"None"]}),c.jsxs("div",{children:["Running Timers: ",Object.keys(o).length]}),Object.keys(o).length>0&&c.jsxs("div",{className:"text-green-400",children:["Active: ",Object.keys(o).map(L=>`Item ${L}`).join(", ")]})]})]}),p.error&&c.jsxs("div",{className:"text-sm text-red-400",children:["Error: ",p.error]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>{O&&O.readyState===WebSocket.OPEN&&O.send(JSON.stringify({type:"osc",address:"/ping",args:[]}))},className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Test Connection"}),!p.isConnected&&c.jsx("button",{onClick:()=>{O&&O.close(),v(L=>({...L,error:void 0}))},className:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white text-sm rounded transition-colors",children:"Retry"})]})]})]}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Cue & Timer Controls"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Cue Name (to load)"}),c.jsx("input",{type:"text",value:E,onChange:L=>F(L.target.value),placeholder:"Enter cue name (1, 1.1, 1A, etc.)",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Sub-Timer ID (for indented items)"}),c.jsx("input",{type:"text",value:B,onChange:L=>C(L.target.value),placeholder:"Enter sub-timer ID",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Main Cue Controls"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:me,className:"px-3 py-2 bg-purple-600 hover:bg-purple-500 text-white text-sm rounded transition-colors",children:"Load Cue"}),c.jsx("button",{onClick:Te,className:"px-3 py-2 bg-green-600 hover:bg-green-500 text-white text-sm rounded transition-colors",children:"Start (Generic)"}),c.jsx("button",{onClick:be,className:"px-3 py-2 bg-red-600 hover:bg-red-500 text-white text-sm rounded transition-colors",children:"Stop (Generic)"}),c.jsx("button",{onClick:le,className:"px-3 py-2 bg-yellow-600 hover:bg-yellow-500 text-white text-sm rounded transition-colors",children:"Reset (Generic)"})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Sub-Timer Controls"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:te,className:"px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Start Sub-Timer"}),c.jsx("button",{onClick:pe,className:"px-3 py-2 bg-orange-600 hover:bg-orange-500 text-white text-sm rounded transition-colors",children:"Stop Sub-Timer"})]})]})]})]}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Message Log"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:M,onChange:L=>re(L.target.checked),className:"rounded"}),c.jsx("label",{className:"text-sm text-slate-300",children:"Enable Logging"})]}),c.jsxs("div",{className:"text-sm text-slate-400",children:["Messages: ",k.length]}),c.jsxs("div",{className:"text-xs text-slate-500 space-y-1",children:[c.jsx("div",{children:c.jsx("strong",{children:"OSC Message Examples:"})}),c.jsx("div",{className:"font-semibold text-slate-400",children:"Main Cue Commands:"}),c.jsx("div",{children:"/cue/1/load"}),c.jsx("div",{children:"/cue/1.1/load"}),c.jsx("div",{children:"/cue/1A/load"}),c.jsx("div",{className:"font-semibold text-slate-400 mt-2",children:"Generic Timer Commands:"}),c.jsx("div",{children:"/timer/start"}),c.jsx("div",{children:"/timer/stop"}),c.jsx("div",{children:"/timer/reset"}),c.jsx("div",{className:"font-semibold text-slate-400 mt-2",children:"Sub-Timer Commands:"}),c.jsx("div",{children:"/subtimer/SUB1/start"}),c.jsx("div",{children:"/subtimer/SUB1/stop"})]})]})]})]}),c.jsxs("div",{className:"mt-6 bg-slate-700 rounded-lg p-4 flex-1 min-h-0",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-white",children:"OSC Message Log"}),c.jsx("button",{onClick:A,className:"px-3 py-1 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded transition-colors",children:"Clear Messages"})]}),c.jsxs("div",{className:"bg-slate-900 rounded-lg p-4 h-64 overflow-y-auto font-mono text-sm",children:[k.length===0?c.jsx("div",{className:"text-slate-500 text-center py-8",children:p.isConnected?"No messages yet. Send OSC commands to see messages.":c.jsxs("div",{children:[c.jsx("div",{className:"text-red-400 mb-2",children:"⚠️ OSC Server Not Connected"}),p.error?.includes("Node.js environment")?c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-yellow-400 mb-2",children:"OSC requires local Node.js server"}),c.jsx("div",{className:"text-sm",children:"For online deployment, OSC is not available."}),c.jsx("div",{className:"text-sm",children:"For local use with OSC:"}),c.jsx("div",{className:"text-xs font-mono bg-slate-800 p-2 rounded mt-2",children:"start-both-servers.bat"}),c.jsx("div",{className:"text-xs mt-1",children:"Or: start-websocket-osc-server.bat"})]}):c.jsxs("div",{children:[c.jsx("div",{className:"text-sm",children:"Start the OSC server using:"}),c.jsx("div",{className:"text-xs font-mono bg-slate-800 p-2 rounded mt-2",children:"node osc-server.js"}),c.jsx("div",{className:"text-xs mt-2",children:"Or use the batch file: start-osc-server.bat"})]})]})}):k.map(L=>c.jsxs("div",{className:`flex items-start gap-3 py-1 ${L.direction==="incoming"?"text-green-400":"text-blue-400"}`,children:[c.jsx("span",{className:"text-slate-500 text-xs w-20 flex-shrink-0",children:N(L.timestamp)}),c.jsx("span",{className:"text-slate-500 text-xs w-20 flex-shrink-0",children:L.direction==="incoming"?"←":"→"}),c.jsx("span",{className:"text-yellow-400 flex-shrink-0",children:L.address}),L.args.length>0&&c.jsx("span",{className:"text-slate-300",children:JSON.stringify(L.args)})]},L.id)),c.jsx("div",{ref:ee})]})]})]})]})}):null};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Gx=1252,aS=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],lh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ch=function(t){aS.indexOf(t)!=-1&&(Gx=lh[0]=t)};function iS(){ch(1252)}var xs=function(t){ch(t)};function Kx(){xs(1200),iS()}function np(t){for(var r=[],e=0,n=t.length;e<n;++e)r[e]=t.charCodeAt(e);return r}function oS(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e)+(t.charCodeAt(2*e+1)<<8));return r.join("")}function Xx(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return r.join("")}var Gl=function(t){var r=t.charCodeAt(0),e=t.charCodeAt(1);return r==255&&e==254?oS(t.slice(2)):r==254&&e==255?Xx(t.slice(2)):r==65279?t.slice(1):t},Wu=function(r){return String.fromCharCode(r)},sp=function(r){return String.fromCharCode(r)},uc,Ja="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ap(t){for(var r="",e=0,n=0,s=0,o=0,l=0,u=0,f=0,m=0;m<t.length;)e=t.charCodeAt(m++),o=e>>2,n=t.charCodeAt(m++),l=(e&3)<<4|n>>4,s=t.charCodeAt(m++),u=(n&15)<<2|s>>6,f=s&63,isNaN(n)?u=f=64:isNaN(s)&&(f=64),r+=Ja.charAt(o)+Ja.charAt(l)+Ja.charAt(u)+Ja.charAt(f);return r}function Hn(t){var r="",e=0,n=0,s=0,o=0,l=0,u=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<t.length;)o=Ja.indexOf(t.charAt(m++)),l=Ja.indexOf(t.charAt(m++)),e=o<<2|l>>4,r+=String.fromCharCode(e),u=Ja.indexOf(t.charAt(m++)),n=(l&15)<<4|u>>2,u!==64&&(r+=String.fromCharCode(n)),f=Ja.indexOf(t.charAt(m++)),s=(u&3)<<6|f,f!==64&&(r+=String.fromCharCode(s));return r}var _t=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),qi=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function Za(t){return _t?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function ip(t){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ps=function(r){return _t?qi(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)&255})};function Ji(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function uh(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return uh(new Uint8Array(t));for(var r=new Array(t.length),e=0;e<t.length;++e)r[e]=t[e];return r}var qa=_t?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:qi(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var n=new Uint8Array(e),s=0;for(r=0,e=0;r<t.length;e+=s,++r)if(s=t[r].length,t[r]instanceof Uint8Array)n.set(t[r],e);else{if(typeof t[r]=="string")throw"wtf";n.set(new Uint8Array(t[r]),e)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function lS(t){for(var r=[],e=0,n=t.length+250,s=Za(t.length+255),o=0;o<t.length;++o){var l=t.charCodeAt(o);if(l<128)s[e++]=l;else if(l<2048)s[e++]=192|l>>6&31,s[e++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=t.charCodeAt(++o)&1023;s[e++]=240|l>>8&7,s[e++]=128|l>>2&63,s[e++]=128|u>>6&15|(l&3)<<4,s[e++]=128|u&63}else s[e++]=224|l>>12&15,s[e++]=128|l>>6&63,s[e++]=128|l&63;e>n&&(r.push(s.slice(0,e)),e=0,s=Za(65535),n=65530)}return r.push(s.slice(0,e)),qa(r)}var yn=/\u0000/g,Kl=/[\u0001-\u0006]/g;function Xo(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function vs(t,r){var e=""+t;return e.length>=r?e:or("0",r-e.length)+e}function dh(t,r){var e=""+t;return e.length>=r?e:or(" ",r-e.length)+e}function sd(t,r){var e=""+t;return e.length>=r?e:e+or(" ",r-e.length)}function cS(t,r){var e=""+Math.round(t);return e.length>=r?e:or("0",r-e.length)+e}function uS(t,r){var e=""+t;return e.length>=r?e:or("0",r-e.length)+e}var op=Math.pow(2,32);function Wo(t,r){if(t>op||t<-op)return cS(t,r);var e=Math.round(t);return uS(e,r)}function ad(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var lp=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],pf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dS(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var gt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},cp={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},fS={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function id(t,r,e){for(var n=t<0?-1:1,s=t*n,o=0,l=1,u=0,f=1,m=0,p=0,v=Math.floor(s);m<r&&(v=Math.floor(s),u=v*l+o,p=v*m+f,!(s-v<5e-8));)s=1/(s-v),o=l,l=u,f=m,m=p;if(p>r&&(m>r?(p=f,u=o):(p=m,u=l)),!e)return[0,n*u,p];var y=Math.floor(n*u/p);return[y,n*u-y*p,p]}function Bi(t,r,e){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),o=0,l=[],u={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),r&&r.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++n,++u.D)),n===60)l=e?[1317,10,29]:[1900,2,29],o=3;else if(n===0)l=e?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),n<60&&(o=(o+6)%7),e&&(o=vS(f,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=o,u}var qx=new Date(1899,11,31,0,0,0),hS=qx.getTime(),mS=new Date(1900,2,1,0,0,0);function Jx(t,r){var e=t.getTime();return r?e-=1461*24*60*60*1e3:t>=mS&&(e+=1440*60*1e3),(e-(hS+(t.getTimezoneOffset()-qx.getTimezoneOffset())*6e4))/(1440*60*1e3)}function fh(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function gS(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function pS(t){var r=t<0?12:11,e=fh(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10),e.length<=r)?e:t.toExponential(5)}function xS(t){var r=fh(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function dc(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return r>=-4&&r<=-1?e=t.toPrecision(10+r):Math.abs(r)<=9?e=pS(t):r===10?e=t.toFixed(10).substr(0,12):e=xS(t),fh(gS(e.toUpperCase()))}function Hi(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):dc(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return rs(14,Jx(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function vS(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function yS(t,r,e,n){var s="",o=0,l=0,u=e.y,f,m=0;switch(t){case 98:u=e.y+543;case 121:switch(r.length){case 1:case 2:f=u%100,m=2;break;default:f=u%1e4,m=4;break}break;case 109:switch(r.length){case 1:case 2:f=e.m,m=r.length;break;case 3:return pf[e.m-1][1];case 5:return pf[e.m-1][0];default:return pf[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:f=e.d,m=r.length;break;case 3:return lp[e.q][0];default:return lp[e.q][1]}break;case 104:switch(r.length){case 1:case 2:f=1+(e.H+11)%12,m=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:f=e.H,m=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:f=e.M,m=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return e.u===0&&(r=="s"||r=="ss")?vs(e.S,r.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,o=Math.round(l*(e.S+e.u)),o>=60*l&&(o=0),r==="s"?o===0?"0":""+o/l:(s=vs(o,2+n),r==="ss"?s.substr(0,2):"."+s.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":f=e.D*24+e.H;break;case"[m]":case"[mm]":f=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":f=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+r}m=r.length===3?1:2;break;case 101:f=u,m=1;break}var p=m>0?vs(f,m):"";return p}function Ya(t){var r=3;if(t.length<=r)return t;for(var e=t.length%r,n=t.substr(0,e);e!=t.length;e+=r)n+=(n.length>0?",":"")+t.substr(e,r);return n}var Yx=/%/g;function wS(t,r,e){var n=r.replace(Yx,""),s=r.length-n.length;return ua(t,n,e*Math.pow(10,2*s))+or("%",s)}function bS(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ua(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function Qx(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Qx(t,-r);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%s;if(o<0&&(o+=s),e=(r/Math.pow(10,o)).toPrecision(n+1+(s+o)%s),e.indexOf("e")===-1){var l=Math.floor(Math.log(r)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(l-e.length+o):e+="E+"+(l-o);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,s)+"."+e.substr(2+s),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,m,p){return f+m+p.substr(0,(s+o)%s)+"."+p.substr(o)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var Zx=/# (\?+)( ?)\/( ?)(\d+)/;function _S(t,r,e){var n=parseInt(t[4],10),s=Math.round(r*n),o=Math.floor(s/n),l=s-o*n,u=n;return e+(o===0?"":""+o)+" "+(l===0?or(" ",t[1].length+1+t[4].length):dh(l,t[1].length)+t[2]+"/"+t[3]+vs(u,t[4].length))}function SS(t,r,e){return e+(r===0?"":""+r)+or(" ",t[1].length+2+t[4].length)}var ev=/^#*0*\.([0#]+)/,tv=/\).*[0#]/,rv=/\(###\) ###\\?-####/;function pn(t){for(var r="",e,n=0;n!=t.length;++n)switch(e=t.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function up(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function dp(t,r){var e=t-Math.floor(t),n=Math.pow(10,r);return r<(""+Math.round(e*n)).length?0:Math.round(e*n)}function ES(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function kS(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function es(t,r,e){if(t.charCodeAt(0)===40&&!r.match(tv)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?es("n",n,e):"("+es("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return bS(t,r,e);if(r.indexOf("%")!==-1)return wS(t,r,e);if(r.indexOf("E")!==-1)return Qx(r,e);if(r.charCodeAt(0)===36)return"$"+es(t,r.substr(r.charAt(1)==" "?2:1),e);var s,o,l,u,f=Math.abs(e),m=e<0?"-":"";if(r.match(/^00+$/))return m+Wo(f,r.length);if(r.match(/^[#?]+$/))return s=Wo(e,0),s==="0"&&(s=""),s.length>r.length?s:pn(r.substr(0,r.length-s.length))+s;if(o=r.match(Zx))return _S(o,f,m);if(r.match(/^#+0+$/))return m+Wo(f,r.length-r.indexOf("0"));if(o=r.match(ev))return s=up(e,o[1].length).replace(/^([^\.]+)$/,"$1."+pn(o[1])).replace(/\.$/,"."+pn(o[1])).replace(/\.(\d*)$/,function(k,w){return"."+w+or("0",pn(o[1]).length-w.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return m+up(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return m+Ya(Wo(f,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+es(t,r,-e):Ya(""+(Math.floor(e)+ES(e,o[1].length)))+"."+vs(dp(e,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return es(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Xo(es(t,r.replace(/[\\-]/g,""),e)),l=0,Xo(Xo(r.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<s.length?s.charAt(l++):k==="0"?"0":""}));if(r.match(rv))return s=es(t,"##########",e),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=id(f,Math.pow(10,l)-1,!1),s=""+m,p=ua("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+o[2]+"/"+o[3],p=sd(u[2],l),p.length<o[4].length&&(p=pn(o[4].substr(o[4].length-p.length))+p),s+=p,s;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=id(f,Math.pow(10,l)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?dh(u[1],l)+o[2]+"/"+o[3]+sd(u[2],l):or(" ",2*l+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return s=Wo(e,0),r.length<=s.length?s:pn(r.substr(0,r.length-s.length))+s;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){s=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var v=r.indexOf(".")-l,y=r.length-s.length-v;return pn(r.substr(0,v)+s+r.substr(r.length-y))}if(o=r.match(/^00,000\.([#0]*0)$/))return l=dp(e,o[1].length),e<0?"-"+es(t,r,-e):Ya(kS(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?vs(0,3-k.length):"")+k})+"."+vs(l,o[1].length);switch(r){case"###,##0.00":return es(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var S=Ya(Wo(f,0));return S!=="0"?m+S:"";case"###,###.00":return es(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return es(t,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function TS(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ua(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function NS(t,r,e){var n=r.replace(Yx,""),s=r.length-n.length;return ua(t,n,e*Math.pow(10,2*s))+or("%",s)}function nv(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+nv(t,-r);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%s;if(o<0&&(o+=s),e=(r/Math.pow(10,o)).toPrecision(n+1+(s+o)%s),!e.match(/[Ee]/)){var l=Math.floor(Math.log(r)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(l-e.length+o):e+="E+"+(l-o),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,m,p){return f+m+p.substr(0,(s+o)%s)+"."+p.substr(o)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function js(t,r,e){if(t.charCodeAt(0)===40&&!r.match(tv)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?js("n",n,e):"("+js("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return TS(t,r,e);if(r.indexOf("%")!==-1)return NS(t,r,e);if(r.indexOf("E")!==-1)return nv(r,e);if(r.charCodeAt(0)===36)return"$"+js(t,r.substr(r.charAt(1)==" "?2:1),e);var s,o,l,u,f=Math.abs(e),m=e<0?"-":"";if(r.match(/^00+$/))return m+vs(f,r.length);if(r.match(/^[#?]+$/))return s=""+e,e===0&&(s=""),s.length>r.length?s:pn(r.substr(0,r.length-s.length))+s;if(o=r.match(Zx))return SS(o,f,m);if(r.match(/^#+0+$/))return m+vs(f,r.length-r.indexOf("0"));if(o=r.match(ev))return s=(""+e).replace(/^([^\.]+)$/,"$1."+pn(o[1])).replace(/\.$/,"."+pn(o[1])),s=s.replace(/\.(\d*)$/,function(k,w){return"."+w+or("0",pn(o[1]).length-w.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return m+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return m+Ya(""+f);if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+js(t,r,-e):Ya(""+e)+"."+or("0",o[1].length);if(o=r.match(/^#,#*,#0/))return js(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Xo(js(t,r.replace(/[\\-]/g,""),e)),l=0,Xo(Xo(r.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<s.length?s.charAt(l++):k==="0"?"0":""}));if(r.match(rv))return s=js(t,"##########",e),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=id(f,Math.pow(10,l)-1,!1),s=""+m,p=ua("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+o[2]+"/"+o[3],p=sd(u[2],l),p.length<o[4].length&&(p=pn(o[4].substr(o[4].length-p.length))+p),s+=p,s;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=id(f,Math.pow(10,l)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?dh(u[1],l)+o[2]+"/"+o[3]+sd(u[2],l):or(" ",2*l+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return s=""+e,r.length<=s.length?s:pn(r.substr(0,r.length-s.length))+s;if(o=r.match(/^([#0]+)\.([#0]+)$/)){s=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var v=r.indexOf(".")-l,y=r.length-s.length-v;return pn(r.substr(0,v)+s+r.substr(r.length-y))}if(o=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+js(t,r,-e):Ya(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?vs(0,3-k.length):"")+k})+"."+vs(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var S=Ya(""+f);return S!=="0"?m+S:"";default:if(r.match(/\.[0#?]*$/))return js(t,r.slice(0,r.lastIndexOf(".")),e)+pn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function ua(t,r,e){return(e|0)===e?js(t,r,e):es(t,r,e)}function CS(t){for(var r=[],e=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:e=!e;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=t.substr(s,n-s),s=n+1}if(r[r.length]=t.substr(s),e===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var sv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function al(t){for(var r=0,e="",n="";r<t.length;)switch(e=t.charAt(r)){case"G":ad(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(n=e;t.charAt(r++)!=="]"&&r<t.length;)n+=t.charAt(r);if(n.match(sv))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||e=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function AS(t,r,e,n){for(var s=[],o="",l=0,u="",f="t",m,p,v,y="H";l<t.length;)switch(u=t.charAt(l)){case"G":if(!ad(t,l))throw new Error("unrecognized character "+u+" in "+t);s[s.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(v=t.charCodeAt(++l))!==34&&l<t.length;)o+=String.fromCharCode(v);s[s.length]={t:"t",v:o},++l;break;case"\\":var S=t.charAt(++l),k=S==="("||S===")"?S:"t";s[s.length]={t:k,v:S},++l;break;case"_":s[s.length]={t:"t",v:" "},l+=2;break;case"@":s[s.length]={t:"T",v:r},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(m==null&&(m=Bi(r,e,t.charAt(l+1)==="2"),m==null))return"";s[s.length]={t:"X",v:t.substr(l,2)},f=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||m==null&&(m=Bi(r,e),m==null))return"";for(o=u;++l<t.length&&t.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),s[s.length]={t:u,v:o},f=u;break;case"A":case"a":case"上":var w={t:u,v:u};if(m==null&&(m=Bi(r,e)),t.substr(l,3).toUpperCase()==="A/P"?(m!=null&&(w.v=m.H>=12?"P":"A"),w.t="T",y="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(m!=null&&(w.v=m.H>=12?"PM":"AM"),w.t="T",l+=5,y="h"):t.substr(l,5).toUpperCase()==="上午/下午"?(m!=null&&(w.v=m.H>=12?"下午":"上午"),w.t="T",l+=5,y="h"):(w.t="t",++l),m==null&&w.t==="T")return"";s[s.length]=w,f=u;break;case"[":for(o=u;t.charAt(l++)!=="]"&&l<t.length;)o+=t.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(sv)){if(m==null&&(m=Bi(r,e),m==null))return"";s[s.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",al(t)||(s[s.length]={t:"t",v:o}));break;case".":if(m!=null){for(o=u;++l<t.length&&(u=t.charAt(l))==="0";)o+=u;s[s.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(l))>-1;)o+=u;s[s.length]={t:"n",v:o};break;case"?":for(o=u;t.charAt(++l)===u;)o+=u;s[s.length]={t:u,v:o},f=u;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":s[s.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)o+=t.charAt(l);s[s.length]={t:"D",v:o};break;case" ":s[s.length]={t:u,v:u},++l;break;case"$":s[s.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);s[s.length]={t:"t",v:u},++l;break}var E=0,F=0,B;for(l=s.length-1,f="t";l>=0;--l)switch(s[l].t){case"h":case"H":s[l].t=y,f="h",E<1&&(E=1);break;case"s":(B=s[l].v.match(/\.0+$/))&&(F=Math.max(F,B[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":f=s[l].t;break;case"m":f==="s"&&(s[l].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&s[l].v.match(/[Hh]/)&&(E=1),E<2&&s[l].v.match(/[Mm]/)&&(E=2),E<3&&s[l].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var C="",M;for(l=0;l<s.length;++l)switch(s[l].t){case"t":case"T":case" ":case"D":break;case"X":s[l].v="",s[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[l].v=yS(s[l].t.charCodeAt(0),s[l].v,m,F),s[l].t="t";break;case"n":case"?":for(M=l+1;s[M]!=null&&((u=s[M].t)==="?"||u==="D"||(u===" "||u==="t")&&s[M+1]!=null&&(s[M+1].t==="?"||s[M+1].t==="t"&&s[M+1].v==="/")||s[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[M].v==="/"||s[M].v===" "&&s[M+1]!=null&&s[M+1].t=="?"));)s[l].v+=s[M].v,s[M]={v:"",t:";"},++M;C+=s[l].v,l=M-1;break;case"G":s[l].t="t",s[l].v=Hi(r,e);break}var re="",O,U;if(C.length>0){C.charCodeAt(0)==40?(O=r<0&&C.charCodeAt(0)===45?-r:r,U=ua("n",C,O)):(O=r<0&&n>1?-r:r,U=ua("n",C,O),O<0&&s[0]&&s[0].t=="t"&&(U=U.substr(1),s[0].v="-"+s[0].v)),M=U.length-1;var ee=s.length;for(l=0;l<s.length;++l)if(s[l]!=null&&s[l].t!="t"&&s[l].v.indexOf(".")>-1){ee=l;break}var I=s.length;if(ee===s.length&&U.indexOf("E")===-1){for(l=s.length-1;l>=0;--l)s[l]==null||"n?".indexOf(s[l].t)===-1||(M>=s[l].v.length-1?(M-=s[l].v.length,s[l].v=U.substr(M+1,s[l].v.length)):M<0?s[l].v="":(s[l].v=U.substr(0,M+1),M=-1),s[l].t="t",I=l);M>=0&&I<s.length&&(s[I].v=U.substr(0,M+1)+s[I].v)}else if(ee!==s.length&&U.indexOf("E")===-1){for(M=U.indexOf(".")-1,l=ee;l>=0;--l)if(!(s[l]==null||"n?".indexOf(s[l].t)===-1)){for(p=s[l].v.indexOf(".")>-1&&l===ee?s[l].v.indexOf(".")-1:s[l].v.length-1,re=s[l].v.substr(p+1);p>=0;--p)M>=0&&(s[l].v.charAt(p)==="0"||s[l].v.charAt(p)==="#")&&(re=U.charAt(M--)+re);s[l].v=re,s[l].t="t",I=l}for(M>=0&&I<s.length&&(s[I].v=U.substr(0,M+1)+s[I].v),M=U.indexOf(".")+1,l=ee;l<s.length;++l)if(!(s[l]==null||"n?(".indexOf(s[l].t)===-1&&l!==ee)){for(p=s[l].v.indexOf(".")>-1&&l===ee?s[l].v.indexOf(".")+1:0,re=s[l].v.substr(0,p);p<s[l].v.length;++p)M<U.length&&(re+=U.charAt(M++));s[l].v=re,s[l].t="t",I=l}}}for(l=0;l<s.length;++l)s[l]!=null&&"n?".indexOf(s[l].t)>-1&&(O=n>1&&r<0&&l>0&&s[l-1].v==="-"?-r:r,s[l].v=ua(s[l].t,s[l].v,O),s[l].t="t");var ie="";for(l=0;l!==s.length;++l)s[l]!=null&&(ie+=s[l].v);return ie}var fp=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function hp(t,r){if(r==null)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function RS(t,r){var e=CS(t),n=e.length,s=e[n-1].indexOf("@");if(n<4&&s>-1&&--n,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof r!="number")return[4,e.length===4||s>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=s>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=s>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=s>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var o=r>0?e[0]:r<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[n,o];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var l=e[0].match(fp),u=e[1].match(fp);return hp(r,l)?[n,e[0]]:hp(r,u)?[n,e[1]]:[n,e[l!=null&&u!=null?2:1]]}return[n,o]}function rs(t,r,e){e==null&&(e={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?n=e.dateNF:n=t;break;case"number":t==14&&e.dateNF?n=e.dateNF:n=(e.table!=null?e.table:gt)[t],n==null&&(n=e.table&&e.table[cp[t]]||gt[cp[t]]),n==null&&(n=fS[t]||"General");break}if(ad(n,0))return Hi(r,e);r instanceof Date&&(r=Jx(r,e.date1904));var s=RS(n,r);if(ad(s[1]))return Hi(r,e);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return AS(s[1],r,e,s[0])}function Vi(t,r){if(typeof r!="number"){r=+r||-1;for(var e=0;e<392;++e){if(gt[e]==null){r<0&&(r=e);continue}if(gt[e]==t){r=e;break}}r<0&&(r=391)}return gt[r]=t,r}function av(){gt=dS()}var IS={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},iv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function OS(t){var r=typeof t=="number"?gt[t]:t;return r=r.replace(iv,"(\\d+)"),new RegExp("^"+r+"$")}function jS(t,r,e){var n=-1,s=-1,o=-1,l=-1,u=-1,f=-1;(r.match(iv)||[]).forEach(function(v,y){var S=parseInt(e[y+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=S;break;case"d":o=S;break;case"h":l=S;break;case"s":f=S;break;case"m":l>=0?u=S:s=S;break}}),f>=0&&u==-1&&s>=0&&(u=s,s=-1);var m=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&u==-1&&f==-1?m:n==-1&&s==-1&&o==-1?p:m+"T"+p}var FS=(function(){var t={};t.version="1.2.0";function r(){for(var U=0,ee=new Array(256),I=0;I!=256;++I)U=I,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,ee[I]=U;return typeof Int32Array<"u"?new Int32Array(ee):ee}var e=r();function n(U){var ee=0,I=0,ie=0,oe=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ie=0;ie!=256;++ie)oe[ie]=U[ie];for(ie=0;ie!=256;++ie)for(I=U[ie],ee=256+ie;ee<4096;ee+=256)I=oe[ee]=I>>>8^U[I&255];var X=[];for(ie=1;ie!=16;++ie)X[ie-1]=typeof Int32Array<"u"?oe.subarray(ie*256,ie*256+256):oe.slice(ie*256,ie*256+256);return X}var s=n(e),o=s[0],l=s[1],u=s[2],f=s[3],m=s[4],p=s[5],v=s[6],y=s[7],S=s[8],k=s[9],w=s[10],E=s[11],F=s[12],B=s[13],C=s[14];function M(U,ee){for(var I=ee^-1,ie=0,oe=U.length;ie<oe;)I=I>>>8^e[(I^U.charCodeAt(ie++))&255];return~I}function re(U,ee){for(var I=ee^-1,ie=U.length-15,oe=0;oe<ie;)I=C[U[oe++]^I&255]^B[U[oe++]^I>>8&255]^F[U[oe++]^I>>16&255]^E[U[oe++]^I>>>24]^w[U[oe++]]^k[U[oe++]]^S[U[oe++]]^y[U[oe++]]^v[U[oe++]]^p[U[oe++]]^m[U[oe++]]^f[U[oe++]]^u[U[oe++]]^l[U[oe++]]^o[U[oe++]]^e[U[oe++]];for(ie+=15;oe<ie;)I=I>>>8^e[(I^U[oe++])&255];return~I}function O(U,ee){for(var I=ee^-1,ie=0,oe=U.length,X=0,ae=0;ie<oe;)X=U.charCodeAt(ie++),X<128?I=I>>>8^e[(I^X)&255]:X<2048?(I=I>>>8^e[(I^(192|X>>6&31))&255],I=I>>>8^e[(I^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,ae=U.charCodeAt(ie++)&1023,I=I>>>8^e[(I^(240|X>>8&7))&255],I=I>>>8^e[(I^(128|X>>2&63))&255],I=I>>>8^e[(I^(128|ae>>6&15|(X&3)<<4))&255],I=I>>>8^e[(I^(128|ae&63))&255]):(I=I>>>8^e[(I^(224|X>>12&15))&255],I=I>>>8^e[(I^(128|X>>6&63))&255],I=I>>>8^e[(I^(128|X&63))&255]);return~I}return t.table=e,t.bstr=M,t.buf=re,t.str=O,t})(),Tt=(function(){var r={};r.version="1.2.1";function e(P,W){for(var z=P.split("/"),H=W.split("/"),Q=0,Z=0,ve=Math.min(z.length,H.length);Q<ve;++Q){if(Z=z[Q].length-H[Q].length)return Z;if(z[Q]!=H[Q])return z[Q]<H[Q]?-1:1}return z.length-H.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var W=P.lastIndexOf("/");return W===-1?P:P.slice(0,W+1)}function s(P){if(P.charAt(P.length-1)=="/")return s(P.slice(0,-1));var W=P.lastIndexOf("/");return W===-1?P:P.slice(W+1)}function o(P,W){typeof W=="string"&&(W=new Date(W));var z=W.getHours();z=z<<6|W.getMinutes(),z=z<<5|W.getSeconds()>>>1,P.write_shift(2,z);var H=W.getFullYear()-1980;H=H<<4|W.getMonth()+1,H=H<<5|W.getDate(),P.write_shift(2,H)}function l(P){var W=P.read_shift(2)&65535,z=P.read_shift(2)&65535,H=new Date,Q=z&31;z>>>=5;var Z=z&15;z>>>=4,H.setMilliseconds(0),H.setFullYear(z+1980),H.setMonth(Z-1),H.setDate(Q);var ve=W&31;W>>>=5;var Ie=W&63;return W>>>=6,H.setHours(W),H.setMinutes(Ie),H.setSeconds(ve<<1),H}function u(P){Wr(P,0);for(var W={},z=0;P.l<=P.length-4;){var H=P.read_shift(2),Q=P.read_shift(2),Z=P.l+Q,ve={};switch(H){case 21589:z=P.read_shift(1),z&1&&(ve.mtime=P.read_shift(4)),Q>5&&(z&2&&(ve.atime=P.read_shift(4)),z&4&&(ve.ctime=P.read_shift(4))),ve.mtime&&(ve.mt=new Date(ve.mtime*1e3));break}P.l=Z,W[H]=ve}return W}var f;function m(){return f||(f={})}function p(P,W){if(P[0]==80&&P[1]==75)return Gr(P,W);if((P[0]|32)==109&&(P[1]|32)==105)return $s(P,W);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var z=3,H=512,Q=0,Z=0,ve=0,Ie=0,_e=0,Ee=[],ke=P.slice(0,512);Wr(ke,0);var Be=v(ke);switch(z=Be[0],z){case 3:H=512;break;case 4:H=4096;break;case 0:if(Be[1]==0)return Gr(P,W);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}H!==512&&(ke=P.slice(0,H),Wr(ke,28));var He=P.slice(0,H);y(ke,z);var Je=ke.read_shift(4,"i");if(z===3&&Je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Je);ke.l+=4,ve=ke.read_shift(4,"i"),ke.l+=4,ke.chk("00100000","Mini Stream Cutoff Size: "),Ie=ke.read_shift(4,"i"),Q=ke.read_shift(4,"i"),_e=ke.read_shift(4,"i"),Z=ke.read_shift(4,"i");for(var Me=-1,De=0;De<109&&(Me=ke.read_shift(4,"i"),!(Me<0));++De)Ee[De]=Me;var ut=S(P,H);E(_e,Z,ut,H,Ee);var Mt=B(ut,ve,Ee,H);Mt[ve].name="!Directory",Q>0&&Ie!==ae&&(Mt[Ie].name="!MiniFAT"),Mt[Ee[0]].name="!FAT",Mt.fat_addrs=Ee,Mt.ssz=H;var Dt={},Ut=[],Gn=[],as=[];C(ve,Mt,ut,Ut,Q,Dt,Gn,Ie),k(Gn,as,Ut),Ut.shift();var Dn={FileIndex:Gn,FullPaths:as};return W&&W.raw&&(Dn.raw={header:He,sectors:ut}),Dn}function v(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(fe,"Header Signature: "),P.l+=16;var W=P.read_shift(2,"u");return[P.read_shift(2,"u"),W]}function y(P,W){var z=9;switch(P.l+=2,z=P.read_shift(2)){case 9:if(W!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(W!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function S(P,W){for(var z=Math.ceil(P.length/W)-1,H=[],Q=1;Q<z;++Q)H[Q-1]=P.slice(Q*W,(Q+1)*W);return H[z-1]=P.slice(z*W),H}function k(P,W,z){for(var H=0,Q=0,Z=0,ve=0,Ie=0,_e=z.length,Ee=[],ke=[];H<_e;++H)Ee[H]=ke[H]=H,W[H]=z[H];for(;Ie<ke.length;++Ie)H=ke[Ie],Q=P[H].L,Z=P[H].R,ve=P[H].C,Ee[H]===H&&(Q!==-1&&Ee[Q]!==Q&&(Ee[H]=Ee[Q]),Z!==-1&&Ee[Z]!==Z&&(Ee[H]=Ee[Z])),ve!==-1&&(Ee[ve]=H),Q!==-1&&H!=Ee[H]&&(Ee[Q]=Ee[H],ke.lastIndexOf(Q)<Ie&&ke.push(Q)),Z!==-1&&H!=Ee[H]&&(Ee[Z]=Ee[H],ke.lastIndexOf(Z)<Ie&&ke.push(Z));for(H=1;H<_e;++H)Ee[H]===H&&(Z!==-1&&Ee[Z]!==Z?Ee[H]=Ee[Z]:Q!==-1&&Ee[Q]!==Q&&(Ee[H]=Ee[Q]));for(H=1;H<_e;++H)if(P[H].type!==0){if(Ie=H,Ie!=Ee[Ie])do Ie=Ee[Ie],W[H]=W[Ie]+"/"+W[H];while(Ie!==0&&Ee[Ie]!==-1&&Ie!=Ee[Ie]);Ee[H]=-1}for(W[0]+="/",H=1;H<_e;++H)P[H].type!==2&&(W[H]+="/")}function w(P,W,z){for(var H=P.start,Q=P.size,Z=[],ve=H;z&&Q>0&&ve>=0;)Z.push(W.slice(ve*X,ve*X+X)),Q-=X,ve=$i(z,ve*4);return Z.length===0?Tr(0):qa(Z).slice(0,P.size)}function E(P,W,z,H,Q){var Z=ae;if(P===ae){if(W!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var ve=z[P],Ie=(H>>>2)-1;if(!ve)return;for(var _e=0;_e<Ie&&(Z=$i(ve,_e*4))!==ae;++_e)Q.push(Z);E($i(ve,H-4),W-1,z,H,Q)}}function F(P,W,z,H,Q){var Z=[],ve=[];Q||(Q=[]);var Ie=H-1,_e=0,Ee=0;for(_e=W;_e>=0;){Q[_e]=!0,Z[Z.length]=_e,ve.push(P[_e]);var ke=z[Math.floor(_e*4/H)];if(Ee=_e*4&Ie,H<4+Ee)throw new Error("FAT boundary crossed: "+_e+" 4 "+H);if(!P[ke])break;_e=$i(P[ke],Ee)}return{nodes:Z,data:Sp([ve])}}function B(P,W,z,H){var Q=P.length,Z=[],ve=[],Ie=[],_e=[],Ee=H-1,ke=0,Be=0,He=0,Je=0;for(ke=0;ke<Q;++ke)if(Ie=[],He=ke+W,He>=Q&&(He-=Q),!ve[He]){_e=[];var Me=[];for(Be=He;Be>=0;){Me[Be]=!0,ve[Be]=!0,Ie[Ie.length]=Be,_e.push(P[Be]);var De=z[Math.floor(Be*4/H)];if(Je=Be*4&Ee,H<4+Je)throw new Error("FAT boundary crossed: "+Be+" 4 "+H);if(!P[De]||(Be=$i(P[De],Je),Me[Be]))break}Z[He]={nodes:Ie,data:Sp([_e])}}return Z}function C(P,W,z,H,Q,Z,ve,Ie){for(var _e=0,Ee=H.length?2:0,ke=W[P].data,Be=0,He=0,Je;Be<ke.length;Be+=128){var Me=ke.slice(Be,Be+128);Wr(Me,64),He=Me.read_shift(2),Je=xh(Me,0,He-Ee),H.push(Je);var De={name:Je,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},ut=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);ut!==0&&(De.ct=M(Me,Me.l-8));var Mt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Mt!==0&&(De.mt=M(Me,Me.l-8)),De.start=Me.read_shift(4,"i"),De.size=Me.read_shift(4,"i"),De.size<0&&De.start<0&&(De.size=De.type=0,De.start=ae,De.name=""),De.type===5?(_e=De.start,Q>0&&_e!==ae&&(W[_e].name="!StreamData")):De.size>=4096?(De.storage="fat",W[De.start]===void 0&&(W[De.start]=F(z,De.start,W.fat_addrs,W.ssz)),W[De.start].name=De.name,De.content=W[De.start].data.slice(0,De.size)):(De.storage="minifat",De.size<0?De.size=0:_e!==ae&&De.start!==ae&&W[_e]&&(De.content=w(De,W[_e].data,(W[Ie]||{}).data))),De.content&&Wr(De.content,0),Z[Je]=De,ve.push(De)}}function M(P,W){return new Date((Vn(P,W+4)/1e7*Math.pow(2,32)+Vn(P,W)/1e7-11644473600)*1e3)}function re(P,W){return m(),p(f.readFileSync(P),W)}function O(P,W){var z=W&&W.type;switch(z||_t&&Buffer.isBuffer(P)&&(z="buffer"),z||"base64"){case"file":return re(P,W);case"base64":return p(ps(Hn(P)),W);case"binary":return p(ps(P),W)}return p(P,W)}function U(P,W){var z=W||{},H=z.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=H+"/",P.FileIndex[0]={name:H,type:5}),z.CLSID&&(P.FileIndex[0].clsid=z.CLSID),ee(P)}function ee(P){var W="Sh33tJ5";if(!Tt.find(P,"/"+W)){var z=Tr(4);z[0]=55,z[1]=z[3]=50,z[2]=54,P.FileIndex.push({name:W,type:2,content:z,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+W),I(P)}}function I(P,W){U(P);for(var z=!1,H=!1,Q=P.FullPaths.length-1;Q>=0;--Q){var Z=P.FileIndex[Q];switch(Z.type){case 0:H?z=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(Z.R*Z.L*Z.C)&&(z=!0),Z.R>-1&&Z.L>-1&&Z.R==Z.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!W)){var ve=new Date(1987,1,19),Ie=0,_e=Object.create?Object.create(null):{},Ee=[];for(Q=0;Q<P.FullPaths.length;++Q)_e[P.FullPaths[Q]]=!0,P.FileIndex[Q].type!==0&&Ee.push([P.FullPaths[Q],P.FileIndex[Q]]);for(Q=0;Q<Ee.length;++Q){var ke=n(Ee[Q][0]);H=_e[ke],H||(Ee.push([ke,{name:s(ke).replace("/",""),type:1,clsid:Te,ct:ve,mt:ve,content:null}]),_e[ke]=!0)}for(Ee.sort(function(Je,Me){return e(Je[0],Me[0])}),P.FullPaths=[],P.FileIndex=[],Q=0;Q<Ee.length;++Q)P.FullPaths[Q]=Ee[Q][0],P.FileIndex[Q]=Ee[Q][1];for(Q=0;Q<Ee.length;++Q){var Be=P.FileIndex[Q],He=P.FullPaths[Q];if(Be.name=s(He).replace("/",""),Be.L=Be.R=Be.C=-(Be.color=1),Be.size=Be.content?Be.content.length:0,Be.start=0,Be.clsid=Be.clsid||Te,Q===0)Be.C=Ee.length>1?1:-1,Be.size=0,Be.type=5;else if(He.slice(-1)=="/"){for(Ie=Q+1;Ie<Ee.length&&n(P.FullPaths[Ie])!=He;++Ie);for(Be.C=Ie>=Ee.length?-1:Ie,Ie=Q+1;Ie<Ee.length&&n(P.FullPaths[Ie])!=n(He);++Ie);Be.R=Ie>=Ee.length?-1:Ie,Be.type=1}else n(P.FullPaths[Q+1]||"")==n(He)&&(Be.R=Q+1),Be.type=2}}}function ie(P,W){var z=W||{};if(z.fileType=="mad")return bs(P,z);switch(I(P),z.fileType){case"zip":return bn(P,z)}var H=(function(Je){for(var Me=0,De=0,ut=0;ut<Je.FileIndex.length;++ut){var Mt=Je.FileIndex[ut];if(Mt.content){var Dt=Mt.content.length;Dt>0&&(Dt<4096?Me+=Dt+63>>6:De+=Dt+511>>9)}}for(var Ut=Je.FullPaths.length+3>>2,Gn=Me+7>>3,as=Me+127>>7,Dn=Gn+De+Ut+as,dr=Dn+127>>7,Bs=dr<=109?0:Math.ceil((dr-109)/127);Dn+dr+Bs+127>>7>dr;)Bs=++dr<=109?0:Math.ceil((dr-109)/127);var rr=[1,Bs,dr,as,Ut,De,Me,0];return Je.FileIndex[0].size=Me<<6,rr[7]=(Je.FileIndex[0].start=rr[0]+rr[1]+rr[2]+rr[3]+rr[4]+rr[5])+(rr[6]+7>>3),rr})(P),Q=Tr(H[7]<<9),Z=0,ve=0;{for(Z=0;Z<8;++Z)Q.write_shift(1,me[Z]);for(Z=0;Z<8;++Z)Q.write_shift(2,0);for(Q.write_shift(2,62),Q.write_shift(2,3),Q.write_shift(2,65534),Q.write_shift(2,9),Q.write_shift(2,6),Z=0;Z<3;++Z)Q.write_shift(2,0);for(Q.write_shift(4,0),Q.write_shift(4,H[2]),Q.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),Q.write_shift(4,0),Q.write_shift(4,4096),Q.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:ae),Q.write_shift(4,H[3]),Q.write_shift(-4,H[1]?H[0]-1:ae),Q.write_shift(4,H[1]),Z=0;Z<109;++Z)Q.write_shift(-4,Z<H[2]?H[1]+Z:-1)}if(H[1])for(ve=0;ve<H[1];++ve){for(;Z<236+ve*127;++Z)Q.write_shift(-4,Z<H[2]?H[1]+Z:-1);Q.write_shift(-4,ve===H[1]-1?ae:ve+1)}var Ie=function(Je){for(ve+=Je;Z<ve-1;++Z)Q.write_shift(-4,Z+1);Je&&(++Z,Q.write_shift(-4,ae))};for(ve=Z=0,ve+=H[1];Z<ve;++Z)Q.write_shift(-4,be.DIFSECT);for(ve+=H[2];Z<ve;++Z)Q.write_shift(-4,be.FATSECT);Ie(H[3]),Ie(H[4]);for(var _e=0,Ee=0,ke=P.FileIndex[0];_e<P.FileIndex.length;++_e)ke=P.FileIndex[_e],ke.content&&(Ee=ke.content.length,!(Ee<4096)&&(ke.start=ve,Ie(Ee+511>>9)));for(Ie(H[6]+7>>3);Q.l&511;)Q.write_shift(-4,be.ENDOFCHAIN);for(ve=Z=0,_e=0;_e<P.FileIndex.length;++_e)ke=P.FileIndex[_e],ke.content&&(Ee=ke.content.length,!(!Ee||Ee>=4096)&&(ke.start=ve,Ie(Ee+63>>6)));for(;Q.l&511;)Q.write_shift(-4,be.ENDOFCHAIN);for(Z=0;Z<H[4]<<2;++Z){var Be=P.FullPaths[Z];if(!Be||Be.length===0){for(_e=0;_e<17;++_e)Q.write_shift(4,0);for(_e=0;_e<3;++_e)Q.write_shift(4,-1);for(_e=0;_e<12;++_e)Q.write_shift(4,0);continue}ke=P.FileIndex[Z],Z===0&&(ke.start=ke.size?ke.start-1:ae);var He=Z===0&&z.root||ke.name;if(Ee=2*(He.length+1),Q.write_shift(64,He,"utf16le"),Q.write_shift(2,Ee),Q.write_shift(1,ke.type),Q.write_shift(1,ke.color),Q.write_shift(-4,ke.L),Q.write_shift(-4,ke.R),Q.write_shift(-4,ke.C),ke.clsid)Q.write_shift(16,ke.clsid,"hex");else for(_e=0;_e<4;++_e)Q.write_shift(4,0);Q.write_shift(4,ke.state||0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,ke.start),Q.write_shift(4,ke.size),Q.write_shift(4,0)}for(Z=1;Z<P.FileIndex.length;++Z)if(ke=P.FileIndex[Z],ke.size>=4096)if(Q.l=ke.start+1<<9,_t&&Buffer.isBuffer(ke.content))ke.content.copy(Q,Q.l,0,ke.size),Q.l+=ke.size+511&-512;else{for(_e=0;_e<ke.size;++_e)Q.write_shift(1,ke.content[_e]);for(;_e&511;++_e)Q.write_shift(1,0)}for(Z=1;Z<P.FileIndex.length;++Z)if(ke=P.FileIndex[Z],ke.size>0&&ke.size<4096)if(_t&&Buffer.isBuffer(ke.content))ke.content.copy(Q,Q.l,0,ke.size),Q.l+=ke.size+63&-64;else{for(_e=0;_e<ke.size;++_e)Q.write_shift(1,ke.content[_e]);for(;_e&63;++_e)Q.write_shift(1,0)}if(_t)Q.l=Q.length;else for(;Q.l<Q.length;)Q.write_shift(1,0);return Q}function oe(P,W){var z=P.FullPaths.map(function(_e){return _e.toUpperCase()}),H=z.map(function(_e){var Ee=_e.split("/");return Ee[Ee.length-(_e.slice(-1)=="/"?2:1)]}),Q=!1;W.charCodeAt(0)===47?(Q=!0,W=z[0].slice(0,-1)+W):Q=W.indexOf("/")!==-1;var Z=W.toUpperCase(),ve=Q===!0?z.indexOf(Z):H.indexOf(Z);if(ve!==-1)return P.FileIndex[ve];var Ie=!Z.match(Kl);for(Z=Z.replace(yn,""),Ie&&(Z=Z.replace(Kl,"!")),ve=0;ve<z.length;++ve)if((Ie?z[ve].replace(Kl,"!"):z[ve]).replace(yn,"")==Z||(Ie?H[ve].replace(Kl,"!"):H[ve]).replace(yn,"")==Z)return P.FileIndex[ve];return null}var X=64,ae=-2,fe="d0cf11e0a1b11ae1",me=[208,207,17,224,161,177,26,225],Te="00000000000000000000000000000000",be={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ae,FREESECT:-1,HEADER_SIGNATURE:fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function le(P,W,z){m();var H=ie(P,z);f.writeFileSync(W,H)}function te(P){for(var W=new Array(P.length),z=0;z<P.length;++z)W[z]=String.fromCharCode(P[z]);return W.join("")}function pe(P,W){var z=ie(P,W);switch(W&&W.type||"buffer"){case"file":return m(),f.writeFileSync(W.filename,z),z;case"binary":return typeof z=="string"?z:te(z);case"base64":return ap(typeof z=="string"?z:te(z));case"buffer":if(_t)return Buffer.isBuffer(z)?z:qi(z);case"array":return typeof z=="string"?ps(z):z}return z}var A;function N(P){try{var W=P.InflateRaw,z=new W;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)A=P;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function L(P,W){if(!A)return Pr(P,W);var z=A.InflateRaw,H=new z,Q=H._processChunk(P.slice(P.l),H._finishFlushFlag);return P.l+=H.bytesRead,Q}function V(P){return A?A.deflateRawSync(P):ct(P)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function he(P){var W=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(W>>16|W>>8|W)&255}for(var Y=typeof Uint8Array<"u",xe=Y?new Uint8Array(256):[],Pe=0;Pe<256;++Pe)xe[Pe]=he(Pe);function K(P,W){var z=xe[P&255];return W<=8?z>>>8-W:(z=z<<8|xe[P>>8&255],W<=16?z>>>16-W:(z=z<<8|xe[P>>16&255],z>>>24-W))}function Xe(P,W){var z=W&7,H=W>>>3;return(P[H]|(z<=6?0:P[H+1]<<8))>>>z&3}function we(P,W){var z=W&7,H=W>>>3;return(P[H]|(z<=5?0:P[H+1]<<8))>>>z&7}function Fe(P,W){var z=W&7,H=W>>>3;return(P[H]|(z<=4?0:P[H+1]<<8))>>>z&15}function Oe(P,W){var z=W&7,H=W>>>3;return(P[H]|(z<=3?0:P[H+1]<<8))>>>z&31}function Ae(P,W){var z=W&7,H=W>>>3;return(P[H]|(z<=1?0:P[H+1]<<8))>>>z&127}function at(P,W,z){var H=W&7,Q=W>>>3,Z=(1<<z)-1,ve=P[Q]>>>H;return z<8-H||(ve|=P[Q+1]<<8-H,z<16-H)||(ve|=P[Q+2]<<16-H,z<24-H)||(ve|=P[Q+3]<<24-H),ve&Z}function St(P,W,z){var H=W&7,Q=W>>>3;return H<=5?P[Q]|=(z&7)<<H:(P[Q]|=z<<H&255,P[Q+1]=(z&7)>>8-H),W+3}function wt(P,W,z){var H=W&7,Q=W>>>3;return z=(z&1)<<H,P[Q]|=z,W+1}function Et(P,W,z){var H=W&7,Q=W>>>3;return z<<=H,P[Q]|=z&255,z>>>=8,P[Q+1]=z,W+8}function Vt(P,W,z){var H=W&7,Q=W>>>3;return z<<=H,P[Q]|=z&255,z>>>=8,P[Q+1]=z&255,P[Q+2]=z>>>8,W+16}function kt(P,W){var z=P.length,H=2*z>W?2*z:W+5,Q=0;if(z>=W)return P;if(_t){var Z=ip(H);if(P.copy)P.copy(Z);else for(;Q<P.length;++Q)Z[Q]=P[Q];return Z}else if(Y){var ve=new Uint8Array(H);if(ve.set)ve.set(P);else for(;Q<z;++Q)ve[Q]=P[Q];return ve}return P.length=H,P}function Ct(P){for(var W=new Array(P),z=0;z<P;++z)W[z]=0;return W}function At(P,W,z){var H=1,Q=0,Z=0,ve=0,Ie=0,_e=P.length,Ee=Y?new Uint16Array(32):Ct(32);for(Z=0;Z<32;++Z)Ee[Z]=0;for(Z=_e;Z<z;++Z)P[Z]=0;_e=P.length;var ke=Y?new Uint16Array(_e):Ct(_e);for(Z=0;Z<_e;++Z)Ee[Q=P[Z]]++,H<Q&&(H=Q),ke[Z]=0;for(Ee[0]=0,Z=1;Z<=H;++Z)Ee[Z+16]=Ie=Ie+Ee[Z-1]<<1;for(Z=0;Z<_e;++Z)Ie=P[Z],Ie!=0&&(ke[Z]=Ee[Ie+16]++);var Be=0;for(Z=0;Z<_e;++Z)if(Be=P[Z],Be!=0)for(Ie=K(ke[Z],H)>>H-Be,ve=(1<<H+4-Be)-1;ve>=0;--ve)W[Ie|ve<<Be]=Be&15|Z<<4;return H}var Ht=Y?new Uint16Array(512):Ct(512),Zt=Y?new Uint16Array(32):Ct(32);if(!Y){for(var qt=0;qt<512;++qt)Ht[qt]=0;for(qt=0;qt<32;++qt)Zt[qt]=0}(function(){for(var P=[],W=0;W<32;W++)P.push(5);At(P,Zt,32);var z=[];for(W=0;W<=143;W++)z.push(8);for(;W<=255;W++)z.push(9);for(;W<=279;W++)z.push(7);for(;W<=287;W++)z.push(8);At(z,Ht,288)})();var an=(function(){for(var W=Y?new Uint8Array(32768):[],z=0,H=0;z<J.length-1;++z)for(;H<J[z+1];++H)W[H]=z;for(;H<32768;++H)W[H]=29;var Q=Y?new Uint8Array(259):[];for(z=0,H=0;z<ce.length-1;++z)for(;H<ce[z+1];++H)Q[H]=z;function Z(Ie,_e){for(var Ee=0;Ee<Ie.length;){var ke=Math.min(65535,Ie.length-Ee),Be=Ee+ke==Ie.length;for(_e.write_shift(1,+Be),_e.write_shift(2,ke),_e.write_shift(2,~ke&65535);ke-- >0;)_e[_e.l++]=Ie[Ee++]}return _e.l}function ve(Ie,_e){for(var Ee=0,ke=0,Be=Y?new Uint16Array(32768):[];ke<Ie.length;){var He=Math.min(65535,Ie.length-ke);if(He<10){for(Ee=St(_e,Ee,+(ke+He==Ie.length)),Ee&7&&(Ee+=8-(Ee&7)),_e.l=Ee/8|0,_e.write_shift(2,He),_e.write_shift(2,~He&65535);He-- >0;)_e[_e.l++]=Ie[ke++];Ee=_e.l*8;continue}Ee=St(_e,Ee,+(ke+He==Ie.length)+2);for(var Je=0;He-- >0;){var Me=Ie[ke];Je=(Je<<5^Me)&32767;var De=-1,ut=0;if((De=Be[Je])&&(De|=ke&-32768,De>ke&&(De-=32768),De<ke))for(;Ie[De+ut]==Ie[ke+ut]&&ut<250;)++ut;if(ut>2){Me=Q[ut],Me<=22?Ee=Et(_e,Ee,xe[Me+1]>>1)-1:(Et(_e,Ee,3),Ee+=5,Et(_e,Ee,xe[Me-23]>>5),Ee+=3);var Mt=Me<8?0:Me-4>>2;Mt>0&&(Vt(_e,Ee,ut-ce[Me]),Ee+=Mt),Me=W[ke-De],Ee=Et(_e,Ee,xe[Me]>>3),Ee-=3;var Dt=Me<4?0:Me-2>>1;Dt>0&&(Vt(_e,Ee,ke-De-J[Me]),Ee+=Dt);for(var Ut=0;Ut<ut;++Ut)Be[Je]=ke&32767,Je=(Je<<5^Ie[ke])&32767,++ke;He-=ut-1}else Me<=143?Me=Me+48:Ee=wt(_e,Ee,1),Ee=Et(_e,Ee,xe[Me]),Be[Je]=ke&32767,++ke}Ee=Et(_e,Ee,0)-1}return _e.l=(Ee+7)/8|0,_e.l}return function(_e,Ee){return _e.length<8?Z(_e,Ee):ve(_e,Ee)}})();function ct(P){var W=Tr(50+Math.floor(P.length*1.1)),z=an(P,W);return W.slice(0,z)}var Lt=Y?new Uint16Array(32768):Ct(32768),Dr=Y?new Uint16Array(32768):Ct(32768),Wt=Y?new Uint16Array(128):Ct(128),on=1,Fn=1;function ws(P,W){var z=Oe(P,W)+257;W+=5;var H=Oe(P,W)+1;W+=5;var Q=Fe(P,W)+4;W+=4;for(var Z=0,ve=Y?new Uint8Array(19):Ct(19),Ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_e=1,Ee=Y?new Uint8Array(8):Ct(8),ke=Y?new Uint8Array(8):Ct(8),Be=ve.length,He=0;He<Q;++He)ve[q[He]]=Z=we(P,W),_e<Z&&(_e=Z),Ee[Z]++,W+=3;var Je=0;for(Ee[0]=0,He=1;He<=_e;++He)ke[He]=Je=Je+Ee[He-1]<<1;for(He=0;He<Be;++He)(Je=ve[He])!=0&&(Ie[He]=ke[Je]++);var Me=0;for(He=0;He<Be;++He)if(Me=ve[He],Me!=0){Je=xe[Ie[He]]>>8-Me;for(var De=(1<<7-Me)-1;De>=0;--De)Wt[Je|De<<Me]=Me&7|He<<3}var ut=[];for(_e=1;ut.length<z+H;)switch(Je=Wt[Ae(P,W)],W+=Je&7,Je>>>=3){case 16:for(Z=3+Xe(P,W),W+=2,Je=ut[ut.length-1];Z-- >0;)ut.push(Je);break;case 17:for(Z=3+we(P,W),W+=3;Z-- >0;)ut.push(0);break;case 18:for(Z=11+Ae(P,W),W+=7;Z-- >0;)ut.push(0);break;default:ut.push(Je),_e<Je&&(_e=Je);break}var Mt=ut.slice(0,z),Dt=ut.slice(z);for(He=z;He<286;++He)Mt[He]=0;for(He=H;He<30;++He)Dt[He]=0;return on=At(Mt,Lt,286),Fn=At(Dt,Dr,30),W}function vr(P,W){if(P[0]==3&&!(P[1]&3))return[Za(W),2];for(var z=0,H=0,Q=ip(W||1<<18),Z=0,ve=Q.length>>>0,Ie=0,_e=0;(H&1)==0;){if(H=we(P,z),z+=3,H>>>1)H>>1==1?(Ie=9,_e=5):(z=ws(P,z),Ie=on,_e=Fn);else{z&7&&(z+=8-(z&7));var Ee=P[z>>>3]|P[(z>>>3)+1]<<8;if(z+=32,Ee>0)for(!W&&ve<Z+Ee&&(Q=kt(Q,Z+Ee),ve=Q.length);Ee-- >0;)Q[Z++]=P[z>>>3],z+=8;continue}for(;;){!W&&ve<Z+32767&&(Q=kt(Q,Z+32767),ve=Q.length);var ke=at(P,z,Ie),Be=H>>>1==1?Ht[ke]:Lt[ke];if(z+=Be&15,Be>>>=4,(Be>>>8&255)===0)Q[Z++]=Be;else{if(Be==256)break;Be-=257;var He=Be<8?0:Be-4>>2;He>5&&(He=0);var Je=Z+ce[Be];He>0&&(Je+=at(P,z,He),z+=He),ke=at(P,z,_e),Be=H>>>1==1?Zt[ke]:Dr[ke],z+=Be&15,Be>>>=4;var Me=Be<4?0:Be-2>>1,De=J[Be];for(Me>0&&(De+=at(P,z,Me),z+=Me),!W&&ve<Je&&(Q=kt(Q,Je+100),ve=Q.length);Z<Je;)Q[Z]=Q[Z-De],++Z}}}return W?[Q,z+7>>>3]:[Q.slice(0,Z),z+7>>>3]}function Pr(P,W){var z=P.slice(P.l||0),H=vr(z,W);return P.l+=H[1],H[0]}function it(P,W){if(P)typeof console<"u"&&console.error(W);else throw new Error(W)}function Gr(P,W){var z=P;Wr(z,0);var H=[],Q=[],Z={FileIndex:H,FullPaths:Q};U(Z,{root:W.root});for(var ve=z.length-4;(z[ve]!=80||z[ve+1]!=75||z[ve+2]!=5||z[ve+3]!=6)&&ve>=0;)--ve;z.l=ve+4,z.l+=4;var Ie=z.read_shift(2);z.l+=6;var _e=z.read_shift(4);for(z.l=_e,ve=0;ve<Ie;++ve){z.l+=20;var Ee=z.read_shift(4),ke=z.read_shift(4),Be=z.read_shift(2),He=z.read_shift(2),Je=z.read_shift(2);z.l+=8;var Me=z.read_shift(4),De=u(z.slice(z.l+Be,z.l+Be+He));z.l+=Be+He+Je;var ut=z.l;z.l=Me+4,Lr(z,Ee,ke,Z,De),z.l=ut}return Z}function Lr(P,W,z,H,Q){P.l+=2;var Z=P.read_shift(2),ve=P.read_shift(2),Ie=l(P);if(Z&8257)throw new Error("Unsupported ZIP encryption");for(var _e=P.read_shift(4),Ee=P.read_shift(4),ke=P.read_shift(4),Be=P.read_shift(2),He=P.read_shift(2),Je="",Me=0;Me<Be;++Me)Je+=String.fromCharCode(P[P.l++]);if(He){var De=u(P.slice(P.l,P.l+He));(De[21589]||{}).mt&&(Ie=De[21589].mt),((Q||{})[21589]||{}).mt&&(Ie=Q[21589].mt)}P.l+=He;var ut=P.slice(P.l,P.l+Ee);switch(ve){case 8:ut=L(P,ke);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ve)}var Mt=!1;Z&8&&(_e=P.read_shift(4),_e==134695760&&(_e=P.read_shift(4),Mt=!0),Ee=P.read_shift(4),ke=P.read_shift(4)),Ee!=W&&it(Mt,"Bad compressed size: "+W+" != "+Ee),ke!=z&&it(Mt,"Bad uncompressed size: "+z+" != "+ke),ss(H,Je,ut,{unsafe:!0,mt:Ie})}function bn(P,W){var z=W||{},H=[],Q=[],Z=Tr(1),ve=z.compression?8:0,Ie=0,_e=0,Ee=0,ke=0,Be=0,He=P.FullPaths[0],Je=He,Me=P.FileIndex[0],De=[],ut=0;for(_e=1;_e<P.FullPaths.length;++_e)if(Je=P.FullPaths[_e].slice(He.length),Me=P.FileIndex[_e],!(!Me.size||!Me.content||Je=="Sh33tJ5")){var Mt=ke,Dt=Tr(Je.length);for(Ee=0;Ee<Je.length;++Ee)Dt.write_shift(1,Je.charCodeAt(Ee)&127);Dt=Dt.slice(0,Dt.l),De[Be]=FS.buf(Me.content,0);var Ut=Me.content;ve==8&&(Ut=V(Ut)),Z=Tr(30),Z.write_shift(4,67324752),Z.write_shift(2,20),Z.write_shift(2,Ie),Z.write_shift(2,ve),Me.mt?o(Z,Me.mt):Z.write_shift(4,0),Z.write_shift(-4,De[Be]),Z.write_shift(4,Ut.length),Z.write_shift(4,Me.content.length),Z.write_shift(2,Dt.length),Z.write_shift(2,0),ke+=Z.length,H.push(Z),ke+=Dt.length,H.push(Dt),ke+=Ut.length,H.push(Ut),Z=Tr(46),Z.write_shift(4,33639248),Z.write_shift(2,0),Z.write_shift(2,20),Z.write_shift(2,Ie),Z.write_shift(2,ve),Z.write_shift(4,0),Z.write_shift(-4,De[Be]),Z.write_shift(4,Ut.length),Z.write_shift(4,Me.content.length),Z.write_shift(2,Dt.length),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(4,0),Z.write_shift(4,Mt),ut+=Z.l,Q.push(Z),ut+=Dt.length,Q.push(Dt),++Be}return Z=Tr(22),Z.write_shift(4,101010256),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,Be),Z.write_shift(2,Be),Z.write_shift(4,ut),Z.write_shift(4,ke),Z.write_shift(2,0),qa([qa(H),qa(Q),Z])}var bt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ln(P,W){if(P.ctype)return P.ctype;var z=P.name||"",H=z.match(/\.([^\.]+)$/);return H&&bt[H[1]]||W&&(H=(z=W).match(/[\.\\]([^\.\\])+$/),H&&bt[H[1]])?bt[H[1]]:"application/octet-stream"}function ni(P){for(var W=ap(P),z=[],H=0;H<W.length;H+=76)z.push(W.slice(H,H+76));return z.join(`\r
`)+`\r
`}function _n(P){var W=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ee){var ke=Ee.charCodeAt(0).toString(16).toUpperCase();return"="+(ke.length==1?"0"+ke:ke)});W=W.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),W.charAt(0)==`
`&&(W="=0D"+W.slice(1)),W=W.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],H=W.split(`\r
`),Q=0;Q<H.length;++Q){var Z=H[Q];if(Z.length==0){z.push("");continue}for(var ve=0;ve<Z.length;){var Ie=76,_e=Z.slice(ve,ve+Ie);_e.charAt(Ie-1)=="="?Ie--:_e.charAt(Ie-2)=="="?Ie-=2:_e.charAt(Ie-3)=="="&&(Ie-=3),_e=Z.slice(ve,ve+Ie),ve+=Ie,ve<Z.length&&(_e+="="),z.push(_e)}}return z.join(`\r
`)}function zt(P){for(var W=[],z=0;z<P.length;++z){for(var H=P[z];z<=P.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+P[++z];W.push(H)}for(var Q=0;Q<W.length;++Q)W[Q]=W[Q].replace(/[=][0-9A-Fa-f]{2}/g,function(Z){return String.fromCharCode(parseInt(Z.slice(1),16))});return ps(W.join(`\r
`))}function Sn(P,W,z){for(var H="",Q="",Z="",ve,Ie=0;Ie<10;++Ie){var _e=W[Ie];if(!_e||_e.match(/^\s*$/))break;var Ee=_e.match(/^(.*?):\s*([^\s].*)$/);if(Ee)switch(Ee[1].toLowerCase()){case"content-location":H=Ee[2].trim();break;case"content-type":Z=Ee[2].trim();break;case"content-transfer-encoding":Q=Ee[2].trim();break}}switch(++Ie,Q.toLowerCase()){case"base64":ve=ps(Hn(W.slice(Ie).join("")));break;case"quoted-printable":ve=zt(W.slice(Ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Q)}var ke=ss(P,H.slice(z.length),ve,{unsafe:!0});Z&&(ke.ctype=Z)}function $s(P,W){if(te(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=W&&W.root||"",H=(_t&&Buffer.isBuffer(P)?P.toString("binary"):te(P)).split(`\r
`),Q=0,Z="";for(Q=0;Q<H.length;++Q)if(Z=H[Q],!!/^Content-Location:/i.test(Z)&&(Z=Z.slice(Z.indexOf("file")),z||(z=Z.slice(0,Z.lastIndexOf("/")+1)),Z.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),Z.slice(0,z.length)!=z););var ve=(H[1]||"").match(/boundary="(.*?)"/);if(!ve)throw new Error("MAD cannot find boundary");var Ie="--"+(ve[1]||""),_e=[],Ee=[],ke={FileIndex:_e,FullPaths:Ee};U(ke);var Be,He=0;for(Q=0;Q<H.length;++Q){var Je=H[Q];Je!==Ie&&Je!==Ie+"--"||(He++&&Sn(ke,H.slice(Be,Q),z),Be=Q)}return ke}function bs(P,W){var z=W||{},H=z.boundary||"SheetJS";H="------="+H;for(var Q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],Z=P.FullPaths[0],ve=Z,Ie=P.FileIndex[0],_e=1;_e<P.FullPaths.length;++_e)if(ve=P.FullPaths[_e].slice(Z.length),Ie=P.FileIndex[_e],!(!Ie.size||!Ie.content||ve=="Sh33tJ5")){ve=ve.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ut){return"_x"+ut.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ut){return"_u"+ut.charCodeAt(0).toString(16)+"_"});for(var Ee=Ie.content,ke=_t&&Buffer.isBuffer(Ee)?Ee.toString("binary"):te(Ee),Be=0,He=Math.min(1024,ke.length),Je=0,Me=0;Me<=He;++Me)(Je=ke.charCodeAt(Me))>=32&&Je<128&&++Be;var De=Be>=He*4/5;Q.push(H),Q.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+ve),Q.push("Content-Transfer-Encoding: "+(De?"quoted-printable":"base64")),Q.push("Content-Type: "+ln(Ie,ve)),Q.push(""),Q.push(De?_n(ke):ni(ke))}return Q.push(H+`--\r
`),Q.join(`\r
`)}function pa(P){var W={};return U(W,P),W}function ss(P,W,z,H){var Q=H&&H.unsafe;Q||U(P);var Z=!Q&&Tt.find(P,W);if(!Z){var ve=P.FullPaths[0];W.slice(0,ve.length)==ve?ve=W:(ve.slice(-1)!="/"&&(ve+="/"),ve=(ve+W).replace("//","/")),Z={name:s(W),type:2},P.FileIndex.push(Z),P.FullPaths.push(ve),Q||Tt.utils.cfb_gc(P)}return Z.content=z,Z.size=z?z.length:0,H&&(H.CLSID&&(Z.clsid=H.CLSID),H.mt&&(Z.mt=H.mt),H.ct&&(Z.ct=H.ct)),Z}function Ac(P,W){U(P);var z=Tt.find(P,W);if(z){for(var H=0;H<P.FileIndex.length;++H)if(P.FileIndex[H]==z)return P.FileIndex.splice(H,1),P.FullPaths.splice(H,1),!0}return!1}function zn(P,W,z){U(P);var H=Tt.find(P,W);if(H){for(var Q=0;Q<P.FileIndex.length;++Q)if(P.FileIndex[Q]==H)return P.FileIndex[Q].name=s(z),P.FullPaths[Q]=z,!0}return!1}function si(P){I(P,!0)}return r.find=oe,r.read=O,r.parse=p,r.write=pe,r.writeFile=le,r.utils={cfb_new:pa,cfb_add:ss,cfb_del:Ac,cfb_mov:zn,cfb_gc:si,ReadShift:Zl,CheckField:Cv,prep_blob:Wr,bconcat:qa,use_zlib:N,_deflateRaw:ct,_inflateRaw:Pr,consts:be},r})();function DS(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(t);r.open("r"),r.encoding="binary";var e=r.read();return r.close(),e}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ps(t){for(var r=Object.keys(t),e=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(t,r[n])&&e.push(r[n]);return e}function hh(t){for(var r=[],e=Ps(t),n=0;n!==e.length;++n)r[t[e[n]]]=e[n];return r}var od=new Date(1899,11,30,0,0,0);function wn(t,r){var e=t.getTime(),n=od.getTime()+(t.getTimezoneOffset()-od.getTimezoneOffset())*6e4;return(e-n)/(1440*60*1e3)}var ov=new Date,PS=od.getTime()+(ov.getTimezoneOffset()-od.getTimezoneOffset())*6e4,mp=ov.getTimezoneOffset();function yd(t){var r=new Date;return r.setTime(t*24*60*60*1e3+PS),r.getTimezoneOffset()!==mp&&r.setTime(r.getTime()+(r.getTimezoneOffset()-mp)*6e4),r}function LS(t){var r=0,e=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=s.length;++o)if(s[o]){switch(e=1,o>3&&(n=!0),s[o].slice(s[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[o].slice(s[o].length-1));case"D":e*=24;case"H":e*=60;case"M":if(n)e*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=e*parseInt(s[o],10)}return r}var gp=new Date("2017-02-19T19:06:09.000Z"),lv=isNaN(gp.getFullYear())?new Date("2/19/17"):gp,MS=lv.getFullYear()==2017;function Fr(t,r){var e=new Date(t);if(MS)return r>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):r<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(lv.getFullYear()==1917&&!isNaN(e.getFullYear())){var n=e.getFullYear();return t.indexOf(""+n)>-1||e.setFullYear(e.getFullYear()+100),e}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function zi(t,r){if(_t&&Buffer.isBuffer(t)){if(r){if(t[0]==255&&t[1]==254)return ql(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ql(Xx(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(t[0]==255&&t[1]==254)return ql(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ql(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(o){return e[o]||o})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function Hr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=Hr(t[e]));return r}function or(t,r){for(var e="";e.length<r;)e+=t;return e}function ys(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,o){return e=-e,o}),!isNaN(r=Number(n)))?r/e:r}var US=["january","february","march","april","may","june","july","august","september","october","november","december"];function Qo(t){var r=new Date(t),e=new Date(NaN),n=r.getYear(),s=r.getMonth(),o=r.getDate();if(isNaN(o))return e;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&US.indexOf(l)==-1)return e}else if(l.match(/[a-z]/))return e;return n<0||n>8099?e:(s>0||o>1)&&n!=101?r:t.match(/[^-0-9:,\/\\]/)?e:r}var $S=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(e,n,s){if(t||typeof n=="string")return e.split(n);for(var o=e.split(n),l=[o[0]],u=1;u<o.length;++u)l.push(s),l.push(o[u]);return l}})();function cv(t){return t?t.content&&t.type?zi(t.content,!0):t.data?Gl(t.data):t.asNodeBuffer&&_t?Gl(t.asNodeBuffer().toString("binary")):t.asBinary?Gl(t.asBinary()):t._data&&t._data.getContent?Gl(zi(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function uv(t){if(!t)return null;if(t.data)return np(t.data);if(t.asNodeBuffer&&_t)return t.asNodeBuffer();if(t._data&&t._data.getContent){var r=t._data.getContent();return typeof r=="string"?np(r):Array.prototype.slice.call(r)}return t.content&&t.type?t.content:null}function BS(t){return t&&t.name.slice(-4)===".bin"?uv(t):cv(t)}function ts(t,r){for(var e=t.FullPaths||Ps(t.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),o=0;o<e.length;++o){var l=e[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||s==l)return t.files?t.files[e[o]]:t.FileIndex[o]}return null}function mh(t,r){var e=ts(t,r);if(e==null)throw new Error("Cannot find file "+r+" in zip");return e}function pr(t,r,e){if(!e)return BS(mh(t,r));if(!r)return null;try{return pr(t,r)}catch{return null}}function Wn(t,r,e){if(!e)return cv(mh(t,r));if(!r)return null;try{return Wn(t,r)}catch{return null}}function VS(t,r,e){return uv(mh(t,r))}function pp(t){for(var r=t.FullPaths||Ps(t.files),e=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&e.push(r[n].replace(/^Root Entry[\/]/,""));return e.sort()}function WS(t,r,e){if(t.FullPaths){if(typeof e=="string"){var n;return _t?n=qi(e):n=lS(e),Tt.utils.cfb_add(t,r,n)}Tt.utils.cfb_add(t,r,e)}else t.file(r,e)}function dv(t,r){switch(r.type){case"base64":return Tt.read(t,{type:"base64"});case"binary":return Tt.read(t,{type:"binary"});case"buffer":case"array":return Tt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Xl(t,r){if(t.charAt(0)=="/")return t.slice(1);var e=r.split("/");r.slice(-1)!="/"&&e.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?e.pop():s!=="."&&e.push(s)}return e.join("/")}var fv=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,HS=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,xp=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,zS=/<[^>]*>/g,sn=fv.match(xp)?xp:zS,GS=/<\w*:/,KS=/<(\/?)\w+:/;function lt(t,r,e){for(var n={},s=0,o=0;s!==t.length&&!((o=t.charCodeAt(s))===32||o===10||o===13);++s);if(r||(n[0]=t.slice(0,s)),s===t.length)return n;var l=t.match(HS),u=0,f="",m=0,p="",v="",y=1;if(l)for(m=0;m!=l.length;++m){for(v=l[m],o=0;o!=v.length&&v.charCodeAt(o)!==61;++o);for(p=v.slice(0,o).trim();v.charCodeAt(o+1)==32;)++o;for(y=(s=v.charCodeAt(o+1))==34||s==39?1:0,f=v.slice(o+1+y,v.length-y),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=f,n[p.toLowerCase()]=f;else{var S=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[S]&&p.slice(u-3,u)=="ext")continue;n[S]=f,n[S.toLowerCase()]=f}}return n}function Ms(t){return t.replace(KS,"<$1")}var hv={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},XS=hh(hv),Ot=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function e(n){var s=n+"",o=s.indexOf("<![CDATA[");if(o==-1)return s.replace(t,function(u,f){return hv[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(r,function(u,f){return String.fromCharCode(parseInt(f,16))});var l=s.indexOf("]]>");return e(s.slice(0,o))+s.slice(o+9,l)+e(s.slice(l+3))}})(),qS=/[&<>'"]/g,JS=/[\u0000-\u001f]/g;function gh(t){var r=t+"";return r.replace(qS,function(e){return XS[e]}).replace(/\n/g,"<br/>").replace(JS,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var vp=(function(){var t=/&#(\d+);/g;function r(e,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,r)}})();function tr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function xf(t){for(var r="",e=0,n=0,s=0,o=0,l=0,u=0;e<t.length;){if(n=t.charCodeAt(e++),n<128){r+=String.fromCharCode(n);continue}if(s=t.charCodeAt(e++),n>191&&n<224){l=(n&31)<<6,l|=s&63,r+=String.fromCharCode(l);continue}if(o=t.charCodeAt(e++),n<240){r+=String.fromCharCode((n&15)<<12|(s&63)<<6|o&63);continue}l=t.charCodeAt(e++),u=((n&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536,r+=String.fromCharCode(55296+(u>>>10&1023)),r+=String.fromCharCode(56320+(u&1023))}return r}function yp(t){var r=Za(2*t.length),e,n,s=1,o=0,l=0,u;for(n=0;n<t.length;n+=s)s=1,(u=t.charCodeAt(n))<128?e=u:u<224?(e=(u&31)*64+(t.charCodeAt(n+1)&63),s=2):u<240?(e=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,e=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),e-=65536,l=55296+(e>>>10&1023),e=56320+(e&1023)),l!==0&&(r[o++]=l&255,r[o++]=l>>>8,l=0),r[o++]=e%256,r[o++]=e>>>8;return r.slice(0,o).toString("ucs2")}function wp(t){return qi(t,"binary").toString("utf8")}var Hu="foo bar bazâð£",Xt=_t&&(wp(Hu)==xf(Hu)&&wp||yp(Hu)==xf(Hu)&&yp)||xf,ql=_t?function(t){return qi(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,n=0,s=0;e<t.length;)switch(n=t.charCodeAt(e++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(e++)-56320+(n<<10),r.push(String.fromCharCode(240+(s>>18&7))),r.push(String.fromCharCode(144+(s>>12&63))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},fc=(function(){var t={};return function(e,n){var s=e+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",n||"")}})(),mv=(function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var n=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}})(),YS=(function(){var t={};return function(e){return t[e]!==void 0?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}})(),QS=/<\/?(?:vt:)?variant>/g,ZS=/<(?:vt:)([^>]*)>([\s\S]*)</;function bp(t,r){var e=lt(t),n=t.match(YS(e.baseType))||[],s=[];if(n.length!=e.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+e.size);return s}return n.forEach(function(o){var l=o.replace(QS,"").match(ZS);l&&s.push({v:Xt(l[2]),t:l[1]})}),s}var e2=/(^\s|\s$|\n)/;function t2(t){return Ps(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function r2(t,r,e){return"<"+t+(e!=null?t2(e):"")+(r!=null?(r.match(e2)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function ph(t){if(_t&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Xt(Ji(uh(t)));throw new Error("Bad input format: expected Buffer or string")}var hc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,n2={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},s2=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function a2(t,r){for(var e=1-2*(t[r+7]>>>7),n=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),s=t[r+6]&15,o=5;o>=0;--o)s=s*256+t[r+o];return n==2047?s==0?e*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),e*Math.pow(2,n-52)*s)}function i2(t,r,e){var n=(r<0||1/r==-1/0?1:0)<<7,s=0,o=0,l=n?-r:r;isFinite(l)?l==0?s=o=0:(s=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-s),s<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?s=-1022:(o-=Math.pow(2,52),s+=1023)):(s=2047,o=isNaN(r)?26985:0);for(var u=0;u<=5;++u,o/=256)t[e+u]=o&255;t[e+6]=(s&15)<<4|o&15,t[e+7]=s>>4|n}var _p=function(t){for(var r=[],e=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,o=t[0][n].length;s<o;s+=e)r.push.apply(r,t[0][n].slice(s,s+e));return r},Sp=_t?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:qi(r)})):_p(t)}:_p,Ep=function(t,r,e){for(var n=[],s=r;s<e;s+=2)n.push(String.fromCharCode(la(t,s)));return n.join("").replace(yn,"")},xh=_t?function(t,r,e){return Buffer.isBuffer(t)?t.toString("utf16le",r,e).replace(yn,""):Ep(t,r,e)}:Ep,kp=function(t,r,e){for(var n=[],s=r;s<r+e;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},gv=_t?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):kp(t,r,e)}:kp,Tp=function(t,r,e){for(var n=[],s=r;s<e;s++)n.push(String.fromCharCode(Go(t,s)));return n.join("")},Sc=_t?function(r,e,n){return Buffer.isBuffer(r)?r.toString("utf8",e,n):Tp(r,e,n)}:Tp,pv=function(t,r){var e=Vn(t,r);return e>0?Sc(t,r+4,r+4+e-1):""},xv=pv,vv=function(t,r){var e=Vn(t,r);return e>0?Sc(t,r+4,r+4+e-1):""},yv=vv,wv=function(t,r){var e=2*Vn(t,r);return e>0?Sc(t,r+4,r+4+e-1):""},bv=wv,_v=function(r,e){var n=Vn(r,e);return n>0?xh(r,e+4,e+4+n):""},Sv=_v,Ev=function(t,r){var e=Vn(t,r);return e>0?Sc(t,r+4,r+4+e):""},kv=Ev,Tv=function(t,r){return a2(t,r)},ld=Tv,Nv=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};_t&&(xv=function(r,e){if(!Buffer.isBuffer(r))return pv(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},yv=function(r,e){if(!Buffer.isBuffer(r))return vv(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},bv=function(r,e){if(!Buffer.isBuffer(r))return wv(r,e);var n=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n-1)},Sv=function(r,e){if(!Buffer.isBuffer(r))return _v(r,e);var n=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n)},kv=function(r,e){if(!Buffer.isBuffer(r))return Ev(r,e);var n=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+n)},ld=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):Tv(r,e)},Nv=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Go=function(t,r){return t[r]},la=function(t,r){return t[r+1]*256+t[r]},o2=function(t,r){var e=t[r+1]*256+t[r];return e<32768?e:(65535-e+1)*-1},Vn=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},$i=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},l2=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function Zl(t,r){var e="",n,s,o=[],l,u,f,m;switch(r){case"dbcs":if(m=this.l,_t&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)e+=String.fromCharCode(la(this,m)),m+=2;t*=2;break;case"utf8":e=Sc(this,this.l,this.l+t);break;case"utf16le":t*=2,e=xh(this,this.l,this.l+t);break;case"wstr":return Zl.call(this,t,"dbcs");case"lpstr-ansi":e=xv(this,this.l),t=4+Vn(this,this.l);break;case"lpstr-cp":e=yv(this,this.l),t=4+Vn(this,this.l);break;case"lpwstr":e=bv(this,this.l),t=4+2*Vn(this,this.l);break;case"lpp4":t=4+Vn(this,this.l),e=Sv(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Vn(this,this.l),e=kv(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(l=Go(this,this.l+t++))!==0;)o.push(Wu(l));e=o.join("");break;case"_wstr":for(t=0,e="";(l=la(this,this.l+t))!==0;)o.push(Wu(l)),t+=2;t+=2,e=o.join("");break;case"dbcs-cont":for(e="",m=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(m)!==-1)return l=Go(this,m),this.l=m+1,u=Zl.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Wu(la(this,m))),m+=2}e=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(e="",m=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(m)!==-1)return l=Go(this,m),this.l=m+1,u=Zl.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Wu(Go(this,m))),m+=1}e=o.join("");break;default:switch(t){case 1:return n=Go(this,this.l),this.l++,n;case 2:return n=(r==="i"?o2:la)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(t>0?$i:l2)(this,this.l),this.l+=4,n):(s=Vn(this,this.l),this.l+=4,s);case 8:case-8:if(r==="f")return t==8?s=ld(this,this.l):s=ld([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:e=gv(this,this.l,t);break}}return this.l+=t,e}var c2=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},u2=function(t,r,e){t[e]=r&255,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},d2=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255};function f2(t,r,e){var n=0,s=0;if(e==="dbcs"){for(s=0;s!=r.length;++s)d2(this,r.charCodeAt(s),this.l+2*s);n=2*r.length}else if(e==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=r.length;++s)this[this.l+s]=r.charCodeAt(s)&255;n=r.length}else if(e==="hex"){for(;s<t;++s)this[this.l++]=parseInt(r.slice(2*s,2*s+2),16)||0;return this}else if(e==="utf16le"){var o=Math.min(this.l+t,this.length);for(s=0;s<Math.min(r.length,t);++s){var l=r.charCodeAt(s);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,c2(this,r,this.l);break;case 8:if(n=8,e==="f"){i2(this,r,this.l);break}case 16:break;case-4:n=4,u2(this,r,this.l);break}return this.l+=n,this}function Cv(t,r){var e=gv(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function Wr(t,r){t.l=r,t.read_shift=Zl,t.chk=Cv,t.write_shift=f2}function nn(t,r){t.l+=r}function Tr(t){var r=Za(t);return Wr(r,0),r}function ga(t,r,e){if(t){var n,s,o;Wr(t,t.l||0);for(var l=t.length,u=0,f=0;t.l<l;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var m=md[u]||md[65535];for(n=t.read_shift(1),o=n&127,s=1;s<4&&n&128;++s)o+=((n=t.read_shift(1))&127)<<7*s;f=t.l+o;var p=m.f&&m.f(t,o,e);if(t.l=f,r(p,m,u))return}}}function $f(){var t=[],r=_t?256:2048,e=function(m){var p=Tr(m);return Wr(p,0),p},n=e(r),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(m){return n&&m<n.length-n.l?n:(s(),n=e(Math.max(m+1,r)))},l=function(){return s(),qa(t)},u=function(m){s(),n=m,n.l==null&&(n.l=n.length),o(r)};return{next:o,push:u,end:l,_bufs:t}}function ec(t,r,e){var n=Hr(t);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!e||e.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Np(t,r,e){var n=Hr(t);return n.s=ec(n.s,r.s,e),n.e=ec(n.e,r.s,e),n}function tc(t,r){if(t.cRel&&t.c<0)for(t=Hr(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=Hr(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=ht(t);return!t.cRel&&t.cRel!=null&&(e=g2(e)),!t.rRel&&t.rRel!=null&&(e=h2(e)),e}function vf(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Nr(t.s.c)+":"+(t.e.cRel?"":"$")+Nr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+zr(t.s.r)+":"+(t.e.rRel?"":"$")+zr(t.e.r):tc(t.s,r.biff)+":"+tc(t.e,r.biff)}function vh(t){return parseInt(m2(t),10)-1}function zr(t){return""+(t+1)}function h2(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function m2(t){return t.replace(/\$(\d+)$/,"$1")}function yh(t){for(var r=p2(t),e=0,n=0;n!==r.length;++n)e=26*e+r.charCodeAt(n)-64;return e-1}function Nr(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function g2(t){return t.replace(/^([A-Z])/,"$$$1")}function p2(t){return t.replace(/^\$([A-Z])/,"$1")}function x2(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function vn(t){for(var r=0,e=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?r=10*r+(s-48):s>=65&&s<=90&&(e=26*e+(s-64))}return{c:e-1,r:r-1}}function ht(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function il(t){var r=t.indexOf(":");return r==-1?{s:vn(t),e:vn(t)}:{s:vn(t.slice(0,r)),e:vn(t.slice(r+1))}}function Nt(t,r){return typeof r>"u"||typeof r=="number"?Nt(t.s,t.e):(typeof t!="string"&&(t=ht(t)),typeof r!="string"&&(r=ht(r)),t==r?t:t+":"+r)}function lr(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,n=0,s=0,o=t.length;for(e=0;n<o&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)e=26*e+s;for(r.s.c=--e,e=0;n<o&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)e=10*e+s;if(r.s.r=--e,n===o||s!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,e=0;n!=o&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)e=26*e+s;for(r.e.c=--e,e=0;n!=o&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)e=10*e+s;return r.e.r=--e,r}function Cp(t,r){var e=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=rs(t.z,e?wn(r):r)}catch{}try{return t.w=rs((t.XF||{}).numFmtId||(e?14:0),e?wn(r):r)}catch{return""+r}}function ha(t,r,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?Zi[t.v]||t.v:r==null?Cp(t,t.v):Cp(t,r))}function ri(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",n={};return n[e]=t,{SheetNames:[e],Sheets:n}}function Av(t,r,e){var n=e||{},s=t?Array.isArray(t):n.dense,o=t||(s?[]:{}),l=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?vn(n.origin):n.origin;l=f.r,u=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=lr(o["!ref"]);m.s.c=p.s.c,m.s.r=p.s.r,m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),l==-1&&(m.e.r=l=p.e.r+1)}for(var v=0;v!=r.length;++v)if(r[v]){if(!Array.isArray(r[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=r[v].length;++y)if(!(typeof r[v][y]>"u")){var S={v:r[v][y]},k=l+v,w=u+y;if(m.s.r>k&&(m.s.r=k),m.s.c>w&&(m.s.c=w),m.e.r<k&&(m.e.r=k),m.e.c<w&&(m.e.c=w),r[v][y]&&typeof r[v][y]=="object"&&!Array.isArray(r[v][y])&&!(r[v][y]instanceof Date))S=r[v][y];else if(Array.isArray(S.v)&&(S.f=r[v][y][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(n.nullError)S.t="e",S.v=0;else if(n.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?S.t="n":typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=n.dateNF||gt[14],n.cellDates?(S.t="d",S.w=rs(S.z,wn(S.v))):(S.t="n",S.v=wn(S.v),S.w=rs(S.z,S.v))):S.t="s";if(s)o[k]||(o[k]=[]),o[k][w]&&o[k][w].z&&(S.z=o[k][w].z),o[k][w]=S;else{var E=ht({c:w,r:k});o[E]&&o[E].z&&(S.z=o[E].z),o[E]=S}}}return m.s.c<1e7&&(o["!ref"]=Nt(m)),o}function ol(t,r){return Av(null,t,r)}function v2(t){return t.read_shift(4,"i")}function rn(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function y2(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function wh(t,r){var e=t.l,n=t.read_shift(1),s=rn(t),o=[],l={t:s,h:s};if((n&1)!==0){for(var u=t.read_shift(4),f=0;f!=u;++f)o.push(y2(t));l.r=o}else l.r=[{ich:0,ifnt:0}];return t.l=e+r,l}var w2=wh;function ns(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function Yi(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}var b2=rn;function bh(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}var _2=rn,Bf=bh;function _h(t){var r=t.slice(t.l,t.l+4),e=r[0]&1,n=r[0]&2;t.l+=4;var s=n===0?ld([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):$i(r,0)>>2;return e?s/100:s}function Rv(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}var Qi=Rv;function en(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function S2(t){var r={},e=t.read_shift(1),n=e>>>1,s=t.read_shift(1),o=t.read_shift(2,"i"),l=t.read_shift(1),u=t.read_shift(1),f=t.read_shift(1);switch(t.l++,n){case 0:r.auto=1;break;case 1:r.index=s;var m=Wi[s];m&&(r.rgb=gc(m));break;case 2:r.rgb=gc([l,u,f]);break;case 3:r.theme=s;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function E2(t){var r=t.read_shift(1);t.l++;var e={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return e}function Iv(t,r){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return e[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,r==1?"lpstr":"lpwstr")}function k2(t){return Iv(t,1)}function T2(t){return Iv(t,2)}var Sh=2,On=3,zu=11,Ap=12,cd=19,Gu=64,N2=65,C2=71,A2=4108,R2=4126,jr=80,Ov=81,I2=[jr,Ov],O2={1:{n:"CodePage",t:Sh},2:{n:"Category",t:jr},3:{n:"PresentationFormat",t:jr},4:{n:"ByteCount",t:On},5:{n:"LineCount",t:On},6:{n:"ParagraphCount",t:On},7:{n:"SlideCount",t:On},8:{n:"NoteCount",t:On},9:{n:"HiddenCount",t:On},10:{n:"MultimediaClipCount",t:On},11:{n:"ScaleCrop",t:zu},12:{n:"HeadingPairs",t:A2},13:{n:"TitlesOfParts",t:R2},14:{n:"Manager",t:jr},15:{n:"Company",t:jr},16:{n:"LinksUpToDate",t:zu},17:{n:"CharacterCount",t:On},19:{n:"SharedDoc",t:zu},22:{n:"HyperlinksChanged",t:zu},23:{n:"AppVersion",t:On,p:"version"},24:{n:"DigSig",t:N2},26:{n:"ContentType",t:jr},27:{n:"ContentStatus",t:jr},28:{n:"Language",t:jr},29:{n:"Version",t:jr},255:{},2147483648:{n:"Locale",t:cd},2147483651:{n:"Behavior",t:cd},1919054434:{}},j2={1:{n:"CodePage",t:Sh},2:{n:"Title",t:jr},3:{n:"Subject",t:jr},4:{n:"Author",t:jr},5:{n:"Keywords",t:jr},6:{n:"Comments",t:jr},7:{n:"Template",t:jr},8:{n:"LastAuthor",t:jr},9:{n:"RevNumber",t:jr},10:{n:"EditTime",t:Gu},11:{n:"LastPrinted",t:Gu},12:{n:"CreatedDate",t:Gu},13:{n:"ModifiedDate",t:Gu},14:{n:"PageCount",t:On},15:{n:"WordCount",t:On},16:{n:"CharCount",t:On},17:{n:"Thumbnail",t:C2},18:{n:"Application",t:jr},19:{n:"DocSecurity",t:On},255:{},2147483648:{n:"Locale",t:cd},2147483651:{n:"Behavior",t:cd},1919054434:{}},Rp={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},F2=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function D2(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var P2=D2([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Wi=Hr(P2),Zi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},jv={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ip={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function L2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function M2(t){var r=L2();if(!t||!t.match)return r;var e={};if((t.match(sn)||[]).forEach(function(n){var s=lt(n);switch(s[0].replace(GS,"<")){case"<?xml":break;case"<Types":r.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[s.Extension]=s.ContentType;break;case"<Override":r[Ip[s.ContentType]]!==void 0&&r[Ip[s.ContentType]].push(s.PartName);break}}),r.xmlns!==n2.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=e,delete r.calcchains,r}var Ko={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Vf(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function rc(t,r){var e={"!id":{}};if(!t)return e;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(t.match(sn)||[]).forEach(function(s){var o=lt(s);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:Xl(o.Target,r);e[u]=l,n[o.Id]=l}}),e["!id"]=n,e}var U2="application/vnd.oasis.opendocument.spreadsheet";function $2(t,r){for(var e=ph(t),n,s;n=hc.exec(e);)switch(n[3]){case"manifest":break;case"file-entry":if(s=lt(n[0],!1),s.path=="/"&&s.type!==U2)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var nc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],B2=(function(){for(var t=new Array(nc.length),r=0;r<nc.length;++r){var e=nc[r],n="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);t[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function Fv(t){var r={};t=Xt(t);for(var e=0;e<nc.length;++e){var n=nc[e],s=t.match(B2[e]);s!=null&&s.length>0&&(r[n[1]]=Ot(s[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=Fr(r[n[1]]))}return r}var V2=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Dv(t,r,e,n){var s=[];if(typeof t=="string")s=bp(t,n);else for(var o=0;o<t.length;++o)s=s.concat(t[o].map(function(p){return{v:p}}));var l=typeof r=="string"?bp(r,n).map(function(p){return p.v}):r,u=0,f=0;if(l.length>0)for(var m=0;m!==s.length;m+=2){switch(f=+s[m+1].v,s[m].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":e.Worksheets=f,e.SheetNames=l.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":e.NamedRanges=f,e.DefinedNames=l.slice(u,u+f);break;case"Charts":case"Diagramme":e.Chartsheets=f,e.ChartNames=l.slice(u,u+f);break}u+=f}}function W2(t,r,e){var n={};return r||(r={}),t=Xt(t),V2.forEach(function(s){var o=(t.match(fc(s[0]))||[])[1];switch(s[2]){case"string":o&&(r[s[1]]=Ot(o));break;case"bool":r[s[1]]=o==="true";break;case"raw":var l=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));l&&l.length>0&&(n[s[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Dv(n.HeadingPairs,n.TitlesOfParts,r,e),r}var H2=/<[^>]+>[^<]*/g;function z2(t,r){var e={},n="",s=t.match(H2);if(s)for(var o=0;o!=s.length;++o){var l=s[o],u=lt(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ot(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),m=f[0].slice(4),p=f[1];switch(m){case"lpstr":case"bstr":case"lpwstr":e[n]=Ot(p);break;case"bool":e[n]=tr(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":e[n]=parseFloat(p);break;case"filetime":case"date":e[n]=Fr(p);break;case"cy":case"error":e[n]=Ot(p);break;default:if(m.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",l,m,f)}}else if(l.slice(0,2)!=="</"){if(r.WTF)throw new Error(l)}}}return e}var G2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},yf;function K2(t,r,e){yf||(yf=hh(G2)),r=yf[r]||r,t[r]=e}function Eh(t){var r=t.read_shift(4),e=t.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Pv(t,r,e){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(e)for(;t.l-n&3;)++t.l;return s}function Lv(t,r,e){var n=t.read_shift(0,"lpwstr");return n}function Mv(t,r,e){return r===31?Lv(t):Pv(t,r,e)}function Wf(t,r,e){return Mv(t,r,e===!1?0:4)}function X2(t,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Mv(t,r,0)}function q2(t){for(var r=t.read_shift(4),e=[],n=0;n!=r;++n){var s=t.l;e[n]=t.read_shift(0,"lpwstr").replace(yn,""),t.l-s&2&&(t.l+=2)}return e}function J2(t){for(var r=t.read_shift(4),e=[],n=0;n!=r;++n)e[n]=t.read_shift(0,"lpstr-cp").replace(yn,"");return e}function Y2(t){var r=t.l,e=ud(t,Ov);t[t.l]==0&&t[t.l+1]==0&&t.l-r&2&&(t.l+=2);var n=ud(t,On);return[e,n]}function Q2(t){for(var r=t.read_shift(4),e=[],n=0;n<r/2;++n)e.push(Y2(t));return e}function Op(t,r){for(var e=t.read_shift(4),n={},s=0;s!=e;++s){var o=t.read_shift(4),l=t.read_shift(4);n[o]=t.read_shift(l,r===1200?"utf16le":"utf8").replace(yn,"").replace(Kl,"!"),r===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function Uv(t){var r=t.read_shift(4),e=t.slice(t.l,t.l+r);return t.l+=r,(r&3)>0&&(t.l+=4-(r&3)&3),e}function Z2(t){var r={};return r.Size=t.read_shift(4),t.l+=r.Size+3-(r.Size-1)%4,r}function ud(t,r,e){var n=t.read_shift(2),s,o=e||{};if(t.l+=2,r!==Ap&&n!==r&&I2.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===Ap?n:r){case 2:return s=t.read_shift(2,"i"),o.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return Pv(t,n,4).replace(yn,"");case 31:return Lv(t);case 64:return Eh(t);case 65:return Uv(t);case 71:return Z2(t);case 80:return Wf(t,n,!o.raw).replace(yn,"");case 81:return X2(t,n).replace(yn,"");case 4108:return Q2(t);case 4126:case 4127:return n==4127?q2(t):J2(t);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function jp(t,r){var e=t.l,n=t.read_shift(4),s=t.read_shift(4),o=[],l=0,u=0,f=-1,m={};for(l=0;l!=s;++l){var p=t.read_shift(4),v=t.read_shift(4);o[l]=[p,v+e]}o.sort(function(B,C){return B[1]-C[1]});var y={};for(l=0;l!=s;++l){if(t.l!==o[l][1]){var S=!0;if(l>0&&r)switch(r[o[l-1][0]].t){case 2:t.l+2===o[l][1]&&(t.l+=2,S=!1);break;case 80:t.l<=o[l][1]&&(t.l=o[l][1],S=!1);break;case 4108:t.l<=o[l][1]&&(t.l=o[l][1],S=!1);break}if((!r||l==0)&&t.l<=o[l][1]&&(S=!1,t.l=o[l][1]),S)throw new Error("Read Error: Expected address "+o[l][1]+" at "+t.l+" :"+l)}if(r){var k=r[o[l][0]];if(y[k.n]=ud(t,k.t,{raw:!0}),k.p==="version"&&(y[k.n]=String(y[k.n]>>16)+"."+("0000"+String(y[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(y[k.n]){case 0:y[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:xs(u=y[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[k.n])}}else if(o[l][0]===1){if(u=y.CodePage=ud(t,Sh),xs(u),f!==-1){var w=t.l;t.l=o[f][1],m=Op(t,u),t.l=w}}else if(o[l][0]===0){if(u===0){f=l,t.l=o[l+1][1];continue}m=Op(t,u)}else{var E=m[o[l][0]],F;switch(t[t.l]){case 65:t.l+=4,F=Uv(t);break;case 30:t.l+=4,F=Wf(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,F=Wf(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,F=t.read_shift(4,"i");break;case 19:t.l+=4,F=t.read_shift(4);break;case 5:t.l+=4,F=t.read_shift(8,"f");break;case 11:t.l+=4,F=ur(t,4);break;case 64:t.l+=4,F=Fr(Eh(t));break;default:throw new Error("unparsed value: "+t[t.l])}y[E]=F}}return t.l=e+n,y}function Fp(t,r,e){var n=t.content;if(!n)return{};Wr(n,0);var s,o,l,u,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var m=n.read_shift(4),p=n.read_shift(16);if(p!==Tt.utils.consts.HEADER_CLSID&&p!==e)throw new Error("Bad PropertySet CLSID "+p);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(o=n.read_shift(16),u=n.read_shift(4),s===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);s===2&&(l=n.read_shift(16),f=n.read_shift(4));var v=jp(n,r),y={SystemIdentifier:m};for(var S in v)y[S]=v[S];if(y.FMTID=o,s===1)return y;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var k;try{k=jp(n,null)}catch{}for(S in k)y[S]=k[S];return y.FMTID=[o,l],y}function za(t,r){return t.read_shift(r),null}function eE(t,r,e){for(var n=[],s=t.l+r;t.l<s;)n.push(e(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function ur(t,r){return t.read_shift(r)===1}function xr(t){return t.read_shift(2,"u")}function $v(t,r){return eE(t,r,xr)}function tE(t){var r=t.read_shift(1),e=t.read_shift(1);return e===1?r:r===1}function Ec(t,r,e){var n=t.read_shift(e&&e.biff>=12?2:1),s="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var o=t.read_shift(1);o&&(s="dbcs-cont")}else e.biff==12&&(s="wstr");e.biff>=2&&e.biff<=5&&(s="cpstr");var l=n?t.read_shift(n,s):"";return l}function rE(t){var r=t.read_shift(2),e=t.read_shift(1),n=e&4,s=e&8,o=1+(e&1),l=0,u,f={};s&&(l=t.read_shift(2)),n&&(u=t.read_shift(4));var m=o==2?"dbcs-cont":"sbcs-cont",p=r===0?"":t.read_shift(r,m);return s&&(t.l+=4*l),n&&(t.l+=u),f.t=p,s||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function Gi(t,r,e){var n;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(r,"sbcs-cont"):n=t.read_shift(r,"dbcs-cont"),n}function kc(t,r,e){var n=t.read_shift(e&&e.biff==2?1:2);return n===0?(t.l++,""):Gi(t,n,e)}function eo(t,r,e){if(e.biff>5)return kc(t,r,e);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function nE(t){var r=t.read_shift(1);t.l++;var e=t.read_shift(2);return t.l+=2,[r,e]}function sE(t){var r=t.read_shift(4),e=t.l,n=!1;r>24&&(t.l+=r-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=e);var s=t.read_shift((n?r-24:r)>>1,"utf16le").replace(yn,"");return n&&(t.l+=24),s}function aE(t){for(var r=t.read_shift(2),e="";r-- >0;)e+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return e+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(o>>1,"utf16le").replace(yn,"");return e+l}function iE(t,r){var e=t.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return sE(t);case"0303000000000000c000000000000046":return aE(t);default:throw new Error("Unsupported Moniker "+e)}}function Ku(t){var r=t.read_shift(4),e=r>0?t.read_shift(r,"utf16le").replace(yn,""):"";return e}function oE(t,r){var e=t.l+r,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var o,l,u,f,m="",p,v;s&16&&(o=Ku(t,e-t.l)),s&128&&(l=Ku(t,e-t.l)),(s&257)===257&&(u=Ku(t,e-t.l)),(s&257)===1&&(f=iE(t,e-t.l)),s&8&&(m=Ku(t,e-t.l)),s&32&&(p=t.read_shift(16)),s&64&&(v=Eh(t)),t.l=e;var y=l||u||f||"";y&&m&&(y+="#"+m),y||(y="#"+m),s&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var S={Target:y};return p&&(S.guid=p),v&&(S.time=v),o&&(S.Tooltip=o),S}function Bv(t){var r=t.read_shift(1),e=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[r,e,n,s]}function Vv(t,r){var e=Bv(t);return e[3]=0,e}function Us(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2);return{r,c:e,ixfe:n}}function lE(t){var r=t.read_shift(2),e=t.read_shift(2);return t.l+=8,{type:r,flags:e}}function cE(t,r,e){return r===0?"":eo(t,r,e)}function uE(t,r,e){var n=e.biff>8?4:2,s=t.read_shift(n),o=t.read_shift(n,"i"),l=t.read_shift(n,"i");return[s,o,l]}function Wv(t){var r=t.read_shift(2),e=_h(t);return[r,e]}function dE(t,r,e){t.l+=4,r-=4;var n=t.l+r,s=Ec(t,r,e),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,s}function wd(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r},e:{c:s,r:e}}}function Hv(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r},e:{c:s,r:e}}}var fE=Hv;function zv(t){t.l+=4;var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[e,r,n]}function hE(t){var r={};return t.l+=4,t.l+=16,r.fSharedNote=t.read_shift(2),t.l+=4,r}function mE(t){var r={};return t.l+=4,t.cf=t.read_shift(2),r}function Qr(t){t.l+=2,t.l+=t.read_shift(2)}var gE={0:Qr,4:Qr,5:Qr,6:Qr,7:mE,8:Qr,9:Qr,10:Qr,11:Qr,12:Qr,13:hE,14:Qr,15:Qr,16:Qr,17:Qr,18:Qr,19:Qr,20:Qr,21:zv};function pE(t,r){for(var e=t.l+r,n=[];t.l<e;){var s=t.read_shift(2);t.l-=2;try{n.push(gE[s](t,e-t.l))}catch{return t.l=e,n}}return t.l!=e&&(t.l=e),n}function Xu(t,r){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=t.read_shift(2),r-=2,r>=2&&(e.dt=t.read_shift(2),t.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return t.read_shift(r),e}function xE(t,r){return r===0||t.read_shift(2),1200}function vE(t,r,e){if(e.enc)return t.l+=r,"";var n=t.l,s=eo(t,0,e);return t.read_shift(r+n-t.l),s}function yE(t,r,e){var n=e&&e.biff==8||r==2?t.read_shift(2):(t.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function wE(t,r,e){var n=t.read_shift(4),s=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=Ec(t,0,e);return l.length===0&&(l="Sheet1"),{pos:n,hs:s,dt:o,name:l}}function bE(t,r){for(var e=t.l+r,n=t.read_shift(4),s=t.read_shift(4),o=[],l=0;l!=s&&t.l<e;++l)o.push(rE(t));return o.Count=n,o.Unique=s,o}function _E(t,r){var e={};return e.dsst=t.read_shift(2),t.l+=r-2,e}function SE(t){var r={};r.r=t.read_shift(2),r.c=t.read_shift(2),r.cnt=t.read_shift(2)-r.c;var e=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=e/20),r}function EE(t){var r=lE(t);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var e=t.read_shift(4);return e!==0}function kE(t){return t.read_shift(2),t.read_shift(4)}function Dp(t,r,e){var n=0;e&&e.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);e&&e.biff==2&&(n=1-(s>>15),s&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,s]}function TE(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2),f=t.read_shift(2),m=t.read_shift(2);return{Pos:[r,e],Dim:[n,s],Flags:o,CurTab:l,FirstTab:u,Selected:f,TabRatio:m}}function NE(t,r,e){if(e&&e.biff>=2&&e.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function CE(){}function AE(t,r,e){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Ec(t,0,e),n}function RE(t){var r=Us(t);return r.isst=t.read_shift(4),r}function IE(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=t.l+r,s=Us(t);e.biff==2&&t.l++;var o=kc(t,n-t.l,e);return s.val=o,s}function OE(t,r,e){var n=t.read_shift(2),s=eo(t,0,e);return[n,s]}var jE=eo;function Pp(t,r,e){var n=t.l+r,s=e.biff==8||!e.biff?4:2,o=t.read_shift(s),l=t.read_shift(s),u=t.read_shift(2),f=t.read_shift(2);return t.l=n,{s:{r:o,c:u},e:{r:l,c:f}}}function FE(t){var r=t.read_shift(2),e=t.read_shift(2),n=Wv(t);return{r,c:e,ixfe:n[0],rknum:n[1]}}function DE(t,r){for(var e=t.l+r-2,n=t.read_shift(2),s=t.read_shift(2),o=[];t.l<e;)o.push(Wv(t));if(t.l!==e)throw new Error("MulRK read error");var l=t.read_shift(2);if(o.length!=l-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:l,rkrec:o}}function PE(t,r){for(var e=t.l+r-2,n=t.read_shift(2),s=t.read_shift(2),o=[];t.l<e;)o.push(t.read_shift(2));if(t.l!==e)throw new Error("MulBlank read error");var l=t.read_shift(2);if(o.length!=l-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:l,ixfe:o}}function LE(t,r,e,n){var s={},o=t.read_shift(4),l=t.read_shift(4),u=t.read_shift(4),f=t.read_shift(2);return s.patternType=F2[u>>26],n.cellStyles&&(s.alc=o&7,s.fWrap=o>>3&1,s.alcV=o>>4&7,s.fJustLast=o>>7&1,s.trot=o>>8&255,s.cIndent=o>>16&15,s.fShrinkToFit=o>>20&1,s.iReadOrder=o>>22&2,s.fAtrNum=o>>26&1,s.fAtrFnt=o>>27&1,s.fAtrAlc=o>>28&1,s.fAtrBdr=o>>29&1,s.fAtrPat=o>>30&1,s.fAtrProt=o>>31&1,s.dgLeft=l&15,s.dgRight=l>>4&15,s.dgTop=l>>8&15,s.dgBottom=l>>12&15,s.icvLeft=l>>16&127,s.icvRight=l>>23&127,s.grbitDiag=l>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=f&127,s.icvBack=f>>7&127,s.fsxButton=f>>14&1),s}function ME(t,r,e){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=LE(t,r,n.fStyle,e),n}function UE(t){t.l+=4;var r=[t.read_shift(2),t.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function Lp(t,r,e){var n=Us(t);(e.biff==2||r==9)&&++t.l;var s=tE(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function $E(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=Us(t),s=en(t);return n.val=s,n}var Mp=cE;function BE(t,r,e){var n=t.l+r,s=t.read_shift(2),o=t.read_shift(2);if(e.sbcch=o,o==1025||o==14849)return[o,s];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=Gi(t,o),u=[];n>t.l;)u.push(kc(t));return[o,s,l,u]}function Up(t,r,e){var n=t.read_shift(2),s,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return e.sbcch===14849&&(s=dE(t,r-2,e)),o.body=s||t.read_shift(r-2),typeof s=="string"&&(o.Name=s),o}var VE=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function $p(t,r,e){var n=t.l+r,s=t.read_shift(2),o=t.read_shift(1),l=t.read_shift(1),u=t.read_shift(e&&e.biff==2?1:2),f=0;(!e||e.biff>=5)&&(e.biff!=5&&(t.l+=2),f=t.read_shift(2),e.biff==5&&(t.l+=2),t.l+=4);var m=Gi(t,l,e);s&32&&(m=VE[m.charCodeAt(0)]);var p=n-t.l;e&&e.biff==2&&--p;var v=n==t.l||u===0||!(p>0)?[]:SC(t,p,e,u);return{chKey:o,Name:m,itab:f,rgce:v}}function Gv(t,r,e){if(e.biff<8)return WE(t,r,e);for(var n=[],s=t.l+r,o=t.read_shift(e.biff>8?4:2);o--!==0;)n.push(uE(t,e.biff>8?12:6,e));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function WE(t,r,e){t[t.l+1]==3&&t[t.l]++;var n=Ec(t,r,e);return n.charCodeAt(0)==3?n.slice(1):n}function HE(t,r,e){if(e.biff<8){t.l+=r;return}var n=t.read_shift(2),s=t.read_shift(2),o=Gi(t,n,e),l=Gi(t,s,e);return[o,l]}function zE(t,r,e){var n=Hv(t);t.l++;var s=t.read_shift(1);return r-=8,[EC(t,r,e),s,n]}function Bp(t,r,e){var n=fE(t);switch(e.biff){case 2:t.l++,r-=7;break;case 3:case 4:t.l+=2,r-=8;break;default:t.l+=6,r-=12}return[n,bC(t,r,e)]}function GE(t){var r=t.read_shift(4)!==0,e=t.read_shift(4)!==0,n=t.read_shift(4);return[r,e,n]}function KE(t,r,e){if(!(e.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=eo(t,0,e);return e.biff<8&&t.read_shift(1),[{r:n,c:s},u,l,o]}}function XE(t,r,e){return KE(t,r,e)}function qE(t,r){for(var e=[],n=t.read_shift(2);n--;)e.push(wd(t));return e}function JE(t,r,e){if(e&&e.biff<8)return QE(t,r,e);var n=zv(t),s=pE(t,r-22,n[1]);return{cmo:n,ft:s}}var YE={8:function(t,r){var e=t.l+r;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=e,{fmt:n}}};function QE(t,r,e){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,r-=36;var l=[];return l.push((YE[n]||nn)(t,r,e)),{cmo:[s,n,o],ft:l}}function ZE(t,r,e){var n=t.l,s="";try{t.l+=4;var o=(e.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:l=nE(t,6,e);var u=t.read_shift(2);t.read_shift(2),xr(t,2);var f=t.read_shift(2);t.l+=f;for(var m=1;m<t.lens.length-1;++m){if(t.l-n!=t.lens[m])throw new Error("TxO: bad continue record");var p=t[t.l],v=Gi(t,t.lens[m+1]-t.lens[m]-1);if(s+=v,s.length>=(p?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return t.l=n+r,{t:s}}catch{return t.l=n+r,{t:s}}}function ek(t,r){var e=wd(t);t.l+=16;var n=oE(t,r-24);return[e,n]}function tk(t,r){t.read_shift(2);var e=wd(t),n=t.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(yn,""),[e,n]}function rk(t){var r=[0,0],e;return e=t.read_shift(2),r[0]=Rp[e]||e,e=t.read_shift(2),r[1]=Rp[e]||e,r}function nk(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(Vv(t));return e}function sk(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(Vv(t));return e}function ak(t){t.l+=2;var r={cxfs:0,crc:0};return r.cxfs=t.read_shift(2),r.crc=t.read_shift(4),r}function Kv(t,r,e){if(!e.cellStyles)return nn(t,r);var n=e&&e.biff>=12?4:2,s=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),u=t.read_shift(n),f=t.read_shift(2);n==2&&(t.l+=2);var m={s,e:o,w:l,ixfe:u,flags:f};return(e.biff>=5||!e.biff)&&(m.level=f>>8&7),m}function ik(t,r){var e={};return r<32||(t.l+=16,e.header=en(t),e.footer=en(t),t.l+=2),e}function ok(t,r,e){var n={area:!1};if(e.biff!=5)return t.l+=r,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var lk=Us,ck=$v,uk=kc;function dk(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(4),s={fmt:r,env:e,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function fk(t,r,e){e.biffguess&&e.biff==5&&(e.biff=2);var n=Us(t);++t.l;var s=eo(t,r-7,e);return n.t="str",n.val=s,n}function hk(t){var r=Us(t);++t.l;var e=en(t);return r.t="n",r.val=e,r}function mk(t){var r=Us(t);++t.l;var e=t.read_shift(2);return r.t="n",r.val=e,r}function gk(t){var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,"sbcs-cont")}function pk(t,r){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=r-13}function xk(t,r,e){var n=t.l+r,s=Us(t),o=t.read_shift(2),l=Gi(t,o,e);return t.l=n,s.t="str",s.val=l,s}var vk=[2,3,48,49,131,139,140,245],Vp=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=hh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(u,f){var m=[],p=Za(1);switch(f.type){case"base64":p=ps(Hn(u));break;case"binary":p=ps(u);break;case"buffer":case"array":p=u;break}Wr(p,0);var v=p.read_shift(1),y=!!(v&136),S=!1,k=!1;switch(v){case 2:break;case 3:break;case 48:S=!0,y=!0;break;case 49:S=!0,y=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var w=0,E=521;v==2&&(w=p.read_shift(2)),p.l+=3,v!=2&&(w=p.read_shift(4)),w>1048576&&(w=1e6),v!=2&&(E=p.read_shift(2));var F=p.read_shift(2),B=f.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(B=t[p[p.l]]),p.l+=1,p.l+=2),k&&(p.l+=36);for(var C=[],M={},re=Math.min(p.length,v==2?521:E-10-(S?264:0)),O=k?32:11;p.l<re&&p[p.l]!=13;)switch(M={},M.name=uc.utils.decode(B,p.slice(p.l,p.l+O)).replace(/[\u0000\r\n].*$/g,""),p.l+=O,M.type=String.fromCharCode(p.read_shift(1)),v!=2&&!k&&(M.offset=p.read_shift(4)),M.len=p.read_shift(1),v==2&&(M.offset=p.read_shift(2)),M.dec=p.read_shift(1),M.name.length&&C.push(M),v!=2&&(p.l+=k?13:14),M.type){case"B":(!S||M.len!=8)&&f.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(p[p.l]!==13&&(p.l=E-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=E;var U=0,ee=0;for(m[0]=[],ee=0;ee!=C.length;++ee)m[0][ee]=C[ee].name;for(;w-- >0;){if(p[p.l]===42){p.l+=F;continue}for(++p.l,m[++U]=[],ee=0,ee=0;ee!=C.length;++ee){var I=p.slice(p.l,p.l+C[ee].len);p.l+=C[ee].len,Wr(I,0);var ie=uc.utils.decode(B,I);switch(C[ee].type){case"C":ie.trim().length&&(m[U][ee]=ie.replace(/\s+$/,""));break;case"D":ie.length===8?m[U][ee]=new Date(+ie.slice(0,4),+ie.slice(4,6)-1,+ie.slice(6,8)):m[U][ee]=ie;break;case"F":m[U][ee]=parseFloat(ie.trim());break;case"+":case"I":m[U][ee]=k?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(ie.trim().toUpperCase()){case"Y":case"T":m[U][ee]=!0;break;case"N":case"F":m[U][ee]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ie+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));m[U][ee]="##MEMO##"+(k?parseInt(ie.trim(),10):I.read_shift(4));break;case"N":ie=ie.replace(/\u0000/g,"").trim(),ie&&ie!="."&&(m[U][ee]=+ie||0);break;case"@":m[U][ee]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":m[U][ee]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":m[U][ee]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[U][ee]=-I.read_shift(-8,"f");break;case"B":if(S&&C[ee].len==8){m[U][ee]=I.read_shift(8,"f");break}case"G":case"P":I.l+=C[ee].len;break;case"0":if(C[ee].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[ee].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(m=m.slice(0,f.sheetRows)),f.DBF=C,m}function n(u,f){var m=f||{};m.dateNF||(m.dateNF="yyyymmdd");var p=ol(e(u,m),m);return p["!cols"]=m.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete m.DBF,p}function s(u,f){try{return ri(n(u,f),f)}catch(m){if(f&&f.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,f){var m=f||{};if(+m.codepage>=0&&xs(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var p=$f(),v=qf(u,{header:1,raw:!0,cellDates:!0}),y=v[0],S=v.slice(1),k=u["!cols"]||[],w=0,E=0,F=0,B=1;for(w=0;w<y.length;++w){if(((k[w]||{}).DBF||{}).name){y[w]=k[w].DBF.name,++F;continue}if(y[w]!=null){if(++F,typeof y[w]=="number"&&(y[w]=y[w].toString(10)),typeof y[w]!="string")throw new Error("DBF Invalid column name "+y[w]+" |"+typeof y[w]+"|");if(y.indexOf(y[w])!==w){for(E=0;E<1024;++E)if(y.indexOf(y[w]+"_"+E)==-1){y[w]+="_"+E;break}}}}var C=lr(u["!ref"]),M=[],re=[],O=[];for(w=0;w<=C.e.c-C.s.c;++w){var U="",ee="",I=0,ie=[];for(E=0;E<S.length;++E)S[E][w]!=null&&ie.push(S[E][w]);if(ie.length==0||y[w]==null){M[w]="?";continue}for(E=0;E<ie.length;++E){switch(typeof ie[E]){case"number":ee="B";break;case"string":ee="C";break;case"boolean":ee="L";break;case"object":ee=ie[E]instanceof Date?"D":"C";break;default:ee="C"}I=Math.max(I,String(ie[E]).length),U=U&&U!=ee?"C":ee}I>250&&(I=250),ee=((k[w]||{}).DBF||{}).type,ee=="C"&&k[w].DBF.len>I&&(I=k[w].DBF.len),U=="B"&&ee=="N"&&(U="N",O[w]=k[w].DBF.dec,I=k[w].DBF.len),re[w]=U=="C"||ee=="N"?I:o[U]||0,B+=re[w],M[w]=U}var oe=p.next(32);for(oe.write_shift(4,318902576),oe.write_shift(4,S.length),oe.write_shift(2,296+32*F),oe.write_shift(2,B),w=0;w<4;++w)oe.write_shift(4,0);for(oe.write_shift(4,0|(+r[Gx]||3)<<8),w=0,E=0;w<y.length;++w)if(y[w]!=null){var X=p.next(32),ae=(y[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,ae,"sbcs"),X.write_shift(1,M[w]=="?"?"C":M[w],"sbcs"),X.write_shift(4,E),X.write_shift(1,re[w]||o[M[w]]||0),X.write_shift(1,O[w]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),E+=re[w]||o[M[w]]||0}var fe=p.next(264);for(fe.write_shift(4,13),w=0;w<65;++w)fe.write_shift(4,0);for(w=0;w<S.length;++w){var me=p.next(B);for(me.write_shift(1,0),E=0;E<y.length;++E)if(y[E]!=null)switch(M[E]){case"L":me.write_shift(1,S[w][E]==null?63:S[w][E]?84:70);break;case"B":me.write_shift(8,S[w][E]||0,"f");break;case"N":var Te="0";for(typeof S[w][E]=="number"&&(Te=S[w][E].toFixed(O[E]||0)),F=0;F<re[E]-Te.length;++F)me.write_shift(1,32);me.write_shift(1,Te,"sbcs");break;case"D":S[w][E]?(me.write_shift(4,("0000"+S[w][E].getFullYear()).slice(-4),"sbcs"),me.write_shift(2,("00"+(S[w][E].getMonth()+1)).slice(-2),"sbcs"),me.write_shift(2,("00"+S[w][E].getDate()).slice(-2),"sbcs")):me.write_shift(8,"00000000","sbcs");break;case"C":var be=String(S[w][E]!=null?S[w][E]:"").slice(0,re[E]);for(me.write_shift(1,be,"sbcs"),F=0;F<re[E]-be.length;++F)me.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:s,to_sheet:n,from_sheet:l}})(),yk=(function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Ps(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(y,S){var k=t[S];return typeof k=="number"?sp(k):k},n=function(y,S,k){var w=S.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return w==59?y:sp(w)};t["|"]=254;function s(y,S){switch(S.type){case"base64":return o(Hn(y),S);case"binary":return o(y,S);case"buffer":return o(_t&&Buffer.isBuffer(y)?y.toString("binary"):Ji(y),S);case"array":return o(zi(y),S)}throw new Error("Unrecognized type "+S.type)}function o(y,S){var k=y.split(/[\n\r]+/),w=-1,E=-1,F=0,B=0,C=[],M=[],re=null,O={},U=[],ee=[],I=[],ie=0,oe;for(+S.codepage>=0&&xs(+S.codepage);F!==k.length;++F){ie=0;var X=k[F].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,e),ae=X.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),fe=ae[0],me;if(X.length>0)switch(fe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ae[1].charAt(0)=="P"&&M.push(X.slice(3).replace(/;;/g,";"));break;case"C":var Te=!1,be=!1,le=!1,te=!1,pe=-1,A=-1;for(B=1;B<ae.length;++B)switch(ae[B].charAt(0)){case"A":break;case"X":E=parseInt(ae[B].slice(1))-1,be=!0;break;case"Y":for(w=parseInt(ae[B].slice(1))-1,be||(E=0),oe=C.length;oe<=w;++oe)C[oe]=[];break;case"K":me=ae[B].slice(1),me.charAt(0)==='"'?me=me.slice(1,me.length-1):me==="TRUE"?me=!0:me==="FALSE"?me=!1:isNaN(ys(me))?isNaN(Qo(me).getDate())||(me=Fr(me)):(me=ys(me),re!==null&&al(re)&&(me=yd(me))),Te=!0;break;case"E":te=!0;var N=qo(ae[B].slice(1),{r:w,c:E});C[w][E]=[C[w][E],N];break;case"S":le=!0,C[w][E]=[C[w][E],"S5S"];break;case"G":break;case"R":pe=parseInt(ae[B].slice(1))-1;break;case"C":A=parseInt(ae[B].slice(1))-1;break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+X)}if(Te&&(C[w][E]&&C[w][E].length==2?C[w][E][0]=me:C[w][E]=me,re=null),le){if(te)throw new Error("SYLK shared formula cannot have own formula");var L=pe>-1&&C[pe][A];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");C[w][E][1]=n1(L[1],{r:w-pe,c:E-A})}break;case"F":var V=0;for(B=1;B<ae.length;++B)switch(ae[B].charAt(0)){case"X":E=parseInt(ae[B].slice(1))-1,++V;break;case"Y":for(w=parseInt(ae[B].slice(1))-1,oe=C.length;oe<=w;++oe)C[oe]=[];break;case"M":ie=parseInt(ae[B].slice(1))/20;break;case"F":break;case"G":break;case"P":re=M[parseInt(ae[B].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=ae[B].slice(1).split(" "),oe=parseInt(I[0],10);oe<=parseInt(I[1],10);++oe)ie=parseInt(I[2],10),ee[oe-1]=ie===0?{hidden:!0}:{wch:ie},Zo(ee[oe-1]);break;case"C":E=parseInt(ae[B].slice(1))-1,ee[E]||(ee[E]={});break;case"R":w=parseInt(ae[B].slice(1))-1,U[w]||(U[w]={}),ie>0?(U[w].hpt=ie,U[w].hpx=pc(ie)):ie===0&&(U[w].hidden=!0);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+X)}V<1&&(re=null);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+X)}}return U.length>0&&(O["!rows"]=U),ee.length>0&&(O["!cols"]=ee),S&&S.sheetRows&&(C=C.slice(0,S.sheetRows)),[C,O]}function l(y,S){var k=s(y,S),w=k[0],E=k[1],F=ol(w,S);return Ps(E).forEach(function(B){F[B]=E[B]}),F}function u(y,S){return ri(l(y,S),S)}function f(y,S,k,w){var E="C;Y"+(k+1)+";X"+(w+1)+";K";switch(y.t){case"n":E+=y.v||0,y.f&&!y.F&&(E+=";E"+aN(y.f,{r:k,c:w}));break;case"b":E+=y.v?"TRUE":"FALSE";break;case"e":E+=y.w||y.v;break;case"d":E+='"'+(y.w||y.v)+'"';break;case"s":E+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function m(y,S){S.forEach(function(k,w){var E="F;W"+(w+1)+" "+(w+1)+" ";k.hidden?E+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=fd(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=hd(k.wpx)),typeof k.wch=="number"&&(E+=Math.round(k.wch))),E.charAt(E.length-1)!=" "&&y.push(E)})}function p(y,S){S.forEach(function(k,w){var E="F;";k.hidden?E+="M0;":k.hpt?E+="M"+20*k.hpt+";":k.hpx&&(E+="M"+20*e1(k.hpx)+";"),E.length>2&&y.push(E+"R"+(w+1))})}function v(y,S){var k=["ID;PWXL;N;E"],w=[],E=lr(y["!ref"]),F,B=Array.isArray(y),C=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),y["!cols"]&&m(k,y["!cols"]),y["!rows"]&&p(k,y["!rows"]),k.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var M=E.s.r;M<=E.e.r;++M)for(var re=E.s.c;re<=E.e.c;++re){var O=ht({r:M,c:re});F=B?(y[M]||[])[re]:y[O],!(!F||F.v==null&&(!F.f||F.F))&&w.push(f(F,y,M,re))}return k.join(C)+C+w.join(C)+C+"E"+C}return{to_workbook:u,to_sheet:l,from_sheet:v}})(),wk=(function(){function t(o,l){switch(l.type){case"base64":return r(Hn(o),l);case"binary":return r(o,l);case"buffer":return r(_t&&Buffer.isBuffer(o)?o.toString("binary"):Ji(o),l);case"array":return r(zi(o),l)}throw new Error("Unrecognized type "+l.type)}function r(o,l){for(var u=o.split(`
`),f=-1,m=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++f]=[],m=0;continue}if(!(f<0)){var y=u[p].trim().split(","),S=y[0],k=y[1];++p;for(var w=u[p]||"";(w.match(/["]/g)||[]).length&1&&p<u.length-1;)w+=`
`+u[++p];switch(w=w.trim(),+S){case-1:if(w==="BOT"){v[++f]=[],m=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?v[f][m]=!0:w==="FALSE"?v[f][m]=!1:isNaN(ys(k))?isNaN(Qo(k).getDate())?v[f][m]=k:v[f][m]=Fr(k):v[f][m]=ys(k),++m;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),v[f][m++]=w!==""?w:null;break}if(w==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function e(o,l){return ol(t(o,l),l)}function n(o,l){return ri(e(o,l),l)}var s=(function(){var o=function(f,m,p,v,y){f.push(m),f.push(p+","+v),f.push('"'+y.replace(/"/g,'""')+'"')},l=function(f,m,p,v){f.push(m+","+p),f.push(m==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(f){var m=[],p=lr(f["!ref"]),v,y=Array.isArray(f);o(m,"TABLE",0,1,"sheetjs"),o(m,"VECTORS",0,p.e.r-p.s.r+1,""),o(m,"TUPLES",0,p.e.c-p.s.c+1,""),o(m,"DATA",0,0,"");for(var S=p.s.r;S<=p.e.r;++S){l(m,-1,0,"BOT");for(var k=p.s.c;k<=p.e.c;++k){var w=ht({r:S,c:k});if(v=y?(f[S]||[])[k]:f[w],!v){l(m,1,0,"");continue}switch(v.t){case"n":var E=v.w;!E&&v.v!=null&&(E=v.v),E==null?v.f&&!v.F?l(m,1,0,"="+v.f):l(m,1,0,""):l(m,0,E,"V");break;case"b":l(m,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(m,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=rs(v.z||gt[14],wn(Fr(v.v)))),l(m,0,v.w,"V");break;default:l(m,1,0,"")}}}l(m,-1,0,"EOD");var F=`\r
`,B=m.join(F);return B}})();return{to_workbook:n,to_sheet:e,from_sheet:s}})(),bk=(function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(v,y){for(var S=v.split(`
`),k=-1,w=-1,E=0,F=[];E!==S.length;++E){var B=S[E].trim().split(":");if(B[0]==="cell"){var C=vn(B[1]);if(F.length<=C.r)for(k=F.length;k<=C.r;++k)F[k]||(F[k]=[]);switch(k=C.r,w=C.c,B[2]){case"t":F[k][w]=t(B[3]);break;case"v":F[k][w]=+B[3];break;case"vtf":var M=B[B.length-1];case"vtc":switch(B[3]){case"nl":F[k][w]=!!+B[4];break;default:F[k][w]=+B[4];break}B[2]=="vtf"&&(F[k][w]=[F[k][w],M])}}}return y&&y.sheetRows&&(F=F.slice(0,y.sheetRows)),F}function n(v,y){return ol(e(v,y),y)}function s(v,y){return ri(n(v,y),y)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function m(v){if(!v||!v["!ref"])return"";for(var y=[],S=[],k,w="",E=il(v["!ref"]),F=Array.isArray(v),B=E.s.r;B<=E.e.r;++B)for(var C=E.s.c;C<=E.e.c;++C)if(w=ht({r:B,c:C}),k=F?(v[B]||[])[C]:v[w],!(!k||k.v==null||k.t==="z")){switch(S=["cell",w,"t"],k.t){case"s":case"str":S.push(r(k.v));break;case"n":k.f?(S[2]="vtf",S[3]="n",S[4]=k.v,S[5]=r(k.f)):(S[2]="v",S[3]=k.v);break;case"b":S[2]="vt"+(k.f?"f":"c"),S[3]="nl",S[4]=k.v?"1":"0",S[5]=r(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var M=wn(Fr(k.v));S[2]="vtc",S[3]="nd",S[4]=""+M,S[5]=k.w||rs(k.z||gt[14],M);break;case"e":continue}y.push(S.join(":"))}return y.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function p(v){return[o,l,u,l,m(v),f].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:p}})(),mc=(function(){function t(p,v,y,S,k){k.raw?v[y][S]=p:p===""||(p==="TRUE"?v[y][S]=!0:p==="FALSE"?v[y][S]=!1:isNaN(ys(p))?isNaN(Qo(p).getDate())?v[y][S]=p:v[y][S]=Fr(p):v[y][S]=ys(p))}function r(p,v){var y=v||{},S=[];if(!p||p.length===0)return S;for(var k=p.split(/[\r\n]/),w=k.length-1;w>=0&&k[w].length===0;)--w;for(var E=10,F=0,B=0;B<=w;++B)F=k[B].indexOf(" "),F==-1?F=k[B].length:F++,E=Math.max(E,F);for(B=0;B<=w;++B){S[B]=[];var C=0;for(t(k[B].slice(0,E).trim(),S,B,C,y),C=1;C<=(k[B].length-E)/10+1;++C)t(k[B].slice(E+(C-1)*10,E+C*10).trim(),S,B,C,y)}return y.sheetRows&&(S=S.slice(0,y.sheetRows)),S}var e={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(p){for(var v={},y=!1,S=0,k=0;S<p.length;++S)(k=p.charCodeAt(S))==34?y=!y:!y&&k in e&&(v[k]=(v[k]||0)+1);k=[];for(S in v)Object.prototype.hasOwnProperty.call(v,S)&&k.push([v[S],S]);if(!k.length){v=n;for(S in v)Object.prototype.hasOwnProperty.call(v,S)&&k.push([v[S],S])}return k.sort(function(w,E){return w[0]-E[0]||n[w[1]]-n[E[1]]}),e[k.pop()[1]]||44}function o(p,v){var y=v||{},S="",k=y.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(S=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(S=p.charAt(4),p=p.slice(6)):S=s(p.slice(0,1024)):y&&y.FS?S=y.FS:S=s(p.slice(0,1024));var E=0,F=0,B=0,C=0,M=0,re=S.charCodeAt(0),O=!1,U=0,ee=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var I=y.dateNF!=null?OS(y.dateNF):null;function ie(){var oe=p.slice(C,M),X={};if(oe.charAt(0)=='"'&&oe.charAt(oe.length-1)=='"'&&(oe=oe.slice(1,-1).replace(/""/g,'"')),oe.length===0)X.t="z";else if(y.raw)X.t="s",X.v=oe;else if(oe.trim().length===0)X.t="s",X.v=oe;else if(oe.charCodeAt(0)==61)oe.charCodeAt(1)==34&&oe.charCodeAt(oe.length-1)==34?(X.t="s",X.v=oe.slice(2,-1).replace(/""/g,'"')):oN(oe)?(X.t="n",X.f=oe.slice(1)):(X.t="s",X.v=oe);else if(oe=="TRUE")X.t="b",X.v=!0;else if(oe=="FALSE")X.t="b",X.v=!1;else if(!isNaN(B=ys(oe)))X.t="n",y.cellText!==!1&&(X.w=oe),X.v=B;else if(!isNaN(Qo(oe).getDate())||I&&oe.match(I)){X.z=y.dateNF||gt[14];var ae=0;I&&oe.match(I)&&(oe=jS(oe,y.dateNF,oe.match(I)||[]),ae=1),y.cellDates?(X.t="d",X.v=Fr(oe,ae)):(X.t="n",X.v=wn(Fr(oe,ae))),y.cellText!==!1&&(X.w=rs(X.z,X.v instanceof Date?wn(X.v):X.v)),y.cellNF||delete X.z}else X.t="s",X.v=oe;if(X.t=="z"||(y.dense?(k[E]||(k[E]=[]),k[E][F]=X):k[ht({c:F,r:E})]=X),C=M+1,ee=p.charCodeAt(C),w.e.c<F&&(w.e.c=F),w.e.r<E&&(w.e.r=E),U==re)++F;else if(F=0,++E,y.sheetRows&&y.sheetRows<=E)return!0}e:for(;M<p.length;++M)switch(U=p.charCodeAt(M)){case 34:ee===34&&(O=!O);break;case re:case 10:case 13:if(!O&&ie())break e;break}return M-C>0&&ie(),k["!ref"]=Nt(w),k}function l(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,v):ol(r(p,v),v)}function u(p,v){var y="",S=v.type=="string"?[0,0,0,0]:Oh(p,v);switch(v.type){case"base64":y=Hn(p);break;case"binary":y=p;break;case"buffer":v.codepage==65001?y=p.toString("utf8"):v.codepage&&typeof uc<"u"||(y=_t&&Buffer.isBuffer(p)?p.toString("binary"):Ji(p));break;case"array":y=zi(p);break;case"string":y=p;break;default:throw new Error("Unrecognized type "+v.type)}return S[0]==239&&S[1]==187&&S[2]==191?y=Xt(y.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?y=Xt(y):v.type=="binary"&&typeof uc<"u",y.slice(0,19)=="socialcalc:version:"?bk.to_sheet(v.type=="string"?y:Xt(y),v):l(y,v)}function f(p,v){return ri(u(p,v),v)}function m(p){for(var v=[],y=lr(p["!ref"]),S,k=Array.isArray(p),w=y.s.r;w<=y.e.r;++w){for(var E=[],F=y.s.c;F<=y.e.c;++F){var B=ht({r:w,c:F});if(S=k?(p[w]||[])[F]:p[B],!S||S.v==null){E.push("          ");continue}for(var C=(S.w||(ha(S),S.w)||"").slice(0,10);C.length<10;)C+=" ";E.push(C+(F===0?" ":""))}v.push(E.join(""))}return v.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:m}})();function _k(t,r){var e=r||{},n=!!e.WTF;e.WTF=!0;try{var s=yk.to_workbook(t,e);return e.WTF=n,s}catch(o){if(e.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return mc.to_workbook(t,r)}}var sc=(function(){function t(N,L,V){if(N){Wr(N,N.l||0);for(var q=V.Enum||pe;N.l<N.length;){var ce=N.read_shift(2),J=q[ce]||q[65535],he=N.read_shift(2),Y=N.l+he,xe=J.f&&J.f(N,he,V);if(N.l=Y,L(xe,J,ce))return}}}function r(N,L){switch(L.type){case"base64":return e(ps(Hn(N)),L);case"binary":return e(ps(N),L);case"buffer":case"array":return e(N,L)}throw"Unsupported type "+L.type}function e(N,L){if(!N)return N;var V=L||{},q=V.dense?[]:{},ce="Sheet1",J="",he=0,Y={},xe=[],Pe=[],K={s:{r:0,c:0},e:{r:0,c:0}},Xe=V.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)V.Enum=pe,t(N,function(Ae,at,St){switch(St){case 0:V.vers=Ae,Ae>=4096&&(V.qpro=!0);break;case 6:K=Ae;break;case 204:Ae&&(J=Ae);break;case 222:J=Ae;break;case 15:case 51:V.qpro||(Ae[1].v=Ae[1].v.slice(1));case 13:case 14:case 16:St==14&&(Ae[2]&112)==112&&(Ae[2]&15)>1&&(Ae[2]&15)<15&&(Ae[1].z=V.dateNF||gt[14],V.cellDates&&(Ae[1].t="d",Ae[1].v=yd(Ae[1].v))),V.qpro&&Ae[3]>he&&(q["!ref"]=Nt(K),Y[ce]=q,xe.push(ce),q=V.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},he=Ae[3],ce=J||"Sheet"+(he+1),J="");var wt=V.dense?(q[Ae[0].r]||[])[Ae[0].c]:q[ht(Ae[0])];if(wt){wt.t=Ae[1].t,wt.v=Ae[1].v,Ae[1].z!=null&&(wt.z=Ae[1].z),Ae[1].f!=null&&(wt.f=Ae[1].f);break}V.dense?(q[Ae[0].r]||(q[Ae[0].r]=[]),q[Ae[0].r][Ae[0].c]=Ae[1]):q[ht(Ae[0])]=Ae[1];break}},V);else if(N[2]==26||N[2]==14)V.Enum=A,N[2]==14&&(V.qpro=!0,N.l=0),t(N,function(Ae,at,St){switch(St){case 204:ce=Ae;break;case 22:Ae[1].v=Ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ae[3]>he&&(q["!ref"]=Nt(K),Y[ce]=q,xe.push(ce),q=V.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},he=Ae[3],ce="Sheet"+(he+1)),Xe>0&&Ae[0].r>=Xe)break;V.dense?(q[Ae[0].r]||(q[Ae[0].r]=[]),q[Ae[0].r][Ae[0].c]=Ae[1]):q[ht(Ae[0])]=Ae[1],K.e.c<Ae[0].c&&(K.e.c=Ae[0].c),K.e.r<Ae[0].r&&(K.e.r=Ae[0].r);break;case 27:Ae[14e3]&&(Pe[Ae[14e3][0]]=Ae[14e3][1]);break;case 1537:Pe[Ae[0]]=Ae[1],Ae[0]==he&&(ce=Ae[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(q["!ref"]=Nt(K),Y[J||ce]=q,xe.push(J||ce),!Pe.length)return{SheetNames:xe,Sheets:Y};for(var we={},Fe=[],Oe=0;Oe<Pe.length;++Oe)Y[xe[Oe]]?(Fe.push(Pe[Oe]||xe[Oe]),we[Pe[Oe]]=Y[Pe[Oe]]||Y[xe[Oe]]):(Fe.push(Pe[Oe]),we[Pe[Oe]]={"!ref":"A1"});return{SheetNames:Fe,Sheets:we}}function n(N,L){var V=L||{};if(+V.codepage>=0&&xs(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var q=$f(),ce=lr(N["!ref"]),J=Array.isArray(N),he=[];hs(q,0,o(1030)),hs(q,6,f(ce));for(var Y=Math.min(ce.e.r,8191),xe=ce.s.r;xe<=Y;++xe)for(var Pe=zr(xe),K=ce.s.c;K<=ce.e.c;++K){xe===ce.s.r&&(he[K]=Nr(K));var Xe=he[K]+Pe,we=J?(N[xe]||[])[K]:N[Xe];if(!(!we||we.t=="z"))if(we.t=="n")(we.v|0)==we.v&&we.v>=-32768&&we.v<=32767?hs(q,13,S(xe,K,we.v)):hs(q,14,w(xe,K,we.v));else{var Fe=ha(we);hs(q,15,v(xe,K,Fe.slice(0,239)))}}return hs(q,1),q.end()}function s(N,L){var V=L||{};if(+V.codepage>=0&&xs(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var q=$f();hs(q,0,l(N));for(var ce=0,J=0;ce<N.SheetNames.length;++ce)(N.Sheets[N.SheetNames[ce]]||{})["!ref"]&&hs(q,27,te(N.SheetNames[ce],J++));var he=0;for(ce=0;ce<N.SheetNames.length;++ce){var Y=N.Sheets[N.SheetNames[ce]];if(!(!Y||!Y["!ref"])){for(var xe=lr(Y["!ref"]),Pe=Array.isArray(Y),K=[],Xe=Math.min(xe.e.r,8191),we=xe.s.r;we<=Xe;++we)for(var Fe=zr(we),Oe=xe.s.c;Oe<=xe.e.c;++Oe){we===xe.s.r&&(K[Oe]=Nr(Oe));var Ae=K[Oe]+Fe,at=Pe?(Y[we]||[])[Oe]:Y[Ae];if(!(!at||at.t=="z"))if(at.t=="n")hs(q,23,ie(we,Oe,he,at.v));else{var St=ha(at);hs(q,22,U(we,Oe,he,St.slice(0,239)))}}++he}}return hs(q,1),q.end()}function o(N){var L=Tr(2);return L.write_shift(2,N),L}function l(N){var L=Tr(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var V=0,q=0,ce=0,J=0;J<N.SheetNames.length;++J){var he=N.SheetNames[J],Y=N.Sheets[he];if(!(!Y||!Y["!ref"])){++ce;var xe=il(Y["!ref"]);V<xe.e.r&&(V=xe.e.r),q<xe.e.c&&(q=xe.e.c)}}return V>8191&&(V=8191),L.write_shift(2,V),L.write_shift(1,ce),L.write_shift(1,q),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function u(N,L,V){var q={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&V.qpro?(q.s.c=N.read_shift(1),N.l++,q.s.r=N.read_shift(2),q.e.c=N.read_shift(1),N.l++,q.e.r=N.read_shift(2),q):(q.s.c=N.read_shift(2),q.s.r=N.read_shift(2),L==12&&V.qpro&&(N.l+=2),q.e.c=N.read_shift(2),q.e.r=N.read_shift(2),L==12&&V.qpro&&(N.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function f(N){var L=Tr(8);return L.write_shift(2,N.s.c),L.write_shift(2,N.s.r),L.write_shift(2,N.e.c),L.write_shift(2,N.e.r),L}function m(N,L,V){var q=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(q[0].c=N.read_shift(1),q[3]=N.read_shift(1),q[0].r=N.read_shift(2),N.l+=2):(q[2]=N.read_shift(1),q[0].c=N.read_shift(2),q[0].r=N.read_shift(2)),q}function p(N,L,V){var q=N.l+L,ce=m(N,L,V);if(ce[1].t="s",V.vers==20768){N.l++;var J=N.read_shift(1);return ce[1].v=N.read_shift(J,"utf8"),ce}return V.qpro&&N.l++,ce[1].v=N.read_shift(q-N.l,"cstr"),ce}function v(N,L,V){var q=Tr(7+V.length);q.write_shift(1,255),q.write_shift(2,L),q.write_shift(2,N),q.write_shift(1,39);for(var ce=0;ce<q.length;++ce){var J=V.charCodeAt(ce);q.write_shift(1,J>=128?95:J)}return q.write_shift(1,0),q}function y(N,L,V){var q=m(N,L,V);return q[1].v=N.read_shift(2,"i"),q}function S(N,L,V){var q=Tr(7);return q.write_shift(1,255),q.write_shift(2,L),q.write_shift(2,N),q.write_shift(2,V,"i"),q}function k(N,L,V){var q=m(N,L,V);return q[1].v=N.read_shift(8,"f"),q}function w(N,L,V){var q=Tr(13);return q.write_shift(1,255),q.write_shift(2,L),q.write_shift(2,N),q.write_shift(8,V,"f"),q}function E(N,L,V){var q=N.l+L,ce=m(N,L,V);if(ce[1].v=N.read_shift(8,"f"),V.qpro)N.l=q;else{var J=N.read_shift(2);M(N.slice(N.l,N.l+J),ce),N.l+=J}return ce}function F(N,L,V){var q=L&32768;return L&=-32769,L=(q?N:0)+(L>=8192?L-16384:L),(q?"":"$")+(V?Nr(L):zr(L))}var B={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(N,L){Wr(N,0);for(var V=[],q=0,ce="",J="",he="",Y="";N.l<N.length;){var xe=N[N.l++];switch(xe){case 0:V.push(N.read_shift(8,"f"));break;case 1:J=F(L[0].c,N.read_shift(2),!0),ce=F(L[0].r,N.read_shift(2),!1),V.push(J+ce);break;case 2:{var Pe=F(L[0].c,N.read_shift(2),!0),K=F(L[0].r,N.read_shift(2),!1);J=F(L[0].c,N.read_shift(2),!0),ce=F(L[0].r,N.read_shift(2),!1),V.push(Pe+K+":"+J+ce)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(N.read_shift(2));break;case 6:{for(var Xe="";xe=N[N.l++];)Xe+=String.fromCharCode(xe);V.push('"'+Xe.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:Y=V.pop(),he=V.pop(),V.push(["AND","OR"][xe-20]+"("+he+","+Y+")");break;default:if(xe<32&&C[xe])Y=V.pop(),he=V.pop(),V.push(he+C[xe]+Y);else if(B[xe]){if(q=B[xe][1],q==69&&(q=N[N.l++]),q>V.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+V.join("|")+"|");return}var we=V.slice(-q);V.length-=q,V.push(B[xe][0]+"("+we.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}V.length==1?L[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function re(N){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=N.read_shift(2),L[3]=N[N.l++],L[0].c=N[N.l++],L}function O(N,L){var V=re(N);return V[1].t="s",V[1].v=N.read_shift(L-4,"cstr"),V}function U(N,L,V,q){var ce=Tr(6+q.length);ce.write_shift(2,N),ce.write_shift(1,V),ce.write_shift(1,L),ce.write_shift(1,39);for(var J=0;J<q.length;++J){var he=q.charCodeAt(J);ce.write_shift(1,he>=128?95:he)}return ce.write_shift(1,0),ce}function ee(N,L){var V=re(N);V[1].v=N.read_shift(2);var q=V[1].v>>1;if(V[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return V[1].v=q,V}function I(N,L){var V=re(N),q=N.read_shift(4),ce=N.read_shift(4),J=N.read_shift(2);if(J==65535)return q===0&&ce===3221225472?(V[1].t="e",V[1].v=15):q===0&&ce===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var he=J&32768;return J=(J&32767)-16446,V[1].v=(1-he*2)*(ce*Math.pow(2,J+32)+q*Math.pow(2,J)),V}function ie(N,L,V,q){var ce=Tr(14);if(ce.write_shift(2,N),ce.write_shift(1,V),ce.write_shift(1,L),q==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var J=0,he=0,Y=0,xe=0;return q<0&&(J=1,q=-q),he=Math.log2(q)|0,q/=Math.pow(2,he-31),xe=q>>>0,(xe&2147483648)==0&&(q/=2,++he,xe=q>>>0),q-=xe,xe|=2147483648,xe>>>=0,q*=Math.pow(2,32),Y=q>>>0,ce.write_shift(4,Y),ce.write_shift(4,xe),he+=16383+(J?32768:0),ce.write_shift(2,he),ce}function oe(N,L){var V=I(N);return N.l+=L-14,V}function X(N,L){var V=re(N),q=N.read_shift(4);return V[1].v=q>>6,V}function ae(N,L){var V=re(N),q=N.read_shift(8,"f");return V[1].v=q,V}function fe(N,L){var V=ae(N);return N.l+=L-10,V}function me(N,L){return N[N.l+L-1]==0?N.read_shift(L,"cstr"):""}function Te(N,L){var V=N[N.l++];V>L-1&&(V=L-1);for(var q="";q.length<V;)q+=String.fromCharCode(N[N.l++]);return q}function be(N,L,V){if(!(!V.qpro||L<21)){var q=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var ce=N.read_shift(L-21,"cstr");return[q,ce]}}function le(N,L){for(var V={},q=N.l+L;N.l<q;){var ce=N.read_shift(2);if(ce==14e3){for(V[ce]=[0,""],V[ce][0]=N.read_shift(2);N[N.l];)V[ce][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return V}function te(N,L){var V=Tr(5+N.length);V.write_shift(2,14e3),V.write_shift(2,L);for(var q=0;q<N.length;++q){var ce=N.charCodeAt(q);V[V.l++]=ce>127?95:ce}return V[V.l++]=0,V}var pe={0:{n:"BOF",f:xr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:me},222:{n:"SHEETNAMELP",f:Te},65535:{n:""}},A={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:ee},25:{n:"FORMULA19",f:oe},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:ae},40:{n:"FORMULA28",f:fe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:me},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:be},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:r}})();function Sk(t){var r={},e=t.match(sn),n=0,s=!1;if(e)for(;n!=e.length;++n){var o=lt(e[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;r.cp=lh[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=o.val;break;case"<sz":r.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":o.rgb&&(r.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(o[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+o[0])}}return r}var Ek=(function(){var t=fc("t"),r=fc("rPr");function e(o){var l=o.match(t);if(!l)return{t:"s",v:""};var u={t:"s",v:Ot(l[1])},f=o.match(r);return f&&(u.s=Sk(f[1])),u}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(s).map(e).filter(function(u){return u.v})}})(),kk=(function(){var r=/(\r\n|\n)/g;function e(s,o,l){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),s.b&&(o.push("<b>"),l.push("</b>")),s.i&&(o.push("<i>"),l.push("</i>")),s.strike&&(o.push("<s>"),l.push("</s>"));var f=s.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(o.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),s}function n(s){var o=[[],s.v,[]];return s.v?(s.s&&e(s.s,o[0],o[2]),o[0].join("")+o[1].replace(r,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}})(),Tk=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Nk=/<(?:\w+:)?r>/,Ck=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function kh(t,r){var e=r?r.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ot(Xt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Xt(t),e&&(n.h=gh(n.t))):t.match(Nk)&&(n.r=Xt(t),n.t=Ot(Xt((t.replace(Ck,"").match(Tk)||[]).join("").replace(sn,""))),e&&(n.h=kk(Ek(n.r)))),n):{t:""}}var Ak=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Rk=/<(?:\w+:)?(?:si|sstItem)>/g,Ik=/<\/(?:\w+:)?(?:si|sstItem)>/;function Ok(t,r){var e=[],n="";if(!t)return e;var s=t.match(Ak);if(s){n=s[2].replace(Rk,"").split(Ik);for(var o=0;o!=n.length;++o){var l=kh(n[o].trim(),r);l!=null&&(e[e.length]=l)}s=lt(s[1]),e.Count=s.count,e.Unique=s.uniqueCount}return e}function jk(t){return[t.read_shift(4),t.read_shift(4)]}function Fk(t,r){var e=[],n=!1;return ga(t,function(o,l,u){switch(u){case 159:e.Count=o[0],e.Unique=o[1];break;case 19:e.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),e}function Xv(t){for(var r=[],e=t.split(""),n=0;n<e.length;++n)r[n]=e[n].charCodeAt(0);return r}function da(t,r){var e={};return e.Major=t.read_shift(2),e.Minor=t.read_shift(2),r>=4&&(t.l+=r-4),e}function Dk(t){var r={};return r.id=t.read_shift(0,"lpp4"),r.R=da(t,4),r.U=da(t,4),r.W=da(t,4),r}function Pk(t){for(var r=t.read_shift(4),e=t.l+r-4,n={},s=t.read_shift(4),o=[];s-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=e)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+e);return n}function Lk(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(Pk(t));return r}function Mk(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(t.read_shift(0,"lpp4"));return r}function Uk(t){var r={};return t.read_shift(4),t.l+=4,r.id=t.read_shift(0,"lpp4"),r.name=t.read_shift(0,"lpp4"),r.R=da(t,4),r.U=da(t,4),r.W=da(t,4),r}function $k(t){var r=Uk(t);if(r.ename=t.read_shift(0,"8lpp4"),r.blksz=t.read_shift(4),r.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function qv(t,r){var e=t.l+r,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(e-t.l>>1,"utf16le"),t.l=e,n}function Jv(t,r){var e={},n=t.l+r;return t.l+=4,e.Salt=t.slice(t.l,t.l+16),t.l+=16,e.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),e.VerifierHash=t.slice(t.l,n),t.l=n,e}function Bk(t){var r=da(t);switch(r.Minor){case 2:return[r.Minor,Vk(t)];case 3:return[r.Minor,Wk()];case 4:return[r.Minor,Hk(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function Vk(t){var r=t.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4),n=qv(t,e),s=Jv(t,t.length-t.l);return{t:"Std",h:n,v:s}}function Wk(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Hk(t){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var e=t.read_shift(t.length-t.l,"utf8"),n={};return e.replace(sn,function(o){var l=lt(o);switch(Ms(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function zk(t,r){var e={},n=e.EncryptionVersionInfo=da(t,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);e.Flags=t.read_shift(4),r-=4;var s=t.read_shift(4);return r-=4,e.EncryptionHeader=qv(t,s),r-=s,e.EncryptionVerifier=Jv(t,r),e}function Gk(t){var r={},e=r.EncryptionVersionInfo=da(t,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return r.Salt=t.read_shift(16),r.EncryptedVerifier=t.read_shift(16),r.EncryptedVerifierHash=t.read_shift(16),r}function Kk(t){var r=0,e,n=Xv(t),s=n.length+1,o,l,u,f,m;for(e=Za(s),e[0]=n.length,o=1;o!=s;++o)e[o]=n[o-1];for(o=s-1;o>=0;--o)l=e[o],u=(r&16384)===0?0:1,f=r<<1&32767,m=u|f,r=m^l;return r^52811}var Yv=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},s=function(l,u){return n(l^u)},o=function(l){for(var u=r[l.length-1],f=104,m=l.length-1;m>=0;--m)for(var p=l[m],v=0;v!=7;++v)p&64&&(u^=e[f]),p*=2,--f;return u};return function(l){for(var u=Xv(l),f=o(u),m=u.length,p=Za(16),v=0;v!=16;++v)p[v]=0;var y,S,k;for((m&1)===1&&(y=f>>8,p[m]=s(t[0],y),--m,y=f&255,S=u[u.length-1],p[m]=s(S,y));m>0;)--m,y=f>>8,p[m]=s(u[m],y),--m,y=f&255,p[m]=s(u[m],y);for(m=15,k=15-u.length;k>0;)y=f>>8,p[m]=s(t[k],y),--m,--k,y=f&255,p[m]=s(u[m],y),--m,--k;return p}})(),Xk=function(t,r,e,n,s){s||(s=r),n||(n=Yv(t));var o,l;for(o=0;o!=r.length;++o)l=r[o],l^=n[e],l=(l>>5|l<<3)&255,s[o]=l,++e;return[s,e,n]},qk=function(t){var r=0,e=Yv(t);return function(n){var s=Xk("",n,r,e);return r=s[1],s[0]}};function Jk(t,r,e,n){var s={key:xr(t),verificationBytes:xr(t)};return e.password&&(s.verifier=Kk(e.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=qk(e.password)),s}function Yk(t,r,e){var n=e||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=Gk(t):n.Data=zk(t,r),n}function Qk(t,r,e){var n={Type:e.biff>=8?t.read_shift(2):0};return n.Type?Yk(t,r-2,n):Jk(t,e.biff>=8?r:r-2,e,n),n}var Zk=(function(){function t(s,o){switch(o.type){case"base64":return r(Hn(s),o);case"binary":return r(s,o);case"buffer":return r(_t&&Buffer.isBuffer(s)?s.toString("binary"):Ji(s),o);case"array":return r(zi(s),o)}throw new Error("Unrecognized type "+o.type)}function r(s,o){var l=o||{},u=l.dense?[]:{},f=s.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,v){Array.isArray(u)&&(u[v]=[]);for(var y=/\\\w+\b/g,S=0,k,w=-1;k=y.exec(p);){switch(k[0]){case"\\cell":var E=p.slice(S,y.lastIndex-k[0].length);if(E[0]==" "&&(E=E.slice(1)),++w,E.length){var F={v:E,t:"s"};Array.isArray(u)?u[v][w]=F:u[ht({r:v,c:w})]=F}break}S=y.lastIndex}w>m.e.c&&(m.e.c=w)}),u["!ref"]=Nt(m),u}function e(s,o){return ri(t(s,o),o)}function n(s){for(var o=["{\\rtf1\\ansi"],l=lr(s["!ref"]),u,f=Array.isArray(s),m=l.s.r;m<=l.e.r;++m){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var v=ht({r:m,c:p});u=f?(s[m]||[])[p]:s[v],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(ha(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:n}})();function eT(t){var r=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function gc(t){for(var r=0,e=1;r!=3;++r)e=e*256+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}function tT(t){var r=t[0]/255,e=t[1]/255,n=t[2]/255,s=Math.max(r,e,n),o=Math.min(r,e,n),l=s-o;if(l===0)return[0,0,r];var u=0,f=0,m=s+o;switch(f=l/(m>1?2-m:m),s){case r:u=((e-n)/l+6)%6;break;case e:u=(n-r)/l+2;break;case n:u=(r-e)/l+4;break}return[u/6,f,m/2]}function rT(t){var r=t[0],e=t[1],n=t[2],s=e*2*(n<.5?n:1-n),o=n-s/2,l=[o,o,o],u=6*r,f;if(e!==0)switch(u|0){case 0:case 6:f=s*u,l[0]+=s,l[1]+=f;break;case 1:f=s*(2-u),l[0]+=f,l[1]+=s;break;case 2:f=s*(u-2),l[1]+=s,l[2]+=f;break;case 3:f=s*(4-u),l[1]+=f,l[2]+=s;break;case 4:f=s*(u-4),l[2]+=s,l[0]+=f;break;case 5:f=s*(6-u),l[2]+=f,l[0]+=s;break}for(var m=0;m!=3;++m)l[m]=Math.round(l[m]*255);return l}function dd(t,r){if(r===0)return t;var e=tT(eT(t));return r<0?e[2]=e[2]*(1+r):e[2]=1-(1-e[2])*(1-r),gc(rT(e))}var Qv=6,nT=15,sT=1,xn=Qv;function fd(t){return Math.floor((t+Math.round(128/xn)/256)*xn)}function hd(t){return Math.floor((t-5)/xn*100+.5)/100}function Hf(t){return Math.round((t*xn+5)/xn*256)/256}function wf(t){return Hf(hd(fd(t)))}function Th(t){var r=Math.abs(t-wf(t)),e=xn;if(r>.005)for(xn=sT;xn<nT;++xn)Math.abs(t-wf(t))<=r&&(r=Math.abs(t-wf(t)),e=xn);xn=e}function Zo(t){t.width?(t.wpx=fd(t.width),t.wch=hd(t.wpx),t.MDW=xn):t.wpx?(t.wch=hd(t.wpx),t.width=Hf(t.wch),t.MDW=xn):typeof t.wch=="number"&&(t.width=Hf(t.wch),t.wpx=fd(t.width),t.MDW=xn),t.customWidth&&delete t.customWidth}var aT=96,Zv=aT;function e1(t){return t*96/Zv}function pc(t){return t*Zv/96}var iT={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function oT(t,r,e,n){r.Borders=[];var s={},o=!1;(t[0].match(sn)||[]).forEach(function(l){var u=lt(l);switch(Ms(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=tr(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=tr(u.diagonalDown)),r.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function lT(t,r,e,n){r.Fills=[];var s={},o=!1;(t[0].match(sn)||[]).forEach(function(l){var u=lt(l);switch(Ms(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},r.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function cT(t,r,e,n){r.Fonts=[];var s={},o=!1;(t[0].match(sn)||[]).forEach(function(l){var u=lt(l);switch(Ms(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=Xt(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?tr(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?tr(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?tr(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?tr(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?tr(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?tr(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?tr(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=lh[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=tr(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var f=Wi[s.color.index];s.color.index==81&&(f=Wi[1]),f||(f=Wi[1]),s.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&e.themeElements&&e.themeElements.clrScheme&&(s.color.rgb=dd(e.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function uT(t,r,e){r.NumberFmt=[];for(var n=Ps(gt),s=0;s<n.length;++s)r.NumberFmt[n[s]]=gt[n[s]];var o=t[0].match(sn);if(o)for(s=0;s<o.length;++s){var l=lt(o[s]);switch(Ms(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Ot(Xt(l.formatCode)),f=parseInt(l.numFmtId,10);if(r.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&r.NumberFmt[f]!=null;--f);r.NumberFmt[f]=u}Vi(u,f)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var qu=["numFmtId","fillId","fontId","borderId","xfId"],Ju=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function dT(t,r,e){r.CellXf=[];var n,s=!1;(t[0].match(sn)||[]).forEach(function(o){var l=lt(o),u=0;switch(Ms(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<qu.length;++u)n[qu[u]]&&(n[qu[u]]=parseInt(n[qu[u]],10));for(u=0;u<Ju.length;++u)n[Ju[u]]&&(n[Ju[u]]=tr(n[Ju[u]]));if(r.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[u]){n.numFmtId=u;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=tr(l.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(e&&e.WTF&&!s)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var fT=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,m){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(r))&&uT(v,p,m),(v=u.match(s))&&cT(v,p,f,m),(v=u.match(n))&&lT(v,p,f,m),(v=u.match(o))&&oT(v,p,f,m),(v=u.match(e))&&dT(v,p,m),p}})();function hT(t,r){var e=t.read_shift(2),n=rn(t);return[e,n]}function mT(t,r,e){var n={};n.sz=t.read_shift(2)/20;var s=E2(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(n.underline=l);var u=t.read_shift(1);u>0&&(n.family=u);var f=t.read_shift(1);switch(f>0&&(n.charset=f),t.l++,n.color=S2(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=rn(t),n}var gT=nn;function pT(t,r){var e=t.l+r,n=t.read_shift(2),s=t.read_shift(2);return t.l=e,{ixfe:n,numFmtId:s}}var xT=nn;function vT(t,r,e){var n={};n.NumberFmt=[];for(var s in gt)n.NumberFmt[s]=gt[s];n.CellXf=[],n.Fonts=[];var o=[],l=!1;return ga(t,function(f,m,p){switch(p){case 44:n.NumberFmt[f[0]]=f[1],Vi(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(f.color.rgb=dd(r.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p),l=!0;break;case 38:o.pop(),l=!1;break;default:if(m.T>0)o.push(p);else if(m.T<0)o.pop();else if(!l||e.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}var yT=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function wT(t,r,e){r.themeElements.clrScheme=[];var n={};(t[0].match(sn)||[]).forEach(function(s){var o=lt(s);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(r.themeElements.clrScheme[yT.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function bT(){}function _T(){}var ST=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ET=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,kT=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function TT(t,r,e){r.themeElements={};var n;[["clrScheme",ST,wT],["fontScheme",ET,bT],["fmtScheme",kT,_T]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,r,e)})}var NT=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function t1(t,r){(!t||t.length===0)&&(t=CT());var e,n={};if(!(e=t.match(NT)))throw new Error("themeElements not found in theme");return TT(e[0],n,r),n.raw=t,n}function CT(t,r){var e=[fv];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function AT(t,r,e){var n=t.l+r,s=t.read_shift(4);if(s!==124226){if(!e.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var l;try{l=dv(o,{type:"array"})}catch{return}var u=Wn(l,"theme/theme/theme1.xml",!0);if(u)return t1(u,e)}}function RT(t){return t.read_shift(4)}function IT(t){var r={};switch(r.xclrType=t.read_shift(2),r.nTintShade=t.read_shift(2),r.xclrType){case 0:t.l+=4;break;case 1:r.xclrValue=OT(t,4);break;case 2:r.xclrValue=Bv(t);break;case 3:r.xclrValue=RT(t);break;case 4:t.l+=4;break}return t.l+=8,r}function OT(t,r){return nn(t,r)}function jT(t,r){return nn(t,r)}function FT(t){var r=t.read_shift(2),e=t.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=IT(t);break;case 6:n[1]=jT(t,e);break;case 14:case 15:n[1]=t.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+e)}return n}function DT(t,r){var e=t.l+r;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),o=[];s-- >0;)o.push(FT(t,e-t.l));return{ixfe:n,ext:o}}function PT(t,r){r.forEach(function(e){e[0]})}function LT(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:rn(t)}}function MT(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function UT(t){return t.l+=4,t.read_shift(4)!=0}function $T(t,r,e){var n={Types:[],Cell:[],Value:[]},s=e||{},o=[],l=!1,u=2;return ga(t,function(f,m,p){switch(p){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(v){u==1?n.Cell.push({type:n.Types[v[0]-1].name,index:v[1]}):u==0&&n.Value.push({type:n.Types[v[0]-1].name,index:v[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:o.push(p),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!m.T){if(!l||s.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function BT(t,r,e){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,o=2,l;return t.replace(sn,function(u){var f=lt(u);switch(Ms(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<n.Types.length;++m)n.Types[m].name==f.name&&(l=n.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):o==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!s&&e.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),n}function VT(t){var r=[];if(!t)return r;var e=1;return(t.match(sn)||[]).forEach(function(n){var s=lt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?e=s.i:s.i=e,r.push(s);break}}),r}function WT(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=ht(e);var n=t.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function HT(t,r,e){var n=[];return ga(t,function(o,l,u){switch(u){case 63:n.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function zT(t,r,e,n){if(!t)return t;var s=n||{},o=!1;ga(t,function(u,f,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!f.T){if(!o||s.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},s)}function GT(t,r){if(!t)return"??";var e=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][e].Target}function Wp(t,r,e,n){var s=Array.isArray(t),o;r.forEach(function(l){var u=vn(l.ref);if(s?(t[u.r]||(t[u.r]=[]),o=t[u.r][u.c]):o=t[l.ref],!o){o={t:"z"},s?t[u.r][u.c]=o:t[l.ref]=o;var f=lr(t["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var m=Nt(f);m!==t["!ref"]&&(t["!ref"]=m)}o.c||(o.c=[]);var p={a:l.author,t:l.t,r:l.r,T:e};l.h&&(p.h=l.h);for(var v=o.c.length-1;v>=0;--v){if(!e&&o.c[v].T)return;e&&!o.c[v].T&&o.c.splice(v,1)}if(e&&n){for(v=0;v<n.length;++v)if(p.a==n[v].id){p.a=n[v].name||p.a;break}}o.c.push(p)})}function KT(t,r){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&e.push(u[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=lt(u[0]),m={author:f.authorId&&e[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},p=vn(f.ref);if(!(r.sheetRows&&r.sheetRows<=p.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!v&&!!v[1]&&kh(v[1])||{r:"",t:"",h:""};m.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),m.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(m.h=y.h),n.push(m)}}}}),n}function XT(t,r){var e=[],n=!1,s={},o=0;return t.replace(sn,function(u,f){var m=lt(u);switch(Ms(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":s.t!=null&&e.push(s);break;case"<text>":case"<text":o=f+u.length;break;case"</text>":s.t=t.slice(o,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return u}),e}function qT(t,r){var e=[],n=!1;return t.replace(sn,function(o){var l=lt(o);switch(Ms(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),e}function JT(t){var r={};r.iauthor=t.read_shift(4);var e=Qi(t);return r.rfx=e.s,r.ref=ht(e.s),t.l+=16,r}var YT=rn;function QT(t,r){var e=[],n=[],s={},o=!1;return ga(t,function(u,f,m){switch(m){case 632:n.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,r.sheetRows&&s.rfx&&r.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,e.push(s);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!o||r.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),e}var ZT="application/vnd.ms-office.vbaProject";function eN(t){var r=Tt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(e,n){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var s=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Tt.utils.cfb_add(r,s,t.FileIndex[n].content)}}),Tt.write(r)}function tN(){return{"!type":"dialog"}}function rN(){return{"!type":"dialog"}}function nN(){return{"!type":"macro"}}function sN(){return{"!type":"macro"}}var qo=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(n,s,o,l){var u=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var m=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return u?p+=r.c:--p,f?m+=r.r:--m,s+(u?"":"$")+Nr(p)+(f?"":"$")+zr(m)}return function(s,o){return r=o,s.replace(t,e)}})(),r1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,aN=(function(){return function(r,e){return r.replace(r1,function(n,s,o,l,u,f){var m=yh(l)-(o?0:e.c),p=vh(f)-(u?0:e.r),v=p==0?"":u?p+1:"["+p+"]",y=m==0?"":o?m+1:"["+m+"]";return s+"R"+v+"C"+y})}})();function n1(t,r){return t.replace(r1,function(e,n,s,o,l,u){return n+(s=="$"?s+o:Nr(yh(o)+r.c))+(l=="$"?l+u:zr(vh(u)+r.r))})}function iN(t,r,e){var n=il(r),s=n.s,o=vn(e),l={r:o.r-s.r,c:o.c-s.c};return n1(t,l)}function oN(t){return t.length!=1}function Hp(t){return t.replace(/_xlfn\./g,"")}function gr(t){t.l+=1}function ei(t,r){var e=t.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function s1(t,r,e){var n=2;if(e){if(e.biff>=2&&e.biff<=5)return a1(t);e.biff==12&&(n=4)}var s=t.read_shift(n),o=t.read_shift(n),l=ei(t),u=ei(t);return{s:{r:s,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function a1(t){var r=ei(t),e=ei(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:e[0],c:s,cRel:e[1],rRel:e[2]}}}function lN(t,r,e){if(e.biff<8)return a1(t);var n=t.read_shift(e.biff==12?4:2),s=t.read_shift(e.biff==12?4:2),o=ei(t),l=ei(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function i1(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return cN(t);var n=t.read_shift(e&&e.biff==12?4:2),s=ei(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function cN(t){var r=ei(t),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}function uN(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function dN(t,r,e){var n=e&&e.biff?e.biff:8;if(n>=2&&n<=5)return fN(t);var s=t.read_shift(n>=12?4:2),o=t.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;s>524287;)s-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:s,c:o,cRel:l,rRel:u}}function fN(t){var r=t.read_shift(2),e=t.read_shift(1),n=(r&32768)>>15,s=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),s==1&&e>=128&&(e=e-256),{r,c:e,cRel:s,rRel:n}}function hN(t,r,e){var n=(t[t.l++]&96)>>5,s=s1(t,e.biff>=2&&e.biff<=5?6:8,e);return[n,s]}function mN(t,r,e){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var l=s1(t,o,e);return[n,s,l]}function gN(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[n]}function pN(t,r,e){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,s]}function xN(t,r,e){var n=(t[t.l++]&96)>>5,s=lN(t,r-1,e);return[n,s]}function vN(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[n]}function zp(t){var r=t[t.l+1]&1,e=1;return t.l+=4,[r,e]}function yN(t,r,e){t.l+=2;for(var n=t.read_shift(e&&e.biff==2?1:2),s=[],o=0;o<=n;++o)s.push(t.read_shift(e&&e.biff==2?1:2));return s}function wN(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function bN(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function _N(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function SN(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[n]}function o1(t){var r=t.read_shift(1),e=t.read_shift(1);return[r,e]}function EN(t){return t.read_shift(2),o1(t)}function kN(t){return t.read_shift(2),o1(t)}function TN(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var s=i1(t,0,e);return[n,s]}function NN(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var s=dN(t,0,e);return[n,s]}function CN(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var o=i1(t,0,e);return[n,s,o]}function AN(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(e&&e.biff<=3?1:2);return[RC[s],u1[s],n]}function RN(t,r,e){var n=t[t.l++],s=t.read_shift(1),o=e&&e.biff<=3?[n==88?-1:0,t.read_shift(1)]:IN(t);return[s,(o[0]===0?u1:AC)[o[1]]]}function IN(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function ON(t,r,e){t.l+=e&&e.biff==2?3:4}function jN(t,r,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(e&&e.biff==2?1:2);return[n,s]}function FN(t){return t.l++,Zi[t.read_shift(1)]}function DN(t){return t.l++,t.read_shift(2)}function PN(t){return t.l++,t.read_shift(1)!==0}function LN(t){return t.l++,en(t)}function MN(t,r,e){return t.l++,Ec(t,r-1,e)}function UN(t,r){var e=[t.read_shift(1)];if(r==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=ur(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:e[1]=Zi[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=en(t);break;case 2:e[1]=eo(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function $N(t,r,e){for(var n=t.read_shift(e.biff==12?4:2),s=[],o=0;o!=n;++o)s.push((e.biff==12?Qi:wd)(t));return s}function BN(t,r,e){var n=0,s=0;e.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--n,--s==0&&(s=256));for(var o=0,l=[];o!=n&&(l[o]=[]);++o)for(var u=0;u!=s;++u)l[o][u]=UN(t,e.biff);return l}function VN(t,r,e){var n=t.read_shift(1)>>>5&3,s=!e||e.biff>=8?4:2,o=t.read_shift(s);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function WN(t,r,e){if(e.biff==5)return HN(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),o=t.read_shift(4);return[n,s,o]}function HN(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[r,e,n]}function zN(t,r,e){var n=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var s=t.read_shift(e&&e.biff==2?1:2);return[n,s]}function GN(t,r,e){var n=t.read_shift(1)>>>5&3,s=t.read_shift(e&&e.biff==2?1:2);return[n,s]}function KN(t,r,e){var n=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[n]}function XN(t,r,e){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),o=4;if(e)switch(e.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,s]}var qN=nn,JN=nn,YN=nn;function Tc(t,r,e){return t.l+=2,[uN(t)]}function Nh(t){return t.l+=6,[]}var QN=Tc,ZN=Nh,eC=Nh,tC=Tc;function l1(t){return t.l+=2,[xr(t),t.read_shift(2)&1]}var rC=Tc,nC=l1,sC=Nh,aC=Tc,iC=Tc,oC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function lC(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),o=t.read_shift(2),l=oC[e>>2&31];return{ixti:r,coltype:e&3,rt:l,idx:n,c:s,C:o}}function cC(t){return t.l+=2,[t.read_shift(4)]}function uC(t,r,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function dC(t,r,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function fC(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function hC(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function mC(t){return t.l+=4,[0,0]}var Gp={1:{n:"PtgExp",f:jN},2:{n:"PtgTbl",f:YN},3:{n:"PtgAdd",f:gr},4:{n:"PtgSub",f:gr},5:{n:"PtgMul",f:gr},6:{n:"PtgDiv",f:gr},7:{n:"PtgPower",f:gr},8:{n:"PtgConcat",f:gr},9:{n:"PtgLt",f:gr},10:{n:"PtgLe",f:gr},11:{n:"PtgEq",f:gr},12:{n:"PtgGe",f:gr},13:{n:"PtgGt",f:gr},14:{n:"PtgNe",f:gr},15:{n:"PtgIsect",f:gr},16:{n:"PtgUnion",f:gr},17:{n:"PtgRange",f:gr},18:{n:"PtgUplus",f:gr},19:{n:"PtgUminus",f:gr},20:{n:"PtgPercent",f:gr},21:{n:"PtgParen",f:gr},22:{n:"PtgMissArg",f:gr},23:{n:"PtgStr",f:MN},26:{n:"PtgSheet",f:uC},27:{n:"PtgEndSheet",f:dC},28:{n:"PtgErr",f:FN},29:{n:"PtgBool",f:PN},30:{n:"PtgInt",f:DN},31:{n:"PtgNum",f:LN},32:{n:"PtgArray",f:vN},33:{n:"PtgFunc",f:AN},34:{n:"PtgFuncVar",f:RN},35:{n:"PtgName",f:VN},36:{n:"PtgRef",f:TN},37:{n:"PtgArea",f:hN},38:{n:"PtgMemArea",f:zN},39:{n:"PtgMemErr",f:qN},40:{n:"PtgMemNoMem",f:JN},41:{n:"PtgMemFunc",f:GN},42:{n:"PtgRefErr",f:KN},43:{n:"PtgAreaErr",f:gN},44:{n:"PtgRefN",f:NN},45:{n:"PtgAreaN",f:xN},46:{n:"PtgMemAreaN",f:fC},47:{n:"PtgMemNoMemN",f:hC},57:{n:"PtgNameX",f:WN},58:{n:"PtgRef3d",f:CN},59:{n:"PtgArea3d",f:mN},60:{n:"PtgRefErr3d",f:XN},61:{n:"PtgAreaErr3d",f:pN},255:{}},gC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},pC={1:{n:"PtgElfLel",f:l1},2:{n:"PtgElfRw",f:aC},3:{n:"PtgElfCol",f:QN},6:{n:"PtgElfRwV",f:iC},7:{n:"PtgElfColV",f:tC},10:{n:"PtgElfRadical",f:rC},11:{n:"PtgElfRadicalS",f:sC},13:{n:"PtgElfColS",f:ZN},15:{n:"PtgElfColSV",f:eC},16:{n:"PtgElfRadicalLel",f:nC},25:{n:"PtgList",f:lC},29:{n:"PtgSxName",f:cC},255:{}},xC={0:{n:"PtgAttrNoop",f:mC},1:{n:"PtgAttrSemi",f:SN},2:{n:"PtgAttrIf",f:bN},4:{n:"PtgAttrChoose",f:yN},8:{n:"PtgAttrGoto",f:wN},16:{n:"PtgAttrSum",f:ON},32:{n:"PtgAttrBaxcel",f:zp},33:{n:"PtgAttrBaxcel",f:zp},64:{n:"PtgAttrSpace",f:EN},65:{n:"PtgAttrSpaceSemi",f:kN},128:{n:"PtgAttrIfError",f:_N},255:{}};function Nc(t,r,e,n){if(n.biff<8)return nn(t,r);for(var s=t.l+r,o=[],l=0;l!==e.length;++l)switch(e[l][0]){case"PtgArray":e[l][1]=BN(t,0,n),o.push(e[l][1]);break;case"PtgMemArea":e[l][2]=$N(t,e[l][1],n),o.push(e[l][2]);break;case"PtgExp":n&&n.biff==12&&(e[l][1][1]=t.read_shift(4),o.push(e[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[l][0]}return r=s-t.l,r!==0&&o.push(nn(t,r)),o}function Cc(t,r,e){for(var n=t.l+r,s,o,l=[];n!=t.l;)r=n-t.l,o=t[t.l],s=Gp[o]||Gp[gC[o]],(o===24||o===25)&&(s=(o===24?pC:xC)[t[t.l+1]]),!s||!s.f?nn(t,r):l.push([s.n,s.f(t,r,e)]);return l}function vC(t){for(var r=[],e=0;e<t.length;++e){for(var n=t[e],s=[],o=0;o<n.length;++o){var l=n[o];if(l)switch(l[0]){case 2:s.push('"'+l[1].replace(/"/g,'""')+'"');break;default:s.push(l[1])}else s.push("")}r.push(s.join(","))}return r.join(";")}var yC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function wC(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function c1(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!n)return"SH33TJSERR1";var s="";if(e.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Kp(t,r,e){var n=c1(t,r,e);return n=="#REF"?n:wC(n,e)}function Zr(t,r,e,n,s){var o=s&&s.biff||8,l={s:{c:0,r:0}},u=[],f,m,p,v=0,y=0,S,k="";if(!t[0]||!t[0][0])return"";for(var w=-1,E="",F=0,B=t[0].length;F<B;++F){var C=t[0][F];switch(C[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),m=u.pop(),w>=0){switch(t[0][w][1][0]){case 0:E=or(" ",t[0][w][1][1]);break;case 1:E=or("\r",t[0][w][1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}m=m+E,w=-1}u.push(m+yC[C[0]]+f);break;case"PtgIsect":f=u.pop(),m=u.pop(),u.push(m+" "+f);break;case"PtgUnion":f=u.pop(),m=u.pop(),u.push(m+","+f);break;case"PtgRange":f=u.pop(),m=u.pop(),u.push(m+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=ec(C[1][1],l,s),u.push(tc(p,o));break;case"PtgRefN":p=e?ec(C[1][1],e,s):C[1][1],u.push(tc(p,o));break;case"PtgRef3d":v=C[1][1],p=ec(C[1][2],l,s),k=Kp(n,v,s),u.push(k+"!"+tc(p,o));break;case"PtgFunc":case"PtgFuncVar":var M=C[1][0],re=C[1][1];M||(M=0),M&=127;var O=M==0?[]:u.slice(-M);u.length-=M,re==="User"&&(re=O.shift()),u.push(re+"("+O.join(",")+")");break;case"PtgBool":u.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(C[1]);break;case"PtgNum":u.push(String(C[1]));break;case"PtgStr":u.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(C[1]);break;case"PtgAreaN":S=Np(C[1][1],e?{s:e}:l,s),u.push(vf(S,s));break;case"PtgArea":S=Np(C[1][1],l,s),u.push(vf(S,s));break;case"PtgArea3d":v=C[1][1],S=C[1][2],k=Kp(n,v,s),u.push(k+"!"+vf(S,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=C[1][2];var U=(n.names||[])[y-1]||(n[0]||[])[y],ee=U?U.Name:"SH33TJSNAME"+String(y);ee&&ee.slice(0,6)=="_xlfn."&&!s.xlfn&&(ee=ee.slice(6)),u.push(ee);break;case"PtgNameX":var I=C[1][1];y=C[1][2];var ie;if(s.biff<=5)I<0&&(I=-I),n[I]&&(ie=n[I][y]);else{var oe="";if(((n[I]||[])[0]||[])[0]==14849||(((n[I]||[])[0]||[])[0]==1025?n[I][y]&&n[I][y].itab>0&&(oe=n.SheetNames[n[I][y].itab-1]+"!"):oe=n.SheetNames[y-1]+"!"),n[I]&&n[I][y])oe+=n[I][y].Name;else if(n[0]&&n[0][y])oe+=n[0][y].Name;else{var X=(c1(n,I,s)||"").split(";;");X[y-1]?oe=X[y-1]:oe+="SH33TJSERRX"}u.push(oe);break}ie||(ie={Name:"SH33TJSERRY"}),u.push(ie.Name);break;case"PtgParen":var ae="(",fe=")";if(w>=0){switch(E="",t[0][w][1][0]){case 2:ae=or(" ",t[0][w][1][1])+ae;break;case 3:ae=or("\r",t[0][w][1][1])+ae;break;case 4:fe=or(" ",t[0][w][1][1])+fe;break;case 5:fe=or("\r",t[0][w][1][1])+fe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}w=-1}u.push(ae+u.pop()+fe);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:C[1][1],r:C[1][0]};var me={c:e.c,r:e.r};if(n.sharedf[ht(p)]){var Te=n.sharedf[ht(p)];u.push(Zr(Te,l,me,n,s))}else{var be=!1;for(f=0;f!=n.arrayf.length;++f)if(m=n.arrayf[f],!(p.c<m[0].s.c||p.c>m[0].e.c)&&!(p.r<m[0].s.r||p.r>m[0].e.r)){u.push(Zr(m[1],l,me,n,s)),be=!0;break}be||u.push(C[1])}break;case"PtgArray":u.push("{"+vC(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=F;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&w>=0&&le.indexOf(t[0][F][0])==-1){C=t[0][w];var te=!0;switch(C[1][0]){case 4:te=!1;case 0:E=or(" ",C[1][1]);break;case 5:te=!1;case 1:E=or("\r",C[1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}u.push((te?E:"")+u.pop()+(te?"":E)),w=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function bC(t,r,e){var n=t.l+r,s=e.biff==2?1:2,o,l=t.read_shift(s);if(l==65535)return[[],nn(t,r-2)];var u=Cc(t,l,e);return r!==l+s&&(o=Nc(t,r-l-s,u,e)),t.l=n,[u,o]}function _C(t,r,e){var n=t.l+r,s=e.biff==2?1:2,o,l=t.read_shift(s);if(l==65535)return[[],nn(t,r-2)];var u=Cc(t,l,e);return r!==l+s&&(o=Nc(t,r-l-s,u,e)),t.l=n,[u,o]}function SC(t,r,e,n){var s=t.l+r,o=Cc(t,n,e),l;return s!==t.l&&(l=Nc(t,s-t.l,o,e)),[o,l]}function EC(t,r,e){var n=t.l+r,s,o=t.read_shift(2),l=Cc(t,o,e);return o==65535?[[],nn(t,r-2)]:(r!==o+2&&(s=Nc(t,n-o-2,l,e)),[l,s])}function kC(t){var r;if(la(t,t.l+6)!==65535)return[en(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return r=t[t.l+2]===1,t.l+=8,[r,"b"];case 2:return r=t[t.l+2],t.l+=8,[r,"e"];case 3:return t.l+=8,["","s"]}return[]}function bf(t,r,e){var n=t.l+r,s=Us(t);e.biff==2&&++t.l;var o=kC(t),l=t.read_shift(1);e.biff!=2&&(t.read_shift(1),e.biff>=5&&t.read_shift(4));var u=_C(t,n-t.l,e);return{cell:s,val:o[0],formula:u,shared:l>>3&1,tt:o[1]}}function bd(t,r,e){var n=t.read_shift(4),s=Cc(t,n,e),o=t.read_shift(4),l=o>0?Nc(t,o,s,e):null;return[s,l]}var TC=bd,_d=bd,NC=bd,CC=bd,AC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},u1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},RC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Xp(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,e){return e.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function _f(t){var r=t.split(":"),e=r[0].split(".")[0];return[e,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var ac={},Jo={};function ic(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function d1(t,r,e,n,s,o){try{n.cellNF&&(t.z=gt[r])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Fr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(gt[r]==null&&Vi(IS[r]||"General",r),t.t==="e")t.w=t.w||Zi[t.v];else if(r===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=dc(t.v);else if(t.t==="d"){var l=wn(t.v);(l|0)===l?t.w=l.toString(10):t.w=dc(l)}else{if(t.v===void 0)return"";t.w=Hi(t.v,Jo)}else t.t==="d"?t.w=rs(r,wn(t.v),Jo):t.w=rs(r,t.v,Jo)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&e!=null)try{t.s=o.Fills[e],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=dd(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=dd(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function IC(t,r){var e=lr(r);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(t["!ref"]=Nt(e))}var OC=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,jC=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,FC=/<(?:\w:)?hyperlink [^>]*>/mg,DC=/"(\w*:\w*)"/,PC=/<(?:\w:)?col\b[^>]*[\/]?>/g,LC=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,MC=/<(?:\w:)?pageMargins[^>]*\/>/g,f1=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,UC=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,$C=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function BC(t,r,e,n,s,o,l){if(!t)return t;n||(n={"!id":{}});var u=r.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",p="",v=t.match(jC);v?(m=t.slice(0,v.index),p=t.slice(v.index+v[0].length)):m=p=t;var y=m.match(f1);y?Ch(y[0],u,s,e):(y=m.match(UC))&&VC(y[0],y[1]||"",u,s,e);var S=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(S>0){var k=m.slice(S,S+50).match(DC);k&&IC(u,k[1])}var w=m.match($C);w&&w[1]&&XC(w[1],s);var E=[];if(r.cellStyles){var F=m.match(PC);F&&zC(E,F)}v&&qC(v[1],u,r,f,o,l);var B=p.match(LC);B&&(u["!autofilter"]=GC(B[0]));var C=[],M=p.match(OC);if(M)for(S=0;S!=M.length;++S)C[S]=lr(M[S].slice(M[S].indexOf('"')+1));var re=p.match(FC);re&&WC(u,re,n);var O=p.match(MC);if(O&&(u["!margins"]=HC(lt(O[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=Nt(f)),r.sheetRows>0&&u["!ref"]){var U=lr(u["!ref"]);r.sheetRows<=+U.e.r&&(U.e.r=r.sheetRows-1,U.e.r>f.e.r&&(U.e.r=f.e.r),U.e.r<U.s.r&&(U.s.r=U.e.r),U.e.c>f.e.c&&(U.e.c=f.e.c),U.e.c<U.s.c&&(U.s.c=U.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Nt(U))}return E.length>0&&(u["!cols"]=E),C.length>0&&(u["!merges"]=C),u}function Ch(t,r,e,n){var s=lt(t);e.Sheets[n]||(e.Sheets[n]={}),s.codeName&&(e.Sheets[n].CodeName=Ot(Xt(s.codeName)))}function VC(t,r,e,n,s){Ch(t.slice(0,t.indexOf(">")),e,n,s)}function WC(t,r,e){for(var n=Array.isArray(t),s=0;s!=r.length;++s){var o=lt(Xt(r[s]),!0);if(!o.ref)return;var l=((e||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Ot(o.location))):(o.Target="#"+Ot(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=lr(o.ref),f=u.s.r;f<=u.e.r;++f)for(var m=u.s.c;m<=u.e.c;++m){var p=ht({c:m,r:f});n?(t[f]||(t[f]=[]),t[f][m]||(t[f][m]={t:"z",v:void 0}),t[f][m].l=o):(t[p]||(t[p]={t:"z",v:void 0}),t[p].l=o)}}}function HC(t){var r={};return["left","right","top","bottom","header","footer"].forEach(function(e){t[e]&&(r[e]=parseFloat(t[e]))}),r}function zC(t,r){for(var e=!1,n=0;n!=r.length;++n){var s=lt(r[n],!0);s.hidden&&(s.hidden=tr(s.hidden));var o=parseInt(s.min,10)-1,l=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!e&&s.width&&(e=!0,Th(s.width)),Zo(s);o<=l;)t[o++]=Hr(s)}}function GC(t){var r={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return r}var KC=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function XC(t,r){r.Views||(r.Views=[{}]),(t.match(KC)||[]).forEach(function(e,n){var s=lt(e);r.Views[n]||(r.Views[n]={}),+s.zoomScale&&(r.Views[n].zoom=+s.zoomScale),tr(s.rightToLeft)&&(r.Views[n].RTL=!0)})}var qC=(function(){var t=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,o=fc("v"),l=fc("f");return function(f,m,p,v,y,S){for(var k=0,w="",E=[],F=[],B=0,C=0,M=0,re="",O,U,ee=0,I=0,ie,oe,X=0,ae=0,fe=Array.isArray(S.CellXf),me,Te=[],be=[],le=Array.isArray(m),te=[],pe={},A=!1,N=!!p.sheetStubs,L=f.split(r),V=0,q=L.length;V!=q;++V){w=L[V].trim();var ce=w.length;if(ce!==0){var J=0;e:for(k=0;k<ce;++k)switch(w[k]){case">":if(w[k-1]!="/"){++k;break e}if(p&&p.cellStyles){if(U=lt(w.slice(J,k),!0),ee=U.r!=null?parseInt(U.r,10):ee+1,I=-1,p.sheetRows&&p.sheetRows<ee)continue;pe={},A=!1,U.ht&&(A=!0,pe.hpt=parseFloat(U.ht),pe.hpx=pc(pe.hpt)),U.hidden=="1"&&(A=!0,pe.hidden=!0),U.outlineLevel!=null&&(A=!0,pe.level=+U.outlineLevel),A&&(te[ee-1]=pe)}break;case"<":J=k;break}if(J>=k)break;if(U=lt(w.slice(J,k),!0),ee=U.r!=null?parseInt(U.r,10):ee+1,I=-1,!(p.sheetRows&&p.sheetRows<ee)){v.s.r>ee-1&&(v.s.r=ee-1),v.e.r<ee-1&&(v.e.r=ee-1),p&&p.cellStyles&&(pe={},A=!1,U.ht&&(A=!0,pe.hpt=parseFloat(U.ht),pe.hpx=pc(pe.hpt)),U.hidden=="1"&&(A=!0,pe.hidden=!0),U.outlineLevel!=null&&(A=!0,pe.level=+U.outlineLevel),A&&(te[ee-1]=pe)),E=w.slice(k).split(t);for(var he=0;he!=E.length&&E[he].trim().charAt(0)=="<";++he);for(E=E.slice(he),k=0;k!=E.length;++k)if(w=E[k].trim(),w.length!==0){if(F=w.match(e),B=k,C=0,M=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,F!=null&&F.length===2){for(B=0,re=F[1],C=0;C!=re.length&&!((M=re.charCodeAt(C)-64)<1||M>26);++C)B=26*B+M;--B,I=B}else++I;for(C=0;C!=w.length&&w.charCodeAt(C)!==62;++C);if(++C,U=lt(w.slice(0,C),!0),U.r||(U.r=ht({r:ee-1,c:I})),re=w.slice(C),O={t:""},(F=re.match(o))!=null&&F[1]!==""&&(O.v=Ot(F[1])),p.cellFormula){if((F=re.match(l))!=null&&F[1]!==""){if(O.f=Ot(Xt(F[1])).replace(/\r\n/g,`
`),p.xlfn||(O.f=Hp(O.f)),F[0].indexOf('t="array"')>-1)O.F=(re.match(s)||[])[1],O.F.indexOf(":")>-1&&Te.push([lr(O.F),O.F]);else if(F[0].indexOf('t="shared"')>-1){oe=lt(F[0]);var Y=Ot(Xt(F[1]));p.xlfn||(Y=Hp(Y)),be[parseInt(oe.si,10)]=[oe,Y,U.r]}}else(F=re.match(/<f[^>]*\/>/))&&(oe=lt(F[0]),be[oe.si]&&(O.f=iN(be[oe.si][1],be[oe.si][2],U.r)));var xe=vn(U.r);for(C=0;C<Te.length;++C)xe.r>=Te[C][0].s.r&&xe.r<=Te[C][0].e.r&&xe.c>=Te[C][0].s.c&&xe.c<=Te[C][0].e.c&&(O.F=Te[C][1])}if(U.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(N)O.t="z";else continue;else O.t=U.t||"n";switch(v.s.c>I&&(v.s.c=I),v.e.c<I&&(v.e.c=I),O.t){case"n":if(O.v==""||O.v==null){if(!N)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!N)continue;O.t="z"}else ie=ac[parseInt(O.v,10)],O.v=ie.t,O.r=ie.r,p.cellHTML&&(O.h=ie.h);break;case"str":O.t="s",O.v=O.v!=null?Xt(O.v):"",p.cellHTML&&(O.h=gh(O.v));break;case"inlineStr":F=re.match(n),O.t="s",F!=null&&(ie=kh(F[1]))?(O.v=ie.t,p.cellHTML&&(O.h=ie.h)):O.v="";break;case"b":O.v=tr(O.v);break;case"d":p.cellDates?O.v=Fr(O.v,1):(O.v=wn(Fr(O.v,1)),O.t="n");break;case"e":(!p||p.cellText!==!1)&&(O.w=O.v),O.v=jv[O.v];break}if(X=ae=0,me=null,fe&&U.s!==void 0&&(me=S.CellXf[U.s],me!=null&&(me.numFmtId!=null&&(X=me.numFmtId),p.cellStyles&&me.fillId!=null&&(ae=me.fillId))),d1(O,X,ae,p,y,S),p.cellDates&&fe&&O.t=="n"&&al(gt[X])&&(O.t="d",O.v=yd(O.v)),U.cm&&p.xlmeta){var Pe=(p.xlmeta.Cell||[])[+U.cm-1];Pe&&Pe.type=="XLDAPR"&&(O.D=!0)}if(le){var K=vn(U.r);m[K.r]||(m[K.r]=[]),m[K.r][K.c]=O}else m[U.r]=O}}}}te.length>0&&(m["!rows"]=te)}})();function JC(t,r){var e={},n=t.l+r;e.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(e.level=o&7),o&16&&(e.hidden=!0),o&32&&(e.hpt=s/20),e}var YC=Qi;function QC(){}function ZC(t,r){var e={},n=t[t.l];return++t.l,e.above=!(n&64),e.left=!(n&128),t.l+=18,e.name=b2(t),e}function e4(t){var r=ns(t);return[r]}function t4(t){var r=Yi(t);return[r]}function r4(t){var r=ns(t),e=t.read_shift(1);return[r,e,"b"]}function n4(t){var r=Yi(t),e=t.read_shift(1);return[r,e,"b"]}function s4(t){var r=ns(t),e=t.read_shift(1);return[r,e,"e"]}function a4(t){var r=Yi(t),e=t.read_shift(1);return[r,e,"e"]}function i4(t){var r=ns(t),e=t.read_shift(4);return[r,e,"s"]}function o4(t){var r=Yi(t),e=t.read_shift(4);return[r,e,"s"]}function l4(t){var r=ns(t),e=en(t);return[r,e,"n"]}function h1(t){var r=Yi(t),e=en(t);return[r,e,"n"]}function c4(t){var r=ns(t),e=_h(t);return[r,e,"n"]}function u4(t){var r=Yi(t),e=_h(t);return[r,e,"n"]}function d4(t){var r=ns(t),e=wh(t);return[r,e,"is"]}function f4(t){var r=ns(t),e=rn(t);return[r,e,"str"]}function h4(t){var r=Yi(t),e=rn(t);return[r,e,"str"]}function m4(t,r,e){var n=t.l+r,s=ns(t);s.r=e["!row"];var o=t.read_shift(1),l=[s,o,"b"];if(e.cellFormula){t.l+=2;var u=_d(t,n-t.l,e);l[3]=Zr(u,null,s,e.supbooks,e)}else t.l=n;return l}function g4(t,r,e){var n=t.l+r,s=ns(t);s.r=e["!row"];var o=t.read_shift(1),l=[s,o,"e"];if(e.cellFormula){t.l+=2;var u=_d(t,n-t.l,e);l[3]=Zr(u,null,s,e.supbooks,e)}else t.l=n;return l}function p4(t,r,e){var n=t.l+r,s=ns(t);s.r=e["!row"];var o=en(t),l=[s,o,"n"];if(e.cellFormula){t.l+=2;var u=_d(t,n-t.l,e);l[3]=Zr(u,null,s,e.supbooks,e)}else t.l=n;return l}function x4(t,r,e){var n=t.l+r,s=ns(t);s.r=e["!row"];var o=rn(t),l=[s,o,"str"];if(e.cellFormula){t.l+=2;var u=_d(t,n-t.l,e);l[3]=Zr(u,null,s,e.supbooks,e)}else t.l=n;return l}var v4=Qi;function y4(t,r){var e=t.l+r,n=Qi(t),s=bh(t),o=rn(t),l=rn(t),u=rn(t);t.l=e;var f={rfx:n,relId:s,loc:o,display:u};return l&&(f.Tooltip=l),f}function w4(){}function b4(t,r,e){var n=t.l+r,s=Rv(t),o=t.read_shift(1),l=[s];if(l[2]=o,e.cellFormula){var u=TC(t,n-t.l,e);l[1]=u}else t.l=n;return l}function _4(t,r,e){var n=t.l+r,s=Qi(t),o=[s];if(e.cellFormula){var l=CC(t,n-t.l,e);o[1]=l,t.l=n}else t.l=n;return o}var S4=["left","right","top","bottom","header","footer"];function E4(t){var r={};return S4.forEach(function(e){r[e]=en(t)}),r}function k4(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function T4(){}function N4(){}function C4(t,r,e,n,s,o,l){if(!t)return t;var u=r||{};n||(n={"!id":{}});var f=u.dense?[]:{},m,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,y=!1,S,k,w,E,F,B,C,M,re,O=[];u.biff=12,u["!row"]=0;var U=0,ee=!1,I=[],ie={},oe=u.supbooks||s.supbooks||[[]];if(oe.sharedf=ie,oe.arrayf=I,oe.SheetNames=s.SheetNames||s.Sheets.map(function(le){return le.name}),!u.supbooks&&(u.supbooks=oe,s.Names))for(var X=0;X<s.Names.length;++X)oe[0][X+1]=s.Names[X];var ae=[],fe=[],me=!1;md[16]={n:"BrtShortReal",f:h1};var Te;if(ga(t,function(te,pe,A){if(!y)switch(A){case 148:m=te;break;case 0:S=te,u.sheetRows&&u.sheetRows<=S.r&&(y=!0),M=zr(E=S.r),u["!row"]=S.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=pc(te.hpt)),fe[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:te[2]},te[2]){case"n":k.v=te[1];break;case"s":C=ac[te[1]],k.v=C.t,k.r=C.r;break;case"b":k.v=!!te[1];break;case"e":k.v=te[1],u.cellText!==!1&&(k.w=Zi[k.v]);break;case"str":k.t="s",k.v=te[1];break;case"is":k.t="s",k.v=te[1].t;break}if((w=l.CellXf[te[0].iStyleRef])&&d1(k,w.numFmtId,null,u,o,l),F=te[0].c==-1?F+1:te[0].c,u.dense?(f[E]||(f[E]=[]),f[E][F]=k):f[Nr(F)+M]=k,u.cellFormula){for(ee=!1,U=0;U<I.length;++U){var N=I[U];S.r>=N[0].s.r&&S.r<=N[0].e.r&&F>=N[0].s.c&&F<=N[0].e.c&&(k.F=Nt(N[0]),ee=!0)}!ee&&te.length>3&&(k.f=te[3])}if(p.s.r>S.r&&(p.s.r=S.r),p.s.c>F&&(p.s.c=F),p.e.r<S.r&&(p.e.r=S.r),p.e.c<F&&(p.e.c=F),u.cellDates&&w&&k.t=="n"&&al(gt[w.numFmtId])){var L=Bi(k.v);L&&(k.t="d",k.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}Te&&(Te.type=="XLDAPR"&&(k.D=!0),Te=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;k={t:"z",v:void 0},F=te[0].c==-1?F+1:te[0].c,u.dense?(f[E]||(f[E]=[]),f[E][F]=k):f[Nr(F)+M]=k,p.s.r>S.r&&(p.s.r=S.r),p.s.c>F&&(p.s.c=F),p.e.r<S.r&&(p.e.r=S.r),p.e.c<F&&(p.e.c=F),Te&&(Te.type=="XLDAPR"&&(k.D=!0),Te=void 0);break;case 176:O.push(te);break;case 49:Te=((u.xlmeta||{}).Cell||[])[te-1];break;case 494:var V=n["!id"][te.relId];for(V?(te.Target=V.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=V):te.relId==""&&(te.Target="#"+te.loc),E=te.rfx.s.r;E<=te.rfx.e.r;++E)for(F=te.rfx.s.c;F<=te.rfx.e.c;++F)u.dense?(f[E]||(f[E]=[]),f[E][F]||(f[E][F]={t:"z",v:void 0}),f[E][F].l=te):(B=ht({c:F,r:E}),f[B]||(f[B]={t:"z",v:void 0}),f[B].l=te);break;case 426:if(!u.cellFormula)break;I.push(te),re=u.dense?f[E][F]:f[Nr(F)+M],re.f=Zr(te[1],p,{r:S.r,c:F},oe,u),re.F=Nt(te[0]);break;case 427:if(!u.cellFormula)break;ie[ht(te[0].s)]=te[1],re=u.dense?f[E][F]:f[Nr(F)+M],re.f=Zr(te[1],p,{r:S.r,c:F},oe,u);break;case 60:if(!u.cellStyles)break;for(;te.e>=te.s;)ae[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},me||(me=!0,Th(te.w/256)),Zo(ae[te.e+1]);break;case 161:f["!autofilter"]={ref:Nt(te)};break;case 476:f["!margins"]=te;break;case 147:s.Sheets[e]||(s.Sheets[e]={}),te.name&&(s.Sheets[e].CodeName=te.name),(te.above||te.left)&&(f["!outline"]={above:te.above,left:te.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),te.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!pe.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(p.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(f["!ref"]=Nt(m||p)),u.sheetRows&&f["!ref"]){var be=lr(f["!ref"]);u.sheetRows<=+be.e.r&&(be.e.r=u.sheetRows-1,be.e.r>p.e.r&&(be.e.r=p.e.r),be.e.r<be.s.r&&(be.s.r=be.e.r),be.e.c>p.e.c&&(be.e.c=p.e.c),be.e.c<be.s.c&&(be.s.c=be.e.c),f["!fullref"]=f["!ref"],f["!ref"]=Nt(be))}return O.length>0&&(f["!merges"]=O),ae.length>0&&(f["!cols"]=ae),fe.length>0&&(f["!rows"]=fe),f}function A4(t){var r=[],e=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(r[+l[1]]=e?+l[2]:l[2])});var s=Ot((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[r,s,n]}function R4(t,r,e,n,s,o){var l=o||{"!type":"chart"};if(!t)return o;var u=0,f=0,m="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var y=A4(v);p.s.r=p.s.c=0,p.e.c=u,m=Nr(u),y[0].forEach(function(S,k){l[m+zr(k)]={t:"n",v:S,z:y[1]},f=k}),p.e.r<f&&(p.e.r=f),++u}),u>0&&(l["!ref"]=Nt(p)),l}function I4(t,r,e,n,s){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,u=t.match(f1);return u&&Ch(u[0],o,s,e),(l=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function O4(t,r){t.l+=10;var e=rn(t);return{name:e}}function j4(t,r,e,n,s){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ga(t,function(f,m,p){switch(p){case 550:o["!rel"]=f;break;case 651:s.Sheets[e]||(s.Sheets[e]={}),f.name&&(s.Sheets[e].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!l||r.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},r),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var m1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],F4=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],D4=[],P4=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function qp(t,r){for(var e=0;e!=t.length;++e)for(var n=t[e],s=0;s!=r.length;++s){var o=r[s];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=tr(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function Jp(t,r){for(var e=0;e!=r.length;++e){var n=r[e];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=tr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function g1(t){Jp(t.WBProps,m1),Jp(t.CalcPr,P4),qp(t.WBView,F4),qp(t.Sheets,D4),Jo.date1904=tr(t.WBProps.date1904)}var L4="][*?/\\".split("");function M4(t,r){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return L4.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}var U4=/<\w+:workbook/;function $4(t,r){if(!t)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",o={},l=0;if(t.replace(sn,function(f,m){var p=lt(f);switch(Ms(p[0])){case"<?xml":break;case"<workbook":f.match(U4)&&(s="xmlns"+f.match(/<(\w+):/)[1]),e.xmlns=p[s];break;case"</workbook>":break;case"<fileVersion":delete p[0],e.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":m1.forEach(function(v){if(p[v[0]]!=null)switch(v[2]){case"bool":e.WBProps[v[0]]=tr(p[v[0]]);break;case"int":e.WBProps[v[0]]=parseInt(p[v[0]],10);break;default:e.WBProps[v[0]]=p[v[0]]}}),p.codeName&&(e.WBProps.CodeName=Xt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],e.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Ot(Xt(p.name)),delete p[0],e.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=Xt(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),tr(p.hidden||"0")&&(o.Hidden=!0),l=m+f.length;break;case"</definedName>":o.Ref=Ot(Xt(t.slice(l,m))),e.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],e.CalcPr=p;break;case"<calcPr/>":delete p[0],e.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return f}),s2.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return g1(e),e}function B4(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=Bf(t),e.name=rn(t),e}function V4(t,r){var e={},n=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var s=r>8?rn(t):"";return s.length>0&&(e.CodeName=s),e.autoCompressPictures=!!(n&65536),e.backupFile=!!(n&64),e.checkCompatibility=!!(n&4096),e.date1904=!!(n&1),e.filterPrivacy=!!(n&8),e.hidePivotFieldList=!!(n&1024),e.promptedSolutions=!!(n&16),e.publishItems=!!(n&2048),e.refreshAllConnections=!!(n&262144),e.saveExternalLinkValues=!!(n&128),e.showBorderUnselectedTables=!!(n&4),e.showInkAnnotation=!!(n&32),e.showObjects=["all","placeholders","none"][n>>13&3],e.showPivotChartFilter=!!(n&32768),e.updateLinks=["userSet","never","always"][n>>8&3],e}function W4(t,r){var e={};return t.read_shift(4),e.ArchID=t.read_shift(4),t.l+=r-8,e}function H4(t,r,e){var n=t.l+r;t.l+=4,t.l+=1;var s=t.read_shift(4),o=_2(t),l=NC(t,0,e),u=bh(t);t.l=n;var f={Name:o,Ptg:l};return s<268435455&&(f.Sheet=s),u&&(f.Comment=u),f}function z4(t,r){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;r||(r={}),r.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],md[16]={n:"BrtFRTArchID$",f:W4},ga(t,function(f,m,p){switch(p){case 156:l.SheetNames.push(f.name),e.Sheets.push(f);break;case 153:e.WBProps=f;break;case 39:f.Sheet!=null&&(r.SID=f.Sheet),f.Ref=Zr(f.Ptg,null,null,l,r),delete r.SID,delete f.Ptg,o.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([p,f]):l[0]=[p,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(p),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!m.T){if(!s||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},r),g1(e),e.Names=o,e.supbooks=l,e}function G4(t,r,e){return r.slice(-4)===".bin"?z4(t,e):$4(t,e)}function K4(t,r,e,n,s,o,l,u){return r.slice(-4)===".bin"?C4(t,n,e,s,o,l,u):BC(t,n,e,s,o,l,u)}function X4(t,r,e,n,s,o,l,u){return r.slice(-4)===".bin"?j4(t,n,e,s,o):I4(t,n,e,s,o)}function q4(t,r,e,n,s,o,l,u){return r.slice(-4)===".bin"?nN():sN()}function J4(t,r,e,n,s,o,l,u){return r.slice(-4)===".bin"?tN():rN()}function Y4(t,r,e,n){return r.slice(-4)===".bin"?vT(t,e,n):fT(t,e,n)}function Q4(t,r,e){return t1(t,e)}function Z4(t,r,e){return r.slice(-4)===".bin"?Fk(t,e):Ok(t,e)}function e3(t,r,e){return r.slice(-4)===".bin"?QT(t,e):KT(t,e)}function t3(t,r,e){return r.slice(-4)===".bin"?HT(t):VT(t)}function r3(t,r,e,n){return e.slice(-4)===".bin"?zT(t,r,e,n):void 0}function n3(t,r,e){return r.slice(-4)===".bin"?$T(t,r,e):BT(t,r,e)}var p1=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,x1=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function fs(t,r){var e=t.split(/\s+/),n=[];if(n[0]=e[0],e.length===1)return n;var s=t.match(p1),o,l,u,f;if(s)for(f=0;f!=s.length;++f)o=s[f].match(x1),(l=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(l+1),n[u]=o[2].slice(1,o[2].length-1));return n}function s3(t){var r=t.split(/\s+/),e={};if(r.length===1)return e;var n=t.match(p1),s,o,l,u;if(n)for(u=0;u!=n.length;++u)s=n[u].match(x1),(o=s[1].indexOf(":"))===-1?e[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),e[l]=s[2].slice(1,s[2].length-1));return e}var oc;function a3(t,r){var e=oc[t]||Ot(t);return e==="General"?Hi(r):rs(e,r)}function i3(t,r,e,n){var s=n;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=tr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Fr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}t[Ot(r)]=s}function o3(t,r,e){if(t.t!=="z"){if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Zi[t.v]:r==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=dc(t.v):t.w=Hi(t.v):t.w=a3(r||"General",t.v)}catch(o){if(e.WTF)throw o}try{var n=oc[r]||r||"General";if(e.cellNF&&(t.z=n),e.cellDates&&t.t=="n"&&al(n)){var s=Bi(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(o){if(e.WTF)throw o}}}function l3(t,r,e){if(e.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=iT[n.Pattern]||n.Pattern)}t[r.ID]=r}function c3(t,r,e,n,s,o,l,u,f,m){var p="General",v=n.StyleID,y={};m=m||{};var S=[],k=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&l&&(v=l.StyleID);o[v]!==void 0&&(o[v].nf&&(p=o[v].nf),o[v].Interior&&S.push(o[v].Interior),!!o[v].Parent);)v=o[v].Parent;switch(e.Type){case"Boolean":n.t="b",n.v=tr(t);break;case"String":n.t="s",n.r=vp(Ot(t)),n.v=t.indexOf("<")>-1?Ot(r||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Fr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Ot(t):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=jv[t],m.cellText!==!1&&(n.w=t);break;default:t==""&&r==""?n.t="z":(n.t="s",n.v=vp(r||t));break}if(o3(n,p,m),m.cellFormula!==!1)if(n.Formula){var w=Ot(n.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),n.f=qo(w,s),delete n.Formula,n.ArrayRange=="RC"?n.F=qo("RC:RC",s):n.ArrayRange&&(n.F=qo(n.ArrayRange,s),f.push([lr(n.F),n.F]))}else for(k=0;k<f.length;++k)s.r>=f[k][0].s.r&&s.r<=f[k][0].e.r&&s.c>=f[k][0].s.c&&s.c<=f[k][0].e.c&&(n.F=f[k][1]);m.cellStyles&&(S.forEach(function(E){!y.patternType&&E.patternType&&(y.patternType=E.patternType)}),n.s=y),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function u3(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Sf(t,r){var e=r||{};av();var n=Gl(ph(t));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(n=Xt(n));var s=n.slice(0,1024).toLowerCase(),o=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var l=Hr(e);return l.type="string",mc.to_workbook(n,l)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(at){s.indexOf("<"+at)>=0&&(o=!0)}),o)return y3(n,e);oc={"General Number":"General","General Date":gt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":gt[15],"Short Date":gt[14],"Long Time":gt[19],"Medium Time":gt[18],"Short Time":gt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:gt[2],Standard:gt[4],Percent:gt[10],Scientific:gt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],m,p={},v=[],y=e.dense?[]:{},S="",k={},w={},E=fs('<Data ss:Type="String">'),F=0,B=0,C=0,M={s:{r:2e6,c:2e6},e:{r:0,c:0}},re={},O={},U="",ee=0,I=[],ie={},oe={},X=0,ae=[],fe=[],me={},Te=[],be,le=!1,te=[],pe=[],A={},N=0,L=0,V={Sheets:[],WBProps:{date1904:!1}},q={};hc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ce="";u=hc.exec(n);)switch(u[3]=(ce=u[3]).toLowerCase()){case"data":if(ce=="data"){if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?c3(n.slice(F,u.index),U,E,f[f.length-1][0]=="comment"?me:k,{c:B,r:C},re,Te[B],w,te,e):(U="",E=fs(u[0]),F=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(fe.length>0&&(k.c=fe),(!e.sheetRows||e.sheetRows>C)&&k.v!==void 0&&(e.dense?(y[C]||(y[C]=[]),y[C][B]=k):y[Nr(B)+zr(C)]=k),k.HRef&&(k.l={Target:Ot(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(N=B+(parseInt(k.MergeAcross,10)|0),L=C+(parseInt(k.MergeDown,10)|0),I.push({s:{c:B,r:C},e:{c:N,r:L}})),!e.sheetStubs)k.MergeAcross?B=N+1:++B;else if(k.MergeAcross||k.MergeDown){for(var J=B;J<=N;++J)for(var he=C;he<=L;++he)(J>B||he>C)&&(e.dense?(y[he]||(y[he]=[]),y[he][J]={t:"z"}):y[Nr(J)+zr(he)]={t:"z"});B=N+1}else++B;else k=s3(u[0]),k.Index&&(B=+k.Index-1),B<M.s.c&&(M.s.c=B),B>M.e.c&&(M.e.c=B),u[0].slice(-2)==="/>"&&++B,fe=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(C<M.s.r&&(M.s.r=C),C>M.e.r&&(M.e.r=C),u[0].slice(-2)==="/>"&&(w=fs(u[0]),w.Index&&(C=+w.Index-1)),B=0,++C):(w=fs(u[0]),w.Index&&(C=+w.Index-1),A={},(w.AutoFitHeight=="0"||w.Height)&&(A.hpx=parseInt(w.Height,10),A.hpt=e1(A.hpx),pe[C]=A),w.Hidden=="1"&&(A.hidden=!0,pe[C]=A));break;case"worksheet":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));v.push(S),M.s.r<=M.e.r&&M.s.c<=M.e.c&&(y["!ref"]=Nt(M),e.sheetRows&&e.sheetRows<=M.e.r&&(y["!fullref"]=y["!ref"],M.e.r=e.sheetRows-1,y["!ref"]=Nt(M))),I.length&&(y["!merges"]=I),Te.length>0&&(y["!cols"]=Te),pe.length>0&&(y["!rows"]=pe),p[S]=y}else M={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=B=0,f.push([u[3],!1]),m=fs(u[0]),S=Ot(m.Name),y=e.dense?[]:{},I=[],te=[],pe=[],q={name:S,Hidden:0},V.Sheets.push(q);break;case"table":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),Te=[],le=!1}break;case"style":u[1]==="/"?l3(re,O,e):O=fs(u[0]);break;case"numberformat":O.nf=Ot(fs(u[0]).Format||"General"),oc[O.nf]&&(O.nf=oc[O.nf]);for(var Y=0;Y!=392&&gt[Y]!=O.nf;++Y);if(Y==392){for(Y=57;Y!=392;++Y)if(gt[Y]==null){Vi(O.nf,Y);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(be=fs(u[0]),be.Hidden&&(be.hidden=!0,delete be.Hidden),be.Width&&(be.wpx=parseInt(be.Width,10)),!le&&be.wpx>10){le=!0,xn=Qv;for(var xe=0;xe<Te.length;++xe)Te[xe]&&Zo(Te[xe])}le&&Zo(be),Te[be.Index-1||Te.length]=be;for(var Pe=0;Pe<+be.Span;++Pe)Te[Te.length]=Hr(be);break;case"namedrange":if(u[1]==="/")break;V.Names||(V.Names=[]);var K=lt(u[0]),Xe={Name:K.Name,Ref:qo(K.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(Xe.Sheet=V.Sheets.length-1),V.Names.push(Xe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?U+=n.slice(ee,u.index):ee=u.index+u[0].length;break;case"interior":if(!e.cellStyles)break;O.Interior=fs(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?K2(ie,ce,n.slice(X,u.index)):X=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));u3(me),fe.push(me)}else f.push([u[3],!1]),m=fs(u[0]),me={a:m.Author};break;case"autofilter":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var we=fs(u[0]);y["!autofilter"]={ref:qo(we.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((m=f.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return rx(n,e);var Fe=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Fe=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Fe=!1}break;case"excelworkbook":switch(u[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Fe=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Fe=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(X,u.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else X=u.index+u[0].length;break;case"header":y["!margins"]||ic(y["!margins"]={},"xlml"),isNaN(+lt(u[0]).Margin)||(y["!margins"].header=+lt(u[0]).Margin);break;case"footer":y["!margins"]||ic(y["!margins"]={},"xlml"),isNaN(+lt(u[0]).Margin)||(y["!margins"].footer=+lt(u[0]).Margin);break;case"pagemargins":var Oe=lt(u[0]);y["!margins"]||ic(y["!margins"]={},"xlml"),isNaN(+Oe.Top)||(y["!margins"].top=+Oe.Top),isNaN(+Oe.Left)||(y["!margins"].left=+Oe.Left),isNaN(+Oe.Right)||(y["!margins"].right=+Oe.Right),isNaN(+Oe.Bottom)||(y["!margins"].bottom=+Oe.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Fe=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Fe=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Fe=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Fe=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Fe=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Fe=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Fe=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Fe=!1}break;case"smarttags":break;default:Fe=!1;break}if(Fe||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?i3(oe,ce,ae,n.slice(X,u.index)):(ae=u,X=u.index+u[0].length);break}if(e.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var Ae={};return!e.bookSheets&&!e.bookProps&&(Ae.Sheets=p),Ae.SheetNames=v,Ae.Workbook=V,Ae.SSF=Hr(gt),Ae.Props=ie,Ae.Custprops=oe,Ae}function zf(t,r){switch(Ih(r=r||{}),r.type||"base64"){case"base64":return Sf(Hn(t),r);case"binary":case"buffer":case"file":return Sf(t,r);case"array":return Sf(Ji(t),r)}}function d3(t){var r={},e=t.content;if(e.l=28,r.AnsiUserType=e.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=k2(e),e.length-e.l<=4)return r;var n=e.read_shift(4);if(n==0||n>40||(e.l-=4,r.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(n=e.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=T2(e),n=e.read_shift(4),n==0||n>40))return r;e.l-=4,r.Reserved2=e.read_shift(0,"lpwstr")}var f3=[60,1084,2066,2165,2175];function h3(t,r,e,n,s){var o=n,l=[],u=e.slice(e.l,e.l+o);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}l.push(u),e.l+=o;for(var f=la(e,e.l),m=Gf[f],p=0;m!=null&&f3.indexOf(f)>-1;)o=la(e,e.l+2),p=e.l+4,f==2066?p+=4:(f==2165||f==2175)&&(p+=12),u=e.slice(p,e.l+4+o),l.push(u),e.l+=4+o,m=Gf[f=la(e,e.l)];var v=qa(l);Wr(v,0);var y=0;v.lens=[];for(var S=0;S<l.length;++S)v.lens.push(y),y+=l[S].length;if(v.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+n;return r.f(v,v.length,s)}function Os(t,r,e){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,r.cellNF&&(t.z=gt[n])}catch(o){if(r.WTF)throw o}if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Zi[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=dc(t.v):t.w=Hi(t.v):t.w=rs(n,t.v,{date1904:!!e,dateNF:r&&r.dateNF})}catch(o){if(r.WTF)throw o}if(r.cellDates&&n&&t.t=="n"&&al(gt[n]||String(n))){var s=Bi(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Yu(t,r,e){return{v:t,ixfe:r,t:e}}function m3(t,r){var e={opts:{}},n={},s=r.dense?[]:{},o={},l={},u=null,f=[],m="",p={},v,y="",S,k,w,E,F={},B=[],C,M,re=[],O=[],U={Sheets:[],WBProps:{date1904:!1},Views:[{}]},ee={},I=function(ct){return ct<8?Wi[ct]:ct<64&&O[ct-8]||Wi[ct]},ie=function(ct,Lt,Dr){var Wt=Lt.XF.data;if(!(!Wt||!Wt.patternType||!Dr||!Dr.cellStyles)){Lt.s={},Lt.s.patternType=Wt.patternType;var on;(on=gc(I(Wt.icvFore)))&&(Lt.s.fgColor={rgb:on}),(on=gc(I(Wt.icvBack)))&&(Lt.s.bgColor={rgb:on})}},oe=function(ct,Lt,Dr){if(!(A>1)&&!(Dr.sheetRows&&ct.r>=Dr.sheetRows)){if(Dr.cellStyles&&Lt.XF&&Lt.XF.data&&ie(ct,Lt,Dr),delete Lt.ixfe,delete Lt.XF,v=ct,y=ht(ct),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),ct.r<l.s.r&&(l.s.r=ct.r),ct.c<l.s.c&&(l.s.c=ct.c),ct.r+1>l.e.r&&(l.e.r=ct.r+1),ct.c+1>l.e.c&&(l.e.c=ct.c+1),Dr.cellFormula&&Lt.f){for(var Wt=0;Wt<B.length;++Wt)if(!(B[Wt][0].s.c>ct.c||B[Wt][0].s.r>ct.r)&&!(B[Wt][0].e.c<ct.c||B[Wt][0].e.r<ct.r)){Lt.F=Nt(B[Wt][0]),(B[Wt][0].s.c!=ct.c||B[Wt][0].s.r!=ct.r)&&delete Lt.f,Lt.f&&(Lt.f=""+Zr(B[Wt][1],l,ct,te,X));break}}Dr.dense?(s[ct.r]||(s[ct.r]=[]),s[ct.r][ct.c]=Lt):s[y]=Lt}},X={enc:!1,sbcch:0,snames:[],sharedf:F,arrayf:B,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(X.password=r.password);var ae,fe=[],me=[],Te=[],be=[],le=!1,te=[];te.SheetNames=X.snames,te.sharedf=X.sharedf,te.arrayf=X.arrayf,te.names=[],te.XTI=[];var pe=0,A=0,N=0,L=[],V=[],q;X.codepage=1200,xs(1200);for(var ce=!1;t.l<t.length-1;){var J=t.l,he=t.read_shift(2);if(he===0&&pe===10)break;var Y=t.l===t.length?0:t.read_shift(2),xe=Gf[he];if(xe&&xe.f){if(r.bookSheets&&pe===133&&he!==133)break;if(pe=he,xe.r===2||xe.r==12){var Pe=t.read_shift(2);if(Y-=2,!X.enc&&Pe!==he&&((Pe&255)<<8|Pe>>8)!==he)throw new Error("rt mismatch: "+Pe+"!="+he);xe.r==12&&(t.l+=10,Y-=10)}var K={};if(he===10?K=xe.f(t,Y,X):K=h3(he,xe,t,Y,X),A==0&&[9,521,1033,2057].indexOf(pe)===-1)continue;switch(he){case 34:e.opts.Date1904=U.WBProps.date1904=K;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(X.enc||(t.l=0),X.enc=K,!r.password)throw new Error("File is password-protected");if(K.valid==null)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:X.lastuser=K;break;case 66:var Xe=Number(K);switch(Xe){case 21010:Xe=1200;break;case 32768:Xe=1e4;break;case 32769:Xe=1252;break}xs(X.codepage=Xe),ce=!0;break;case 317:X.rrtabid=K;break;case 25:X.winlocked=K;break;case 439:e.opts.RefreshAll=K;break;case 12:e.opts.CalcCount=K;break;case 16:e.opts.CalcDelta=K;break;case 17:e.opts.CalcIter=K;break;case 13:e.opts.CalcMode=K;break;case 14:e.opts.CalcPrecision=K;break;case 95:e.opts.CalcSaveRecalc=K;break;case 15:X.CalcRefMode=K;break;case 2211:e.opts.FullCalc=K;break;case 129:K.fDialog&&(s["!type"]="dialog"),K.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),K.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:re.push(K);break;case 430:te.push([K]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(K);break;case 24:case 536:q={Name:K.Name,Ref:Zr(K.rgce,l,null,te,X)},K.itab>0&&(q.Sheet=K.itab-1),te.names.push(q),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(K),K.Name=="_xlnm._FilterDatabase"&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&K.rgce[0][0][0]=="PtgArea3d"&&(V[K.itab-1]={ref:Nt(K.rgce[0][0][1][2])});break;case 22:X.ExternCount=K;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(K),te.XTI=te.XTI.concat(K);break;case 2196:if(X.biff<8)break;q!=null&&(q.Comment=K[1]);break;case 18:s["!protect"]=K;break;case 19:K!==0&&X.WTF&&console.error("Password verifier: "+K);break;case 133:o[K.pos]=K,X.snames.push(K.name);break;case 10:{if(--A)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,s["!ref"]=Nt(l),r.sheetRows&&r.sheetRows<=l.e.r){var we=l.e.r;l.e.r=r.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Nt(l),l.e.r=we}l.e.r++,l.e.c++}fe.length>0&&(s["!merges"]=fe),me.length>0&&(s["!objects"]=me),Te.length>0&&(s["!cols"]=Te),be.length>0&&(s["!rows"]=be),U.Sheets.push(ee)}m===""?p=s:n[m]=s,s=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(X.biff===8&&(X.biff={9:2,521:3,1033:4}[he]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),X.biffguess=K.BIFFVer==0,K.BIFFVer==0&&K.dt==4096&&(X.biff=5,ce=!0,xs(X.codepage=28591)),X.biff==8&&K.BIFFVer==0&&K.dt==16&&(X.biff=2),A++)break;if(s=r.dense?[]:{},X.biff<8&&!ce&&(ce=!0,xs(X.codepage=r.codepage||1252)),X.biff<5||K.BIFFVer==0&&K.dt==4096){m===""&&(m="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Fe={pos:t.l-Y,name:m};o[Fe.pos]=Fe,X.snames.push(m)}else m=(o[J]||{name:""}).name;K.dt==32&&(s["!type"]="chart"),K.dt==64&&(s["!type"]="macro"),fe=[],me=[],X.arrayf=B=[],Te=[],be=[],le=!1,ee={Hidden:(o[J]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(r.dense?(s[K.r]||[])[K.c]:s[ht({c:K.c,r:K.r})])&&++K.c,C={ixfe:K.ixfe,XF:re[K.ixfe]||{},v:K.val,t:"n"},N>0&&(C.z=L[C.ixfe>>8&63]),Os(C,r,e.opts.Date1904),oe({c:K.c,r:K.r},C,r);break;case 5:case 517:C={ixfe:K.ixfe,XF:re[K.ixfe],v:K.val,t:K.t},N>0&&(C.z=L[C.ixfe>>8&63]),Os(C,r,e.opts.Date1904),oe({c:K.c,r:K.r},C,r);break;case 638:C={ixfe:K.ixfe,XF:re[K.ixfe],v:K.rknum,t:"n"},N>0&&(C.z=L[C.ixfe>>8&63]),Os(C,r,e.opts.Date1904),oe({c:K.c,r:K.r},C,r);break;case 189:for(var Oe=K.c;Oe<=K.C;++Oe){var Ae=K.rkrec[Oe-K.c][0];C={ixfe:Ae,XF:re[Ae],v:K.rkrec[Oe-K.c][1],t:"n"},N>0&&(C.z=L[C.ixfe>>8&63]),Os(C,r,e.opts.Date1904),oe({c:Oe,r:K.r},C,r)}break;case 6:case 518:case 1030:{if(K.val=="String"){u=K;break}if(C=Yu(K.val,K.cell.ixfe,K.tt),C.XF=re[C.ixfe],r.cellFormula){var at=K.formula;if(at&&at[0]&&at[0][0]&&at[0][0][0]=="PtgExp"){var St=at[0][0][1][0],wt=at[0][0][1][1],Et=ht({r:St,c:wt});F[Et]?C.f=""+Zr(K.formula,l,K.cell,te,X):C.F=((r.dense?(s[St]||[])[wt]:s[Et])||{}).F}else C.f=""+Zr(K.formula,l,K.cell,te,X)}N>0&&(C.z=L[C.ixfe>>8&63]),Os(C,r,e.opts.Date1904),oe(K.cell,C,r),u=K}break;case 7:case 519:if(u)u.val=K,C=Yu(K,u.cell.ixfe,"s"),C.XF=re[C.ixfe],r.cellFormula&&(C.f=""+Zr(u.formula,l,u.cell,te,X)),N>0&&(C.z=L[C.ixfe>>8&63]),Os(C,r,e.opts.Date1904),oe(u.cell,C,r),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{B.push(K);var Vt=ht(K[0].s);if(S=r.dense?(s[K[0].s.r]||[])[K[0].s.c]:s[Vt],r.cellFormula&&S){if(!u||!Vt||!S)break;S.f=""+Zr(K[1],l,K[0],te,X),S.F=Nt(K[0])}}break;case 1212:{if(!r.cellFormula)break;if(y){if(!u)break;F[ht(u.cell)]=K[0],S=r.dense?(s[u.cell.r]||[])[u.cell.c]:s[ht(u.cell)],(S||{}).f=""+Zr(K[0],l,v,te,X)}}break;case 253:C=Yu(f[K.isst].t,K.ixfe,"s"),f[K.isst].h&&(C.h=f[K.isst].h),C.XF=re[C.ixfe],N>0&&(C.z=L[C.ixfe>>8&63]),Os(C,r,e.opts.Date1904),oe({c:K.c,r:K.r},C,r);break;case 513:r.sheetStubs&&(C={ixfe:K.ixfe,XF:re[K.ixfe],t:"z"},N>0&&(C.z=L[C.ixfe>>8&63]),Os(C,r,e.opts.Date1904),oe({c:K.c,r:K.r},C,r));break;case 190:if(r.sheetStubs)for(var kt=K.c;kt<=K.C;++kt){var Ct=K.ixfe[kt-K.c];C={ixfe:Ct,XF:re[Ct],t:"z"},N>0&&(C.z=L[C.ixfe>>8&63]),Os(C,r,e.opts.Date1904),oe({c:kt,r:K.r},C,r)}break;case 214:case 516:case 4:C=Yu(K.val,K.ixfe,"s"),C.XF=re[C.ixfe],N>0&&(C.z=L[C.ixfe>>8&63]),Os(C,r,e.opts.Date1904),oe({c:K.c,r:K.r},C,r);break;case 0:case 512:A===1&&(l=K);break;case 252:f=K;break;case 1054:if(X.biff==4){L[N++]=K[1];for(var At=0;At<N+163&&gt[At]!=K[1];++At);At>=163&&Vi(K[1],N+163)}else Vi(K[1],K[0]);break;case 30:{L[N++]=K;for(var Ht=0;Ht<N+163&&gt[Ht]!=K;++Ht);Ht>=163&&Vi(K,N+163)}break;case 229:fe=fe.concat(K);break;case 93:me[K.cmo[0]]=X.lastobj=K;break;case 438:X.lastobj.TxO=K;break;case 127:X.lastobj.ImData=K;break;case 440:for(E=K[0].s.r;E<=K[0].e.r;++E)for(w=K[0].s.c;w<=K[0].e.c;++w)S=r.dense?(s[E]||[])[w]:s[ht({c:w,r:E})],S&&(S.l=K[1]);break;case 2048:for(E=K[0].s.r;E<=K[0].e.r;++E)for(w=K[0].s.c;w<=K[0].e.c;++w)S=r.dense?(s[E]||[])[w]:s[ht({c:w,r:E})],S&&S.l&&(S.l.Tooltip=K[1]);break;case 28:{if(X.biff<=5&&X.biff>=2)break;S=r.dense?(s[K[0].r]||[])[K[0].c]:s[ht(K[0])];var Zt=me[K[2]];S||(r.dense?(s[K[0].r]||(s[K[0].r]=[]),S=s[K[0].r][K[0].c]={t:"z"}):S=s[ht(K[0])]={t:"z"},l.e.r=Math.max(l.e.r,K[0].r),l.s.r=Math.min(l.s.r,K[0].r),l.e.c=Math.max(l.e.c,K[0].c),l.s.c=Math.min(l.s.c,K[0].c)),S.c||(S.c=[]),k={a:K[1],t:Zt.TxO.t},S.c.push(k)}break;case 2173:PT(re[K.ixfe],K.ext);break;case 125:{if(!X.cellStyles)break;for(;K.e>=K.s;)Te[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(K.flags&1)},le||(le=!0,Th(K.w/256)),Zo(Te[K.e+1])}break;case 520:{var qt={};K.level!=null&&(be[K.r]=qt,qt.level=K.level),K.hidden&&(be[K.r]=qt,qt.hidden=!0),K.hpt&&(be[K.r]=qt,qt.hpt=K.hpt,qt.hpx=pc(K.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||ic(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[he]]=K;break;case 161:s["!margins"]||ic(s["!margins"]={}),s["!margins"].header=K.header,s["!margins"].footer=K.footer;break;case 574:K.RTL&&(U.Views[0].RTL=!0);break;case 146:O=K;break;case 2198:ae=K;break;case 140:M=K;break;case 442:m?ee.CodeName=K||ee.name:U.WBProps.CodeName=K||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+he.toString(16)),t.l+=Y}return e.SheetNames=Ps(o).sort(function(an,ct){return Number(an)-Number(ct)}).map(function(an){return o[an].name}),r.bookSheets||(e.Sheets=n),!e.SheetNames.length&&p["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=p)):e.Preamble=p,e.Sheets&&V.forEach(function(an,ct){e.Sheets[e.SheetNames[ct]]["!autofilter"]=an}),e.Strings=f,e.SSF=Hr(gt),X.enc&&(e.Encryption=X.enc),ae&&(e.Themes=ae),e.Metadata={},M!==void 0&&(e.Metadata.Country=M),te.names.length>0&&(U.Names=te.names),e.Workbook=U,e}var Yp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function g3(t,r,e){var n=Tt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=Fp(n,O2,Yp.DSI);for(var o in s)r[o]=s[o]}catch(m){if(e.WTF)throw m}var l=Tt.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var u=Fp(l,j2,Yp.SI);for(var f in u)r[f]==null&&(r[f]=u[f])}catch(m){if(e.WTF)throw m}r.HeadingPairs&&r.TitlesOfParts&&(Dv(r.HeadingPairs,r.TitlesOfParts,r,e),delete r.HeadingPairs,delete r.TitlesOfParts)}function v1(t,r){r||(r={}),Ih(r),Kx(),r.codepage&&ch(r.codepage);var e,n;if(t.FullPaths){if(Tt.find(t,"/encryption"))throw new Error("File is password-protected");e=Tt.find(t,"!CompObj"),n=Tt.find(t,"/Workbook")||Tt.find(t,"/Book")}else{switch(r.type){case"base64":t=ps(Hn(t));break;case"binary":t=ps(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Wr(t,0),n={content:t}}var s,o;if(e&&d3(e),r.bookProps&&!r.bookSheets)s={};else{var l=_t?"buffer":"array";if(n&&n.content)s=m3(n.content,r);else if((o=Tt.find(t,"PerfectOffice_MAIN"))&&o.content)s=sc.to_workbook(o.content,(r.type=l,r));else if((o=Tt.find(t,"NativeContent_MAIN"))&&o.content)s=sc.to_workbook(o.content,(r.type=l,r));else throw(o=Tt.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&t.FullPaths&&Tt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=eN(t))}var u={};return t.FullPaths&&g3(t,u,r),s.Props=s.Custprops=u,r.bookFiles&&(s.cfb=t),s}var md={0:{f:JC},1:{f:e4},2:{f:c4},3:{f:s4},4:{f:r4},5:{f:l4},6:{f:f4},7:{f:i4},8:{f:x4},9:{f:p4},10:{f:m4},11:{f:g4},12:{f:t4},13:{f:u4},14:{f:a4},15:{f:n4},16:{f:h1},17:{f:h4},18:{f:o4},19:{f:wh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:H4},40:{},42:{},43:{f:mT},44:{f:hT},45:{f:gT},46:{f:xT},47:{f:pT},48:{},49:{f:v2},50:{},51:{f:MT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Kv},62:{f:d4},63:{f:WT},64:{f:T4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:nn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:k4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ZC},148:{f:YC,p:16},151:{f:w4},152:{},153:{f:V4},154:{},155:{},156:{f:B4},157:{},158:{},159:{T:1,f:jk},160:{T:-1},161:{T:1,f:Qi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:v4},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:LT},336:{T:-1},337:{f:UT,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Bf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Gv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:b4},427:{f:_4},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:E4},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:QC},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:y4},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Bf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:YT},633:{T:1},634:{T:-1},635:{T:1,f:JT},636:{T:-1},637:{f:w2},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:O4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:N4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Gf={6:{f:bf},10:{f:za},12:{f:xr},13:{f:xr},14:{f:ur},15:{f:ur},16:{f:en},17:{f:ur},18:{f:ur},19:{f:xr},20:{f:Mp},21:{f:Mp},23:{f:Gv},24:{f:$p},25:{f:ur},26:{},27:{},28:{f:XE},29:{},34:{f:ur},35:{f:Up},38:{f:en},39:{f:en},40:{f:en},41:{f:en},42:{f:ur},43:{f:ur},47:{f:Qk},49:{f:AE},51:{f:xr},60:{},61:{f:TE},64:{f:ur},65:{f:CE},66:{f:xr},77:{},80:{},81:{},82:{},85:{f:xr},89:{},90:{},91:{},92:{f:vE},93:{f:JE},94:{},95:{f:ur},96:{},97:{},99:{f:ur},125:{f:Kv},128:{f:UE},129:{f:yE},130:{f:xr},131:{f:ur},132:{f:ur},133:{f:wE},134:{},140:{f:rk},141:{f:xr},144:{},146:{f:sk},151:{},152:{},153:{},154:{},155:{},156:{f:xr},157:{},158:{},160:{f:ck},161:{f:ik},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:DE},190:{f:PE},193:{f:za},197:{},198:{},199:{},200:{},201:{},202:{f:ur},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:xr},220:{},221:{f:ur},222:{},224:{f:ME},225:{f:xE},226:{f:za},227:{},229:{f:qE},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:bE},253:{f:RE},255:{f:_E},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:$v},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ur},353:{f:za},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:BE},431:{f:ur},432:{},433:{},434:{},437:{},438:{f:ZE},439:{f:ur},440:{f:ek},441:{},442:{f:kc},443:{},444:{f:xr},445:{},446:{},448:{f:za},449:{f:kE,r:2},450:{f:za},512:{f:Pp},513:{f:lk},515:{f:$E},516:{f:IE},517:{f:Lp},519:{f:uk},520:{f:SE},523:{},545:{f:Bp},549:{f:Dp},566:{},574:{f:NE},638:{f:FE},659:{},1048:{},1054:{f:OE},1084:{},1212:{f:zE},2048:{f:tk},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Xu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:za},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:ak,r:12},2173:{f:DT,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ur,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:HE,r:12},2197:{},2198:{f:AT,r:12},2199:{},2200:{},2201:{},2202:{f:GE,r:12},2203:{f:za},2204:{},2205:{},2206:{},2207:{},2211:{f:EE},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:xr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:ok},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:nk},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Pp},1:{},2:{f:mk},3:{f:hk},4:{f:fk},5:{f:Lp},7:{f:gk},8:{},9:{f:Xu},11:{},22:{f:xr},30:{f:jE},31:{},32:{},33:{f:Bp},36:{},37:{f:Dp},50:{f:pk},62:{},52:{},67:{},68:{f:xr},69:{},86:{},126:{},127:{f:dk},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:xk},223:{},234:{},354:{},421:{},518:{f:bf},521:{f:Xu},536:{f:$p},547:{f:Up},561:{},579:{},1030:{f:bf},1033:{f:Xu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function hs(t,r,e,n){var s=r;if(!isNaN(s)){var o=(e||[]).length||0,l=t.next(4);l.write_shift(2,s),l.write_shift(2,o),o>0&&Nv(e)&&t.push(e)}}function Qp(t,r){var e=r||{},n=e.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),l=s.index,u=o&&o.index||t.length,f=$S(t.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,p=0,v=0,y=0,S={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(l=0;l<f.length;++l){var w=f[l].trim(),E=w.slice(0,3).toLowerCase();if(E=="<tr"){if(++m,e.sheetRows&&e.sheetRows<=m){--m;break}p=0;continue}if(!(E!="<td"&&E!="<th")){var F=w.split(/<\/t[dh]>/i);for(u=0;u<F.length;++u){var B=F[u].trim();if(B.match(/<t[dh]/i)){for(var C=B,M=0;C.charAt(0)=="<"&&(M=C.indexOf(">"))>-1;)C=C.slice(M+1);for(var re=0;re<k.length;++re){var O=k[re];O.s.c==p&&O.s.r<m&&m<=O.e.r&&(p=O.e.c+1,re=-1)}var U=lt(B.slice(0,B.indexOf(">")));y=U.colspan?+U.colspan:1,((v=+U.rowspan)>1||y>1)&&k.push({s:{r:m,c:p},e:{r:m+(v||1)-1,c:p+y-1}});var ee=U.t||U["data-t"]||"";if(!C.length){p+=y;continue}if(C=mv(C),S.s.r>m&&(S.s.r=m),S.e.r<m&&(S.e.r=m),S.s.c>p&&(S.s.c=p),S.e.c<p&&(S.e.c=p),!C.length){p+=y;continue}var I={t:"s",v:C};e.raw||!C.trim().length||ee=="s"||(C==="TRUE"?I={t:"b",v:!0}:C==="FALSE"?I={t:"b",v:!1}:isNaN(ys(C))?isNaN(Qo(C).getDate())||(I={t:"d",v:Fr(C)},e.cellDates||(I={t:"n",v:wn(I.v)}),I.z=e.dateNF||gt[14]):I={t:"n",v:ys(C)}),e.dense?(n[m]||(n[m]=[]),n[m][p]=I):n[ht({r:m,c:p})]=I,p+=y}}}}return n["!ref"]=Nt(S),k.length&&(n["!merges"]=k),n}function p3(t,r,e,n){for(var s=t["!merges"]||[],o=[],l=r.s.c;l<=r.e.c;++l){for(var u=0,f=0,m=0;m<s.length;++m)if(!(s[m].s.r>e||s[m].s.c>l)&&!(s[m].e.r<e||s[m].e.c<l)){if(s[m].s.r<e||s[m].s.c<l){u=-1;break}u=s[m].e.r-s[m].s.r+1,f=s[m].e.c-s[m].s.c+1;break}if(!(u<0)){var p=ht({r:e,c:l}),v=n.dense?(t[e]||[])[l]:t[p],y=v&&v.v!=null&&(v.h||gh(v.w||(ha(v),v.w)||""))||"",S={};u>1&&(S.rowspan=u),f>1&&(S.colspan=f),n.editable?y='<span contenteditable="true">'+y+"</span>":v&&(S["data-t"]=v&&v.t||"z",v.v!=null&&(S["data-v"]=v.v),v.z!=null&&(S["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+v.l.Target+'">'+y+"</a>")),S.id=(n.id||"sjs")+"-"+p,o.push(r2("td",y,S))}}var k="<tr>";return k+o.join("")+"</tr>"}var x3='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',v3="</body></html>";function y3(t,r){var e=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return ri(Qp(e[0],r),r);var n=jh();return e.forEach(function(s,o){Fh(n,Qp(s,r),"Sheet"+(o+1))}),n}function w3(t,r,e){var n=[];return n.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function b3(t,r){var e=r||{},n=e.header!=null?e.header:x3,s=e.footer!=null?e.footer:v3,o=[n],l=il(t["!ref"]);e.dense=Array.isArray(t),o.push(w3(t,l,e));for(var u=l.s.r;u<=l.e.r;++u)o.push(p3(t,l,u,e));return o.push("</table>"+s),o.join("")}function y1(t,r,e){var n=e||{},s=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?vn(n.origin):n.origin;s=l.r,o=l.c}var u=r.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),m={s:{r:0,c:0},e:{r:s,c:o}};if(t["!ref"]){var p=il(t["!ref"]);m.s.r=Math.min(m.s.r,p.s.r),m.s.c=Math.min(m.s.c,p.s.c),m.e.r=Math.max(m.e.r,p.e.r),m.e.c=Math.max(m.e.c,p.e.c),s==-1&&(m.e.r=s=p.e.r+1)}var v=[],y=0,S=t["!rows"]||(t["!rows"]=[]),k=0,w=0,E=0,F=0,B=0,C=0;for(t["!cols"]||(t["!cols"]=[]);k<u.length&&w<f;++k){var M=u[k];if(Zp(M)){if(n.display)continue;S[w]={hidden:!0}}var re=M.children;for(E=F=0;E<re.length;++E){var O=re[E];if(!(n.display&&Zp(O))){var U=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):mv(O.innerHTML),ee=O.getAttribute("data-z")||O.getAttribute("z");for(y=0;y<v.length;++y){var I=v[y];I.s.c==F+o&&I.s.r<w+s&&w+s<=I.e.r&&(F=I.e.c+1-o,y=-1)}C=+O.getAttribute("colspan")||1,((B=+O.getAttribute("rowspan")||1)>1||C>1)&&v.push({s:{r:w+s,c:F+o},e:{r:w+s+(B||1)-1,c:F+o+(C||1)-1}});var ie={t:"s",v:U},oe=O.getAttribute("data-t")||O.getAttribute("t")||"";U!=null&&(U.length==0?ie.t=oe||"z":n.raw||U.trim().length==0||oe=="s"||(U==="TRUE"?ie={t:"b",v:!0}:U==="FALSE"?ie={t:"b",v:!1}:isNaN(ys(U))?isNaN(Qo(U).getDate())||(ie={t:"d",v:Fr(U)},n.cellDates||(ie={t:"n",v:wn(ie.v)}),ie.z=n.dateNF||gt[14]):ie={t:"n",v:ys(U)})),ie.z===void 0&&ee!=null&&(ie.z=ee);var X="",ae=O.getElementsByTagName("A");if(ae&&ae.length)for(var fe=0;fe<ae.length&&!(ae[fe].hasAttribute("href")&&(X=ae[fe].getAttribute("href"),X.charAt(0)!="#"));++fe);X&&X.charAt(0)!="#"&&(ie.l={Target:X}),n.dense?(t[w+s]||(t[w+s]=[]),t[w+s][F+o]=ie):t[ht({c:F+o,r:w+s})]=ie,m.e.c<F+o&&(m.e.c=F+o),F+=C}}++w}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),m.e.r=Math.max(m.e.r,w-1+s),t["!ref"]=Nt(m),w>=f&&(t["!fullref"]=Nt((m.e.r=u.length-k+w-1+s,m))),t}function w1(t,r){var e=r||{},n=e.dense?[]:{};return y1(n,t,r)}function _3(t,r){return ri(w1(t,r),r)}function Zp(t){var r="",e=S3(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function S3(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function E3(t){var r=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=Ot(r.replace(/<[^>]*>/g,""));return[e]}var ex={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function b1(t,r){var e=r||{},n=ph(t),s=[],o,l,u={name:""},f="",m=0,p,v,y={},S=[],k=e.dense?[]:{},w,E,F={value:""},B="",C=0,M=[],re=-1,O=-1,U={s:{r:1e6,c:1e7},e:{r:0,c:0}},ee=0,I={},ie=[],oe={},X=0,ae=0,fe=[],me=1,Te=1,be=[],le={Names:[]},te={},pe=["",""],A=[],N={},L="",V=0,q=!1,ce=!1,J=0;for(hc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=hc.exec(n);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"工作表":w[1]==="/"?(U.e.c>=U.s.c&&U.e.r>=U.s.r?k["!ref"]=Nt(U):k["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=U.e.r&&(k["!fullref"]=k["!ref"],U.e.r=e.sheetRows-1,k["!ref"]=Nt(U)),ie.length&&(k["!merges"]=ie),fe.length&&(k["!rows"]=fe),p.name=p.名称||p.name,typeof JSON<"u"&&JSON.stringify(p),S.push(p.name),y[p.name]=k,ce=!1):w[0].charAt(w[0].length-2)!=="/"&&(p=lt(w[0],!1),re=O=-1,U.s.r=U.s.c=1e7,U.e.r=U.e.c=0,k=e.dense?[]:{},ie=[],fe=[],ce=!0);break;case"table-row-group":w[1]==="/"?--ee:++ee;break;case"table-row":case"行":if(w[1]==="/"){re+=me,me=1;break}if(v=lt(w[0],!1),v.行号?re=v.行号-1:re==-1&&(re=0),me=+v["number-rows-repeated"]||1,me<10)for(J=0;J<me;++J)ee>0&&(fe[re+J]={level:ee});O=-1;break;case"covered-table-cell":w[1]!=="/"&&++O,e.sheetStubs&&(e.dense?(k[re]||(k[re]=[]),k[re][O]={t:"z"}):k[ht({r:re,c:O})]={t:"z"}),B="",M=[];break;case"table-cell":case"数据":if(w[0].charAt(w[0].length-2)==="/")++O,F=lt(w[0],!1),Te=parseInt(F["number-columns-repeated"]||"1",10),E={t:"z",v:null},F.formula&&e.cellFormula!=!1&&(E.f=Xp(Ot(F.formula))),(F.数据类型||F["value-type"])=="string"&&(E.t="s",E.v=Ot(F["string-value"]||""),e.dense?(k[re]||(k[re]=[]),k[re][O]=E):k[ht({r:re,c:O})]=E),O+=Te-1;else if(w[1]!=="/"){++O,B="",C=0,M=[],Te=1;var he=me?re+me-1:re;if(O>U.e.c&&(U.e.c=O),O<U.s.c&&(U.s.c=O),re<U.s.r&&(U.s.r=re),he>U.e.r&&(U.e.r=he),F=lt(w[0],!1),A=[],N={},E={t:F.数据类型||F["value-type"],v:null},e.cellFormula)if(F.formula&&(F.formula=Ot(F.formula)),F["number-matrix-columns-spanned"]&&F["number-matrix-rows-spanned"]&&(X=parseInt(F["number-matrix-rows-spanned"],10)||0,ae=parseInt(F["number-matrix-columns-spanned"],10)||0,oe={s:{r:re,c:O},e:{r:re+X-1,c:O+ae-1}},E.F=Nt(oe),be.push([oe,E.F])),F.formula)E.f=Xp(F.formula);else for(J=0;J<be.length;++J)re>=be[J][0].s.r&&re<=be[J][0].e.r&&O>=be[J][0].s.c&&O<=be[J][0].e.c&&(E.F=be[J][1]);switch((F["number-columns-spanned"]||F["number-rows-spanned"])&&(X=parseInt(F["number-rows-spanned"],10)||0,ae=parseInt(F["number-columns-spanned"],10)||0,oe={s:{r:re,c:O},e:{r:re+X-1,c:O+ae-1}},ie.push(oe)),F["number-columns-repeated"]&&(Te=parseInt(F["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=tr(F["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(F.value);break;case"percentage":E.t="n",E.v=parseFloat(F.value);break;case"currency":E.t="n",E.v=parseFloat(F.value);break;case"date":E.t="d",E.v=Fr(F["date-value"]),e.cellDates||(E.t="n",E.v=wn(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=LS(F["time-value"])/86400,e.cellDates&&(E.t="d",E.v=yd(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(F.数据数值);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",F["string-value"]!=null&&(B=Ot(F["string-value"]),M=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(q=!1,E.t==="s"&&(E.v=B||"",M.length&&(E.R=M),q=C==0),te.Target&&(E.l=te),A.length>0&&(E.c=A,A=[]),B&&e.cellText!==!1&&(E.w=B),q&&(E.t="z",delete E.v),(!q||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=re))for(var Y=0;Y<me;++Y){if(Te=parseInt(F["number-columns-repeated"]||"1",10),e.dense)for(k[re+Y]||(k[re+Y]=[]),k[re+Y][O]=Y==0?E:Hr(E);--Te>0;)k[re+Y][O+Te]=Hr(E);else for(k[ht({r:re+Y,c:O})]=E;--Te>0;)k[ht({r:re+Y,c:O+Te})]=Hr(E);U.e.c<=O&&(U.e.c=O)}Te=parseInt(F["number-columns-repeated"]||"1",10),O+=Te-1,Te=0,E={},B="",M=[]}te={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((o=s.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((o=s.pop())[0]!==w[3])throw"Bad state: "+o;N.t=B,M.length&&(N.R=M),N.a=L,A.push(N)}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);L="",V=0,B="",C=0,M=[];break;case"creator":w[1]==="/"?L=n.slice(V,w.index):V=w.index+w[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((o=s.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);B="",C=0,M=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(I[u.name]=f,(o=s.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&(f="",u=lt(w[0],!1),s.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":l=lt(w[0],!1),f+=ex[w[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":l=lt(w[0],!1),f+=ex[w[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(m,w.index);break}else m=w.index+w[0].length;break;case"named-range":l=lt(w[0],!1),pe=_f(l["cell-range-address"]);var xe={Name:l.name,Ref:pe[0]+"!"+pe[1]};ce&&(xe.Sheet=S.length),le.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(w[1]==="/"&&(!F||!F["string-value"])){var Pe=E3(n.slice(C,w.index));B=(B.length>0?B+`
`:"")+Pe[0]}else lt(w[0],!1),C=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{pe=_f(lt(w[0])["target-range-address"]),y[pe[0]]["!autofilter"]={ref:pe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(te=lt(w[0],!1),!te.href)break;te.Target=Ot(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(pe=_f(te.Target.slice(1)),te.Target="#"+pe[0]+"!"+pe[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(e.WTF)throw new Error(w)}}var K={Sheets:y,SheetNames:S,Workbook:le};return e.bookSheets&&delete K.Sheets,K}function tx(t,r){r=r||{},ts(t,"META-INF/manifest.xml")&&$2(pr(t,"META-INF/manifest.xml"),r);var e=Wn(t,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var n=b1(Xt(e),r);return ts(t,"meta.xml")&&(n.Props=Fv(pr(t,"meta.xml"))),n}function rx(t,r){return b1(t,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ah(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Kf(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Xt(Ji(t))}function Xf(t){var r=t.reduce(function(s,o){return s+o.length},0),e=new Uint8Array(r),n=0;return t.forEach(function(s){e.set(s,n),n+=s.length}),e}function nx(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function k3(t,r){for(var e=(t[r+15]&127)<<7|t[r+14]>>1,n=t[r+14]&1,s=r+13;s>=r;--s)n=n*256+t[s];return(t[r+15]&128?-n:n)*Math.pow(10,e-6176)}function xc(t,r){var e=r?r[0]:0,n=t[e]&127;e:if(t[e++]>=128&&(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return r&&(r[0]=e),n}function Cr(t){var r=0,e=t[r]&127;e:if(t[r++]>=128){if(e|=(t[r]&127)<<7,t[r++]<128||(e|=(t[r]&127)<<14,t[r++]<128)||(e|=(t[r]&127)<<21,t[r++]<128))break e;e|=(t[r]&127)<<28}return e}function tn(t){for(var r=[],e=[0];e[0]<t.length;){var n=e[0],s=xc(t,e),o=s&7;s=Math.floor(s/8);var l=0,u;if(s==0)break;switch(o){case 0:{for(var f=e[0];t[e[0]++]>=128;);u=t.slice(f,e[0])}break;case 5:l=4,u=t.slice(e[0],e[0]+l),e[0]+=l;break;case 1:l=8,u=t.slice(e[0],e[0]+l),e[0]+=l;break;case 2:l=xc(t,e),u=t.slice(e[0],e[0]+l),e[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(s," at offset ").concat(n))}var m={data:u,type:o};r[s]==null?r[s]=[m]:r[s].push(m)}return r}function Rh(t,r){return t?.map(function(e){return r(e.data)})||[]}function T3(t){for(var r,e=[],n=[0];n[0]<t.length;){var s=xc(t,n),o=tn(t.slice(n[0],n[0]+s));n[0]+=s;var l={id:Cr(o[1][0].data),messages:[]};o[2].forEach(function(u){var f=tn(u.data),m=Cr(f[3][0].data);l.messages.push({meta:f,data:t.slice(n[0],n[0]+m)}),n[0]+=m}),(r=o[3])!=null&&r[0]&&(l.merge=Cr(o[3][0].data)>>>0>0),e.push(l)}return e}function N3(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],n=xc(r,e),s=[];e[0]<r.length;){var o=r[e[0]]&3;if(o==0){var l=r[e[0]++]>>2;if(l<60)++l;else{var u=l-59;l=r[e[0]],u>1&&(l|=r[e[0]+1]<<8),u>2&&(l|=r[e[0]+2]<<16),u>3&&(l|=r[e[0]+3]<<24),l>>>=0,l++,e[0]+=u}s.push(r.slice(e[0],e[0]+l)),e[0]+=l;continue}else{var f=0,m=0;if(o==1?(m=(r[e[0]]>>2&7)+4,f=(r[e[0]++]&224)<<3,f|=r[e[0]++]):(m=(r[e[0]++]>>2)+1,o==2?(f=r[e[0]]|r[e[0]+1]<<8,e[0]+=2):(f=(r[e[0]]|r[e[0]+1]<<8|r[e[0]+2]<<16|r[e[0]+3]<<24)>>>0,e[0]+=4)),s=[Xf(s)],f==0)throw new Error("Invalid offset 0");if(f>s[0].length)throw new Error("Invalid offset beyond length");if(m>=f)for(s.push(s[0].slice(-f)),m-=f;m>=s[s.length-1].length;)s.push(s[s.length-1]),m-=s[s.length-1].length;s.push(s[0].slice(-f,-f+m))}}var p=Xf(s);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function C3(t){for(var r=[],e=0;e<t.length;){var n=t[e++],s=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,r.push(N3(n,t.slice(e,e+s))),e+=s}if(e!==t.length)throw new Error("data is not a valid framed stream!");return Xf(r)}function A3(t,r,e,n){var s=Ah(t),o=s.getUint32(4,!0),l=(n>1?12:8)+nx(o&(n>1?3470:398))*4,u=-1,f=-1,m=NaN,p=new Date(2001,0,1);o&512&&(u=s.getUint32(l,!0),l+=4),l+=nx(o&(n>1?12288:4096))*4,o&16&&(f=s.getUint32(l,!0),l+=4),o&32&&(m=s.getFloat64(l,!0),l+=8),o&64&&(p.setTime(p.getTime()+s.getFloat64(l,!0)*1e3),l+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:m};break;case 3:v={t:"s",v:r[f]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:e[u]};else if(f>-1)v={t:"s",v:r[f]};else if(!isNaN(m))v={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function R3(t,r,e){var n=Ah(t),s=n.getUint32(8,!0),o=12,l=-1,u=-1,f=NaN,m=NaN,p=new Date(2001,0,1);s&1&&(f=k3(t,o),o+=16),s&2&&(m=n.getFloat64(o,!0),o+=8),s&4&&(p.setTime(p.getTime()+n.getFloat64(o,!0)*1e3),o+=8),s&8&&(u=n.getUint32(o,!0),o+=4),s&16&&(l=n.getUint32(o,!0),o+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:f};break;case 3:v={t:"s",v:r[u]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:e[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return v}function I3(t,r,e){switch(t[0]){case 0:case 1:case 2:case 3:return A3(t,r,e,t[0]);case 5:return R3(t,r,e);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Qa(t){var r=tn(t);return xc(r[1][0].data)}function sx(t,r){var e=tn(r.data),n=Cr(e[1][0].data),s=e[3],o=[];return(s||[]).forEach(function(l){var u=tn(l.data),f=Cr(u[1][0].data)>>>0;switch(n){case 1:o[f]=Kf(u[3][0].data);break;case 8:{var m=t[Qa(u[9][0].data)][0],p=tn(m.data),v=t[Qa(p[1][0].data)][0],y=Cr(v.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var S=tn(v.data);o[f]=S[3].map(function(k){return Kf(k.data)}).join("")}break}}),o}function O3(t,r){var e,n,s,o,l,u,f,m,p,v,y,S,k,w,E=tn(t),F=Cr(E[1][0].data)>>>0,B=Cr(E[2][0].data)>>>0,C=((n=(e=E[8])==null?void 0:e[0])==null?void 0:n.data)&&Cr(E[8][0].data)>0||!1,M,re;if((o=(s=E[7])==null?void 0:s[0])!=null&&o.data&&r!=0)M=(u=(l=E[7])==null?void 0:l[0])==null?void 0:u.data,re=(m=(f=E[6])==null?void 0:f[0])==null?void 0:m.data;else if((v=(p=E[4])==null?void 0:p[0])!=null&&v.data&&r!=1)M=(S=(y=E[4])==null?void 0:y[0])==null?void 0:S.data,re=(w=(k=E[3])==null?void 0:k[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var O=C?4:1,U=Ah(M),ee=[],I=0;I<M.length/2;++I){var ie=U.getUint16(I*2,!0);ie<65535&&ee.push([I,ie])}if(ee.length!=B)throw"Expected ".concat(B," cells, found ").concat(ee.length);var oe=[];for(I=0;I<ee.length-1;++I)oe[ee[I][0]]=re.subarray(ee[I][1]*O,ee[I+1][1]*O);return ee.length>=1&&(oe[ee[ee.length-1][0]]=re.subarray(ee[ee.length-1][1]*O)),{R:F,cells:oe}}function j3(t,r){var e,n=tn(r.data),s=(e=n?.[7])!=null&&e[0]?Cr(n[7][0].data)>>>0>0?1:0:-1,o=Rh(n[5],function(l){return O3(l,s)});return{nrows:Cr(n[4][0].data)>>>0,data:o.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(f,m){if(l[u.R][m])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(m));l[u.R][m]=f}),l},[])}}function F3(t,r,e){var n,s=tn(r.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Cr(s[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(o.e.c=(Cr(s[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));e["!ref"]=Nt(o);var l=tn(s[4][0].data),u=sx(t,t[Qa(l[4][0].data)][0]),f=(n=l[17])!=null&&n[0]?sx(t,t[Qa(l[17][0].data)][0]):[],m=tn(l[3][0].data),p=0;m[1].forEach(function(v){var y=tn(v.data),S=t[Qa(y[2][0].data)][0],k=Cr(S.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var w=j3(t,S);w.data.forEach(function(E,F){E.forEach(function(B,C){var M=ht({r:p+F,c:C}),re=I3(B,u,f);re&&(e[M]=re)})}),p+=w.nrows})}function D3(t,r){var e=tn(r.data),n={"!ref":"A1"},s=t[Qa(e[2][0].data)],o=Cr(s[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return F3(t,s[0],n),n}function P3(t,r){var e,n=tn(r.data),s={name:(e=n[1])!=null&&e[0]?Kf(n[1][0].data):"",sheets:[]},o=Rh(n[2],Qa);return o.forEach(function(l){t[l].forEach(function(u){var f=Cr(u.meta[1][0].data);f==6e3&&s.sheets.push(D3(t,u))})}),s}function L3(t,r){var e=jh(),n=tn(r.data),s=Rh(n[1],Qa);if(s.forEach(function(o){t[o].forEach(function(l){var u=Cr(l.meta[1][0].data);if(u==2){var f=P3(t,l);f.sheets.forEach(function(m,p){Fh(e,m,p==0?f.name:f.name+"_"+p,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function Ef(t){var r,e,n,s,o={},l=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var m;try{m=C3(f.content)}catch(v){return console.log("?? "+f.content.length+" "+(v.message||v))}var p;try{p=T3(m)}catch(v){return console.log("## "+(v.message||v))}p.forEach(function(v){o[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var u=((s=(n=(e=(r=o?.[1])==null?void 0:r[0])==null?void 0:e.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Cr(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||l.forEach(function(f){o[f].forEach(function(m){var p=Cr(m.meta[1][0].data)>>>0;if(p==1)if(!u)u=m;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return L3(o,u)}function M3(t){return function(e){for(var n=0;n!=t.length;++n){var s=t[n];e[s[0]]===void 0&&(e[s[0]]=s[1]),s[2]==="n"&&(e[s[0]]=Number(e[s[0]]))}}}function Ih(t){M3([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function U3(t){return Ko.WS.indexOf(t)>-1?"sheet":t==Ko.CS?"chart":t==Ko.DS?"dialog":t==Ko.MS?"macro":t&&t.length?t:"sheet"}function $3(t,r){if(!t)return 0;try{t=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,U3(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function B3(t,r,e,n,s,o,l,u,f,m,p,v){try{o[n]=rc(Wn(t,e,!0),r);var y=pr(t,r),S;switch(u){case"sheet":S=K4(y,r,s,f,o[n],m,p,v);break;case"chart":if(S=X4(y,r,s,f,o[n],m,p,v),!S||!S["!drawel"])break;var k=Xl(S["!drawel"].Target,r),w=Vf(k),E=GT(Wn(t,k,!0),rc(Wn(t,w,!0),k)),F=Xl(E,k),B=Vf(F);S=R4(Wn(t,F,!0),F,f,rc(Wn(t,B,!0),F),m,S);break;case"macro":S=q4(y,r,s,f,o[n],m,p,v);break;case"dialog":S=J4(y,r,s,f,o[n],m,p,v);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=S;var C=[];o&&o[n]&&Ps(o[n]).forEach(function(M){var re="";if(o[n][M].Type==Ko.CMNT){re=Xl(o[n][M].Target,r);var O=e3(pr(t,re,!0),re,f);if(!O||!O.length)return;Wp(S,O,!1)}o[n][M].Type==Ko.TCMNT&&(re=Xl(o[n][M].Target,r),C=C.concat(XT(pr(t,re,!0),f)))}),C&&C.length&&Wp(S,C,!0,f.people||[])}catch(M){if(f.WTF)throw M}}function Zn(t){return t.charAt(0)=="/"?t.slice(1):t}function V3(t,r){if(av(),r=r||{},Ih(r),ts(t,"META-INF/manifest.xml")||ts(t,"objectdata.xml"))return tx(t,r);if(ts(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ef<"u"){if(t.FileIndex)return Ef(t);var e=Tt.utils.cfb_new();return pp(t).forEach(function(fe){WS(e,fe,VS(t,fe))}),Ef(e)}throw new Error("Unsupported NUMBERS file")}if(!ts(t,"[Content_Types].xml"))throw ts(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ts(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=pp(t),s=M2(Wn(t,"[Content_Types].xml")),o=!1,l,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",pr(t,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!pr(t,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),o=!0}s.workbooks[0].slice(-3)=="bin"&&(o=!0);var f={},m={};if(!r.bookSheets&&!r.bookProps){if(ac=[],s.sst)try{ac=Z4(pr(t,Zn(s.sst)),s.sst,r)}catch(fe){if(r.WTF)throw fe}r.cellStyles&&s.themes.length&&(f=Q4(Wn(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],r)),s.style&&(m=Y4(pr(t,Zn(s.style)),s.style,f,r))}s.links.map(function(fe){try{var me=rc(Wn(t,Vf(Zn(fe))),fe);return r3(pr(t,Zn(fe)),me,fe,r)}catch{}});var p=G4(pr(t,Zn(s.workbooks[0])),s.workbooks[0],r),v={},y="";s.coreprops.length&&(y=pr(t,Zn(s.coreprops[0]),!0),y&&(v=Fv(y)),s.extprops.length!==0&&(y=pr(t,Zn(s.extprops[0]),!0),y&&W2(y,v,r)));var S={};(!r.bookSheets||r.bookProps)&&s.custprops.length!==0&&(y=Wn(t,Zn(s.custprops[0]),!0),y&&(S=z2(y,r)));var k={};if((r.bookSheets||r.bookProps)&&(p.Sheets?l=p.Sheets.map(function(me){return me.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),r.bookProps&&(k.Props=v,k.Custprops=S),r.bookSheets&&typeof l<"u"&&(k.SheetNames=l),r.bookSheets?k.SheetNames:r.bookProps))return k;l={};var w={};r.bookDeps&&s.calcchain&&(w=t3(pr(t,Zn(s.calcchain)),s.calcchain));var E=0,F={},B,C;{var M=p.Sheets;v.Worksheets=M.length,v.SheetNames=[];for(var re=0;re!=M.length;++re)v.SheetNames[re]=M[re].name}var O=o?"bin":"xml",U=s.workbooks[0].lastIndexOf("/"),ee=(s.workbooks[0].slice(0,U+1)+"_rels/"+s.workbooks[0].slice(U+1)+".rels").replace(/^\//,"");ts(t,ee)||(ee="xl/_rels/workbook."+O+".rels");var I=rc(Wn(t,ee,!0),ee.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(r.xlmeta=n3(pr(t,Zn(s.metadata[0])),s.metadata[0],r)),(s.people||[]).length>=1&&(r.people=qT(pr(t,Zn(s.people[0])),r)),I&&(I=$3(I,p.Sheets));var ie=pr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=v.Worksheets;++E){var oe="sheet";if(I&&I[E]?(B="xl/"+I[E][1].replace(/[\/]?xl\//,""),ts(t,B)||(B=I[E][1]),ts(t,B)||(B=ee.replace(/_rels\/.*$/,"")+I[E][1]),oe=I[E][2]):(B="xl/worksheets/sheet"+(E+1-ie)+"."+O,B=B.replace(/sheet0\./,"sheet.")),C=B.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(E!=r.sheets)continue e;break;case"string":if(v.SheetNames[E].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var X=!1,ae=0;ae!=r.sheets.length;++ae)typeof r.sheets[ae]=="number"&&r.sheets[ae]==E&&(X=1),typeof r.sheets[ae]=="string"&&r.sheets[ae].toLowerCase()==v.SheetNames[E].toLowerCase()&&(X=1);if(!X)continue e}}B3(t,B,C,v.SheetNames[E],E,F,l,oe,r,p,f,m)}return k={Directory:s,Workbook:p,Props:v,Custprops:S,Deps:w,Sheets:l,SheetNames:v.SheetNames,Strings:ac,Styles:m,Themes:f,SSF:Hr(gt)},r&&r.bookFiles&&(t.files?(k.keys=n,k.files=t.files):(k.keys=[],k.files={},t.FullPaths.forEach(function(fe,me){fe=fe.replace(/^Root Entry[\/]/,""),k.keys.push(fe),k.files[fe]=t.FileIndex[me]}))),r&&r.bookVBA&&(s.vba.length>0?k.vbaraw=pr(t,Zn(s.vba[0]),!0):s.defaults&&s.defaults.bin===ZT&&(k.vbaraw=pr(t,"xl/vbaProject.bin",!0))),k}function W3(t,r){var e=r||{},n="Workbook",s=Tt.find(t,n);try{if(n="/!DataSpaces/Version",s=Tt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Dk(s.content),n="/!DataSpaces/DataSpaceMap",s=Tt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Lk(s.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Tt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=Mk(s.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Tt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);$k(s.content)}catch{}if(n="/EncryptionInfo",s=Tt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=Bk(s.content);if(n="/EncryptedPackage",s=Tt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,e.password||"",e);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,e.password||"",e);throw new Error("File is password-protected")}function Oh(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=Hn(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function H3(t,r){return Tt.find(t,"EncryptedPackage")?W3(t,r):v1(t,r)}function z3(t,r){var e,n=t,s=r||{};return s.type||(s.type=_t&&Buffer.isBuffer(t)?"buffer":"base64"),e=dv(n,s),V3(e,s)}function _1(t,r){var e=0;e:for(;e<t.length;)switch(t.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return zf(t.slice(e),r);default:break e}return mc.to_workbook(t,r)}function G3(t,r){var e="",n=Oh(t,r);switch(r.type){case"base64":e=Hn(t);break;case"binary":e=t;break;case"buffer":e=t.toString("binary");break;case"array":e=zi(t);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(e=Xt(e)),r.type="binary",_1(e,r)}function K3(t,r){var e=t;return r.type=="base64"&&(e=Hn(e)),e=uc.utils.decode(1200,e.slice(2),"str"),r.type="binary",_1(e,r)}function X3(t){return t.match(/[^\x00-\x7F]/)?ql(t):t}function kf(t,r,e,n){return n?(e.type="string",mc.to_workbook(t,e)):mc.to_workbook(r,e)}function gd(t,r){Kx();var e=r||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return gd(new Uint8Array(t),(e=Hr(e),e.type="array",e));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],o=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),Jo={},e.dateNF&&(Jo.dateNF=e.dateNF),e.type||(e.type=_t&&Buffer.isBuffer(t)?"buffer":"base64"),e.type=="file"&&(e.type=_t?"buffer":"binary",n=DS(t),typeof Uint8Array<"u"&&!_t&&(e.type="array")),e.type=="string"&&(o=!0,e.type="binary",e.codepage=65001,n=X3(t)),e.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return e=Hr(e),e.type="array",gd(uh(n),e)}switch((s=Oh(n,e))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return H3(Tt.read(n,e),e);break;case 9:if(s[1]<=8)return v1(n,e);break;case 60:return zf(n,e);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return _k(n,e);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return wk.to_workbook(n,e);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?z3(n,e):kf(t,n,e,o);case 239:return s[3]===60?zf(n,e):kf(t,n,e,o);case 255:if(s[1]===254)return K3(n,e);if(s[1]===0&&s[2]===2&&s[3]===0)return sc.to_workbook(n,e);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return sc.to_workbook(n,e);break;case 3:case 131:case 139:case 140:return Vp.to_workbook(n,e);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Zk.to_workbook(n,e);break;case 10:case 13:case 32:return G3(n,e);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return vk.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Vp.to_workbook(n,e):kf(t,n,e,o)}function q3(t,r,e,n,s,o,l,u){var f=zr(e),m=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,y=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:e,enumerable:!1})}catch{y.__rowNum__=e}else y.__rowNum__=e;if(!l||t[e])for(var S=r.s.c;S<=r.e.c;++S){var k=l?t[e][S]:t[n[S]+f];if(k===void 0||k.t===void 0){if(m===void 0)continue;o[S]!=null&&(y[o[S]]=m);continue}var w=k.v;switch(k.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(o[S]!=null){if(w==null)if(k.t=="e"&&w===null)y[o[S]]=null;else if(m!==void 0)y[o[S]]=m;else if(p&&w===null)y[o[S]]=null;else continue;else y[o[S]]=p&&(k.t!=="n"||k.t==="n"&&u.rawNumbers!==!1)?w:ha(k,w,u);w!=null&&(v=!1)}}return{row:y,isempty:v}}function qf(t,r){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},n=0,s=1,o=[],l=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},m=r||{},p=m.range!=null?m.range:t["!ref"];switch(m.header===1?n=1:m.header==="A"?n=2:Array.isArray(m.header)?n=3:m.header==null&&(n=0),typeof p){case"string":f=lr(p);break;case"number":f=lr(t["!ref"]),f.s.r=p;break;default:f=p}n>0&&(s=0);var v=zr(f.s.r),y=[],S=[],k=0,w=0,E=Array.isArray(t),F=f.s.r,B=0,C={};E&&!t[F]&&(t[F]=[]);var M=m.skipHidden&&t["!cols"]||[],re=m.skipHidden&&t["!rows"]||[];for(B=f.s.c;B<=f.e.c;++B)if(!(M[B]||{}).hidden)switch(y[B]=Nr(B),e=E?t[F][B]:t[y[B]+v],n){case 1:o[B]=B-f.s.c;break;case 2:o[B]=y[B];break;case 3:o[B]=m.header[B-f.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),u=l=ha(e,null,m),w=C[l]||0,!w)C[l]=1;else{do u=l+"_"+w++;while(C[u]);C[l]=w,C[u]=1}o[B]=u}for(F=f.s.r+s;F<=f.e.r;++F)if(!(re[F]||{}).hidden){var O=q3(t,f,F,y,n,o,E,m);(O.isempty===!1||(n===1?m.blankrows!==!1:m.blankrows))&&(S[k++]=O.row)}return S.length=k,S}var ax=/"/g;function J3(t,r,e,n,s,o,l,u){for(var f=!0,m=[],p="",v=zr(e),y=r.s.c;y<=r.e.c;++y)if(n[y]){var S=u.dense?(t[e]||[])[y]:t[n[y]+v];if(S==null)p="";else if(S.v!=null){f=!1,p=""+(u.rawNumbers&&S.t=="n"?S.v:ha(S,null,u));for(var k=0,w=0;k!==p.length;++k)if((w=p.charCodeAt(k))===s||w===o||w===34||u.forceQuotes){p='"'+p.replace(ax,'""')+'"';break}p=="ID"&&(p='"ID"')}else S.f!=null&&!S.F?(f=!1,p="="+S.f,p.indexOf(",")>=0&&(p='"'+p.replace(ax,'""')+'"')):p="";m.push(p)}return u.blankrows===!1&&f?null:m.join(l)}function S1(t,r){var e=[],n=r??{};if(t==null||t["!ref"]==null)return"";var s=lr(t["!ref"]),o=n.FS!==void 0?n.FS:",",l=o.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),m=new RegExp((o=="|"?"\\|":o)+"+$"),p="",v=[];n.dense=Array.isArray(t);for(var y=n.skipHidden&&t["!cols"]||[],S=n.skipHidden&&t["!rows"]||[],k=s.s.c;k<=s.e.c;++k)(y[k]||{}).hidden||(v[k]=Nr(k));for(var w=0,E=s.s.r;E<=s.e.r;++E)(S[E]||{}).hidden||(p=J3(t,s,E,v,l,f,o,n),p!=null&&(n.strip&&(p=p.replace(m,"")),(p||n.blankrows!==!1)&&e.push((w++?u:"")+p)));return delete n.dense,e.join("")}function Y3(t,r){r||(r={}),r.FS="	",r.RS=`
`;var e=S1(t,r);return e}function Q3(t){var r="",e,n="";if(t==null||t["!ref"]==null)return[];var s=lr(t["!ref"]),o="",l=[],u,f=[],m=Array.isArray(t);for(u=s.s.c;u<=s.e.c;++u)l[u]=Nr(u);for(var p=s.s.r;p<=s.e.r;++p)for(o=zr(p),u=s.s.c;u<=s.e.c;++u)if(r=l[u]+o,e=m?(t[p]||[])[u]:t[r],n="",e!==void 0){if(e.F!=null){if(r=e.F,!e.f)continue;n=e.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(e.f!=null)n=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)n=""+e.v;else if(e.t=="b")n=e.v?"TRUE":"FALSE";else if(e.w!==void 0)n="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?n="'"+e.v:n=""+e.v}}f[f.length]=r+"="+n}return f}function E1(t,r,e){var n=e||{},s=+!n.skipHeader,o=t||{},l=0,u=0;if(o&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?vn(n.origin):n.origin;l=f.r,u=f.c}var m,p={s:{c:0,r:0},e:{c:u,r:l+r.length-1+s}};if(o["!ref"]){var v=lr(o["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),l==-1&&(l=v.e.r+1,p.e.r=l+r.length-1+s)}else l==-1&&(l=0,p.e.r=r.length-1+s);var y=n.header||[],S=0;r.forEach(function(w,E){Ps(w).forEach(function(F){(S=y.indexOf(F))==-1&&(y[S=y.length]=F);var B=w[F],C="z",M="",re=ht({c:u+S,r:l+E+s});m=vc(o,re),B&&typeof B=="object"&&!(B instanceof Date)?o[re]=B:(typeof B=="number"?C="n":typeof B=="boolean"?C="b":typeof B=="string"?C="s":B instanceof Date?(C="d",n.cellDates||(C="n",B=wn(B)),M=n.dateNF||gt[14]):B===null&&n.nullError&&(C="e",B=0),m?(m.t=C,m.v=B,delete m.w,delete m.R,M&&(m.z=M)):o[re]=m={t:C,v:B},M&&(m.z=M))})}),p.e.c=Math.max(p.e.c,u+y.length-1);var k=zr(l);if(s)for(S=0;S<y.length;++S)o[Nr(S+u)+k]={t:"s",v:y[S]};return o["!ref"]=Nt(p),o}function Z3(t,r){return E1(null,t,r)}function vc(t,r,e){if(typeof r=="string"){if(Array.isArray(t)){var n=vn(r);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?vc(t,ht(r)):vc(t,ht({r,c:e||0}))}function eA(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function jh(){return{SheetNames:[],Sheets:{}}}function Fh(t,r,e,n){var s=1;if(!e)for(;s<=65535&&t.SheetNames.indexOf(e="Sheet"+s)!=-1;++s,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(e)>=0){var o=e.match(/(^.*?)(\d+)$/);s=o&&+o[2]||0;var l=o&&o[1]||e;for(++s;s<=65535&&t.SheetNames.indexOf(e=l+s)!=-1;++s);}if(M4(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function tA(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=eA(t,r);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[n].Hidden=e}function rA(t,r){return t.z=r,t}function k1(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}function nA(t,r,e){return k1(t,"#"+r,e)}function sA(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})}function aA(t,r,e,n){for(var s=typeof r!="string"?r:lr(r),o=typeof r=="string"?r:Nt(r),l=s.s.r;l<=s.e.r;++l)for(var u=s.s.c;u<=s.e.c;++u){var f=vc(t,l,u);f.t="n",f.F=o,delete f.v,l==s.s.r&&u==s.s.c&&(f.f=e,n&&(f.D=!0))}return t}var ix={encode_col:Nr,encode_row:zr,encode_cell:ht,encode_range:Nt,decode_col:yh,decode_row:vh,split_cell:x2,decode_cell:vn,decode_range:il,format_cell:ha,sheet_add_aoa:Av,sheet_add_json:E1,sheet_add_dom:y1,aoa_to_sheet:ol,json_to_sheet:Z3,table_to_sheet:w1,table_to_book:_3,sheet_to_csv:S1,sheet_to_txt:Y3,sheet_to_json:qf,sheet_to_html:b3,sheet_to_formulae:Q3,sheet_to_row_object_array:qf,sheet_get_cell:vc,book_new:jh,book_append_sheet:Fh,book_set_sheet_visibility:tA,cell_set_number_format:rA,cell_set_hyperlink:k1,cell_set_internal_link:nA,cell_add_comment:sA,sheet_set_array_formula:aA,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const iA=({isOpen:t,onClose:r,onImport:e})=>{const[n,s]=j.useState(null),[o,l]=j.useState([]),[u,f]=j.useState(!1),[m,p]=j.useState(null),[v,y]=j.useState([]),[S,k]=j.useState(""),w=j.useRef(null),E=ee=>{const I=ee.target.files?.[0];I&&(s(I),p(null),l([]),y([]),k(""))},F=ee=>{const I=Math.round(ee*24*60*60),ie=Math.floor(I/3600),oe=Math.floor(I%3600/60),X=I%60;return`${ie.toString().padStart(2,"0")}:${oe.toString().padStart(2,"0")}:${X.toString().padStart(2,"0")}`},B=ee=>{const I=ee.toString().toLowerCase();let ie=ee,oe=!1,X=!1;return(I.includes("ppt")||I.includes("powerpoint"))&&(oe=!0,ie=ie.replace(/\+?\s*ppt\s*\+?/gi,"").replace(/\+?\s*powerpoint\s*\+?/gi,"")),(I.includes("q&a")||I.includes("qa"))&&(X=!0,ie=ie.replace(/\+?\s*q&a\s*\+?/gi,"").replace(/\s*\+\s*qa\s*\+?/gi,"")),ie=ie.replace(/^\++|\++$/g,"").replace(/\s*\+\s*/g," ").trim(),{shotType:ie,hasPPT:oe,hasQA:X}},C=(ee,I)=>{if(!ee.trim())return null;const ie=ee.split(`
`).map(oe=>oe.trim());if(ie.length>=2){let oe=ie[0],X="Seat";oe.startsWith("*P*")?(X="Podium",oe=oe.replace("*P*","").trim()):oe.startsWith("*M*")?(X="Moderator",oe=oe.replace("*M*","").trim()):oe.startsWith("*V*")&&(X="Virtual",oe=oe.replace("*V*","").trim());const ae=ie[1];let fe="",me="";for(let Te=ie.length-1;Te>=2;Te--)if(ie[Te]&&(ie[Te].startsWith("http://")||ie[Te].startsWith("https://"))){fe=ie[Te],Te>2&&ie[Te-1]&&(me=ie[Te-1]);break}return!fe&&ie[2]&&(me=ie[2]),{id:`speaker-${I}`,slot:I,location:X,fullName:oe,title:ae,org:me,photoUrl:fe}}return null},M=async()=>{if(n){f(!0),p(null);try{const ee=await n.arrayBuffer(),I=gd(ee),ie=I.SheetNames;if(y(ie),ie.length>1){k(ie[0]),l([]);return}const oe=ie[0],X=I.Sheets[oe],ae=ix.sheet_to_json(X,{header:1});if(ae.length<12)throw new Error("Excel file must have at least 12 rows. Headers should be in row 11, data should start from row 12.");const fe=ae[10];if(!fe||fe.length===0)throw new Error("No headers found in row 11. Please ensure headers are in row 11.");const me=[];for(let Te=11;Te<ae.length;Te++){const be=ae[Te];if(!be||be.length===0)continue;const le={row:Te-10,cue:"",segmentName:"",duration:"",shotType:"",hasPPT:!1,hasQA:!1,programType:"",notes:"",assets:"",speakers:""};if(be[0]&&(le.cue=be[0].toString()),be[2]){let pe=be[2].toString();pe.toLowerCase()==="pod transition"&&(pe="Podium Transition"),le.programType=pe}if(be[3]){const pe=be[3];typeof pe=="number"&&pe<1?le.duration=F(pe):le.duration=pe.toString()}if(be[9]&&(le.segmentName=be[9].toString()),be[10]){const pe=be[10].toString(),{shotType:A,hasPPT:N,hasQA:L}=B(pe);le.shotType=A,le.hasPPT=N,le.hasQA=L}be[11]&&(le.notes=be[11].toString()),be[13]&&(le.assets=be[13].toString());const te=[];for(let pe=21;pe<=27;pe++)if(be[pe]){const A=be[pe].toString().trim();if(A&&A.length>0&&A!==""){const N=pe-20,L=C(A,N);L&&L.fullName&&L.fullName.trim()!==""&&te.push(L)}}te.length>0&&(le.speakers=JSON.stringify(te)),me.push(le)}l(me),console.log("✅ Excel parsing completed:",me.length,"rows")}catch(ee){console.error("❌ Error parsing Excel:",ee),p(ee instanceof Error?ee.message:"Failed to parse Excel file")}finally{f(!1)}}},re=async()=>{if(!(!n||!S)){f(!0),p(null);try{const ee=await n.arrayBuffer(),ie=gd(ee).Sheets[S],oe=ix.sheet_to_json(ie,{header:1});if(oe.length<12)throw new Error("Excel file must have at least 12 rows. Headers should be in row 11, data should start from row 12.");const X=oe[10];if(!X||X.length===0)throw new Error("No headers found in row 11. Please ensure headers are in row 11.");const ae=[];for(let fe=11;fe<oe.length;fe++){const me=oe[fe];if(!me||me.length===0)continue;const Te={row:fe-10,cue:"",segmentName:"",duration:"",shotType:"",hasPPT:!1,hasQA:!1,programType:"",notes:"",assets:"",speakers:""};if(me[0]&&(Te.cue=me[0].toString()),me[2]){let le=me[2].toString();le.toLowerCase()==="pod transition"&&(le="Podium Transition"),Te.programType=le}if(me[3]){const le=me[3];typeof le=="number"&&le<1?Te.duration=F(le):Te.duration=le.toString()}if(me[9]&&(Te.segmentName=me[9].toString()),me[10]){const le=me[10].toString(),{shotType:te,hasPPT:pe,hasQA:A}=B(le);Te.shotType=te,Te.hasPPT=pe,Te.hasQA=A}me[11]&&(Te.notes=me[11].toString()),me[13]&&(Te.assets=me[13].toString());const be=[];for(let le=21;le<=27;le++)if(me[le]){const te=me[le].toString().trim();if(te&&te.length>0&&te!==""){const pe=le-20,A=C(te,pe);A&&A.fullName&&A.fullName.trim()!==""&&be.push(A)}}be.length>0&&(Te.speakers=JSON.stringify(be)),ae.push(Te)}l(ae),console.log("✅ Excel parsing completed:",ae.length,"rows")}catch(ee){console.error("❌ Error parsing Excel:",ee),p(ee instanceof Error?ee.message:"Failed to parse Excel file")}finally{f(!1)}}},O=()=>{o.length!==0&&(e(o),r())},U=()=>{s(null),l([]),p(null),y([]),k(""),r()};return t?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 w-full max-w-4xl max-h-[80vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:"Import Excel File"}),c.jsx("button",{onClick:U,className:"text-gray-400 hover:text-white text-2xl",children:"×"})]}),c.jsxs("div",{className:"space-y-4",children:[o.length===0&&c.jsxs("div",{className:"bg-slate-700 p-4 rounded-md",children:[c.jsx("h3",{className:"text-white font-semibold mb-2",children:"Excel File Format Requirements:"}),c.jsxs("ul",{className:"text-gray-300 text-sm space-y-1",children:[c.jsx("li",{children:"• Headers should be in row 11, data should start from row 12"}),c.jsx("li",{children:"• Expected columns: A=CUE, C=Program Type, D=Duration, J=Segment Name, K=Shot Type+PPT+QA, L=Notes, N=Assets, V-AB=Speakers"}),c.jsx("li",{children:'• "Pod Transition" will be converted to "Podium Transition"'}),c.jsx("li",{children:"• Excel decimal time format (0.002083...) will be converted to HH:MM:SS"}),c.jsx("li",{children:"• Speaker format: Name, Title, [Org], Photo URL (with line breaks). Use *P* (Podium), *M* (Moderator), *V* (Virtual) prefixes"})]})]}),o.length===0&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Select Excel File (.xlsx, .xls)"}),c.jsx("input",{ref:w,type:"file",accept:".xlsx,.xls",onChange:E,className:"block w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700"})]}),n&&o.length===0&&c.jsxs("div",{className:"bg-slate-700 p-3 rounded-md",children:[c.jsxs("p",{className:"text-white text-sm",children:[c.jsx("strong",{children:"Selected file:"})," ",n.name]}),c.jsxs("p",{className:"text-gray-300 text-sm",children:[c.jsx("strong",{children:"Size:"})," ",(n.size/1024).toFixed(2)," KB"]})]}),v.length>1&&o.length===0&&c.jsxs("div",{children:[c.jsxs("label",{className:"block text-white text-sm font-medium mb-2",children:["Select Sheet (",v.length," sheets found)"]}),c.jsx("select",{value:S,onChange:ee=>k(ee.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:v.map(ee=>c.jsx("option",{value:ee,children:ee},ee))})]}),o.length===0&&c.jsx("div",{className:"flex justify-center",children:c.jsx("button",{onClick:v.length>1?re:M,disabled:!n||u||v.length>1&&!S,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-medium rounded-md transition-colors",children:u?"Parsing...":"Parse Excel File"})}),m&&c.jsxs("div",{className:"bg-red-600 text-white p-3 rounded-md",children:[c.jsx("strong",{children:"Error:"})," ",m]}),o.length>0&&c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-white mb-3",children:["Preview (",o.length," rows found)"]}),c.jsx("div",{className:"border border-slate-600 rounded-md bg-slate-700 max-h-96 overflow-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"sticky top-0 bg-slate-600",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Row"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"CUE"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Segment Name"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Duration"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Shot Type"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"PPT/QA"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Program Type"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Notes"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Assets"}),c.jsx("th",{className:"px-3 py-2 text-left text-white text-sm",children:"Speakers"})]})}),c.jsx("tbody",{children:o.map((ee,I)=>c.jsxs("tr",{className:"border-t border-slate-600 hover:bg-slate-600",children:[c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:ee.row}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:ee.cue}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:ee.segmentName}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:ee.duration}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:ee.shotType}),c.jsxs("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:[ee.hasPPT&&"PPT ",ee.hasQA&&"QA",!ee.hasPPT&&!ee.hasQA&&"-"]}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:ee.programType}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:ee.notes?ee.notes.length>30?`${ee.notes.substring(0,30)}...`:ee.notes:"None"}),c.jsx("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:ee.assets?ee.assets.length>30?`${ee.assets.substring(0,30)}...`:ee.assets:"None"}),c.jsx("td",{className:"px-3 py-2 text-white text-sm",children:ee.speakers?(()=>{try{const ie=JSON.parse(ee.speakers);return ie.length>0?`${ie.length} speaker(s)`:"None"}catch{return"None"}})():"None"})]},I))})]})}),c.jsxs("div",{className:"flex justify-center gap-4 mt-4",children:[c.jsxs("button",{onClick:O,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-md transition-colors",children:["Import ",o.length," Items"]}),c.jsx("button",{onClick:()=>{s(null),l([]),p(null),w.current&&(w.current.value="")},className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:"Import Another File"})]})]}),c.jsx("div",{className:"flex justify-center",children:c.jsx("button",{onClick:U,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-md transition-colors",children:"Cancel"})})]})]})}):null},oA=()=>{const t=jn(),r=rl();let e=t.state?.event,n=t.state?.userRole;const{user:s,loading:o}=Xi(),[l,u]=j.useState("VIEWER"),[f,m]=j.useState(!1),[p,v]=j.useState(!1),[y,S]=j.useState([]),[k,w]=j.useState([]),[E,F]=j.useState(!1),[B,C]=j.useState(new Map),M=j.useRef(new Map),re=j.useRef(new Set),O=(h,_,T)=>{if(l!=="EDITOR"&&l!=="OPERATOR"||!s||!e?.id){console.log("⚠️ Not logging change - missing requirements:",{role:l,user:!!s,event:!!e?.id});return}let R=_,G,ne;T?.itemId&&(G=I.findIndex(Re=>Re.id===T.itemId)+1,ne=I.find(Re=>Re.id===T.itemId)?.customFields?.cue||"CUE",R=`ROW ${G} - ${yr(ne)}: ${_}`),Sr.addChange({eventId:e.id,userId:s.id,userName:s.user_metadata?.full_name||s.email||"Unknown",userRole:l,action:h,description:R,details:T,rowNumber:G,cueNumber:ne,segmentName:T?.itemName||T?.segmentName});const ue=Sr.getLocalChanges();S(ue.slice(0,100)),console.log("📝 Change logged to buffer:",R)},U=(h,_,T,R)=>{if(l!=="EDITOR"&&l!=="OPERATOR"){console.log("⚠️ Not logging change - user role is not EDITOR or OPERATOR:",l);return}const G=R?.fieldName?.includes("Name")||R?.fieldName?.includes("segmentName")||R?.fieldName?.includes("cue")||R?.fieldName?.includes("custom"),ne=G?`text_${R?.itemId}_${R?.fieldName}`:h,ue=M.current.get(ne);ue&&(clearTimeout(ue),M.current.delete(ne)),C(Ke=>{const Ue=new Map(Ke);for(const[qe,ot]of Ue.entries())ot.originalKey===ne&&Ue.delete(qe);return Ue});let Ne=T,Re={...R};if(R?.itemId){const Ke=I.findIndex(ot=>ot.id===R.itemId)+1,qe=I.find(ot=>ot.id===R.itemId)?.customFields?.cue||"CUE";Ne=`ROW ${Ke} - ${yr(qe)}: ${T}`,Re={...R,rowNumber:Ke,cueNumber:qe}}if(G)C(Ke=>{const Ue=new Map(Ke);for(const[ot,jt]of Ue.entries())jt.originalKey===ne&&Ue.delete(ot);const qe=`${ne}_${Date.now()}`;return Ue.set(qe,{action:_,description:Ne,details:Re,timestamp:new Date,user:s?.user_metadata?.full_name||s?.email||"Unknown User",originalKey:ne}),console.log("📝 Updated text field pending change:",qe,"for baseKey:",ne),console.log("📝 Total pending changes:",Ue.size),console.log("📝 Pending change details:",{action:_,description:Ne,baseKey:ne,uniqueKey:qe}),Ue});else{const Ke=`${ne}_${Date.now()}`;C(Ue=>{const qe=new Map(Ue.set(Ke,{action:_,description:Ne,details:Re,timestamp:new Date,user:s?.user_metadata?.full_name||s?.email||"Unknown User",originalKey:ne}));return console.log("📝 Added pending change:",Ke,"for baseKey:",ne),console.log("📝 Total pending changes:",qe.size),console.log("📝 Pending change details:",{action:_,description:Ne,baseKey:ne,uniqueKey:Ke}),qe})}const We=setTimeout(async()=>{console.log("🕐 TIMEOUT FIRED for baseKey:",ne),C(Ke=>{let Ue=null,qe=null;console.log("🕐 TIMEOUT: Looking for baseKey:",ne),console.log("🕐 TIMEOUT: Available pending changes:",Array.from(Ke.entries()).map(([jt,Yt])=>({key:jt,originalKey:Yt.originalKey})));for(const[jt,Yt]of Ke.entries())if(Yt.originalKey===ne){Ue=Yt,qe=jt,console.log("🕐 TIMEOUT: Found match - key:",jt,"originalKey:",Yt.originalKey);break}console.log("🕐 TIMEOUT: Found pending change:",Ue?"YES":"NO"),console.log("🕐 TIMEOUT: Change key:",qe),console.log("🕐 TIMEOUT: Has change key in prev:",Ke.has(qe||""));const ot=`${ne}-${Ue?.timestamp?.getTime()||Date.now()}`;if(console.log("🕐 TIMEOUT: Change ID:",ot),console.log("🕐 TIMEOUT: Already processed:",re.current.has(ot)),Ue&&qe&&Ke.has(qe)&&s&&e?.id&&!re.current.has(ot)){console.log("🕐 TIMEOUT: Processing change..."),re.current.add(ot);const jt={eventId:e.id,userId:s.id,userName:s.user_metadata?.full_name||s.email||"Unknown",userRole:l||"VIEWER",action:Ue?.action||"unknown",description:Ue?.description||"unknown",details:Ue?.details||{},rowNumber:Ue?.details?.rowNumber,cueNumber:Ue?.details?.cueNumber,segmentName:Ue?.details?.itemName||Ue?.details?.segmentName};console.log("🔄 Adding change to service:",jt),Sr.addChange(jt);const Yt=Sr.getLocalChanges();console.log("🔄 Local changes after adding to service:",Yt.length),console.log("🔄 Latest change:",Yt[Yt.length-1]),console.log("🔄 Current changeLog state length:",y.length),S(Yt.slice(0,100)),console.log("🔄 Set changeLog to:",Yt.slice(0,100).length,"changes"),console.log("✅ Debounced change logged to change log service:",Ue?.description||"unknown"),console.log("🔄 Removed pending change from queue:",qe),console.log("🔄 Auto-syncing changes after timeout... (with 3s additional delay)"),setTimeout(()=>{uo().then(()=>{console.log("✅ Auto-sync completed after timeout + 3s delay"),fi(!0),console.log("⏭️ Set skipNextSync flag to prevent false reset")}).catch(Mn=>{console.error("❌ Auto-sync failed after timeout + 3s delay:",Mn)})},3e3),M.current.delete(ne);const fn=new Map(Ke);return fn.delete(qe),console.log("🔄 Pending changes after removal:",fn.size),console.log("🔄 Remaining pending keys:",Array.from(fn.keys())),fn}else{M.current.delete(ne),re.current.has(ot)?console.log("⚠️ Prevented duplicate processing of change:",ot):console.log("ℹ️ Pending change already processed or removed:",ne);const jt=Date.now(),Yt=new Map(Ke);let fn=0;for(const[Mn,Bt]of Yt.entries()){const Aa=jt-Bt.timestamp.getTime();Aa>15e3&&(console.log("🧹 Removing stale pending change:",Mn,"age:",Aa+"ms"),Yt.delete(Mn),fn++)}return fn>0?(console.log("🧹 Removed",fn,"stale pending changes"),Yt):Ke}})},5e3);M.current.set(ne,We),console.log("⏰ Set timeout for baseKey:",ne,"in",5e3,"ms"),console.log("⏰ Total active timeouts:",M.current.size)},ee=async()=>{console.log("🔄 Finalizing all pending changes...");const h=Array.from(B.entries());if(h.length===0){console.log("ℹ️ No pending changes to finalize");return}M.current.forEach(R=>{clearTimeout(R)}),M.current.clear(),console.log(`🔄 Processing ${h.length} pending changes immediately...`);const _=new Set;for(const[R,G]of h)if(G&&s&&e?.id){const ne=`${G.originalKey||R}-${G.timestamp.getTime()}`;if(re.current.has(ne)){console.log("⚠️ Skipping already processed change:",ne);continue}re.current.add(ne),_.add(ne);let ue=G.description,Ne,Re;G.details?.itemId&&(Ne=I.findIndex(Ke=>Ke.id===G.details.itemId)+1,Re=I.find(Ke=>Ke.id===G.details.itemId)?.customFields?.cue||"CUE",ue=`ROW ${Ne} - ${yr(Re)}: ${G.description}`),Sr.addChange({eventId:e.id,userId:s.id,userName:s.user_metadata?.full_name||s.email||"Unknown",userRole:l||"VIEWER",action:G.action,description:ue,details:G.details,rowNumber:Ne,cueNumber:Re,segmentName:G.details?.itemName||G.details?.segmentName}),console.log("✅ Processed pending change immediately:",ue)}C(new Map);const T=Sr.getLocalChanges();S(T.slice(0,100)),console.log(`✅ All ${_.size} pending changes processed immediately`),console.log("🔄 Auto-syncing changes after manual finalization...");try{await uo(),console.log("✅ Auto-sync completed after manual finalization")}catch(R){console.error("❌ Auto-sync failed after manual finalization:",R)}setTimeout(()=>{_.forEach(R=>{re.current.delete(R)}),console.log("🧹 Cleaned up processed change tracking for",_.size,"changes")},6e4)};if(j.useEffect(()=>()=>{M.current.forEach(h=>clearTimeout(h))},[]),j.useEffect(()=>{const h=setInterval(()=>{C(_=>{const T=Date.now(),R=new Map(_);let G=0;for(const[ne,ue]of R.entries()){const Ne=T-ue.timestamp.getTime();Ne>2e4&&(console.log("🧹 Periodic cleanup: Removing stale pending change:",ne,"age:",Ne+"ms"),R.delete(ne),G++)}return G>0&&console.log("🧹 Periodic cleanup: Removed",G,"stale pending changes"),R})},5e3);return()=>clearInterval(h)},[]),j.useEffect(()=>{const h=Sr.getChangesCount().unsynced;di(h)},[y,B]),!e){const h=localStorage.getItem("events");if(h){const _=JSON.parse(h);e=_[_.length-1]}}console.log("Event from location.state:",t.state?.event),console.log("Final event data:",e);const[I,ie]=j.useState([]),[oe,X]=j.useState([]),[ae,fe]=j.useState(e?.name||""),[me,Te]=j.useState(""),[be,le]=j.useState({}),[te,pe]=j.useState(1),[A,N]=j.useState(null),[L,V]=j.useState(!1),[q,ce]=j.useState({show:!1}),[J,he]=j.useState(!1),[Y,xe]=j.useState(!1),[Pe,K]=j.useState(null),[Xe,we]=j.useState(!1),[Fe,Oe]=j.useState(!1),[Ae,at]=j.useState(null),[St,wt]=j.useState(!1),[Et,Vt]=j.useState(null),[kt,Ct]=j.useState([]),[At,Ht]=j.useState(!1),[Zt,qt]=j.useState(null),[an,ct]=j.useState(!1),[Lt,Dr]=j.useState(null),[Wt,on]=j.useState(!1),[Fn,ws]=j.useState(null),[vr,Pr]=j.useState([]),[it,Gr]=j.useState({}),[Lr,bn]=j.useState({}),[bt,ln]=j.useState({}),[ni,_n]=j.useState({}),[zt,Sn]=j.useState(null),[$s,bs]=j.useState(null),[pa,ss]=j.useState(!1),[Ac,zn]=j.useState(null),[si,P]=j.useState(null),[W,z]=j.useState(null),[H,Q]=j.useState({}),[Z,ve]=j.useState({}),[Ie,_e]=j.useState(new Set),[Ee,ke]=j.useState(null),[Be,He]=j.useState({}),[Je,Me]=j.useState(!1),[De,ut]=j.useState(null),[Mt,Dt]=j.useState(!1),[Ut,Gn]=j.useState(""),[as,Dn]=j.useState(!1),[dr,Bs]=j.useState(!1),[rr,Rc]=j.useState(!1),[to,ll]=j.useState(!1),[ro,ai]=j.useState(!1),[xa,ii]=j.useState([]),[Dh,cl]=j.useState({totalBackups:0,lastBackup:null,autoBackups:0,manualBackups:0}),[ul,oi]=j.useState(!1),[cn,va]=j.useState(null),[Vs,dl]=j.useState(!0),[Rt,Ic]=j.useState(null),[ft,Kr]=j.useState({start:!0,programType:!0,duration:!0,segmentName:!0,shotType:!0,pptQA:!0,notes:!0,assets:!0,participants:!1,speakers:!0,public:!0,custom:!0}),[li,no]=j.useState({}),[xt,fl]=j.useState({start:128,programType:224,duration:224,segmentName:320,shotType:192,pptQA:192,notes:384,assets:192,participants:256,speakers:384,public:128}),[Ws,_s]=j.useState({}),[fr,is]=j.useState(!1);j.useEffect(()=>{const h=localStorage.getItem(`followEnabled_${e?.id}`);h!==null&&is(h==="true")},[e?.id]),j.useEffect(()=>{localStorage.setItem(`followEnabled_${e?.id}`,fr.toString())},[fr,e?.id]),j.useEffect(()=>{if(fr&&W){const h=localStorage.getItem(`scrollPosition_${e?.id}`);if(h){const _=parseInt(h);setTimeout(()=>{window.scrollTo({top:_,behavior:"smooth"})},100)}}},[W,fr,e?.id]);const[ya,Pn]=j.useState(new Set),yr=h=>h?h.includes("CUE ")?h:h.replace(/^CUE(\d+)$/,"CUE $1"):"CUE",[Oc,Hs]=j.useState(new Set),[wa,ci]=j.useState(null),[jc,ui]=j.useState(!1),[zs,Ss]=j.useState(!1),[Es,di]=j.useState(0),[un,ba]=j.useState(null),[so,Sd]=j.useState(0),[hl,fi]=j.useState(!1),[_a,Gs]=j.useState(!1),[dn,Sa]=j.useState(null),[ao,hi]=j.useState(20),[io,Ks]=j.useState(!1),Xs=j.useRef(null),vt=()=>{console.log("✏️ User started editing - pausing sync"),Gs(!0),dn&&clearTimeout(dn);const h=setTimeout(()=>{console.log("⏸️ User stopped editing - resuming sync"),Gs(!1),Ea()},5e3);Sa(h)},hr=()=>{console.log("✏️ Modal opened - pausing sync until closed"),Gs(!0),dn&&(clearTimeout(dn),Sa(null))},Ea=j.useCallback(()=>{Xs.current&&clearInterval(Xs.current),hi(20),Ks(!1);const h=setInterval(()=>{hi(_=>_<=1?(Ks(!0),setTimeout(()=>{Ks(!1),hi(20)},3e3),0):_-1)},1e3);Xs.current=h},[]),ka=j.useCallback(()=>{Xs.current&&(clearInterval(Xs.current),Xs.current=null),hi(20),Ks(!1)},[]),Mr=()=>{console.log("✏️ Modal closed - resuming sync in 5 seconds");const h=setTimeout(()=>{console.log("⏸️ User stopped editing - resuming sync"),Gs(!1),Ea()},5e3);Sa(h)};j.useEffect(()=>{if(o){console.log("⏳ Authentication still loading, waiting...");return}s&&e?.id?(async()=>{try{console.log("🔍 Loading role from Supabase for user:",s.id,"event:",e.id);const _=await Ge.getCurrentUserSession(s.id,e.id);if(console.log("📋 User session from Supabase:",_),_&&_.event_id===e.id&&_.user_role)return u(_.user_role),console.log("✅ Loaded role from Supabase:",_.user_role),localStorage.setItem(`userRole_${e.id}`,_.user_role),console.log("💾 Updated localStorage with Supabase role:",_.user_role),!0;console.log("❌ No valid role found in Supabase:",{hasSession:!!_,eventIdMatch:_?.event_id===e.id,hasRole:!!_?.user_role,userSessionEventId:_?.event_id,currentEventId:e.id,userRole:_?.user_role})}catch(_){console.log("⚠️ Failed to load role from Supabase:",_)}return!1})().then(_=>{if(_){console.log("✅ Using role from Supabase");return}if(n&&["VIEWER","EDITOR","OPERATOR"].includes(n)){u(n),Ge.saveUserSession(e.id,s.id,s.user_metadata?.full_name||s.email||"Unknown",n).then(ne=>{ne?console.log("✅ Role saved to Supabase from navigation state:",n):console.log("⚠️ Failed to save role to Supabase, using localStorage only")}),localStorage.setItem(`userRole_${e.id}`,n),console.log("💾 Saved role to localStorage:",n),console.log("✅ Using role from navigation state (no Supabase role found):",n);return}const T=localStorage.getItem(`userRole_${e.id}`);if(console.log("🔍 Checking localStorage for role:",{eventId:e.id,savedRole:T}),T&&["VIEWER","EDITOR","OPERATOR"].includes(T)){u(T),console.log("✅ Using role from localStorage fallback:",T),Ge.saveUserSession(e.id,s.id,s.user_metadata?.full_name||s.email||"Unknown",T).then(ne=>{ne?console.log("✅ Role synced to Supabase from localStorage:",T):console.log("⚠️ Failed to sync role to Supabase, keeping localStorage only")});return}const R=Object.keys(localStorage),G=R.filter(ne=>ne.startsWith("userRole_"));if(console.log("🔍 Checking all localStorage role keys:",G),console.log("🔍 Current event ID:",e.id),console.log("🔍 All localStorage keys:",R),G.length>0){const ne=G[G.length-1],ue=localStorage.getItem(ne);if(console.log("🔍 Found latest role in localStorage:",{key:ne,role:ue}),ue&&["VIEWER","EDITOR","OPERATOR"].includes(ue)){u(ue),console.log("✅ Using latest role from localStorage:",ue),localStorage.setItem(`userRole_${e.id}`,ue),Ge.saveUserSession(e.id,s.id,s.user_metadata?.full_name||s.email||"Unknown",ue).then(Ne=>{Ne?console.log("✅ Role synced to Supabase from latest localStorage:",ue):console.log("⚠️ Failed to sync role to Supabase, keeping localStorage only")});return}}console.log("❌ No role found, showing role selection modal"),m(!0)}):!s&&e?.id&&(console.log("❌ No user authenticated, defaulting to VIEWER role"),u("VIEWER"))},[s,e?.id,o,n,r]),j.useEffect(()=>{if(e?.id){console.log("🔄 Loading change log data for event:",e.id),Sr.reloadLocalChanges();const h=Sr.getLocalChanges();S(h.slice(0,100)),console.log("📝 Loaded local changes:",h.length),xl(),kd(),pl(),lo(),Td();const _=setInterval(()=>{const T=Sr.getLocalChanges();S(T.slice(0,100))},2e3);return()=>clearInterval(_)}},[e?.id]);const[ml,mi]=j.useState(!1),[qs,oo]=j.useState(null),[gl,Ed]=j.useState(!1);j.useEffect(()=>{e?.id&&I.length>0&&!gl&&(console.log("🔄 Schedule loaded, checking for running timers for event:",e.id),Nd(),Ed(!0))},[e?.id,I.length,gl]),j.useEffect(()=>{if(!e?.id)return;const h=async()=>{try{const{data:T,error:R}=await je.from("completed_cues").select("*").eq("event_id",e.id);if(!R&&T){const G={};T.forEach(ne=>{ne.item_id&&(G[ne.item_id]=!0)}),_n(G),console.log("🟣 Synced completed cues:",G)}}catch(T){console.warn("⚠️ Error syncing completed cues:",T)}};h();const _=setInterval(h,2e3);return()=>clearInterval(_)},[e?.id]),j.useEffect(()=>{if(!e?.id)return;const h=async()=>{try{await lo()}catch(T){console.warn("⚠️ Error syncing sub-cue timers:",T)}};h();const _=setInterval(h,1e3);return()=>clearInterval(_)},[e?.id]),j.useEffect(()=>{if(!e?.id||!s?.id)return;const h=async()=>{try{const{data:T,error:R}=await je.from("active_timers").select("*").eq("event_id",e.id).order("updated_at",{ascending:!1}).limit(1);if(R){console.warn("⚠️ Top text sync error:",R);return}const G=T?.[0];if(G&&G.user_id===s.id)return;if(G){const ne=G.timer_state||"unknown",ue=parseInt(G.item_id),Ne=G.is_active,Re=G.started_at;let We=ne;if((ne==="unknown"||!ne)&&(Ne&&Re?We="running":Ne?We="loaded":We="stopped"),We==="running"){z(ue),He(qe=>({...qe,[ue]:!0})),Gr(qe=>({...qe,[ue]:!0}));const Ke=I.findIndex(qe=>qe.id===ue),Ue=new Set;if(Ke!==-1)for(let qe=Ke+1;qe<I.length&&I[qe].isIndented;qe++)Ue.add(I[qe].id);Hs(Ue),ci(ue)}else if(We==="loaded"){z(ue),He(qe=>({...qe,[ue]:!0})),Gr({});const Ke=I.findIndex(qe=>qe.id===ue),Ue=new Set;if(Ke!==-1)for(let qe=Ke+1;qe<I.length&&I[qe].isIndented;qe++)Ue.add(I[qe].id);Hs(Ue),ci(ue)}else We==="stopped"&&(z(null),He({}),Gr({}),Hs(new Set),ci(null))}else z(null),He({}),Gr({}),Hs(new Set),ci(null)}catch(T){console.warn("⚠️ Top text sync error:",T)}};h();const _=setInterval(h,2e3);return()=>clearInterval(_)},[e?.id,s?.id,I]),j.useEffect(()=>()=>{console.log("🔄 Cleaning up drift detector on component unmount"),Vr.destroy()},[]),j.useEffect(()=>{if(e?.id&&s?.id&&l&&l!=="VIEWER"){console.log("💾 Saving current role to Supabase:",l);try{const h=s.user_metadata?.full_name||s.email||"Unknown";Ge.saveUserSession(e.id,s.id,h,l),console.log("✅ Role saved to Supabase:",l)}catch(h){console.error("❌ Failed to save role to Supabase:",h)}}},[e?.id,s?.id,l]),j.useEffect(()=>()=>{if(e?.id&&s?.id&&l&&l!=="VIEWER"){console.log("💾 Saving current role to Supabase before navigating away:",l);try{const h=s.user_metadata?.full_name||s.email||"Unknown";Ge.saveUserSession(e.id,s.id,h,l),console.log("✅ Role saved to Supabase on navigation away:",l)}catch(h){console.error("❌ Failed to save role to Supabase on navigation away:",h)}}},[e?.id,s?.id,l]);const kd=async()=>{if(e?.id)try{console.log("🟣 Loading completed cues from Supabase for event:",e.id);const h=await Ge.getCompletedCues(e.id);if(h&&h.length>0){console.log("🟣 Found completed cues:",h);const _={};h.forEach(T=>{if(T.item_id){if(W&&T.item_id===W){console.log("🟣 Skipping currently loaded cue from completed cues:",T.item_id);return}_[T.item_id]=!0}}),_n(_),console.log("🟣 Set completedCues state:",_)}else console.log("🟣 No completed cues found")}catch(h){console.error("❌ Error loading completed cues from Supabase:",h),console.log("💡 This means the completed_cues table or functions need to be created first"),console.log("📋 Please run the create-completed-cues-table.sql script in your Supabase SQL Editor")}};j.useCallback(()=>e?.id?(console.log("🔄 Starting countdown sync for Browser B"),setInterval(async()=>{try{const _=await Ge.getActiveTimer(e.id);_&&_.timer_state==="running"&&_.started_at&&_.elapsed_seconds!==void 0&&_.duration_seconds!==void 0&&Q(T=>({...T,[_.item_id]:{elapsed:_.elapsed_seconds,total:_.duration_seconds,startedAt:new Date(_.started_at)}}))}catch(_){console.warn("⚠️ Failed to sync countdown from server:",_)}},1e3)):void 0,[e?.id]),j.useEffect(()=>{if(!e?.id||!s?.id)return;console.log("🔄 Starting countdown sync for Browser B");const h=setInterval(async()=>{try{const _=await Ge.getActiveTimer(e.id);if(_){if(_.user_id===s.id){console.log("⏭️ Skipping countdown sync - timer started by current user");return}if(console.log("🔄 Browser B: Syncing timer from server:",{itemId:_.item_id,state:_.timer_state,elapsed:_.elapsed_seconds,total:_.duration_seconds,startedAt:_.started_at,userId:_.user_id,currentUserId:s.id}),Q(T=>{const R=T[_.item_id];return _.timer_state==="running"&&_.started_at?{...T,[_.item_id]:{elapsed:_.elapsed_seconds,total:_.duration_seconds,startedAt:new Date(_.started_at)}}:{...T,[_.item_id]:{elapsed:0,total:_.duration_seconds,startedAt:null}}}),_.timer_state==="running"&&_.started_at){const T=new Date(_.started_at),R=_.duration_seconds;console.log(`🔄 Browser B: Starting drift detection for timer ${_.item_id} with duration ${R}s`),Vr.startMonitoring(_.item_id,T,R,G=>{console.log(`🔄 Browser B DriftDetector: Syncing timer ${_.item_id} with server elapsed: ${G}s`),_e(ne=>{const ue=new Set([...ne,_.item_id]);return console.log(`🔄 Browser B DriftDetector: Marking timer ${_.item_id} as server-synced. Server-synced timers:`,Array.from(ue)),ue}),Q(ne=>{const ue={...ne,[_.item_id]:{...ne[_.item_id],elapsed:G}};return console.log(`🔄 Browser B DriftDetector: Updated timer ${_.item_id} progress to elapsed: ${G}s`),ue})})}}else console.log("🔄 No active timer, clearing timer progress"),Q({})}catch(_){console.warn("⚠️ Failed to sync countdown from server:",_)}},1e3);return()=>{console.log("🔄 Cleaning up countdown sync"),clearInterval(h)}},[e?.id,s?.id]);const lo=async()=>{if(e?.id){console.log("🟠 Polling for sub-cue timer...");try{const{data:h}=await Ge.hasActiveSubCueTimer(e.id);if(!h){console.log("🟠 No active sub-cue timer found, clearing local state"),Object.keys(bt).forEach(R=>{bt[parseInt(R)]&&clearInterval(bt[parseInt(R)])}),ln({}),ve({}),Sn(null);return}const{data:_,error:T}=await Ge.getActiveSubCueTimer(e.id);if(console.log("🟠 Sub-cue timer data from Supabase:",_),T){console.error("❌ Error loading sub-cue timer:",T);return}if(_&&_.is_active&&_.is_running){if(console.log("🟠 Sub-cue timer loaded:",_.item_id,"Duration:",_.duration_seconds,"s","Active:",_.is_active,"Running:",_.is_running),s&&_.user_id===s.id){console.log("⏭️ Skipping sub-cue sync - change made by current user");return}ui(!0),Object.keys(bt).forEach(Re=>{bt[parseInt(Re)]&&clearInterval(bt[parseInt(Re)])});const R=parseInt(_.item_id),G=new Date(_.started_at),ue=Math.floor((new Date().getTime()-G.getTime())/1e3)+2;ve(Re=>({...Re,[R]:{elapsed:Math.max(0,ue),total:_.duration_seconds,startedAt:G}})),console.log("🟠 Browser B: Not starting local timer, will update via 2-second sync"),console.log("🟠 Set sub-cue timer state");const Ne=Math.max(0,_.duration_seconds-ue);console.log("🟠 Browser B timing debug:",{startedAt:G.toISOString(),elapsed:ue,duration:_.duration_seconds,remaining:Ne,fix:"Browser B uses database elapsed time, no local timer"}),Sn({itemId:R,remaining:Ne,duration:_.duration_seconds,isActive:!0,startedAt:G,timerState:"running"}),console.log("🟠 Set secondaryTimer state for top UI"),setTimeout(()=>{ui(!1)},100)}else _&&(!_.is_active||!_.is_running)?(console.log("🟠 Sub-cue timer found but not active or not running, clearing local state"),Object.keys(bt).forEach(R=>{bt[parseInt(R)]&&clearInterval(bt[parseInt(R)])}),ln({}),ve({}),Sn(null)):(console.log("🟠 No sub-cue timer found, clearing local state"),Object.keys(bt).forEach(R=>{bt[parseInt(R)]&&clearInterval(bt[parseInt(R)])}),ln({}),ve({}),Sn(null))}catch(h){console.error("❌ Error loading sub-cue timer:",h),Object.keys(bt).forEach(_=>{bt[parseInt(_)]&&clearInterval(bt[parseInt(_)])}),ln({}),ve({})}}},pl=async()=>{if(e?.id)try{const{data:h,error:_}=await Ge.getActiveSubCueTimers(e.id);if(_){console.error("❌ Error loading sub-cue timers:",_);return}h&&h.length>0&&(console.log("🔄 Loaded sub-cue timers from Supabase:",h),console.log("🔄 Setting up sub-cue timer states..."),h.forEach(T=>{const R=T.item_id,G=T.duration_seconds||0;if(console.log(`🔄 Setting up sub-cue timer for item ${R}:`,{elapsed:T.elapsed_seconds||0,total:G,startedAt:T.started_at?new Date(T.started_at):null,timer_state:T.timer_state}),ve(ne=>({...ne,[R]:{elapsed:T.elapsed_seconds||0,total:G,startedAt:T.started_at?new Date(T.started_at):null}})),T.timer_state==="running"){console.log(`🔄 Starting local timer interval for sub-cue item ${R}`);const ne=setInterval(()=>{ve(ue=>{if(ue[R]&&ue[R].startedAt){const Ne=ue[R].startedAt,Re=Ne instanceof Date?Ne.getTime():new Date(Ne).getTime(),We=Math.floor((Date.now()-Re)/1e3);return{...ue,[R]:{...ue[R],elapsed:We}}}return ue})},100);ln(ue=>(console.log(`🔄 Setting sub-cue timer state for item ${R}`),{...ue,[R]:ne}))}else console.log(`🔄 Sub-cue timer for item ${R} is not running, state: ${T.timer_state}`)}))}catch(h){console.error("❌ Error loading sub-cue timers:",h)}},Td=async()=>{if(e?.id){console.log("🧪 Testing database connection...");try{const{data:h,error:_}=await Ge.getLastLoadedCue(e.id);_?(console.error("❌ Database test failed:",_),console.log("💡 This means the SQL migration needs to be run first"),console.log("📋 Please run the migrate-timer-states.sql script in your Supabase SQL Editor")):(console.log("✅ Database connection test passed"),console.log("📊 Test data received:",h))}catch(h){console.error("❌ Database connection test error:",h)}}},Nd=async()=>{if(!e?.id){console.log("⚠️ No event ID for checking running timers");return}console.log("🔄 Checking for running timers for event:",e.id);try{console.log("🔄 Using fallback timer detection..."),oo({cueName:"Timer Detected",remainingTime:"Check Console"}),mi(!0),console.log("✅ Fallback timer popup shown")}catch(h){console.error("❌ Error checking running timers:",h)}},Cd=async()=>{if(console.log("🔄 Master sync: Getting active timer from database..."),!e?.id){console.warn("⚠️ No event selected for sync");return}try{const h=await Ge.getActiveTimer(e.id);if(!h){console.log("ℹ️ No active timer found in database");return}console.log("🔄 Found active timer in database:",h);const _=new Date,T=Math.floor(_.getTime()/1e3),R=new Date(h.started_at),G=Math.floor(R.getTime()/1e3),ne=h.duration_seconds||0,ue=h.is_running;if(console.log("📊 Timer calculation:",{currentTime:T,startTimeSeconds:G,durationSeconds:ne,isRunning:ue,currentTimeFormatted:_.toISOString(),startTimeFormatted:R.toISOString()}),z(h.item_id),ue){const Ne=T-G,Re=ne-Ne;if(console.log("🔄 Time calculation for running timer:",{elapsedSeconds:Ne,remainingSeconds:Re,isOverdue:Re<0}),Q(We=>({...We,[h.item_id]:{elapsed:Ne,total:ne,startedAt:R}})),Re!==0){Re>0?console.log(`✅ Timer synced: ${Re} seconds remaining - starting countdown`):console.log(`⚠️ Timer synced: ${Math.abs(Re)} seconds overdue - starting count up`),it[h.item_id]&&clearInterval(Lr[h.item_id]);const We=setInterval(()=>{Q(Ke=>{const Ue=Ke[h.item_id];if(!Ue)return Ke;const qe=Ue.elapsed+1,ot=Ue.total-qe;return ot>0?console.log(`🔄 Timer countdown: ${ot} seconds remaining`):console.log(ot===0?"⏰ Timer just expired":`🔄 Timer count up: ${Math.abs(ot)} seconds overdue`),{...Ke,[h.item_id]:{...Ue,elapsed:qe}}})},1e3);bn(Ke=>({...Ke,[h.item_id]:We}))}else console.log("⏰ Timer just expired")}else console.log("⏸️ Timer is loaded but not running - setting duration only"),Q(Ne=>({...Ne,[h.item_id]:{elapsed:0,total:ne,startedAt:null}})),console.log(`✅ Timer synced: Set loaded duration to ${ne} seconds`)}catch(h){console.error("❌ Error during master sync:",h)}},co=async()=>{if(!(!e?.id||!s?.id))try{console.log("🔄 Backing up schedule data..."),await Ge.saveRunOfShowData({event_id:e.id,event_name:e.name,event_date:e.date,schedule_items:I,custom_columns:oe,settings:{}}),console.log("✅ Schedule data backed up")}catch(h){console.error("❌ Error backing up schedule data:",h)}},xl=async()=>{if(!e?.id){console.log("⚠️ No event ID for loading master change log");return}try{console.log("🔄 Loading master change log for event:",e.id);const h=await Sr.getMasterChangeLog(e.id,100);w(h),console.log("📊 Loaded master change log:",h.length,"changes"),h.length===0&&console.log("ℹ️ No master changes found - this might be normal for new events")}catch(h){console.error("❌ Error loading master change log:",h),w([])}},uo=async()=>{if(!e?.id||!s){console.log("❌ Cannot sync - missing event ID or user");return}if(!Vs){console.log("👁️ Skipping sync - page not visible");return}if(St||Fe||At||Wt||to){console.log("🚫 Skipping sync - modal is open");return}if(_a){console.log("✏️ Skipping sync - user is actively editing");return}try{console.log("🔄 Syncing schedule data to database...");const h={event_id:e.id,event_name:e.name,event_date:e.date,schedule_items:I,custom_columns:oe,settings:{eventName:ae,masterStartTime:me,dayStartTimes:be}};await Ge.saveRunOfShowData(h,{userId:s.id,userName:s.user_metadata?.full_name||s.email||"Unknown User",userRole:l||"VIEWER"})?(console.log("✅ Schedule data synced to database successfully"),xl()):console.log("❌ Failed to sync schedule data to database")}catch(h){console.error("❌ Error syncing schedule data to database:",h)}},Ad=async()=>{if(prompt("Enter password to clear all change logs:")!=="1615"){alert("Incorrect password. Change logs not cleared.");return}if(confirm(`⚠️ WARNING: This will permanently delete ALL change logs (local and master) for this event. This action cannot be undone.

Are you sure you want to continue?`))try{if(Sr.clearLocalChanges(),S([]),console.log("✅ Local changes cleared"),e?.id){console.log("🔄 Attempting to clear master change log for event:",e.id);const{data:{user:T},error:R}=await je.auth.getUser();if(console.log("🔄 Current user:",T?.id,T?.email),R){console.error("❌ Auth error:",R),alert("❌ Authentication error. Please refresh and try again.");return}const G=await Sr.clearMasterChangeLog(e.id);if(G.success){w([]),console.log("✅ Master change log cleared successfully"),console.log("🔄 Verifying master change log is cleared...");const ne=await Sr.getMasterChangeLog(e.id);console.log("🔄 Master change log after clearing:",ne.length,"records"),w(ne),ne.length===0?alert(`✅ All change logs cleared successfully!

- Local changes: ✅ Cleared
- Master changes: ✅ Cleared (${G.deletedCount} records deleted)`):alert(`⚠️ Partial success:

- Local changes: ✅ Cleared
- Master changes: ⚠️ ${G.deletedCount} deleted, but ${ne.length} remain

Some records may be protected by RLS policies.`)}else console.log("❌ Failed to clear master change log:",G.error),alert(`⚠️ Partial success:

- Local changes: ✅ Cleared
- Master changes: ❌ Failed

Error: ${G.error}

This might be due to database permissions. Check the console for details.`)}else alert("❌ Error: No event ID found. Cannot clear master change log.")}catch(T){console.error("Error clearing change logs:",T),alert("❌ Error clearing change logs. Check the console for details.")}};j.useEffect(()=>{if(!zs||Object.keys(it).length===0){Ss(!1);return}const h=parseInt(Object.keys(it)[0]),_=I.find(T=>T.id===h);if(_)try{const T=new Date,R=I.findIndex(ne=>ne.id===_.id),G=Ca(R);if(G){const[ne,ue]=G.split(" "),[Ne,Re]=ne.split(":").map(Number);let We=Ne;ue==="PM"&&Ne!==12&&(We+=12),ue==="AM"&&Ne===12&&(We=0);const Ke=new Date,Ue=new Date(Ke.getFullYear(),Ke.getMonth(),Ke.getDate(),We,Re),qe=T.getTime()-Ue.getTime(),ot=Math.round(qe/(1e3*60));Sd(Math.abs(ot)),ot<-1?(ba("early"),Ss(!0)):ot>1?(ba("late"),Ss(!0)):(ba("on-time"),Ss(!0)),setTimeout(()=>{Ss(!1)},2e4)}}catch(T){console.error("Error calculating time status:",T),Ss(!1)}},[it,I,zs]);const Rd=()=>{if(!fr)return;const h=document.querySelector(`[data-item-id="${W}"]`);if(h){const _=h.getBoundingClientRect(),T=window.pageYOffset||document.documentElement.scrollTop,R=_.top+T,G=document.querySelector("#main-scroll-container .h-24");let ne=100;G&&(ne=G.getBoundingClientRect().height+20);const Ne=R-ne-230;window.scrollTo({top:Math.max(0,Ne),behavior:"smooth"}),localStorage.setItem(`scrollPosition_${e?.id}`,Ne.toString())}},[Pt,wr]=j.useState({cue:"",day:1,programType:"PreShow/End",shotType:"",segmentName:"",durationHours:0,durationMinutes:0,durationSeconds:0,notes:"",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!1,timerId:"",isPublic:!1,isIndented:!1,customFields:{}});j.useEffect(()=>{wr(h=>({...h,day:te}))},[te]);const fo=["PreShow/End","Podium Transition","Panel Transition","Sub Cue","No Transition","Video","Panel+Remote","Remote Only","Break","TBD","KILLED"],ho={"PreShow/End":"#8B5CF6","Podium Transition":"#8B4513","Panel Transition":"#404040","Sub Cue":"#F3F4F6","No Transition":"#059669",Video:"#F59E0B","Panel+Remote":"#1E40AF","Remote Only":"#60A5FA",Break:"#EC4899",TBD:"#6B7280",KILLED:"#DC2626"},En=(h,_,T,R,G)=>{let ne=6.5;if(h&&h.trim()!==""){const ue=document.createElement("div");ue.style.position="absolute",ue.style.visibility="hidden",ue.style.width="22rem",ue.style.padding="0.75rem",ue.style.fontSize="1rem",ue.style.lineHeight="1.5",ue.style.fontFamily="system-ui, -apple-system, sans-serif",ue.style.whiteSpace="pre-wrap",ue.style.wordWrap="break-word",ue.innerHTML=h,document.body.appendChild(ue);const Ne=ue.scrollHeight;document.body.removeChild(ue);const Ke=Ne/16+3;ne=Math.max(ne,Ke)}if(T&&T.trim()!=="")try{const ue=JSON.parse(T);if(Array.isArray(ue)&&ue.length>0){const Ne=ue.filter(Re=>Re.fullName&&Re.fullName.trim()!=="");if(Ne.length>0){const Ke=4+Ne.length*1.5;ne=Math.max(ne,Ke)}}}catch{if(T.includes(`
`)){const Re=4+T.split(`
`).filter(We=>We.trim()!=="").length*1.5;ne=Math.max(ne,Re)}}if(_&&_.trim()!=="")try{const ue=JSON.parse(_);if(Array.isArray(ue)&&ue.length>0){const Ne=ue.filter(Re=>Re.fullName&&Re.fullName.trim()!=="");if(Ne.length>0){const Ke=4+Ne.length*1.5;ne=Math.max(ne,Ke)}}}catch{if(_.includes(`
`)){const Re=4+_.split(`
`).filter(We=>We.trim()!=="").length*1.5;ne=Math.max(ne,Re)}}return R&&G&&G.length>0&&G.forEach(ue=>{const Ne=R[ue.name];if(Ne&&Ne.trim()!==""){const Re=Ne.split(`
`),ot=3+Math.max(2,Re.length)*1.6+1;ne=Math.max(ne,ot)}}),`${ne}rem`},Fc=h=>{if(!h||h.trim()==="")return"4.5rem";const _=document.createElement("div");_.style.position="absolute",_.style.visibility="hidden",_.style.width="20rem",_.style.padding="0.5rem",_.style.fontSize="1rem",_.style.lineHeight="1.4",_.style.fontFamily="system-ui, -apple-system, sans-serif",_.style.whiteSpace="pre-wrap",_.style.wordWrap="break-word",_.innerHTML=h,document.body.appendChild(_);const T=_.scrollHeight;document.body.removeChild(_);const R=T/16,G=2.5,ne=4.5,ue=R+G;return`${Math.max(ne,ue)}rem`},vl=h=>{if(!h||h.trim()==="")return"3.5rem";let _=1;try{const ne=JSON.parse(h);if(Array.isArray(ne)){const ue=ne.filter(Ne=>Ne.fullName&&Ne.fullName.trim()!=="");_=Math.max(1,ue.length)}}catch{_=Math.max(1,h.split(`
`).filter(ue=>ue.trim()!=="").length)}const G=3+(_-1)*1.5;return`${Math.max(3.5,G)}rem`},$t=(h,_)=>{const T=document.getElementById("notes-editor");if(T){T.focus();try{switch(h){case"bold":document.execCommand("bold",!1);break;case"italic":document.execCommand("italic",!1);break;case"underline":document.execCommand("underline",!1);break;case"color":_&&document.execCommand("foreColor",!1,_);break;case"highlight":_&&_!=="none"?document.execCommand("backColor",!1,_):document.execCommand("removeFormat",!1);break;case"fontSize":_&&document.execCommand("fontSize",!1,_);break;case"bullet":document.execCommand("insertUnorderedList",!1);break;case"list":document.execCommand("insertOrderedList",!1);break;case"left":document.execCommand("justifyLeft",!1);break;case"center":document.execCommand("justifyCenter",!1);break;case"right":document.execCommand("justifyRight",!1);break;case"undo":document.execCommand("undo",!1);break;case"redo":document.execCommand("redo",!1);break}}catch{console.warn("Formatting command not supported:",h)}}},Id=()=>{const h=document.getElementById("notes-editor");if(h&&Ae!==null){const _=h.innerHTML;if(Ae===-1)wr(T=>({...T,notes:_}));else{const T=I.find(G=>G.id===Ae)?.notes||"",R=I.find(G=>G.id===Ae);ie(G=>G.map(ne=>ne.id===Ae?{...ne,notes:_}:ne)),R&&O("FIELD_UPDATE",`Updated notes for "${R.segmentName}"`,{changeType:"FIELD_CHANGE",itemId:R.id,itemName:R.segmentName,fieldName:"notes",oldValue:T,newValue:_,details:{fieldType:"text",characterChange:_.length-T.length}})}Oe(!1),at(null),Mr()}},Od=()=>{if(Et!==null){const h=JSON.stringify(kt);if(Et===-1)wr(_=>({..._,speakersText:h}));else{const _=I.find(R=>R.id===Et)?.speakersText||"",T=I.find(R=>R.id===Et);ie(R=>R.map(G=>G.id===Et?{...G,speakersText:h}:G)),T&&O("FIELD_UPDATE",`Updated speakers for "${T.segmentName}"`,{changeType:"FIELD_CHANGE",itemId:T.id,itemName:T.segmentName,fieldName:"speakers",oldValue:_,newValue:h,details:{fieldType:"speakers",speakerCount:kt.length,characterChange:h.length-_.length}})}wt(!1),Vt(null),Mr()}},jd=()=>{if(Zt!==null){const h=document.getElementById("assets-list");if(h){const _=h.querySelectorAll(".asset-item"),T=[];_.forEach(G=>{const ne=G.querySelector(".asset-name"),ue=G.querySelector(".asset-link");if(ne&&ue){const Ne=ne.value.trim(),Re=ue.value.trim();Ne&&T.push(Re?`${Ne}|${Re}`:Ne)}});const R=T.join("||");if(Zt===-1)wr(G=>({...G,assets:R}));else{const G=I.find(ue=>ue.id===Zt)?.assets||"",ne=I.find(ue=>ue.id===Zt);ie(ue=>ue.map(Ne=>Ne.id===Zt?{...Ne,assets:R}:Ne)),ne&&O("FIELD_UPDATE",`Updated assets for "${ne.segmentName}"`,{changeType:"FIELD_CHANGE",itemId:ne.id,itemName:ne.segmentName,fieldName:"assets",oldValue:G,newValue:R,details:{fieldType:"assets",assetCount:T.length,characterChange:R.length-G.length}})}Ht(!1),qt(null),Mr()}}},Dc=()=>{const h=document.getElementById("assets-list");if(h){const _=document.createElement("div");_.className="asset-item p-3 bg-slate-700 rounded-lg space-y-3",_.innerHTML=`
        <div class="flex gap-3 items-center">
          <input type="text" class="asset-name flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Asset name..." />
          <button type="button" class="toggle-link px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded transition-colors text-sm">
            + Link
          </button>
          <button type="button" class="remove-asset px-3 py-2 bg-red-600 hover:bg-red-500 text-white rounded transition-colors">Remove</button>
        </div>
        <div class="asset-link-container hidden">
          <input type="url" class="asset-link w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Enter asset URL..." />
        </div>
      `;const T=_.querySelector(".toggle-link"),R=_.querySelector(".asset-link-container"),G=_.querySelector(".asset-link");T?.addEventListener("click",()=>{R?.classList.contains("hidden")?(R.classList.remove("hidden"),T.textContent="− Link",T.classList.remove("bg-blue-600","hover:bg-blue-500"),T.classList.add("bg-slate-600","hover:bg-slate-500"),G?.focus()):(R?.classList.add("hidden"),T.textContent="+ Link",T.classList.remove("bg-slate-600","hover:bg-slate-500"),T.classList.add("bg-blue-600","hover:bg-blue-500"),G&&(G.value=""))}),_.querySelector(".remove-asset")?.addEventListener("click",()=>{_.remove()}),h.appendChild(_)}},Pc=()=>{if(vr.length>=7)return;const h=vr.map(R=>R.slot),_=[1,2,3,4,5,6,7].find(R=>!h.includes(R))||1,T={id:`speaker_${Date.now()}`,slot:_,location:"Podium",fullName:"",title:"",org:"",photoLink:""};Pr(R=>[...R,T].sort((G,ne)=>G.slot-ne.slot))},Fd=h=>{Pr(_=>_.filter(T=>T.id!==h))},ks=(h,_,T)=>{Pr(R=>R.map(G=>G.id===h?{...G,[_]:T}:G).sort((G,ne)=>G.slot-ne.slot))},gi=()=>{if(Fn!==null){const h=JSON.stringify(vr);Fn===-1?wr(_=>({..._,speakers:h})):ie(_=>_.map(T=>T.id===Fn?{...T,speakers:h}:T)),on(!1),ws(null)}},Dd=()=>{if(kt.length>=7)return;const h=kt.map(R=>R.slot),_=[1,2,3,4,5,6,7].find(R=>!h.includes(R))||1,T={id:Date.now().toString(),fullName:"",location:"Podium",slot:_,title:"",org:"",photoLink:""};Ct(R=>[...R,T])},Lc=h=>{Ct(_=>_.filter(T=>T.id!==h))},Ts=(h,_,T)=>{Ct(R=>R.map(G=>G.id===h?{...G,[_]:T}:G))},Mc=(h,_)=>{if(kt.some(R=>R.id!==h&&R.slot===_)){const R=kt.find(G=>G.id!==h&&G.slot===_);if(R){const G=kt.find(ne=>ne.id===h);G&&Ts(R.id,"slot",G.slot)}}Ts(h,"slot",_)},Uc=(h,_)=>{const T=vr.find(G=>G.id===h);if(!T)return;const R=vr.find(G=>G.id!==h&&G.slot===_);if(R){const G=vr.map(ne=>ne.id===h?{...ne,slot:_}:ne.id===R.id?{...ne,slot:T.slot}:ne);Pr(G)}else ks(h,"slot",_)},yl=h=>{if(!h)return"Click to add participants...";try{const _=JSON.parse(h);return!Array.isArray(_)||_.length===0?"Click to add participants...":_.sort((T,R)=>T.slot-R.slot).map(T=>`${T.location==="Podium"?"P":T.location==="Seat"?"S":T.location==="Virtual"?"V":"M"}${T.slot} - ${T.fullName||"Unnamed"}`).join(`
`)}catch{return"Click to add participants..."}},Ns=h=>{if(!h)return"Click to add speakers...";try{const _=JSON.parse(h);return!Array.isArray(_)||_.length===0?"Click to add speakers...":_.sort((T,R)=>T.slot-R.slot).filter(T=>T.fullName&&T.fullName.trim()!=="").map(T=>`${T.location==="Podium"?"P":T.location==="Seat"?"S":T.location==="Virtual"?"V":"M"}${T.slot} - ${T.fullName||"Unnamed"}`).join(`
`)}catch{return"Click to add speakers..."}},$c=["Podium","2-Shot","3-Shot","4-Shot","5-Shot","6-Shot","7-Shot","Ted-Talk"],Pd=h=>{if(isNaN(h)||h===void 0||h===null)return console.warn("⚠️ formatTime received invalid value:",h),"00:00:00";const _=h<0,T=Math.abs(h),R=Math.floor(T/3600),G=Math.floor(T%3600/60),ne=Math.floor(T%60);return`${_?"-":""}${R.toString().padStart(2,"0")}:${G.toString().padStart(2,"0")}:${ne.toString().padStart(2,"0")}`},Ld=h=>{if(isNaN(h)||h===void 0||h===null)return console.warn("⚠️ formatSubCueTime received invalid value:",h),"00:00";const _=h<0,T=Math.abs(h),R=Math.floor(T/3600),G=Math.floor(T%3600/60),ne=Math.floor(T%60),ue=_?"-":"";return R===0?`${ue}${G.toString().padStart(2,"0")}:${ne.toString().padStart(2,"0")}`:`${ue}${R.toString().padStart(2,"0")}:${G.toString().padStart(2,"0")}:${ne.toString().padStart(2,"0")}`},Ta=h=>{const _=I.find(R=>R.id===h);if(!_||!_.isIndented)return!1;const T=I.findIndex(R=>R.id===h);if(T===-1)return!1;for(let R=T-1;R>=0;R--){const G=I[R];if(!G.isIndented)return it[G.id]!==void 0}return!1},Bc=()=>{const h=Object.keys(it);if(h.length>0){const T=parseInt(h[0]);if(H[T]){const R=H[T];return R.total-R.elapsed}}const _=Object.keys(bt);if(_.length>0){const T=parseInt(_[0]);if(Z[T]){const R=Z[T];return R.total-R.elapsed}}if(W&&H[W]){const T=H[W];return T.total-T.elapsed}return 0},pi=()=>{const h=Object.keys(it);if(h.length>0){const T=parseInt(h[0]);if(H[T]){const R=H[T],G=R.total-R.elapsed;return G<0?0:R.total>0?G/R.total*100:0}}const _=Object.keys(bt);if(_.length>0){const T=parseInt(_[0]);if(Z[T]){const R=Z[T],G=R.total-R.elapsed;return R.total>0?G/R.total*100:0}}if(W&&H[W]){const T=H[W],R=T.total-T.elapsed;return T.total>0?R/T.total*100:0}return 0},xi=()=>{const h=Object.keys(it);if(h.length>0){const T=parseInt(h[0]);if(H[T]){const R=H[T],G=R.total-R.elapsed;return G<0?"bg-red-500":G>120?"#10b981":G>30?"#f59e0b":"#ef4444"}}const _=Object.keys(bt);if(_.length>0){const T=parseInt(_[0]);if(Z[T]){const R=Z[T],G=R.total-R.elapsed;return G>120?"#10b981":G>30?"#f59e0b":"#ef4444"}}if(W&&H[W]){const T=H[W],R=T.total-T.elapsed;return R>120?"#10b981":R>30?"#f59e0b":"#ef4444"}return"transparent"},Md=()=>{const h=Object.keys(it);if(h.length>0){const _=parseInt(h[0]);if(H[_]){const T=H[_],R=T.total-T.elapsed;return R>120?"#10b981":R>30?"#f59e0b":"#ef4444"}}if(W&&H[W]){const _=H[W],T=_.total-_.elapsed;return T>120?"#10b981":T>30?"#f59e0b":"#ef4444"}return"#ffffff"},Js=async h=>{if(!W||!s||!e?.id)return;const _=I.find(ue=>ue.id===W);if(!_)return;const T=Math.max(0,_.durationHours*3600+_.durationMinutes*60+_.durationSeconds+h),R=Math.floor(T/3600),G=Math.floor(T%3600/60),ne=T%60;ie(ue=>ue.map(Ne=>Ne.id===W?{...Ne,durationHours:R,durationMinutes:G,durationSeconds:ne}:Ne)),H[W]&&(console.log("🔄 Updating timer duration for item:",W,"new duration:",T),Q(ue=>({...ue,[W]:{...ue[W],total:T}})),it[W]?(console.log("✅ Timer duration updated locally for running timer"),await Ge.updateTimerDuration(e.id,W,T)?console.log("✅ Timer duration updated on server - Browser B will see the change"):console.warn("⚠️ Failed to update timer duration on server"),await co(),console.log("✅ Time adjustment completed locally and on server")):console.log("✅ Timer duration updated locally for loaded timer"))},Vc=async h=>{if(console.log("🚀🚀🚀 loadCue function STARTED with itemId:",h),console.log("🚀🚀🚀 loadCue function STARTED with itemId:",h),console.log("🚀🚀🚀 loadCue function STARTED with itemId:",h),!s||!e?.id){console.log("❌ Missing user or event ID:",{user:!!s,eventId:e?.id});return}Object.keys(it).forEach(async ne=>{if(it[parseInt(ne)]){clearInterval(Lr[parseInt(ne)]),_n(Ne=>({...Ne,[parseInt(ne)]:!0}));const ue=I.find(Ne=>Ne.id===parseInt(ne));console.log("🟣 About to mark cue as completed:",{eventId:e.id,itemId:parseInt(ne),userId:s.id,cueId:ue?.customFields?.cue||"CUE"});try{const Ne=await Ge.markCueCompleted(e.id,parseInt(ne),ue?.customFields?.cue||"CUE",s.id,s.user_metadata?.full_name||s.email||"Unknown User",l||"VIEWER");console.log("🟣 Mark completed result:",Ne)}catch(Ne){console.error("❌ Error marking cue as completed:",Ne)}}}),Gr({}),console.log("🔄 Stopping all timers in Supabase for event:",e.id,"user:",s.id);const _=await Ge.stopAllTimersForEvent(e.id,s.id);if(console.log("🔄 Stop all timers result:",_),W&&W!==h){Pn(Ne=>new Set([...Ne,W])),_n(Ne=>({...Ne,[W]:!0}));const ne=I.find(Ne=>Ne.id===W);console.log("🟣 About to mark active cue as completed:",{eventId:e.id,itemId:W,userId:s.id,cueId:ne?.customFields?.cue||"CUE"});try{const Ne=await Ge.markCueCompleted(e.id,W,ne?.customFields?.cue||"CUE",s.id,s.user_metadata?.full_name||s.email||"Unknown User",l||"VIEWER");console.log("🟣 Mark active completed result:",Ne)}catch(Ne){console.error("❌ Error marking active cue as completed:",Ne)}const ue=I.findIndex(Ne=>Ne.id===W);if(ue!==-1)for(let Ne=ue+1;Ne<I.length&&I[Ne].isIndented;Ne++)_n(Re=>({...Re,[I[Ne].id]:!0})),Pn(Re=>new Set([...Re,I[Ne].id])),await Ge.markCueCompleted(e.id,I[Ne].id,I[Ne].customFields?.cue||"CUE",s.id,s.user_metadata?.full_name||s.email||"Unknown User",l||"VIEWER")}_n(ne=>{const ue={...ne};delete ue[h];const Ne=I.findIndex(Re=>Re.id===h);if(Ne!==-1)for(let Re=Ne+1;Re<I.length&&I[Re].isIndented;Re++)delete ue[I[Re].id];return ue}),Pn(ne=>{const ue=new Set(ne);ue.delete(h);const Ne=I.findIndex(Re=>Re.id===h);if(Ne!==-1)for(let Re=Ne+1;Re<I.length&&I[Re].isIndented;Re++)ue.delete(I[Re].id);return ue});const T=I.find(ne=>ne.id===h);if(T){console.log("🔄 Item found:",T),console.log("🔄 Item ID type:",typeof T.id,"Value:",T.id),console.log("🔄 Item duration values:",{durationHours:T.durationHours,durationMinutes:T.durationMinutes,durationSeconds:T.durationSeconds});const ne=T.durationHours*3600+T.durationMinutes*60+T.durationSeconds;console.log("🔄 Calculated total seconds:",ne);const ue=typeof h=="string"?parseInt(h):h;console.log("🔄 Numeric item ID:",ue),console.log("⚡ Optimistic UI update - showing loaded state immediately"),Q(Ue=>({...Ue,[h]:{elapsed:0,total:ne,startedAt:null}})),z(h),He(Ue=>({...Ue,[h]:!0}));const Re=I.findIndex(Ue=>Ue.id===h)+1,We=yr(T.customFields.cue),Ke=T.timerId;console.log("🔄 Loading CUE in Supabase:",{eventId:e.id,itemId:ue,userId:s.id,totalSeconds:ne,rowNumber:Re,cueDisplay:We,timerId:Ke}),console.log("🔄 About to call DatabaseService.loadCue..."),console.log("🔄 DatabaseService object:",typeof Ge),console.log("🔄 DatabaseService.loadCue function:",typeof Ge.loadCue),console.log("🔄 Testing Supabase configuration...");try{const{isSupabaseConfigured:Ue}=await nl(async()=>{const{isSupabaseConfigured:qe}=await Promise.resolve().then(()=>J_);return{isSupabaseConfigured:qe}},void 0);console.log("🔄 Supabase configured:",Ue)}catch(Ue){console.error("❌ Error importing Supabase config:",Ue)}try{console.log("🔄 Calling DatabaseService.loadCue now...");const Ue=await Ge.loadCue(e.id,ue,s.id,ne,Re,We,Ke);console.log("🔄 Load CUE result:",Ue),Ue?console.log("✅ Load CUE succeeded!"):console.error("❌ Load CUE failed - check database connection and functions")}catch(Ue){console.error("❌ Load CUE error:",Ue),console.error("❌ Error stack:",Ue.stack)}console.log("🔄 Finished loadCue database call"),ci(ue);try{await Ge.updateLastLoadedCue(e.id,ue,"loaded"),console.log("✅ Last loaded CUE saved")}catch(Ue){console.log("⚠️ Could not save last loaded CUE (migration may not be run):",Ue)}await co(),console.log("✅ Load CUE action completed locally")}const R=I.findIndex(ne=>ne.id===h),G=new Set;if(R!==-1)for(let ne=R+1;ne<I.length&&I[ne].isIndented;ne++)G.add(I[ne].id);Hs(G)},wl=async()=>{if(Object.keys(it).forEach(h=>{it[parseInt(h)]&&clearInterval(Lr[parseInt(h)])}),Object.keys(bt).forEach(h=>{bt[parseInt(h)]&&clearInterval(bt[parseInt(h)])}),e?.id)try{await Ge.clearCompletedCues(e.id),console.log("✅ Cleared completed cues from database"),await Ge.clearAllActiveTimersForEvent(e.id),console.log("✅ Cleared all active timers from Supabase")}catch(h){console.warn("⚠️ Failed to clear database:",h)}Gr({}),ln({}),Q({}),ve({}),_n({}),z(null),Pn(new Set),Hs(new Set)},bl=()=>{Me(!1),De&&!De.closed&&De.close();const h=Object.keys(it),_=h.length>0?I.find(G=>it[G.id]):I.find(G=>G.id===W),T={isRunning:h.length>0,elapsedTime:_&&H[_.id]?H[_.id].elapsed:0,totalDuration:_?_.durationHours*3600+_.durationMinutes*60+_.durationSeconds:0,eventId:e?.id,mainTimer:_?{cue:_.customFields.cue||"CUE",segmentName:_.segmentName||""}:null,secondaryTimer:zt?{itemId:zt.itemId,remaining:zt.remaining,duration:zt.duration,cue:I.find(G=>G.id===zt.itemId)?.customFields.cue||"CUE",segmentName:I.find(G=>G.id===zt.itemId)?.segmentName||""}:null},R=window.open("/fullscreen-timer","fullScreenTimer","width=1920,height=1080,fullscreen=yes,menubar=no,toolbar=no,location=no,status=no,scrollbars=no,resizable=yes");R&&(ut(R),R.addEventListener("load",()=>{R.postMessage({type:"TIMER_UPDATE",...T},"*")}))};j.useEffect(()=>{const h=()=>{P(null),zn(null),Me(!1)};return document.addEventListener("click",h),()=>document.removeEventListener("click",h)},[]),j.useEffect(()=>{if(Fe&&Ae!==null){const h=document.getElementById("notes-editor");if(h)if(Ae===-1)h.innerHTML=Pt.notes||"";else{const _=I.find(T=>T.id===Ae);h.innerHTML=_?.notes||""}}},[Fe,Ae,I,Pt.notes]),j.useEffect(()=>{if(St&&Et!==null)if(Et===-1)if(Pt.speakersText)try{const h=JSON.parse(Pt.speakersText);Ct(Array.isArray(h)?h:[])}catch{Ct([])}else Ct([]);else{const h=I.find(_=>_.id===Et);if(h?.speakersText)try{const _=JSON.parse(h.speakersText);Ct(Array.isArray(_)?_:[])}catch{Ct([])}else Ct([])}},[St,Et,I,Pt.speakersText]),j.useEffect(()=>{if(At&&Zt!==null){const h=document.getElementById("assets-list");if(h){h.innerHTML="";let _="";Zt===-1?_=Pt.assets||"":_=I.find(R=>R.id===Zt)?.assets||"",_&&_.split("||").forEach(R=>{if(R.trim()){const[G,ne]=R.split("|"),ue=ne&&ne.trim()!=="",Ne=document.createElement("div");Ne.className="asset-item p-3 bg-slate-700 rounded-lg space-y-3",Ne.innerHTML=`
                <div class="flex gap-3 items-center">
                  <input type="text" class="asset-name flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Asset name..." value="${G||""}" />
                  <button type="button" class="toggle-link px-3 py-2 text-white rounded transition-colors text-sm ${ue?"bg-slate-600 hover:bg-slate-500":"bg-blue-600 hover:bg-blue-500"}">
                    ${ue?"− Link":"+ Link"}
                  </button>
                  <button type="button" class="remove-asset px-3 py-2 bg-red-600 hover:bg-red-500 text-white rounded transition-colors">Remove</button>
                </div>
                <div class="asset-link-container ${ue?"":"hidden"}">
                  <input type="url" class="asset-link w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Enter asset URL..." value="${ne||""}" />
                </div>
              `;const Re=Ne.querySelector(".toggle-link"),We=Ne.querySelector(".asset-link-container"),Ke=Ne.querySelector(".asset-link");Re?.addEventListener("click",()=>{We?.classList.contains("hidden")?(We.classList.remove("hidden"),Re.textContent="− Link",Re.classList.remove("bg-blue-600","hover:bg-blue-500"),Re.classList.add("bg-slate-600","hover:bg-slate-500"),Ke?.focus()):(We?.classList.add("hidden"),Re.textContent="+ Link",Re.classList.remove("bg-slate-600","hover:bg-slate-500"),Re.classList.add("bg-blue-600","hover:bg-blue-500"),Ke&&(Ke.value=""))}),Ne.querySelector(".remove-asset")?.addEventListener("click",()=>{Ne.remove()}),h.appendChild(Ne)}}),h.children.length===0&&Dc()}}},[At,Zt,I,Pt.assets]),j.useEffect(()=>{if(Wt&&Fn!==null)if(Fn===-1)if(Pt.speakers)try{const h=JSON.parse(Pt.speakers);Pr(Array.isArray(h)?h:[])}catch{Pr([])}else Pr([]);else{const h=I.find(_=>_.id===Fn);if(h?.speakers)try{const _=JSON.parse(h.speakers);Pr(Array.isArray(_)?_:[])}catch{Pr([])}else Pr([])}},[Wt,Fn,I,Pt.speakers]);const kn=ed.useCallback(Wc(async()=>{if(e?.id)try{const h={event_id:e.id,event_name:e.name,event_date:e.date,schedule_items:I,custom_columns:oe,settings:{eventName:ae,masterStartTime:me,dayStartTimes:be,lastSaved:new Date().toISOString()}};console.log("🔄 Auto-saving to Supabase:",{eventId:e.id,scheduleItemsCount:I.length,customColumnsCount:oe.length,eventName:ae,masterStartTime:me,sampleScheduleItem:I[0]?{id:I[0].id,segmentName:I[0].segmentName,speakersText:I[0].speakersText?"Has speakers data":"No speakers data",speakers:I[0].speakers?"Has speakers data":"No speakers data"}:"No schedule items"});const _=await Ge.saveRunOfShowData(h,{userId:s?.id||"unknown",userName:s?.user_metadata?.full_name||s?.email||"Unknown User",userRole:l||"VIEWER"});console.log("✅ Auto-saved to Supabase successfully")}catch(h){console.error("❌ Error auto-saving to Supabase:",h)}},1e3),[e?.id,e?.name,e?.date,I,oe,ae,me,be]);function Wc(h,_){let T;return((...R)=>{clearTimeout(T),T=setTimeout(()=>h(...R),_)})}const Hc=j.useCallback(async()=>{if(e?.id)try{console.log("🔄 Loading from Supabase for event:",e.id);const h=Ge.getRunOfShowData(e.id),_=new Promise((R,G)=>setTimeout(()=>G(new Error("Database query timeout after 10 seconds")),1e4)),T=await Promise.race([h,_]);if(console.log("🔍 Debug - Raw data from Supabase:",T),console.log("🔍 Debug - schedule_items:",T?.schedule_items),console.log("🔍 Debug - custom_columns:",T?.custom_columns),console.log("🔍 Debug - settings:",T?.settings),T){console.log("📥 Data loaded from Supabase:",{scheduleItemsCount:T.schedule_items?.length||0,customColumnsCount:T.custom_columns?.length||0,eventName:T.settings?.eventName,masterStartTime:T.settings?.masterStartTime,sampleScheduleItem:T.schedule_items?.[0]?{id:T.schedule_items[0].id,segmentName:T.schedule_items[0].segmentName,speakersText:T.schedule_items[0].speakersText?"Has speakers data":"No speakers data",speakers:T.schedule_items[0].speakers?"Has speakers data":"No speakers data"}:"No schedule items"});const R=T.schedule_items?[...T.schedule_items]:[];ie(R),X(T.custom_columns||[]),T.settings?.eventName&&fe(T.settings.eventName),T.settings?.masterStartTime&&Te(T.settings.masterStartTime),T.settings?.dayStartTimes&&le(T.settings.dayStartTimes),N(T.updated_at||null),V(!1),ce({show:!1}),console.log("✅ Run of Show data loaded from Supabase successfully")}else{console.log("ℹ️ No data found in Supabase, falling back to localStorage for event:",e.id);const R=localStorage.getItem(`runOfShowSchedule_${e.id}`),G=localStorage.getItem(`customColumns_${e.id}`),ne=localStorage.getItem(`eventName_${e.id}`),ue=localStorage.getItem(`masterStartTime_${e.id}`),Ne=localStorage.getItem(`dayStartTimes_${e.id}`);if(R)try{const Re=JSON.parse(R);console.log("🔍 Parsed schedule from localStorage:",Re);const We=Re.map(Ke=>({...Ke,day:Ke.day||1}));ie(We),console.log("📥 Loaded schedule from localStorage:",We.length,"items"),console.log("🔍 First few items:",We.slice(0,3))}catch(Re){console.error("❌ Error parsing schedule from localStorage:",Re),console.log("🔍 Raw localStorage data:",R)}else console.log("❌ No schedule found in localStorage for event:",e.id);G&&(X(JSON.parse(G)),console.log("📥 Loaded custom columns from localStorage")),ne&&(fe(ne),console.log("📥 Loaded event name from localStorage")),ue&&(Te(ue),console.log("📥 Loaded master start time from localStorage")),Ne&&(le(JSON.parse(Ne)),console.log("📥 Loaded day start times from localStorage"))}}catch(h){console.error("❌ Error loading run of show data from Supabase:",h),console.error("❌ Error details:",{message:h.message,stack:h.stack,eventId:e?.id}),console.log("🔄 Falling back to localStorage due to error");const _=localStorage.getItem(`runOfShowSchedule_${e.id}`);if(_)try{const R=JSON.parse(_).map(G=>({...G,day:G.day||1}));ie(R),console.log("📥 Loaded schedule from localStorage after error:",R.length,"items"),console.log("🔍 First few items after error:",R.slice(0,3))}catch(T){console.error("❌ Error parsing schedule from localStorage after error:",T),console.log("🔍 Raw localStorage data after error:",_)}else console.log("❌ No schedule found in localStorage after error for event:",e.id)}},[e?.id]),_l=j.useCallback(async()=>{if(e?.id)try{console.log("🔄 Loading changes dynamically for event:",e.id);const h=await Ge.loadChangesDynamically(e.id);if(h){console.log("📥 Dynamic changes loaded:",{scheduleItemsCount:h.schedule_items?.length||0,customColumnsCount:h.custom_columns?.length||0,lastModifiedBy:h.last_modified_by_name});const _=h.schedule_items?[...h.schedule_items]:[];ie(_),X(h.custom_columns||[]),h.settings?.eventName&&fe(h.settings.eventName),h.settings?.masterStartTime&&Te(h.settings.masterStartTime),h.settings?.dayStartTimes&&le(h.settings.dayStartTimes),N(h.updated_at||null),V(!1),ce({show:!1}),console.log("✅ Changes loaded dynamically - timers preserved")}}catch(h){console.error("❌ Error loading changes dynamically:",h)}},[e?.id]);j.useEffect(()=>{console.log("🔄 useEffect triggered for event ID:",e?.id),e?.id?(console.log("🔄 Calling loadFromSupabase for event:",e.id),Hc()):console.log("❌ No event ID available for loading data")},[e?.id]),j.useEffect(()=>{console.log("📊 Schedule state changed:",{scheduleLength:I.length,firstItem:I[0]?{id:I[0].id,segmentName:I[0].segmentName,programType:I[0].programType}:"No items",eventId:e?.id})},[I,e?.id]);const Sl=async()=>{if(!e?.id){console.log("❌ No event ID available for loading backups");return}try{if(console.log("🔄 Loading backups for event:",e.id),console.log("🔄 Event details:",{id:e.id,name:e.name}),!await Li.testBackupTable())throw new Error("Backup table is not accessible");const _=await Li.getBackupsForEvent(e.id);console.log("📊 Raw backup data received:",_),ii(_),console.log("🔄 Loading backup stats...");const T=await Li.getBackupStats(e.id);console.log("📊 Backup stats:",T),cl(T),console.log(`✅ Loaded ${_.length} backups successfully`)}catch(h){console.error("❌ Error loading backups:",h),console.error("❌ Error details:",{message:h.message,stack:h.stack,eventId:e?.id}),ii([]),cl({totalBackups:0,lastBackup:null,autoBackups:0,manualBackups:0})}},Ud=async()=>{if(e?.id)try{console.log("🔄 Creating manual backup for event:",e.id);const h=new Date().toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),_=`${e.name} • ${h}`;await Li.createBackup(e.id,I,oe,e,"manual",_),console.log("✅ Manual backup created:",_);const T=await Li.getBackupStats(e.id);cl(T),alert(`✅ Manual backup created successfully!

Backup: ${_}
Schedule Items: ${I.length}
Custom Columns: ${oe.length}`)}catch(h){console.error("❌ Error creating manual backup:",h),alert(`❌ Error creating manual backup: ${h.message}`)}},$d=h=>{va(h),oi(!0)},Bd=async()=>{if(!(!e?.id||!cn))try{console.log("🔄 Restoring from backup:",cn.id);const h=await Li.restoreFromBackup(cn.id);ie(h.scheduleData),X(h.customColumnsData),localStorage.setItem(`runOfShowSchedule_${e.id}`,JSON.stringify(h.scheduleData)),localStorage.setItem(`customColumns_${e.id}`,JSON.stringify(h.customColumnsData)),await Ge.saveRunOfShowData({event_id:e.id,schedule_items:h.scheduleData,custom_columns:h.customColumnsData}),console.log("✅ Restored from backup:",h.backupName),oi(!1),ll(!1),va(null),alert(`✅ Data restored from backup!

Backup: ${h.backupName}
Date: ${new Date(h.backupTimestamp).toLocaleString()}

Schedule Items: ${h.scheduleData.length}
Custom Columns: ${h.customColumnsData.length}`)}catch(h){console.error("❌ Error restoring from backup:",h),alert(`❌ Error restoring from backup: ${h.message}`)}},Vd=async h=>{if(confirm("Are you sure you want to delete this backup?"))try{console.log("🔄 Deleting backup:",h),await Li.deleteBackup(h),console.log("✅ Backup deleted successfully"),alert("Backup deleted successfully"),await Sl()}catch(_){console.error("❌ Error deleting backup:",_),alert(`Error deleting backup: ${_.message}`)}};j.useEffect(()=>{if(!e?.id){console.log("❌ No event ID, skipping change detection");return}console.log("🔄 Starting change detection for event:",e.id),Ea();const h=async()=>{try{if(hl){console.log("⏭️ Skipping sync check - user just made a change"),fi(!1),Ea();return}if(_a){console.log("✏️ Skipping sync check - user is actively editing");return}console.log("🔄 Running change check...");const T=await Ge.checkForChanges(e.id,A??void 0);T.hasChanges?(console.log("🔄 Changes detected:",T),V(!0),ce({show:!0,lastModifiedBy:T.lastModifiedBy,lastModifiedByName:T.lastModifiedByName}),Vs?(console.log("🔄 Loading changes automatically..."),await _l()):console.log("👁️ Changes detected but page not visible - will load when page becomes visible")):console.log("✅ No changes detected")}catch(T){console.error("❌ Error checking for changes:",T)}};h();const _=setInterval(h,2e4);return()=>{clearInterval(_),ka()}},[e?.id,A,Vs,ka]),j.useEffect(()=>{Vs&&L&&(console.log("👁️ Page became visible with pending changes - loading changes..."),_l())},[Vs,L]),j.useEffect(()=>{to&&e?.id&&Sl()},[to,e?.id]),j.useEffect(()=>{const h=()=>{const _=!document.hidden;console.log(`🔄 Page visibility changed: ${_?"visible":"hidden"}`),dl(_),_?(console.log("🔄 Page became visible, checking for changes..."),Ln()):(Ic(new Date),console.log("🔄 Page became hidden, recording last sync time"))};return document.addEventListener("visibilitychange",h),()=>document.removeEventListener("visibilitychange",h)},[]);const Ln=async()=>{if(!e?.id||!Rt){console.log("🔄 No event ID or last sync time, skipping change check");return}try{console.log("🔄 Checking for changes since last sync...");const h=await Ge.getRunOfShowData(e.id);if(h){const _=new Date(h.last_change_at||new Date);console.log("🔄 Latest change time:",_),console.log("🔄 Last sync time:",Rt),_>Rt?(console.log("🔄 Changes detected since last sync, updating local data..."),ie(h.schedule_items||[]),X(h.custom_columns||[]),localStorage.setItem(`runOfShowSchedule_${e.id}`,JSON.stringify(h.schedule_items||[])),localStorage.setItem(`customColumns_${e.id}`,JSON.stringify(h.custom_columns||[])),console.log("✅ Local data updated with latest changes")):console.log("✅ No changes detected since last sync")}}catch(h){console.error("❌ Error checking for changes on return:",h)}};j.useEffect(()=>{e?.id&&(localStorage.setItem(`runOfShowSchedule_${e.id}`,JSON.stringify(I)),window.dispatchEvent(new CustomEvent("scheduleUpdated",{detail:{eventId:e.id,schedule:I}})),console.log("📝 Schedule saved and event dispatched for event:",e.id),kn())},[I,e?.id,kn]),j.useEffect(()=>{if(!e?.id)return;const h=()=>{console.log("🔄 Updating graphics data for live JSON files..."),localStorage.setItem(`runOfShowSchedule_${e.id}`,JSON.stringify(I)),localStorage.setItem(`customColumns_${e.id}`,JSON.stringify(oe)),localStorage.setItem(`eventName_${e.id}`,ae),localStorage.setItem(`masterStartTime_${e.id}`,me),localStorage.setItem(`dayStartTimes_${e.id}`,JSON.stringify(be)),window.dispatchEvent(new CustomEvent("scheduleUpdated",{detail:{eventId:e.id,schedule:I}}))};h();const _=setInterval(h,1e4);return()=>clearInterval(_)},[e?.id,I,oe,ae,me,be]),j.useEffect(()=>{e?.id&&(localStorage.setItem(`customColumns_${e.id}`,JSON.stringify(oe)),kn())},[oe,e?.id,kn]),j.useEffect(()=>{e?.id&&(localStorage.setItem(`eventName_${e.id}`,ae),kn())},[ae,e?.id,kn]),j.useEffect(()=>{e?.id&&(localStorage.setItem(`masterStartTime_${e.id}`,me),kn())},[me,e?.id,kn]),j.useEffect(()=>{e?.id&&(localStorage.setItem(`dayStartTimes_${e.id}`,JSON.stringify(be)),kn())},[be,e?.id,kn]),j.useEffect(()=>{if(De&&!De.closed){const h=Object.keys(it),_=h.length>0?I.find(R=>it[R.id]):I.find(R=>R.id===W),T={type:"TIMER_UPDATE",isRunning:h.length>0,elapsedTime:_&&H[_.id]?H[_.id].elapsed:0,totalDuration:_&&H[_.id]?H[_.id].total:_?_.durationHours*3600+_.durationMinutes*60+_.durationSeconds:0,eventId:e?.id,itemId:_?.id,mainTimer:_?{cue:_.customFields.cue||"CUE",segmentName:_.segmentName||""}:null,secondaryTimer:zt?{itemId:zt.itemId,remaining:zt.remaining,duration:zt.duration,cue:I.find(R=>R.id===zt.itemId)?.customFields.cue||"CUE",segmentName:I.find(R=>R.id===zt.itemId)?.segmentName||""}:null};De.postMessage(T,"*")}},[it,H,W,I,me,ae,De,zt]);const vi=h=>{const _=()=>{const G="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let ne="";for(let ue=0;ue<5;ue++)ne+=G.charAt(Math.floor(Math.random()*G.length));return ne},T={...h,id:Date.now(),timerId:_(),isIndented:h.isIndented||!1,customFields:{cue:h.cue?`CUE${h.cue}`:"CUE"}};Pe!==null?(ie(G=>{const ne=[...G];return ne.splice(Pe+1,0,T),ne}),K(null)):ie(G=>[...G,T]);const R=Pe!==null?Pe+2:I.length+1;O("ADD_ITEM",`Added new schedule item: "${T.segmentName}"`,{changeType:"ADD",itemId:T.id,itemName:T.segmentName,rowNumber:R,cueNumber:T.customFields.cue?parseInt(T.customFields.cue,10):null,details:{day:T.day,programType:T.programType,shotType:T.shotType,position:`Row ${R}`,durationHours:T.durationHours,durationMinutes:T.durationMinutes,totalDurationMinutes:T.durationHours*60+T.durationMinutes,speakers:T.speakers||"None",speakersText:T.speakersText||"None",notes:T.notes||"",assets:T.assets||"None",hasPPT:T.hasPPT,hasQA:T.hasQA,timerId:T.timerId,isPublic:T.isPublic,isIndented:T.isIndented}}),he(!1),Mr(),wr({cue:"",day:te,programType:"PreShow/End",shotType:"",segmentName:"",durationHours:0,durationMinutes:0,durationSeconds:0,notes:"",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!1,timerId:"",isPublic:!1,isIndented:!1,customFields:{}})},El=h=>{const _={name:h,id:Date.now().toString()};X(T=>[...T,_]),ie(T=>T.map(R=>({...R,customFields:{...R.customFields,[h]:""}}))),O("COLUMN_ADD",`Added custom column "${h}"`,{changeType:"COLUMN_ADD",columnName:h,details:{columnType:"text",affectedItems:I.length,defaultValue:""}}),we(!1),Mr()},zc=h=>{const _=oe.find(T=>T.id===h);_&&(X(T=>T.filter(R=>R.id!==h)),ie(T=>T.map(R=>{const{[_.name]:G,...ne}=R.customFields;return{...R,customFields:ne}})),O("COLUMN_REMOVE",`Removed custom column "${_.name}"`,{changeType:"COLUMN_REMOVE",columnName:_.name,details:{affectedItems:I.length,columnId:_.id}}))},Jt=(h,_)=>{h.preventDefault(),h.stopPropagation();const T=h.clientX,R=xt[_]||256;document.body.style.cursor="col-resize",document.body.style.userSelect="none";const G=ue=>{const Ne=ue.clientX-T,Re=Math.max(100,R+Ne);fl(We=>({...We,[_]:Re}))},ne=()=>{document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",G),document.removeEventListener("mouseup",ne)};document.addEventListener("mousemove",G),document.addEventListener("mouseup",ne)},kl=(h,_)=>{h.preventDefault(),h.stopPropagation();const T=h.clientX,R=Ws[_]||256;document.body.style.cursor="col-resize",document.body.style.userSelect="none";const G=ue=>{const Ne=ue.clientX-T,Re=Math.max(100,R+Ne);_s(We=>({...We,[_]:Re}))},ne=()=>{document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",G),document.removeEventListener("mouseup",ne)};document.addEventListener("mousemove",G),document.addEventListener("mouseup",ne)},Ys=async h=>{if(!(!s||!e?.id))if(it[h]){clearInterval(Lr[h]);const _=`${h}_drift`;it[_]&&clearInterval(Lr[_]),Gr(R=>{const G={...R};return delete G[h],delete G[_],G}),bn(R=>{const G={...R};return delete G[h],delete G[_],G}),Vr.stopMonitoring(h),_e(R=>{const G=new Set(R);return G.delete(h),G}),_n(R=>({...R,[h]:!0})),Pn(R=>new Set([...R,h]));try{const R=I.find(G=>G.id===h);await Ge.markCueCompleted(e.id,h,R?.customFields?.cue||"CUE",s.id,s.user_metadata?.full_name||s.email||"Unknown User",l||"VIEWER")}catch(R){console.warn("⚠️ Failed to mark cue as completed in database:",R),console.log("💡 This means the completed_cues table needs to be created first")}const T=I.findIndex(R=>R.id===h);if(T!==-1)for(let R=T+1;R<I.length&&I[R].isIndented;R++)_n(G=>({...G,[I[R].id]:!0})),Pn(G=>new Set([...G,I[R].id])),await Ge.markCueCompleted(e.id,I[R].id,I[R].customFields?.cue||"CUE",s.id,s.user_metadata?.full_name||s.email||"Unknown User",l||"VIEWER");He(R=>{const G={...R};return delete G[h],G}),W===h&&z(null),Q(R=>{const G={...R};return delete G[h],G}),console.log("🔄 Stopping timer in Supabase for item:",h),await Ge.stopTimer(e.id,h,s.id),console.log("✅ Timer stopped in Supabase");try{await Ge.updateLastLoadedCue(e.id,h,"stopped"),console.log("✅ Last loaded CUE saved as stopped")}catch(R){console.log("⚠️ Could not save last loaded CUE as stopped (migration may not be run):",R)}await co()}else{if(Object.keys(it).length>0)return;const _=I.find(T=>T.id===h);if(_){const T=_.durationHours*3600+_.durationMinutes*60+_.durationSeconds;console.log("⚡ Optimistic UI update - showing running state immediately");const R=new Date;Q(Ue=>({...Ue,[h]:{elapsed:0,total:T,startedAt:R}}));const G=setInterval(()=>{Q(Ue=>{if(Ue[h]){if(Ie.has(h)&&it[h]&&Ue[h]?.startedAt)return console.log(`🔄 Timer ${h}: Skipping local update - using server-synced time (Browser A)`),Ue;const qe=Date.now(),ot=Ue[h].startedAt;let jt;ot instanceof Date?jt=ot.getTime():typeof ot=="string"?jt=new Date(ot).getTime():(console.warn("⚠️ startedAt is not a Date or string:",ot),jt=qe);const Yt=Math.floor((qe-jt)/1e3),fn=T-Yt;return Vr.updateLocalElapsed(h,Yt),Yt<=10&&console.log(`🕐 Timer ${h}: Elapsed=${Yt}s, Remaining=${fn}s, Start=${new Date(jt).toISOString()}, Now=${new Date(qe).toISOString()}`),{...Ue,[h]:{...Ue[h],elapsed:Yt}}}return Ue})},100);bn(Ue=>({...Ue,[h]:G})),Gr(Ue=>({...Ue,[h]:!0})),console.log(`🔄 Starting drift detection for timer ${h} with duration ${T}s`),console.log("🔄 Drift detector config:",Vr.getConfig()),Vr.startMonitoring(h,R,T,Ue=>{console.log(`🔄 DriftDetector: Syncing timer ${h} with server elapsed: ${Ue}s`),_e(qe=>{const ot=new Set([...qe,h]);return console.log(`🔄 DriftDetector: Marking timer ${h} as server-synced. Server-synced timers:`,Array.from(ot)),ot}),Q(qe=>{const ot={...qe,[h]:{...qe[h],elapsed:Ue}};return console.log(`🔄 DriftDetector: Updated timer ${h} progress to elapsed: ${Ue}s`),ot})});const ne=Vr.getStatus();console.log("🔄 Drift detector status after starting:",ne),console.log(`🔄 Timer ${h} will run locally until first drift sync`);const Ne=I.findIndex(Ue=>Ue.id===h)+1,Re=yr(_.customFields.cue),We=_.timerId;console.log("🔄 Starting timer in Supabase for item:",h,"at:",R.toISOString(),"row:",Ne,"cue:",Re,"timerId:",We);try{const Ue=await Ge.startTimer(e.id,h,s.id,T,R,Ne,Re,We);console.log("✅ Timer started in Supabase:",Ue),Ue||console.error("❌ Start timer failed - check database connection and functions")}catch(Ue){console.error("❌ Start timer error:",Ue)}try{await Ge.updateLastLoadedCue(e.id,h,"running"),console.log("✅ Last loaded CUE saved as running")}catch(Ue){console.log("⚠️ Could not save last loaded CUE as running (migration may not be run):",Ue)}const Ke=setInterval(async()=>{try{console.log(`🔄 DriftDetector: Starting periodic sync for timer ${h}`),await Vr.forceSync(h,async()=>{const qe=(await Ge.getActiveTimer(e.id))?.elapsed_seconds||0;return console.log(`🔄 DriftDetector: Server returned elapsed: ${qe}s for timer ${h}`),qe}),console.log(`🔄 DriftDetector: Periodic sync completed for timer ${h}`)}catch(Ue){console.warn(`⚠️ DriftDetector: Failed to sync timer ${h}:`,Ue)}},3e4);bn(Ue=>({...Ue,[`${h}_drift`]:Ke})),console.log("✅ Timer started locally with drift detection enabled"),await co(),Pn(Ue=>{const qe=new Set(Ue);qe.delete(h);const ot=I.findIndex(jt=>jt.id===h);if(ot!==-1)for(let jt=ot+1;jt<I.length&&I[jt].isIndented;jt++)qe.delete(I[jt].id);return qe})}}},Wd=async h=>{if(!(!s||!e?.id)){if(console.log("🔄 Reset timer for item:",h),it[h]){clearInterval(Lr[h]);const _=`${h}_drift`;Lr[_]&&clearInterval(Lr[_]),Gr(T=>{const R={...T};return delete R[h],delete R[_],R}),bn(T=>{const R={...T};return delete R[h],delete R[_],R}),Vr.stopMonitoring(h),_e(T=>{const R=new Set(T);return R.delete(h),R}),Q(T=>{const R={...T};return delete R[h],R});try{await Ge.stopTimer(e.id,h,s.id),console.log("✅ Timer reset in Supabase")}catch(T){console.error("❌ Error resetting timer in database:",T)}}He(_=>{const T={..._};return delete T[h],T}),W===h&&z(null),console.log("✅ Timer reset completed for item:",h)}},Hd=async h=>{if(!s||!e?.id)return;const _=I.find(T=>T.id===h);if(_&&_.isIndented){const T=_.durationHours*3600+_.durationMinutes*60+_.durationSeconds;console.log("🟠 Starting secondary timer for item:",h,"Duration:",T,"s"),ve(G=>({...G,[h]:{elapsed:0,total:T,startedAt:new Date}}));const R=setInterval(()=>{ve(G=>{const ne=G[h];if(!ne)return G;const ue=Math.floor((Date.now()-(ne.startedAt?.getTime()||Date.now()))/1e3);return Math.max(0,ne.total-ue),{...G,[h]:{...ne,elapsed:ue}}}),Sn(G=>{if(!G)return null;if(jc)return G;const ne=G.startedAt?.getTime()||Date.now(),ue=Math.floor((Date.now()-ne)/1e3),Ne=Math.max(0,G.duration-ue);if(Ne===0){console.log("⏰ Sub-cue timer reached 0 - holding for a beat");const Re=e?.id;console.log("⏰ Current event ID for database call:",Re),setTimeout(()=>{console.log("⏰ Sub-cue timer auto-stopping after hold - clearing local state"),$s&&(clearInterval($s),bs(null)),Object.keys(bt).forEach(We=>{bt[parseInt(We)]&&clearInterval(bt[parseInt(We)])}),ln({}),ve({}),Sn(null),setTimeout(async()=>{try{if(Re){console.log("⏰ Clearing sub-cue timer from database after 3s delay with event ID:",Re);const We=await Ge.stopSubCueTimer(Re);console.log("⏰ Database stop result:",We),console.log("⏰ Sub-cue timer stopped in database (is_active = false)")}else console.error("❌ No event ID available for database call")}catch(We){console.error("❌ Error stopping sub-cue timer in database:",We),console.error("❌ Error details:",We)}},3e3)},1e3)}return{...G,remaining:Ne}})},1e3);ln(G=>({...G,[h]:R})),Sn({itemId:h,remaining:T,duration:T,isActive:!0,startedAt:new Date,timerState:"running"});try{console.log("🟠 User ID:",s.id,"Event ID:",e.id);const G=I.find(Re=>Re.id===h),ne=I.findIndex(Re=>Re.id===h)+1,ue=G?yr(G.customFields.cue):`CUE ${h}`,Ne=G?.timerId||`SUB${h}`;try{console.log("🔄 Starting sub-cue timer for item:",h,"(will auto-stop any existing timers)");const Re=await Ge.startSubCueTimer(e.id,h,s.id,T,ne,ue,Ne);console.log("✅ Secondary timer started in Supabase for item:",h,"Result:",Re),Re?.error&&console.error("❌ Secondary timer database error:",Re.error)}catch(Re){console.error("❌ Secondary timer call failed:",Re)}try{console.log("✅ Sub-cue timer started locally"),console.log("✅ Secondary timer action broadcasted")}catch(Re){console.error("❌ Error broadcasting secondary timer action:",Re)}await lo()}catch(G){console.error("❌ Error starting secondary timer:",G),clearInterval(R),ln(ne=>{const ue={...ne};return delete ue[h],ue}),ve(ne=>{const ue={...ne};return delete ue[h],ue})}}},Na=async()=>{if(e?.id){console.log("🛑 Stopping secondary timer..."),Sn(null),$s&&(clearInterval($s),bs(null)),Object.keys(bt).forEach(h=>{bt[parseInt(h)]&&clearInterval(bt[parseInt(h)])}),ln({}),ve({}),console.log("✅ Local secondary timer state cleared");try{console.log("🛑 Stopping sub-cue timer in database with event ID:",e.id);const h=await Ge.stopSubCueTimer(e.id);console.log("🛑 Database stop result:",h),console.log("🛑 Secondary timer stopped in database (is_active = false)");try{console.log("🛑 Broadcasting STOP_SECONDARY_TIMER action..."),console.log("✅ Sub-cue timer stopped locally"),console.log("✅ Secondary timer stop action broadcasted successfully")}catch(_){console.error("❌ Error broadcasting secondary timer stop action:",_)}}catch(h){console.error("❌ Error stopping sub-cue timer in database:",h),console.error("❌ Error details:",h)}try{await lo()}catch(h){console.error("❌ Error loading updated timer from Supabase:",h)}}},Tl=async h=>{try{console.log("📊 Processing Excel import:",h);const _=`This will add ${h.length} new items to your schedule. Continue?`;if(!window.confirm(_)){console.log("❌ Excel import cancelled by user");return}const T=h.map((R,G)=>{const ne=R.duration?R.duration.split(":"):["0","0","0"],ue=parseInt(ne[0])||0,Ne=parseInt(ne[1])||0,Re=parseInt(ne[2])||0;return{id:Math.max(...I.map(Ke=>Ke.id),0)+G+1,segmentName:R.segmentName||`Imported Item ${G+1}`,programType:R.programType||"",shotType:R.shotType||"",durationHours:ue,durationMinutes:Ne,durationSeconds:Re,notes:R.notes||"",assets:R.assets||"",speakers:R.speakers||"",speakersText:R.speakers||"",hasPPT:R.hasPPT||!1,hasQA:R.hasQA||!1,timerId:R.timerId||"",isPublic:R.isPublic||!1,isIndented:R.isIndented||!1,day:R.day||te,customFields:{cue:R.cue||`CUE ${G+1}`,...R.customFields}}});ie(R=>[...R,...T]),console.log("📊 Imported items with assets:",T.filter(R=>R.assets).map(R=>({id:R.id,segmentName:R.segmentName,assets:R.assets}))),O("IMPORT_EXCEL",`Imported ${T.length} items from Excel`,{changeType:"IMPORT",itemCount:T.length,source:"Excel"}),console.log("✅ Excel import completed successfully")}catch(_){console.error("❌ Error importing Excel data:",_),alert("Error importing Excel data. Please check the file format and try again.")}},yi=h=>{if(window.confirm("Delete this schedule item?")){const _=I.find(T=>T.id===h);if(ie(T=>T.filter(R=>R.id!==h)),zn(null),_){const T=I.findIndex(R=>R.id===h)+1;O("REMOVE_ITEM",`Deleted schedule item: "${_.segmentName}"`,{changeType:"DELETE",itemId:_.id,itemName:_.segmentName,rowNumber:T,cueNumber:_.customFields.cue?parseInt(_.customFields.cue,10):null,details:{day:_.day,programType:_.programType,shotType:_.shotType,position:`Row ${T}`,durationHours:_.durationHours,durationMinutes:_.durationMinutes,totalDurationMinutes:_.durationHours*60+_.durationMinutes,speakers:_.speakers||"None",speakersText:_.speakersText||"None",notes:_.notes||"",assets:_.assets||"None",hasPPT:_.hasPPT,hasQA:_.hasQA,timerId:_.timerId,isPublic:_.isPublic,isIndented:_.isIndented}})}}},mo=(h,_)=>{const T=I.findIndex(Ne=>Ne.id===h);if(T===-1)return;const R=_==="up"?T-1:T+1;if(R<0||R>=I.length)return;const G=I[T],ne=T+1,ue=R+1;ie(Ne=>{const Re=[...Ne];return[Re[T],Re[R]]=[Re[R],Re[T]],Re}),G&&O("MOVE_ITEM",`Moved "${G.segmentName}" from row ${ne} to row ${ue}`,{changeType:"MOVE",itemId:G.id,itemName:G.segmentName,details:{fromRow:ne,toRow:ue,direction:_}}),zn(null)},Gc=(h,_)=>{const T=I.findIndex(Ne=>Ne.id===h);if(T===-1)return;const R=_-1;if(R<0||R>=I.length||R===T)return;const G=I[T],ne=T+1,ue=_;ie(Ne=>{const Re=[...Ne],We=Re[T];return Re.splice(T,1),Re.splice(R,0,We),Re}),G&&O("MOVE_ITEM",`Moved "${G.segmentName}" from row ${ne} to row ${ue}`,{changeType:"MOVE",itemId:G.id,itemName:G.segmentName,details:{fromRow:ne,toRow:ue,direction:"specific"}}),zn(null)},Ca=h=>{const _=I[h];if(!_||_.isIndented)return"";const T=_.day||1,R=be[T]||me;if(!R)return"";let G=0;for(let qe=0;qe<h;qe++){const ot=I[qe];(ot.day||1)===T&&!ot.isIndented&&(G+=(ot.durationHours||0)*3600+(ot.durationMinutes||0)*60+(ot.durationSeconds||0))}const[ne,ue]=R.split(":").map(Number),Re=ne*3600+ue*60+G,We=Math.floor(Re/3600)%24,Ke=Math.floor(Re%3600/60),Ue=new Date;return Ue.setHours(We,Ke,0,0),Ue.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},Ur=()=>I.filter(h=>(h.day||1)===te);return j.useEffect(()=>{const h=()=>{const _=window.pageYOffset||document.documentElement.scrollTop;ss(_>100)};return window.addEventListener("scroll",h),()=>window.removeEventListener("scroll",h)},[]),j.useEffect(()=>{const h=document.getElementById("main-scroll-container");if(!h)return;let _=!1;const T=(ue,Ne)=>{_||(_=!0,Ne.scrollLeft=ue.scrollLeft,requestAnimationFrame(()=>{_=!1}))},R=()=>{const ue=document.querySelector(".sticky-header-scroll-container");ue&&T(h,ue)},G=()=>{const ue=document.querySelector(".sticky-header-scroll-container");ue&&T(ue,h)};h.addEventListener("scroll",R);const ne=new MutationObserver(()=>{const ue=document.querySelector(".sticky-header-scroll-container");ue&&ue.addEventListener("scroll",G)});return ne.observe(document.body,{childList:!0,subtree:!0}),()=>{h.removeEventListener("scroll",R),ne.disconnect()}},[]),j.useEffect(()=>{W!==null&&setTimeout(()=>{Rd()},100)},[W,fr]),j.useEffect(()=>{if(fr&&Object.keys(it).length>0){const h=parseInt(Object.keys(it)[0]),_=document.querySelector(`[data-item-id="${h}"]`);_&&setTimeout(()=>{const T=document.querySelector("#main-scroll-container .h-24");let R=100;if(T){const ue=T.getBoundingClientRect(),Ne=document.querySelector("#main-scroll-container")?.getBoundingClientRect();Ne&&(R=ue.bottom-Ne.top-120)}const G=_.getBoundingClientRect(),ne=document.querySelector("#main-scroll-container")?.getBoundingClientRect();if(ne){const ue=G.top-ne.top-R;window.scrollTo({top:ue,behavior:"smooth"})}},100)}},[it,fr]),e?c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 text-slate-200",children:[!Vs&&c.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-yellow-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2",children:[c.jsx("div",{className:"w-2 h-2 bg-yellow-300 rounded-full animate-pulse"}),c.jsx("span",{className:"text-sm font-medium",children:"Tab Hidden - Syncing Paused"})]}),c.jsx(Hx,{isOpen:f,onClose:()=>m(!1),onRoleSelected:h=>{if(u(h),e?.id&&s?.id)try{const _=s.user_metadata?.full_name||s.email||"Unknown";Ge.saveUserSession(e.id,s.id,_,h).then(T=>{T?console.log("✅ Role saved to Supabase from RunOfShowPage:",h):console.log("⚠️ Failed to save role to Supabase, using localStorage only")}),localStorage.setItem(`userRole_${e.id}`,h),console.log("💾 Saved role to localStorage from RunOfShowPage:",h)}catch(_){console.error("❌ Failed to save role to Supabase from RunOfShowPage:",_),localStorage.setItem(`userRole_${e.id}`,h),console.log("💾 Saved role to localStorage as fallback:",h)}m(!1)},eventId:e?.id||""}),ml&&qs&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsx("div",{className:"bg-slate-800 rounded-lg p-6 max-w-md w-full mx-4 border-2 border-orange-500",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-orange-400 text-2xl font-bold mb-4",children:"⏰ Timer Running"}),c.jsx("div",{className:"text-white text-lg mb-2",children:c.jsx("strong",{children:qs.cueName})}),c.jsxs("div",{className:"text-orange-300 text-xl font-mono mb-6",children:[qs.remainingTime," remaining"]}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx("button",{onClick:()=>mi(!1),className:"px-6 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded transition-colors",children:"Dismiss"}),c.jsx("button",{onClick:()=>{mi(!1),Cd()},className:"px-6 py-2 bg-orange-600 hover:bg-orange-500 text-white rounded transition-colors",children:"Sync Timer"})]})]})})}),p&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Change Log"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:()=>F(!1),className:`px-3 py-1 rounded text-sm transition-colors ${E?"bg-slate-600 text-slate-300 hover:bg-slate-500":"bg-blue-600 text-white"}`,children:["Local (",y.length,")"]}),c.jsxs("button",{onClick:()=>F(!0),className:`px-3 py-1 rounded text-sm transition-colors ${E?"bg-blue-600 text-white":"bg-slate-600 text-slate-300 hover:bg-slate-500"}`,children:["Master (",k.length,")"]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[!E&&c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:uo,className:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white text-sm rounded transition-colors",title:"Sync changes to Supabase",children:"🔄 Sync"}),c.jsx("button",{onClick:()=>{Sr.reloadLocalChanges();const h=Sr.getLocalChanges();S(h.slice(0,100)),console.log("🔄 Manually reloaded local changes:",h.length)},className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",title:"Reload local changes",children:"🔄 Reload"})]}),E&&c.jsx("button",{onClick:xl,className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",title:"Reload master change log",children:"🔄 Reload"}),c.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-white text-2xl",children:"×"})]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto",children:E?k.length===0?c.jsx("p",{className:"text-gray-400 text-center py-8",children:"No master changes found"}):c.jsx("div",{className:"space-y-3",children:k.map(h=>c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:`text-white text-xs px-2 py-1 rounded ${h.action==="ADD_ITEM"?"bg-green-600":h.action==="REMOVE_ITEM"?"bg-red-600":h.action==="FIELD_UPDATE"?"bg-blue-600":h.action==="MOVE_ITEM"?"bg-yellow-600":h.action==="COLUMN_ADD"?"bg-purple-600":h.action==="COLUMN_REMOVE"?"bg-orange-600":"bg-blue-600"}`,children:h.action}),c.jsxs("span",{className:"text-gray-300 text-sm",children:["by ",h.user_name]}),c.jsxs("span",{className:"text-gray-500 text-xs",children:["(",h.user_role,")"]}),h.row_number&&c.jsxs("span",{className:"text-gray-400 text-xs bg-slate-600 px-2 py-1 rounded",children:["ROW ",h.row_number]}),h.cue_number&&h.cue_number!=="CUE"&&c.jsx("span",{className:"text-gray-400 text-xs bg-slate-600 px-2 py-1 rounded",children:yr(h.cue_number)})]}),c.jsx("div",{className:"text-gray-400 text-xs",children:new Date(h.timestamp||h.change_timestamp).toLocaleString()})]}),h.details&&c.jsxs("div",{className:"space-y-1 text-sm",children:[h.details.fieldName&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Field:"})," ",h.details.fieldName]}),h.details.oldValue!==void 0&&h.details.newValue!==void 0&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Changed from:"}),c.jsxs("span",{className:"text-red-300 ml-1",children:['"',h.details.oldValue,'"']}),c.jsx("span",{className:"text-slate-400 mx-1",children:"→"}),c.jsxs("span",{className:"text-green-300",children:['"',h.details.newValue,'"']})]}),h.batch_id&&c.jsxs("div",{className:"text-gray-500 text-xs mt-2 pt-2 border-t border-slate-600",children:["Batch: ",h.batch_id.slice(0,8),"... | Synced: ",new Date(h.batch_created_at).toLocaleString()]})]})]},h.id))}):y.length===0&&B.size===0?c.jsx("p",{className:"text-gray-400 text-center py-8",children:"No local changes recorded yet"}):c.jsxs("div",{className:"space-y-3",children:[y.map(h=>c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:`text-white text-xs px-2 py-1 rounded ${h.action==="ADD_ITEM"?"bg-green-600":h.action==="REMOVE_ITEM"?"bg-red-600":h.action==="FIELD_UPDATE"?"bg-blue-600":h.action==="MOVE_ITEM"?"bg-yellow-600":h.action==="COLUMN_ADD"?"bg-purple-600":h.action==="COLUMN_REMOVE"?"bg-orange-600":h.action==="AUTO_SAVE"?"bg-gray-600":"bg-blue-600"}`,children:h.action}),h.details?.processedBy&&c.jsx("span",{className:`text-white text-xs px-2 py-1 rounded ${h.details.processedBy==="TIMEOUT"?"bg-orange-600":h.details.processedBy==="SAVE_BUTTON"?"bg-purple-600":"bg-gray-600"}`,children:h.details.processedBy}),c.jsxs("span",{className:"text-gray-300 text-sm",children:["by ",h.userName]}),h.details?.itemId&&c.jsxs("span",{className:"text-gray-400 text-xs",children:["Item #",h.details.itemId]})]}),c.jsx("div",{className:"text-gray-400 text-xs",children:h.timestamp.toLocaleString()})]}),h.details&&c.jsxs("div",{className:"space-y-1 text-sm",children:[(h.details?.rowNumber||h.details?.cueNumber)&&c.jsx("div",{className:"text-gray-300",children:c.jsxs("strong",{children:["Row ",h.details?.rowNumber||"?"," | ",h.details?.cueNumber||"CUE"]})}),h.action==="ADD_ITEM"&&h.details.details&&c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Program Type:"})," ",h.details.details.programType]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Shot Type:"})," ",h.details.details.shotType]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Duration:"})," ",h.details.details.durationHours,"h ",h.details.details.durationMinutes,"m"]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Speakers:"})," ",h.details.details.speakers]}),h.details.details.notes&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Notes:"})," ",h.details.details.notes]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Position:"})," ",h.details.details.position]})]}),h.action==="REMOVE_ITEM"&&h.details.details&&c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Program Type:"})," ",h.details.details.programType]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Shot Type:"})," ",h.details.details.shotType]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Duration:"})," ",h.details.details.durationHours,"h ",h.details.details.durationMinutes,"m"]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Speakers:"})," ",h.details.details.speakers]}),h.details.details.notes&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Notes:"})," ",h.details.details.notes]})]}),h.action!=="ADD_ITEM"&&h.action!=="REMOVE_ITEM"&&h.details.fieldName&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Field:"})," ",h.details.fieldName]}),h.action!=="ADD_ITEM"&&h.action!=="REMOVE_ITEM"&&h.details.fieldName==="speakers"&&h.details.details&&c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Speaker Count:"})," ",h.details.details.speakerCount||0]}),h.details.newValue&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Speakers:"}),c.jsx("div",{className:"mt-1 text-sm text-blue-300",children:(()=>{try{const _=JSON.parse(h.details.newValue);if(Array.isArray(_))return _.sort((T,R)=>T.slot-R.slot).map(T=>`${T.slot}. ${T.fullName||T.name||"Unknown"} (${T.location||"Unknown"})`).join(", ")}catch{return"Unable to parse speakers"}return"No speakers"})()})]})]}),h.action!=="ADD_ITEM"&&h.action!=="REMOVE_ITEM"&&h.details.fieldName==="assets"&&h.details.details&&c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Asset Count:"})," ",h.details.details.assetCount||0]}),h.details.newValue&&c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Assets:"}),c.jsx("div",{className:"mt-1 text-sm text-blue-300",children:h.details.newValue.split("||").filter(T=>T.trim()).map(T=>{if(T.includes("|")){const[R,G]=T.split("|");return`${R}${G?` (${G})`:""}`}return T}).join(", ")})]})]}),h.action==="MOVE_ITEM"&&h.details.details&&c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Moved from Row:"})," ",h.details.details.fromRow||"Unknown"]}),c.jsxs("div",{className:"text-gray-300",children:[c.jsx("strong",{children:"Moved to Row:"})," ",h.details.details.toRow||"Unknown"]})]}),h.action!=="ADD_ITEM"&&h.action!=="REMOVE_ITEM"&&h.action!=="MOVE_ITEM"&&h.details.fieldName!=="speakers"&&h.details.fieldName!=="assets"&&h.details.oldValue!==void 0&&h.details.newValue!==void 0&&c.jsx("div",{className:"text-gray-300",children:h.details.fieldName==="durationHours"||h.details.fieldName==="durationMinutes"||h.details.fieldName==="durationSeconds"?c.jsx("span",{className:"text-green-300",children:h.details.newValue}):c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Changed from:"}),c.jsxs("span",{className:"text-red-300 ml-1",children:['"',h.details.oldValue,'"']}),c.jsx("span",{className:"text-gray-400 mx-1",children:"→"}),c.jsxs("span",{className:"text-green-300",children:['"',h.details.newValue,'"']})]})})]})]},h.id)),Array.from(B.entries()).map(([h,_])=>{const T=Date.now()-_.timestamp.getTime(),R=Math.max(0,1e4-T),G=Math.ceil(R/1e3);return c.jsxs("div",{className:"bg-slate-600 rounded-lg p-4 border-2 border-yellow-500 animate-pulse",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("span",{className:"bg-yellow-600 text-white text-xs px-2 py-1 rounded",children:["PENDING [",_.originalKey||"NO_KEY","]"]}),c.jsxs("span",{className:"text-slate-300 text-sm",children:["by ",_.user]}),c.jsxs("span",{className:"text-yellow-300 text-xs",children:["⏳ Will confirm in ",G,"s"]})]}),c.jsx("div",{className:"text-slate-400 text-xs",children:_.timestamp.toLocaleString()})]}),_.details&&c.jsxs("div",{className:"space-y-1 text-sm",children:[(_.details?.rowNumber||_.details?.cueNumber)&&c.jsx("div",{className:"text-slate-300",children:c.jsxs("strong",{children:["Row ",_.details?.rowNumber||"?"," | ",_.details?.cueNumber||"CUE"]})}),_.details.fieldName&&c.jsxs("div",{className:"text-slate-300",children:[c.jsx("strong",{children:"Field:"})," ",_.details.fieldName]}),_.details.oldValue!==void 0&&_.details.newValue!==void 0&&c.jsxs("div",{className:"text-slate-300",children:[c.jsx("strong",{children:"Will change from:"}),c.jsxs("span",{className:"text-red-300 ml-1",children:['"',_.details.oldValue,'"']}),c.jsx("span",{className:"text-slate-400 mx-1",children:"→"}),c.jsxs("span",{className:"text-green-300",children:['"',_.details.newValue,'"']})]})]})]},h)})]})}),c.jsx("div",{className:"mt-4 pt-4 border-t border-slate-600",children:c.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-400",children:[c.jsxs("div",{children:[c.jsxs("span",{children:["Total changes: ",y.length," (",B.size," pending)"]}),B.size>0&&c.jsx("span",{className:"ml-2 text-yellow-400",children:"• Changes will be confirmed after 10s of inactivity"})]}),c.jsxs("div",{className:"flex gap-2",children:[B.size>0&&c.jsxs("button",{className:"px-3 py-1 bg-yellow-600 text-white rounded transition-colors animate-pulse cursor-not-allowed",disabled:!0,title:"Changes are pending and will auto-save after 5 seconds",children:["⏳ Changes Pending (",B.size,")"]}),c.jsx("button",{onClick:Ad,className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",title:"Clear all change logs (password protected)",children:"🗑️ Clear All Logs"})]})]})})]})}),c.jsx("style",{children:`
          select {
            border: 2px solid #64748b !important;
            border-radius: 6px !important;
          }
          select:focus {
            border-color: #3b82f6 !important;
            outline: none !important;
          }
          select option {
            background-color: #1e293b !important;
            color: #ffffff !important;
            border-bottom: 1px solid #475569 !important;
            padding: 8px 12px !important;
            margin: 0 !important;
          }
          select option:hover {
            background-color: #334155 !important;
          }
          select option:checked {
            background-color: #3b82f6 !important;
          }
        `}),c.jsx("div",{className:"fixed top-16 left-0 right-0 z-40 bg-slate-900 shadow-lg border-b border-slate-600",style:{height:pa?"240px":"150px"},children:c.jsxs("div",{className:"py-2 pt-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2 px-8",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:()=>r("/"),className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"← Back to Events"}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:h=>{h.stopPropagation(),Me(!Je)},className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",title:"Menu",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),Je&&c.jsx("div",{className:"absolute top-full left-0 mt-1 w-48 bg-slate-800 border border-slate-600 rounded-lg shadow-lg z-50",children:c.jsxs("div",{className:"py-1",children:[c.jsxs("button",{onClick:bl,className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Full Timer"]}),c.jsxs("button",{onClick:()=>{Me(!1);const h=`/reports?eventId=${e?.id}&eventName=${encodeURIComponent(e?.name||"")}`;window.open(h,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Reports and Printing"]}),c.jsxs("button",{onClick:()=>{Me(!1);const h=`/graphics-links?eventId=${e?.id}&eventName=${encodeURIComponent(e?.name||"")}`;window.open(h,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Graphic Links"]}),c.jsxs("button",{onClick:()=>{Me(!1);const h=`/photo-view?eventId=${e?.id}&eventName=${encodeURIComponent(e?.name||"")}&eventDate=${encodeURIComponent(e?.date||"")}&eventLocation=${encodeURIComponent(e?.location||"")}`;window.open(h,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"PhotoView"]}),c.jsxs("button",{onClick:()=>{Me(!1),console.log("=== CSV EXPORT ==="),console.log("Event:",e),console.log("Schedule length:",I.length),console.log("Full schedule:",I),console.log("Master start time:",me);const h=["ROW","CUE","Program Type","Shot Type","Segment Name","Duration","Start Time","End Time","Notes","Assets","Speakers","Has PPT","Has QA","Timer ID","Is Public","Is Indented","Day"],_=oe.map(We=>We.name),T=[...h,..._],G=I.filter(We=>(We.day||1)===te).map((We,Ke)=>{const Ue=I.findIndex(Mn=>Mn.id===We.id),qe=Ca(Ue),ot=`${We.durationHours}:${We.durationMinutes.toString().padStart(2,"0")}:${We.durationSeconds.toString().padStart(2,"0")}`,jt=qe?(()=>{const[Mn,Bt,Aa]=qe.split(":").map(Number),[go,wi,Kc]=ot.split(":").map(Number);let bi=Mn*3600+Bt*60+Aa+(go*3600+wi*60+Kc);const _i=Math.floor(bi/3600),po=Math.floor(bi%3600/60),Ra=bi%60;return`${_i.toString().padStart(2,"0")}:${po.toString().padStart(2,"0")}:${Ra.toString().padStart(2,"0")}`})():"",Yt=[Ke+1,We.customFields?.cue||`CUE ${Ke+1}`,We.programType||"",We.shotType||"",We.segmentName||"",ot,qe||"",jt,We.notes||"",We.assets||"",We.speakersText||"",We.hasPPT?"Yes":"No",We.hasQA?"Yes":"No",We.timerId||"",We.isPublic?"Yes":"No",We.isIndented?"Yes":"No",We.day||1],fn=oe.map(Mn=>We.customFields[Mn.id]||"");return[...Yt,...fn]}),ne=[T.join(","),...G.map(We=>We.map(Ke=>typeof Ke=="string"&&(Ke.includes(",")||Ke.includes('"')||Ke.includes(`
`))?`"${Ke.replace(/"/g,'""')}"`:Ke).join(","))].join(`
`);console.log("CSV Content:",ne);const ue=new Blob([ne],{type:"text/csv;charset=utf-8;"}),Ne=URL.createObjectURL(ue),Re=document.createElement("a");Re.href=Ne,Re.download=`${e?.name||"RunOfShow"}_Day${te}_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(Re),Re.click(),document.body.removeChild(Re),URL.revokeObjectURL(Ne),console.log("=== END CSV EXPORT ===")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export CSV"]}),c.jsxs("button",{onClick:()=>{Me(!1),ai(!0)},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Import Excel"]}),c.jsxs("button",{onClick:()=>{Me(!1),ll(!0)},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Backups"]}),c.jsxs("button",{onClick:()=>{Me(!1);const h=`/green-room?eventId=${e?.id}&eventName=${encodeURIComponent(e?.name||"")}&eventDate=${e?.date||""}&eventLocation=${encodeURIComponent(e?.location||"")}`;window.open(h,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Green Room"]}),c.jsxs("button",{onClick:()=>{Me(!1),Rc(!0)},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"OSC Control"]})]})})]})]}),c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-white font-semibold",children:"Event Name:"}),c.jsx("div",{className:"px-4 py-2 bg-slate-700 border-2 border-slate-600 rounded-lg text-white w-64",children:ae||"No Event Name"}),e?.numberOfDays&&e.numberOfDays>1&&c.jsxs(c.Fragment,{children:[c.jsx("label",{className:"text-white font-semibold",children:"Working Day:"}),c.jsx("select",{value:te,onChange:h=>{vt(),pe(parseInt(h.target.value))},className:"px-4 py-2 bg-slate-700 border-2 border-slate-600 rounded-lg text-white focus:border-blue-500 focus:outline-none w-32",children:Array.from({length:e.numberOfDays},(h,_)=>c.jsxs("option",{value:_+1,children:["Day ",_+1]},_+1))})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-white font-semibold",children:"Start Time:"}),c.jsx("input",{type:"time",value:e?.numberOfDays&&e.numberOfDays>1?be[te]||"":me,onChange:h=>{if(vt(),l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can change start time. Please change your role to EDITOR.");return}e?.numberOfDays&&e.numberOfDays>1?le(_=>({..._,[te]:h.target.value})):Te(h.target.value)},disabled:l==="VIEWER"||l==="OPERATOR",className:"px-4 py-2 border-2 rounded-lg focus:outline-none w-48 transition-colors bg-slate-700 border-slate-600 text-white focus:border-blue-500",style:{colorScheme:"dark"},title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can change start time":`Set ${e?.numberOfDays&&e.numberOfDays>1?`Day ${te}`:"master"} start time`})]})]}),c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsx("div",{className:"text-center",children:Object.keys(it).length>0?c.jsxs("div",{className:"text-lg text-green-400 font-bold",children:["RUNNING - ",yr(I.find(h=>it[h.id])?.customFields.cue),zt&&c.jsxs("div",{className:"text-lg text-orange-400 mt-0.5 font-bold",children:[yr(I.find(h=>h.id===zt.itemId)?.customFields.cue)," - ",Ld(zt.remaining)]})]}):W&&H[W]?c.jsxs("div",{className:"text-lg text-yellow-400 font-bold",children:["LOADED - ",yr(I.find(h=>h.id===W)?.customFields.cue)]}):c.jsx("div",{className:"text-lg text-slate-300 font-bold",children:"No CUE Selected"})}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"text-3xl font-mono bg-slate-800 px-6 py-3 rounded-lg border border-slate-600",style:{color:Md()},children:Pd(Bc())}),W&&c.jsx("div",{className:"absolute bottom-1 right-1",children:c.jsx(zx,{itemId:W,className:"flex-shrink-0"})})]})]})]}),c.jsx("div",{className:"px-8 mb-2",children:c.jsx("div",{className:"w-full h-2 bg-slate-700 rounded-full overflow-hidden border border-slate-600 relative",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${pi()}%`,background:xi()}})})}),c.jsx("div",{className:"px-8 pb-2",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"text-sm text-slate-300",children:["Role: ",c.jsx("span",{className:"font-semibold text-white",children:l})]}),c.jsx("button",{onClick:()=>m(!0),className:"px-3 py-1 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded transition-colors",title:"Change your role",children:"Change Role"}),c.jsx("button",{onClick:Ud,className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",title:"Create a manual backup of current data",children:"💾 Create Backup"}),_a&&c.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 bg-yellow-600 rounded text-sm",children:[c.jsx("div",{className:"w-2 h-2 bg-yellow-200 rounded-full animate-pulse"}),c.jsx("span",{className:"text-yellow-100 font-medium",children:"Editing - Sync Paused"})]}),!_a&&Vs&&c.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 bg-blue-600 rounded text-sm",children:[c.jsx("div",{className:"w-2 h-2 bg-blue-200 rounded-full animate-pulse"}),c.jsx("span",{className:"text-blue-100 font-medium",children:io?"Syncing...":`Next sync in ${ao}s`})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>Bs(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm font-medium rounded transition-colors",title:"Open Filter View",children:"Filter View"}),c.jsx("button",{onClick:()=>Ss(!zs),className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${zs?"bg-green-600 hover:bg-green-500":"bg-slate-600 hover:bg-slate-500"}`,title:zs?"Disable Time Toast":"Enable Time Toast",children:"⏰ Time Toast"}),c.jsx("button",{onClick:()=>is(!fr),className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${fr?"bg-purple-600 hover:bg-purple-500 ring-4 ring-inset ring-green-400":"bg-purple-600 hover:bg-purple-500"}`,title:fr?"Disable auto-scroll to active row":"Enable auto-scroll to active row",children:"🎯 Follow"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-medium",children:"Duration:"}),c.jsx("button",{onClick:async()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await Js(-300)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-700 hover:bg-red-600"}`,disabled:l==="VIEWER"||l==="EDITOR",title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can adjust timer duration":"Subtract 5 minutes",children:"-5"}),c.jsx("button",{onClick:async()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await Js(-60)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-600 hover:bg-red-500"}`,disabled:l==="VIEWER"||l==="EDITOR",title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can adjust timer duration":"Subtract 1 minute",children:"-1"}),c.jsx("button",{onClick:async()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await Js(60)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500"}`,disabled:l==="VIEWER"||l==="EDITOR",title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can adjust timer duration":"Add 1 minute",children:"+1"}),c.jsx("button",{onClick:async()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await Js(300)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-700 hover:bg-blue-600"}`,disabled:l==="VIEWER"||l==="EDITOR",title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can adjust timer duration":"Add 5 minutes",children:"+5"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can send messages. Please change your role to OPERATOR.");return}Dt(!0)},className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":as?"bg-purple-600 hover:bg-purple-500 ring-4 ring-inset ring-green-500":"bg-purple-600 hover:bg-purple-500"}`,disabled:l==="VIEWER"||l==="EDITOR",title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can send messages":"Send Messages to Full Screen Timer",children:"Messages"}),as&&c.jsx("button",{onClick:async()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can control messages. Please change your role to OPERATOR.");return}try{if(e?.id){const _=(await Ge.getTimerMessagesForEvent(e.id)).find(T=>T.enabled);_&&(await Ge.disableTimerMessage(_.id),console.log("✅ Message disabled in Supabase via Turn Off button"))}}catch(h){console.error("❌ Error disabling message in Supabase:",h)}Dn(!1),Gn(""),De&&!De.closed&&De.postMessage({type:"MESSAGE_UPDATE",message:"",enabled:!1},"*")},className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500 animate-pulse"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot control messages":"Turn Off Message",children:"Click to Turn Off"})]})]})]})}),c.jsx("div",{className:`px-8 transition-all duration-500 ease-in-out overflow-hidden ${pa?"max-h-80 opacity-100 -mb-6":"max-h-0 opacity-0 mb-0"}`,children:c.jsx("div",{className:"bg-slate-800 rounded-xl p-4 shadow-2xl",style:{transform:"scale(0.75)",transformOrigin:"top center",width:"127.67%",marginLeft:"-13.83%"},children:c.jsxs("div",{className:"flex border-2 border-slate-600 rounded-lg overflow-hidden bg-slate-900",children:[c.jsx("div",{className:"w-12 flex-shrink-0 bg-slate-900 border-r-2 border-slate-600",children:c.jsx("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold text-xs",children:"#"})})}),c.jsx("div",{className:"w-40 flex-shrink-0 bg-slate-900",style:{borderRight:"6px solid #475569"},children:c.jsx("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:c.jsxs("span",{className:"text-white font-bold text-lg flex items-center gap-1",children:["CUE",l==="VIEWER"&&c.jsx("span",{className:"text-yellow-400",title:"Viewers cannot edit CUE",children:"🔒"})]})})}),c.jsx("div",{className:"flex-1 overflow-x-auto sticky-header-scroll-container",style:{scrollbarWidth:"thin"},children:c.jsx("div",{className:"min-w-max",children:c.jsxs("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex",children:[ft.start&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.start},children:[c.jsx("span",{className:"text-white font-bold",children:"Start"}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"start")})]}),ft.programType&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.programType},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Program Type",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"programType")})]}),ft.duration&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.duration},children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-white font-bold flex items-center justify-center gap-1",children:["Duration",l==="VIEWER"&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"text-xs text-slate-400",children:"HH MM SS"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"duration")})]}),ft.segmentName&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.segmentName},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Segment Name",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"segmentName")})]}),ft.shotType&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.shotType},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Shot Type",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"shotType")})]}),ft.pptQA&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.pptQA},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["PPT/Q&A",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"pptQA")})]}),ft.notes&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.notes},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Notes",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"notes")})]}),ft.assets&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.assets},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Assets",l==="VIEWER"&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for VIEWERs",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"assets")})]}),ft.participants&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.participants},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Participants",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"participants")})]}),ft.speakers&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.speakers},children:[c.jsx("span",{className:"text-white font-bold",children:"Speakers"}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"speakers")})]}),ft.public&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.public},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Public",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"public")})]}),oe.map(h=>li[h.id]!==!1&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center relative flex-shrink-0",style:{width:Ws[h.id]||256},children:[c.jsx("span",{className:"text-white font-bold",children:h.name}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:_=>kl(_,h.id)})]},h.id))]})})}),c.jsx("div",{className:"w-32 flex-shrink-0 bg-slate-900",style:{borderLeft:"6px solid #475569"},children:c.jsx("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:c.jsxs("span",{className:"text-white font-bold text-base flex items-center gap-1",children:["Timer",(l==="VIEWER"||l==="EDITOR")&&c.jsx("span",{className:"text-yellow-400",title:"Only OPERATORs can control timers",children:"🔒"})]})})})]})})})]})}),c.jsx("div",{className:"max-w-[95%] mx-auto px-6",style:{paddingTop:"250px"},children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 shadow-2xl",style:{transform:"scale(0.75)",transformOrigin:"top center",width:"133.33%",marginLeft:"-16.67%"},children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Schedule",e?.numberOfDays&&e.numberOfDays>1?` - Day ${te}`:""]}),s&&c.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[c.jsxs("button",{onClick:()=>v(!0),className:"text-xs bg-purple-600 hover:bg-purple-500 text-white px-2 py-1 rounded transition-colors",title:"View change history",children:["📝 Change Log (",y.length+B.size,")",Sr.getChangesCount().unsynced>0&&c.jsxs("span",{className:"ml-1 text-yellow-400",children:["(",Sr.getChangesCount().unsynced," unsynced)"]})]}),Es>0&&c.jsx("button",{onClick:async()=>{await ee()},className:"text-xs bg-yellow-600 hover:bg-yellow-500 text-white px-2 py-1 rounded transition-colors animate-pulse",title:`${Es} unsynced change${Es!==1?"s":""} - Click to sync`,children:Es}),B.size>0&&c.jsxs("button",{className:"text-xs bg-yellow-600 text-white px-2 py-1 rounded transition-colors animate-pulse cursor-not-allowed",title:"Changes are pending and will auto-save after 5 seconds",disabled:!0,children:["⏳ Changes Pending (",B.size,")"]})]})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>{if(l==="VIEWER"){alert("Viewers cannot add items. Please change your role to EDITOR or OPERATOR.");return}hr(),he(!0),wr({cue:"",day:te,programType:"PreShow/End",shotType:"",segmentName:"",durationHours:0,durationMinutes:0,durationSeconds:0,notes:"",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!1,timerId:"",isPublic:!1,isIndented:!1,customFields:{}})},className:`px-4 py-2 font-medium rounded text-sm transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Only EDITORs and OPERATORs can add items":"Add new item",children:"+ Item"}),c.jsx("button",{onClick:()=>{if(l==="VIEWER"){alert("Viewers cannot add columns. Please change your role to EDITOR or OPERATOR.");return}hr(),we(!0)},className:`px-4 py-2 font-medium rounded text-sm transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot add columns":"Add custom column",children:"+ Column"}),c.jsx("button",{onClick:async()=>{if(l==="VIEWER"){alert("Viewers cannot reset the schedule. Please change your role to EDITOR or OPERATOR.");return}await wl()},className:`px-4 py-2 font-medium rounded text-sm transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-600 hover:bg-red-700 text-white"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot reset the schedule":"Reset all states",children:"Reset"})]})]}),c.jsxs("div",{className:"flex border-2 border-slate-600 rounded-lg overflow-hidden bg-slate-900",children:[c.jsxs("div",{className:"w-12 flex-shrink-0 bg-slate-900 border-r-2 border-slate-600",children:[c.jsx("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold text-xs",children:"#"})}),Ur().length===0?c.jsx("div",{className:"h-24 flex items-center justify-center text-slate-500",children:"-"}):Ur().map((h,_)=>c.jsx("div",{className:`border-b-2 border-slate-600 flex items-center justify-center gap-1 ${it[h.id]?"bg-green-900 border-green-500":W===h.id?"bg-blue-900 border-blue-500":Oc.has(h.id)?"bg-amber-800 border-amber-600":ni[h.id]||ya.has(h.id)?"bg-gray-900 border-gray-700 opacity-40":_%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:En(h.notes,h.speakersText,h.speakers,h.customFields,oe)},children:c.jsxs("div",{className:"flex flex-col items-center gap-1",children:[c.jsx("button",{onClick:()=>{if(l==="VIEWER"){alert("Viewers cannot jump to rows. Please change your role to EDITOR or OPERATOR.");return}console.log("✏️ Row jump button clicked - pausing sync"),Gs(!0),dn&&clearTimeout(dn),setTimeout(()=>{const T=prompt(`Move to row (1-${Ur().length}):`,(_+1).toString());console.log("⏸️ Row jump prompt closed - resuming sync in 5 seconds");const R=setTimeout(()=>{console.log("⏸️ User stopped editing - resuming sync"),Gs(!1)},5e3);Sa(R),T&&!isNaN(Number(T))&&Gc(h.id,Number(T))},0)},className:`w-5 h-5 text-white rounded flex items-center justify-center text-xs font-bold transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-purple-600 hover:bg-purple-500"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot jump to rows":"Jump to Row",children:"#"}),c.jsx("span",{className:"text-white font-bold text-lg",children:_+1}),c.jsx("button",{onClick:()=>{if(l==="VIEWER"){alert("Viewers cannot add rows. Please change your role to EDITOR or OPERATOR.");return}hr(),K(_),he(!0)},className:`w-5 h-5 text-white rounded flex items-center justify-center text-xs font-bold transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot add rows":`Insert row after row ${_+1}`,children:"+"})]})},`${h.id}-${h.notes?.length||0}-${h.speakers?.length||0}`))]}),c.jsxs("div",{className:"w-40 flex-shrink-0 bg-slate-900",style:{borderRight:"6px solid #475569"},children:[c.jsx("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:c.jsxs("span",{className:"text-white font-bold text-lg flex items-center gap-1",children:["CUE",l==="VIEWER"&&c.jsx("span",{className:"text-yellow-400",title:"Viewers cannot edit CUE",children:"🔒"})]})}),Ur().length===0?c.jsx("div",{className:"h-24 flex items-center justify-center text-slate-500",children:"No items"}):Ur().map((h,_)=>c.jsxs("div",{className:`border-b-2 border-slate-600 flex flex-col items-center justify-center gap-1 ${_%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:En(h.notes,h.speakersText,h.speakers,h.customFields,oe)},children:[c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:`flex items-center px-1 py-1 border border-slate-600 border-r-0 rounded-l text-white text-lg font-medium min-w-[40px] ${wa===h.id?"bg-purple-600":"bg-slate-600"}`,children:"CUE"}),c.jsx("input",{type:"text",value:h.customFields.cue?h.customFields.cue.replace(/^CUE\s*/,""):"",onChange:T=>{if(vt(),l==="VIEWER"){alert("Viewers cannot edit cue names. Please change your role to EDITOR or OPERATOR.");return}const R=h.customFields.cue||"CUE ",G=T.target.value?`CUE ${T.target.value}`:"CUE ";ie(ne=>ne.map(ue=>ue.id===h.id?{...ue,customFields:{...ue.customFields,cue:G}}:ue)),U(`cue_${h.id}`,"FIELD_UPDATE",`Updated cue for "${h.segmentName}" from "${R}" to "${G}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"cue",oldValue:R,newValue:G,details:{fieldType:"text",characterChange:G.length-R.length}})},disabled:l==="VIEWER",className:"w-14 px-1 py-1 border border-slate-600 rounded-r text-center text-lg transition-colors bg-slate-700 text-white focus:outline-none focus:border-blue-500",title:l==="VIEWER"?"Viewers cannot edit cue names":"Edit cue number",maxLength:4})]}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>{if(vt(),l==="VIEWER"){alert("Viewers cannot indent/unindent items. Please change your role to EDITOR or OPERATOR.");return}const T=h.isIndented;ie(R=>R.map(G=>G.id===h.id?{...G,isIndented:!G.isIndented}:G)),O("FIELD_UPDATE",`Updated indentation for "${h.segmentName}" from ${T} to ${!T}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"isIndented",oldValue:T,newValue:!T,details:{fieldType:"boolean",booleanChange:!0}})},className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot indent/unindent items":h.isIndented?"Unindent (group with row above)":"Indent (group with row above)",children:h.isIndented?"↗":"↘"}),c.jsx("button",{onClick:()=>{if(vt(),l==="VIEWER"){alert("Viewers cannot move items. Please change your role to EDITOR or OPERATOR.");return}mo(h.id,"up")},disabled:_===0||l==="VIEWER",className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500 disabled:opacity-30 disabled:cursor-not-allowed"}`,title:l==="VIEWER"?"Viewers cannot move items":"Move Up",children:"↑"}),c.jsx("button",{onClick:()=>{if(vt(),l==="VIEWER"){alert("Viewers cannot move items. Please change your role to EDITOR or OPERATOR.");return}mo(h.id,"down")},disabled:_===Ur().length-1||l==="VIEWER",className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500 disabled:opacity-30 disabled:cursor-not-allowed"}`,title:l==="VIEWER"?"Viewers cannot move items":"Move Down",children:"↓"}),c.jsx("button",{onClick:()=>{if(vt(),l==="VIEWER"){alert("Viewers cannot delete items. Please change your role to EDITOR or OPERATOR.");return}yi(h.id)},className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${l==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-600 hover:bg-red-500"}`,disabled:l==="VIEWER",title:l==="VIEWER"?"Viewers cannot delete items":"Delete",children:"×"})]})]},`${h.id}-${h.notes?.length||0}-${h.speakers?.length||0}`))]}),c.jsx("div",{id:"main-scroll-container",className:"flex-1 overflow-x-auto",style:{scrollbarWidth:"thin"},children:c.jsxs("div",{className:"min-w-max",children:[c.jsxs("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex",children:[ft.start&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.start},children:[c.jsx("span",{className:"text-white font-bold",children:"Start"}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"start")})]}),ft.programType&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.programType},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Program Type",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"programType")})]}),ft.duration&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.duration},children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-white font-bold flex items-center justify-center gap-1",children:["Duration",l==="VIEWER"&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"text-xs text-slate-400",children:"HH MM SS"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"duration")})]}),ft.segmentName&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.segmentName},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Segment Name",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"segmentName")})]}),ft.shotType&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.shotType},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Shot Type",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"shotType")})]}),ft.pptQA&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.pptQA},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["PPT/Q&A",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"pptQA")})]}),ft.notes&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.notes},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Notes",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"notes")})]}),ft.assets&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.assets},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Assets",l==="VIEWER"&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for VIEWERs",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"assets")})]}),ft.participants&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.participants},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Participants",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"participants")})]}),ft.speakers&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.speakers},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Speakers",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"speakers")})]}),ft.public&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:xt.public},children:[c.jsxs("span",{className:"text-white font-bold flex items-center gap-1",children:["Public",(l==="VIEWER"||l==="OPERATOR")&&c.jsx("span",{className:"text-yellow-400",title:"Read-only for your role",children:"🔒"})]}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Jt(h,"public")})]}),oe.map(h=>li[h.id]!==!1&&c.jsxs("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center relative flex-shrink-0",style:{width:Ws[h.id]||256},children:[c.jsx("span",{className:"text-white font-bold",children:h.name}),c.jsx("button",{onClick:()=>{window.confirm(`Are you sure you want to remove the "${h.name}" column? This will delete all data in this column.`)&&zc(h.id)},className:"absolute top-1 right-1 w-6 h-6 bg-red-600 hover:bg-red-700 text-white rounded-md text-base font-bold flex items-center justify-center transition-colors shadow-md hover:shadow-lg",title:`Remove "${h.name}" column`,children:"×"}),c.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:_=>kl(_,h.id)})]},h.id))]}),Ur().length===0?c.jsxs("div",{className:"h-24 flex items-center justify-center text-slate-500 text-xl",children:["No schedule items for Day ",te,'. Click "Add Schedule Item" to start!']}):Ur().map((h,_)=>c.jsxs("div",{"data-item-id":h.id,className:`border-b-2 border-slate-600 flex ${it[h.id]?"bg-green-950":W===h.id?"bg-blue-950":Oc.has(h.id)?"bg-amber-950 border-amber-600":ni[h.id]||ya.has(h.id)?"bg-gray-900 opacity-40":wa===h.id?"bg-purple-950 border-purple-400":_%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:En(h.notes,h.speakersText,h.speakers,h.customFields,oe)},children:[ft.start&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:xt.start},children:c.jsx("span",{className:"text-white font-mono text-base font-bold",children:h.isIndented?"↘":Ca(_)})}),ft.programType&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:xt.programType},children:c.jsx("select",{value:h.programType,onFocus:()=>{console.log("✏️ Program Type dropdown focused - pausing sync"),hr()},onChange:T=>{if(l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can edit program type. Please change your role to EDITOR.");return}const R=h.programType;ie(G=>G.map(ne=>ne.id===h.id?{...ne,programType:T.target.value}:ne)),U(`programType_${h.id}`,"FIELD_UPDATE",`Updated program type for "${h.segmentName}" from "${R}" to "${T.target.value}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"programType",oldValue:R,newValue:T.target.value,details:{fieldType:"select",optionChange:!0}}),Mr()},disabled:l==="VIEWER"||l==="OPERATOR",className:"w-full px-3 py-2 border-2 rounded text-base transition-colors bg-slate-700 border-slate-500 text-white focus:border-blue-500",style:{backgroundColor:ho[h.programType]||"#374151",color:h.programType==="Sub Cue"?"#000000":"#ffffff",opacity:1},title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can edit program type":"Select program type",children:fo.map(T=>c.jsx("option",{value:T,style:{backgroundColor:ho[T]||"#374151",color:T==="Sub Cue"?"#000000":"#ffffff"},children:T},T))})}),ft.duration&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:xt.duration},children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",min:"0",max:"23",value:h.durationHours,onChange:T=>{if(vt(),l==="VIEWER"){alert("Only EDITORs and OPERATORs can edit duration. Please change your role to EDITOR or OPERATOR.");return}const R=h.durationHours,G=parseInt(T.target.value)||0;ie(ne=>ne.map(ue=>ue.id===h.id?{...ue,durationHours:G}:ue)),U(`durationHours_${h.id}`,"FIELD_UPDATE",`Updated duration hours for "${h.segmentName}" from ${R} to ${G}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"durationHours",oldValue:R,newValue:G,details:{fieldType:"number",timeChange:G-R}})},disabled:l==="VIEWER",className:"w-14 px-2 py-2 border border-slate-600 rounded text-center text-lg font-mono font-bold transition-colors bg-slate-700 text-white",style:{opacity:1},title:l==="VIEWER"?"Only EDITORs and OPERATORs can edit duration":"Edit hours"}),c.jsx("span",{className:"text-slate-400 text-xl font-bold",children:":"}),c.jsx("input",{type:"number",min:"0",max:"59",value:h.durationMinutes,onChange:T=>{if(vt(),l==="VIEWER"){alert("Only EDITORs and OPERATORs can edit duration. Please change your role to EDITOR or OPERATOR.");return}const R=h.durationMinutes,G=parseInt(T.target.value)||0;ie(ne=>ne.map(ue=>ue.id===h.id?{...ue,durationMinutes:G}:ue)),U(`durationMinutes_${h.id}`,"FIELD_UPDATE",`Updated duration minutes for "${h.segmentName}" from ${R} to ${G}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"durationMinutes",oldValue:R,newValue:G,details:{fieldType:"number",timeChange:G-R}})},disabled:l==="VIEWER",className:"w-14 px-2 py-2 border border-slate-600 rounded text-center text-lg font-mono font-bold transition-colors bg-slate-700 text-white",style:{opacity:1},title:l==="VIEWER"?"Only EDITORs and OPERATORs can edit duration":"Edit minutes"}),c.jsx("span",{className:"text-slate-400 text-xl font-bold",children:":"}),c.jsx("input",{type:"number",min:"0",max:"59",value:h.durationSeconds,onChange:T=>{if(vt(),l==="VIEWER"){alert("Only EDITORs and OPERATORs can edit duration. Please change your role to EDITOR or OPERATOR.");return}const R=h.durationSeconds,G=parseInt(T.target.value)||0;ie(ne=>ne.map(ue=>ue.id===h.id?{...ue,durationSeconds:G}:ue)),U(`durationSeconds_${h.id}`,"FIELD_UPDATE",`Updated duration seconds for "${h.segmentName}" from ${R} to ${G}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"durationSeconds",oldValue:R,newValue:G,details:{fieldType:"number",timeChange:G-R}})},disabled:l==="VIEWER",className:"w-14 px-2 py-2 border border-slate-600 rounded text-center text-lg font-mono font-bold transition-colors bg-slate-700 text-white",style:{opacity:1},title:l==="VIEWER"?"Only EDITORs and OPERATORs can edit duration":"Edit seconds"})]})}),ft.segmentName&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:xt.segmentName},children:c.jsx("input",{type:"text",value:h.segmentName,onChange:T=>{if(vt(),l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can edit segment names. Please change your role to EDITOR.");return}const R=h.segmentName;ie(G=>G.map(ne=>ne.id===h.id?{...ne,segmentName:T.target.value}:ne)),U(`segmentName_${h.id}`,"FIELD_UPDATE",`Updated segment name for "${R}" to "${T.target.value}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:T.target.value,fieldName:"segmentName",oldValue:R,newValue:T.target.value,details:{fieldType:"text",characterChange:T.target.value.length-R.length}})},disabled:l==="VIEWER"||l==="OPERATOR",className:"w-full px-3 py-2 border border-slate-600 rounded text-base transition-colors bg-slate-700 text-white",placeholder:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can edit":"Enter segment name",title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can edit segment names":"Edit segment name"})}),ft.shotType&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:xt.shotType},children:c.jsxs("select",{value:h.shotType,onFocus:()=>{console.log("✏️ Shot Type dropdown focused - pausing sync"),hr()},onChange:T=>{if(l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can edit shot type. Please change your role to EDITOR.");return}const R=h.shotType;ie(G=>G.map(ne=>ne.id===h.id?{...ne,shotType:T.target.value}:ne)),U(`shotType_${h.id}`,"FIELD_UPDATE",`Updated shot type for "${h.segmentName}" from "${R}" to "${T.target.value}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"shotType",oldValue:R,newValue:T.target.value,details:{fieldType:"select",optionChange:!0}}),Mr()},disabled:l==="VIEWER"||l==="OPERATOR",className:"w-full px-3 py-2 border border-slate-600 rounded text-base transition-colors bg-slate-700 text-white",style:{opacity:1},title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can edit shot type":"Select shot type",children:[c.jsx("option",{value:"",children:"Select Shot Type"}),$c.map(T=>c.jsx("option",{value:T,children:T},T))]})}),ft.pptQA&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:xt.pptQA},children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("label",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"checkbox",checked:h.hasPPT,onChange:T=>{if(vt(),l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can edit PPT settings. Please change your role to EDITOR.");return}const R=h.hasPPT;ie(G=>G.map(ne=>ne.id===h.id?{...ne,hasPPT:T.target.checked}:ne)),U(`hasPPT_${h.id}`,"FIELD_UPDATE",`Updated PPT status for "${h.segmentName}" from ${R?"TRUE":"FALSE"} to ${T.target.checked?"TRUE":"FALSE"}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"hasPPT",oldValue:R?"TRUE":"FALSE",newValue:T.target.checked?"TRUE":"FALSE",details:{fieldType:"checkbox",booleanChange:!0}})},className:`w-6 h-6 rounded border-2 transition-colors ${l==="VIEWER"||l==="OPERATOR"?"border-slate-400 bg-slate-700 cursor-not-allowed":"border-slate-400 bg-slate-700 hover:border-blue-400 focus:ring-2 focus:ring-blue-500"}`,style:{opacity:1,filter:"none",WebkitFilter:"none"},title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can edit PPT settings":"Toggle PPT"}),c.jsx("span",{className:"text-base font-medium text-white",children:"PPT"})]}),c.jsxs("label",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"checkbox",checked:h.hasQA,onChange:T=>{if(vt(),l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can edit Q&A settings. Please change your role to EDITOR.");return}const R=h.hasQA;ie(G=>G.map(ne=>ne.id===h.id?{...ne,hasQA:T.target.checked}:ne)),U(`hasQA_${h.id}`,"FIELD_UPDATE",`Updated Q&A status for "${h.segmentName}" from ${R?"TRUE":"FALSE"} to ${T.target.checked?"TRUE":"FALSE"}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"hasQA",oldValue:R?"TRUE":"FALSE",newValue:T.target.checked?"TRUE":"FALSE",details:{fieldType:"checkbox",booleanChange:!0}})},className:`w-6 h-6 rounded border-2 transition-colors ${l==="VIEWER"||l==="OPERATOR"?"border-slate-400 bg-slate-700 cursor-not-allowed":"border-slate-400 bg-slate-700 hover:border-blue-400 focus:ring-2 focus:ring-blue-500"}`,style:{opacity:1,filter:"none",WebkitFilter:"none"},title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can edit Q&A settings":"Toggle Q&A"}),c.jsx("span",{className:"text-base font-medium text-white",children:"Q&A"})]})]})}),ft.notes&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:xt.notes,height:En(h.notes,h.speakersText,h.speakers,h.customFields,oe)},children:c.jsx("div",{onClick:()=>{if(l==="VIEWER"||l==="OPERATOR"){if(l==="OPERATOR"&&h.notes){alert(`Notes (View Only):

${h.notes.replace(/<[^>]*>/g,"")}`);return}alert("Only EDITORs can edit notes. Please change your role to EDITOR.");return}hr(),at(h.id),Oe(!0)},className:"w-full px-3 py-2 border border-slate-600 rounded text-white text-base transition-colors flex items-start justify-center bg-slate-700 cursor-pointer hover:bg-slate-600",style:{height:Fc(h.notes),minHeight:Fc(h.notes),wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden",paddingBottom:"1rem"},title:l==="VIEWER"?"Viewers cannot edit notes":l==="OPERATOR"?"Click to view notes (read-only)":"Click to edit notes",children:h.notes?c.jsx("div",{className:"text-left w-full",dangerouslySetInnerHTML:{__html:h.notes}}):c.jsx("span",{className:"text-slate-400",children:"Click to edit notes..."})})}),ft.assets&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:xt.assets},children:c.jsx("div",{onClick:()=>{if(l==="VIEWER"||l==="OPERATOR"){if(l==="OPERATOR"&&h.assets){Dr(h.id),ct(!0);return}alert("Only EDITORs can edit assets. Please change your role to EDITOR.");return}hr(),qt(h.id),Ht(!0)},className:"w-full px-3 py-2 border border-slate-600 rounded text-white text-base transition-colors flex items-center justify-center bg-slate-700 cursor-pointer hover:bg-slate-600",title:l==="VIEWER"?"Viewers cannot edit assets":l==="OPERATOR"?"Click to view assets (read-only)":"Click to edit assets",children:h.assets?c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"text-sm font-medium",children:[h.assets.split("||").length," Asset",h.assets.split("||").length!==1?"s":""]})}):c.jsx("span",{className:"text-slate-400",children:"Click to add assets..."})})}),ft.participants&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-start justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:xt.participants,height:En(h.notes,h.speakersText,h.speakers,h.customFields,oe)},children:c.jsx("div",{onClick:()=>{if(l==="VIEWER"||l==="OPERATOR"){if(l==="OPERATOR"&&h.speakers){alert(`Participants (View Only):

${yl(h.speakers)}`);return}alert("Only EDITORs can edit participants. Please change your role to EDITOR.");return}ws(h.id),on(!0)},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-base cursor-pointer hover:bg-slate-600",style:{height:`calc(${En(h.notes,h.speakersText,h.speakers,h.customFields,oe)} - 2rem)`,maxHeight:`calc(${En(h.notes,h.speakersText,h.speakers,h.customFields,oe)} - 2rem)`,overflow:"hidden",lineHeight:"1.6",wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"pre-wrap"},title:l==="VIEWER"?"Viewers cannot edit participants":l==="OPERATOR"?"Click to view participants (read-only)":"Click to edit participants",children:yl(h.speakers||"")||"Click to add participants..."})}),ft.speakers&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:xt.speakers,height:En(h.notes,h.speakersText,h.speakers,h.customFields,oe)},children:c.jsx("div",{onClick:()=>{if(l==="VIEWER"||l==="OPERATOR"){if(l==="OPERATOR"&&h.speakersText){alert(`Speakers (View Only):

${Ns(h.speakersText)}`);return}alert("Only EDITORs can edit speakers. Please change your role to EDITOR.");return}hr(),Vt(h.id),wt(!0)},className:"w-full px-3 py-2 border border-slate-600 rounded text-white text-base transition-colors flex items-start justify-start bg-slate-700 cursor-pointer hover:bg-slate-600",style:{height:vl(h.speakersText),minHeight:vl(h.speakersText),wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden",paddingBottom:"1rem",lineHeight:"1.6",whiteSpace:"pre-wrap"},title:l==="VIEWER"?"Viewers cannot edit speakers":l==="OPERATOR"?"Click to view speakers (read-only)":"Click to edit speakers",children:c.jsx("div",{className:"text-left w-full",children:Ns(h.speakersText||"")||"Click to add speakers..."})})}),ft.public&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:xt.public},children:c.jsx("input",{type:"checkbox",checked:h.isPublic||!1,onChange:T=>{if(l==="VIEWER"||l==="OPERATOR"){alert("Only EDITORs can change public status. Please change your role to EDITOR.");return}const R=h.isPublic;ie(G=>G.map(ne=>ne.id===h.id?{...ne,isPublic:T.target.checked}:ne)),O("FIELD_UPDATE",`Updated Public status for "${h.segmentName}" from ${R} to ${T.target.checked}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"isPublic",oldValue:R,newValue:T.target.checked,details:{fieldType:"checkbox",booleanChange:!0}})},className:`w-5 h-5 rounded border-2 focus:ring-2 transition-colors ${l==="VIEWER"||l==="OPERATOR"?"border-slate-500 bg-slate-700 text-blue-600 cursor-not-allowed":"border-slate-500 bg-slate-700 text-blue-600 focus:ring-blue-500"}`,style:{opacity:1,filter:"none",WebkitFilter:"none"},title:l==="VIEWER"||l==="OPERATOR"?"Only EDITORs can change public status":"Toggle public visibility"})}),oe.map(T=>li[T.id]!==!1&&c.jsx("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:Ws[T.id]||256,height:En(h.notes,h.speakersText,h.speakers,h.customFields,oe)},children:c.jsx("textarea",{value:h.customFields[T.name]||"",onFocus:()=>{console.log("✏️ Custom column focused - pausing sync"),vt()},onChange:R=>{vt();const G=h.customFields[T.name]||"";ie(ne=>ne.map(ue=>ue.id===h.id?{...ue,customFields:{...ue.customFields,[T.name]:R.target.value}}:ue)),U(`custom_${T.name}_${h.id}`,"FIELD_UPDATE",`Updated custom field "${T.name}" for "${h.segmentName}" from "${G}" to "${R.target.value}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:`custom_${T.name}`,oldValue:G,newValue:R.target.value,details:{fieldType:"custom_field",columnName:T.name,characterChange:R.target.value.length-G.length}})},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-base resize-none",style:{height:`calc(${En(h.notes,h.speakersText,h.speakers,h.customFields,oe)} - 2rem)`,maxHeight:`calc(${En(h.notes,h.speakersText,h.speakers,h.customFields,oe)} - 2rem)`,overflow:"hidden",lineHeight:"1.6",wordWrap:"break-word",overflowWrap:"break-word"},rows:Math.max(2,(h.customFields[T.name]||"").split(`
`).length),placeholder:`${T.name}...`})},T.id))]},`${h.id}-${h.notes?.length||0}-${h.speakers?.length||0}`))]})}),c.jsxs("div",{className:"w-32 flex-shrink-0 bg-slate-900",style:{borderLeft:"6px solid #475569"},children:[c.jsx("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:c.jsxs("span",{className:"text-white font-bold text-base flex items-center gap-1",children:["Timer",(l==="VIEWER"||l==="EDITOR")&&c.jsx("span",{className:"text-yellow-400",title:"Only OPERATORs can control timers",children:"🔒"})]})}),Ur().length===0?c.jsx("div",{className:"h-24 flex items-center justify-center text-slate-500",children:"-"}):Ur().map((h,_)=>c.jsx("div",{className:`border-b-2 border-slate-600 flex flex-col items-center justify-center gap-1 ${_%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:En(h.notes,h.speakersText,h.speakers,h.customFields,oe)},children:c.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-1",children:[c.jsx("div",{className:"text-sm font-mono text-slate-300",children:h.timerId||"TIMER"}),c.jsx("div",{className:"flex flex-col gap-1",children:h.isIndented?c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can start secondary timers. Please change your role to OPERATOR.");return}Hd(h.id)},disabled:zt?.itemId===h.id||l==="VIEWER"||l==="EDITOR"||!Ta(h.id),className:`px-3 py-1 rounded text-sm font-bold transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":Ta(h.id)?zt?.itemId===h.id?"bg-orange-600 text-white cursor-default":"bg-orange-500 hover:bg-orange-400 text-white":"bg-gray-500 text-gray-300 cursor-not-allowed"}`,title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can start secondary timers":Ta(h.id)?"Start secondary timer":"Start the CUE above first before starting secondary timer",children:zt?.itemId===h.id?"PLAYING":"PLAY"}),c.jsx("button",{onClick:()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can stop secondary timers. Please change your role to OPERATOR.");return}Na()},disabled:zt?.itemId!==h.id||l==="VIEWER"||l==="EDITOR"||!Ta(h.id),className:`px-3 py-1 rounded text-sm font-bold transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":Ta(h.id)?zt?.itemId===h.id?"bg-red-600 hover:bg-red-500 text-white":"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-gray-500 text-gray-300 cursor-not-allowed"}`,title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can stop secondary timers":"Stop secondary timer",children:"STOP"})]}):c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:async()=>{if(l==="VIEWER"){alert("Viewers cannot load cues. Please change your role to EDITOR or OPERATOR.");return}if(console.log("🔄🔄🔄 Button clicked, currentUserRole:",l),console.log("🔄🔄🔄 Button clicked, item.id:",h.id),l==="EDITOR"){alert("Editors cannot load cues. Please change your role to OPERATOR.");return}console.log("🔄🔄🔄 Button clicked, calling loadCue with item.id:",h.id),await Vc(h.id)},disabled:W===h.id||l==="VIEWER"||l==="EDITOR",className:`px-3 py-1 rounded text-sm font-bold transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":W===h.id?"bg-blue-600 text-white cursor-default":"bg-slate-600 hover:bg-slate-500 text-white"}`,title:l==="VIEWER"?"Viewers cannot load cues":l==="EDITOR"?"Editors cannot load cues":"Load this cue",children:W===h.id?"LOADED":"LOAD"}),c.jsx("button",{onClick:async()=>{if(l==="VIEWER"||l==="EDITOR"){alert("Only OPERATORs can start/stop timers. Please change your role to OPERATOR.");return}await Ys(h.id)},disabled:W!==h.id||(it[h.id]?!1:Object.keys(it).length>0)||l==="VIEWER"||l==="EDITOR",className:`px-3 py-1 rounded text-sm font-bold transition-colors ${l==="VIEWER"||l==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":it[h.id]?"bg-red-600 hover:bg-red-500 text-white":W===h.id&&Object.keys(it).length===0?"bg-green-600 hover:bg-green-500 text-white":"bg-slate-600 text-slate-400 cursor-not-allowed"}`,title:l==="VIEWER"||l==="EDITOR"?"Only OPERATORs can start/stop timers":it[h.id]?"Stop timer":"Start timer",children:it[h.id]?"STOP":"START"})]})})]})},`${h.id}-${h.notes?.length||0}-${h.speakers?.length||0}`))]})]})]})}),J&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg max-w-lg w-full max-h-[90vh] flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-600",children:[c.jsx("h2",{className:"text-lg font-bold text-white",children:"Add Schedule Item"}),c.jsxs("label",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:Pt.isPublic,onChange:h=>wr(_=>({..._,isPublic:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-slate-300 text-sm",children:"Public"})]})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Cue"}),c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex items-center px-2 py-2 bg-slate-600 border border-slate-600 border-r-0 rounded-l text-white text-sm font-medium min-w-[40px]",children:"CUE"}),c.jsx("input",{type:"text",value:Pt.cue,onChange:h=>{vt(),wr(_=>({..._,cue:h.target.value}))},className:"flex-1 px-3 py-2 bg-slate-700 border border-slate-600 rounded-r text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm",placeholder:"1, 1.1, 1A, etc."})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Program Type"}),c.jsx("select",{value:Pt.programType,onFocus:()=>{console.log("✏️ Program Type modal dropdown focused - pausing sync"),hr()},onChange:h=>{wr(_=>({..._,programType:h.target.value})),Mr()},className:"w-full px-3 py-2 bg-slate-700 border-2 border-slate-500 rounded text-white focus:outline-none focus:border-blue-500 text-sm",style:{backgroundColor:ho[Pt.programType]||"#374151",color:Pt.programType==="Sub Cue"?"#000000":"#ffffff"},children:fo.map(h=>c.jsx("option",{value:h,style:{backgroundColor:ho[h]||"#374151",color:h==="Sub Cue"?"#000000":"#ffffff"},children:h},h))})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Segment Name"}),c.jsx("input",{type:"text",value:Pt.segmentName,onChange:h=>{vt(),wr(_=>({..._,segmentName:h.target.value}))},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm",placeholder:"Enter segment name"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Shot Type"}),c.jsxs("select",{value:Pt.shotType,onFocus:()=>{console.log("✏️ Shot Type modal dropdown focused - pausing sync"),hr()},onChange:h=>{wr(_=>({..._,shotType:h.target.value})),Mr()},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm",children:[c.jsx("option",{value:"",children:"Select Shot Type"}),$c.map(h=>c.jsx("option",{value:h,children:h},h))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Duration"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("input",{type:"number",value:Pt.durationHours,onChange:h=>{vt(),wr(_=>({..._,durationHours:parseInt(h.target.value)||0}))},className:"w-12 px-2 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm text-center",min:"0",placeholder:"H"}),c.jsx("span",{className:"text-slate-400 self-center text-sm",children:":"}),c.jsx("input",{type:"number",value:Pt.durationMinutes,onChange:h=>{vt(),wr(_=>({..._,durationMinutes:parseInt(h.target.value)||0}))},className:"w-12 px-2 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm text-center",min:"0",max:"59",placeholder:"M"}),c.jsx("span",{className:"text-slate-400 self-center text-sm",children:":"}),c.jsx("input",{type:"number",value:Pt.durationSeconds,onChange:h=>{vt(),wr(_=>({..._,durationSeconds:parseInt(h.target.value)||0}))},className:"w-12 px-2 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm text-center",min:"0",max:"59",placeholder:"S"})]})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("label",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:Pt.hasPPT,onChange:h=>{vt(),wr(_=>({..._,hasPPT:h.target.checked}))},className:"rounded"}),c.jsx("span",{className:"text-slate-300 text-sm",children:"Has PPT"})]}),c.jsxs("label",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:Pt.hasQA,onChange:h=>{vt(),wr(_=>({..._,hasQA:h.target.checked}))},className:"rounded"}),c.jsx("span",{className:"text-slate-300 text-sm",children:"Has QA"})]})]})]}),c.jsxs("div",{className:"mt-3",children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Notes"}),c.jsx("div",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm cursor-pointer hover:bg-slate-600 transition-colors min-h-[60px] flex items-center",onClick:()=>{hr(),at(-1),Oe(!0)},children:Pt.notes?c.jsx("div",{className:"text-sm",dangerouslySetInnerHTML:{__html:Pt.notes}}):c.jsx("span",{className:"text-slate-400",children:"Click to edit notes with rich formatting..."})})]}),c.jsxs("div",{className:"mt-3",children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Assets"}),c.jsx("div",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm cursor-pointer hover:bg-slate-600 transition-colors min-h-[60px] flex items-center",onClick:()=>{hr(),qt(-1),Ht(!0)},children:Pt.assets?c.jsx("div",{className:"text-sm",dangerouslySetInnerHTML:{__html:Pt.assets.replace(/\|\|/g,"<br>")}}):c.jsx("span",{className:"text-slate-400",children:"Click to edit assets with advanced management..."})})]}),c.jsxs("div",{className:"mt-3",children:[c.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Speakers"}),c.jsx("div",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm cursor-pointer hover:bg-slate-600 transition-colors min-h-[60px] flex items-start justify-start",onClick:()=>{hr(),Vt(-1),wt(!0)},style:{wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.6",whiteSpace:"pre-wrap"},children:Pt.speakersText?c.jsx("div",{className:"text-sm text-left w-full",children:Ns(Pt.speakersText)}):c.jsx("span",{className:"text-slate-400",children:"Click to add speakers..."})})]})]}),c.jsx("div",{className:"p-4 border-t border-slate-600",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>vi(Pt),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded transition-colors text-sm",children:"Add Item"}),c.jsx("button",{onClick:()=>{he(!1),Mr()},className:"flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors text-sm",children:"Cancel"})]})})]})}),Xe&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-8 max-w-md w-full",children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Add Custom Column"}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-slate-300 font-semibold mb-2",children:"Column Name"}),c.jsx("input",{type:"text",placeholder:"Enter column name",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",onFocus:()=>{console.log("✏️ Custom column input focused - pausing sync"),vt()},onKeyPress:h=>{if(h.key==="Enter"){const _=h.target;_.value.trim()&&(El(_.value.trim()),_.value="")}}})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>{const h=document.querySelector('input[placeholder="Enter column name"]');h?.value.trim()&&(El(h.value.trim()),h.value="")},className:"flex-1 px-4 py-3 bg-purple-600 hover:bg-purple-500 text-white font-semibold rounded-lg transition-colors",children:"Add Column"}),c.jsx("button",{onClick:()=>{we(!1),Mr()},className:"flex-1 px-4 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})]})}),Fe&&Ae!==null&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-5xl w-full max-h-[90vh] flex flex-col",children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Edit Notes"}),c.jsxs("div",{className:"mb-4 bg-slate-700 rounded-lg overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 border-b border-slate-600",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-semibold",children:"Format:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>$t("undo"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Undo",children:"↶"}),c.jsx("button",{onClick:()=>$t("redo"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Redo",children:"↷"}),c.jsx("div",{className:"w-px h-6 bg-slate-500 mx-1"}),c.jsx("button",{onClick:()=>$t("bold"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded font-bold flex items-center justify-center",title:"Bold",children:"B"}),c.jsx("button",{onClick:()=>$t("italic"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded italic flex items-center justify-center",title:"Italic",children:"I"}),c.jsx("button",{onClick:()=>$t("underline"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded underline flex items-center justify-center",title:"Underline",children:"U"})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-semibold",children:"Size:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>$t("fontSize","1"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Small",children:"S"}),c.jsx("button",{onClick:()=>$t("fontSize","3"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded flex items-center justify-center",title:"Normal",children:"N"}),c.jsx("button",{onClick:()=>$t("fontSize","5"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-base rounded flex items-center justify-center",title:"Large",children:"L"}),c.jsx("button",{onClick:()=>$t("fontSize","7"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-lg rounded flex items-center justify-center",title:"X-Large",children:"XL"})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-semibold",children:"Align:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>$t("left"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Left Align",children:"≡"}),c.jsx("button",{onClick:()=>$t("center"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Center Align",children:"≣"}),c.jsx("button",{onClick:()=>$t("right"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Right Align",children:"≡"})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-semibold",children:"Lists:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>$t("bullet"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded flex items-center justify-center",title:"Bullet List",children:"•"}),c.jsx("button",{onClick:()=>$t("list"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded flex items-center justify-center",title:"Numbered List",children:"1."})]})]})]}),c.jsxs("div",{className:"flex items-center justify-center gap-6 p-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-semibold",children:"Text Color:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>$t("color","#ffffff"),className:"w-6 h-6 bg-white border border-slate-400 rounded",title:"White"}),c.jsx("button",{onClick:()=>$t("color","#ef4444"),className:"w-6 h-6 bg-red-500 rounded",title:"Red"}),c.jsx("button",{onClick:()=>$t("color","#3b82f6"),className:"w-6 h-6 bg-blue-500 rounded",title:"Blue"}),c.jsx("button",{onClick:()=>$t("color","#22c55e"),className:"w-6 h-6 bg-green-500 rounded",title:"Green"}),c.jsx("button",{onClick:()=>$t("color","#f97316"),className:"w-6 h-6 bg-orange-500 rounded",title:"Orange"}),c.jsx("button",{onClick:()=>$t("color","#a855f7"),className:"w-6 h-6 bg-purple-500 rounded",title:"Purple"}),c.jsx("button",{onClick:()=>$t("color","#000000"),className:"w-6 h-6 bg-black border border-slate-400 rounded",title:"Black"})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-white text-sm font-semibold",children:"Highlight:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>$t("highlight","transparent"),className:"w-6 h-6 bg-slate-600 border border-slate-400 rounded flex items-center justify-center text-white text-xs",title:"No Highlight",children:"×"}),c.jsx("button",{onClick:()=>$t("highlight","#fbbf24"),className:"w-6 h-6 bg-yellow-400 rounded",title:"Yellow"}),c.jsx("button",{onClick:()=>$t("highlight","#60a5fa"),className:"w-6 h-6 bg-blue-400 rounded",title:"Light Blue"}),c.jsx("button",{onClick:()=>$t("highlight","#4ade80"),className:"w-6 h-6 bg-green-400 rounded",title:"Light Green"}),c.jsx("button",{onClick:()=>$t("highlight","#f472b6"),className:"w-6 h-6 bg-pink-400 rounded",title:"Pink"}),c.jsx("button",{onClick:()=>$t("highlight","#fb923c"),className:"w-6 h-6 bg-orange-400 rounded",title:"Orange"})]})]})]})]}),c.jsxs("div",{className:"flex-1 min-h-[400px] mb-6",children:[c.jsx("label",{className:"block text-white text-sm mb-2",children:"Notes:"}),c.jsx("div",{id:"notes-editor",contentEditable:!0,className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white text-base focus:outline-none focus:border-blue-500 overflow-auto",style:{height:"400px",lineHeight:"1.5",fontFamily:"system-ui, -apple-system, sans-serif"},"data-placeholder":"Start typing your notes here...",onInput:h=>{}})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:Id,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"}),c.jsx("button",{onClick:()=>{Oe(!1),at(null),Mr()},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})]})}),St&&Et!==null&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-5xl w-full max-h-[90vh] flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-700",children:[c.jsxs("h2",{className:"text-xl font-bold text-white",children:["Edit Speakers (",kt.length,"/7)"]}),c.jsx("button",{onClick:()=>{wt(!1),Vt(null),Mr()},className:"text-slate-400 hover:text-white text-xl",children:"✕"})]}),c.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[c.jsx("div",{className:"mb-6",children:c.jsxs("button",{onClick:Dd,disabled:kt.length>=7,className:"px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors",children:["+ Add Speaker ",kt.length<7&&`(${7-kt.length} slots remaining)`]})}),c.jsxs("div",{className:"space-y-4 mb-6",children:[kt.sort((h,_)=>h.slot-_.slot).map(h=>c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Speaker ",h.slot]}),c.jsx("button",{onClick:()=>Lc(h.id),className:"w-8 h-8 bg-red-600 hover:bg-red-500 text-white rounded flex items-center justify-center transition-colors",title:"Remove Speaker",children:"✕"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Slot Number"}),c.jsx("select",{value:h.slot,onChange:_=>Mc(h.id,parseInt(_.target.value)),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[1,2,3,4,5,6,7].map(_=>{const T=kt.some(R=>R.id!==h.id&&R.slot===_);return c.jsxs("option",{value:_,className:T?"bg-yellow-600 text-white":"bg-slate-600 text-white",children:[_," ",T?"(Used)":""]},_)})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Location"}),c.jsxs("select",{value:h.location,onChange:_=>Ts(h.id,"location",_.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[c.jsx("option",{value:"Podium",children:"Podium"}),c.jsx("option",{value:"Seat",children:"Seat"}),c.jsx("option",{value:"Moderator",children:"Moderator"}),c.jsx("option",{value:"Virtual",children:"Virtual"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Full Name"}),c.jsx("input",{type:"text",value:h.fullName,onChange:_=>Ts(h.id,"fullName",_.target.value),placeholder:"Enter full name",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Title"}),c.jsx("input",{type:"text",value:h.title,onChange:_=>Ts(h.id,"title",_.target.value),placeholder:"Enter title",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Organization"}),c.jsx("input",{type:"text",value:h.org,onChange:_=>Ts(h.id,"org",_.target.value),placeholder:"Enter organization",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Photo Link"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"url",value:h.photoLink,onChange:_=>Ts(h.id,"photoLink",_.target.value),placeholder:"Enter photo URL",className:"flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"}),h.photoLink&&c.jsx("div",{className:"flex-shrink-0",children:c.jsx("img",{src:h.photoLink,alt:h.fullName,className:"w-12 h-12 rounded object-cover border-2 border-slate-500 -mt-2.5",onError:_=>{_.currentTarget.style.display="none"}})})]})]})]})]},h.id)),kt.length===0&&c.jsx("div",{className:"text-center py-8 text-slate-400",children:'No speakers added yet. Click "Add Speaker" to get started.'})]})]}),c.jsx("div",{className:"border-t border-slate-700 p-6",children:c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:Od,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"}),c.jsx("button",{onClick:()=>{wt(!1),Vt(null),Mr()},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})})]})}),At&&Zt!==null&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Edit Assets"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-white",children:"Assets List"}),c.jsx("button",{onClick:Dc,className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:"+ Add Asset"})]}),c.jsx("div",{id:"assets-list",className:"space-y-3"})]}),c.jsxs("div",{className:"flex gap-3 mt-6",children:[c.jsx("button",{onClick:jd,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"}),c.jsx("button",{onClick:()=>{Ht(!1),qt(null),Mr()},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})]})}),an&&Lt!==null&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Assets List"}),c.jsx("button",{onClick:()=>{ct(!1),Dr(null)},className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:"Close"})]}),c.jsx("div",{className:"space-y-4",children:(()=>{const h=I.find(T=>T.id===Lt);if(!h||!h.assets)return c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-slate-400 text-lg",children:"No assets available for this item."})});let _=[];if(h.assets.includes("||"))_=h.assets.split("||").filter(R=>R.trim()).map(R=>{if(R.includes("|")){const[G,ne]=R.split("|").map(ue=>ue.trim());return{name:G||"Unnamed Asset",url:ne||""}}else return{name:R.trim(),url:""}});else if(h.assets.includes("|")){const[T,R]=h.assets.split("|").map(G=>G.trim());_=[{name:T||"Unnamed Asset",url:R||""}]}else try{const T=JSON.parse(h.assets);Array.isArray(T)?_=T.map(R=>({name:R.name||"Unnamed Asset",url:R.link||R.url||""})):_=[{name:T.name||"Unnamed Asset",url:T.link||T.url||""}]}catch{_=[{name:h.assets.trim(),url:""}]}return _.length===0?c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-slate-400 text-lg",children:"No assets available for this item."})}):c.jsx("div",{className:"space-y-4",children:c.jsx("div",{className:"max-h-96 overflow-y-auto space-y-3 pr-2",children:_.map((T,R)=>c.jsx("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"text-white font-semibold text-lg",children:T.name}),T.url&&c.jsx("div",{children:c.jsx("a",{href:T.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline break-all text-sm",children:T.url})})]})},R))})})})()})]})}),Wt&&Fn!==null&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-5xl w-full max-h-[90vh] flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-700",children:[c.jsxs("h2",{className:"text-xl font-bold text-white",children:["Edit Participants (",vr.length,"/7)"]}),c.jsx("button",{onClick:()=>{on(!1),ws(null)},className:"text-slate-400 hover:text-white text-xl",children:"✕"})]}),c.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[c.jsx("div",{className:"mb-6",children:c.jsxs("button",{onClick:Pc,disabled:vr.length>=7,className:"px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors",children:["+ Add Speaker ",vr.length<7&&`(${7-vr.length} slots remaining)`]})}),c.jsxs("div",{className:"space-y-4",children:[vr.sort((h,_)=>h.slot-_.slot).map(h=>c.jsxs("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Speaker ",h.slot]}),c.jsx("button",{onClick:()=>Fd(h.id),className:"w-8 h-8 bg-red-600 hover:bg-red-500 text-white rounded flex items-center justify-center transition-colors",title:"Remove Speaker",children:"✕"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Slot Number"}),c.jsx("select",{value:h.slot,onChange:_=>Uc(h.id,parseInt(_.target.value)),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[1,2,3,4,5,6,7].map(_=>{const T=vr.some(R=>R.id!==h.id&&R.slot===_);return c.jsxs("option",{value:_,className:T?"bg-yellow-600 text-white":"bg-slate-600 text-white",children:[_," ",T?"(Used)":""]},_)})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Location"}),c.jsxs("select",{value:h.location,onChange:_=>ks(h.id,"location",_.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[c.jsx("option",{value:"Podium",children:"Podium"}),c.jsx("option",{value:"Seat",children:"Seat"}),c.jsx("option",{value:"Moderator",children:"Moderator"}),c.jsx("option",{value:"Virtual",children:"Virtual"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Full Name"}),c.jsx("input",{type:"text",value:h.fullName,onChange:_=>ks(h.id,"fullName",_.target.value),placeholder:"Enter full name",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Title"}),c.jsx("input",{type:"text",value:h.title,onChange:_=>ks(h.id,"title",_.target.value),placeholder:"Enter title/position",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Organization"}),c.jsx("input",{type:"text",value:h.org,onChange:_=>ks(h.id,"org",_.target.value),placeholder:"Enter organization",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Speaker Photo Link"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"url",value:h.photoLink,onChange:_=>ks(h.id,"photoLink",_.target.value),placeholder:"Enter photo URL",className:"flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"}),h.photoLink&&c.jsx("div",{className:"flex-shrink-0",children:c.jsx("img",{src:h.photoLink,alt:h.fullName,className:"w-12 h-12 rounded object-cover border-2 border-slate-500 -mt-2.5",onError:_=>{_.target.style.display="none"}})})]})]})]})]},h.id)),vr.length===0&&c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-slate-400 text-lg mb-4",children:"No speakers added yet"}),c.jsx("button",{onClick:Pc,className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Add Your First Speaker"})]})]})]}),c.jsx("div",{className:"border-t border-slate-700 p-6",children:c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:gi,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"}),c.jsx("button",{onClick:()=>{on(!1),ws(null)},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"})]})})]})}),Mt&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 max-w-md w-full",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:"Send Message to Full Screen Timer"}),c.jsx("button",{onClick:()=>Dt(!1),className:"text-slate-400 hover:text-white transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Quick Presets"}),c.jsx("div",{className:"grid grid-cols-2 gap-2",children:["Break in 5 minutes","Technical difficulties","Starting soon","Please wait","Break time","Resuming shortly","Stall / Stretch Time","Wrap Up Please"].map(h=>c.jsx("button",{onClick:()=>Gn(h),className:"px-3 py-2 bg-slate-700 hover:bg-slate-600 border border-slate-600 rounded text-white text-sm transition-colors text-left",children:h},h))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Custom Message"}),c.jsx("textarea",{value:Ut,onChange:h=>Gn(h.target.value),placeholder:"Enter custom message to display on full screen timer...",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm h-24 resize-none"})]}),Ut&&c.jsx("div",{className:"p-3 bg-slate-700 rounded-lg",children:c.jsxs("div",{className:"text-slate-300 text-sm",children:[c.jsx("strong",{children:"Message Preview:"})," ",Ut]})})]}),c.jsxs("div",{className:"flex gap-3 mt-6",children:[c.jsx("button",{onClick:async()=>{if(!(!Ut.trim()||!e?.id))try{const _=(await Ge.getTimerMessagesForEvent(e.id)).filter(G=>G.enabled);for(const G of _)await Ge.disableTimerMessage(G.id),console.log("✅ Disabled existing message:",G.id);const T={event_id:e.id,message:Ut.trim(),enabled:!0,sent_by:s?.id,sent_by_name:s?.user_metadata?.full_name||s?.email||"Unknown User",sent_by_role:l||"VIEWER",message_type:"general",priority:2},R=await Ge.saveTimerMessage(T);if(!R){console.error("❌ Failed to save message to Supabase"),alert("Failed to save message. Please try again.");return}console.log("✅ New message created in Supabase:",R),Dn(!0),De&&!De.closed&&De.postMessage({type:"MESSAGE_UPDATE",message:Ut,enabled:!0},"*"),Gn(""),Dt(!1)}catch(h){console.error("❌ Error saving message:",h),alert("Error saving message. Please try again.")}},className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded transition-colors",disabled:!Ut.trim()||!e?.id,children:"Send & Activate Message"}),c.jsx("button",{onClick:()=>Dt(!1),className:"flex-1 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors",children:"Cancel"})]})]})}),dr&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg max-w-md w-full max-h-[80vh] flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-600",children:[c.jsx("h2",{className:"text-lg font-bold text-white",children:"Filter Columns"}),c.jsx("button",{onClick:()=>Bs(!1),className:"text-slate-400 hover:text-white text-xl",children:"×"})]}),c.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:c.jsxs("div",{className:"space-y-3",children:[c.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Select which columns to display in the schedule:"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:ft.start,onChange:h=>Kr(_=>({..._,start:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Start Time"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:ft.programType,onChange:h=>Kr(_=>({..._,programType:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Program Type"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:ft.duration,onChange:h=>Kr(_=>({..._,duration:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Duration"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:ft.segmentName,onChange:h=>Kr(_=>({..._,segmentName:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Segment Name"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:ft.shotType,onChange:h=>Kr(_=>({..._,shotType:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Shot Type"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:ft.pptQA,onChange:h=>Kr(_=>({..._,pptQA:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"PPT/Q&A"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:ft.notes,onChange:h=>Kr(_=>({..._,notes:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Notes"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:ft.assets,onChange:h=>Kr(_=>({..._,assets:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Assets"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:ft.speakers,onChange:h=>Kr(_=>({..._,speakers:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Speakers"})]}),c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:ft.public,onChange:h=>Kr(_=>({..._,public:h.target.checked})),className:"rounded"}),c.jsx("span",{className:"text-white",children:"Public"})]}),oe.map((h,_)=>c.jsxs("label",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"checkbox",checked:li[h.id]!==!1,onChange:T=>no(R=>({...R,[h.id]:T.target.checked})),className:"rounded"}),c.jsxs("span",{className:"text-white",children:[h.name,c.jsx("span",{className:"text-slate-400 text-xs ml-2",children:"(Custom)"})]})]},h.id))]})]})}),c.jsx("div",{className:"p-4 border-t border-slate-600",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>{Kr({start:!0,programType:!0,duration:!0,segmentName:!0,shotType:!0,pptQA:!0,notes:!0,assets:!0,participants:!1,speakers:!0,public:!0,custom:!0});const h={};oe.forEach(_=>{h[_.id]=!0}),no(h)},className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors text-sm",children:"Show All"}),c.jsx("button",{onClick:()=>{Kr({start:!1,programType:!1,duration:!1,segmentName:!1,shotType:!1,pptQA:!1,notes:!1,assets:!1,participants:!1,speakers:!1,public:!1,custom:!1});const h={};oe.forEach(_=>{h[_.id]=!1}),no(h)},className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors text-sm",children:"Hide All"}),c.jsx("button",{onClick:()=>Bs(!1),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded transition-colors text-sm",children:"Apply Filters"})]})})]})}),zs&&c.jsx("div",{className:"fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50",children:c.jsxs("div",{className:`px-6 py-4 rounded-lg shadow-lg border-2 flex items-center gap-3 ${un==="early"?"bg-yellow-600 border-yellow-500 text-yellow-100":un==="late"?"bg-red-600 border-red-500 text-red-100":"bg-green-600 border-green-500 text-green-100"}`,children:[c.jsx("div",{className:"text-3xl flex-shrink-0",children:un==="early"?"⏰":un==="late"?"⚠️":"✅"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"font-bold text-lg mb-1",children:un==="early"?"EARLY":un==="late"?"RUNNING LATE":"ON TIME"}),c.jsxs("div",{className:"text-base font-medium",children:[c.jsx("span",{className:"text-2xl font-bold",children:so>=60?`${Math.floor(so/60)}h ${so%60}m`:`${so}m`}),un==="early"?` before ${Object.keys(it).length>0&&I.find(h=>h.id===parseInt(Object.keys(it)[0]))?.customFields.cue||"CUE"} start`:un==="late"?` after ${Object.keys(it).length>0&&I.find(h=>h.id===parseInt(Object.keys(it)[0]))?.customFields.cue||"CUE"} start`:" - Timing is on track"]})]}),c.jsx("button",{onClick:()=>Ss(!1),className:"ml-4 text-xl hover:opacity-70 transition-opacity",children:"×"})]})}),c.jsx(sS,{isOpen:rr,onClose:()=>Rc(!1),event:e,schedule:I,activeItemId:W,activeTimers:it,onLoadCue:async h=>{const _=parseInt(h);isNaN(_)||await Vc(_)},onStartTimer:async h=>{if(h==="generic")W?(console.log("🎯 Generic start - controlling currently loaded item:",W),await Ys(W)):console.log("❌ No item currently loaded for generic start");else{const _=parseInt(h);isNaN(_)||await Ys(_)}},onStopTimer:async h=>{if(h==="generic"){const _=Object.keys(it);if(_.length>0){const T=parseInt(_[0]);console.log("🎯 Generic stop - controlling currently running timer:",T),await Ys(T)}else console.log("❌ No timer currently running for generic stop")}else{const _=parseInt(h);isNaN(_)||await Ys(_)}},onResetTimer:async h=>{if(h==="generic")console.log("🎯 Generic reset - using resetAllStates (same as Reset button)"),await wl();else{const _=parseInt(h);isNaN(_)||await Wd(_)}}}),to&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-8 w-full max-w-7xl max-h-[95vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Backup Management"}),c.jsx("button",{onClick:()=>ll(!1),className:"text-slate-400 hover:text-white text-2xl font-bold",children:"✕"})]}),c.jsx("div",{className:"bg-blue-900 border border-blue-600 rounded-lg p-4 mb-6",children:c.jsxs("div",{className:"flex items-start",children:[c.jsx("div",{className:"text-blue-400 text-xl mr-3",children:"ℹ️"}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-blue-200 font-semibold mb-1",children:"Manual Backup Only"}),c.jsx("p",{className:"text-blue-100 text-sm",children:'Automatic backups have been disabled to prevent interference with the main run of show. Use the "💾 Create Backup" button in the main interface to create backups when needed.'})]})]})}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Filter & Search"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-base font-medium mb-3",children:"Search by Event Name"}),c.jsx("input",{type:"text",placeholder:"Filter by event name...",className:"w-full px-4 py-3 bg-slate-600 border border-slate-500 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-base",onChange:h=>{}})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-base font-medium mb-3",children:"Filter by Date"}),c.jsx("input",{type:"date",className:"w-full px-4 py-3 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:border-blue-500 text-base",onChange:h=>{}})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-slate-300 text-base font-medium mb-3",children:"Sort by"}),c.jsxs("select",{className:"w-full px-4 py-3 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:border-blue-500 text-base",children:[c.jsx("option",{value:"newest",children:"Newest First"}),c.jsx("option",{value:"oldest",children:"Oldest First"}),c.jsx("option",{value:"event",children:"Event Name"}),c.jsx("option",{value:"type",children:"Backup Type"})]})]})]})]}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 flex-1 overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h3",{className:"text-xl font-semibold text-white",children:"Available Backups"}),c.jsx("button",{onClick:Sl,className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white text-base font-medium rounded-lg transition-colors",children:"🔄 Refresh"})]}),c.jsx("div",{className:"flex-1 overflow-y-auto",children:xa.length===0?c.jsx("div",{className:"text-slate-400 text-center py-12 text-lg",children:'No backups available. Use the "💾 Create Backup" button in the main interface to create a manual backup.'}):c.jsx("div",{className:"space-y-4",children:xa.map(h=>c.jsxs("div",{className:"bg-slate-600 p-6 rounded-lg flex justify-between items-center hover:bg-slate-500 transition-colors",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"text-white font-semibold text-xl mb-2 flex items-center gap-3",children:[h.backup_name,c.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${h.backup_type==="auto"?"bg-blue-600 text-blue-100":"bg-green-600 text-green-100"}`,children:h.backup_type})]}),c.jsxs("div",{className:"text-slate-400 text-sm",children:[c.jsx("strong",{children:"Event Date:"})," ",h.event_data?.date?new Date(h.event_data.date).toLocaleDateString():"N/A"," •",c.jsx("strong",{children:" Schedule Items:"})," ",h.schedule_data?.length||0," •",c.jsx("strong",{children:" Custom Columns:"})," ",h.custom_columns_data?.length||0]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:()=>$d(h),className:"px-6 py-3 bg-green-600 hover:bg-green-500 text-white text-base font-medium rounded-lg transition-colors",title:"Preview and load this backup",children:"🔄 Load/Overwrite"}),c.jsx("button",{onClick:()=>Vd(h.id),className:"px-5 py-3 bg-red-600 hover:bg-red-500 text-white text-base font-medium rounded-lg transition-colors",title:"Delete this backup",children:"🗑️ Delete"})]})]},h.id))})})]})]})}),ul&&cn&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-slate-800 rounded-lg p-8 w-full max-w-2xl",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Confirm Backup Restore"}),c.jsx("button",{onClick:()=>oi(!1),className:"text-slate-400 hover:text-white text-2xl font-bold",children:"✕"})]}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Backup Details"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Backup Name:"}),c.jsx("span",{className:"text-white font-medium",children:cn.backup_name})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Event:"}),c.jsx("span",{className:"text-white font-medium",children:cn.event_data?.name||"Unknown"})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Date:"}),c.jsx("span",{className:"text-white font-medium",children:new Date(cn.backup_timestamp).toLocaleString()})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Type:"}),c.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${cn.backup_type==="auto"?"bg-blue-600 text-blue-100":"bg-green-600 text-green-100"}`,children:cn.backup_type})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Schedule Items:"}),c.jsx("span",{className:"text-white font-medium",children:cn.schedule_data?.length||0})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-slate-300",children:"Custom Columns:"}),c.jsx("span",{className:"text-white font-medium",children:cn.custom_columns_data?.length||0})]})]})]}),c.jsx("div",{className:"bg-yellow-900 border border-yellow-600 rounded-lg p-4 mb-6",children:c.jsxs("div",{className:"flex items-start",children:[c.jsx("div",{className:"text-yellow-400 text-xl mr-3",children:"⚠️"}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-yellow-200 font-semibold mb-2",children:"Warning"}),c.jsx("p",{className:"text-yellow-100 text-sm",children:"This will completely overwrite your current run of show data with the backup data. This action cannot be undone. Make sure you want to proceed."})]})]})}),c.jsxs("div",{className:"flex justify-end space-x-4",children:[c.jsx("button",{onClick:()=>oi(!1),className:"px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white text-base font-medium rounded-lg transition-colors",children:"Cancel"}),c.jsx("button",{onClick:Bd,className:"px-6 py-3 bg-green-600 hover:bg-green-500 text-white text-base font-medium rounded-lg transition-colors",children:"🔄 Confirm Restore"})]})]})}),c.jsx(iA,{isOpen:ro,onClose:()=>ai(!1),onImport:Tl})]}):c.jsx("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-2xl font-bold mb-4",children:"No Event Selected"}),c.jsx("button",{onClick:()=>r("/"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded",children:"Back to Event List"})]})})},lA=({isRunning:t=!1,elapsedTime:r=0,totalDuration:e=0,onClose:n,message:s="",messageEnabled:o=!1,itemId:l,eventId:u,mainTimer:f=null,secondaryTimer:m=null})=>{const[p,v]=j.useState({elapsed:r,total:e}),[y,S]=j.useState(new Date),[k,w]=j.useState(!1),[E,F]=j.useState(null),[B,C]=j.useState(!1),[M,re]=j.useState(!1),[O,U]=j.useState(null),[ee,I]=j.useState(null),[ie,oe]=j.useState(0),[X,ae]=j.useState(null),[fe,me]=j.useState(null),[Te,be]=j.useState(null),[le,te]=j.useState(null),[pe,A]=j.useState(new Set);j.useEffect(()=>{m&&console.log("🔍 Secondary timer prop updated:",{secondaryTimer:m,supabaseOnly:M,hasSecondaryTimer:!!m})},[m,M]),j.useEffect(()=>{if(M&&O?.activeTimer){const J=O.activeTimer;if(J.is_running&&J.is_active){const he=new Date,Y=new Date(J.started_at),xe=Math.floor((he.getTime()-Y.getTime())/1e3),Pe=J.duration_seconds||0;v({elapsed:xe,total:Pe})}else v({elapsed:0,total:J.duration_seconds||0})}else v({elapsed:r,total:e})},[r,e,M,O]),j.useEffect(()=>{const J=setInterval(()=>{S(new Date)},1e3);return()=>clearInterval(J)},[]),j.useEffect(()=>{const J=()=>{w(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",J),()=>document.removeEventListener("fullscreenchange",J)},[]),j.useEffect(()=>{if(!u)return;const J=async()=>{C(!0);try{const Y=await Ge.getTimerMessage(u);F(Y),console.log("📨 Loaded timer message from Supabase:",Y)}catch(Y){console.error("❌ Error loading timer message:",Y)}finally{C(!1)}};J();const he=setInterval(J,5e3);return()=>clearInterval(he)},[u]),j.useEffect(()=>{if(!M||!u){if(ee&&(clearInterval(ee),I(null)),ae(null),me(null),be(null),X){const Y=parseInt(X.split("_")[0]);Vr.stopMonitoring(Y)}le&&(clearInterval(le),te(null)),A(new Set);return}const J=async()=>{try{console.log("🔄 Fetching hybrid timer data from Supabase...");const Y=await Ge.getHybridTimerData(u);if(U(Y),console.log("✅ Hybrid timer data updated:",Y),Y?.secondaryTimer?console.log("🔍 Secondary timer data:",Y.secondaryTimer):console.log("❌ No secondary timer data found"),Y?.subCueTimers&&Y.subCueTimers.length>0?(console.log("🔍 Sub-cue timers data:",Y.subCueTimers),console.log("🔍 First sub-cue timer structure:",Y.subCueTimers[0])):console.log("❌ No sub-cue timers data found"),Y?.secondaryTimer&&console.log("🔍 Secondary timer data (from sub-cue fallback):",Y.secondaryTimer),Y?.activeTimer&&console.log("🔍 Active timer data for CUE display:",{cue_display:Y.activeTimer.cue_display,cue:Y.activeTimer.cue,item_id:Y.activeTimer.item_id,allFields:Object.keys(Y.activeTimer),fullData:Y.activeTimer}),Y?.lastLoadedCue&&console.log("🔍 Last loaded cue data:",{cue:Y.lastLoadedCue.cue,cue_display:Y.lastLoadedCue.cue_display,segment_name:Y.lastLoadedCue.segment_name,allFields:Object.keys(Y.lastLoadedCue),fullData:Y.lastLoadedCue}),Y?.cueData?console.log("🔍 CUE data from schedule/items table:",{allFields:Object.keys(Y.cueData),fullData:Y.cueData}):console.log("🔍 No CUE data found from schedule/items tables"),Y?.activeTimer&&console.log("🔍 Full active timer data structure:",Y.activeTimer),Y?.activeTimer&&M){const xe=`${Y.activeTimer.item_id}_${Y.activeTimer.started_at}`,Pe=Y.activeTimer.item_id;X&&X!==xe&&(console.log("🔄 Active timer changed - stopping secondary timer"),console.log("🔄 Previous timer:",X),console.log("🔄 New timer:",xe),U(Xe=>({...Xe,secondaryTimer:null}))),fe&&fe!==Pe&&(console.log("🔄 New cue loaded - stopping secondary timer"),console.log("🔄 Previous item_id:",fe),console.log("🔄 New item_id:",Pe),U(Xe=>({...Xe,secondaryTimer:null})));const K=Y.activeTimer.started_at;if(Te&&Te!==K&&(console.log("🔄 Timer start time changed - restarting local timer"),console.log("🔄 Previous start time:",Te),console.log("🔄 New start time:",K)),Y.activeTimer.is_running&&Y.activeTimer.is_active&&Y.activeTimer.started_at){const Xe=new Date(Y.activeTimer.started_at),we=Y.activeTimer.duration_seconds;console.log(`🔄 Starting drift detection for timer ${Pe} with duration ${we}s`),Vr.stopMonitoring(Pe),Vr.startMonitoring(Pe,Xe,we,Oe=>{console.log(`🔄 DriftDetector: Syncing timer ${Pe} with server elapsed: ${Oe}s`),A(Ae=>new Set(Ae).add(Pe))});const Fe=setInterval(async()=>{try{console.log(`🔄 DriftDetector: Starting periodic sync for timer ${Pe}`),await Vr.forceSync(Pe,async()=>{const Ae=(await Ge.getActiveTimer(u))?.elapsed_seconds||0;return console.log(`🔄 DriftDetector: Server returned elapsed: ${Ae}s for timer ${Pe}`),Ae})}catch(Oe){console.warn(`⚠️ DriftDetector: Failed to sync timer ${Pe}:`,Oe)}},3e4);te(Fe)}ae(xe),me(Pe),be(K)}else if(!Y?.activeTimer&&X&&M){if(console.log("🔄 Active timer stopped - stopping secondary timer and drift detection"),U(xe=>({...xe,secondaryTimer:null})),X){const xe=parseInt(X.split("_")[0]);Vr.stopMonitoring(xe),A(Pe=>{const K=new Set(Pe);return K.delete(xe),K})}le&&(clearInterval(le),te(null)),ae(null),me(null),be(null)}}catch(Y){console.error("❌ Error fetching hybrid timer data:",Y)}};J();const he=setInterval(J,3e3);return I(he),()=>{clearInterval(he),I(null)}},[M,u]),j.useEffect(()=>{if(!M||!O?.secondaryTimer)return;const J=setInterval(()=>{oe(he=>he+1)},1e3);return()=>clearInterval(J)},[M,O?.secondaryTimer]),j.useEffect(()=>{if(!M||!O?.activeTimer)return;const J=O.activeTimer,he=J.item_id;if(J.is_running&&J.is_active&&J.started_at){const Y=new Date(J.started_at),xe=J.duration_seconds;console.log(`🔄 Starting continuous local timer for ${he} with duration ${xe}s, start time: ${Y.toISOString()}`);const Pe=setInterval(()=>{const K=new Date,Xe=Math.floor((K.getTime()-Y.getTime())/1e3);v(we=>({...we,elapsed:Xe,total:xe})),Vr.updateLocalElapsed(he,Xe),Xe<=10&&console.log(`🕐 Timer ${he}: Continuous elapsed=${Xe}s, Start=${Y.toISOString()}, Now=${K.toISOString()}`)},1e3);return()=>{console.log(`🔄 Stopping continuous local timer for ${he}`),clearInterval(Pe)}}},[M,O?.activeTimer,Te]),j.useEffect(()=>()=>{console.log("🔄 Cleaning up drift detector on component unmount"),Vr.destroy(),le&&clearInterval(le)},[]);const N=J=>{const he=J<0,Y=Math.abs(J),xe=Math.floor(Y/3600),Pe=Math.floor(Y%3600/60),K=Math.floor(Y%60),Xe=he?"-":"";return xe===0?`${Xe}${Pe.toString().padStart(2,"0")}:${K.toString().padStart(2,"0")}`:`${Xe}${xe.toString().padStart(2,"0")}:${Pe.toString().padStart(2,"0")}:${K.toString().padStart(2,"0")}`},L=J=>J.toLocaleTimeString("en-US",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}),V=()=>{const J=p,he=J.total-J.elapsed;if(M&&O?.activeTimer){const Y=O.activeTimer;if(!Y.is_running||!Y.is_active)return J.total}return he},q=()=>{const J=p,he=J.total-J.elapsed;if(M&&O?.activeTimer){const Y=O.activeTimer;if(!Y.is_running||!Y.is_active)return 100}return J.total>0?he/J.total*100:0},ce=()=>{const J=p,he=J.total-J.elapsed;if(M&&O?.activeTimer){const Y=O.activeTimer;if(!Y.is_running||!Y.is_active)return"#6b7280"}return he>120?"#10b981":he>30?"#f59e0b":"#ef4444"};return c.jsxs("div",{className:"fixed inset-0 bg-black text-white overflow-hidden flex flex-col items-center justify-center",style:{padding:0,margin:0},children:[c.jsxs("div",{className:"absolute top-10 left-10 text-3xl font-mono text-white",children:[c.jsx("div",{className:"text-slate-400 text-lg mb-1",children:"CURRENT TIME"}),c.jsx("div",{className:"text-white",children:L(y)})]}),c.jsxs("div",{className:"absolute top-10 right-10 text-3xl font-mono text-white",children:[c.jsx("div",{className:"text-slate-400 text-lg mb-1",children:"CURRENT CUE"}),c.jsxs("div",{className:"text-white flex items-center gap-3",children:[c.jsx("span",{children:(()=>{if(M&&O?.activeTimer){const J=O.activeTimer,he=O?.lastLoadedCue,Y=O?.cueData;if(J.cue_is)return console.log("✅ Using CUE data from active timer cue_is:",J.cue_is),J.cue_is;if(Y){console.log("🔍 CUE data structure:",Y),console.log("🔍 CUE data fields:",Object.keys(Y));const K=Y.customFields?.cue||Y.cue||Y.cue_display||Y.name||Y.title,Xe=Y.segmentName||Y.segment_name||Y.segment;if(K)return console.log("✅ Found CUE display:",K,"Segment:",Xe),`${K}${Xe?` - ${Xe}`:""}`}const xe=J.cue_display||J.cue,Pe=J.segment_name||J.segmentName;if(xe)return`${xe}${Pe?` - ${Pe}`:""}`;if(he){const K=he.cue_display||he.cue,Xe=he.segment_name||he.segmentName;if(K)return`${K}${Xe?` - ${Xe}`:""}`}return J.item_id?`CUE ${J.item_id.toString().slice(-4)}`:"No CUE"}return f?`${f.cue}${f.segmentName?` - ${f.segmentName}`:""}`:"No CUE"})()}),l&&c.jsx(zx,{itemId:l,className:"flex-shrink-0"})]})]}),!k&&M&&O?.activeTimer&&c.jsx("div",{className:"absolute bottom-10 left-10 text-center",children:c.jsx("div",{className:`text-lg font-bold px-4 py-2 rounded-lg ${O.activeTimer.is_running&&O.activeTimer.is_active?"bg-green-600 text-white":"bg-gray-600 text-white"}`,children:O.activeTimer.is_running&&O.activeTimer.is_active?"⏱️ TIMER RUNNING":"⏸️ TIMER STOPPED"})}),!k&&c.jsxs("div",{className:"absolute top-10 left-1/2 transform -translate-x-1/2 flex gap-3 z-50",children:[c.jsx("button",{onClick:()=>{document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-bold text-lg transition-colors",children:"FULL SCREEN"}),!k&&c.jsx("button",{onClick:()=>re(!M),className:`px-4 py-2 rounded-lg font-bold text-lg transition-colors ${M?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-600 hover:bg-gray-700 text-white"}`,children:"SUPABASE ONLY"})]}),(()=>{if(M){const J=O?.timerMessage||E;return J&&J.enabled}return o&&s||E&&E.enabled})()&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c.jsx("div",{className:"font-bold text-white bg-black bg-opacity-50 rounded-lg border-4 border-white text-center flex items-center justify-center",style:{width:"80vw",minHeight:"50vh",maxHeight:"70vh",lineHeight:"1.2",whiteSpace:"pre-line",overflow:"visible",padding:"30px",display:"flex",alignItems:"center",justifyContent:"center",wordWrap:"break-word"},children:(()=>{const J=M?O?.timerMessage?.message||E?.message||"":E?.message||s,he=J.split(" ");let Y;if(he.length<=3)Y=J;else if(he.length<=6){const K=Math.ceil(he.length/2);Y=he.slice(0,K).join(" ")+`
`+he.slice(K).join(" ")}else if(he.length<=10){const K=Math.ceil(he.length/3);Y=he.slice(0,K).join(" ")+`
`+he.slice(K,K*2).join(" ")+`
`+he.slice(K*2).join(" ")}else{const K=Math.ceil(he.length/4);Y=he.slice(0,K).join(" ")+`
`+he.slice(K,K*2).join(" ")+`
`+he.slice(K*2,K*3).join(" ")+`
`+he.slice(K*3).join(" ")}let xe;const Pe=/[gjpqy]/.test(J.toLowerCase());return he.length<=3?xe=Pe?"clamp(3rem, 12vw, 16rem)":"clamp(3.5rem, 13.5vw, 18rem)":he.length<=6?xe=Pe?"clamp(1.9rem, 8vw, 12rem)":"clamp(2.25rem, 9vw, 13.5rem)":he.length<=10?xe=Pe?"clamp(1.4rem, 6vw, 9rem)":"clamp(1.6rem, 7vw, 10.5rem)":xe=Pe?"clamp(0.9rem, 4vw, 6rem)":"clamp(1.1rem, 5vw, 7rem)",c.jsx("div",{style:{fontSize:xe},children:Y})})()})}),(()=>{if(M){const J=O?.secondaryTimer;if(!J)return!1;if(!J.is_running)return console.log("🔍 Sub-cue timer not running - hiding"),!1;if(J.is_running&&J.is_active){const he=new Date,Y=new Date(J.started_at||J.created_at),xe=Math.floor((he.getTime()-Y.getTime())/1e3),Pe=J.duration_seconds||J.duration||0;if(Math.max(0,Pe-xe)<=0)return!1}return!0}else return!!m})()&&c.jsxs("div",{className:`absolute animate-in fade-in duration-500 ${(M?E&&E.enabled:o&&s||E&&E.enabled)?"bottom-20 right-1/3 transform translate-x-1/2 flex flex-col items-center":"inset-0 flex flex-col items-center justify-center"}`,style:{marginTop:(M?E&&E.enabled:o&&s||E&&E.enabled)?"0":"-80px"},children:[c.jsx("div",{className:`text-orange-400 font-bold animate-in slide-in-from-top duration-500 ${(()=>{if(M){const J=O?.timerMessage||E;return J&&J.enabled}return o&&s||E&&E.enabled})()?"text-lg md:text-xl lg:text-2xl mb-2":"text-xl md:text-2xl lg:text-3xl mb-4"}`,style:{lineHeight:"1.2"},children:(()=>{const J=M?O?.secondaryTimer:m;if(!J)return"";if(M){const he=J.cue_display||J.cue||J.cue_is||"",Y=J.segment_name||J.segmentName||"";return Y?`${he} - ${Y}`:he}else{const he=J.cue||"",Y=J.segmentName||"";return Y?`${he} - ${Y}`:he}})()}),c.jsx("div",{className:`text-orange-400 font-mono font-bold animate-in zoom-in duration-500 ${(()=>{const J=M?O?.secondaryTimer:m;if(!J)return"text-3xl md:text-4xl lg:text-5xl";let he=0;if(M)if(J.is_running&&J.is_active){const xe=new Date,Pe=new Date(J.started_at||J.created_at),K=Math.floor((xe.getTime()-Pe.getTime())/1e3),Xe=J.duration_seconds||J.duration||0;he=Math.max(0,Xe-K)}else he=J.duration_seconds||J.duration||0;else he=J.remaining||0;const Y=Math.floor(he/3600);if(M){const xe=O?.timerMessage||E;if(xe&&xe.enabled)return"text-3xl md:text-4xl lg:text-5xl"}else if(o&&s||E&&E.enabled)return"text-3xl md:text-4xl lg:text-5xl";return Y===0?"text-[15rem] md:text-[16.875rem] lg:text-[22.5rem]":"text-[12rem] md:text-[13.5rem] lg:text-[18rem]"})()}`,style:{lineHeight:"1"},children:(()=>{const J=M?O?.secondaryTimer:m;if(!J)return"00:00";let he=0;if(M)if(J.is_running&&J.is_active){const K=new Date,Xe=new Date(J.started_at||J.created_at),we=Math.floor((K.getTime()-Xe.getTime())/1e3),Fe=J.duration_seconds||J.duration||0;he=Math.max(0,Fe-we)}else he=J.duration_seconds||J.duration||0;else he=J.remaining||0;const Y=Math.floor(he/3600),xe=Math.floor(he%3600/60),Pe=he%60;return Y===0?`${xe.toString().padStart(2,"0")}:${Pe.toString().padStart(2,"0")}`:`${Y.toString().padStart(2,"0")}:${xe.toString().padStart(2,"0")}:${Pe.toString().padStart(2,"0")}`})()})]}),(()=>{let J=!1;if(M){const Y=O?.secondaryTimer;if(Y)if(!Y.is_running)J=!1;else if(Y.is_running&&Y.is_active){const xe=new Date,Pe=new Date(Y.started_at||Y.created_at),K=Math.floor((xe.getTime()-Pe.getTime())/1e3),Xe=Y.duration_seconds||Y.duration||0;J=Math.max(0,Xe-K)>0}else J=!0}else J=!!m;const he=M?O?.timerMessage&&O.timerMessage.enabled||E&&E.enabled:o&&s||E&&E.enabled;return J&&he})()&&c.jsxs("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/3 transform -translate-x-1/2",children:[V()<0&&c.jsx("div",{className:"mb-2",children:c.jsx("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"})}),c.jsx("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:ce()},children:N(V())})]}),(()=>{let J=!1;if(M){const Y=O?.secondaryTimer;if(Y)if(!Y.is_running)J=!1;else if(Y.is_running&&Y.is_active){const xe=new Date,Pe=new Date(Y.started_at||Y.created_at),K=Math.floor((xe.getTime()-Pe.getTime())/1e3),Xe=Y.duration_seconds||Y.duration||0;J=Math.max(0,Xe-K)>0}else J=!0}else J=!!m;const he=M?O?.timerMessage&&O.timerMessage.enabled||E&&E.enabled:o&&s||E&&E.enabled;return J&&he})()&&c.jsx("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${Math.min(100,Math.max(0,V()/(e||1)*100))}%`,backgroundColor:ce()}})})}),(()=>{let J=!1;if(M){const Y=O?.secondaryTimer;if(Y)if(!Y.is_running)J=!1;else if(Y.is_running&&Y.is_active){const xe=new Date,Pe=new Date(Y.started_at||Y.created_at),K=Math.floor((xe.getTime()-Pe.getTime())/1e3),Xe=Y.duration_seconds||Y.duration||0;J=Math.max(0,Xe-K)>0}else J=!0}else J=!!m;const he=M?O?.timerMessage&&O.timerMessage.enabled||E&&E.enabled:o&&s||E&&E.enabled;return!J&&!he})()&&c.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center",children:[V()<0&&c.jsx("div",{className:"mb-[-50px]",children:c.jsx("div",{className:"font-bold text-red-500 text-5xl",children:"OVER TIME"})}),c.jsx("div",{className:"text-center",children:c.jsx("div",{className:`font-mono font-bold ${(()=>{const J=V();return Math.floor(Math.abs(J)/3600)===0?"text-[15rem] md:text-[16.875rem] lg:text-[22.5rem]":"text-[12rem] md:text-[13.5rem] lg:text-[18rem]"})()}`,style:{color:ce()},children:N(V())})}),c.jsx("div",{className:"w-full max-w-5xl mt-0",children:c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-8",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${q()}%`,background:ce()}})})})]}),(()=>{let J=!1;if(M){const Y=O?.secondaryTimer;if(Y)if(!Y.is_running)J=!1;else if(Y.is_running&&Y.is_active){const xe=new Date,Pe=new Date(Y.started_at||Y.created_at),K=Math.floor((xe.getTime()-Pe.getTime())/1e3),Xe=Y.duration_seconds||Y.duration||0;J=Math.max(0,Xe-K)>0}else J=!0}else J=!!m;return(M?O?.timerMessage&&O.timerMessage.enabled||E&&E.enabled:o&&s||E&&E.enabled)&&!J})()&&c.jsxs("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/2 transform -translate-x-1/2",children:[V()<0&&c.jsx("div",{className:"mb-2",children:c.jsx("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"})}),c.jsx("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:ce()},children:N(V())})]}),(()=>{let J=!1;if(M){const Y=O?.secondaryTimer;if(Y)if(!Y.is_running)J=!1;else if(Y.is_running&&Y.is_active){const xe=new Date,Pe=new Date(Y.started_at||Y.created_at),K=Math.floor((xe.getTime()-Pe.getTime())/1e3),Xe=Y.duration_seconds||Y.duration||0;J=Math.max(0,Xe-K)>0}else J=!0}else J=!!m;const he=M?O?.timerMessage&&O.timerMessage.enabled||E&&E.enabled:o&&s||E&&E.enabled;return J&&!he})()&&c.jsxs("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/2 transform -translate-x-1/2",children:[V()<0&&c.jsx("div",{className:"mb-2",children:c.jsx("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"})}),c.jsx("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:ce()},children:N(V())})]}),(()=>{let J=!1;if(M){const Y=O?.secondaryTimer;if(Y)if(!Y.is_running)J=!1;else if(Y.is_running&&Y.is_active){const xe=new Date,Pe=new Date(Y.started_at||Y.created_at),K=Math.floor((xe.getTime()-Pe.getTime())/1e3),Xe=Y.duration_seconds||Y.duration||0;J=Math.max(0,Xe-K)>0}else J=!0}else J=!!m;return(M?O?.timerMessage&&O.timerMessage.enabled||E&&E.enabled:o&&s||E&&E.enabled)&&!J})()&&c.jsx("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${q()}%`,background:ce()}})})}),(()=>{let J=!1;if(M){const Y=O?.secondaryTimer;if(Y)if(!Y.is_running)J=!1;else if(Y.is_running&&Y.is_active){const xe=new Date,Pe=new Date(Y.started_at||Y.created_at),K=Math.floor((xe.getTime()-Pe.getTime())/1e3),Xe=Y.duration_seconds||Y.duration||0;J=Math.max(0,Xe-K)>0}else J=!0}else J=!!m;const he=M?O?.timerMessage&&O.timerMessage.enabled||E&&E.enabled:o&&s||E&&E.enabled;return J&&!he})()&&c.jsx("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${q()}%`,background:ce()}})})})]})},cA=()=>{const t=jn();rl();const r=t.state||{},[e,n]=j.useState(r.isRunning||!1),[s,o]=j.useState(r.elapsedTime||0),[l,u]=j.useState(r.totalDuration||0),[f,m]=j.useState(""),[p,v]=j.useState(!1),[y,S]=j.useState(null),[k,w]=j.useState(r.itemId||null),[E,F]=j.useState(r.eventId||null),[B,C]=j.useState(r.mainTimer||null),[M,re]=j.useState(r.secondaryTimer||null);j.useEffect(()=>{const U=ee=>{switch(ee.key){case"Escape":window.close();break;case" ":ee.preventDefault(),n(!e);break;case"r":case"R":(ee.ctrlKey||ee.metaKey)&&(ee.preventDefault(),o(0),n(!1));break;case"+":case"=":(ee.ctrlKey||ee.metaKey)&&ee.preventDefault();break;case"-":(ee.ctrlKey||ee.metaKey)&&ee.preventDefault();break}};return window.addEventListener("keydown",U),()=>window.removeEventListener("keydown",U)},[e]);const O=async()=>{if(E&&(p||y))try{const ee=(await Ge.getTimerMessagesForEvent(E)).find(I=>I.enabled);ee&&(await Ge.disableTimerMessage(ee.id),console.log("✅ Message disabled in Supabase on close"))}catch(U){console.error("❌ Error clearing message on close:",U)}window.close()};return j.useEffect(()=>{if(!E)return;const U=async()=>{try{const I=await Ge.getTimerMessage(E);S(I),console.log("📨 Loaded timer message from Supabase:",I)}catch(I){console.error("❌ Error loading timer message:",I)}};U();const ee=setInterval(U,5e3);return()=>clearInterval(ee)},[E]),j.useEffect(()=>{const U=ee=>{if(ee.data.type==="TIMER_UPDATE"){const{isRunning:I,elapsedTime:ie,totalDuration:oe,eventId:X,itemId:ae,mainTimer:fe,secondaryTimer:me}=ee.data;I!==void 0&&n(I),ie!==void 0&&o(ie),oe!==void 0&&u(oe),X!==void 0&&F(X),ae!==void 0&&w(ae),fe!==void 0&&C(fe),me!==void 0&&re(me)}else if(ee.data.type==="MESSAGE_UPDATE"){const{message:I,enabled:ie}=ee.data;I!==void 0&&m(I),ie!==void 0&&v(ie)}};return window.addEventListener("message",U),()=>window.removeEventListener("message",U)},[]),c.jsx(lA,{isRunning:e,elapsedTime:s,totalDuration:l,onClose:O,message:f,messageEnabled:p,itemId:k,eventId:E,supabaseMessage:y,mainTimer:B,secondaryTimer:M})},uA=()=>{const t=jn();rl();const r=new URLSearchParams(t.search),e=r.get("eventId"),n=r.get("eventName"),s=t.state?.event||{id:e||"",name:n||"Current Event",date:"",location:"",schedule:[]},[o,l]=j.useState([]),[u,f]=j.useState(null),[m,p]=j.useState(!0),[v,y]=j.useState(null),[S,k]=j.useState(!1);j.useEffect(()=>{(async()=>{console.log("=== GRAPHICS LINKS PAGE INITIALIZATION ==="),console.log("Event from location.state:",t.state?.event),console.log("Event from URL params:",{eventId:e,eventName:n}),console.log("Final event object:",s);try{if(s?.id){console.log("🔄 Loading from Supabase for event:",s.id);const fe=await Ge.getRunOfShowData(s.id);if(fe){console.log("✅ Loaded from Supabase:",fe),console.log("Schedule items from Supabase:",fe.schedule_items?.length||0),console.log("Sample schedule item:",fe.schedule_items?.[0]),l(fe.schedule_items||[]),f(fe.updated_at||null),p(!1);return}}console.log("📱 Falling back to localStorage...");let ae=null;if(s?.id){const fe=`runOfShowSchedule_${s.id}`;ae=localStorage.getItem(fe)}if(!ae&&e){const fe=`runOfShowSchedule_${e}`;ae=localStorage.getItem(fe)}if(!ae){const me=Object.keys(localStorage).filter(Te=>Te.startsWith("runOfShowSchedule_"));if(me.length>0){const Te=me[me.length-1];ae=localStorage.getItem(Te)}}if(ae){const fe=JSON.parse(ae);console.log("📱 Loaded from localStorage:",fe),l(fe)}}catch(ae){console.error("❌ Error loading initial data:",ae)}finally{p(!1)}})()},[s?.id,e]),j.useEffect(()=>{if(!s?.id){console.log("❌ No event ID, skipping change detection");return}console.log("🔄 Starting change detection for Graphics Links page");const X=async()=>{try{console.log("🔄 Checking for changes in Graphics Links...");const fe=await Ge.checkForChanges(s.id,u??void 0);if(fe.hasChanges){console.log("🔄 Changes detected in Graphics Links:",fe),k(!0);const me=await Ge.loadChangesDynamically(s.id);me&&(console.log("📥 Loading updated data for Graphics Links:",me),console.log("📥 Updated schedule items:",me.schedule_items?.length||0),console.log("📥 Sample updated item:",me.schedule_items?.[0]),l(me.schedule_items||[]),f(me.updated_at||null),y(new Date),console.log("✅ Graphics Links data updated")),k(!1)}else console.log("✅ No changes detected in Graphics Links")}catch(fe){console.error("❌ Error checking for changes in Graphics Links:",fe)}};X();const ae=setInterval(X,5e3);return()=>clearInterval(ae)},[s?.id,u]),j.useEffect(()=>{const X=()=>{console.log("🔄 localStorage changed, updating schedule...");let fe=null;if(s?.id){const me=`runOfShowSchedule_${s.id}`;fe=localStorage.getItem(me)}if(!fe&&e){const me=`runOfShowSchedule_${e}`;fe=localStorage.getItem(me)}if(!fe){const Te=Object.keys(localStorage).filter(be=>be.startsWith("runOfShowSchedule_"));if(Te.length>0){const be=Te[Te.length-1];fe=localStorage.getItem(be)}}if(fe)try{k(!0);const me=JSON.parse(fe);console.log("📝 Updated schedule from localStorage:",me),console.log("📝 Schedule items count:",me.length),console.log("📝 Sample item with speakers:",me.find(Te=>Te.speakersText)),l(me),y(new Date),k(!1)}catch(me){console.log("Error parsing updated schedule:",me),k(!1)}};window.addEventListener("storage",X),window.addEventListener("scheduleUpdated",X);const ae=setInterval(()=>{console.log("🔍 Polling for schedule changes..."),X()},1e3);return()=>{window.removeEventListener("storage",X),window.removeEventListener("scheduleUpdated",X),clearInterval(ae)}},[s?.id,e]);const w=X=>{if(typeof X=="string"){let ae=X.replace(/&/g,"\\u0026");return ae=ae.replace(/\n/g," ").replace(/\r/g," "),ae=ae.replace(/[\x00-\x1F\x7F]/g," "),ae}else{if(Array.isArray(X))return X.map(ae=>w(ae));if(X!==null&&typeof X=="object"){const ae={};for(const[fe,me]of Object.entries(X))ae[fe]=w(me);return ae}}return X},E=async()=>{console.log("=== GRAPHICS LINKS JSON GENERATION ==="),console.log("Using schedule from state:",o);let X="";try{if(s?.id){const pe=await Ge.getRunOfShowData(s.id);pe?.settings?.masterStartTime&&(X=pe.settings.masterStartTime,console.log("Master start time from Supabase:",X))}}catch(pe){console.log("Error getting master start time from Supabase:",pe)}if(!X){const A=Object.keys(localStorage).filter(N=>N.startsWith("masterStartTime_"));if(A.length>0){const N=A[A.length-1],L=localStorage.getItem(N);L&&(X=L,console.log("Master start time from localStorage:",X))}}const ae=pe=>{const A=o[pe];if(!A||A.isIndented||!X)return"";let N=0;for(let xe=0;xe<pe;xe++){const Pe=o[xe];Pe.isIndented||(N+=(Pe.durationHours||0)*3600+(Pe.durationMinutes||0)*60+(Pe.durationSeconds||0))}const[L,V]=X.split(":").map(Number),ce=L*3600+V*60+N,J=Math.floor(ce/3600)%24,he=Math.floor(ce%3600/60),Y=new Date;return Y.setHours(J,he,0,0),Y.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})};console.log("=== FINAL DATA SUMMARY ==="),console.log("Schedule from state:",o),console.log("Master start time:",X),console.log("=== END FINAL DATA SUMMARY ===");const fe=o.filter(pe=>pe.isPublic===!0).map(pe=>{const A=o.findIndex(L=>L.id===pe.id),N=ae(A);return{segmentName:pe.segmentName||"Untitled Segment",startTime:N||"No Start Time"}});console.log("Public items found:",fe);const me={event:s?.name||"Current Event",generated:new Date().toISOString(),schedule:fe},Te=w(me),be=JSON.stringify(Te,null,2),le=new Blob([be],{type:"application/json;charset=utf-8;"}),te=URL.createObjectURL(le);window.open(te,"_blank")},F=()=>{console.log("=== GENERATING LOWER THIRDS JSON ==="),console.log("Event ID from URL:",e),console.log("Event object:",s),console.log("Using schedule from state:",o),console.log("Schedule length:",o.length),console.log("First few items:",o.slice(0,3));const X=o.filter(A=>A.speakersText&&A.speakersText.trim());console.log("Items with speakers data:",X.length),console.log("Items with speakers:",X.map(A=>({segmentName:A.segmentName,speakersText:A.speakersText,speakersLength:A.speakersText?.length||0}))),o.length===0&&(console.log("⚠️ NO SCHEDULE DATA FOUND!"),console.log("Available localStorage keys:",Object.keys(localStorage)),console.log("Looking for keys with event ID:",e));const fe=Object.keys(localStorage).filter(A=>A.startsWith("masterStartTime_"));if(fe.length>0){const A=fe[fe.length-1];localStorage.getItem(A)}const me=[];o.forEach((A,N)=>{console.log("Processing item:",A.segmentName,"Speakers:",A.speakersText),console.log("Item details:",{id:A.id,segmentName:A.segmentName,speakersText:A.speakersText,speakersTextLength:A.speakersText?.length||0,speakersTextType:typeof A.speakersText});const L={row:N+1,cue:A.customFields.cue||"",program:A.programType||"",segmentName:A.segmentName||"",speaker1Name:"",speaker1TitleOrg:"",speaker1Photo:"",speaker2Name:"",speaker2TitleOrg:"",speaker2Photo:"",speaker3Name:"",speaker3TitleOrg:"",speaker3Photo:"",speaker4Name:"",speaker4TitleOrg:"",speaker4Photo:"",speaker5Name:"",speaker5TitleOrg:"",speaker5Photo:"",speaker6Name:"",speaker6TitleOrg:"",speaker6Photo:"",speaker7Name:"",speaker7TitleOrg:"",speaker7Photo:""};if(A.speakersText&&A.speakersText.trim())try{const V=JSON.parse(A.speakersText);console.log("Parsed speakers array:",V),console.log("Speakers array length:",V?.length||0);const q=V.sort((ce,J)=>ce.slot-J.slot);console.log("Sorted speakers by slot:",q),q.forEach(ce=>{const J=ce.slot;if(J>=1&&J<=7){const he=ce.fullName||"",Y=ce.title&&ce.org?`${ce.title}
${ce.org}`:ce.title||ce.org||"",xe=ce.photoLink||"";L[`speaker${J}Name`]=he,L[`speaker${J}TitleOrg`]=Y,L[`speaker${J}Photo`]=xe,console.log(`Set speaker ${J} (${he}) in row ${N+1}`)}else console.log(`Speaker slot ${J} (${ce.fullName}) is outside range 1-7, skipping`)})}catch(V){console.log("Error parsing speakers JSON:",V),console.log("Raw speakers data:",A.speakersText)}else console.log("No speakers found in row:",A.segmentName);me.push(L)}),console.log("CUE rows with all speakers:",me);const Te={event:s?.name||"Current Event",generated:new Date().toISOString(),lowerThirds:{cueRows:me,totalRows:me.length,totalSpeakers:me.reduce((A,N)=>A+[1,2,3,4,5,6,7].filter(L=>N[`speaker${L}Name`].trim()).length,0)}},be=w(Te),le=JSON.stringify(be,null,2),te=new Blob([le],{type:"application/json;charset=utf-8;"}),pe=URL.createObjectURL(te);window.open(pe,"_blank"),console.log("=== END GENERATING LOWER THIRDS JSON ===")},B=()=>{const ae=`${window.location.origin}/lower-thirds-live.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(ae).then(()=>{alert(`Live JSON URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → JSON/XML

This URL will automatically update every 10 seconds!`)}).catch(()=>{const fe=document.createElement("textarea");fe.value=ae,document.body.appendChild(fe),fe.select(),document.execCommand("copy"),document.body.removeChild(fe),alert(`Live JSON URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → JSON/XML

This URL will automatically update every 10 seconds!`)})},C=()=>{const ae=`${window.location.origin}/lower-thirds-live.html?eventId=${e||s?.id}&format=xml`;navigator.clipboard.writeText(ae).then(()=>{alert(`Live XML URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → JSON/XML

This URL will automatically update every 10 seconds!`)}).catch(()=>{const fe=document.createElement("textarea");fe.value=ae,document.body.appendChild(fe),fe.select(),document.execCommand("copy"),document.body.removeChild(fe),alert(`Live XML URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → JSON/XML

This URL will automatically update every 10 seconds!`)})},M=()=>{const ae=`${window.location.origin}/schedule-live.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(ae).then(()=>{alert(`Live Schedule URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → JSON/XML

This URL will automatically update every 10 seconds!`)}).catch(()=>{const fe=document.createElement("textarea");fe.value=ae,document.body.appendChild(fe),fe.select(),document.execCommand("copy"),document.body.removeChild(fe),alert(`Live Schedule URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → JSON/XML

This URL will automatically update every 10 seconds!`)})},re=()=>{const ae=`${window.location.origin}/custom-graphics-live.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(ae).then(()=>{alert(`Live Custom Graphics JSON URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → JSON

This URL will automatically update every 10 seconds!`)}).catch(()=>{const fe=document.createElement("textarea");fe.value=ae,document.body.appendChild(fe),fe.select(),document.execCommand("copy"),document.body.removeChild(fe),alert(`Live Custom Graphics JSON URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → JSON

This URL will automatically update every 10 seconds!`)})},O=()=>{const ae=`${window.location.origin}/custom-graphics-live-xml.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(ae).then(()=>{alert(`Live Custom Graphics XML URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → JSON/XML

This URL will automatically update every 10 seconds!`)}).catch(()=>{const fe=document.createElement("textarea");fe.value=ae,document.body.appendChild(fe),fe.select(),document.execCommand("copy"),document.body.removeChild(fe),alert(`Live Custom Graphics XML URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → JSON/XML

This URL will automatically update every 10 seconds!`)})},U=()=>{const ae=`${window.location.origin}/custom-graphics-live-csv.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(ae).then(()=>{alert(`Live Custom Graphics CSV URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → CSV

This URL will automatically update every 10 seconds!`)}).catch(()=>{const fe=document.createElement("textarea");fe.value=ae,document.body.appendChild(fe),fe.select(),document.execCommand("copy"),document.body.removeChild(fe),alert(`Live Custom Graphics CSV URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → CSV

This URL will automatically update every 10 seconds!`)})},ee=()=>{const ae=`${window.location.origin}/lower-thirds-live-csv.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(ae).then(()=>{alert(`Live CSV URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → CSV

This URL will automatically update every 10 seconds!`)}).catch(()=>{const fe=document.createElement("textarea");fe.value=ae,document.body.appendChild(fe),fe.select(),document.execCommand("copy"),document.body.removeChild(fe),alert(`Live CSV URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → CSV

This URL will automatically update every 10 seconds!`)})},I=()=>{const ae=`${window.location.origin}/schedule-live-xml.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(ae).then(()=>{alert(`Live Schedule XML URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → JSON/XML

This URL will automatically update every 10 seconds!`)}).catch(()=>{const fe=document.createElement("textarea");fe.value=ae,document.body.appendChild(fe),fe.select(),document.execCommand("copy"),document.body.removeChild(fe),alert(`Live Schedule XML URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → JSON/XML

This URL will automatically update every 10 seconds!`)})},ie=()=>{const ae=`${window.location.origin}/schedule-live-csv.html?eventId=${e||s?.id}`;navigator.clipboard.writeText(ae).then(()=>{alert(`Live Schedule CSV URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → CSV

This URL will automatically update every 10 seconds!`)}).catch(()=>{const fe=document.createElement("textarea");fe.value=ae,document.body.appendChild(fe),fe.select(),document.execCommand("copy"),document.body.removeChild(fe),alert(`Live Schedule CSV URL copied to clipboard:
${ae}

Use this URL in VMIX Data Sources → CSV

This URL will automatically update every 10 seconds!`)})},oe=async()=>{console.log("🔍 Starting generateCustomGraphicsJSON"),console.log("🔍 Current schedule state:",o),console.log("🔍 Schedule length:",o.length);let X="";const fe=Object.keys(localStorage).filter(L=>L.startsWith("masterStartTime_"));if(fe.length>0){const L=fe[fe.length-1],V=localStorage.getItem(L);V&&(X=V)}const me=L=>{if(!X)return"";let V=0;for(let he=0;he<L;he++){const Y=o[he];V+=Y.durationHours*60+Y.durationMinutes}const[q,ce]=X.split(":").map(Number),J=new Date;return J.setHours(q,ce+V,0,0),J.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})};let Te=[];try{s?.id&&(Te=(await Ge.getRunOfShowData(s.id))?.custom_columns||[],console.log("🔍 Custom columns from Supabase:",Te))}catch(L){console.log("Error getting custom columns from Supabase:",L)}if(Te.length===0&&s?.id){const L=localStorage.getItem(`customColumns_${s.id}`);L&&(Te=JSON.parse(L),console.log("🔍 Custom columns from localStorage:",Te))}console.log("🔍 Final custom columns for graphics:",Te),console.log("🔍 Schedule data for graphics:",o),console.log("🔍 Schedule length:",o.length),console.log("🔍 Public items:",o.filter(L=>L.isPublic).length);const be=o.filter(L=>L.isPublic).map(L=>{const V={type:L.segmentName||"Segment",text:L.segmentName||"Custom Graphic",duration:`${L.durationHours.toString().padStart(2,"0")}:${L.durationMinutes.toString().padStart(2,"0")}:${L.durationSeconds.toString().padStart(2,"0")}`,cue:L.customFields.cue||"CUE##",startTime:me(o.findIndex(ce=>ce.id===L.id)),notes:L.notes||""},q={};return Te.forEach(ce=>{const J=L.customFields[ce.name];J&&J.trim()!==""&&(q[ce.name]=J)}),{...V,...q}});console.log("🔍 Generated custom graphics:",be),console.log("🔍 Custom graphics length:",be.length);const le={event:s?.name||"Current Event",generated:new Date().toISOString(),customGraphics:be.length>0?be:[{type:"Title",text:"Welcome to Event",duration:"00:00:10",cue:"CUE01",startTime:"00:00:00",notes:"Opening title"},{type:"Break",text:"Commercial Break",duration:"00:02:00",cue:"CUE02",startTime:"00:15:00",notes:"Commercial break"}]},te=w(le),pe=JSON.stringify(te,null,2),A=new Blob([pe],{type:"application/json;charset=utf-8;"}),N=URL.createObjectURL(A);window.open(N,"_blank")};return c.jsxs("div",{className:"min-h-screen bg-slate-900 text-white pt-16",children:[c.jsx("div",{className:"bg-slate-800 border-b border-slate-700",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex items-center justify-between h-16",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{onClick:()=>{window.close()},className:"text-slate-300 hover:text-white transition-colors mr-6",children:"← Back to Run of Show"}),c.jsx("h1",{className:"text-xl font-semibold",children:"Graphics Links"})]}),c.jsx("div",{className:"text-slate-400",children:s?.name||"Event"})]})})}),c.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-8 shadow-2xl",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Generate JSON Files"}),m&&c.jsx("p",{className:"text-blue-400 text-sm mt-1",children:"🔄 Loading data..."}),v&&!m&&c.jsxs("p",{className:"text-green-400 text-sm mt-1",children:["✅ Last updated: ",v.toLocaleTimeString()]}),S&&c.jsx("p",{className:"text-blue-400 text-sm mt-1",children:"🔄 Updating data..."})]}),c.jsx("button",{onClick:async()=>{console.log("🔄 Manual refresh triggered"),p(!0);try{if(s?.id){const ae=await Ge.getRunOfShowData(s.id);if(ae){l(ae.schedule_items||[]),f(ae.updated_at||null),console.log("✅ Refreshed from Supabase"),alert("Data refreshed from database!");return}}let X=null;if(s?.id){const ae=`runOfShowSchedule_${s.id}`;X=localStorage.getItem(ae)}if(!X&&e){const ae=`runOfShowSchedule_${e}`;X=localStorage.getItem(ae)}if(!X){const fe=Object.keys(localStorage).filter(me=>me.startsWith("runOfShowSchedule_"));if(fe.length>0){const me=fe[fe.length-1];X=localStorage.getItem(me)}}if(X){const ae=JSON.parse(X);console.log("📝 Manually refreshed schedule:",ae),l(ae),alert("Data refreshed from local storage!")}else alert("No schedule data found")}catch(X){console.error("❌ Error refreshing data:",X),alert("Error refreshing data")}finally{p(!1)}},className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:"🔄 Refresh Data"})]}),c.jsxs("p",{className:"text-slate-300 mb-8",children:["Click the buttons below to generate url links that VMIX can use as data sources for graphics.",c.jsx("span",{className:"text-green-400 font-medium",children:" ✨ Live pages updates automatically when content changes! "}),`Use "Refresh Data" if changes don't appear automatically.`]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 flex flex-col",children:[c.jsx("h3",{className:"text-xl font-semibold text-white mb-4 text-center",children:"Lower Thirds"}),c.jsxs("div",{className:"space-y-3 mt-auto",children:[c.jsx("button",{onClick:F,className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:"📄 Generate Static JSON"}),c.jsx("button",{onClick:B,className:"w-full px-4 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors",children:"🔄 Generate Live JSON URL"}),c.jsx("button",{onClick:C,className:"w-full px-4 py-3 bg-orange-600 hover:bg-orange-500 text-white font-medium rounded-lg transition-colors",children:"🔄 Generate Live XML URL"}),c.jsx("button",{onClick:ee,className:"w-full px-4 py-3 bg-yellow-600 hover:bg-yellow-500 text-white font-medium rounded-lg transition-colors",children:"🔄 Generate Live CSV URL"})]})]}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 flex flex-col",children:[c.jsx("h3",{className:"text-xl font-semibold text-white mb-4 text-center",children:"Schedule"}),c.jsxs("div",{className:"space-y-3 mt-auto",children:[c.jsx("button",{onClick:async()=>{try{await E()}catch(X){console.error("Error generating schedule JSON:",X),alert("Error generating schedule JSON")}},className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:"📄 Generate Static JSON"}),c.jsx("button",{onClick:M,className:"w-full px-4 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors",children:"🔄 Generate Live JSON URL"}),c.jsx("button",{onClick:I,className:"w-full px-4 py-3 bg-orange-600 hover:bg-orange-500 text-white font-medium rounded-lg transition-colors",children:"🔄 Generate Live XML URL"}),c.jsx("button",{onClick:ie,className:"w-full px-4 py-3 bg-yellow-600 hover:bg-yellow-500 text-white font-medium rounded-lg transition-colors",children:"🔄 Generate Live CSV URL"})]})]}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 flex flex-col",children:[c.jsx("h3",{className:"text-xl font-semibold text-white mb-4 text-center",children:"Custom Graphics"}),c.jsxs("div",{className:"space-y-3 mt-auto",children:[c.jsx("button",{onClick:async()=>{try{await oe()}catch(X){console.error("Error generating custom graphics JSON:",X),alert("Error generating custom graphics JSON")}},className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:"📄 Generate Static JSON"}),c.jsx("button",{onClick:re,className:"w-full px-4 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors",children:"🔄 Generate Live JSON URL"}),c.jsx("button",{onClick:O,className:"w-full px-4 py-3 bg-orange-600 hover:bg-orange-500 text-white font-medium rounded-lg transition-colors",children:"🔄 Generate Live XML URL"}),c.jsx("button",{onClick:U,className:"w-full px-4 py-3 bg-yellow-600 hover:bg-yellow-500 text-white font-medium rounded-lg transition-colors",children:"🔄 Generate Live CSV URL"})]})]})]}),c.jsxs("div",{className:"mt-8 p-4 bg-slate-600 rounded-lg",children:[c.jsx("h4",{className:"text-white font-semibold mb-2",children:"VMIX Data Source Information"}),c.jsx("p",{className:"text-slate-300 text-sm",children:'These data sources are designed for VMIX and will include only items marked as "Public":'}),c.jsxs("ul",{className:"text-slate-300 text-sm mt-2 ml-4 list-disc",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Schedule:"})," Segment Name, Start Time (sorted by time)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Lower Thirds:"})," Speaker Names, Titles, Organizations, Segments, CUEs (up to 7 speakers per segment)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Custom Graphics:"})," Type, Text, Duration, CUE, Start Time, Notes, plus custom columns (if data exists)"]})]}),c.jsx("div",{className:"mt-4 p-3 bg-green-900 rounded-lg",children:c.jsxs("p",{className:"text-green-200 text-sm",children:[c.jsx("strong",{children:"✨ Live Updates:"}),' Use the "Live" URLs for real-time data that automatically updates every 10 seconds in VMIX']})}),c.jsx("div",{className:"mt-4 p-3 bg-blue-900 rounded-lg",children:c.jsxs("p",{className:"text-blue-200 text-sm",children:[c.jsx("strong",{children:"VMIX Setup:"})," Copy the Live URLs and add them in VMIX Data Sources → JSON/XML/CSV. No need to save files manually!"]})}),c.jsx("div",{className:"mt-2 p-3 bg-yellow-900 rounded-lg",children:c.jsxs("p",{className:"text-yellow-200 text-sm",children:[c.jsx("strong",{children:"Format Options:"})," JSON (recommended), XML, or CSV - choose what works best with your VMIX setup"]})})]})]})})]})},dA=()=>{const t=jn();rl();const r=new URLSearchParams(t.search),e=r.get("eventId"),n=r.get("eventName"),s=t.state?.event||{id:e||"",name:n||"Current Event",date:"",location:"",schedule:[]};console.log("ReportsPage event data:",{fromState:!!t.state?.event,eventId:e,eventName:n,finalEvent:s,userRole:localStorage.getItem("currentUserRole")});const[o,l]=j.useState([]),[u,f]=j.useState(""),[m,p]=j.useState("showfile"),[v,y]=j.useState(1);j.useEffect(()=>{console.log("=== REPORTS PAGE INITIALIZATION ==="),console.log("Event:",s);let C=null;if(s?.id){const U=`runOfShowSchedule_${s.id}`;C=localStorage.getItem(U)}if(!C&&e){const U=`runOfShowSchedule_${e}`;C=localStorage.getItem(U)}if(!C){const ee=Object.keys(localStorage).filter(I=>I.startsWith("runOfShowSchedule_"));if(ee.length>0){const I=ee[ee.length-1];C=localStorage.getItem(I)}}if(C)try{const U=JSON.parse(C);l(U),console.log("Schedule loaded:",U),console.log("First schedule item:",U[0]),console.log("Schedule item duration fields:",U[0]?{durationHours:U[0].durationHours,durationMinutes:U[0].durationMinutes,durationSeconds:U[0].durationSeconds}:"No items")}catch(U){console.log("Error parsing schedule:",U)}const re=Object.keys(localStorage).filter(U=>U.startsWith("masterStartTime_"));console.log("Master time keys found:",re);let O=null;if(s?.id&&(O=localStorage.getItem(`masterStartTime_${s.id}`),console.log(`Master time for event ${s.id}:`,O)),!O&&re.length>0){const U=re[re.length-1];O=localStorage.getItem(U),console.log("Latest master time key:",U,"Value:",O)}O?(f(O),console.log("Master start time set to:",O)):(console.log("No master start time found in localStorage"),f("09:00"),console.log("Set default master start time to 09:00"))},[s?.id,e]);const S=C=>{if(console.log(`calculateStartTime called with index: ${C}, masterStartTime: ${u}`),!u)return console.log("No master start time, returning empty string"),"";let M=0;for(let I=0;I<C;I++){const ie=o[I];M+=ie.durationHours*60+ie.durationMinutes}console.log(`Total minutes for index ${C}: ${M}`);const[re,O]=u.split(":").map(Number),U=new Date;U.setHours(re,O+M,0,0);const ee=U.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return console.log(`Calculated start time for index ${C}: ${ee}`),ee},k=C=>({"PreShow/End":"#8B5CF6","Podium Transition":"#8B4513","Panel Transition":"#404040","Sub Cue":"#F3F4F6","No Transition":"#059669",Video:"#F59E0B","Panel+Remote":"#1E40AF","Remote Only":"#60A5FA",Break:"#EC4899",TBD:"#6B7280",KILLED:"#DC2626",Podium:"#FFFFFF",Panel:"#FFFFFF"})[C]||"#D3D3D3",w=C=>C==="Panel Transition"||C==="Podium Transition"||C==="Panel"||C==="Podium"?"#FFFFFF":k(C),E=()=>{const C=m==="showfile",M=o.filter(re=>(re.day||1)===v);if(console.log("=== GENERATING REPORT ==="),console.log("Report type:",m),console.log("Selected day:",v),console.log("Total schedule items:",o.length),console.log("Filtered schedule items:",M.length),console.log("Sample item:",M[0]),console.log("Master start time:",u),M.length>0){const re=o.findIndex(U=>U.id===M[0].id),O=S(re);console.log("Test start time calculation:",{testIndex:re,testStartTime:O,item:M[0].segmentName})}if(C){let re=`
        <!DOCTYPE html>
        <html>
        <head>
          <title>ROS Show File - ${s?.name||"Event"}</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 0; 
              padding: 15px;
              font-size: 11px;
              line-height: 1.3;
              background: white;
            }
            @media print {
              body { 
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
              * {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
            }
            .header { 
              text-align: center; 
              margin-bottom: 15px; 
            }
            .header h1 { 
              font-size: 16px; 
              margin: 0; 
              color: #000;
              font-weight: normal;
            }
            .header h2 { 
              font-size: 12px; 
              margin: 3px 0 0 0; 
              color: #333; 
              font-weight: normal;
            }
            .event-info { 
              background: #f5f5f5; 
              padding: 8px; 
              margin-bottom: 12px; 
              font-size: 10px;
              border: 1px solid #ddd;
            }
            .section { 
              margin-bottom: 8px; 
              border: 1px solid #000;
              page-break-inside: avoid;
            }
            .section-header { 
              padding: 6px 8px; 
              font-weight: normal; 
              font-size: 11px;
              color: white;
              background: #366092;
              border-bottom: 1px solid #000;
            }
            .section-content { 
              padding: 0; 
              background: white;
            }
            .modal-table { 
              width: 100%;
              border-collapse: collapse;
              border: 2px solid #000;
              background: white;
            }
            .modal-table td { 
              border: 1px solid #000; 
              padding: 6px 8px; 
              background: white;
              vertical-align: top;
            }
            .modal-table .header-cell { 
              background: #d9d9d9; 
              font-weight: normal; 
              text-align: center;
              font-size: 10px;
              width: 70px;
              min-width: 70px;
            }
            .modal-table .segment-cell { 
              min-width: 180px;
              max-width: 250px;
              word-wrap: break-word;
              font-size: 11px;
            }
            .modal-table .notes-cell { 
              background: #f0f0f0; 
              min-height: 35px;
              min-width: 200px;
              font-size: 10px;
            }
            .modal-table .participants-cell { 
              background: #f0f0f0; 
              min-height: 60px;
              min-width: 250px;
            }
            .modal-table .start-time-cell { 
              background: #e7f3ff; 
              font-weight: normal;
              font-size: 12px;
            }
            .times-cell {
              background: #e7f3ff;
              font-weight: normal;
              text-align: center;
              vertical-align: middle;
              width: 80px;
              min-width: 80px;
            }
            .times-content {
              display: flex;
              flex-direction: column;
              gap: 2px;
            }
            .start-time {
              font-size: 11px;
              font-weight: normal;
              color: #000;
            }
            .duration {
              font-size: 11px;
              font-weight: normal;
              color: #000;
            }
            .time-label {
              font-size: 9px;
              font-weight: normal;
              color: #333;
              margin-right: 4px;
            }
            .simple-table { 
              width: 100%;
              border-collapse: collapse;
              border: 1px solid #000;
              background: white;
            }
            .simple-table td { 
              border: 1px solid #000; 
              padding: 8px; 
              background: white;
              vertical-align: top;
              font-size: 11px;
            }
        .simple-table .header-cell { 
          background: #d9d9d9; 
          font-weight: normal; 
          text-align: center;
          font-size: 10px;
        }
        .stacked-header {
          width: 250px;
        }
        .stacked-cell {
          width: 250px;
          max-width: 250px;
          vertical-align: top;
          padding: 8px;
        }
        .stacked-item {
          margin-bottom: 8px;
          padding-bottom: 6px;
          border-bottom: 1px solid #e0e0e0;
          display: flex;
          flex-direction: column;
        }
        .stacked-item:last-child {
          border-bottom: none;
          margin-bottom: 0;
          padding-bottom: 0;
        }
        .stacked-label {
          font-weight: normal;
          font-size: 9px;
          color: #333;
          margin-bottom: 3px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        .stacked-value {
          font-size: 10px;
          line-height: 1.3;
          word-wrap: break-word;
          color: #000;
          padding-left: 4px;
        }
        .slot-cell {
          width: 120px;
          height: 100px;
          vertical-align: top;
        }
        .slot-container {
          height: 100px;
          display: flex;
          flex-direction: column;
          justify-content: flex-start;
          padding: 4px;
        }
        .slot-name {
          font-weight: normal;
          font-size: 11px;
          line-height: 1.2;
        }
        .slot-title {
          font-size: 10px;
          line-height: 1.1;
          color: #666;
        }
        .slot-org {
          font-size: 10px;
          line-height: 1.1;
          color: #666;
        }
        .slot-photo {
          display: flex;
          align-items: center;
          justify-content: center;
          margin-top: 8px;
        }
        .slot-photo-img {
          width: 65px;
          height: 65px;
          object-fit: cover;
          border-radius: 4px;
          border: 1px solid #ccc;
        }
        .notes-header-row {
          background: #e0e0e0;
        }
        .notes-header-cell {
          padding: 6px 8px;
          font-size: 10px;
          font-weight: normal;
          text-align: center;
          border-top: 2px solid #ddd;
          background: #e0e0e0;
        }
        .notes-content-row {
          background: #f9f9f9;
        }
        .notes-content-cell {
          padding: 8px;
          font-size: 10px;
          line-height: 1.3;
          background: #f9f9f9;
        }
            .modal-cell .field-label { 
              font-weight: normal; 
              font-size: 11px; 
              color: #333; 
              margin-bottom: 4px;
            }
            .modal-cell .field-value { 
              font-size: 12px; 
              color: #000;
              line-height: 1.3;
            }
            .speaker-item { 
              display: flex; 
              align-items: center; 
              margin-bottom: 6px;
              padding: 6px;
              background: white;
              border: 1px solid #ddd;
              border-radius: 4px;
              box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            }
            .speaker-photo { 
              width: 40px; 
              height: 40px; 
              border-radius: 4px; 
              object-fit: cover; 
              border: 2px solid #007acc;
              margin-right: 10px;
              flex-shrink: 0;
            }
            .speaker-info { 
              flex: 1;
            }
            .speaker-badges { 
              display: flex; 
              gap: 4px;
              margin-bottom: 3px;
            }
            .speaker-name { 
              font-weight: normal; 
              font-size: 11px; 
              color: #000;
              margin-bottom: 2px;
            }
            .slot-badge { 
              background: #007acc; 
              color: white; 
              padding: 2px 6px; 
              border-radius: 6px; 
              font-size: 8px; 
              font-weight: normal;
            }
            .location-badge { 
              background: #28a745; 
              color: white; 
              padding: 2px 6px; 
              border-radius: 6px; 
              font-size: 8px; 
              font-weight: normal;
            }
            .speaker-title { 
              color: #666; 
              font-size: 10px;
              margin-bottom: 1px;
            }
            .speaker-org { 
              color: #888; 
              font-size: 9px;
            }
            .footer { 
              margin-top: 40px; 
              text-align: center; 
              color: #666; 
              font-size: 12px;
              border-top: 1px solid #ddd;
              padding-top: 20px;
            }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
              @page { 
                size: A4; 
                margin: 0.5in; 
              }
              .section { 
                page-break-inside: avoid;
              }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>ROS SHOW FILE</h1>
            <h2>${s?.name||"Event"}${s?.numberOfDays&&s.numberOfDays>1?` - Day ${v}`:""}</h2>
          </div>
          
      `;return M.forEach((O,U)=>{const ee=o.findIndex(me=>me.id===O.id),I=S(ee),ie=`${O.durationHours.toString().padStart(2,"0")}:${O.durationMinutes.toString().padStart(2,"0")}:${O.durationSeconds.toString().padStart(2,"0")}`,oe=k(O.programType||"");console.log(`SHOW FILE - Item ${U} (${O.segmentName}):`,{originalIndex:ee,startTime:I,duration:ie,masterStartTime:u,itemId:O.id});let X=[];if(O.speakersText)try{X=JSON.parse(O.speakersText),console.log(`Speakers parsed for item ${U}:`,X)}catch(me){console.log(`Error parsing speakers for item ${U}:`,me),X=[{fullName:O.speakersText,title:"",org:"",photoLink:""}]}else console.log(`No speakersText for item ${U}:`,O.segmentName);let ae="";O.hasPPT&&O.hasQA?ae="PPT + Q&A":O.hasPPT?ae="PPT":O.hasQA?ae="Q&A":ae="None",re+=`
          <div class="section">
            <div class="section-content">
              <table class="simple-table">
                <tr>
                  <td class="header-cell">CUE</td>
                  <td class="header-cell">TIME</td>
                  <td class="header-cell stacked-header">SEGMENT INFO</td>
                  <td class="header-cell">SLOT 1</td>
                  <td class="header-cell">SLOT 2</td>
                  <td class="header-cell">SLOT 3</td>
                  <td class="header-cell">SLOT 4</td>
                  <td class="header-cell">SLOT 5</td>
                  <td class="header-cell">SLOT 6</td>
                  <td class="header-cell">SLOT 7</td>
                </tr>
                <tr>
                  <td>
                    <div style="margin-bottom: 4px;">${O.customFields.cue||`CUE ${U+1}`}</div>
                    <div style="background-color: ${oe}; color: ${O.programType==="Sub Cue"?"black":"white"}; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: normal; display: inline-block; ${O.programType==="Sub Cue"?"border: 1px solid #000000;":""}">${O.programType||"Unknown"}</div>
                  </td>
                  <td class="times-cell">
                    <div class="times-content">
                      <div class="start-time">
                        <span class="time-label">Start:</span> ${I}
                      </div>
                      <div class="duration">
                        <span class="time-label">Dur:</span> ${ie}
                      </div>
                    </div>
                  </td>
                  <td class="stacked-cell">
                    <div class="stacked-item">
                      <div class="stacked-label">SEGMENT:</div>
                      <div class="stacked-value">${O.segmentName||"Untitled Segment"}</div>
                    </div>
                    <div class="stacked-item">
                      <div class="stacked-label">SHOT:</div>
                      <div class="stacked-value">${O.shotType||"Not specified"}</div>
                    </div>
                    <div class="stacked-item">
                      <div class="stacked-label">PPT/Q&A:</div>
                      <div class="stacked-value">${ae}</div>
                    </div>
                  </td>
        `;const fe=["","","","","","",""];X.length>0&&X.forEach(me=>{const Te=me.fullName||me.name||"Unknown",be=me.title||"",le=me.org||"",te=me.slot||1,pe=me.location||"Podium",A=me.photoLink||"";let L=`
              <div class="slot-container">
                <div class="slot-name">${pe==="Podium"?"P":pe==="Seat"?"S":"V"}${te} - ${Te}</div>
                <div class="slot-title">${be}</div>
                <div class="slot-org">${le}</div>
                <div class="slot-photo">${A?`<img src="${A}" alt="${Te}" class="slot-photo-img" />`:""}</div>
              </div>
            `;const V=Math.min(te-1,6);V>=0&&V<7&&(fe[V]=L)});for(let me=0;me<7;me++)re+=`<td class="slot-cell">${fe[me]||""}</td>`;re+=`
                </tr>
                <tr class="notes-header-row">
                  <td colspan="10" class="notes-header-cell">NOTES</td>
                </tr>
                <tr class="notes-content-row">
                  <td colspan="10" class="notes-content-cell">${O.notes||"None"}</td>
                </tr>
              </table>
            </div>
          </div>
        `}),re+=`
          <div class="footer">
            <p>Generated: ${new Date().toLocaleString()} | Run of Show Application</p>
          </div>
        </body>
        </html>
      `,re}else{let re=`
        <!DOCTYPE html>
        <html>
        <head>
          <title>Run of Show Report - ${s?.name||"Event"}</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 20px; 
              font-size: 14px;
            }
            .header { 
              text-align: center; 
              margin-bottom: 30px; 
            }
            .header h1 { 
              font-size: 24px; 
              margin: 0; 
            }
            .header h2 { 
              font-size: 18px; 
              margin: 5px 0 0 0; 
              color: #666; 
            }
            .event-info { 
              background: #f5f5f5; 
              padding: 15px; 
              border-radius: 5px; 
              margin-bottom: 20px; 
              font-size: 12px;
            }
            table { 
              width: 100%; 
              border-collapse: collapse; 
              margin-top: 20px; 
            }
            th, td { 
              border: 1px solid #ddd; 
              padding: 8px; 
              text-align: left; 
              font-size: 12px;
            }
            th { 
              background-color: #f2f2f2; 
              font-weight: normal; 
            }
            tr { 
              -webkit-print-color-adjust: exact !important;
              color-adjust: exact !important;
              print-color-adjust: exact !important;
            }
            .footer { 
              margin-top: 30px; 
              text-align: center; 
              color: #666; 
              font-size: 12px;
            }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
              @page { 
                size: A4; 
                margin: 0.5in; 
              }
              tr { 
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>RUN OF SHOW REPORT</h1>
            <h2>${s?.name||"Event"}${s?.numberOfDays&&s.numberOfDays>1?` - Day ${v}`:""}</h2>
            <h3>ROS CONDENSED</h3>
          </div>
          
          <div class="event-info">
            <p><strong>Event:</strong> ${s?.name||"Current Event"} | 
               <strong>Date:</strong> ${s?.date||"Not specified"} | 
               <strong>Location:</strong> ${s?.location||"Not specified"} | 
               <strong>Start Time:</strong> ${u||"Not set"} | 
               <strong>Total Items:</strong> ${o.length}</p>
          </div>
          
          <table>
            <thead>
              <tr>
                <th>CUE</th>
                <th>START</th>
                <th>DURATION</th>
                <th>SEGMENT</th>
                <th>SHOT TYPE</th>
                <th>PPT/Q&A</th>
                <th>PARTICIPANTS</th>
              </tr>
            </thead>
            <tbody>
      `;return M.forEach((O,U)=>{const ee=o.findIndex(ae=>ae.id===O.id),I=S(ee),ie=`${O.durationHours.toString().padStart(2,"0")}:${O.durationMinutes.toString().padStart(2,"0")}:${O.durationSeconds.toString().padStart(2,"0")}`;k(O.programType||"");let oe="";if(O.speakersText)try{oe=JSON.parse(O.speakersText).map(fe=>fe.fullName||fe.name||fe).join(`
`)}catch{oe=O.speakersText}let X="";O.hasPPT&&O.hasQA?X="PPT + Q&A":O.hasPPT?X="PPT":O.hasQA?X="Q&A":X="",re+=`
          <tr style="background-color: ${w(O.programType)};">
            <td>${O.programType==="Sub Cue"?`<span style="background-color: #9CA3AF; color: white; padding: 2px 6px; border-radius: 4px; font-weight: bold;">${O.customFields?.cue||""}</span>`:O.programType==="Podium"||O.programType==="Podium Transition"?`<span style="background-color: #8B4513; color: white; padding: 2px 6px; border-radius: 4px; font-weight: bold;">${O.customFields?.cue||""}</span>`:O.programType==="Panel"||O.programType==="Panel Transition"?`<span style="background-color: #404040; color: white; padding: 2px 6px; border-radius: 4px; font-weight: bold;">${O.customFields?.cue||""}</span>`:O.customFields?.cue||""}</td>
            <td>${I}</td>
            <td>${ie}</td>
            <td>${O.segmentName||"Untitled Segment"}</td>
            <td>${O.shotType||""}</td>
            <td>${X}</td>
            <td style="white-space: pre-line;">${oe}</td>
          </tr>
        `}),re+=`
            </tbody>
          </table>
          
          <div class="footer">
            <p>Generated: ${new Date().toLocaleString()} | Run of Show Application</p>
          </div>
        </body>
        </html>
      `,re}},F=()=>{const C=E(),M=window.open("","_blank");M&&(M.document.write(C),M.document.close(),M.focus(),M.print())},B=()=>{const C=E(),M=new Blob([C],{type:"text/html"}),re=URL.createObjectURL(M),O=document.createElement("a");O.href=re,O.download=`ros-${m==="showfile"?"show-file":"condensed"}${s?.numberOfDays&&s.numberOfDays>1?`-day-${v}`:""}-${s?.name?.replace(/\s+/g,"-")||"event"}-${new Date().toISOString().split("T")[0]}.html`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(re)};return c.jsxs("div",{className:"min-h-screen bg-slate-900 text-white pt-16",children:[c.jsx("div",{className:"bg-slate-800 border-b border-slate-700",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex items-center justify-between h-16",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{onClick:()=>{window.close()},className:"text-slate-300 hover:text-white transition-colors mr-6",children:"← Back to Run of Show"}),c.jsx("h1",{className:"text-xl font-semibold",children:"Reports and Printing"})]}),c.jsx("div",{className:"text-slate-400",children:s?.name||"Event"})]})})}),c.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"bg-slate-800 rounded-xl p-8 shadow-2xl",children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Generate Reports"}),c.jsxs("div",{className:"bg-slate-700 rounded-lg p-6 mb-8",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Report Options"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Report Type"}),c.jsxs("select",{value:m,onChange:C=>p(C.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"showfile",children:"ROS Show File"}),c.jsx("option",{value:"condensed",children:"ROS CONDENSED"})]})]}),s?.numberOfDays&&s.numberOfDays>1&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Select Day"}),c.jsx("select",{value:v,onChange:C=>y(parseInt(C.target.value)),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:Array.from({length:s.numberOfDays},(C,M)=>c.jsxs("option",{value:M+1,children:["Day ",M+1]},M+1))})]}),c.jsxs("div",{className:"text-slate-400 text-sm",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"ROS Show File:"})," Section-based format with all details and speaker photos"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"ROS CONDENSED:"})," Table format with all information"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Color Coding:"})," Sections colored by program type"]})]})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-4",children:[c.jsxs("button",{onClick:F,className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Report"]}),c.jsxs("button",{onClick:B,className:"px-6 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download Report"]})]}),c.jsxs("div",{className:"mt-8",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Report Preview"}),c.jsx("div",{className:"bg-slate-700 rounded-lg p-4 max-h-96 overflow-y-auto",children:c.jsxs("div",{className:"text-slate-300 text-sm",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Event:"})," ",s?.name||"Current Event"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Total Items:"})," ",o.length,s?.numberOfDays&&s.numberOfDays>1?` | <strong>Day ${v} Items:</strong> ${o.filter(C=>(C.day||1)===v).length}`:""]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Master Start Time:"})," ",u||"Not set"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Report Type:"})," ",m==="showfile"?"ROS Show File":"ROS CONDENSED"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Format:"})," ",m==="showfile"?"Section-based with speaker photos":"Table format"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Color Coding:"})," Sections colored by program type"]})]})})]})]})})]})},fA=()=>{const t=jn(),r=new URLSearchParams(t.search),e=r.get("eventId"),n=r.get("eventName"),s=r.get("eventDate"),o=r.get("eventLocation"),l=t.state?.event||{id:e||"",name:n||"Current Event",date:s||"",location:o||"",numberOfDays:1},[u,f]=j.useState([]),[m,p]=j.useState(new Date),[v,y]=j.useState(!0),[S,k]=j.useState(null),[w,E]=j.useState(null),[F,B]=j.useState({}),[C,M]=j.useState(null),[re,O]=j.useState({}),[U,ee]=j.useState("09:00"),[I,ie]=j.useState({}),oe=le=>{if(console.log(`🔄 calculateStartTime called for index ${le}:`,{masterStartTime:U,scheduleLength:u.length}),!U)return console.log("❌ No master start time, returning empty string"),"";let te=0;for(let Y=0;Y<le;Y++){const xe=u[Y],Pe=xe.durationHours*60+xe.durationMinutes;te+=Pe,console.log(`  Item ${Y} (${xe.segmentName}): ${xe.durationHours}h ${xe.durationMinutes}m = ${Pe} total minutes`)}const[pe,A]=U.split(":").map(Number),N=pe*60+A,L=N+te,V=Math.floor(L/60),q=L%60,ce=V>=12?"PM":"AM";let J=V;V>12&&(J=V-12),V===0&&(J=12);const he=`${J}:${q.toString().padStart(2,"0")} ${ce}`;return console.log(`🔄 calculateStartTime result for index ${le}:`,{masterStartTime:U,totalMinutes:te,totalStartMinutes:N,finalMinutes:L,hours:V,minutes:q,period:ce,displayHours:J,result:he}),he};j.useEffect(()=>{if(l?.id){console.log("🔍 Loading master start time for event ID:",l.id);const le=localStorage.getItem(`masterStartTime_${l.id}`),te=localStorage.getItem(`dayStartTimes_${l.id}`);if(console.log("🔍 Raw localStorage values:",{masterStartTime:le,dayStartTimes:te,eventId:l.id}),le)ee(le),console.log("📥 Loaded master start time from localStorage:",le);else{console.log("❌ No master start time found in localStorage for event:",l.id),console.log("🔍 Available localStorage keys:",Object.keys(localStorage).filter(L=>L.includes("masterStartTime"))),console.log("🔍 All localStorage keys:",Object.keys(localStorage));const pe=Object.keys(localStorage).filter(L=>L.includes("masterStartTime")).map(L=>({key:L,value:localStorage.getItem(L)}));console.log("🔍 All master start times in localStorage:",pe);let A=null;const N=pe.find(L=>L.value&&L.value!=="09:00");N?(A=N,console.log("📥 Found non-default master start time:",N.value)):(A=pe.find(L=>L.value),console.log("📥 Using first available master start time:",A?.value)),A&&A.value?(console.log("📥 Setting master start time to:",A.value),ee(A.value)):(console.log("❌ No suitable master start time found in localStorage"),console.log("🔍 Will try to get master start time from Supabase data..."))}te?(ie(JSON.parse(te)),console.log("📥 Loaded day start times from localStorage:",JSON.parse(te))):console.log("❌ No day start times found in localStorage for event:",l.id)}},[l?.id]),j.useEffect(()=>{const le=setInterval(()=>{p(new Date)},1e3);return()=>clearInterval(le)},[]);const X=async()=>{if(l?.id)try{console.log("🔄 Loading active timer for Green Room...");const le=await Ge.getActiveTimer(l.id);le?(console.log("🔄 Active timer found:",le),console.log("🔄 Timer state:",le.timer_state),console.log("🔄 Item ID:",le.item_id),E(le.item_id),M(le.timer_state),O({[le.item_id]:!0}),console.log("🔄 Set loaded items:",{[le.item_id]:!0}),B({[le.item_id]:{elapsed:le.elapsed_seconds||0,total:le.duration_seconds||0,startedAt:le.started_at?new Date(le.started_at):null}})):(console.log("🔄 No active timer found"),E(null),M(null),O({}),B({}))}catch(le){console.error("❌ Error loading active timer:",le)}};j.useEffect(()=>{if(!l?.id)return;X();const le=setInterval(X,2e3);return()=>clearInterval(le)},[l?.id]);const ae=async()=>{if(!l?.id){k("No event selected"),y(!1);return}try{console.log("🔄 Loading schedule for Green Room..."),console.log("🔄 Event details:",{id:l.id,name:l.name,location:l.location});const le=await Ge.getRunOfShowData(l.id);if(console.log("🔄 Raw data received:",le),le&&le.settings&&le.settings.masterStartTime&&U==="09:00"&&(console.log("📥 Found master start time in Supabase data:",le.settings.masterStartTime),ee(le.settings.masterStartTime)),le?.schedule_items){console.log("🔄 Total schedule items found:",le.schedule_items.length);const pe=le.schedule_items.map((A,N)=>{const L=(A.durationHours||0)*60+(A.durationMinutes||0)+(A.durationSeconds||0)/60,V=L>0?`${Math.round(L)} min`:"0 min",q=oe(N);let ce=null;if(console.log(`🔄 Calculated start time for ${A.segmentName} (index ${N}):`,{index:N,startTime:q,masterStartTime:U,duration:L,itemDurationHours:A.durationHours,itemDurationMinutes:A.durationMinutes,itemDurationSeconds:A.durationSeconds}),q&&L>0){const J=new Date(`1970-01-01 ${q}`);ce=new Date(J.getTime()+L*6e4).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0})}else ce="TBD";return{...A,startTime:q,endTime:ce,duration:V,isPublic:A.isPublic||!1}}).filter(A=>A.isPublic===!0);console.log("🔄 Public items found after time calculation:",pe.length),pe.sort((A,N)=>{if(A.startTime&&A.startTime!=="TBD"&&N.startTime&&N.startTime!=="TBD"){const L=new Date(`1970-01-01 ${A.startTime}`),V=new Date(`1970-01-01 ${N.startTime}`);return L.getTime()-V.getTime()}return(!A.startTime||A.startTime==="TBD")&&N.startTime&&N.startTime!=="TBD"?1:A.startTime&&A.startTime!=="TBD"&&(!N.startTime||N.startTime==="TBD")?-1:0}),f(pe),console.log("✅ Schedule loaded for Green Room:",pe)}else k("No schedule data found")}catch(le){console.error("❌ Error loading schedule:",le),k("Failed to load schedule data")}finally{y(!1)}};j.useEffect(()=>{ae()},[l?.id]),j.useEffect(()=>{if(!l?.id)return;console.log("🔄 Starting 20-second schedule polling for Green Room...");const le=setInterval(()=>{console.log("🔄 Polling for schedule changes (every 20s)..."),ae()},2e4);return()=>{console.log("🔄 Clearing 20-second schedule polling for Green Room..."),clearInterval(le)}},[l?.id]);const fe=(()=>{const le=w?u.findIndex(A=>String(A.id)===String(w)):-1;console.log("🔄 Modifying schedule visibility:",{totalScheduleItems:u.length,currentIndex:le,activeItemId:w,activeItemIdType:typeof w,scheduleItemIds:u.map(A=>({id:A.id,idType:typeof A.id,name:A.segmentName})),originalSchedule:u.map(A=>({id:A.id,name:A.segmentName,isPublic:A.isPublic}))});const te=u.map((A,N)=>le>=0&&N<le?{...A,isPublic:!1}:A),pe=te.filter(A=>A.isPublic===!0);return console.log("🔄 Modified schedule:",{modifiedSchedule:te.map(A=>({id:A.id,name:A.segmentName,isPublic:A.isPublic})),visibleItems:pe.map(A=>({id:A.id,name:A.segmentName}))}),pe})(),me=()=>{if(!w||!F[w])return"No Timer";const le=F[w];return le.startedAt?new Date(le.startedAt.getTime()+le.total*1e3).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0}):"Not Started"},Te=()=>{if(!w||!F[w])return"00:00";const le=F[w],te=le.total-le.elapsed,pe=te<0,A=Math.abs(te),N=Math.floor(A/60),L=Math.floor(A%60),V=`${N.toString().padStart(2,"0")}:${L.toString().padStart(2,"0")}`;return pe?`-${V}`:V},be=()=>{if(!w||!F[w])return!1;const le=F[w];return le.total-le.elapsed<0};return v?c.jsxs("div",{className:"w-full h-screen flex items-center justify-center relative",style:{aspectRatio:"9/16"},children:[c.jsxs("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover",style:{objectFit:"cover"},children:[c.jsx("source",{src:"/pointed_crop_loop.webm",type:"video/webm"}),"Your browser does not support the video tag."]}),c.jsx("div",{className:"text-white text-xl relative z-10 bg-black/50 px-4 py-2 rounded",children:"Loading Green Room..."})]}):S?c.jsxs("div",{className:"w-full h-screen flex items-center justify-center relative",style:{aspectRatio:"9/16"},children:[c.jsxs("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover",style:{objectFit:"cover"},children:[c.jsx("source",{src:"/pointed_crop_loop.webm",type:"video/webm"}),"Your browser does not support the video tag."]}),c.jsx("div",{className:"text-red-400 text-xl relative z-10 bg-black/50 px-4 py-2 rounded",children:S})]}):c.jsxs("div",{className:"w-full h-screen text-white overflow-hidden relative",style:{aspectRatio:"9/16"},children:[c.jsxs("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover",style:{objectFit:"cover"},children:[c.jsx("source",{src:"/pointed_crop_loop.webm",type:"video/webm"}),"Your browser does not support the video tag."]}),c.jsxs("div",{className:"relative z-10",children:[c.jsxs("div",{className:"p-6 flex items-center",children:[c.jsx("div",{className:"text-white font-bold flex-1 text-center",style:{fontSize:"clamp(2rem, 6vw, 4rem)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"1.1",marginRight:"20px"},children:l?.name||"Current Event"}),c.jsxs("div",{className:`rounded-lg p-4 text-center flex-shrink-0 ${be()?"bg-red-800":"bg-red-600"}`,children:[c.jsx("div",{className:"text-white text-lg font-semibold mb-2",children:be()?"OVER TIME":"Stage Timer"}),c.jsx("div",{className:`text-4xl font-bold mb-2 ${be()?"text-red-200":"text-white"}`,children:Te()}),c.jsxs("div",{className:"text-white text-sm",children:["Expected Finish: ",me()]})]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto p-6 max-h-[calc(100vh-200px)] [&::-webkit-scrollbar]:hidden",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:c.jsx("div",{className:"space-y-4",children:fe.length===0?c.jsx("div",{className:"text-center text-gray-400 text-lg py-12",children:"No public schedule items available"}):c.jsx(c.Fragment,{children:fe.slice(0,8).map((le,te)=>{const pe=re[le.id],A=C==="running"&&String(w)===String(le.id),N=String(w)===String(le.id);return console.log(`🔄 Item ${le.id} (${le.segmentName}):`,{isLoaded:pe,isRunning:A,isActive:N,timerState:C,activeItemId:w,loadedItems:re}),c.jsxs("div",{className:`p-4 rounded-lg transition-all duration-300 ${pe?A?"bg-red-600 text-white":"bg-green-600 text-white":"bg-gray-300 text-gray-700"}`,children:[c.jsx("div",{className:"font-bold text-xl mb-2 uppercase",children:le.segmentName}),c.jsxs("div",{className:"text-sm space-y-1",children:[c.jsxs("div",{children:["Start: ",le.startTime]}),c.jsxs("div",{children:["End: ",le.endTime]})]})]},le.id)})})})})]})]})},hA=()=>{const t=jn(),r=new URLSearchParams(t.search),e=r.get("eventId"),n=r.get("eventName"),s=r.get("eventDate"),o=r.get("eventLocation"),l=t.state?.event||{id:e||"",name:n||"Current Event",date:s||"",location:o||"",numberOfDays:1},[u,f]=j.useState([]),[m,p]=j.useState(new Date),[v,y]=j.useState(!0),[S,k]=j.useState(null),[w,E]=j.useState(null),[F,B]=j.useState({}),[C,M]=j.useState(null),[re,O]=j.useState({}),[U,ee]=j.useState("09:00"),[I,ie]=j.useState(20),[oe,X]=j.useState(!1),[ae,fe]=j.useState(!1),[me,Te]=j.useState({}),[be,le]=j.useState({}),[te,pe]=j.useState(null),A=we=>we?we.includes("CUE ")?we:we.replace(/^CUE(\d+)$/,"CUE $1"):"CUE",N=we=>{if(isNaN(we)||we===void 0||we===null)return console.warn("⚠️ formatTime received invalid value:",we),"00:00:00";const Fe=we<0,Oe=Math.abs(we),Ae=Math.floor(Oe/3600),at=Math.floor(Oe%3600/60),St=Math.floor(Oe%60);return`${Fe?"-":""}${Ae.toString().padStart(2,"0")}:${at.toString().padStart(2,"0")}:${St.toString().padStart(2,"0")}`},L=()=>{const we=Object.keys(be);if(we.length>0){const Fe=parseInt(we[0]);if(F[Fe]){const Oe=F[Fe];return Oe.total-Oe.elapsed}}if(w&&F[w]){const Fe=F[w];return Fe.total-Fe.elapsed}return 0},V=()=>{const we=Object.keys(be);if(we.length>0){const Fe=parseInt(we[0]);if(F[Fe]){const Oe=F[Fe],Ae=Oe.total-Oe.elapsed;return Oe.total>0?Ae/Oe.total*100:0}}if(w&&F[w]){const Fe=F[w],Oe=Fe.total-Fe.elapsed;return Fe.total>0?Oe/Fe.total*100:0}return 0},q=()=>{const we=Object.keys(be);if(we.length>0){const Fe=parseInt(we[0]);if(F[Fe]){const Oe=F[Fe],Ae=Oe.total-Oe.elapsed;return Ae>120?"#10b981":Ae>30?"#f59e0b":"#ef4444"}}if(w&&F[w]){const Fe=F[w],Oe=Fe.total-Fe.elapsed;return Oe>120?"#10b981":Oe>30?"#f59e0b":"#ef4444"}return"#10b981"},ce=()=>{const we=Object.keys(be);if(we.length>0){const Fe=parseInt(we[0]);if(F[Fe]){const Oe=F[Fe],Ae=Oe.total-Oe.elapsed;return Ae>120?"#10b981":Ae>30?"#f59e0b":"#ef4444"}}if(w&&F[w]){const Fe=F[w],Oe=Fe.total-Fe.elapsed;return Oe>120?"#10b981":Oe>30?"#f59e0b":"#ef4444"}return"#10b981"};console.log("🔍 PhotoView Status Debug:",{activeTimersKeys:Object.keys(be),activeTimers:be,activeItemId:w,timerProgress:w?F[w]:null,scheduleLength:u.length,runningItem:Object.keys(be).length>0?u.find(we=>be[we.id]):null,loadedItem:w?u.find(we=>we.id===w):null,loadedItemCue:w?u.find(we=>we.id===w)?.customFields?.cue:null,allItemsCues:u.map(we=>({id:we.id,cue:we.customFields?.cue})),secondaryTimer:te,secondaryTimerActive:te?.isActive,secondaryTimerCue:te?.cue});const J=we=>{if(isNaN(we)||we===void 0||we===null)return"00:00";const Fe=we<0,Oe=Math.abs(we),Ae=Math.floor(Oe/3600),at=Math.floor(Oe%3600/60),St=Oe%60,wt=Fe?"-":"";return Ae>0?`${wt}${Ae.toString().padStart(2,"0")}:${at.toString().padStart(2,"0")}:${St.toString().padStart(2,"0")}`:`${wt}${at.toString().padStart(2,"0")}:${St.toString().padStart(2,"0")}`},he=we=>{if(!U)return"";let Fe=0;for(let At=0;At<we;At++){const Ht=u[At],Zt=Ht.durationHours*60+Ht.durationMinutes;Fe+=Zt}const[Oe,Ae]=U.split(":").map(Number),St=Oe*60+Ae+Fe,wt=Math.floor(St/60),Et=St%60,Vt=wt>=12?"PM":"AM";let kt=wt;return wt>12&&(kt=wt-12),wt===0&&(kt=12),`${kt}:${Et.toString().padStart(2,"0")} ${Vt}`};j.useEffect(()=>{if(l?.id){const we=localStorage.getItem(`masterStartTime_${l.id}`);we&&ee(we)}},[l?.id]),j.useEffect(()=>{const we=setInterval(()=>{p(new Date)},1e3);return()=>clearInterval(we)},[]),j.useEffect(()=>{if(ae||oe)return;const we=setInterval(()=>{ie(Fe=>Fe<=1?(X(!0),setTimeout(()=>{X(!1),ie(20)},3e3),0):Fe-1)},1e3);return()=>clearInterval(we)},[ae,oe]);const Y=async()=>{if(l?.id){console.log("🟠 Polling for sub-cue timer...");try{const{data:we}=await Ge.hasActiveSubCueTimer(l.id);if(!we){console.log("🟠 No active sub-cue timer found, clearing local state"),pe(null);return}const{data:Fe,error:Oe}=await Ge.getActiveSubCueTimer(l.id);if(console.log("🟠 Sub-cue timer data from Supabase:",Fe),Oe){console.error("❌ Error loading sub-cue timer:",Oe);return}if(Fe&&Fe.is_active&&Fe.is_running){console.log("🟠 Sub-cue timer loaded:",Fe.item_id,"Duration:",Fe.duration_seconds,"s","Active:",Fe.is_active,"Running:",Fe.is_running);const Ae=parseInt(Fe.item_id),at=new Date(Fe.started_at),wt=Math.floor((new Date().getTime()-at.getTime())/1e3),Et=Math.max(0,Fe.duration_seconds-wt),Vt=u.find(kt=>kt.id===Ae);pe({itemId:Ae,remaining:Et,duration:Fe.duration_seconds,isActive:!0,startedAt:at,timerState:"running",cue:Vt?.customFields?.cue||"CUE",segmentName:Vt?.segmentName||""}),console.log("🟠 Set secondaryTimer state for PhotoView:",{itemId:Ae,remaining:Et,duration:Fe.duration_seconds,cue:Vt?.customFields?.cue||"CUE",segmentName:Vt?.segmentName||""})}else console.log("🟠 Sub-cue timer found but not active or not running, clearing local state"),pe(null)}catch(we){console.error("❌ Error loading sub-cue timer:",we),pe(null)}}},xe=async()=>{if(l?.id)try{console.log("🔄 Loading active timer for PhotoView...");const we=await Ge.getActiveTimer(l.id);if(we){console.log("🔄 Active timer found:",we),console.log("🔄 Timer state:",we.timer_state),console.log("🔄 Item ID:",we.item_id),E(parseInt(we.item_id)),M(we.timer_state),O({[parseInt(we.item_id)]:!0}),we.timer_state==="running"?le({[parseInt(we.item_id)]:!0}):le({});const Fe=we.elapsed_seconds||0,Oe=we.started_at?new Date(we.started_at):null;B({[parseInt(we.item_id)]:{elapsed:Fe,total:we.duration_seconds||0,startedAt:Oe}})}else console.log("🔄 No active timer found"),E(null),M(null),O({}),B({}),le({}),pe(null),Te({})}catch(we){console.error("❌ Error loading active timer:",we)}};j.useEffect(()=>{if(!l?.id)return;xe();const we=setInterval(xe,1e3);return()=>clearInterval(we)},[l?.id]),j.useEffect(()=>{if(!l?.id)return;const we=async()=>{try{await Y()}catch(Oe){console.warn("⚠️ Error syncing sub-cue timers:",Oe)}};we();const Fe=setInterval(we,1e3);return()=>clearInterval(Fe)},[l?.id,u]),j.useEffect(()=>{if(!te)return;const we=setInterval(()=>{pe(Fe=>{if(!Fe)return null;const Oe=Fe.startedAt?.getTime()||Date.now(),Ae=Math.floor((Date.now()-Oe)/1e3),at=Math.max(0,Fe.duration-Ae);return{...Fe,remaining:at}})},1e3);return()=>clearInterval(we)},[te]),j.useEffect(()=>{(async()=>{if(console.log("=== PHOTO VIEW PAGE INITIALIZATION ==="),!l?.id&&!e){k("No event selected"),y(!1);return}try{if(l?.id||e){console.log("🔄 Loading from Supabase for event:",l?.id||e);const Oe=await Ge.getRunOfShowData(l?.id||e);if(Oe?.schedule_items){console.log("✅ Loaded from Supabase:",Oe);const Ae=Oe.schedule_items.map(at=>({...at,isPublic:at.isPublic||!1}));f(Ae),y(!1);return}}console.log("📱 Falling back to localStorage...");let Fe=null;if(l?.id||e){const Oe=`runOfShowSchedule_${l?.id||e}`;Fe=localStorage.getItem(Oe)}if(!Fe){const Ae=Object.keys(localStorage).filter(at=>at.startsWith("runOfShowSchedule_"));if(Ae.length>0){const at=Ae[Ae.length-1];Fe=localStorage.getItem(at)}}if(Fe){const Oe=JSON.parse(Fe);console.log("📱 Loaded from localStorage:",Oe),f(Oe)}else console.log("⚠️ No schedule data found, creating sample data for testing"),f([{id:1,day:1,programType:"PreShow/End",shotType:"Wide",segmentName:"Welcome & Opening",durationHours:0,durationMinutes:5,durationSeconds:0,notes:"Welcome everyone to the event",assets:"",speakers:"",speakersText:"",hasPPT:!0,hasQA:!1,timerId:"",customFields:{cue:"CUE1"},isPublic:!0},{id:2,day:1,programType:"Podium Transition",shotType:"Medium",segmentName:"Keynote Speaker",durationHours:0,durationMinutes:15,durationSeconds:0,notes:"Main keynote presentation",assets:"",speakers:"",speakersText:"",hasPPT:!0,hasQA:!0,timerId:"",customFields:{cue:"CUE2"},isPublic:!0},{id:3,day:1,programType:"Panel Transition",shotType:"Two Shot",segmentName:"Panel Discussion",durationHours:0,durationMinutes:30,durationSeconds:0,notes:"Interactive panel discussion",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!0,timerId:"",customFields:{cue:"CUE3"},isPublic:!0}]),console.log("✅ Using sample data for testing")}catch(Fe){console.error("❌ Error loading schedule:",Fe),k("Failed to load schedule data")}finally{y(!1)}})()},[l?.id,e]);const K=(()=>{if(console.log("🔍 getPreviewItems called"),console.log("Schedule length:",u.length),console.log("Active item ID:",w),console.log("Active item ID type:",typeof w),u.length===0)return console.log("No schedule items available"),[];const we=w?u.findIndex(Ae=>String(Ae.id)===String(w)):-1;if(console.log("Current index:",we),we===-1)return console.log("No active item or not found, showing first 3 items"),u.slice(0,3);const Fe=Math.min(we+3,u.length),Oe=u.slice(we,Fe);return console.log("Showing items from index",we,"to",Fe-1,":",Oe.length,"items"),console.log("Items:",Oe.map(Ae=>({id:Ae.id,name:Ae.segmentName}))),Oe})();console.log("Preview items:",K);const Xe={"Podium Transition":"#8B4513","Panel Transition":"#404040","Sub Cue":"#F3F4F6","No Transition":"#059669",Video:"#F59E0B","Panel+Remote":"#1E40AF","Remote Only":"#60A5FA",Break:"#EC4899",TBD:"#6B7280",KILLED:"#DC2626",Podium:"#8B4513",Panel:"#404040","PreShow/End":"#8B5CF6"};return v?c.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:c.jsx("div",{className:"text-white text-xl",children:"Loading PhotoView..."})}):S?c.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:c.jsx("div",{className:"text-red-400 text-xl",children:S})}):c.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-6",children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex justify-between items-start mb-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold",children:l?.name||"Current Event"}),c.jsx("div",{className:"text-sm text-gray-300 mt-1",children:m.toLocaleTimeString()})]}),c.jsxs("div",{className:"flex items-center space-x-6",children:[c.jsx("div",{className:"text-center",children:Object.keys(be).length>0?c.jsxs("div",{className:"text-lg text-green-400 font-bold",children:["RUNNING - ",A(u.find(we=>be[we.id])?.customFields.cue),te&&te.isActive&&c.jsxs("div",{className:"text-lg text-orange-400 mt-0.5 font-bold",children:[A(te.cue)," - ",J(te.remaining)]})]}):w&&F[w]?c.jsxs("div",{className:"text-lg text-yellow-400 font-bold",children:["LOADED - ",A(u.find(we=>we.id===w)?.customFields.cue)]}):c.jsx("div",{className:"text-lg text-slate-300 font-bold",children:"No CUE Selected"})}),c.jsx("div",{className:"relative",children:c.jsx("div",{className:"text-3xl font-mono bg-slate-800 px-6 py-3 rounded-lg border border-slate-600",style:{color:ce()},children:N(L())})})]})]}),w&&F[w]&&c.jsx("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border border-slate-600 relative h-2",children:c.jsx("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${V()}%`,background:q()}})})]}),c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsx("div",{className:"bg-slate-700 border border-slate-600",children:c.jsxs("div",{className:"grid grid-cols-11 gap-0",children:[c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"CUE"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"TIME"}),c.jsx("div",{className:"col-span-2 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SEGMENT INFO"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 1"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 2"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 3"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 4"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 5"}),c.jsx("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 6"}),c.jsx("div",{className:"col-span-1 bg-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 7"})]})}),K.length===0?c.jsx("div",{className:"text-center text-gray-400 text-xl py-12 bg-slate-800 border border-slate-600 border-t-0",children:"No schedule items available"}):K.map((we,Fe)=>{const Oe=String(w)===String(we.id);re[we.id];const Ae=C==="running"&&Oe,at=we.isIndented||!1,St=u.findIndex(Ct=>Ct.id===we.id),wt=he(St),Et=`${we.durationHours.toString().padStart(2,"0")}:${we.durationMinutes.toString().padStart(2,"0")}:${we.durationSeconds.toString().padStart(2,"0")}`,Vt=[];we.hasPPT&&Vt.push("PPT"),we.hasQA&&Vt.push("Q&A");const kt=Vt.length>0?Vt.join("/"):"None";return c.jsxs("div",{className:`${at?"border-4 border-orange-400":Oe?Ae?"border-4 border-green-400":"border-4 border-blue-400":"border border-slate-600"}`,children:[c.jsxs("div",{className:`grid grid-cols-11 gap-0 ${at?"bg-amber-950":Oe?Ae?"bg-green-950":"bg-blue-950":"bg-slate-900"}`,children:[c.jsx("div",{className:"col-span-1 border-r border-slate-600 p-3",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-sm font-bold mb-1",children:we.customFields?.cue||`CUE ${St+1}`}),c.jsx("div",{className:"inline-block px-3 py-1 rounded text-xs font-medium text-white border",style:{backgroundColor:Xe[we.programType]||"#6B7280",color:we.programType==="Sub Cue"?"black":"white",borderColor:we.programType==="Sub Cue"?"black":"transparent"},children:we.programType||"Unknown"})]})}),c.jsx("div",{className:"col-span-1 border-r border-slate-600 p-3",children:c.jsxs("div",{className:"text-center text-xs",children:[c.jsxs("div",{className:"mb-1",children:[c.jsx("span",{className:"text-gray-400",children:"Start:"}),c.jsx("div",{className:"font-bold",children:wt||"No Time"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-400",children:"Dur:"}),c.jsx("div",{className:"font-bold",children:Et})]})]})}),c.jsx("div",{className:"col-span-2 border-r border-slate-600 p-3",children:c.jsxs("div",{className:"text-xs",children:[c.jsxs("div",{className:"mb-1",children:[c.jsx("span",{className:"text-gray-400",children:"SEGMENT:"}),c.jsx("span",{className:"ml-1 font-bold",children:St+1})]}),c.jsxs("div",{className:"mb-1",children:[c.jsx("span",{className:"text-gray-400",children:"SHOT:"}),c.jsx("span",{className:"ml-1 font-bold",children:we.shotType||"Not specified"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-400",children:"PPT/Q&A:"}),c.jsx("span",{className:"ml-1 font-bold",children:kt})]})]})}),[1,2,3,4,5,6,7].map(Ct=>{let At=null;if(we.speakersText)try{const Ht=JSON.parse(we.speakersText);Array.isArray(Ht)&&(At=Ht.find(Zt=>Zt.slot===Ct))}catch(Ht){console.log("Error parsing speakers:",Ht)}return c.jsx("div",{className:`col-span-1 ${Ct<7?"border-r border-slate-600":""} p-2`,children:At?c.jsxs("div",{className:"text-center",children:[At.photoLink&&c.jsx("div",{className:"mb-2",children:c.jsx("img",{src:At.photoLink,alt:At.fullName,className:"w-20 h-12 rounded-lg mx-auto object-cover border-2 border-slate-400",onError:Ht=>{Ht.currentTarget.style.display="none"}})}),c.jsx("div",{className:"text-sm font-medium text-white truncate mb-1",children:At.fullName||"Unnamed"}),c.jsx("div",{className:"text-xs text-gray-300 font-medium",children:At.location==="Podium"?"Podium":At.location==="Seat"?"Seat":At.location==="Virtual"?"Virtual":At.location==="Moderator"?"Moderator":At.location||"Unknown"})]}):c.jsx("div",{className:"text-center text-xs text-gray-500"})},Ct)})]}),c.jsxs("div",{className:`border-t border-slate-600 p-4 ${at?"bg-amber-950":Oe?Ae?"bg-green-950":"bg-blue-950":"bg-slate-800"}`,children:[c.jsx("div",{className:"text-gray-400 text-sm mb-2 font-bold",children:"NOTES:"}),c.jsx("div",{className:"text-sm text-white",children:we.notes||"None"})]}),Fe<K.length-1&&c.jsx("div",{className:"border-t-2 border-slate-500"})]},we.id)})]})]})};function mA(){const t=jn(),r=t.pathname==="/fullscreen-timer",e=t.pathname==="/green-room",n=t.pathname==="/photo-view";return c.jsx("div",{className:"App",children:c.jsxs(eS,{children:[!r&&!e&&!n&&c.jsx(Uf,{})," ",c.jsxs(mw,{children:[c.jsx(Ga,{path:"/",element:c.jsx(tS,{})}),c.jsx(Ga,{path:"/run-of-show",element:c.jsx(oA,{})}),c.jsx(Ga,{path:"/fullscreen-timer",element:c.jsx(cA,{})}),c.jsx(Ga,{path:"/graphics-links",element:c.jsx(uA,{})}),c.jsx(Ga,{path:"/reports",element:c.jsx(dA,{})}),c.jsx(Ga,{path:"/green-room",element:c.jsx(fA,{})}),c.jsx(Ga,{path:"/photo-view",element:c.jsx(hA,{})})]})]})})}function gA(){return c.jsx(Y_,{children:c.jsx(Lw,{children:c.jsx(mA,{})})})}const pA=Ey.createRoot(document.getElementById("root"));pA.render(c.jsx(ed.StrictMode,{children:c.jsx(gA,{})}));
