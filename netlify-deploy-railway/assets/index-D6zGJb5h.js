(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const d of i)if(d.type==="childList")for(const c of d.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function e(i){const d={};return i.integrity&&(d.integrity=i.integrity),i.referrerPolicy&&(d.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?d.credentials="include":i.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(i){if(i.ep)return;i.ep=!0;const d=e(i);fetch(i.href,d)}})();function BE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var cb={exports:{}},oh={},ub={exports:{}},Df={exports:{}};Df.exports;var gO;function NU(){return gO||(gO=1,(function(t,n){/**
 * @license React
 * react.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e="18.3.1",s=Symbol.for("react.element"),i=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),g=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen"),U=Symbol.iterator,q="@@iterator";function G(B){if(B===null||typeof B!="object")return null;var me=U&&B[U]||B[q];return typeof me=="function"?me:null}var _={current:null},ne={transition:null},ee={current:null,isBatchingLegacy:!1,didScheduleLegacyUpdate:!1},Q={current:null},z={},ce=null;function S(B){ce=B}z.setExtraStackFrame=function(B){ce=B},z.getCurrentStack=null,z.getStackAddendum=function(){var B="";ce&&(B+=ce);var me=z.getCurrentStack;return me&&(B+=me()||""),B};var A=!1,W=!1,H=!1,K=!1,Oe=!1,ye={ReactCurrentDispatcher:_,ReactCurrentBatchConfig:ne,ReactCurrentOwner:Q};ye.ReactDebugCurrentFrame=z,ye.ReactCurrentActQueue=ee;function Pe(B){{for(var me=arguments.length,Le=new Array(me>1?me-1:0),Me=1;Me<me;Me++)Le[Me-1]=arguments[Me];Ge("warn",B,Le)}}function ve(B){{for(var me=arguments.length,Le=new Array(me>1?me-1:0),Me=1;Me<me;Me++)Le[Me-1]=arguments[Me];Ge("error",B,Le)}}function Ge(B,me,Le){{var Me=ye.ReactDebugCurrentFrame,st=Me.getStackAddendum();st!==""&&(me+="%s",Le=Le.concat([st]));var _t=Le.map(function(Et){return String(Et)});_t.unshift("Warning: "+me),Function.prototype.apply.call(console[B],console,_t)}}var ie={};function Ee(B,me){{var Le=B.constructor,Me=Le&&(Le.displayName||Le.name)||"ReactClass",st=Me+"."+me;if(ie[st])return;ve("Can't call %s on a component that is not yet mounted. This is a no-op, but it might indicate a bug in your application. Instead, assign to `this.state` directly or define a `state = {};` class property with the desired state in the %s component.",me,Me),ie[st]=!0}}var Ce={isMounted:function(B){return!1},enqueueForceUpdate:function(B,me,Le){Ee(B,"forceUpdate")},enqueueReplaceState:function(B,me,Le,Me){Ee(B,"replaceState")},enqueueSetState:function(B,me,Le,Me){Ee(B,"setState")}},j=Object.assign,X={};Object.freeze(X);function T(B,me,Le){this.props=B,this.context=me,this.refs=X,this.updater=Le||Ce}T.prototype.isReactComponent={},T.prototype.setState=function(B,me){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw new Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,me,"setState")},T.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};{var O={isMounted:["isMounted","Instead, make sure to clean up subscriptions and pending requests in componentWillUnmount to prevent memory leaks."],replaceState:["replaceState","Refactor your code to use setState instead (see https://github.com/facebook/react/issues/3236)."]},P=function(B,me){Object.defineProperty(T.prototype,B,{get:function(){Pe("%s(...) is deprecated in plain JavaScript React classes. %s",me[0],me[1])}})};for(var F in O)O.hasOwnProperty(F)&&P(F,O[F])}function de(){}de.prototype=T.prototype;function fe(B,me,Le){this.props=B,this.context=me,this.refs=X,this.updater=Le||Ce}var ge=fe.prototype=new de;ge.constructor=fe,j(ge,T.prototype),ge.isPureReactComponent=!0;function ze(){var B={current:null};return Object.seal(B),B}var oe=Array.isArray;function Tt(B){return oe(B)}function ft(B){{var me=typeof Symbol=="function"&&Symbol.toStringTag,Le=me&&B[Symbol.toStringTag]||B.constructor.name||"Object";return Le}}function xt(B){try{return Dt(B),!1}catch{return!0}}function Dt(B){return""+B}function Ke(B){if(xt(B))return ve("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",ft(B)),Dt(B)}function er(B,me,Le){var Me=B.displayName;if(Me)return Me;var st=me.displayName||me.name||"";return st!==""?Le+"("+st+")":Le}function wr(B){return B.displayName||"Context"}function ur(B){if(B==null)return null;if(typeof B.tag=="number"&&ve("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof B=="function")return B.displayName||B.name||null;if(typeof B=="string")return B;switch(B){case d:return"Fragment";case i:return"Portal";case f:return"Profiler";case c:return"StrictMode";case b:return"Suspense";case E:return"SuspenseList"}if(typeof B=="object")switch(B.$$typeof){case g:var me=B;return wr(me)+".Consumer";case p:var Le=B;return wr(Le._context)+".Provider";case x:return er(B,B.render,"ForwardRef");case w:var Me=B.displayName||null;return Me!==null?Me:ur(B.type)||"Memo";case R:{var st=B,_t=st._payload,Et=st._init;try{return ur(Et(_t))}catch{return null}}}return null}var ar=Object.prototype.hasOwnProperty,Ve={key:!0,ref:!0,__self:!0,__source:!0},Xe,he,Be;Be={};function Qe(B){if(ar.call(B,"ref")){var me=Object.getOwnPropertyDescriptor(B,"ref").get;if(me&&me.isReactWarning)return!1}return B.ref!==void 0}function vt(B){if(ar.call(B,"key")){var me=Object.getOwnPropertyDescriptor(B,"key").get;if(me&&me.isReactWarning)return!1}return B.key!==void 0}function St(B,me){var Le=function(){Xe||(Xe=!0,ve("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",me))};Le.isReactWarning=!0,Object.defineProperty(B,"key",{get:Le,configurable:!0})}function tr(B,me){var Le=function(){he||(he=!0,ve("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",me))};Le.isReactWarning=!0,Object.defineProperty(B,"ref",{get:Le,configurable:!0})}function $e(B){if(typeof B.ref=="string"&&Q.current&&B.__self&&Q.current.stateNode!==B.__self){var me=ur(Q.current.type);Be[me]||(ve('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',me,B.ref),Be[me]=!0)}}var tt=function(B,me,Le,Me,st,_t,Et){var Mt={$$typeof:s,type:B,key:me,ref:Le,props:Et,_owner:_t};return Mt._store={},Object.defineProperty(Mt._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(Mt,"_self",{configurable:!1,enumerable:!1,writable:!1,value:Me}),Object.defineProperty(Mt,"_source",{configurable:!1,enumerable:!1,writable:!1,value:st}),Object.freeze&&(Object.freeze(Mt.props),Object.freeze(Mt)),Mt};function Ct(B,me,Le){var Me,st={},_t=null,Et=null,Mt=null,rr=null;if(me!=null){Qe(me)&&(Et=me.ref,$e(me)),vt(me)&&(Ke(me.key),_t=""+me.key),Mt=me.__self===void 0?null:me.__self,rr=me.__source===void 0?null:me.__source;for(Me in me)ar.call(me,Me)&&!Ve.hasOwnProperty(Me)&&(st[Me]=me[Me])}var Gt=arguments.length-2;if(Gt===1)st.children=Le;else if(Gt>1){for(var xr=Array(Gt),br=0;br<Gt;br++)xr[br]=arguments[br+2];Object.freeze&&Object.freeze(xr),st.children=xr}if(B&&B.defaultProps){var Kt=B.defaultProps;for(Me in Kt)st[Me]===void 0&&(st[Me]=Kt[Me])}if(_t||Et){var jr=typeof B=="function"?B.displayName||B.name||"Unknown":B;_t&&St(st,jr),Et&&tr(st,jr)}return tt(B,_t,Et,Mt,rr,Q.current,st)}function Nt(B,me){var Le=tt(B.type,me,B.ref,B._self,B._source,B._owner,B.props);return Le}function Ot(B,me,Le){if(B==null)throw new Error("React.cloneElement(...): The argument must be a React element, but you passed "+B+".");var Me,st=j({},B.props),_t=B.key,Et=B.ref,Mt=B._self,rr=B._source,Gt=B._owner;if(me!=null){Qe(me)&&(Et=me.ref,Gt=Q.current),vt(me)&&(Ke(me.key),_t=""+me.key);var xr;B.type&&B.type.defaultProps&&(xr=B.type.defaultProps);for(Me in me)ar.call(me,Me)&&!Ve.hasOwnProperty(Me)&&(me[Me]===void 0&&xr!==void 0?st[Me]=xr[Me]:st[Me]=me[Me])}var br=arguments.length-2;if(br===1)st.children=Le;else if(br>1){for(var Kt=Array(br),jr=0;jr<br;jr++)Kt[jr]=arguments[jr+2];st.children=Kt}return tt(B.type,_t,Et,Mt,rr,Gt,st)}function kt(B){return typeof B=="object"&&B!==null&&B.$$typeof===s}var Ft=".",Lt=":";function Yt(B){var me=/[=:]/g,Le={"=":"=0",":":"=2"},Me=B.replace(me,function(st){return Le[st]});return"$"+Me}var ct=!1,nr=/\/+/g;function rn(B){return B.replace(nr,"$&/")}function An(B,me){return typeof B=="object"&&B!==null&&B.key!=null?(Ke(B.key),Yt(""+B.key)):me.toString(36)}function Cr(B,me,Le,Me,st){var _t=typeof B;(_t==="undefined"||_t==="boolean")&&(B=null);var Et=!1;if(B===null)Et=!0;else switch(_t){case"string":case"number":Et=!0;break;case"object":switch(B.$$typeof){case s:case i:Et=!0}}if(Et){var Mt=B,rr=st(Mt),Gt=Me===""?Ft+An(Mt,0):Me;if(Tt(rr)){var xr="";Gt!=null&&(xr=rn(Gt)+"/"),Cr(rr,me,xr,"",function(Sn){return Sn})}else rr!=null&&(kt(rr)&&(rr.key&&(!Mt||Mt.key!==rr.key)&&Ke(rr.key),rr=Nt(rr,Le+(rr.key&&(!Mt||Mt.key!==rr.key)?rn(""+rr.key)+"/":"")+Gt)),me.push(rr));return 1}var br,Kt,jr=0,$r=Me===""?Ft:Me+Lt;if(Tt(B))for(var Fi=0;Fi<B.length;Fi++)br=B[Fi],Kt=$r+An(br,Fi),jr+=Cr(br,me,Le,Kt,st);else{var di=G(B);if(typeof di=="function"){var ua=B;di===ua.entries&&(ct||Pe("Using Maps as children is not supported. Use an array of keyed ReactElements instead."),ct=!0);for(var Pr=di.call(ua),Dn,Eo=0;!(Dn=Pr.next()).done;)br=Dn.value,Kt=$r+An(br,Eo++),jr+=Cr(br,me,Le,Kt,st)}else if(_t==="object"){var gl=String(B);throw new Error("Objects are not valid as a React child (found: "+(gl==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":gl)+"). If you meant to render a collection of children, use an array instead.")}}return jr}function gn(B,me,Le){if(B==null)return B;var Me=[],st=0;return Cr(B,Me,"","",function(_t){return me.call(Le,_t,st++)}),Me}function ii(B){var me=0;return gn(B,function(){me++}),me}function Lr(B,me,Le){gn(B,function(){me.apply(this,arguments)},Le)}function Xr(B){return gn(B,function(me){return me})||[]}function qa(B){if(!kt(B))throw new Error("React.Children.only expected to receive a single React element child.");return B}function qt(B){var me={$$typeof:g,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null};me.Provider={$$typeof:p,_context:me};var Le=!1,Me=!1,st=!1;{var _t={$$typeof:g,_context:me};Object.defineProperties(_t,{Provider:{get:function(){return Me||(Me=!0,ve("Rendering <Context.Consumer.Provider> is not supported and will be removed in a future major release. Did you mean to render <Context.Provider> instead?")),me.Provider},set:function(Et){me.Provider=Et}},_currentValue:{get:function(){return me._currentValue},set:function(Et){me._currentValue=Et}},_currentValue2:{get:function(){return me._currentValue2},set:function(Et){me._currentValue2=Et}},_threadCount:{get:function(){return me._threadCount},set:function(Et){me._threadCount=Et}},Consumer:{get:function(){return Le||(Le=!0,ve("Rendering <Context.Consumer.Consumer> is not supported and will be removed in a future major release. Did you mean to render <Context.Consumer> instead?")),me.Consumer}},displayName:{get:function(){return me.displayName},set:function(Et){st||(Pe("Setting `displayName` on Context.Consumer has no effect. You should set it directly on the context with Context.displayName = '%s'.",Et),st=!0)}}}),me.Consumer=_t}return me._currentRenderer=null,me._currentRenderer2=null,me}var Ln=-1,xn=0,cn=1,wa=2;function Ts(B){if(B._status===Ln){var me=B._result,Le=me();if(Le.then(function(_t){if(B._status===xn||B._status===Ln){var Et=B;Et._status=cn,Et._result=_t}},function(_t){if(B._status===xn||B._status===Ln){var Et=B;Et._status=wa,Et._result=_t}}),B._status===Ln){var Me=B;Me._status=xn,Me._result=Le}}if(B._status===cn){var st=B._result;return st===void 0&&ve(`lazy: Expected the result of a dynamic import() call. Instead received: %s

Your code should look like: 
  const MyComponent = lazy(() => import('./MyComponent'))

Did you accidentally put curly braces around the import?`,st),"default"in st||ve(`lazy: Expected the result of a dynamic import() call. Instead received: %s

Your code should look like: 
  const MyComponent = lazy(() => import('./MyComponent'))`,st),st.default}else throw B._result}function pe(B){var me={_status:Ln,_result:B},Le={$$typeof:R,_payload:me,_init:Ts};{var Me,st;Object.defineProperties(Le,{defaultProps:{configurable:!0,get:function(){return Me},set:function(_t){ve("React.lazy(...): It is not supported to assign `defaultProps` to a lazy component import. Either specify them where the component is defined, or create a wrapping component around it."),Me=_t,Object.defineProperty(Le,"defaultProps",{enumerable:!0})}},propTypes:{configurable:!0,get:function(){return st},set:function(_t){ve("React.lazy(...): It is not supported to assign `propTypes` to a lazy component import. Either specify them where the component is defined, or create a wrapping component around it."),st=_t,Object.defineProperty(Le,"propTypes",{enumerable:!0})}}})}return Le}function L(B){B!=null&&B.$$typeof===w?ve("forwardRef requires a render function but received a `memo` component. Instead of forwardRef(memo(...)), use memo(forwardRef(...))."):typeof B!="function"?ve("forwardRef requires a render function but was given %s.",B===null?"null":typeof B):B.length!==0&&B.length!==2&&ve("forwardRef render functions accept exactly two parameters: props and ref. %s",B.length===1?"Did you forget to use the ref parameter?":"Any additional parameter will be undefined."),B!=null&&(B.defaultProps!=null||B.propTypes!=null)&&ve("forwardRef render functions do not support propTypes or defaultProps. Did you accidentally pass a React component?");var me={$$typeof:x,render:B};{var Le;Object.defineProperty(me,"displayName",{enumerable:!1,configurable:!0,get:function(){return Le},set:function(Me){Le=Me,!B.name&&!B.displayName&&(B.displayName=Me)}})}return me}var Z;Z=Symbol.for("react.module.reference");function J(B){return!!(typeof B=="string"||typeof B=="function"||B===d||B===f||Oe||B===c||B===b||B===E||K||B===y||A||W||H||typeof B=="object"&&B!==null&&(B.$$typeof===R||B.$$typeof===w||B.$$typeof===p||B.$$typeof===g||B.$$typeof===x||B.$$typeof===Z||B.getModuleId!==void 0))}function Y(B,me){J(B)||ve("memo: The first argument must be a component. Instead received: %s",B===null?"null":typeof B);var Le={$$typeof:w,type:B,compare:me===void 0?null:me};{var Me;Object.defineProperty(Le,"displayName",{enumerable:!1,configurable:!0,get:function(){return Me},set:function(st){Me=st,!B.name&&!B.displayName&&(B.displayName=st)}})}return Le}function ae(){var B=_.current;return B===null&&ve(`Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:
1. You might have mismatching versions of React and the renderer (such as React DOM)
2. You might be breaking the Rules of Hooks
3. You might have more than one copy of React in the same app
See https://reactjs.org/link/invalid-hook-call for tips about how to debug and fix this problem.`),B}function se(B){var me=ae();if(B._context!==void 0){var Le=B._context;Le.Consumer===B?ve("Calling useContext(Context.Consumer) is not supported, may cause bugs, and will be removed in a future major release. Did you mean to call useContext(Context) instead?"):Le.Provider===B&&ve("Calling useContext(Context.Provider) is not supported. Did you mean to call useContext(Context) instead?")}return me.useContext(B)}function xe(B){var me=ae();return me.useState(B)}function je(B,me,Le){var Me=ae();return Me.useReducer(B,me,Le)}function Se(B){var me=ae();return me.useRef(B)}function we(B,me){var Le=ae();return Le.useEffect(B,me)}function Re(B,me){var Le=ae();return Le.useInsertionEffect(B,me)}function Ue(B,me){var Le=ae();return Le.useLayoutEffect(B,me)}function Ze(B,me){var Le=ae();return Le.useCallback(B,me)}function at(B,me){var Le=ae();return Le.useMemo(B,me)}function et(B,me,Le){var Me=ae();return Me.useImperativeHandle(B,me,Le)}function lt(B,me){{var Le=ae();return Le.useDebugValue(B,me)}}function ot(){var B=ae();return B.useTransition()}function yr(B){var me=ae();return me.useDeferredValue(B)}function ir(){var B=ae();return B.useId()}function Wr(B,me,Le){var Me=ae();return Me.useSyncExternalStore(B,me,Le)}var Ar=0,Fr,Ka,zn,_s,Xn,Ai,fs;function Ps(){}Ps.__reactDisabledLog=!0;function xo(){{if(Ar===0){Fr=console.log,Ka=console.info,zn=console.warn,_s=console.error,Xn=console.group,Ai=console.groupCollapsed,fs=console.groupEnd;var B={configurable:!0,enumerable:!0,value:Ps,writable:!0};Object.defineProperties(console,{info:B,log:B,warn:B,error:B,group:B,groupCollapsed:B,groupEnd:B})}Ar++}}function Ja(){{if(Ar--,Ar===0){var B={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:j({},B,{value:Fr}),info:j({},B,{value:Ka}),warn:j({},B,{value:zn}),error:j({},B,{value:_s}),group:j({},B,{value:Xn}),groupCollapsed:j({},B,{value:Ai}),groupEnd:j({},B,{value:fs})})}Ar<0&&ve("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var Li=ye.ReactCurrentDispatcher,ms;function bo(B,me,Le){{if(ms===void 0)try{throw Error()}catch(st){var Me=st.stack.trim().match(/\n( *(at )?)/);ms=Me&&Me[1]||""}return`
`+ms+B}}var oi=!1,No;{var Do=typeof WeakMap=="function"?WeakMap:Map;No=new Do}function Vi(B,me){if(!B||oi)return"";{var Le=No.get(B);if(Le!==void 0)return Le}var Me;oi=!0;var st=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var _t;_t=Li.current,Li.current=null,xo();try{if(me){var Et=function(){throw Error()};if(Object.defineProperty(Et.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Et,[])}catch($r){Me=$r}Reflect.construct(B,[],Et)}else{try{Et.call()}catch($r){Me=$r}B.call(Et.prototype)}}else{try{throw Error()}catch($r){Me=$r}B()}}catch($r){if($r&&Me&&typeof $r.stack=="string"){for(var Mt=$r.stack.split(`
`),rr=Me.stack.split(`
`),Gt=Mt.length-1,xr=rr.length-1;Gt>=1&&xr>=0&&Mt[Gt]!==rr[xr];)xr--;for(;Gt>=1&&xr>=0;Gt--,xr--)if(Mt[Gt]!==rr[xr]){if(Gt!==1||xr!==1)do if(Gt--,xr--,xr<0||Mt[Gt]!==rr[xr]){var br=`
`+Mt[Gt].replace(" at new "," at ");return B.displayName&&br.includes("<anonymous>")&&(br=br.replace("<anonymous>",B.displayName)),typeof B=="function"&&No.set(B,br),br}while(Gt>=1&&xr>=0);break}}}finally{oi=!1,Li.current=_t,Ja(),Error.prepareStackTrace=st}var Kt=B?B.displayName||B.name:"",jr=Kt?bo(Kt):"";return typeof B=="function"&&No.set(B,jr),jr}function ji(B,me,Le){return Vi(B,!1)}function Tu(B){var me=B.prototype;return!!(me&&me.isReactComponent)}function li(B,me,Le){if(B==null)return"";if(typeof B=="function")return Vi(B,Tu(B));if(typeof B=="string")return bo(B);switch(B){case b:return bo("Suspense");case E:return bo("SuspenseList")}if(typeof B=="object")switch(B.$$typeof){case x:return ji(B.render);case w:return li(B.type,me,Le);case R:{var Me=B,st=Me._payload,_t=Me._init;try{return li(_t(st),me,Le)}catch{}}}return""}var hl={},So=ye.ReactDebugCurrentFrame;function mr(B){if(B){var me=B._owner,Le=li(B.type,B._source,me?me.type:null);So.setExtraStackFrame(Le)}else So.setExtraStackFrame(null)}function pl(B,me,Le,Me,st){{var _t=Function.call.bind(ar);for(var Et in B)if(_t(B,Et)){var Mt=void 0;try{if(typeof B[Et]!="function"){var rr=Error((Me||"React class")+": "+Le+" type `"+Et+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof B[Et]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw rr.name="Invariant Violation",rr}Mt=B[Et](me,Et,Me,Le,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Gt){Mt=Gt}Mt&&!(Mt instanceof Error)&&(mr(st),ve("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",Me||"React class",Le,Et,typeof Mt),mr(null)),Mt instanceof Error&&!(Mt.message in hl)&&(hl[Mt.message]=!0,mr(st),ve("Failed %s type: %s",Le,Mt.message),mr(null))}}}function Us(B){if(B){var me=B._owner,Le=li(B.type,B._source,me?me.type:null);S(Le)}else S(null)}var jt;jt=!1;function Gn(){if(Q.current){var B=ur(Q.current.type);if(B)return`

Check the render method of \``+B+"`."}return""}function Vn(B){if(B!==void 0){var me=B.fileName.replace(/^.*[\\\/]/,""),Le=B.lineNumber;return`

Check your code at `+me+":"+Le+"."}return""}function Ca(B){return B!=null?Vn(B.__source):""}var ci={};function vl(B){var me=Gn();if(!me){var Le=typeof B=="string"?B:B.displayName||B.name;Le&&(me=`

Check the top-level render call using <`+Le+">.")}return me}function un(B,me){if(!(!B._store||B._store.validated||B.key!=null)){B._store.validated=!0;var Le=vl(me);if(!ci[Le]){ci[Le]=!0;var Me="";B&&B._owner&&B._owner!==Q.current&&(Me=" It was passed a child from "+ur(B._owner.type)+"."),Us(B),ve('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',Le,Me),Us(null)}}}function yt(B,me){if(typeof B=="object"){if(Tt(B))for(var Le=0;Le<B.length;Le++){var Me=B[Le];kt(Me)&&un(Me,me)}else if(kt(B))B._store&&(B._store.validated=!0);else if(B){var st=G(B);if(typeof st=="function"&&st!==B.entries)for(var _t=st.call(B),Et;!(Et=_t.next()).done;)kt(Et.value)&&un(Et.value,me)}}}function Yn(B){{var me=B.type;if(me==null||typeof me=="string")return;var Le;if(typeof me=="function")Le=me.propTypes;else if(typeof me=="object"&&(me.$$typeof===x||me.$$typeof===w))Le=me.propTypes;else return;if(Le){var Me=ur(me);pl(Le,B.props,"prop",Me,B)}else if(me.PropTypes!==void 0&&!jt){jt=!0;var st=ur(me);ve("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",st||"Unknown")}typeof me.getDefaultProps=="function"&&!me.getDefaultProps.isReactClassApproved&&ve("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function qn(B){{for(var me=Object.keys(B.props),Le=0;Le<me.length;Le++){var Me=me[Le];if(Me!=="children"&&Me!=="key"){Us(B),ve("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",Me),Us(null);break}}B.ref!==null&&(Us(B),ve("Invalid attribute `ref` supplied to `React.Fragment`."),Us(null))}}function bn(B,me,Le){var Me=J(B);if(!Me){var st="";(B===void 0||typeof B=="object"&&B!==null&&Object.keys(B).length===0)&&(st+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var _t=Ca(me);_t?st+=_t:st+=Gn();var Et;B===null?Et="null":Tt(B)?Et="array":B!==void 0&&B.$$typeof===s?(Et="<"+(ur(B.type)||"Unknown")+" />",st=" Did you accidentally export a JSX literal instead of a component?"):Et=typeof B,ve("React.createElement: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Et,st)}var Mt=Ct.apply(this,arguments);if(Mt==null)return Mt;if(Me)for(var rr=2;rr<arguments.length;rr++)yt(arguments[rr],B);return B===d?qn(Mt):Yn(Mt),Mt}var zt=!1;function _u(B){var me=bn.bind(null,B);return me.type=B,zt||(zt=!0,Pe("React.createFactory() is deprecated and will be removed in a future major release. Consider using JSX or use React.createElement() directly instead.")),Object.defineProperty(me,"type",{enumerable:!1,get:function(){return Pe("Factory.type is deprecated. Access the class directly before passing it to createFactory."),Object.defineProperty(this,"type",{value:B}),B}}),me}function ui(B,me,Le){for(var Me=Ot.apply(this,arguments),st=2;st<arguments.length;st++)yt(arguments[st],Me.type);return Yn(Me),Me}function mc(B,me){var Le=ne.transition;ne.transition={};var Me=ne.transition;ne.transition._updatedFibers=new Set;try{B()}finally{if(ne.transition=Le,Le===null&&Me._updatedFibers){var st=Me._updatedFibers.size;st>10&&Pe("Detected a large number of updates inside startTransition. If this is due to a subscription please re-write it to use React provided hooks. Otherwise concurrent mode guarantees are off the table."),Me._updatedFibers.clear()}}}var Kn=!1,Ii=null;function hc(B){if(Ii===null)try{var me=("require"+Math.random()).slice(0,7),Le=t&&t[me];Ii=Le.call(t,"timers").setImmediate}catch{Ii=function(st){Kn===!1&&(Kn=!0,typeof MessageChannel>"u"&&ve("This browser does not have a MessageChannel implementation, so enqueuing tasks via await act(async () => ...) will fail. Please file an issue at https://github.com/facebook/react/issues if you encounter this warning."));var _t=new MessageChannel;_t.port1.onmessage=st,_t.port2.postMessage(void 0)}}return Ii(B)}var Nn=0,nn=!1;function yo(B){{var me=Nn;Nn++,ee.current===null&&(ee.current=[]);var Le=ee.isBatchingLegacy,Me;try{if(ee.isBatchingLegacy=!0,Me=B(),!Le&&ee.didScheduleLegacyUpdate){var st=ee.current;st!==null&&(ee.didScheduleLegacyUpdate=!1,Oo(st))}}catch(Kt){throw jn(me),Kt}finally{ee.isBatchingLegacy=Le}if(Me!==null&&typeof Me=="object"&&typeof Me.then=="function"){var _t=Me,Et=!1,Mt={then:function(Kt,jr){Et=!0,_t.then(function($r){jn(me),Nn===0?Mi($r,Kt,jr):Kt($r)},function($r){jn(me),jr($r)})}};return!nn&&typeof Promise<"u"&&Promise.resolve().then(function(){}).then(function(){Et||(nn=!0,ve("You called act(async () => ...) without await. This could lead to unexpected testing behaviour, interleaving multiple act calls and mixing their scopes. You should - await act(async () => ...);"))}),Mt}else{var rr=Me;if(jn(me),Nn===0){var Gt=ee.current;Gt!==null&&(Oo(Gt),ee.current=null);var xr={then:function(Kt,jr){ee.current===null?(ee.current=[],Mi(rr,Kt,jr)):Kt(rr)}};return xr}else{var br={then:function(Kt,jr){Kt(rr)}};return br}}}}function jn(B){B!==Nn-1&&ve("You seem to have overlapping act() calls, this is not supported. Be sure to await previous act() calls before making a new one. "),Nn=B}function Mi(B,me,Le){{var Me=ee.current;if(Me!==null)try{Oo(Me),hc(function(){Me.length===0?(ee.current=null,me(B)):Mi(B,me,Le)})}catch(st){Le(st)}else me(B)}}var Ma=!1;function Oo(B){if(!Ma){Ma=!0;var me=0;try{for(;me<B.length;me++){var Le=B[me];do Le=Le(!0);while(Le!==null)}B.length=0}catch(Me){throw B=B.slice(me+1),Me}finally{Ma=!1}}}var Pu=bn,pc=ui,hs=_u,As={map:gn,forEach:Lr,count:ii,toArray:Xr,only:qa};n.Children=As,n.Component=T,n.Fragment=d,n.Profiler=f,n.PureComponent=fe,n.StrictMode=c,n.Suspense=b,n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ye,n.act=yo,n.cloneElement=pc,n.createContext=qt,n.createElement=Pu,n.createFactory=hs,n.createRef=ze,n.forwardRef=L,n.isValidElement=kt,n.lazy=pe,n.memo=Y,n.startTransition=mc,n.unstable_act=yo,n.useCallback=Ze,n.useContext=se,n.useDebugValue=lt,n.useDeferredValue=yr,n.useEffect=we,n.useId=ir,n.useImperativeHandle=et,n.useInsertionEffect=Re,n.useLayoutEffect=Ue,n.useMemo=at,n.useReducer=je,n.useRef=Se,n.useState=xe,n.useSyncExternalStore=Wr,n.useTransition=ot,n.version=e,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)})()})(Df,Df.exports)),Df.exports}var xO;function qb(){return xO||(xO=1,ub.exports=NU()),ub.exports}var bO;function DU(){if(bO)return oh;bO=1;/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */return(function(){var t=qb(),n=Symbol.for("react.element"),e=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),f=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),w=Symbol.for("react.offscreen"),R=Symbol.iterator,y="@@iterator";function U(pe){if(pe===null||typeof pe!="object")return null;var L=R&&pe[R]||pe[y];return typeof L=="function"?L:null}var q=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function G(pe){{for(var L=arguments.length,Z=new Array(L>1?L-1:0),J=1;J<L;J++)Z[J-1]=arguments[J];_("error",pe,Z)}}function _(pe,L,Z){{var J=q.ReactDebugCurrentFrame,Y=J.getStackAddendum();Y!==""&&(L+="%s",Z=Z.concat([Y]));var ae=Z.map(function(se){return String(se)});ae.unshift("Warning: "+L),Function.prototype.apply.call(console[pe],console,ae)}}var ne=!1,ee=!1,Q=!1,z=!1,ce=!1,S;S=Symbol.for("react.module.reference");function A(pe){return!!(typeof pe=="string"||typeof pe=="function"||pe===s||pe===d||ce||pe===i||pe===g||pe===x||z||pe===w||ne||ee||Q||typeof pe=="object"&&pe!==null&&(pe.$$typeof===E||pe.$$typeof===b||pe.$$typeof===c||pe.$$typeof===f||pe.$$typeof===p||pe.$$typeof===S||pe.getModuleId!==void 0))}function W(pe,L,Z){var J=pe.displayName;if(J)return J;var Y=L.displayName||L.name||"";return Y!==""?Z+"("+Y+")":Z}function H(pe){return pe.displayName||"Context"}function K(pe){if(pe==null)return null;if(typeof pe.tag=="number"&&G("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof pe=="function")return pe.displayName||pe.name||null;if(typeof pe=="string")return pe;switch(pe){case s:return"Fragment";case e:return"Portal";case d:return"Profiler";case i:return"StrictMode";case g:return"Suspense";case x:return"SuspenseList"}if(typeof pe=="object")switch(pe.$$typeof){case f:var L=pe;return H(L)+".Consumer";case c:var Z=pe;return H(Z._context)+".Provider";case p:return W(pe,pe.render,"ForwardRef");case b:var J=pe.displayName||null;return J!==null?J:K(pe.type)||"Memo";case E:{var Y=pe,ae=Y._payload,se=Y._init;try{return K(se(ae))}catch{return null}}}return null}var Oe=Object.assign,ye=0,Pe,ve,Ge,ie,Ee,Ce,j;function X(){}X.__reactDisabledLog=!0;function T(){{if(ye===0){Pe=console.log,ve=console.info,Ge=console.warn,ie=console.error,Ee=console.group,Ce=console.groupCollapsed,j=console.groupEnd;var pe={configurable:!0,enumerable:!0,value:X,writable:!0};Object.defineProperties(console,{info:pe,log:pe,warn:pe,error:pe,group:pe,groupCollapsed:pe,groupEnd:pe})}ye++}}function O(){{if(ye--,ye===0){var pe={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:Oe({},pe,{value:Pe}),info:Oe({},pe,{value:ve}),warn:Oe({},pe,{value:Ge}),error:Oe({},pe,{value:ie}),group:Oe({},pe,{value:Ee}),groupCollapsed:Oe({},pe,{value:Ce}),groupEnd:Oe({},pe,{value:j})})}ye<0&&G("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var P=q.ReactCurrentDispatcher,F;function de(pe,L,Z){{if(F===void 0)try{throw Error()}catch(Y){var J=Y.stack.trim().match(/\n( *(at )?)/);F=J&&J[1]||""}return`
`+F+pe}}var fe=!1,ge;{var ze=typeof WeakMap=="function"?WeakMap:Map;ge=new ze}function oe(pe,L){if(!pe||fe)return"";{var Z=ge.get(pe);if(Z!==void 0)return Z}var J;fe=!0;var Y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var ae;ae=P.current,P.current=null,T();try{if(L){var se=function(){throw Error()};if(Object.defineProperty(se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(se,[])}catch(at){J=at}Reflect.construct(pe,[],se)}else{try{se.call()}catch(at){J=at}pe.call(se.prototype)}}else{try{throw Error()}catch(at){J=at}pe()}}catch(at){if(at&&J&&typeof at.stack=="string"){for(var xe=at.stack.split(`
`),je=J.stack.split(`
`),Se=xe.length-1,we=je.length-1;Se>=1&&we>=0&&xe[Se]!==je[we];)we--;for(;Se>=1&&we>=0;Se--,we--)if(xe[Se]!==je[we]){if(Se!==1||we!==1)do if(Se--,we--,we<0||xe[Se]!==je[we]){var Re=`
`+xe[Se].replace(" at new "," at ");return pe.displayName&&Re.includes("<anonymous>")&&(Re=Re.replace("<anonymous>",pe.displayName)),typeof pe=="function"&&ge.set(pe,Re),Re}while(Se>=1&&we>=0);break}}}finally{fe=!1,P.current=ae,O(),Error.prepareStackTrace=Y}var Ue=pe?pe.displayName||pe.name:"",Ze=Ue?de(Ue):"";return typeof pe=="function"&&ge.set(pe,Ze),Ze}function Tt(pe,L,Z){return oe(pe,!1)}function ft(pe){var L=pe.prototype;return!!(L&&L.isReactComponent)}function xt(pe,L,Z){if(pe==null)return"";if(typeof pe=="function")return oe(pe,ft(pe));if(typeof pe=="string")return de(pe);switch(pe){case g:return de("Suspense");case x:return de("SuspenseList")}if(typeof pe=="object")switch(pe.$$typeof){case p:return Tt(pe.render);case b:return xt(pe.type,L,Z);case E:{var J=pe,Y=J._payload,ae=J._init;try{return xt(ae(Y),L,Z)}catch{}}}return""}var Dt=Object.prototype.hasOwnProperty,Ke={},er=q.ReactDebugCurrentFrame;function wr(pe){if(pe){var L=pe._owner,Z=xt(pe.type,pe._source,L?L.type:null);er.setExtraStackFrame(Z)}else er.setExtraStackFrame(null)}function ur(pe,L,Z,J,Y){{var ae=Function.call.bind(Dt);for(var se in pe)if(ae(pe,se)){var xe=void 0;try{if(typeof pe[se]!="function"){var je=Error((J||"React class")+": "+Z+" type `"+se+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof pe[se]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw je.name="Invariant Violation",je}xe=pe[se](L,se,J,Z,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Se){xe=Se}xe&&!(xe instanceof Error)&&(wr(Y),G("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",J||"React class",Z,se,typeof xe),wr(null)),xe instanceof Error&&!(xe.message in Ke)&&(Ke[xe.message]=!0,wr(Y),G("Failed %s type: %s",Z,xe.message),wr(null))}}}var ar=Array.isArray;function Ve(pe){return ar(pe)}function Xe(pe){{var L=typeof Symbol=="function"&&Symbol.toStringTag,Z=L&&pe[Symbol.toStringTag]||pe.constructor.name||"Object";return Z}}function he(pe){try{return Be(pe),!1}catch{return!0}}function Be(pe){return""+pe}function Qe(pe){if(he(pe))return G("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Xe(pe)),Be(pe)}var vt=q.ReactCurrentOwner,St={key:!0,ref:!0,__self:!0,__source:!0},tr,$e,tt;tt={};function Ct(pe){if(Dt.call(pe,"ref")){var L=Object.getOwnPropertyDescriptor(pe,"ref").get;if(L&&L.isReactWarning)return!1}return pe.ref!==void 0}function Nt(pe){if(Dt.call(pe,"key")){var L=Object.getOwnPropertyDescriptor(pe,"key").get;if(L&&L.isReactWarning)return!1}return pe.key!==void 0}function Ot(pe,L){if(typeof pe.ref=="string"&&vt.current&&L&&vt.current.stateNode!==L){var Z=K(vt.current.type);tt[Z]||(G('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',K(vt.current.type),pe.ref),tt[Z]=!0)}}function kt(pe,L){{var Z=function(){tr||(tr=!0,G("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",L))};Z.isReactWarning=!0,Object.defineProperty(pe,"key",{get:Z,configurable:!0})}}function Ft(pe,L){{var Z=function(){$e||($e=!0,G("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",L))};Z.isReactWarning=!0,Object.defineProperty(pe,"ref",{get:Z,configurable:!0})}}var Lt=function(pe,L,Z,J,Y,ae,se){var xe={$$typeof:n,type:pe,key:L,ref:Z,props:se,_owner:ae};return xe._store={},Object.defineProperty(xe._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(xe,"_self",{configurable:!1,enumerable:!1,writable:!1,value:J}),Object.defineProperty(xe,"_source",{configurable:!1,enumerable:!1,writable:!1,value:Y}),Object.freeze&&(Object.freeze(xe.props),Object.freeze(xe)),xe};function Yt(pe,L,Z,J,Y){{var ae,se={},xe=null,je=null;Z!==void 0&&(Qe(Z),xe=""+Z),Nt(L)&&(Qe(L.key),xe=""+L.key),Ct(L)&&(je=L.ref,Ot(L,Y));for(ae in L)Dt.call(L,ae)&&!St.hasOwnProperty(ae)&&(se[ae]=L[ae]);if(pe&&pe.defaultProps){var Se=pe.defaultProps;for(ae in Se)se[ae]===void 0&&(se[ae]=Se[ae])}if(xe||je){var we=typeof pe=="function"?pe.displayName||pe.name||"Unknown":pe;xe&&kt(se,we),je&&Ft(se,we)}return Lt(pe,xe,je,Y,J,vt.current,se)}}var ct=q.ReactCurrentOwner,nr=q.ReactDebugCurrentFrame;function rn(pe){if(pe){var L=pe._owner,Z=xt(pe.type,pe._source,L?L.type:null);nr.setExtraStackFrame(Z)}else nr.setExtraStackFrame(null)}var An;An=!1;function Cr(pe){return typeof pe=="object"&&pe!==null&&pe.$$typeof===n}function gn(){{if(ct.current){var pe=K(ct.current.type);if(pe)return`

Check the render method of \``+pe+"`."}return""}}function ii(pe){{if(pe!==void 0){var L=pe.fileName.replace(/^.*[\\\/]/,""),Z=pe.lineNumber;return`

Check your code at `+L+":"+Z+"."}return""}}var Lr={};function Xr(pe){{var L=gn();if(!L){var Z=typeof pe=="string"?pe:pe.displayName||pe.name;Z&&(L=`

Check the top-level render call using <`+Z+">.")}return L}}function qa(pe,L){{if(!pe._store||pe._store.validated||pe.key!=null)return;pe._store.validated=!0;var Z=Xr(L);if(Lr[Z])return;Lr[Z]=!0;var J="";pe&&pe._owner&&pe._owner!==ct.current&&(J=" It was passed a child from "+K(pe._owner.type)+"."),rn(pe),G('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',Z,J),rn(null)}}function qt(pe,L){{if(typeof pe!="object")return;if(Ve(pe))for(var Z=0;Z<pe.length;Z++){var J=pe[Z];Cr(J)&&qa(J,L)}else if(Cr(pe))pe._store&&(pe._store.validated=!0);else if(pe){var Y=U(pe);if(typeof Y=="function"&&Y!==pe.entries)for(var ae=Y.call(pe),se;!(se=ae.next()).done;)Cr(se.value)&&qa(se.value,L)}}}function Ln(pe){{var L=pe.type;if(L==null||typeof L=="string")return;var Z;if(typeof L=="function")Z=L.propTypes;else if(typeof L=="object"&&(L.$$typeof===p||L.$$typeof===b))Z=L.propTypes;else return;if(Z){var J=K(L);ur(Z,pe.props,"prop",J,pe)}else if(L.PropTypes!==void 0&&!An){An=!0;var Y=K(L);G("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",Y||"Unknown")}typeof L.getDefaultProps=="function"&&!L.getDefaultProps.isReactClassApproved&&G("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function xn(pe){{for(var L=Object.keys(pe.props),Z=0;Z<L.length;Z++){var J=L[Z];if(J!=="children"&&J!=="key"){rn(pe),G("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",J),rn(null);break}}pe.ref!==null&&(rn(pe),G("Invalid attribute `ref` supplied to `React.Fragment`."),rn(null))}}var cn={};function wa(pe,L,Z,J,Y,ae){{var se=A(pe);if(!se){var xe="";(pe===void 0||typeof pe=="object"&&pe!==null&&Object.keys(pe).length===0)&&(xe+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var je=ii(Y);je?xe+=je:xe+=gn();var Se;pe===null?Se="null":Ve(pe)?Se="array":pe!==void 0&&pe.$$typeof===n?(Se="<"+(K(pe.type)||"Unknown")+" />",xe=" Did you accidentally export a JSX literal instead of a component?"):Se=typeof pe,G("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Se,xe)}var we=Yt(pe,L,Z,Y,ae);if(we==null)return we;if(se){var Re=L.children;if(Re!==void 0)if(J)if(Ve(Re)){for(var Ue=0;Ue<Re.length;Ue++)qt(Re[Ue],pe);Object.freeze&&Object.freeze(Re)}else G("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else qt(Re,pe)}if(Dt.call(L,"key")){var Ze=K(pe),at=Object.keys(L).filter(function(ot){return ot!=="key"}),et=at.length>0?"{key: someKey, "+at.join(": ..., ")+": ...}":"{key: someKey}";if(!cn[Ze+et]){var lt=at.length>0?"{"+at.join(": ..., ")+": ...}":"{}";G(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,et,Ze,lt,Ze),cn[Ze+et]=!0}}return pe===s?xn(we):Ln(we),we}}var Ts=wa;oh.Fragment=s,oh.jsxDEV=Ts})(),oh}var NO;function SU(){return NO||(NO=1,cb.exports=DU()),cb.exports}var l=SU(),I=qb();const Rh=BE(I);var lh={},db={exports:{}},Ga={},fb={exports:{}},mb={},DO;function yU(){return DO||(DO=1,(function(t){/**
 * @license React
 * scheduler.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var n=!1,e=5;function s($e,tt){var Ct=$e.length;$e.push(tt),c($e,tt,Ct)}function i($e){return $e.length===0?null:$e[0]}function d($e){if($e.length===0)return null;var tt=$e[0],Ct=$e.pop();return Ct!==tt&&($e[0]=Ct,f($e,Ct,0)),tt}function c($e,tt,Ct){for(var Nt=Ct;Nt>0;){var Ot=Nt-1>>>1,kt=$e[Ot];if(p(kt,tt)>0)$e[Ot]=tt,$e[Nt]=kt,Nt=Ot;else return}}function f($e,tt,Ct){for(var Nt=Ct,Ot=$e.length,kt=Ot>>>1;Nt<kt;){var Ft=(Nt+1)*2-1,Lt=$e[Ft],Yt=Ft+1,ct=$e[Yt];if(p(Lt,tt)<0)Yt<Ot&&p(ct,Lt)<0?($e[Nt]=ct,$e[Yt]=tt,Nt=Yt):($e[Nt]=Lt,$e[Ft]=tt,Nt=Ft);else if(Yt<Ot&&p(ct,tt)<0)$e[Nt]=ct,$e[Yt]=tt,Nt=Yt;else return}}function p($e,tt){var Ct=$e.sortIndex-tt.sortIndex;return Ct!==0?Ct:$e.id-tt.id}var g=1,x=2,b=3,E=4,w=5;function R($e,tt){}var y=typeof performance=="object"&&typeof performance.now=="function";if(y){var U=performance;t.unstable_now=function(){return U.now()}}else{var q=Date,G=q.now();t.unstable_now=function(){return q.now()-G}}var _=1073741823,ne=-1,ee=250,Q=5e3,z=1e4,ce=_,S=[],A=[],W=1,H=null,K=b,Oe=!1,ye=!1,Pe=!1,ve=typeof setTimeout=="function"?setTimeout:null,Ge=typeof clearTimeout=="function"?clearTimeout:null,ie=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Ee($e){for(var tt=i(A);tt!==null;){if(tt.callback===null)d(A);else if(tt.startTime<=$e)d(A),tt.sortIndex=tt.expirationTime,s(S,tt);else return;tt=i(A)}}function Ce($e){if(Pe=!1,Ee($e),!ye)if(i(S)!==null)ye=!0,Be(j);else{var tt=i(A);tt!==null&&Qe(Ce,tt.startTime-$e)}}function j($e,tt){ye=!1,Pe&&(Pe=!1,vt()),Oe=!0;var Ct=K;try{var Nt;if(!n)return X($e,tt)}finally{H=null,K=Ct,Oe=!1}}function X($e,tt){var Ct=tt;for(Ee(Ct),H=i(S);H!==null&&!(H.expirationTime>Ct&&(!$e||er()));){var Nt=H.callback;if(typeof Nt=="function"){H.callback=null,K=H.priorityLevel;var Ot=H.expirationTime<=Ct,kt=Nt(Ot);Ct=t.unstable_now(),typeof kt=="function"?H.callback=kt:H===i(S)&&d(S),Ee(Ct)}else d(S);H=i(S)}if(H!==null)return!0;var Ft=i(A);return Ft!==null&&Qe(Ce,Ft.startTime-Ct),!1}function T($e,tt){switch($e){case g:case x:case b:case E:case w:break;default:$e=b}var Ct=K;K=$e;try{return tt()}finally{K=Ct}}function O($e){var tt;switch(K){case g:case x:case b:tt=b;break;default:tt=K;break}var Ct=K;K=tt;try{return $e()}finally{K=Ct}}function P($e){var tt=K;return function(){var Ct=K;K=tt;try{return $e.apply(this,arguments)}finally{K=Ct}}}function F($e,tt,Ct){var Nt=t.unstable_now(),Ot;if(typeof Ct=="object"&&Ct!==null){var kt=Ct.delay;typeof kt=="number"&&kt>0?Ot=Nt+kt:Ot=Nt}else Ot=Nt;var Ft;switch($e){case g:Ft=ne;break;case x:Ft=ee;break;case w:Ft=ce;break;case E:Ft=z;break;case b:default:Ft=Q;break}var Lt=Ot+Ft,Yt={id:W++,callback:tt,priorityLevel:$e,startTime:Ot,expirationTime:Lt,sortIndex:-1};return Ot>Nt?(Yt.sortIndex=Ot,s(A,Yt),i(S)===null&&Yt===i(A)&&(Pe?vt():Pe=!0,Qe(Ce,Ot-Nt))):(Yt.sortIndex=Lt,s(S,Yt),!ye&&!Oe&&(ye=!0,Be(j))),Yt}function de(){}function fe(){!ye&&!Oe&&(ye=!0,Be(j))}function ge(){return i(S)}function ze($e){$e.callback=null}function oe(){return K}var Tt=!1,ft=null,xt=-1,Dt=e,Ke=-1;function er(){var $e=t.unstable_now()-Ke;return!($e<Dt)}function wr(){}function ur($e){if($e<0||$e>125){console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported");return}$e>0?Dt=Math.floor(1e3/$e):Dt=e}var ar=function(){if(ft!==null){var $e=t.unstable_now();Ke=$e;var tt=!0,Ct=!0;try{Ct=ft(tt,$e)}finally{Ct?Ve():(Tt=!1,ft=null)}}else Tt=!1},Ve;if(typeof ie=="function")Ve=function(){ie(ar)};else if(typeof MessageChannel<"u"){var Xe=new MessageChannel,he=Xe.port2;Xe.port1.onmessage=ar,Ve=function(){he.postMessage(null)}}else Ve=function(){ve(ar,0)};function Be($e){ft=$e,Tt||(Tt=!0,Ve())}function Qe($e,tt){xt=ve(function(){$e(t.unstable_now())},tt)}function vt(){Ge(xt),xt=-1}var St=wr,tr=null;t.unstable_IdlePriority=w,t.unstable_ImmediatePriority=g,t.unstable_LowPriority=E,t.unstable_NormalPriority=b,t.unstable_Profiling=tr,t.unstable_UserBlockingPriority=x,t.unstable_cancelCallback=ze,t.unstable_continueExecution=fe,t.unstable_forceFrameRate=ur,t.unstable_getCurrentPriorityLevel=oe,t.unstable_getFirstCallbackNode=ge,t.unstable_next=O,t.unstable_pauseExecution=de,t.unstable_requestPaint=St,t.unstable_runWithPriority=T,t.unstable_scheduleCallback=F,t.unstable_shouldYield=er,t.unstable_wrapCallback=P,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)})()})(mb)),mb}var SO;function OU(){return SO||(SO=1,fb.exports=yU()),fb.exports}var yO;function EU(){if(yO)return Ga;yO=1;/**
 * @license React
 * react-dom.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */return(function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var t=qb(),n=OU(),e=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,s=!1;function i(r){s=r}function d(r){if(!s){for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];f("warn",r,o)}}function c(r){if(!s){for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];f("error",r,o)}}function f(r,a,o){{var u=e.ReactDebugCurrentFrame,m=u.getStackAddendum();m!==""&&(a+="%s",o=o.concat([m]));var v=o.map(function(N){return String(N)});v.unshift("Warning: "+a),Function.prototype.apply.call(console[r],console,v)}}var p=0,g=1,x=2,b=3,E=4,w=5,R=6,y=7,U=8,q=9,G=10,_=11,ne=12,ee=13,Q=14,z=15,ce=16,S=17,A=18,W=19,H=21,K=22,Oe=23,ye=24,Pe=25,ve=!0,Ge=!1,ie=!1,Ee=!1,Ce=!1,j=!0,X=!0,T=!0,O=!0,P=new Set,F={},de={};function fe(r,a){ge(r,a),ge(r+"Capture",a)}function ge(r,a){F[r]&&c("EventRegistry: More than one plugin attempted to publish the same registration name, `%s`.",r),F[r]=a;{var o=r.toLowerCase();de[o]=r,r==="onDoubleClick"&&(de.ondblclick=r)}for(var u=0;u<a.length;u++)P.add(a[u])}var ze=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",oe=Object.prototype.hasOwnProperty;function Tt(r){{var a=typeof Symbol=="function"&&Symbol.toStringTag,o=a&&r[Symbol.toStringTag]||r.constructor.name||"Object";return o}}function ft(r){try{return xt(r),!1}catch{return!0}}function xt(r){return""+r}function Dt(r,a){if(ft(r))return c("The provided `%s` attribute is an unsupported type %s. This value must be coerced to a string before before using it here.",a,Tt(r)),xt(r)}function Ke(r){if(ft(r))return c("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Tt(r)),xt(r)}function er(r,a){if(ft(r))return c("The provided `%s` prop is an unsupported type %s. This value must be coerced to a string before before using it here.",a,Tt(r)),xt(r)}function wr(r,a){if(ft(r))return c("The provided `%s` CSS property is an unsupported type %s. This value must be coerced to a string before before using it here.",a,Tt(r)),xt(r)}function ur(r){if(ft(r))return c("The provided HTML markup uses a value of unsupported type %s. This value must be coerced to a string before before using it here.",Tt(r)),xt(r)}function ar(r){if(ft(r))return c("Form field values (value, checked, defaultValue, or defaultChecked props) must be strings, not %s. This value must be coerced to a string before before using it here.",Tt(r)),xt(r)}var Ve=0,Xe=1,he=2,Be=3,Qe=4,vt=5,St=6,tr=":A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",$e=tr+"\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",tt=new RegExp("^["+tr+"]["+$e+"]*$"),Ct={},Nt={};function Ot(r){return oe.call(Nt,r)?!0:oe.call(Ct,r)?!1:tt.test(r)?(Nt[r]=!0,!0):(Ct[r]=!0,c("Invalid attribute name: `%s`",r),!1)}function kt(r,a,o){return a!==null?a.type===Ve:o?!1:r.length>2&&(r[0]==="o"||r[0]==="O")&&(r[1]==="n"||r[1]==="N")}function Ft(r,a,o,u){if(o!==null&&o.type===Ve)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":{if(u)return!1;if(o!==null)return!o.acceptsBooleans;var m=r.toLowerCase().slice(0,5);return m!=="data-"&&m!=="aria-"}default:return!1}}function Lt(r,a,o,u){if(a===null||typeof a>"u"||Ft(r,a,o,u))return!0;if(u)return!1;if(o!==null)switch(o.type){case Be:return!a;case Qe:return a===!1;case vt:return isNaN(a);case St:return isNaN(a)||a<1}return!1}function Yt(r){return nr.hasOwnProperty(r)?nr[r]:null}function ct(r,a,o,u,m,v,N){this.acceptsBooleans=a===he||a===Be||a===Qe,this.attributeName=u,this.attributeNamespace=m,this.mustUseProperty=o,this.propertyName=r,this.type=a,this.sanitizeURL=v,this.removeEmptyString=N}var nr={},rn=["children","dangerouslySetInnerHTML","defaultValue","defaultChecked","innerHTML","suppressContentEditableWarning","suppressHydrationWarning","style"];rn.forEach(function(r){nr[r]=new ct(r,Ve,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var a=r[0],o=r[1];nr[a]=new ct(a,Xe,!1,o,null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){nr[r]=new ct(r,he,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){nr[r]=new ct(r,he,!1,r,null,!1,!1)}),["allowFullScreen","async","autoFocus","autoPlay","controls","default","defer","disabled","disablePictureInPicture","disableRemotePlayback","formNoValidate","hidden","loop","noModule","noValidate","open","playsInline","readOnly","required","reversed","scoped","seamless","itemScope"].forEach(function(r){nr[r]=new ct(r,Be,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){nr[r]=new ct(r,Be,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){nr[r]=new ct(r,Qe,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){nr[r]=new ct(r,St,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){nr[r]=new ct(r,vt,!1,r.toLowerCase(),null,!1,!1)});var An=/[\-\:]([a-z])/g,Cr=function(r){return r[1].toUpperCase()};["accent-height","alignment-baseline","arabic-form","baseline-shift","cap-height","clip-path","clip-rule","color-interpolation","color-interpolation-filters","color-profile","color-rendering","dominant-baseline","enable-background","fill-opacity","fill-rule","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","glyph-name","glyph-orientation-horizontal","glyph-orientation-vertical","horiz-adv-x","horiz-origin-x","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","overline-position","overline-thickness","paint-order","panose-1","pointer-events","rendering-intent","shape-rendering","stop-color","stop-opacity","strikethrough-position","strikethrough-thickness","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-rendering","underline-position","underline-thickness","unicode-bidi","unicode-range","units-per-em","v-alphabetic","v-hanging","v-ideographic","v-mathematical","vector-effect","vert-adv-y","vert-origin-x","vert-origin-y","word-spacing","writing-mode","xmlns:xlink","x-height"].forEach(function(r){var a=r.replace(An,Cr);nr[a]=new ct(a,Xe,!1,r,null,!1,!1)}),["xlink:actuate","xlink:arcrole","xlink:role","xlink:show","xlink:title","xlink:type"].forEach(function(r){var a=r.replace(An,Cr);nr[a]=new ct(a,Xe,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var a=r.replace(An,Cr);nr[a]=new ct(a,Xe,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){nr[r]=new ct(r,Xe,!1,r.toLowerCase(),null,!1,!1)});var gn="xlinkHref";nr[gn]=new ct("xlinkHref",Xe,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){nr[r]=new ct(r,Xe,!1,r.toLowerCase(),null,!0,!0)});var ii=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*\:/i,Lr=!1;function Xr(r){!Lr&&ii.test(r)&&(Lr=!0,c("A future version of React will block javascript: URLs as a security precaution. Use event handlers instead if you can. If you need to generate unsafe HTML try using dangerouslySetInnerHTML instead. React was passed %s.",JSON.stringify(r)))}function qa(r,a,o,u){if(u.mustUseProperty){var m=u.propertyName;return r[m]}else{Dt(o,a),u.sanitizeURL&&Xr(""+o);var v=u.attributeName,N=null;if(u.type===Qe){if(r.hasAttribute(v)){var k=r.getAttribute(v);return k===""?!0:Lt(a,o,u,!1)?k:k===""+o?o:k}}else if(r.hasAttribute(v)){if(Lt(a,o,u,!1))return r.getAttribute(v);if(u.type===Be)return o;N=r.getAttribute(v)}return Lt(a,o,u,!1)?N===null?o:N:N===""+o?o:N}}function qt(r,a,o,u){{if(!Ot(a))return;if(!r.hasAttribute(a))return o===void 0?void 0:null;var m=r.getAttribute(a);return Dt(o,a),m===""+o?o:m}}function Ln(r,a,o,u){var m=Yt(a);if(!kt(a,m,u)){if(Lt(a,o,m,u)&&(o=null),u||m===null){if(Ot(a)){var v=a;o===null?r.removeAttribute(v):(Dt(o,a),r.setAttribute(v,""+o))}return}var N=m.mustUseProperty;if(N){var k=m.propertyName;if(o===null){var M=m.type;r[k]=M===Be?!1:""}else r[k]=o;return}var te=m.attributeName,le=m.attributeNamespace;if(o===null)r.removeAttribute(te);else{var De=m.type,Ne;De===Be||De===Qe&&o===!0?Ne="":(Dt(o,te),Ne=""+o,m.sanitizeURL&&Xr(Ne.toString())),le?r.setAttributeNS(le,te,Ne):r.setAttribute(te,Ne)}}}var xn=Symbol.for("react.element"),cn=Symbol.for("react.portal"),wa=Symbol.for("react.fragment"),Ts=Symbol.for("react.strict_mode"),pe=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),Z=Symbol.for("react.context"),J=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),se=Symbol.for("react.memo"),xe=Symbol.for("react.lazy"),je=Symbol.for("react.scope"),Se=Symbol.for("react.debug_trace_mode"),we=Symbol.for("react.offscreen"),Re=Symbol.for("react.legacy_hidden"),Ue=Symbol.for("react.cache"),Ze=Symbol.for("react.tracing_marker"),at=Symbol.iterator,et="@@iterator";function lt(r){if(r===null||typeof r!="object")return null;var a=at&&r[at]||r[et];return typeof a=="function"?a:null}var ot=Object.assign,yr=0,ir,Wr,Ar,Fr,Ka,zn,_s;function Xn(){}Xn.__reactDisabledLog=!0;function Ai(){{if(yr===0){ir=console.log,Wr=console.info,Ar=console.warn,Fr=console.error,Ka=console.group,zn=console.groupCollapsed,_s=console.groupEnd;var r={configurable:!0,enumerable:!0,value:Xn,writable:!0};Object.defineProperties(console,{info:r,log:r,warn:r,error:r,group:r,groupCollapsed:r,groupEnd:r})}yr++}}function fs(){{if(yr--,yr===0){var r={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:ot({},r,{value:ir}),info:ot({},r,{value:Wr}),warn:ot({},r,{value:Ar}),error:ot({},r,{value:Fr}),group:ot({},r,{value:Ka}),groupCollapsed:ot({},r,{value:zn}),groupEnd:ot({},r,{value:_s})})}yr<0&&c("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var Ps=e.ReactCurrentDispatcher,xo;function Ja(r,a,o){{if(xo===void 0)try{throw Error()}catch(m){var u=m.stack.trim().match(/\n( *(at )?)/);xo=u&&u[1]||""}return`
`+xo+r}}var Li=!1,ms;{var bo=typeof WeakMap=="function"?WeakMap:Map;ms=new bo}function oi(r,a){if(!r||Li)return"";{var o=ms.get(r);if(o!==void 0)return o}var u;Li=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var v;v=Ps.current,Ps.current=null,Ai();try{if(a){var N=function(){throw Error()};if(Object.defineProperty(N.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(N,[])}catch(Ie){u=Ie}Reflect.construct(r,[],N)}else{try{N.call()}catch(Ie){u=Ie}r.call(N.prototype)}}else{try{throw Error()}catch(Ie){u=Ie}r()}}catch(Ie){if(Ie&&u&&typeof Ie.stack=="string"){for(var k=Ie.stack.split(`
`),M=u.stack.split(`
`),te=k.length-1,le=M.length-1;te>=1&&le>=0&&k[te]!==M[le];)le--;for(;te>=1&&le>=0;te--,le--)if(k[te]!==M[le]){if(te!==1||le!==1)do if(te--,le--,le<0||k[te]!==M[le]){var De=`
`+k[te].replace(" at new "," at ");return r.displayName&&De.includes("<anonymous>")&&(De=De.replace("<anonymous>",r.displayName)),typeof r=="function"&&ms.set(r,De),De}while(te>=1&&le>=0);break}}}finally{Li=!1,Ps.current=v,fs(),Error.prepareStackTrace=m}var Ne=r?r.displayName||r.name:"",Ae=Ne?Ja(Ne):"";return typeof r=="function"&&ms.set(r,Ae),Ae}function No(r,a,o){return oi(r,!0)}function Do(r,a,o){return oi(r,!1)}function Vi(r){var a=r.prototype;return!!(a&&a.isReactComponent)}function ji(r,a,o){if(r==null)return"";if(typeof r=="function")return oi(r,Vi(r));if(typeof r=="string")return Ja(r);switch(r){case Y:return Ja("Suspense");case ae:return Ja("SuspenseList")}if(typeof r=="object")switch(r.$$typeof){case J:return Do(r.render);case se:return ji(r.type,a,o);case xe:{var u=r,m=u._payload,v=u._init;try{return ji(v(m),a,o)}catch{}}}return""}function Tu(r){switch(r._debugOwner&&r._debugOwner.type,r._debugSource,r.tag){case w:return Ja(r.type);case ce:return Ja("Lazy");case ee:return Ja("Suspense");case W:return Ja("SuspenseList");case p:case x:case z:return Do(r.type);case _:return Do(r.type.render);case g:return No(r.type);default:return""}}function li(r){try{var a="",o=r;do a+=Tu(o),o=o.return;while(o);return a}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function hl(r,a,o){var u=r.displayName;if(u)return u;var m=a.displayName||a.name||"";return m!==""?o+"("+m+")":o}function So(r){return r.displayName||"Context"}function mr(r){if(r==null)return null;if(typeof r.tag=="number"&&c("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case wa:return"Fragment";case cn:return"Portal";case pe:return"Profiler";case Ts:return"StrictMode";case Y:return"Suspense";case ae:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case Z:var a=r;return So(a)+".Consumer";case L:var o=r;return So(o._context)+".Provider";case J:return hl(r,r.render,"ForwardRef");case se:var u=r.displayName||null;return u!==null?u:mr(r.type)||"Memo";case xe:{var m=r,v=m._payload,N=m._init;try{return mr(N(v))}catch{return null}}}return null}function pl(r,a,o){var u=a.displayName||a.name||"";return r.displayName||(u!==""?o+"("+u+")":o)}function Us(r){return r.displayName||"Context"}function jt(r){var a=r.tag,o=r.type;switch(a){case ye:return"Cache";case q:var u=o;return Us(u)+".Consumer";case G:var m=o;return Us(m._context)+".Provider";case A:return"DehydratedFragment";case _:return pl(o,o.render,"ForwardRef");case y:return"Fragment";case w:return o;case E:return"Portal";case b:return"Root";case R:return"Text";case ce:return mr(o);case U:return o===Ts?"StrictMode":"Mode";case K:return"Offscreen";case ne:return"Profiler";case H:return"Scope";case ee:return"Suspense";case W:return"SuspenseList";case Pe:return"TracingMarker";case g:case p:case S:case x:case Q:case z:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;break}return null}var Gn=e.ReactDebugCurrentFrame,Vn=null,Ca=!1;function ci(){{if(Vn===null)return null;var r=Vn._debugOwner;if(r!==null&&typeof r<"u")return jt(r)}return null}function vl(){return Vn===null?"":li(Vn)}function un(){Gn.getCurrentStack=null,Vn=null,Ca=!1}function yt(r){Gn.getCurrentStack=r===null?null:vl,Vn=r,Ca=!1}function Yn(){return Vn}function qn(r){Ca=r}function bn(r){return""+r}function zt(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return ar(r),r;default:return""}}var _u={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0};function ui(r,a){_u[a.type]||a.onChange||a.onInput||a.readOnly||a.disabled||a.value==null||c("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`."),a.onChange||a.readOnly||a.disabled||a.checked==null||c("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")}function mc(r){var a=r.type,o=r.nodeName;return o&&o.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Kn(r){return r._valueTracker}function Ii(r){r._valueTracker=null}function hc(r){var a="";return r&&(mc(r)?a=r.checked?"true":"false":a=r.value),a}function Nn(r){var a=mc(r)?"checked":"value",o=Object.getOwnPropertyDescriptor(r.constructor.prototype,a);ar(r[a]);var u=""+r[a];if(!(r.hasOwnProperty(a)||typeof o>"u"||typeof o.get!="function"||typeof o.set!="function")){var m=o.get,v=o.set;Object.defineProperty(r,a,{configurable:!0,get:function(){return m.call(this)},set:function(k){ar(k),u=""+k,v.call(this,k)}}),Object.defineProperty(r,a,{enumerable:o.enumerable});var N={getValue:function(){return u},setValue:function(k){ar(k),u=""+k},stopTracking:function(){Ii(r),delete r[a]}};return N}}function nn(r){Kn(r)||(r._valueTracker=Nn(r))}function yo(r){if(!r)return!1;var a=Kn(r);if(!a)return!0;var o=a.getValue(),u=hc(r);return u!==o?(a.setValue(u),!0):!1}function jn(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Mi=!1,Ma=!1,Oo=!1,Pu=!1;function pc(r){var a=r.type==="checkbox"||r.type==="radio";return a?r.checked!=null:r.value!=null}function hs(r,a){var o=r,u=a.checked,m=ot({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??o._wrapperState.initialChecked});return m}function As(r,a){ui("input",a),a.checked!==void 0&&a.defaultChecked!==void 0&&!Ma&&(c("%s contains an input of type %s with both checked and defaultChecked props. Input elements must be either controlled or uncontrolled (specify either the checked prop, or the defaultChecked prop, but not both). Decide between using a controlled or uncontrolled input element and remove one of these props. More info: https://reactjs.org/link/controlled-components",ci()||"A component",a.type),Ma=!0),a.value!==void 0&&a.defaultValue!==void 0&&!Mi&&(c("%s contains an input of type %s with both value and defaultValue props. Input elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled input element and remove one of these props. More info: https://reactjs.org/link/controlled-components",ci()||"A component",a.type),Mi=!0);var o=r,u=a.defaultValue==null?"":a.defaultValue;o._wrapperState={initialChecked:a.checked!=null?a.checked:a.defaultChecked,initialValue:zt(a.value!=null?a.value:u),controlled:pc(a)}}function B(r,a){var o=r,u=a.checked;u!=null&&Ln(o,"checked",u,!1)}function me(r,a){var o=r;{var u=pc(a);!o._wrapperState.controlled&&u&&!Pu&&(c("A component is changing an uncontrolled input to be controlled. This is likely caused by the value changing from undefined to a defined value, which should not happen. Decide between using a controlled or uncontrolled input element for the lifetime of the component. More info: https://reactjs.org/link/controlled-components"),Pu=!0),o._wrapperState.controlled&&!u&&!Oo&&(c("A component is changing a controlled input to be uncontrolled. This is likely caused by the value changing from a defined to undefined, which should not happen. Decide between using a controlled or uncontrolled input element for the lifetime of the component. More info: https://reactjs.org/link/controlled-components"),Oo=!0)}B(r,a);var m=zt(a.value),v=a.type;if(m!=null)v==="number"?(m===0&&o.value===""||o.value!=m)&&(o.value=bn(m)):o.value!==bn(m)&&(o.value=bn(m));else if(v==="submit"||v==="reset"){o.removeAttribute("value");return}a.hasOwnProperty("value")?_t(o,a.type,m):a.hasOwnProperty("defaultValue")&&_t(o,a.type,zt(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(o.defaultChecked=!!a.defaultChecked)}function Le(r,a,o){var u=r;if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var m=a.type,v=m==="submit"||m==="reset";if(v&&(a.value===void 0||a.value===null))return;var N=bn(u._wrapperState.initialValue);o||N!==u.value&&(u.value=N),u.defaultValue=N}var k=u.name;k!==""&&(u.name=""),u.defaultChecked=!u.defaultChecked,u.defaultChecked=!!u._wrapperState.initialChecked,k!==""&&(u.name=k)}function Me(r,a){var o=r;me(o,a),st(o,a)}function st(r,a){var o=a.name;if(a.type==="radio"&&o!=null){for(var u=r;u.parentNode;)u=u.parentNode;Dt(o,"name");for(var m=u.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),v=0;v<m.length;v++){var N=m[v];if(!(N===r||N.form!==r.form)){var k=G0(N);if(!k)throw new Error("ReactDOMInput: Mixing React and non-React radio inputs with the same `name` is not supported.");yo(N),me(N,k)}}}}function _t(r,a,o){(a!=="number"||jn(r.ownerDocument)!==r)&&(o==null?r.defaultValue=bn(r._wrapperState.initialValue):r.defaultValue!==bn(o)&&(r.defaultValue=bn(o)))}var Et=!1,Mt=!1,rr=!1;function Gt(r,a){a.value==null&&(typeof a.children=="object"&&a.children!==null?t.Children.forEach(a.children,function(o){o!=null&&(typeof o=="string"||typeof o=="number"||Mt||(Mt=!0,c("Cannot infer the option value of complex children. Pass a `value` prop or use a plain string as children to <option>.")))}):a.dangerouslySetInnerHTML!=null&&(rr||(rr=!0,c("Pass a `value` prop if you set dangerouslyInnerHTML so React knows which value should be selected.")))),a.selected!=null&&!Et&&(c("Use the `defaultValue` or `value` props on <select> instead of setting `selected` on <option>."),Et=!0)}function xr(r,a){a.value!=null&&r.setAttribute("value",bn(zt(a.value)))}var br=Array.isArray;function Kt(r){return br(r)}var jr;jr=!1;function $r(){var r=ci();return r?`

Check the render method of \``+r+"`.":""}var Fi=["value","defaultValue"];function di(r){{ui("select",r);for(var a=0;a<Fi.length;a++){var o=Fi[a];if(r[o]!=null){var u=Kt(r[o]);r.multiple&&!u?c("The `%s` prop supplied to <select> must be an array if `multiple` is true.%s",o,$r()):!r.multiple&&u&&c("The `%s` prop supplied to <select> must be a scalar value if `multiple` is false.%s",o,$r())}}}}function ua(r,a,o,u){var m=r.options;if(a){for(var v=o,N={},k=0;k<v.length;k++)N["$"+v[k]]=!0;for(var M=0;M<m.length;M++){var te=N.hasOwnProperty("$"+m[M].value);m[M].selected!==te&&(m[M].selected=te),te&&u&&(m[M].defaultSelected=!0)}}else{for(var le=bn(zt(o)),De=null,Ne=0;Ne<m.length;Ne++){if(m[Ne].value===le){m[Ne].selected=!0,u&&(m[Ne].defaultSelected=!0);return}De===null&&!m[Ne].disabled&&(De=m[Ne])}De!==null&&(De.selected=!0)}}function Pr(r,a){return ot({},a,{value:void 0})}function Dn(r,a){var o=r;di(a),o._wrapperState={wasMultiple:!!a.multiple},a.value!==void 0&&a.defaultValue!==void 0&&!jr&&(c("Select elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled select element and remove one of these props. More info: https://reactjs.org/link/controlled-components"),jr=!0)}function Eo(r,a){var o=r;o.multiple=!!a.multiple;var u=a.value;u!=null?ua(o,!!a.multiple,u,!1):a.defaultValue!=null&&ua(o,!!a.multiple,a.defaultValue,!0)}function gl(r,a){var o=r,u=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?ua(o,!!a.multiple,m,!1):u!==!!a.multiple&&(a.defaultValue!=null?ua(o,!!a.multiple,a.defaultValue,!0):ua(o,!!a.multiple,a.multiple?[]:"",!1))}function Sn(r,a){var o=r,u=a.value;u!=null&&ua(o,!!a.multiple,u,!1)}var r0=!1;function xl(r,a){var o=r;if(a.dangerouslySetInnerHTML!=null)throw new Error("`dangerouslySetInnerHTML` does not make sense on <textarea>.");var u=ot({},a,{value:void 0,defaultValue:void 0,children:bn(o._wrapperState.initialValue)});return u}function vc(r,a){var o=r;ui("textarea",a),a.value!==void 0&&a.defaultValue!==void 0&&!r0&&(c("%s contains a textarea with both value and defaultValue props. Textarea elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled textarea and remove one of these props. More info: https://reactjs.org/link/controlled-components",ci()||"A component"),r0=!0);var u=a.value;if(u==null){var m=a.children,v=a.defaultValue;if(m!=null){c("Use the `defaultValue` or `value` props instead of setting children on <textarea>.");{if(v!=null)throw new Error("If you supply `defaultValue` on a <textarea>, do not pass children.");if(Kt(m)){if(m.length>1)throw new Error("<textarea> can only have at most one child.");m=m[0]}v=m}}v==null&&(v=""),u=v}o._wrapperState={initialValue:zt(u)}}function n0(r,a){var o=r,u=zt(a.value),m=zt(a.defaultValue);if(u!=null){var v=bn(u);v!==o.value&&(o.value=v),a.defaultValue==null&&o.defaultValue!==v&&(o.defaultValue=v)}m!=null&&(o.defaultValue=bn(m))}function Uu(r,a){var o=r,u=o.textContent;u===o._wrapperState.initialValue&&u!==""&&u!==null&&(o.value=u)}function Jh(r,a){n0(r,a)}var Ls="http://www.w3.org/1999/xhtml",Qh="http://www.w3.org/1998/Math/MathML",Au="http://www.w3.org/2000/svg";function Lu(r){switch(r){case"svg":return Au;case"math":return Qh;default:return Ls}}function Vu(r,a){return r==null||r===Ls?Lu(a):r===Au&&a==="foreignObject"?Ls:r}var Zh=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,o,u,m){MSApp.execUnsafeLocalFunction(function(){return r(a,o,u,m)})}:r},gc,bl=Zh(function(r,a){if(r.namespaceURI===Au&&!("innerHTML"in r)){gc=gc||document.createElement("div"),gc.innerHTML="<svg>"+a.valueOf().toString()+"</svg>";for(var o=gc.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;o.firstChild;)r.appendChild(o.firstChild);return}r.innerHTML=a}),da=1,Vs=3,qr=8,js=9,wo=11,Co=function(r,a){if(a){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===Vs){o.nodeValue=a;return}}r.textContent=a},ju={animation:["animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimingFunction"],background:["backgroundAttachment","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundSize"],backgroundPosition:["backgroundPositionX","backgroundPositionY"],border:["borderBottomColor","borderBottomStyle","borderBottomWidth","borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRightColor","borderRightStyle","borderRightWidth","borderTopColor","borderTopStyle","borderTopWidth"],borderBlockEnd:["borderBlockEndColor","borderBlockEndStyle","borderBlockEndWidth"],borderBlockStart:["borderBlockStartColor","borderBlockStartStyle","borderBlockStartWidth"],borderBottom:["borderBottomColor","borderBottomStyle","borderBottomWidth"],borderColor:["borderBottomColor","borderLeftColor","borderRightColor","borderTopColor"],borderImage:["borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth"],borderInlineEnd:["borderInlineEndColor","borderInlineEndStyle","borderInlineEndWidth"],borderInlineStart:["borderInlineStartColor","borderInlineStartStyle","borderInlineStartWidth"],borderLeft:["borderLeftColor","borderLeftStyle","borderLeftWidth"],borderRadius:["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"],borderRight:["borderRightColor","borderRightStyle","borderRightWidth"],borderStyle:["borderBottomStyle","borderLeftStyle","borderRightStyle","borderTopStyle"],borderTop:["borderTopColor","borderTopStyle","borderTopWidth"],borderWidth:["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth"],columnRule:["columnRuleColor","columnRuleStyle","columnRuleWidth"],columns:["columnCount","columnWidth"],flex:["flexBasis","flexGrow","flexShrink"],flexFlow:["flexDirection","flexWrap"],font:["fontFamily","fontFeatureSettings","fontKerning","fontLanguageOverride","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontVariantAlternates","fontVariantCaps","fontVariantEastAsian","fontVariantLigatures","fontVariantNumeric","fontVariantPosition","fontWeight","lineHeight"],fontVariant:["fontVariantAlternates","fontVariantCaps","fontVariantEastAsian","fontVariantLigatures","fontVariantNumeric","fontVariantPosition"],gap:["columnGap","rowGap"],grid:["gridAutoColumns","gridAutoFlow","gridAutoRows","gridTemplateAreas","gridTemplateColumns","gridTemplateRows"],gridArea:["gridColumnEnd","gridColumnStart","gridRowEnd","gridRowStart"],gridColumn:["gridColumnEnd","gridColumnStart"],gridColumnGap:["columnGap"],gridGap:["columnGap","rowGap"],gridRow:["gridRowEnd","gridRowStart"],gridRowGap:["rowGap"],gridTemplate:["gridTemplateAreas","gridTemplateColumns","gridTemplateRows"],listStyle:["listStyleImage","listStylePosition","listStyleType"],margin:["marginBottom","marginLeft","marginRight","marginTop"],marker:["markerEnd","markerMid","markerStart"],mask:["maskClip","maskComposite","maskImage","maskMode","maskOrigin","maskPositionX","maskPositionY","maskRepeat","maskSize"],maskPosition:["maskPositionX","maskPositionY"],outline:["outlineColor","outlineStyle","outlineWidth"],overflow:["overflowX","overflowY"],padding:["paddingBottom","paddingLeft","paddingRight","paddingTop"],placeContent:["alignContent","justifyContent"],placeItems:["alignItems","justifyItems"],placeSelf:["alignSelf","justifySelf"],textDecoration:["textDecorationColor","textDecorationLine","textDecorationStyle"],textEmphasis:["textEmphasisColor","textEmphasisStyle"],transition:["transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction"],wordWrap:["overflowWrap"]},Nl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function ep(r,a){return r+a.charAt(0).toUpperCase()+a.substring(1)}var Er=["Webkit","ms","Moz","O"];Object.keys(Nl).forEach(function(r){Er.forEach(function(a){Nl[ep(a,r)]=Nl[r]})});function an(r,a,o){var u=a==null||typeof a=="boolean"||a==="";return u?"":!o&&typeof a=="number"&&a!==0&&!(Nl.hasOwnProperty(r)&&Nl[r])?a+"px":(wr(a,r),(""+a).trim())}var a0=/([A-Z])/g,xc=/^ms-/;function Fa(r){return r.replace(a0,"-$1").toLowerCase().replace(xc,"-ms-")}var Iu=function(){};{var tp=/^(?:webkit|moz|o)[A-Z]/,Ur=/^-ms-/,rp=/-(.)/g,s0=/;\s*$/,ko={},bc={},Mu=!1,i0=!1,Ro=function(r){return r.replace(rp,function(a,o){return o.toUpperCase()})},np=function(r){ko.hasOwnProperty(r)&&ko[r]||(ko[r]=!0,c("Unsupported style property %s. Did you mean %s?",r,Ro(r.replace(Ur,"ms-"))))},ap=function(r){ko.hasOwnProperty(r)&&ko[r]||(ko[r]=!0,c("Unsupported vendor-prefixed style property %s. Did you mean %s?",r,r.charAt(0).toUpperCase()+r.slice(1)))},sp=function(r,a){bc.hasOwnProperty(a)&&bc[a]||(bc[a]=!0,c(`Style property values shouldn't contain a semicolon. Try "%s: %s" instead.`,r,a.replace(s0,"")))},$i=function(r,a){Mu||(Mu=!0,c("`NaN` is an invalid value for the `%s` css style property.",r))},ip=function(r,a){i0||(i0=!0,c("`Infinity` is an invalid value for the `%s` css style property.",r))};Iu=function(r,a){r.indexOf("-")>-1?np(r):tp.test(r)?ap(r):s0.test(a)&&sp(r,a),typeof a=="number"&&(isNaN(a)?$i(r,a):isFinite(a)||ip(r,a))}}var op=Iu;function o0(r){{var a="",o="";for(var u in r)if(r.hasOwnProperty(u)){var m=r[u];if(m!=null){var v=u.indexOf("--")===0;a+=o+(v?u:Fa(u))+":",a+=an(u,m,v),o=";"}}return a||null}}function Nc(r,a){var o=r.style;for(var u in a)if(a.hasOwnProperty(u)){var m=u.indexOf("--")===0;m||op(u,a[u]);var v=an(u,a[u],m);u==="float"&&(u="cssFloat"),m?o.setProperty(u,v):o[u]=v}}function l0(r){return r==null||typeof r=="boolean"||r===""}function c0(r){var a={};for(var o in r)for(var u=ju[o]||[o],m=0;m<u.length;m++)a[u[m]]=o;return a}function Fu(r,a){{if(!a)return;var o=c0(r),u=c0(a),m={};for(var v in o){var N=o[v],k=u[v];if(k&&N!==k){var M=N+","+k;if(m[M])continue;m[M]=!0,c("%s a style property during rerender (%s) when a conflicting property is set (%s) can lead to styling bugs. To avoid this, don't mix shorthand and non-shorthand properties for the same value; instead, replace the shorthand with separate values.",l0(r[N])?"Removing":"Updating",N,k)}}}}var Dl={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},lp=ot({menuitem:!0},Dl),cp="__html";function $u(r,a){if(a){if(lp[r]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw new Error(r+" is a void element tag and must neither have `children` nor use `dangerouslySetInnerHTML`.");if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw new Error("Can only set one of `children` or `props.dangerouslySetInnerHTML`.");if(typeof a.dangerouslySetInnerHTML!="object"||!(cp in a.dangerouslySetInnerHTML))throw new Error("`props.dangerouslySetInnerHTML` must be in the form `{__html: ...}`. Please visit https://reactjs.org/link/dangerously-set-inner-html for more information.")}if(!a.suppressContentEditableWarning&&a.contentEditable&&a.children!=null&&c("A component is `contentEditable` and contains `children` managed by React. It is now your responsibility to guarantee that none of those nodes are unexpectedly modified or duplicated. This is probably not intentional."),a.style!=null&&typeof a.style!="object")throw new Error("The `style` prop expects a mapping from style properties to values, not a string. For example, style={{marginRight: spacing + 'em'}} when using JSX.")}}function Bi(r,a){if(r.indexOf("-")===-1)return typeof a.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hi={accept:"accept",acceptcharset:"acceptCharset","accept-charset":"acceptCharset",accesskey:"accessKey",action:"action",allowfullscreen:"allowFullScreen",alt:"alt",as:"as",async:"async",autocapitalize:"autoCapitalize",autocomplete:"autoComplete",autocorrect:"autoCorrect",autofocus:"autoFocus",autoplay:"autoPlay",autosave:"autoSave",capture:"capture",cellpadding:"cellPadding",cellspacing:"cellSpacing",challenge:"challenge",charset:"charSet",checked:"checked",children:"children",cite:"cite",class:"className",classid:"classID",classname:"className",cols:"cols",colspan:"colSpan",content:"content",contenteditable:"contentEditable",contextmenu:"contextMenu",controls:"controls",controlslist:"controlsList",coords:"coords",crossorigin:"crossOrigin",dangerouslysetinnerhtml:"dangerouslySetInnerHTML",data:"data",datetime:"dateTime",default:"default",defaultchecked:"defaultChecked",defaultvalue:"defaultValue",defer:"defer",dir:"dir",disabled:"disabled",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback",download:"download",draggable:"draggable",enctype:"encType",enterkeyhint:"enterKeyHint",for:"htmlFor",form:"form",formmethod:"formMethod",formaction:"formAction",formenctype:"formEncType",formnovalidate:"formNoValidate",formtarget:"formTarget",frameborder:"frameBorder",headers:"headers",height:"height",hidden:"hidden",high:"high",href:"href",hreflang:"hrefLang",htmlfor:"htmlFor",httpequiv:"httpEquiv","http-equiv":"httpEquiv",icon:"icon",id:"id",imagesizes:"imageSizes",imagesrcset:"imageSrcSet",innerhtml:"innerHTML",inputmode:"inputMode",integrity:"integrity",is:"is",itemid:"itemID",itemprop:"itemProp",itemref:"itemRef",itemscope:"itemScope",itemtype:"itemType",keyparams:"keyParams",keytype:"keyType",kind:"kind",label:"label",lang:"lang",list:"list",loop:"loop",low:"low",manifest:"manifest",marginwidth:"marginWidth",marginheight:"marginHeight",max:"max",maxlength:"maxLength",media:"media",mediagroup:"mediaGroup",method:"method",min:"min",minlength:"minLength",multiple:"multiple",muted:"muted",name:"name",nomodule:"noModule",nonce:"nonce",novalidate:"noValidate",open:"open",optimum:"optimum",pattern:"pattern",placeholder:"placeholder",playsinline:"playsInline",poster:"poster",preload:"preload",profile:"profile",radiogroup:"radioGroup",readonly:"readOnly",referrerpolicy:"referrerPolicy",rel:"rel",required:"required",reversed:"reversed",role:"role",rows:"rows",rowspan:"rowSpan",sandbox:"sandbox",scope:"scope",scoped:"scoped",scrolling:"scrolling",seamless:"seamless",selected:"selected",shape:"shape",size:"size",sizes:"sizes",span:"span",spellcheck:"spellCheck",src:"src",srcdoc:"srcDoc",srclang:"srcLang",srcset:"srcSet",start:"start",step:"step",style:"style",summary:"summary",tabindex:"tabIndex",target:"target",title:"title",type:"type",usemap:"useMap",value:"value",width:"width",wmode:"wmode",wrap:"wrap",about:"about",accentheight:"accentHeight","accent-height":"accentHeight",accumulate:"accumulate",additive:"additive",alignmentbaseline:"alignmentBaseline","alignment-baseline":"alignmentBaseline",allowreorder:"allowReorder",alphabetic:"alphabetic",amplitude:"amplitude",arabicform:"arabicForm","arabic-form":"arabicForm",ascent:"ascent",attributename:"attributeName",attributetype:"attributeType",autoreverse:"autoReverse",azimuth:"azimuth",basefrequency:"baseFrequency",baselineshift:"baselineShift","baseline-shift":"baselineShift",baseprofile:"baseProfile",bbox:"bbox",begin:"begin",bias:"bias",by:"by",calcmode:"calcMode",capheight:"capHeight","cap-height":"capHeight",clip:"clip",clippath:"clipPath","clip-path":"clipPath",clippathunits:"clipPathUnits",cliprule:"clipRule","clip-rule":"clipRule",color:"color",colorinterpolation:"colorInterpolation","color-interpolation":"colorInterpolation",colorinterpolationfilters:"colorInterpolationFilters","color-interpolation-filters":"colorInterpolationFilters",colorprofile:"colorProfile","color-profile":"colorProfile",colorrendering:"colorRendering","color-rendering":"colorRendering",contentscripttype:"contentScriptType",contentstyletype:"contentStyleType",cursor:"cursor",cx:"cx",cy:"cy",d:"d",datatype:"datatype",decelerate:"decelerate",descent:"descent",diffuseconstant:"diffuseConstant",direction:"direction",display:"display",divisor:"divisor",dominantbaseline:"dominantBaseline","dominant-baseline":"dominantBaseline",dur:"dur",dx:"dx",dy:"dy",edgemode:"edgeMode",elevation:"elevation",enablebackground:"enableBackground","enable-background":"enableBackground",end:"end",exponent:"exponent",externalresourcesrequired:"externalResourcesRequired",fill:"fill",fillopacity:"fillOpacity","fill-opacity":"fillOpacity",fillrule:"fillRule","fill-rule":"fillRule",filter:"filter",filterres:"filterRes",filterunits:"filterUnits",floodopacity:"floodOpacity","flood-opacity":"floodOpacity",floodcolor:"floodColor","flood-color":"floodColor",focusable:"focusable",fontfamily:"fontFamily","font-family":"fontFamily",fontsize:"fontSize","font-size":"fontSize",fontsizeadjust:"fontSizeAdjust","font-size-adjust":"fontSizeAdjust",fontstretch:"fontStretch","font-stretch":"fontStretch",fontstyle:"fontStyle","font-style":"fontStyle",fontvariant:"fontVariant","font-variant":"fontVariant",fontweight:"fontWeight","font-weight":"fontWeight",format:"format",from:"from",fx:"fx",fy:"fy",g1:"g1",g2:"g2",glyphname:"glyphName","glyph-name":"glyphName",glyphorientationhorizontal:"glyphOrientationHorizontal","glyph-orientation-horizontal":"glyphOrientationHorizontal",glyphorientationvertical:"glyphOrientationVertical","glyph-orientation-vertical":"glyphOrientationVertical",glyphref:"glyphRef",gradienttransform:"gradientTransform",gradientunits:"gradientUnits",hanging:"hanging",horizadvx:"horizAdvX","horiz-adv-x":"horizAdvX",horizoriginx:"horizOriginX","horiz-origin-x":"horizOriginX",ideographic:"ideographic",imagerendering:"imageRendering","image-rendering":"imageRendering",in2:"in2",in:"in",inlist:"inlist",intercept:"intercept",k1:"k1",k2:"k2",k3:"k3",k4:"k4",k:"k",kernelmatrix:"kernelMatrix",kernelunitlength:"kernelUnitLength",kerning:"kerning",keypoints:"keyPoints",keysplines:"keySplines",keytimes:"keyTimes",lengthadjust:"lengthAdjust",letterspacing:"letterSpacing","letter-spacing":"letterSpacing",lightingcolor:"lightingColor","lighting-color":"lightingColor",limitingconeangle:"limitingConeAngle",local:"local",markerend:"markerEnd","marker-end":"markerEnd",markerheight:"markerHeight",markermid:"markerMid","marker-mid":"markerMid",markerstart:"markerStart","marker-start":"markerStart",markerunits:"markerUnits",markerwidth:"markerWidth",mask:"mask",maskcontentunits:"maskContentUnits",maskunits:"maskUnits",mathematical:"mathematical",mode:"mode",numoctaves:"numOctaves",offset:"offset",opacity:"opacity",operator:"operator",order:"order",orient:"orient",orientation:"orientation",origin:"origin",overflow:"overflow",overlineposition:"overlinePosition","overline-position":"overlinePosition",overlinethickness:"overlineThickness","overline-thickness":"overlineThickness",paintorder:"paintOrder","paint-order":"paintOrder",panose1:"panose1","panose-1":"panose1",pathlength:"pathLength",patterncontentunits:"patternContentUnits",patterntransform:"patternTransform",patternunits:"patternUnits",pointerevents:"pointerEvents","pointer-events":"pointerEvents",points:"points",pointsatx:"pointsAtX",pointsaty:"pointsAtY",pointsatz:"pointsAtZ",prefix:"prefix",preservealpha:"preserveAlpha",preserveaspectratio:"preserveAspectRatio",primitiveunits:"primitiveUnits",property:"property",r:"r",radius:"radius",refx:"refX",refy:"refY",renderingintent:"renderingIntent","rendering-intent":"renderingIntent",repeatcount:"repeatCount",repeatdur:"repeatDur",requiredextensions:"requiredExtensions",requiredfeatures:"requiredFeatures",resource:"resource",restart:"restart",result:"result",results:"results",rotate:"rotate",rx:"rx",ry:"ry",scale:"scale",security:"security",seed:"seed",shaperendering:"shapeRendering","shape-rendering":"shapeRendering",slope:"slope",spacing:"spacing",specularconstant:"specularConstant",specularexponent:"specularExponent",speed:"speed",spreadmethod:"spreadMethod",startoffset:"startOffset",stddeviation:"stdDeviation",stemh:"stemh",stemv:"stemv",stitchtiles:"stitchTiles",stopcolor:"stopColor","stop-color":"stopColor",stopopacity:"stopOpacity","stop-opacity":"stopOpacity",strikethroughposition:"strikethroughPosition","strikethrough-position":"strikethroughPosition",strikethroughthickness:"strikethroughThickness","strikethrough-thickness":"strikethroughThickness",string:"string",stroke:"stroke",strokedasharray:"strokeDasharray","stroke-dasharray":"strokeDasharray",strokedashoffset:"strokeDashoffset","stroke-dashoffset":"strokeDashoffset",strokelinecap:"strokeLinecap","stroke-linecap":"strokeLinecap",strokelinejoin:"strokeLinejoin","stroke-linejoin":"strokeLinejoin",strokemiterlimit:"strokeMiterlimit","stroke-miterlimit":"strokeMiterlimit",strokewidth:"strokeWidth","stroke-width":"strokeWidth",strokeopacity:"strokeOpacity","stroke-opacity":"strokeOpacity",suppresscontenteditablewarning:"suppressContentEditableWarning",suppresshydrationwarning:"suppressHydrationWarning",surfacescale:"surfaceScale",systemlanguage:"systemLanguage",tablevalues:"tableValues",targetx:"targetX",targety:"targetY",textanchor:"textAnchor","text-anchor":"textAnchor",textdecoration:"textDecoration","text-decoration":"textDecoration",textlength:"textLength",textrendering:"textRendering","text-rendering":"textRendering",to:"to",transform:"transform",typeof:"typeof",u1:"u1",u2:"u2",underlineposition:"underlinePosition","underline-position":"underlinePosition",underlinethickness:"underlineThickness","underline-thickness":"underlineThickness",unicode:"unicode",unicodebidi:"unicodeBidi","unicode-bidi":"unicodeBidi",unicoderange:"unicodeRange","unicode-range":"unicodeRange",unitsperem:"unitsPerEm","units-per-em":"unitsPerEm",unselectable:"unselectable",valphabetic:"vAlphabetic","v-alphabetic":"vAlphabetic",values:"values",vectoreffect:"vectorEffect","vector-effect":"vectorEffect",version:"version",vertadvy:"vertAdvY","vert-adv-y":"vertAdvY",vertoriginx:"vertOriginX","vert-origin-x":"vertOriginX",vertoriginy:"vertOriginY","vert-origin-y":"vertOriginY",vhanging:"vHanging","v-hanging":"vHanging",videographic:"vIdeographic","v-ideographic":"vIdeographic",viewbox:"viewBox",viewtarget:"viewTarget",visibility:"visibility",vmathematical:"vMathematical","v-mathematical":"vMathematical",vocab:"vocab",widths:"widths",wordspacing:"wordSpacing","word-spacing":"wordSpacing",writingmode:"writingMode","writing-mode":"writingMode",x1:"x1",x2:"x2",x:"x",xchannelselector:"xChannelSelector",xheight:"xHeight","x-height":"xHeight",xlinkactuate:"xlinkActuate","xlink:actuate":"xlinkActuate",xlinkarcrole:"xlinkArcrole","xlink:arcrole":"xlinkArcrole",xlinkhref:"xlinkHref","xlink:href":"xlinkHref",xlinkrole:"xlinkRole","xlink:role":"xlinkRole",xlinkshow:"xlinkShow","xlink:show":"xlinkShow",xlinktitle:"xlinkTitle","xlink:title":"xlinkTitle",xlinktype:"xlinkType","xlink:type":"xlinkType",xmlbase:"xmlBase","xml:base":"xmlBase",xmllang:"xmlLang","xml:lang":"xmlLang",xmlns:"xmlns","xml:space":"xmlSpace",xmlnsxlink:"xmlnsXlink","xmlns:xlink":"xmlnsXlink",xmlspace:"xmlSpace",y1:"y1",y2:"y2",y:"y",ychannelselector:"yChannelSelector",z:"z",zoomandpan:"zoomAndPan"},u0={"aria-current":0,"aria-description":0,"aria-details":0,"aria-disabled":0,"aria-hidden":0,"aria-invalid":0,"aria-keyshortcuts":0,"aria-label":0,"aria-roledescription":0,"aria-autocomplete":0,"aria-checked":0,"aria-expanded":0,"aria-haspopup":0,"aria-level":0,"aria-modal":0,"aria-multiline":0,"aria-multiselectable":0,"aria-orientation":0,"aria-placeholder":0,"aria-pressed":0,"aria-readonly":0,"aria-required":0,"aria-selected":0,"aria-sort":0,"aria-valuemax":0,"aria-valuemin":0,"aria-valuenow":0,"aria-valuetext":0,"aria-atomic":0,"aria-busy":0,"aria-live":0,"aria-relevant":0,"aria-dropeffect":0,"aria-grabbed":0,"aria-activedescendant":0,"aria-colcount":0,"aria-colindex":0,"aria-colspan":0,"aria-controls":0,"aria-describedby":0,"aria-errormessage":0,"aria-flowto":0,"aria-labelledby":0,"aria-owns":0,"aria-posinset":0,"aria-rowcount":0,"aria-rowindex":0,"aria-rowspan":0,"aria-setsize":0},To={},up=new RegExp("^(aria)-["+$e+"]*$"),dp=new RegExp("^(aria)[A-Z]["+$e+"]*$");function ps(r,a){{if(oe.call(To,a)&&To[a])return!0;if(dp.test(a)){var o="aria-"+a.slice(4).toLowerCase(),u=u0.hasOwnProperty(o)?o:null;if(u==null)return c("Invalid ARIA attribute `%s`. ARIA attributes follow the pattern aria-* and must be lowercase.",a),To[a]=!0,!0;if(a!==u)return c("Invalid ARIA attribute `%s`. Did you mean `%s`?",a,u),To[a]=!0,!0}if(up.test(a)){var m=a.toLowerCase(),v=u0.hasOwnProperty(m)?m:null;if(v==null)return To[a]=!0,!1;if(a!==v)return c("Unknown ARIA attribute `%s`. Did you mean `%s`?",a,v),To[a]=!0,!0}}return!0}function fp(r,a){{var o=[];for(var u in a){var m=ps(r,u);m||o.push(u)}var v=o.map(function(N){return"`"+N+"`"}).join(", ");o.length===1?c("Invalid aria prop %s on <%s> tag. For details, see https://reactjs.org/link/invalid-aria-props",v,r):o.length>1&&c("Invalid aria props %s on <%s> tag. For details, see https://reactjs.org/link/invalid-aria-props",v,r)}}function mp(r,a){Bi(r,a)||fp(r,a)}var Bu=!1;function Hu(r,a){{if(r!=="input"&&r!=="textarea"&&r!=="select")return;a!=null&&a.value===null&&!Bu&&(Bu=!0,r==="select"&&a.multiple?c("`value` prop on `%s` should not be null. Consider using an empty array when `multiple` is set to `true` to clear the component or `undefined` for uncontrolled components.",r):c("`value` prop on `%s` should not be null. Consider using an empty string to clear the component or `undefined` for uncontrolled components.",r))}}var d0=function(){};{var Jn={},f0=/^on./,hp=/^on[^A-Z]/,pp=new RegExp("^(aria)-["+$e+"]*$"),vp=new RegExp("^(aria)[A-Z]["+$e+"]*$");d0=function(r,a,o,u){if(oe.call(Jn,a)&&Jn[a])return!0;var m=a.toLowerCase();if(m==="onfocusin"||m==="onfocusout")return c("React uses onFocus and onBlur instead of onFocusIn and onFocusOut. All React events are normalized to bubble, so onFocusIn and onFocusOut are not needed/supported by React."),Jn[a]=!0,!0;if(u!=null){var v=u.registrationNameDependencies,N=u.possibleRegistrationNames;if(v.hasOwnProperty(a))return!0;var k=N.hasOwnProperty(m)?N[m]:null;if(k!=null)return c("Invalid event handler property `%s`. Did you mean `%s`?",a,k),Jn[a]=!0,!0;if(f0.test(a))return c("Unknown event handler property `%s`. It will be ignored.",a),Jn[a]=!0,!0}else if(f0.test(a))return hp.test(a)&&c("Invalid event handler property `%s`. React events use the camelCase naming convention, for example `onClick`.",a),Jn[a]=!0,!0;if(pp.test(a)||vp.test(a))return!0;if(m==="innerhtml")return c("Directly setting property `innerHTML` is not permitted. For more information, lookup documentation on `dangerouslySetInnerHTML`."),Jn[a]=!0,!0;if(m==="aria")return c("The `aria` attribute is reserved for future use in React. Pass individual `aria-` attributes instead."),Jn[a]=!0,!0;if(m==="is"&&o!==null&&o!==void 0&&typeof o!="string")return c("Received a `%s` for a string attribute `is`. If this is expected, cast the value to a string.",typeof o),Jn[a]=!0,!0;if(typeof o=="number"&&isNaN(o))return c("Received NaN for the `%s` attribute. If this is expected, cast the value to a string.",a),Jn[a]=!0,!0;var M=Yt(a),te=M!==null&&M.type===Ve;if(Hi.hasOwnProperty(m)){var le=Hi[m];if(le!==a)return c("Invalid DOM property `%s`. Did you mean `%s`?",a,le),Jn[a]=!0,!0}else if(!te&&a!==m)return c("React does not recognize the `%s` prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase `%s` instead. If you accidentally passed it from a parent component, remove it from the DOM element.",a,m),Jn[a]=!0,!0;return typeof o=="boolean"&&Ft(a,o,M,!1)?(o?c('Received `%s` for a non-boolean attribute `%s`.\n\nIf you want to write it to the DOM, pass a string instead: %s="%s" or %s={value.toString()}.',o,a,a,o,a):c('Received `%s` for a non-boolean attribute `%s`.\n\nIf you want to write it to the DOM, pass a string instead: %s="%s" or %s={value.toString()}.\n\nIf you used to conditionally omit it with %s={condition && value}, pass %s={condition ? value : undefined} instead.',o,a,a,o,a,a,a),Jn[a]=!0,!0):te?!0:Ft(a,o,M,!1)?(Jn[a]=!0,!1):((o==="false"||o==="true")&&M!==null&&M.type===Be&&(c("Received the string `%s` for the boolean attribute `%s`. %s Did you mean %s={%s}?",o,a,o==="false"?"The browser will interpret it as a truthy value.":'Although this works, it will not work as expected if you pass the string "false".',a,o),Jn[a]=!0),!0)}}var m0=function(r,a,o){{var u=[];for(var m in a){var v=d0(r,m,a[m],o);v||u.push(m)}var N=u.map(function(k){return"`"+k+"`"}).join(", ");u.length===1?c("Invalid value for prop %s on <%s> tag. Either remove it from the element, or pass a string or number value to keep it in the DOM. For details, see https://reactjs.org/link/attribute-behavior ",N,r):u.length>1&&c("Invalid values for props %s on <%s> tag. Either remove them from the element, or pass a string or number value to keep them in the DOM. For details, see https://reactjs.org/link/attribute-behavior ",N,r)}};function gp(r,a,o){Bi(r,a)||m0(r,a,o)}var Br=1,Dc=2,Sl=4,xp=Br|Dc|Sl,Wi=null;function bp(r){Wi!==null&&c("Expected currently replaying event to be null. This error is likely caused by a bug in React. Please file an issue."),Wi=r}function Np(){Wi===null&&c("Expected currently replaying event to not be null. This error is likely caused by a bug in React. Please file an issue."),Wi=null}function Dp(r){return r===Wi}function Wu(r){var a=r.target||r.srcElement||window;return a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===Vs?a.parentNode:a}var Sc=null,_o=null,fi=null;function Qa(r){var a=Fo(r);if(a){if(typeof Sc!="function")throw new Error("setRestoreImplementation() needs to be called to handle a target for controlled events. This error is likely caused by a bug in React. Please file an issue.");var o=a.stateNode;if(o){var u=G0(o);Sc(a.stateNode,a.type,u)}}}function h(r){Sc=r}function C(r){_o?fi?fi.push(r):fi=[r]:_o=r}function D(){return _o!==null||fi!==null}function V(){if(_o){var r=_o,a=fi;if(_o=null,fi=null,Qa(r),a)for(var o=0;o<a.length;o++)Qa(a[o])}}var re=function(r,a){return r(a)},ue=function(){},be=!1;function ke(){var r=D();r&&(ue(),V())}function Fe(r,a,o){if(be)return r(a,o);be=!0;try{return re(r,a,o)}finally{be=!1,ke()}}function qe(r,a,o){re=r,ue=o}function nt(r){return r==="button"||r==="input"||r==="select"||r==="textarea"}function mt(r,a,o){switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":return!!(o.disabled&&nt(a));default:return!1}}function Pt(r,a){var o=r.stateNode;if(o===null)return null;var u=G0(o);if(u===null)return null;var m=u[a];if(mt(a,r.type,u))return null;if(m&&typeof m!="function")throw new Error("Expected `"+a+"` listener to be a function, instead got a value of `"+typeof m+"` type.");return m}var $t=!1;if(ze)try{var Kr={};Object.defineProperty(Kr,"passive",{get:function(){$t=!0}}),window.addEventListener("test",Kr,Kr),window.removeEventListener("test",Kr,Kr)}catch{$t=!1}function Jr(r,a,o,u,m,v,N,k,M){var te=Array.prototype.slice.call(arguments,3);try{a.apply(o,te)}catch(le){this.onError(le)}}var Za=Jr;if(typeof window<"u"&&typeof window.dispatchEvent=="function"&&typeof document<"u"&&typeof document.createEvent=="function"){var $a=document.createElement("react");Za=function(a,o,u,m,v,N,k,M,te){if(typeof document>"u"||document===null)throw new Error("The `document` global was defined when React was initialized, but is not defined anymore. This can happen in a test environment if a component schedules an update from an asynchronous callback, but the test has already finished running. To solve this, you can either unmount the component at the end of your test (and ensure that any asynchronous operations get canceled in `componentWillUnmount`), or you can change the test itself to be asynchronous.");var le=document.createEvent("Event"),De=!1,Ne=!0,Ae=window.event,Ie=Object.getOwnPropertyDescriptor(window,"event");function He(){$a.removeEventListener(We,Ut,!1),typeof window.event<"u"&&window.hasOwnProperty("event")&&(window.event=Ae)}var dt=Array.prototype.slice.call(arguments,3);function Ut(){De=!0,He(),o.apply(u,dt),Ne=!1}var Rt,cr=!1,sr=!1;function Te(_e){if(Rt=_e.error,cr=!0,Rt===null&&_e.colno===0&&_e.lineno===0&&(sr=!0),_e.defaultPrevented&&Rt!=null&&typeof Rt=="object")try{Rt._suppressLogging=!0}catch{}}var We="react-"+(a||"invokeguardedcallback");if(window.addEventListener("error",Te),$a.addEventListener(We,Ut,!1),le.initEvent(We,!1,!1),$a.dispatchEvent(le),Ie&&Object.defineProperty(window,"event",Ie),De&&Ne&&(cr?sr&&(Rt=new Error("A cross-origin error was thrown. React doesn't have access to the actual error object in development. See https://reactjs.org/link/crossorigin-error for more information.")):Rt=new Error(`An error was thrown inside one of your components, but React doesn't know what it was. This is likely due to browser flakiness. React does its best to preserve the "Pause on exceptions" behavior of the DevTools, which requires some DEV-mode only tricks. It's possible that these don't work in your browser. Try triggering the error in production mode, or switching to a modern browser. If you suspect that this is actually an issue with React, please file an issue.`),this.onError(Rt)),window.removeEventListener("error",Te),!De)return He(),Jr.apply(this,arguments)}}var zu=Za,Is=!1,yc=null,Oc=!1,Xu=null,Gu={onError:function(r){Is=!0,yc=r}};function Yu(r,a,o,u,m,v,N,k,M){Is=!1,yc=null,zu.apply(Gu,arguments)}function Sp(r,a,o,u,m,v,N,k,M){if(Yu.apply(this,arguments),Is){var te=Op();Oc||(Oc=!0,Xu=te)}}function yp(){if(Oc){var r=Xu;throw Oc=!1,Xu=null,r}}function nk(){return Is}function Op(){if(Is){var r=yc;return Is=!1,yc=null,r}else throw new Error("clearCaughtError was called but no error was captured. This error is likely caused by a bug in React. Please file an issue.")}function Ec(r){return r._reactInternals}function ak(r){return r._reactInternals!==void 0}function sk(r,a){r._reactInternals=a}var Vt=0,wc=1,dn=2,Nr=4,yl=16,qu=32,UN=64,Dr=128,zi=256,Ol=512,Cc=1024,Po=2048,Xi=4096,El=8192,Ep=16384,ik=32767,h0=32768,ka=65536,wp=131072,AN=1048576,Cp=2097152,wl=4194304,kp=8388608,Uo=16777216,Rp=33554432,Tp=Nr|Cc|0,_p=dn|Nr|yl|qu|Ol|Xi|El,Ku=Nr|UN|Ol|El,kc=Po|yl,Gi=wl|kp|Cp,ok=e.ReactCurrentOwner;function Cl(r){var a=r,o=r;if(r.alternate)for(;a.return;)a=a.return;else{var u=a;do a=u,(a.flags&(dn|Xi))!==Vt&&(o=a.return),u=a.return;while(u)}return a.tag===b?o:null}function LN(r){if(r.tag===ee){var a=r.memoizedState;if(a===null){var o=r.alternate;o!==null&&(a=o.memoizedState)}if(a!==null)return a.dehydrated}return null}function VN(r){return r.tag===b?r.stateNode.containerInfo:null}function lk(r){return Cl(r)===r}function ck(r){{var a=ok.current;if(a!==null&&a.tag===g){var o=a,u=o.stateNode;u._warnedAboutRefsInRender||c("%s is accessing isMounted inside its render() function. render() should be a pure function of props and state. It should never access something that requires stale data from the previous render, such as refs. Move this logic to componentDidMount and componentDidUpdate instead.",jt(o)||"A component"),u._warnedAboutRefsInRender=!0}}var m=Ec(r);return m?Cl(m)===m:!1}function jN(r){if(Cl(r)!==r)throw new Error("Unable to find node on an unmounted component.")}function IN(r){var a=r.alternate;if(!a){var o=Cl(r);if(o===null)throw new Error("Unable to find node on an unmounted component.");return o!==r?null:r}for(var u=r,m=a;;){var v=u.return;if(v===null)break;var N=v.alternate;if(N===null){var k=v.return;if(k!==null){u=m=k;continue}break}if(v.child===N.child){for(var M=v.child;M;){if(M===u)return jN(v),r;if(M===m)return jN(v),a;M=M.sibling}throw new Error("Unable to find node on an unmounted component.")}if(u.return!==m.return)u=v,m=N;else{for(var te=!1,le=v.child;le;){if(le===u){te=!0,u=v,m=N;break}if(le===m){te=!0,m=v,u=N;break}le=le.sibling}if(!te){for(le=N.child;le;){if(le===u){te=!0,u=N,m=v;break}if(le===m){te=!0,m=N,u=v;break}le=le.sibling}if(!te)throw new Error("Child was not found in either parent set. This indicates a bug in React related to the return pointer. Please file an issue.")}}if(u.alternate!==m)throw new Error("Return fibers should always be each others' alternates. This error is likely caused by a bug in React. Please file an issue.")}if(u.tag!==b)throw new Error("Unable to find node on an unmounted component.");return u.stateNode.current===u?r:a}function MN(r){var a=IN(r);return a!==null?FN(a):null}function FN(r){if(r.tag===w||r.tag===R)return r;for(var a=r.child;a!==null;){var o=FN(a);if(o!==null)return o;a=a.sibling}return null}function uk(r){var a=IN(r);return a!==null?$N(a):null}function $N(r){if(r.tag===w||r.tag===R)return r;for(var a=r.child;a!==null;){if(a.tag!==E){var o=$N(a);if(o!==null)return o}a=a.sibling}return null}var BN=n.unstable_scheduleCallback,dk=n.unstable_cancelCallback,fk=n.unstable_shouldYield,mk=n.unstable_requestPaint,In=n.unstable_now,hk=n.unstable_getCurrentPriorityLevel,p0=n.unstable_ImmediatePriority,Pp=n.unstable_UserBlockingPriority,kl=n.unstable_NormalPriority,pk=n.unstable_LowPriority,Up=n.unstable_IdlePriority,vk=n.unstable_yieldValue,gk=n.unstable_setDisableYieldValue,Rc=null,fa=null,pt=null,mi=!1,Ms=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u";function xk(r){if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")return!1;var a=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(a.isDisabled)return!0;if(!a.supportsFiber)return c("The installed version of React DevTools is too old and will not work with the current version of React. Please update React DevTools. https://reactjs.org/link/react-devtools"),!0;try{X&&(r=ot({},r,{getLaneLabelMap:Ok,injectProfilingHooks:yk})),Rc=a.inject(r),fa=a}catch(o){c("React instrumentation encountered an error: %s.",o)}return!!a.checkDCE}function bk(r,a){if(fa&&typeof fa.onScheduleFiberRoot=="function")try{fa.onScheduleFiberRoot(Rc,r,a)}catch(o){mi||(mi=!0,c("React instrumentation encountered an error: %s",o))}}function Nk(r,a){if(fa&&typeof fa.onCommitFiberRoot=="function")try{var o=(r.current.flags&Dr)===Dr;if(T){var u;switch(a){case rs:u=p0;break;case qi:u=Pp;break;case Ki:u=kl;break;case S0:u=Up;break;default:u=kl;break}fa.onCommitFiberRoot(Rc,r,u,o)}}catch(m){mi||(mi=!0,c("React instrumentation encountered an error: %s",m))}}function Dk(r){if(fa&&typeof fa.onPostCommitFiberRoot=="function")try{fa.onPostCommitFiberRoot(Rc,r)}catch(a){mi||(mi=!0,c("React instrumentation encountered an error: %s",a))}}function Sk(r){if(fa&&typeof fa.onCommitFiberUnmount=="function")try{fa.onCommitFiberUnmount(Rc,r)}catch(a){mi||(mi=!0,c("React instrumentation encountered an error: %s",a))}}function Mn(r){if(typeof vk=="function"&&(gk(r),i(r)),fa&&typeof fa.setStrictMode=="function")try{fa.setStrictMode(Rc,r)}catch(a){mi||(mi=!0,c("React instrumentation encountered an error: %s",a))}}function yk(r){pt=r}function Ok(){{for(var r=new Map,a=1,o=0;o<Lp;o++){var u=Wk(a);r.set(a,u),a*=2}return r}}function Ek(r){pt!==null&&typeof pt.markCommitStarted=="function"&&pt.markCommitStarted(r)}function HN(){pt!==null&&typeof pt.markCommitStopped=="function"&&pt.markCommitStopped()}function Ju(r){pt!==null&&typeof pt.markComponentRenderStarted=="function"&&pt.markComponentRenderStarted(r)}function Tc(){pt!==null&&typeof pt.markComponentRenderStopped=="function"&&pt.markComponentRenderStopped()}function wk(r){pt!==null&&typeof pt.markComponentPassiveEffectMountStarted=="function"&&pt.markComponentPassiveEffectMountStarted(r)}function Ck(){pt!==null&&typeof pt.markComponentPassiveEffectMountStopped=="function"&&pt.markComponentPassiveEffectMountStopped()}function kk(r){pt!==null&&typeof pt.markComponentPassiveEffectUnmountStarted=="function"&&pt.markComponentPassiveEffectUnmountStarted(r)}function Rk(){pt!==null&&typeof pt.markComponentPassiveEffectUnmountStopped=="function"&&pt.markComponentPassiveEffectUnmountStopped()}function Tk(r){pt!==null&&typeof pt.markComponentLayoutEffectMountStarted=="function"&&pt.markComponentLayoutEffectMountStarted(r)}function _k(){pt!==null&&typeof pt.markComponentLayoutEffectMountStopped=="function"&&pt.markComponentLayoutEffectMountStopped()}function WN(r){pt!==null&&typeof pt.markComponentLayoutEffectUnmountStarted=="function"&&pt.markComponentLayoutEffectUnmountStarted(r)}function zN(){pt!==null&&typeof pt.markComponentLayoutEffectUnmountStopped=="function"&&pt.markComponentLayoutEffectUnmountStopped()}function Pk(r,a,o){pt!==null&&typeof pt.markComponentErrored=="function"&&pt.markComponentErrored(r,a,o)}function Uk(r,a,o){pt!==null&&typeof pt.markComponentSuspended=="function"&&pt.markComponentSuspended(r,a,o)}function Ak(r){pt!==null&&typeof pt.markLayoutEffectsStarted=="function"&&pt.markLayoutEffectsStarted(r)}function Lk(){pt!==null&&typeof pt.markLayoutEffectsStopped=="function"&&pt.markLayoutEffectsStopped()}function Vk(r){pt!==null&&typeof pt.markPassiveEffectsStarted=="function"&&pt.markPassiveEffectsStarted(r)}function jk(){pt!==null&&typeof pt.markPassiveEffectsStopped=="function"&&pt.markPassiveEffectsStopped()}function XN(r){pt!==null&&typeof pt.markRenderStarted=="function"&&pt.markRenderStarted(r)}function Ik(){pt!==null&&typeof pt.markRenderYielded=="function"&&pt.markRenderYielded()}function GN(){pt!==null&&typeof pt.markRenderStopped=="function"&&pt.markRenderStopped()}function Mk(r){pt!==null&&typeof pt.markRenderScheduled=="function"&&pt.markRenderScheduled(r)}function Fk(r,a){pt!==null&&typeof pt.markForceUpdateScheduled=="function"&&pt.markForceUpdateScheduled(r,a)}function Ap(r,a){pt!==null&&typeof pt.markStateUpdateScheduled=="function"&&pt.markStateUpdateScheduled(r,a)}var At=0,or=1,kr=2,Qr=8,hi=16,YN=Math.clz32?Math.clz32:Hk,$k=Math.log,Bk=Math.LN2;function Hk(r){var a=r>>>0;return a===0?32:31-($k(a)/Bk|0)|0}var Lp=31,Je=0,Fn=0,Bt=1,_c=2,Yi=4,Rl=8,pi=16,Qu=32,Pc=4194240,Zu=64,Vp=128,jp=256,Ip=512,Mp=1024,Fp=2048,$p=4096,Bp=8192,Hp=16384,Wp=32768,zp=65536,Xp=131072,Gp=262144,Yp=524288,qp=1048576,Kp=2097152,v0=130023424,Uc=4194304,Jp=8388608,Qp=16777216,Zp=33554432,ev=67108864,qN=Uc,ed=134217728,KN=268435455,td=268435456,Tl=536870912,es=1073741824;function Wk(r){{if(r&Bt)return"Sync";if(r&_c)return"InputContinuousHydration";if(r&Yi)return"InputContinuous";if(r&Rl)return"DefaultHydration";if(r&pi)return"Default";if(r&Qu)return"TransitionHydration";if(r&Pc)return"Transition";if(r&v0)return"Retry";if(r&ed)return"SelectiveHydration";if(r&td)return"IdleHydration";if(r&Tl)return"Idle";if(r&es)return"Offscreen"}}var Ir=-1,g0=Zu,x0=Uc;function rd(r){switch(_l(r)){case Bt:return Bt;case _c:return _c;case Yi:return Yi;case Rl:return Rl;case pi:return pi;case Qu:return Qu;case Zu:case Vp:case jp:case Ip:case Mp:case Fp:case $p:case Bp:case Hp:case Wp:case zp:case Xp:case Gp:case Yp:case qp:case Kp:return r&Pc;case Uc:case Jp:case Qp:case Zp:case ev:return r&v0;case ed:return ed;case td:return td;case Tl:return Tl;case es:return es;default:return c("Should have found matching lanes. This is a bug in React."),r}}function b0(r,a){var o=r.pendingLanes;if(o===Je)return Je;var u=Je,m=r.suspendedLanes,v=r.pingedLanes,N=o&KN;if(N!==Je){var k=N&~m;if(k!==Je)u=rd(k);else{var M=N&v;M!==Je&&(u=rd(M))}}else{var te=o&~m;te!==Je?u=rd(te):v!==Je&&(u=rd(v))}if(u===Je)return Je;if(a!==Je&&a!==u&&(a&m)===Je){var le=_l(u),De=_l(a);if(le>=De||le===pi&&(De&Pc)!==Je)return a}(u&Yi)!==Je&&(u|=o&pi);var Ne=r.entangledLanes;if(Ne!==Je)for(var Ae=r.entanglements,Ie=u&Ne;Ie>0;){var He=Pl(Ie),dt=1<<He;u|=Ae[He],Ie&=~dt}return u}function zk(r,a){for(var o=r.eventTimes,u=Ir;a>0;){var m=Pl(a),v=1<<m,N=o[m];N>u&&(u=N),a&=~v}return u}function Xk(r,a){switch(r){case Bt:case _c:case Yi:return a+250;case Rl:case pi:case Qu:case Zu:case Vp:case jp:case Ip:case Mp:case Fp:case $p:case Bp:case Hp:case Wp:case zp:case Xp:case Gp:case Yp:case qp:case Kp:return a+5e3;case Uc:case Jp:case Qp:case Zp:case ev:return Ir;case ed:case td:case Tl:case es:return Ir;default:return c("Should have found matching lanes. This is a bug in React."),Ir}}function Gk(r,a){for(var o=r.pendingLanes,u=r.suspendedLanes,m=r.pingedLanes,v=r.expirationTimes,N=o;N>0;){var k=Pl(N),M=1<<k,te=v[k];te===Ir?((M&u)===Je||(M&m)!==Je)&&(v[k]=Xk(M,a)):te<=a&&(r.expiredLanes|=M),N&=~M}}function Yk(r){return rd(r.pendingLanes)}function tv(r){var a=r.pendingLanes&~es;return a!==Je?a:a&es?es:Je}function qk(r){return(r&Bt)!==Je}function rv(r){return(r&KN)!==Je}function JN(r){return(r&v0)===r}function Kk(r){var a=Bt|Yi|pi;return(r&a)===Je}function Jk(r){return(r&Pc)===r}function N0(r,a){var o=_c|Yi|Rl|pi;return(a&o)!==Je}function Qk(r,a){return(a&r.expiredLanes)!==Je}function QN(r){return(r&Pc)!==Je}function ZN(){var r=g0;return g0<<=1,(g0&Pc)===Je&&(g0=Zu),r}function Zk(){var r=x0;return x0<<=1,(x0&v0)===Je&&(x0=Uc),r}function _l(r){return r&-r}function nd(r){return _l(r)}function Pl(r){return 31-YN(r)}function nv(r){return Pl(r)}function ts(r,a){return(r&a)!==Je}function Ac(r,a){return(r&a)===a}function Qt(r,a){return r|a}function D0(r,a){return r&~a}function e1(r,a){return r&a}function S9(r){return r}function eR(r,a){return r!==Fn&&r<a?r:a}function av(r){for(var a=[],o=0;o<Lp;o++)a.push(r);return a}function ad(r,a,o){r.pendingLanes|=a,a!==Tl&&(r.suspendedLanes=Je,r.pingedLanes=Je);var u=r.eventTimes,m=nv(a);u[m]=o}function tR(r,a){r.suspendedLanes|=a,r.pingedLanes&=~a;for(var o=r.expirationTimes,u=a;u>0;){var m=Pl(u),v=1<<m;o[m]=Ir,u&=~v}}function t1(r,a,o){r.pingedLanes|=r.suspendedLanes&a}function rR(r,a){var o=r.pendingLanes&~a;r.pendingLanes=a,r.suspendedLanes=Je,r.pingedLanes=Je,r.expiredLanes&=a,r.mutableReadLanes&=a,r.entangledLanes&=a;for(var u=r.entanglements,m=r.eventTimes,v=r.expirationTimes,N=o;N>0;){var k=Pl(N),M=1<<k;u[k]=Je,m[k]=Ir,v[k]=Ir,N&=~M}}function sv(r,a){for(var o=r.entangledLanes|=a,u=r.entanglements,m=o;m;){var v=Pl(m),N=1<<v;N&a|u[v]&a&&(u[v]|=a),m&=~N}}function nR(r,a){var o=_l(a),u;switch(o){case Yi:u=_c;break;case pi:u=Rl;break;case Zu:case Vp:case jp:case Ip:case Mp:case Fp:case $p:case Bp:case Hp:case Wp:case zp:case Xp:case Gp:case Yp:case qp:case Kp:case Uc:case Jp:case Qp:case Zp:case ev:u=Qu;break;case Tl:u=td;break;default:u=Fn;break}return(u&(r.suspendedLanes|a))!==Fn?Fn:u}function r1(r,a,o){if(Ms)for(var u=r.pendingUpdatersLaneMap;o>0;){var m=nv(o),v=1<<m,N=u[m];N.add(a),o&=~v}}function n1(r,a){if(Ms)for(var o=r.pendingUpdatersLaneMap,u=r.memoizedUpdaters;a>0;){var m=nv(a),v=1<<m,N=o[m];N.size>0&&(N.forEach(function(k){var M=k.alternate;(M===null||!u.has(M))&&u.add(k)}),N.clear()),a&=~v}}function a1(r,a){return null}var rs=Bt,qi=Yi,Ki=pi,S0=Tl,sd=Fn;function Fs(){return sd}function $n(r){sd=r}function aR(r,a){var o=sd;try{return sd=r,a()}finally{sd=o}}function sR(r,a){return r!==0&&r<a?r:a}function iR(r,a){return r>a?r:a}function iv(r,a){return r!==0&&r<a}function s1(r){var a=_l(r);return iv(rs,a)?iv(qi,a)?rv(a)?Ki:S0:qi:rs}function y0(r){var a=r.current.memoizedState;return a.isDehydrated}var i1;function oR(r){i1=r}function lR(r){i1(r)}var ov;function cR(r){ov=r}var o1;function uR(r){o1=r}var l1;function dR(r){l1=r}var c1;function fR(r){c1=r}var lv=!1,O0=[],Ao=null,Lo=null,Vo=null,id=new Map,od=new Map,jo=[],mR=["mousedown","mouseup","touchcancel","touchend","touchstart","auxclick","dblclick","pointercancel","pointerdown","pointerup","dragend","dragstart","drop","compositionend","compositionstart","keydown","keypress","keyup","input","textInput","copy","cut","paste","click","change","contextmenu","reset","submit"];function hR(r){return mR.indexOf(r)>-1}function pR(r,a,o,u,m){return{blockedOn:r,domEventName:a,eventSystemFlags:o,nativeEvent:m,targetContainers:[u]}}function u1(r,a){switch(r){case"focusin":case"focusout":Ao=null;break;case"dragenter":case"dragleave":Lo=null;break;case"mouseover":case"mouseout":Vo=null;break;case"pointerover":case"pointerout":{var o=a.pointerId;id.delete(o);break}case"gotpointercapture":case"lostpointercapture":{var u=a.pointerId;od.delete(u);break}}}function ld(r,a,o,u,m,v){if(r===null||r.nativeEvent!==v){var N=pR(a,o,u,m,v);if(a!==null){var k=Fo(a);k!==null&&ov(k)}return N}r.eventSystemFlags|=u;var M=r.targetContainers;return m!==null&&M.indexOf(m)===-1&&M.push(m),r}function vR(r,a,o,u,m){switch(a){case"focusin":{var v=m;return Ao=ld(Ao,r,a,o,u,v),!0}case"dragenter":{var N=m;return Lo=ld(Lo,r,a,o,u,N),!0}case"mouseover":{var k=m;return Vo=ld(Vo,r,a,o,u,k),!0}case"pointerover":{var M=m,te=M.pointerId;return id.set(te,ld(id.get(te)||null,r,a,o,u,M)),!0}case"gotpointercapture":{var le=m,De=le.pointerId;return od.set(De,ld(od.get(De)||null,r,a,o,u,le)),!0}}return!1}function d1(r){var a=Ll(r.target);if(a!==null){var o=Cl(a);if(o!==null){var u=o.tag;if(u===ee){var m=LN(o);if(m!==null){r.blockedOn=m,c1(r.priority,function(){o1(o)});return}}else if(u===b){var v=o.stateNode;if(y0(v)){r.blockedOn=VN(o);return}}}}r.blockedOn=null}function gR(r){for(var a=l1(),o={blockedOn:null,target:r,priority:a},u=0;u<jo.length&&iv(a,jo[u].priority);u++);jo.splice(u,0,o),u===0&&d1(o)}function E0(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;a.length>0;){var o=a[0],u=dv(r.domEventName,r.eventSystemFlags,o,r.nativeEvent);if(u===null){var m=r.nativeEvent,v=new m.constructor(m.type,m);bp(v),m.target.dispatchEvent(v),Np()}else{var N=Fo(u);return N!==null&&ov(N),r.blockedOn=u,!1}a.shift()}return!0}function f1(r,a,o){E0(r)&&o.delete(a)}function xR(){lv=!1,Ao!==null&&E0(Ao)&&(Ao=null),Lo!==null&&E0(Lo)&&(Lo=null),Vo!==null&&E0(Vo)&&(Vo=null),id.forEach(f1),od.forEach(f1)}function cd(r,a){r.blockedOn===a&&(r.blockedOn=null,lv||(lv=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,xR)))}function ud(r){if(O0.length>0){cd(O0[0],r);for(var a=1;a<O0.length;a++){var o=O0[a];o.blockedOn===r&&(o.blockedOn=null)}}Ao!==null&&cd(Ao,r),Lo!==null&&cd(Lo,r),Vo!==null&&cd(Vo,r);var u=function(k){return cd(k,r)};id.forEach(u),od.forEach(u);for(var m=0;m<jo.length;m++){var v=jo[m];v.blockedOn===r&&(v.blockedOn=null)}for(;jo.length>0;){var N=jo[0];if(N.blockedOn!==null)break;d1(N),N.blockedOn===null&&jo.shift()}}var Lc=e.ReactCurrentBatchConfig,cv=!0;function m1(r){cv=!!r}function bR(){return cv}function NR(r,a,o){var u=h1(a),m;switch(u){case rs:m=DR;break;case qi:m=SR;break;case Ki:default:m=uv;break}return m.bind(null,a,o,r)}function DR(r,a,o,u){var m=Fs(),v=Lc.transition;Lc.transition=null;try{$n(rs),uv(r,a,o,u)}finally{$n(m),Lc.transition=v}}function SR(r,a,o,u){var m=Fs(),v=Lc.transition;Lc.transition=null;try{$n(qi),uv(r,a,o,u)}finally{$n(m),Lc.transition=v}}function uv(r,a,o,u){cv&&yR(r,a,o,u)}function yR(r,a,o,u){var m=dv(r,a,o,u);if(m===null){Ev(r,a,u,w0,o),u1(r,u);return}if(vR(m,r,a,o,u)){u.stopPropagation();return}if(u1(r,u),a&Sl&&hR(r)){for(;m!==null;){var v=Fo(m);v!==null&&lR(v);var N=dv(r,a,o,u);if(N===null&&Ev(r,a,u,w0,o),N===m)break;m=N}m!==null&&u.stopPropagation();return}Ev(r,a,u,null,o)}var w0=null;function dv(r,a,o,u){w0=null;var m=Wu(u),v=Ll(m);if(v!==null){var N=Cl(v);if(N===null)v=null;else{var k=N.tag;if(k===ee){var M=LN(N);if(M!==null)return M;v=null}else if(k===b){var te=N.stateNode;if(y0(te))return VN(N);v=null}else N!==v&&(v=null)}}return w0=v,null}function h1(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return rs;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return qi;case"message":{var a=hk();switch(a){case p0:return rs;case Pp:return qi;case kl:case pk:return Ki;case Up:return S0;default:return Ki}}default:return Ki}}function OR(r,a,o){return r.addEventListener(a,o,!1),o}function ER(r,a,o){return r.addEventListener(a,o,!0),o}function wR(r,a,o,u){return r.addEventListener(a,o,{capture:!0,passive:u}),o}function CR(r,a,o,u){return r.addEventListener(a,o,{passive:u}),o}var dd=null,fv=null,fd=null;function kR(r){return dd=r,fv=v1(),!0}function RR(){dd=null,fv=null,fd=null}function p1(){if(fd)return fd;var r,a=fv,o=a.length,u,m=v1(),v=m.length;for(r=0;r<o&&a[r]===m[r];r++);var N=o-r;for(u=1;u<=N&&a[o-u]===m[v-u];u++);var k=u>1?1-u:void 0;return fd=m.slice(r,k),fd}function v1(){return"value"in dd?dd.value:dd.textContent}function C0(r){var a,o=r.keyCode;return"charCode"in r?(a=r.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),a>=32||a===13?a:0}function k0(){return!0}function g1(){return!1}function ns(r){function a(o,u,m,v,N){this._reactName=o,this._targetInst=m,this.type=u,this.nativeEvent=v,this.target=N,this.currentTarget=null;for(var k in r)if(r.hasOwnProperty(k)){var M=r[k];M?this[k]=M(v):this[k]=v[k]}var te=v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1;return te?this.isDefaultPrevented=k0:this.isDefaultPrevented=g1,this.isPropagationStopped=g1,this}return ot(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=k0)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=k0)},persist:function(){},isPersistent:k0}),a}var Vc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mv=ns(Vc),md=ot({},Vc,{view:0,detail:0}),TR=ns(md),hv,pv,hd;function _R(r){r!==hd&&(hd&&r.type==="mousemove"?(hv=r.screenX-hd.screenX,pv=r.screenY-hd.screenY):(hv=0,pv=0),hd=r)}var R0=ot({},md,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gv,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(_R(r),hv)},movementY:function(r){return"movementY"in r?r.movementY:pv}}),x1=ns(R0),PR=ot({},R0,{dataTransfer:0}),UR=ns(PR),AR=ot({},md,{relatedTarget:0}),vv=ns(AR),LR=ot({},Vc,{animationName:0,elapsedTime:0,pseudoElement:0}),VR=ns(LR),jR=ot({},Vc,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),IR=ns(jR),MR=ot({},Vc,{data:0}),b1=ns(MR),FR=b1,$R={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};function HR(r){if(r.key){var a=$R[r.key]||r.key;if(a!=="Unidentified")return a}if(r.type==="keypress"){var o=C0(r);return o===13?"Enter":String.fromCharCode(o)}return r.type==="keydown"||r.type==="keyup"?BR[r.keyCode]||"Unidentified":""}var WR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zR(r){var a=this,o=a.nativeEvent;if(o.getModifierState)return o.getModifierState(r);var u=WR[r];return u?!!o[u]:!1}function gv(r){return zR}var XR=ot({},md,{key:HR,code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gv,charCode:function(r){return r.type==="keypress"?C0(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?C0(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),GR=ns(XR),YR=ot({},R0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),N1=ns(YR),qR=ot({},md,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gv}),KR=ns(qR),JR=ot({},Vc,{propertyName:0,elapsedTime:0,pseudoElement:0}),QR=ns(JR),ZR=ot({},R0,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),eT=ns(ZR),tT=[9,13,27,32],D1=229,xv=ze&&"CompositionEvent"in window,pd=null;ze&&"documentMode"in document&&(pd=document.documentMode);var rT=ze&&"TextEvent"in window&&!pd,S1=ze&&(!xv||pd&&pd>8&&pd<=11),y1=32,O1=String.fromCharCode(y1);function nT(){fe("onBeforeInput",["compositionend","keypress","textInput","paste"]),fe("onCompositionEnd",["compositionend","focusout","keydown","keypress","keyup","mousedown"]),fe("onCompositionStart",["compositionstart","focusout","keydown","keypress","keyup","mousedown"]),fe("onCompositionUpdate",["compositionupdate","focusout","keydown","keypress","keyup","mousedown"])}var E1=!1;function aT(r){return(r.ctrlKey||r.altKey||r.metaKey)&&!(r.ctrlKey&&r.altKey)}function sT(r){switch(r){case"compositionstart":return"onCompositionStart";case"compositionend":return"onCompositionEnd";case"compositionupdate":return"onCompositionUpdate"}}function iT(r,a){return r==="keydown"&&a.keyCode===D1}function w1(r,a){switch(r){case"keyup":return tT.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==D1;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function C1(r){var a=r.detail;return typeof a=="object"&&"data"in a?a.data:null}function k1(r){return r.locale==="ko"}var jc=!1;function oT(r,a,o,u,m){var v,N;if(xv?v=sT(a):jc?w1(a,u)&&(v="onCompositionEnd"):iT(a,u)&&(v="onCompositionStart"),!v)return null;S1&&!k1(u)&&(!jc&&v==="onCompositionStart"?jc=kR(m):v==="onCompositionEnd"&&jc&&(N=p1()));var k=A0(o,v);if(k.length>0){var M=new b1(v,a,null,u,m);if(r.push({event:M,listeners:k}),N)M.data=N;else{var te=C1(u);te!==null&&(M.data=te)}}}function lT(r,a){switch(r){case"compositionend":return C1(a);case"keypress":var o=a.which;return o!==y1?null:(E1=!0,O1);case"textInput":var u=a.data;return u===O1&&E1?null:u;default:return null}}function cT(r,a){if(jc){if(r==="compositionend"||!xv&&w1(r,a)){var o=p1();return RR(),jc=!1,o}return null}switch(r){case"paste":return null;case"keypress":if(!aT(a)){if(a.char&&a.char.length>1)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return S1&&!k1(a)?null:a.data;default:return null}}function uT(r,a,o,u,m){var v;if(rT?v=lT(a,u):v=cT(a,u),!v)return null;var N=A0(o,"onBeforeInput");if(N.length>0){var k=new FR("onBeforeInput","beforeinput",null,u,m);r.push({event:k,listeners:N}),k.data=v}}function dT(r,a,o,u,m,v,N){oT(r,a,o,u,m),uT(r,a,o,u,m)}var fT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function R1(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!fT[r.type]:a==="textarea"}/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */function mT(r){if(!ze)return!1;var a="on"+r,o=a in document;if(!o){var u=document.createElement("div");u.setAttribute(a,"return;"),o=typeof u[a]=="function"}return o}function hT(){fe("onChange",["change","click","focusin","focusout","input","keydown","keyup","selectionchange"])}function T1(r,a,o,u){C(u);var m=A0(a,"onChange");if(m.length>0){var v=new mv("onChange","change",null,o,u);r.push({event:v,listeners:m})}}var vd=null,gd=null;function pT(r){var a=r.nodeName&&r.nodeName.toLowerCase();return a==="select"||a==="input"&&r.type==="file"}function vT(r){var a=[];T1(a,gd,r,Wu(r)),Fe(gT,a)}function gT(r){Y1(r,0)}function T0(r){var a=Hc(r);if(yo(a))return r}function xT(r,a){if(r==="change")return a}var _1=!1;ze&&(_1=mT("input")&&(!document.documentMode||document.documentMode>9));function bT(r,a){vd=r,gd=a,vd.attachEvent("onpropertychange",U1)}function P1(){vd&&(vd.detachEvent("onpropertychange",U1),vd=null,gd=null)}function U1(r){r.propertyName==="value"&&T0(gd)&&vT(r)}function NT(r,a,o){r==="focusin"?(P1(),bT(a,o)):r==="focusout"&&P1()}function DT(r,a){if(r==="selectionchange"||r==="keyup"||r==="keydown")return T0(gd)}function ST(r){var a=r.nodeName;return a&&a.toLowerCase()==="input"&&(r.type==="checkbox"||r.type==="radio")}function yT(r,a){if(r==="click")return T0(a)}function OT(r,a){if(r==="input"||r==="change")return T0(a)}function ET(r){var a=r._wrapperState;!a||!a.controlled||r.type!=="number"||_t(r,"number",r.value)}function wT(r,a,o,u,m,v,N){var k=o?Hc(o):window,M,te;if(pT(k)?M=xT:R1(k)?_1?M=OT:(M=DT,te=NT):ST(k)&&(M=yT),M){var le=M(a,o);if(le){T1(r,le,u,m);return}}te&&te(a,k,o),a==="focusout"&&ET(k)}function CT(){ge("onMouseEnter",["mouseout","mouseover"]),ge("onMouseLeave",["mouseout","mouseover"]),ge("onPointerEnter",["pointerout","pointerover"]),ge("onPointerLeave",["pointerout","pointerover"])}function kT(r,a,o,u,m,v,N){var k=a==="mouseover"||a==="pointerover",M=a==="mouseout"||a==="pointerout";if(k&&!Dp(u)){var te=u.relatedTarget||u.fromElement;if(te&&(Ll(te)||Pd(te)))return}if(!(!M&&!k)){var le;if(m.window===m)le=m;else{var De=m.ownerDocument;De?le=De.defaultView||De.parentWindow:le=window}var Ne,Ae;if(M){var Ie=u.relatedTarget||u.toElement;if(Ne=o,Ae=Ie?Ll(Ie):null,Ae!==null){var He=Cl(Ae);(Ae!==He||Ae.tag!==w&&Ae.tag!==R)&&(Ae=null)}}else Ne=null,Ae=o;if(Ne!==Ae){var dt=x1,Ut="onMouseLeave",Rt="onMouseEnter",cr="mouse";(a==="pointerout"||a==="pointerover")&&(dt=N1,Ut="onPointerLeave",Rt="onPointerEnter",cr="pointer");var sr=Ne==null?le:Hc(Ne),Te=Ae==null?le:Hc(Ae),We=new dt(Ut,cr+"leave",Ne,u,m);We.target=sr,We.relatedTarget=Te;var _e=null,rt=Ll(m);if(rt===o){var bt=new dt(Rt,cr+"enter",Ae,u,m);bt.target=Te,bt.relatedTarget=sr,_e=bt}QT(r,We,_e,Ne,Ae)}}}function RT(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var as=typeof Object.is=="function"?Object.is:RT;function xd(r,a){if(as(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var o=Object.keys(r),u=Object.keys(a);if(o.length!==u.length)return!1;for(var m=0;m<o.length;m++){var v=o[m];if(!oe.call(a,v)||!as(r[v],a[v]))return!1}return!0}function A1(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function TT(r){for(;r;){if(r.nextSibling)return r.nextSibling;r=r.parentNode}}function L1(r,a){for(var o=A1(r),u=0,m=0;o;){if(o.nodeType===Vs){if(m=u+o.textContent.length,u<=a&&m>=a)return{node:o,offset:a-u};u=m}o=A1(TT(o))}}function _T(r){var a=r.ownerDocument,o=a&&a.defaultView||window,u=o.getSelection&&o.getSelection();if(!u||u.rangeCount===0)return null;var m=u.anchorNode,v=u.anchorOffset,N=u.focusNode,k=u.focusOffset;try{m.nodeType,N.nodeType}catch{return null}return PT(r,m,v,N,k)}function PT(r,a,o,u,m){var v=0,N=-1,k=-1,M=0,te=0,le=r,De=null;e:for(;;){for(var Ne=null;le===a&&(o===0||le.nodeType===Vs)&&(N=v+o),le===u&&(m===0||le.nodeType===Vs)&&(k=v+m),le.nodeType===Vs&&(v+=le.nodeValue.length),(Ne=le.firstChild)!==null;)De=le,le=Ne;for(;;){if(le===r)break e;if(De===a&&++M===o&&(N=v),De===u&&++te===m&&(k=v),(Ne=le.nextSibling)!==null)break;le=De,De=le.parentNode}le=Ne}return N===-1||k===-1?null:{start:N,end:k}}function UT(r,a){var o=r.ownerDocument||document,u=o&&o.defaultView||window;if(u.getSelection){var m=u.getSelection(),v=r.textContent.length,N=Math.min(a.start,v),k=a.end===void 0?N:Math.min(a.end,v);if(!m.extend&&N>k){var M=k;k=N,N=M}var te=L1(r,N),le=L1(r,k);if(te&&le){if(m.rangeCount===1&&m.anchorNode===te.node&&m.anchorOffset===te.offset&&m.focusNode===le.node&&m.focusOffset===le.offset)return;var De=o.createRange();De.setStart(te.node,te.offset),m.removeAllRanges(),N>k?(m.addRange(De),m.extend(le.node,le.offset)):(De.setEnd(le.node,le.offset),m.addRange(De))}}}function V1(r){return r&&r.nodeType===Vs}function j1(r,a){return!r||!a?!1:r===a?!0:V1(r)?!1:V1(a)?j1(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1}function AT(r){return r&&r.ownerDocument&&j1(r.ownerDocument.documentElement,r)}function LT(r){try{return typeof r.contentWindow.location.href=="string"}catch{return!1}}function I1(){for(var r=window,a=jn();a instanceof r.HTMLIFrameElement;){if(LT(a))r=a.contentWindow;else return a;a=jn(r.document)}return a}function bv(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}function VT(){var r=I1();return{focusedElem:r,selectionRange:bv(r)?IT(r):null}}function jT(r){var a=I1(),o=r.focusedElem,u=r.selectionRange;if(a!==o&&AT(o)){u!==null&&bv(o)&&MT(o,u);for(var m=[],v=o;v=v.parentNode;)v.nodeType===da&&m.push({element:v,left:v.scrollLeft,top:v.scrollTop});typeof o.focus=="function"&&o.focus();for(var N=0;N<m.length;N++){var k=m[N];k.element.scrollLeft=k.left,k.element.scrollTop=k.top}}}function IT(r){var a;return"selectionStart"in r?a={start:r.selectionStart,end:r.selectionEnd}:a=_T(r),a||{start:0,end:0}}function MT(r,a){var o=a.start,u=a.end;u===void 0&&(u=o),"selectionStart"in r?(r.selectionStart=o,r.selectionEnd=Math.min(u,r.value.length)):UT(r,a)}var FT=ze&&"documentMode"in document&&document.documentMode<=11;function $T(){fe("onSelect",["focusout","contextmenu","dragend","focusin","keydown","keyup","mousedown","mouseup","selectionchange"])}var Ic=null,Nv=null,bd=null,Dv=!1;function BT(r){if("selectionStart"in r&&bv(r))return{start:r.selectionStart,end:r.selectionEnd};var a=r.ownerDocument&&r.ownerDocument.defaultView||window,o=a.getSelection();return{anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}}function HT(r){return r.window===r?r.document:r.nodeType===js?r:r.ownerDocument}function M1(r,a,o){var u=HT(o);if(!(Dv||Ic==null||Ic!==jn(u))){var m=BT(Ic);if(!bd||!xd(bd,m)){bd=m;var v=A0(Nv,"onSelect");if(v.length>0){var N=new mv("onSelect","select",null,a,o);r.push({event:N,listeners:v}),N.target=Ic}}}}function WT(r,a,o,u,m,v,N){var k=o?Hc(o):window;switch(a){case"focusin":(R1(k)||k.contentEditable==="true")&&(Ic=k,Nv=o,bd=null);break;case"focusout":Ic=null,Nv=null,bd=null;break;case"mousedown":Dv=!0;break;case"contextmenu":case"mouseup":case"dragend":Dv=!1,M1(r,u,m);break;case"selectionchange":if(FT)break;case"keydown":case"keyup":M1(r,u,m)}}function _0(r,a){var o={};return o[r.toLowerCase()]=a.toLowerCase(),o["Webkit"+r]="webkit"+a,o["Moz"+r]="moz"+a,o}var Mc={animationend:_0("Animation","AnimationEnd"),animationiteration:_0("Animation","AnimationIteration"),animationstart:_0("Animation","AnimationStart"),transitionend:_0("Transition","TransitionEnd")},Sv={},F1={};ze&&(F1=document.createElement("div").style,"AnimationEvent"in window||(delete Mc.animationend.animation,delete Mc.animationiteration.animation,delete Mc.animationstart.animation),"TransitionEvent"in window||delete Mc.transitionend.transition);function P0(r){if(Sv[r])return Sv[r];if(!Mc[r])return r;var a=Mc[r];for(var o in a)if(a.hasOwnProperty(o)&&o in F1)return Sv[r]=a[o];return r}var $1=P0("animationend"),B1=P0("animationiteration"),H1=P0("animationstart"),W1=P0("transitionend"),z1=new Map,X1=["abort","auxClick","cancel","canPlay","canPlayThrough","click","close","contextMenu","copy","cut","drag","dragEnd","dragEnter","dragExit","dragLeave","dragOver","dragStart","drop","durationChange","emptied","encrypted","ended","error","gotPointerCapture","input","invalid","keyDown","keyPress","keyUp","load","loadedData","loadedMetadata","loadStart","lostPointerCapture","mouseDown","mouseMove","mouseOut","mouseOver","mouseUp","paste","pause","play","playing","pointerCancel","pointerDown","pointerMove","pointerOut","pointerOver","pointerUp","progress","rateChange","reset","resize","seeked","seeking","stalled","submit","suspend","timeUpdate","touchCancel","touchEnd","touchStart","volumeChange","scroll","toggle","touchMove","waiting","wheel"];function Io(r,a){z1.set(r,a),fe(a,[r])}function zT(){for(var r=0;r<X1.length;r++){var a=X1[r],o=a.toLowerCase(),u=a[0].toUpperCase()+a.slice(1);Io(o,"on"+u)}Io($1,"onAnimationEnd"),Io(B1,"onAnimationIteration"),Io(H1,"onAnimationStart"),Io("dblclick","onDoubleClick"),Io("focusin","onFocus"),Io("focusout","onBlur"),Io(W1,"onTransitionEnd")}function XT(r,a,o,u,m,v,N){var k=z1.get(a);if(k!==void 0){var M=mv,te=a;switch(a){case"keypress":if(C0(u)===0)return;case"keydown":case"keyup":M=GR;break;case"focusin":te="focus",M=vv;break;case"focusout":te="blur",M=vv;break;case"beforeblur":case"afterblur":M=vv;break;case"click":if(u.button===2)return;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":M=x1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":M=UR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":M=KR;break;case $1:case B1:case H1:M=VR;break;case W1:M=QR;break;case"scroll":M=TR;break;case"wheel":M=eT;break;case"copy":case"cut":case"paste":M=IR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":M=N1;break}var le=(v&Sl)!==0;{var De=!le&&a==="scroll",Ne=KT(o,k,u.type,le,De);if(Ne.length>0){var Ae=new M(k,te,null,u,m);r.push({event:Ae,listeners:Ne})}}}}zT(),CT(),hT(),$T(),nT();function GT(r,a,o,u,m,v,N){XT(r,a,o,u,m,v);var k=(v&xp)===0;k&&(kT(r,a,o,u,m),wT(r,a,o,u,m),WT(r,a,o,u,m),dT(r,a,o,u,m))}var Nd=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","resize","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],yv=new Set(["cancel","close","invalid","load","scroll","toggle"].concat(Nd));function G1(r,a,o){var u=r.type||"unknown-event";r.currentTarget=o,Sp(u,a,void 0,r),r.currentTarget=null}function YT(r,a,o){var u;if(o)for(var m=a.length-1;m>=0;m--){var v=a[m],N=v.instance,k=v.currentTarget,M=v.listener;if(N!==u&&r.isPropagationStopped())return;G1(r,M,k),u=N}else for(var te=0;te<a.length;te++){var le=a[te],De=le.instance,Ne=le.currentTarget,Ae=le.listener;if(De!==u&&r.isPropagationStopped())return;G1(r,Ae,Ne),u=De}}function Y1(r,a){for(var o=(a&Sl)!==0,u=0;u<r.length;u++){var m=r[u],v=m.event,N=m.listeners;YT(v,N,o)}yp()}function qT(r,a,o,u,m){var v=Wu(o),N=[];GT(N,r,u,o,v,a),Y1(N,a)}function Hr(r,a){yv.has(r)||c('Did not expect a listenToNonDelegatedEvent() call for "%s". This is a bug in React. Please file an issue.',r);var o=!1,u=E_(a),m=ZT(r);u.has(m)||(q1(a,r,Dc,o),u.add(m))}function Ov(r,a,o){yv.has(r)&&!a&&c('Did not expect a listenToNativeEvent() call for "%s" in the bubble phase. This is a bug in React. Please file an issue.',r);var u=0;a&&(u|=Sl),q1(o,r,u,a)}var U0="_reactListening"+Math.random().toString(36).slice(2);function Dd(r){if(!r[U0]){r[U0]=!0,P.forEach(function(o){o!=="selectionchange"&&(yv.has(o)||Ov(o,!1,r),Ov(o,!0,r))});var a=r.nodeType===js?r:r.ownerDocument;a!==null&&(a[U0]||(a[U0]=!0,Ov("selectionchange",!1,a)))}}function q1(r,a,o,u,m){var v=NR(r,a,o),N=void 0;$t&&(a==="touchstart"||a==="touchmove"||a==="wheel")&&(N=!0),r=r,u?N!==void 0?wR(r,a,v,N):ER(r,a,v):N!==void 0?CR(r,a,v,N):OR(r,a,v)}function K1(r,a){return r===a||r.nodeType===qr&&r.parentNode===a}function Ev(r,a,o,u,m){var v=u;if((a&Br)===0&&(a&Dc)===0){var N=m;if(u!==null){var k=u;e:for(;;){if(k===null)return;var M=k.tag;if(M===b||M===E){var te=k.stateNode.containerInfo;if(K1(te,N))break;if(M===E)for(var le=k.return;le!==null;){var De=le.tag;if(De===b||De===E){var Ne=le.stateNode.containerInfo;if(K1(Ne,N))return}le=le.return}for(;te!==null;){var Ae=Ll(te);if(Ae===null)return;var Ie=Ae.tag;if(Ie===w||Ie===R){k=v=Ae;continue e}te=te.parentNode}}k=k.return}}}Fe(function(){return qT(r,a,o,v)})}function Sd(r,a,o){return{instance:r,listener:a,currentTarget:o}}function KT(r,a,o,u,m,v){for(var N=a!==null?a+"Capture":null,k=u?N:a,M=[],te=r,le=null;te!==null;){var De=te,Ne=De.stateNode,Ae=De.tag;if(Ae===w&&Ne!==null&&(le=Ne,k!==null)){var Ie=Pt(te,k);Ie!=null&&M.push(Sd(te,Ie,le))}if(m)break;te=te.return}return M}function A0(r,a){for(var o=a+"Capture",u=[],m=r;m!==null;){var v=m,N=v.stateNode,k=v.tag;if(k===w&&N!==null){var M=N,te=Pt(m,o);te!=null&&u.unshift(Sd(m,te,M));var le=Pt(m,a);le!=null&&u.push(Sd(m,le,M))}m=m.return}return u}function Fc(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==w);return r||null}function JT(r,a){for(var o=r,u=a,m=0,v=o;v;v=Fc(v))m++;for(var N=0,k=u;k;k=Fc(k))N++;for(;m-N>0;)o=Fc(o),m--;for(;N-m>0;)u=Fc(u),N--;for(var M=m;M--;){if(o===u||u!==null&&o===u.alternate)return o;o=Fc(o),u=Fc(u)}return null}function J1(r,a,o,u,m){for(var v=a._reactName,N=[],k=o;k!==null&&k!==u;){var M=k,te=M.alternate,le=M.stateNode,De=M.tag;if(te!==null&&te===u)break;if(De===w&&le!==null){var Ne=le;if(m){var Ae=Pt(k,v);Ae!=null&&N.unshift(Sd(k,Ae,Ne))}else if(!m){var Ie=Pt(k,v);Ie!=null&&N.push(Sd(k,Ie,Ne))}}k=k.return}N.length!==0&&r.push({event:a,listeners:N})}function QT(r,a,o,u,m){var v=u&&m?JT(u,m):null;u!==null&&J1(r,a,u,v,!1),m!==null&&o!==null&&J1(r,o,m,v,!0)}function ZT(r,a){return r+"__bubble"}var Ba=!1,yd="dangerouslySetInnerHTML",L0="suppressContentEditableWarning",Mo="suppressHydrationWarning",Q1="autoFocus",Ul="children",Al="style",V0="__html",wv,j0,Od,Z1,I0,eD,tD;wv={dialog:!0,webview:!0},j0=function(r,a){mp(r,a),Hu(r,a),gp(r,a,{registrationNameDependencies:F,possibleRegistrationNames:de})},eD=ze&&!document.documentMode,Od=function(r,a,o){if(!Ba){var u=M0(o),m=M0(a);m!==u&&(Ba=!0,c("Prop `%s` did not match. Server: %s Client: %s",r,JSON.stringify(m),JSON.stringify(u)))}},Z1=function(r){if(!Ba){Ba=!0;var a=[];r.forEach(function(o){a.push(o)}),c("Extra attributes from the server: %s",a)}},I0=function(r,a){a===!1?c("Expected `%s` listener to be a function, instead got `false`.\n\nIf you used to conditionally omit it with %s={condition && value}, pass %s={condition ? value : undefined} instead.",r,r,r):c("Expected `%s` listener to be a function, instead got a value of `%s` type.",r,typeof a)},tD=function(r,a){var o=r.namespaceURI===Ls?r.ownerDocument.createElement(r.tagName):r.ownerDocument.createElementNS(r.namespaceURI,r.tagName);return o.innerHTML=a,o.innerHTML};var e5=/\r\n?/g,t5=/\u0000|\uFFFD/g;function M0(r){ur(r);var a=typeof r=="string"?r:""+r;return a.replace(e5,`
`).replace(t5,"")}function F0(r,a,o,u){var m=M0(a),v=M0(r);if(v!==m&&(u&&(Ba||(Ba=!0,c('Text content did not match. Server: "%s" Client: "%s"',v,m))),o&&ve))throw new Error("Text content does not match server-rendered HTML.")}function rD(r){return r.nodeType===js?r:r.ownerDocument}function r5(){}function $0(r){r.onclick=r5}function n5(r,a,o,u,m){for(var v in u)if(u.hasOwnProperty(v)){var N=u[v];if(v===Al)N&&Object.freeze(N),Nc(a,N);else if(v===yd){var k=N?N[V0]:void 0;k!=null&&bl(a,k)}else if(v===Ul)if(typeof N=="string"){var M=r!=="textarea"||N!=="";M&&Co(a,N)}else typeof N=="number"&&Co(a,""+N);else v===L0||v===Mo||v===Q1||(F.hasOwnProperty(v)?N!=null&&(typeof N!="function"&&I0(v,N),v==="onScroll"&&Hr("scroll",a)):N!=null&&Ln(a,v,N,m))}}function a5(r,a,o,u){for(var m=0;m<a.length;m+=2){var v=a[m],N=a[m+1];v===Al?Nc(r,N):v===yd?bl(r,N):v===Ul?Co(r,N):Ln(r,v,N,u)}}function s5(r,a,o,u){var m,v=rD(o),N,k=u;if(k===Ls&&(k=Lu(r)),k===Ls){if(m=Bi(r,a),!m&&r!==r.toLowerCase()&&c("<%s /> is using incorrect casing. Use PascalCase for React components, or lowercase for HTML elements.",r),r==="script"){var M=v.createElement("div");M.innerHTML="<script><\/script>";var te=M.firstChild;N=M.removeChild(te)}else if(typeof a.is=="string")N=v.createElement(r,{is:a.is});else if(N=v.createElement(r),r==="select"){var le=N;a.multiple?le.multiple=!0:a.size&&(le.size=a.size)}}else N=v.createElementNS(k,r);return k===Ls&&!m&&Object.prototype.toString.call(N)==="[object HTMLUnknownElement]"&&!oe.call(wv,r)&&(wv[r]=!0,c("The tag <%s> is unrecognized in this browser. If you meant to render a React component, start its name with an uppercase letter.",r)),N}function i5(r,a){return rD(a).createTextNode(r)}function o5(r,a,o,u){var m=Bi(a,o);j0(a,o);var v;switch(a){case"dialog":Hr("cancel",r),Hr("close",r),v=o;break;case"iframe":case"object":case"embed":Hr("load",r),v=o;break;case"video":case"audio":for(var N=0;N<Nd.length;N++)Hr(Nd[N],r);v=o;break;case"source":Hr("error",r),v=o;break;case"img":case"image":case"link":Hr("error",r),Hr("load",r),v=o;break;case"details":Hr("toggle",r),v=o;break;case"input":As(r,o),v=hs(r,o),Hr("invalid",r);break;case"option":Gt(r,o),v=o;break;case"select":Dn(r,o),v=Pr(r,o),Hr("invalid",r);break;case"textarea":vc(r,o),v=xl(r,o),Hr("invalid",r);break;default:v=o}switch($u(a,v),n5(a,r,u,v,m),a){case"input":nn(r),Le(r,o,!1);break;case"textarea":nn(r),Uu(r);break;case"option":xr(r,o);break;case"select":Eo(r,o);break;default:typeof v.onClick=="function"&&$0(r);break}}function l5(r,a,o,u,m){j0(a,u);var v=null,N,k;switch(a){case"input":N=hs(r,o),k=hs(r,u),v=[];break;case"select":N=Pr(r,o),k=Pr(r,u),v=[];break;case"textarea":N=xl(r,o),k=xl(r,u),v=[];break;default:N=o,k=u,typeof N.onClick!="function"&&typeof k.onClick=="function"&&$0(r);break}$u(a,k);var M,te,le=null;for(M in N)if(!(k.hasOwnProperty(M)||!N.hasOwnProperty(M)||N[M]==null))if(M===Al){var De=N[M];for(te in De)De.hasOwnProperty(te)&&(le||(le={}),le[te]="")}else M===yd||M===Ul||M===L0||M===Mo||M===Q1||(F.hasOwnProperty(M)?v||(v=[]):(v=v||[]).push(M,null));for(M in k){var Ne=k[M],Ae=N?.[M];if(!(!k.hasOwnProperty(M)||Ne===Ae||Ne==null&&Ae==null))if(M===Al)if(Ne&&Object.freeze(Ne),Ae){for(te in Ae)Ae.hasOwnProperty(te)&&(!Ne||!Ne.hasOwnProperty(te))&&(le||(le={}),le[te]="");for(te in Ne)Ne.hasOwnProperty(te)&&Ae[te]!==Ne[te]&&(le||(le={}),le[te]=Ne[te])}else le||(v||(v=[]),v.push(M,le)),le=Ne;else if(M===yd){var Ie=Ne?Ne[V0]:void 0,He=Ae?Ae[V0]:void 0;Ie!=null&&He!==Ie&&(v=v||[]).push(M,Ie)}else M===Ul?(typeof Ne=="string"||typeof Ne=="number")&&(v=v||[]).push(M,""+Ne):M===L0||M===Mo||(F.hasOwnProperty(M)?(Ne!=null&&(typeof Ne!="function"&&I0(M,Ne),M==="onScroll"&&Hr("scroll",r)),!v&&Ae!==Ne&&(v=[])):(v=v||[]).push(M,Ne))}return le&&(Fu(le,k[Al]),(v=v||[]).push(Al,le)),v}function c5(r,a,o,u,m){o==="input"&&m.type==="radio"&&m.name!=null&&B(r,m);var v=Bi(o,u),N=Bi(o,m);switch(a5(r,a,v,N),o){case"input":me(r,m);break;case"textarea":n0(r,m);break;case"select":gl(r,m);break}}function u5(r){{var a=r.toLowerCase();return Hi.hasOwnProperty(a)&&Hi[a]||null}}function d5(r,a,o,u,m,v,N){var k,M;switch(k=Bi(a,o),j0(a,o),a){case"dialog":Hr("cancel",r),Hr("close",r);break;case"iframe":case"object":case"embed":Hr("load",r);break;case"video":case"audio":for(var te=0;te<Nd.length;te++)Hr(Nd[te],r);break;case"source":Hr("error",r);break;case"img":case"image":case"link":Hr("error",r),Hr("load",r);break;case"details":Hr("toggle",r);break;case"input":As(r,o),Hr("invalid",r);break;case"option":Gt(r,o);break;case"select":Dn(r,o),Hr("invalid",r);break;case"textarea":vc(r,o),Hr("invalid",r);break}$u(a,o);{M=new Set;for(var le=r.attributes,De=0;De<le.length;De++){var Ne=le[De].name.toLowerCase();switch(Ne){case"value":break;case"checked":break;case"selected":break;default:M.add(le[De].name)}}}var Ae=null;for(var Ie in o)if(o.hasOwnProperty(Ie)){var He=o[Ie];if(Ie===Ul)typeof He=="string"?r.textContent!==He&&(o[Mo]!==!0&&F0(r.textContent,He,v,N),Ae=[Ul,He]):typeof He=="number"&&r.textContent!==""+He&&(o[Mo]!==!0&&F0(r.textContent,He,v,N),Ae=[Ul,""+He]);else if(F.hasOwnProperty(Ie))He!=null&&(typeof He!="function"&&I0(Ie,He),Ie==="onScroll"&&Hr("scroll",r));else if(N&&typeof k=="boolean"){var dt=void 0,Ut=Yt(Ie);if(o[Mo]!==!0){if(!(Ie===L0||Ie===Mo||Ie==="value"||Ie==="checked"||Ie==="selected")){if(Ie===yd){var Rt=r.innerHTML,cr=He?He[V0]:void 0;if(cr!=null){var sr=tD(r,cr);sr!==Rt&&Od(Ie,Rt,sr)}}else if(Ie===Al){if(M.delete(Ie),eD){var Te=o0(He);dt=r.getAttribute("style"),Te!==dt&&Od(Ie,dt,Te)}}else if(k&&!Ce)M.delete(Ie.toLowerCase()),dt=qt(r,Ie,He),He!==dt&&Od(Ie,dt,He);else if(!kt(Ie,Ut,k)&&!Lt(Ie,He,Ut,k)){var We=!1;if(Ut!==null)M.delete(Ut.attributeName),dt=qa(r,Ie,He,Ut);else{var _e=u;if(_e===Ls&&(_e=Lu(a)),_e===Ls)M.delete(Ie.toLowerCase());else{var rt=u5(Ie);rt!==null&&rt!==Ie&&(We=!0,M.delete(rt)),M.delete(Ie)}dt=qt(r,Ie,He)}var bt=Ce;!bt&&He!==dt&&!We&&Od(Ie,dt,He)}}}}}switch(N&&M.size>0&&o[Mo]!==!0&&Z1(M),a){case"input":nn(r),Le(r,o,!0);break;case"textarea":nn(r),Uu(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&$0(r);break}return Ae}function f5(r,a,o){var u=r.nodeValue!==a;return u}function Cv(r,a){{if(Ba)return;Ba=!0,c("Did not expect server HTML to contain a <%s> in <%s>.",a.nodeName.toLowerCase(),r.nodeName.toLowerCase())}}function kv(r,a){{if(Ba)return;Ba=!0,c('Did not expect server HTML to contain the text node "%s" in <%s>.',a.nodeValue,r.nodeName.toLowerCase())}}function Rv(r,a,o){{if(Ba)return;Ba=!0,c("Expected server HTML to contain a matching <%s> in <%s>.",a,r.nodeName.toLowerCase())}}function Tv(r,a){{if(a===""||Ba)return;Ba=!0,c('Expected server HTML to contain a matching text node for "%s" in <%s>.',a,r.nodeName.toLowerCase())}}function m5(r,a,o){switch(a){case"input":Me(r,o);return;case"textarea":Jh(r,o);return;case"select":Sn(r,o);return}}var Ed=function(){},wd=function(){};{var h5=["address","applet","area","article","aside","base","basefont","bgsound","blockquote","body","br","button","caption","center","col","colgroup","dd","details","dir","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","img","input","isindex","li","link","listing","main","marquee","menu","menuitem","meta","nav","noembed","noframes","noscript","object","ol","p","param","plaintext","pre","script","section","select","source","style","summary","table","tbody","td","template","textarea","tfoot","th","thead","title","tr","track","ul","wbr","xmp"],nD=["applet","caption","html","table","td","th","marquee","object","template","foreignObject","desc","title"],p5=nD.concat(["button"]),v5=["dd","dt","li","option","optgroup","p","rp","rt"],aD={current:null,formTag:null,aTagInScope:null,buttonTagInScope:null,nobrTagInScope:null,pTagInButtonScope:null,listItemTagAutoclosing:null,dlItemTagAutoclosing:null};wd=function(r,a){var o=ot({},r||aD),u={tag:a};return nD.indexOf(a)!==-1&&(o.aTagInScope=null,o.buttonTagInScope=null,o.nobrTagInScope=null),p5.indexOf(a)!==-1&&(o.pTagInButtonScope=null),h5.indexOf(a)!==-1&&a!=="address"&&a!=="div"&&a!=="p"&&(o.listItemTagAutoclosing=null,o.dlItemTagAutoclosing=null),o.current=u,a==="form"&&(o.formTag=u),a==="a"&&(o.aTagInScope=u),a==="button"&&(o.buttonTagInScope=u),a==="nobr"&&(o.nobrTagInScope=u),a==="p"&&(o.pTagInButtonScope=u),a==="li"&&(o.listItemTagAutoclosing=u),(a==="dd"||a==="dt")&&(o.dlItemTagAutoclosing=u),o};var g5=function(r,a){switch(a){case"select":return r==="option"||r==="optgroup"||r==="#text";case"optgroup":return r==="option"||r==="#text";case"option":return r==="#text";case"tr":return r==="th"||r==="td"||r==="style"||r==="script"||r==="template";case"tbody":case"thead":case"tfoot":return r==="tr"||r==="style"||r==="script"||r==="template";case"colgroup":return r==="col"||r==="template";case"table":return r==="caption"||r==="colgroup"||r==="tbody"||r==="tfoot"||r==="thead"||r==="style"||r==="script"||r==="template";case"head":return r==="base"||r==="basefont"||r==="bgsound"||r==="link"||r==="meta"||r==="title"||r==="noscript"||r==="noframes"||r==="style"||r==="script"||r==="template";case"html":return r==="head"||r==="body"||r==="frameset";case"frameset":return r==="frame";case"#document":return r==="html"}switch(r){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return a!=="h1"&&a!=="h2"&&a!=="h3"&&a!=="h4"&&a!=="h5"&&a!=="h6";case"rp":case"rt":return v5.indexOf(a)===-1;case"body":case"caption":case"col":case"colgroup":case"frameset":case"frame":case"head":case"html":case"tbody":case"td":case"tfoot":case"th":case"thead":case"tr":return a==null}return!0},x5=function(r,a){switch(r){case"address":case"article":case"aside":case"blockquote":case"center":case"details":case"dialog":case"dir":case"div":case"dl":case"fieldset":case"figcaption":case"figure":case"footer":case"header":case"hgroup":case"main":case"menu":case"nav":case"ol":case"p":case"section":case"summary":case"ul":case"pre":case"listing":case"table":case"hr":case"xmp":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return a.pTagInButtonScope;case"form":return a.formTag||a.pTagInButtonScope;case"li":return a.listItemTagAutoclosing;case"dd":case"dt":return a.dlItemTagAutoclosing;case"button":return a.buttonTagInScope;case"a":return a.aTagInScope;case"nobr":return a.nobrTagInScope}return null},sD={};Ed=function(r,a,o){o=o||aD;var u=o.current,m=u&&u.tag;a!=null&&(r!=null&&c("validateDOMNesting: when childText is passed, childTag should be null"),r="#text");var v=g5(r,m)?null:u,N=v?null:x5(r,o),k=v||N;if(k){var M=k.tag,te=!!v+"|"+r+"|"+M;if(!sD[te]){sD[te]=!0;var le=r,De="";if(r==="#text"?/\S/.test(a)?le="Text nodes":(le="Whitespace text nodes",De=" Make sure you don't have any extra whitespace between tags on each line of your source code."):le="<"+r+">",v){var Ne="";M==="table"&&r==="tr"&&(Ne+=" Add a <tbody>, <thead> or <tfoot> to your code to match the DOM tree generated by the browser."),c("validateDOMNesting(...): %s cannot appear as a child of <%s>.%s%s",le,M,De,Ne)}else c("validateDOMNesting(...): %s cannot appear as a descendant of <%s>.",le,M)}}}}var B0="suppressHydrationWarning",H0="$",W0="/$",Cd="$?",kd="$!",b5="style",_v=null,Pv=null;function N5(r){var a,o,u=r.nodeType;switch(u){case js:case wo:{a=u===js?"#document":"#fragment";var m=r.documentElement;o=m?m.namespaceURI:Vu(null,"");break}default:{var v=u===qr?r.parentNode:r,N=v.namespaceURI||null;a=v.tagName,o=Vu(N,a);break}}{var k=a.toLowerCase(),M=wd(null,k);return{namespace:o,ancestorInfo:M}}}function D5(r,a,o){{var u=r,m=Vu(u.namespace,a),v=wd(u.ancestorInfo,a);return{namespace:m,ancestorInfo:v}}}function y9(r){return r}function S5(r){_v=bR(),Pv=VT();var a=null;return m1(!1),a}function y5(r){jT(Pv),m1(_v),_v=null,Pv=null}function O5(r,a,o,u,m){var v;{var N=u;if(Ed(r,null,N.ancestorInfo),typeof a.children=="string"||typeof a.children=="number"){var k=""+a.children,M=wd(N.ancestorInfo,r);Ed(null,k,M)}v=N.namespace}var te=s5(r,a,o,v);return _d(m,te),Fv(te,a),te}function E5(r,a){r.appendChild(a)}function w5(r,a,o,u,m){switch(o5(r,a,o,u),a){case"button":case"input":case"select":case"textarea":return!!o.autoFocus;case"img":return!0;default:return!1}}function C5(r,a,o,u,m,v){{var N=v;if(typeof u.children!=typeof o.children&&(typeof u.children=="string"||typeof u.children=="number")){var k=""+u.children,M=wd(N.ancestorInfo,a);Ed(null,k,M)}}return l5(r,a,o,u)}function Uv(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}function k5(r,a,o,u){{var m=o;Ed(null,r,m.ancestorInfo)}var v=i5(r,a);return _d(u,v),v}function R5(){var r=window.event;return r===void 0?Ki:h1(r.type)}var Av=typeof setTimeout=="function"?setTimeout:void 0,T5=typeof clearTimeout=="function"?clearTimeout:void 0,Lv=-1,iD=typeof Promise=="function"?Promise:void 0,_5=typeof queueMicrotask=="function"?queueMicrotask:typeof iD<"u"?function(r){return iD.resolve(null).then(r).catch(P5)}:Av;function P5(r){setTimeout(function(){throw r})}function U5(r,a,o,u){switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&r.focus();return;case"img":{o.src&&(r.src=o.src);return}}}function A5(r,a,o,u,m,v){c5(r,a,o,u,m),Fv(r,m)}function oD(r){Co(r,"")}function L5(r,a,o){r.nodeValue=o}function V5(r,a){r.appendChild(a)}function j5(r,a){var o;r.nodeType===qr?(o=r.parentNode,o.insertBefore(a,r)):(o=r,o.appendChild(a));var u=r._reactRootContainer;u==null&&o.onclick===null&&$0(o)}function I5(r,a,o){r.insertBefore(a,o)}function M5(r,a,o){r.nodeType===qr?r.parentNode.insertBefore(a,o):r.insertBefore(a,o)}function F5(r,a){r.removeChild(a)}function $5(r,a){r.nodeType===qr?r.parentNode.removeChild(a):r.removeChild(a)}function Vv(r,a){var o=a,u=0;do{var m=o.nextSibling;if(r.removeChild(o),m&&m.nodeType===qr){var v=m.data;if(v===W0)if(u===0){r.removeChild(m),ud(a);return}else u--;else(v===H0||v===Cd||v===kd)&&u++}o=m}while(o);ud(a)}function B5(r,a){r.nodeType===qr?Vv(r.parentNode,a):r.nodeType===da&&Vv(r,a),ud(r)}function H5(r){r=r;var a=r.style;typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"}function W5(r){r.nodeValue=""}function z5(r,a){r=r;var o=a[b5],u=o!=null&&o.hasOwnProperty("display")?o.display:null;r.style.display=an("display",u)}function X5(r,a){r.nodeValue=a}function G5(r){r.nodeType===da?r.textContent="":r.nodeType===js&&r.documentElement&&r.removeChild(r.documentElement)}function Y5(r,a,o){return r.nodeType!==da||a.toLowerCase()!==r.nodeName.toLowerCase()?null:r}function q5(r,a){return a===""||r.nodeType!==Vs?null:r}function K5(r){return r.nodeType!==qr?null:r}function lD(r){return r.data===Cd}function jv(r){return r.data===kd}function J5(r){var a=r.nextSibling&&r.nextSibling.dataset,o,u,m;return a&&(o=a.dgst,u=a.msg,m=a.stck),{message:u,digest:o,stack:m}}function Q5(r,a){r._reactRetry=a}function z0(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===da||a===Vs)break;if(a===qr){var o=r.data;if(o===H0||o===kd||o===Cd)break;if(o===W0)return null}}return r}function Rd(r){return z0(r.nextSibling)}function Z5(r){return z0(r.firstChild)}function e_(r){return z0(r.firstChild)}function t_(r){return z0(r.nextSibling)}function r_(r,a,o,u,m,v,N){_d(v,r),Fv(r,o);var k;{var M=m;k=M.namespace}var te=(v.mode&or)!==At;return d5(r,a,o,k,u,te,N)}function n_(r,a,o,u){return _d(o,r),o.mode&or,f5(r,a)}function a_(r,a){_d(a,r)}function s_(r){for(var a=r.nextSibling,o=0;a;){if(a.nodeType===qr){var u=a.data;if(u===W0){if(o===0)return Rd(a);o--}else(u===H0||u===kd||u===Cd)&&o++}a=a.nextSibling}return null}function cD(r){for(var a=r.previousSibling,o=0;a;){if(a.nodeType===qr){var u=a.data;if(u===H0||u===kd||u===Cd){if(o===0)return a;o--}else u===W0&&o++}a=a.previousSibling}return null}function i_(r){ud(r)}function o_(r){ud(r)}function l_(r){return r!=="head"&&r!=="body"}function c_(r,a,o,u){var m=!0;F0(a.nodeValue,o,u,m)}function u_(r,a,o,u,m,v){if(a[B0]!==!0){var N=!0;F0(u.nodeValue,m,v,N)}}function d_(r,a){a.nodeType===da?Cv(r,a):a.nodeType===qr||kv(r,a)}function f_(r,a){{var o=r.parentNode;o!==null&&(a.nodeType===da?Cv(o,a):a.nodeType===qr||kv(o,a))}}function m_(r,a,o,u,m){(m||a[B0]!==!0)&&(u.nodeType===da?Cv(o,u):u.nodeType===qr||kv(o,u))}function h_(r,a,o){Rv(r,a)}function p_(r,a){Tv(r,a)}function v_(r,a,o){{var u=r.parentNode;u!==null&&Rv(u,a)}}function g_(r,a){{var o=r.parentNode;o!==null&&Tv(o,a)}}function x_(r,a,o,u,m,v){(v||a[B0]!==!0)&&Rv(o,u)}function b_(r,a,o,u,m){(m||a[B0]!==!0)&&Tv(o,u)}function N_(r){c("An error occurred during hydration. The server HTML was replaced with client content in <%s>.",r.nodeName.toLowerCase())}function D_(r){Dd(r)}var $c=Math.random().toString(36).slice(2),Bc="__reactFiber$"+$c,Iv="__reactProps$"+$c,Td="__reactContainer$"+$c,Mv="__reactEvents$"+$c,S_="__reactListeners$"+$c,y_="__reactHandles$"+$c;function O_(r){delete r[Bc],delete r[Iv],delete r[Mv],delete r[S_],delete r[y_]}function _d(r,a){a[Bc]=r}function X0(r,a){a[Td]=r}function uD(r){r[Td]=null}function Pd(r){return!!r[Td]}function Ll(r){var a=r[Bc];if(a)return a;for(var o=r.parentNode;o;){if(a=o[Td]||o[Bc],a){var u=a.alternate;if(a.child!==null||u!==null&&u.child!==null)for(var m=cD(r);m!==null;){var v=m[Bc];if(v)return v;m=cD(m)}return a}r=o,o=r.parentNode}return null}function Fo(r){var a=r[Bc]||r[Td];return a&&(a.tag===w||a.tag===R||a.tag===ee||a.tag===b)?a:null}function Hc(r){if(r.tag===w||r.tag===R)return r.stateNode;throw new Error("getNodeFromInstance: Invalid argument.")}function G0(r){return r[Iv]||null}function Fv(r,a){r[Iv]=a}function E_(r){var a=r[Mv];return a===void 0&&(a=r[Mv]=new Set),a}var dD={},fD=e.ReactDebugCurrentFrame;function Y0(r){if(r){var a=r._owner,o=ji(r.type,r._source,a?a.type:null);fD.setExtraStackFrame(o)}else fD.setExtraStackFrame(null)}function $s(r,a,o,u,m){{var v=Function.call.bind(oe);for(var N in r)if(v(r,N)){var k=void 0;try{if(typeof r[N]!="function"){var M=Error((u||"React class")+": "+o+" type `"+N+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof r[N]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw M.name="Invariant Violation",M}k=r[N](a,N,u,o,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(te){k=te}k&&!(k instanceof Error)&&(Y0(m),c("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",u||"React class",o,N,typeof k),Y0(null)),k instanceof Error&&!(k.message in dD)&&(dD[k.message]=!0,Y0(m),c("Failed %s type: %s",o,k.message),Y0(null))}}}var $v=[],q0;q0=[];var Ji=-1;function $o(r){return{current:r}}function ma(r,a){if(Ji<0){c("Unexpected pop.");return}a!==q0[Ji]&&c("Unexpected Fiber popped."),r.current=$v[Ji],$v[Ji]=null,q0[Ji]=null,Ji--}function ha(r,a,o){Ji++,$v[Ji]=r.current,q0[Ji]=o,r.current=a}var Bv;Bv={};var ss={};Object.freeze(ss);var Qi=$o(ss),vi=$o(!1),Hv=ss;function Wc(r,a,o){return o&&gi(a)?Hv:Qi.current}function mD(r,a,o){{var u=r.stateNode;u.__reactInternalMemoizedUnmaskedChildContext=a,u.__reactInternalMemoizedMaskedChildContext=o}}function zc(r,a){{var o=r.type,u=o.contextTypes;if(!u)return ss;var m=r.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===a)return m.__reactInternalMemoizedMaskedChildContext;var v={};for(var N in u)v[N]=a[N];{var k=jt(r)||"Unknown";$s(u,v,"context",k)}return m&&mD(r,a,v),v}}function K0(){return vi.current}function gi(r){{var a=r.childContextTypes;return a!=null}}function J0(r){ma(vi,r),ma(Qi,r)}function Wv(r){ma(vi,r),ma(Qi,r)}function hD(r,a,o){{if(Qi.current!==ss)throw new Error("Unexpected context found on stack. This error is likely caused by a bug in React. Please file an issue.");ha(Qi,a,r),ha(vi,o,r)}}function pD(r,a,o){{var u=r.stateNode,m=a.childContextTypes;if(typeof u.getChildContext!="function"){{var v=jt(r)||"Unknown";Bv[v]||(Bv[v]=!0,c("%s.childContextTypes is specified but there is no getChildContext() method on the instance. You can either define getChildContext() on %s or remove childContextTypes from it.",v,v))}return o}var N=u.getChildContext();for(var k in N)if(!(k in m))throw new Error((jt(r)||"Unknown")+'.getChildContext(): key "'+k+'" is not defined in childContextTypes.');{var M=jt(r)||"Unknown";$s(m,N,"child context",M)}return ot({},o,N)}}function Q0(r){{var a=r.stateNode,o=a&&a.__reactInternalMemoizedMergedChildContext||ss;return Hv=Qi.current,ha(Qi,o,r),ha(vi,vi.current,r),!0}}function vD(r,a,o){{var u=r.stateNode;if(!u)throw new Error("Expected to have an instance by this point. This error is likely caused by a bug in React. Please file an issue.");if(o){var m=pD(r,a,Hv);u.__reactInternalMemoizedMergedChildContext=m,ma(vi,r),ma(Qi,r),ha(Qi,m,r),ha(vi,o,r)}else ma(vi,r),ha(vi,o,r)}}function w_(r){{if(!lk(r)||r.tag!==g)throw new Error("Expected subtree parent to be a mounted class component. This error is likely caused by a bug in React. Please file an issue.");var a=r;do{switch(a.tag){case b:return a.stateNode.context;case g:{var o=a.type;if(gi(o))return a.stateNode.__reactInternalMemoizedMergedChildContext;break}}a=a.return}while(a!==null);throw new Error("Found unexpected detached subtree parent. This error is likely caused by a bug in React. Please file an issue.")}}var Bo=0,Z0=1,Zi=null,zv=!1,Xv=!1;function gD(r){Zi===null?Zi=[r]:Zi.push(r)}function C_(r){zv=!0,gD(r)}function xD(){zv&&Ho()}function Ho(){if(!Xv&&Zi!==null){Xv=!0;var r=0,a=Fs();try{var o=!0,u=Zi;for($n(rs);r<u.length;r++){var m=u[r];do m=m(o);while(m!==null)}Zi=null,zv=!1}catch(v){throw Zi!==null&&(Zi=Zi.slice(r+1)),BN(p0,Ho),v}finally{$n(a),Xv=!1}}return null}var Xc=[],Gc=0,em=null,tm=0,vs=[],gs=0,Vl=null,eo=1,to="";function k_(r){return Il(),(r.flags&AN)!==Vt}function R_(r){return Il(),tm}function T_(){var r=to,a=eo,o=a&~__(a);return o.toString(32)+r}function jl(r,a){Il(),Xc[Gc++]=tm,Xc[Gc++]=em,em=r,tm=a}function bD(r,a,o){Il(),vs[gs++]=eo,vs[gs++]=to,vs[gs++]=Vl,Vl=r;var u=eo,m=to,v=rm(u)-1,N=u&~(1<<v),k=o+1,M=rm(a)+v;if(M>30){var te=v-v%5,le=(1<<te)-1,De=(N&le).toString(32),Ne=N>>te,Ae=v-te,Ie=rm(a)+Ae,He=k<<Ae,dt=He|Ne,Ut=De+m;eo=1<<Ie|dt,to=Ut}else{var Rt=k<<v,cr=Rt|N,sr=m;eo=1<<M|cr,to=sr}}function Gv(r){Il();var a=r.return;if(a!==null){var o=1,u=0;jl(r,o),bD(r,o,u)}}function rm(r){return 32-YN(r)}function __(r){return 1<<rm(r)-1}function Yv(r){for(;r===em;)em=Xc[--Gc],Xc[Gc]=null,tm=Xc[--Gc],Xc[Gc]=null;for(;r===Vl;)Vl=vs[--gs],vs[gs]=null,to=vs[--gs],vs[gs]=null,eo=vs[--gs],vs[gs]=null}function P_(){return Il(),Vl!==null?{id:eo,overflow:to}:null}function U_(r,a){Il(),vs[gs++]=eo,vs[gs++]=to,vs[gs++]=Vl,eo=a.id,to=a.overflow,Vl=r}function Il(){Zn()||c("Expected to be hydrating. This is a bug in React. Please file an issue.")}var Qn=null,xs=null,Bs=!1,Ml=!1,Wo=null;function A_(){Bs&&c("We should not be hydrating here. This is a bug in React. Please file a bug.")}function ND(){Ml=!0}function L_(){return Ml}function V_(r){var a=r.stateNode.containerInfo;return xs=e_(a),Qn=r,Bs=!0,Wo=null,Ml=!1,!0}function j_(r,a,o){return xs=t_(a),Qn=r,Bs=!0,Wo=null,Ml=!1,o!==null&&U_(r,o),!0}function DD(r,a){switch(r.tag){case b:{d_(r.stateNode.containerInfo,a);break}case w:{var o=(r.mode&or)!==At;m_(r.type,r.memoizedProps,r.stateNode,a,o);break}case ee:{var u=r.memoizedState;u.dehydrated!==null&&f_(u.dehydrated,a);break}}}function SD(r,a){DD(r,a);var o=$P();o.stateNode=a,o.return=r;var u=r.deletions;u===null?(r.deletions=[o],r.flags|=yl):u.push(o)}function qv(r,a){{if(Ml)return;switch(r.tag){case b:{var o=r.stateNode.containerInfo;switch(a.tag){case w:var u=a.type;a.pendingProps,h_(o,u);break;case R:var m=a.pendingProps;p_(o,m);break}break}case w:{var v=r.type,N=r.memoizedProps,k=r.stateNode;switch(a.tag){case w:{var M=a.type,te=a.pendingProps,le=(r.mode&or)!==At;x_(v,N,k,M,te,le);break}case R:{var De=a.pendingProps,Ne=(r.mode&or)!==At;b_(v,N,k,De,Ne);break}}break}case ee:{var Ae=r.memoizedState,Ie=Ae.dehydrated;if(Ie!==null)switch(a.tag){case w:var He=a.type;a.pendingProps,v_(Ie,He);break;case R:var dt=a.pendingProps;g_(Ie,dt);break}break}default:return}}}function yD(r,a){a.flags=a.flags&~Xi|dn,qv(r,a)}function OD(r,a){switch(r.tag){case w:{var o=r.type;r.pendingProps;var u=Y5(a,o);return u!==null?(r.stateNode=u,Qn=r,xs=Z5(u),!0):!1}case R:{var m=r.pendingProps,v=q5(a,m);return v!==null?(r.stateNode=v,Qn=r,xs=null,!0):!1}case ee:{var N=K5(a);if(N!==null){var k={dehydrated:N,treeContext:P_(),retryLane:es};r.memoizedState=k;var M=BP(N);return M.return=r,r.child=M,Qn=r,xs=null,!0}return!1}default:return!1}}function Kv(r){return(r.mode&or)!==At&&(r.flags&Dr)===Vt}function Jv(r){throw new Error("Hydration failed because the initial UI does not match what was rendered on the server.")}function Qv(r){if(Bs){var a=xs;if(!a){Kv(r)&&(qv(Qn,r),Jv()),yD(Qn,r),Bs=!1,Qn=r;return}var o=a;if(!OD(r,a)){Kv(r)&&(qv(Qn,r),Jv()),a=Rd(o);var u=Qn;if(!a||!OD(r,a)){yD(Qn,r),Bs=!1,Qn=r;return}SD(u,o)}}}function I_(r,a,o){var u=r.stateNode,m=!Ml,v=r_(u,r.type,r.memoizedProps,a,o,r,m);return r.updateQueue=v,v!==null}function M_(r){var a=r.stateNode,o=r.memoizedProps,u=n_(a,o,r);if(u){var m=Qn;if(m!==null)switch(m.tag){case b:{var v=m.stateNode.containerInfo,N=(m.mode&or)!==At;c_(v,a,o,N);break}case w:{var k=m.type,M=m.memoizedProps,te=m.stateNode,le=(m.mode&or)!==At;u_(k,M,te,a,o,le);break}}}return u}function F_(r){var a=r.memoizedState,o=a!==null?a.dehydrated:null;if(!o)throw new Error("Expected to have a hydrated suspense instance. This error is likely caused by a bug in React. Please file an issue.");a_(o,r)}function $_(r){var a=r.memoizedState,o=a!==null?a.dehydrated:null;if(!o)throw new Error("Expected to have a hydrated suspense instance. This error is likely caused by a bug in React. Please file an issue.");return s_(o)}function ED(r){for(var a=r.return;a!==null&&a.tag!==w&&a.tag!==b&&a.tag!==ee;)a=a.return;Qn=a}function nm(r){if(r!==Qn)return!1;if(!Bs)return ED(r),Bs=!0,!1;if(r.tag!==b&&(r.tag!==w||l_(r.type)&&!Uv(r.type,r.memoizedProps))){var a=xs;if(a)if(Kv(r))wD(r),Jv();else for(;a;)SD(r,a),a=Rd(a)}return ED(r),r.tag===ee?xs=$_(r):xs=Qn?Rd(r.stateNode):null,!0}function B_(){return Bs&&xs!==null}function wD(r){for(var a=xs;a;)DD(r,a),a=Rd(a)}function Yc(){Qn=null,xs=null,Bs=!1,Ml=!1}function CD(){Wo!==null&&(Ny(Wo),Wo=null)}function Zn(){return Bs}function Zv(r){Wo===null?Wo=[r]:Wo.push(r)}var H_=e.ReactCurrentBatchConfig,W_=null;function z_(){return H_.transition}var Hs={recordUnsafeLifecycleWarnings:function(r,a){},flushPendingUnsafeLifecycleWarnings:function(){},recordLegacyContextWarning:function(r,a){},flushLegacyContextWarning:function(){},discardPendingWarnings:function(){}};{var X_=function(r){for(var a=null,o=r;o!==null;)o.mode&Qr&&(a=o),o=o.return;return a},Fl=function(r){var a=[];return r.forEach(function(o){a.push(o)}),a.sort().join(", ")},Ud=[],Ad=[],Ld=[],Vd=[],jd=[],Id=[],$l=new Set;Hs.recordUnsafeLifecycleWarnings=function(r,a){$l.has(r.type)||(typeof a.componentWillMount=="function"&&a.componentWillMount.__suppressDeprecationWarning!==!0&&Ud.push(r),r.mode&Qr&&typeof a.UNSAFE_componentWillMount=="function"&&Ad.push(r),typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps.__suppressDeprecationWarning!==!0&&Ld.push(r),r.mode&Qr&&typeof a.UNSAFE_componentWillReceiveProps=="function"&&Vd.push(r),typeof a.componentWillUpdate=="function"&&a.componentWillUpdate.__suppressDeprecationWarning!==!0&&jd.push(r),r.mode&Qr&&typeof a.UNSAFE_componentWillUpdate=="function"&&Id.push(r))},Hs.flushPendingUnsafeLifecycleWarnings=function(){var r=new Set;Ud.length>0&&(Ud.forEach(function(Ne){r.add(jt(Ne)||"Component"),$l.add(Ne.type)}),Ud=[]);var a=new Set;Ad.length>0&&(Ad.forEach(function(Ne){a.add(jt(Ne)||"Component"),$l.add(Ne.type)}),Ad=[]);var o=new Set;Ld.length>0&&(Ld.forEach(function(Ne){o.add(jt(Ne)||"Component"),$l.add(Ne.type)}),Ld=[]);var u=new Set;Vd.length>0&&(Vd.forEach(function(Ne){u.add(jt(Ne)||"Component"),$l.add(Ne.type)}),Vd=[]);var m=new Set;jd.length>0&&(jd.forEach(function(Ne){m.add(jt(Ne)||"Component"),$l.add(Ne.type)}),jd=[]);var v=new Set;if(Id.length>0&&(Id.forEach(function(Ne){v.add(jt(Ne)||"Component"),$l.add(Ne.type)}),Id=[]),a.size>0){var N=Fl(a);c(`Using UNSAFE_componentWillMount in strict mode is not recommended and may indicate bugs in your code. See https://reactjs.org/link/unsafe-component-lifecycles for details.

* Move code with side effects to componentDidMount, and set initial state in the constructor.

Please update the following components: %s`,N)}if(u.size>0){var k=Fl(u);c(`Using UNSAFE_componentWillReceiveProps in strict mode is not recommended and may indicate bugs in your code. See https://reactjs.org/link/unsafe-component-lifecycles for details.

* Move data fetching code or side effects to componentDidUpdate.
* If you're updating state whenever props change, refactor your code to use memoization techniques or move it to static getDerivedStateFromProps. Learn more at: https://reactjs.org/link/derived-state

Please update the following components: %s`,k)}if(v.size>0){var M=Fl(v);c(`Using UNSAFE_componentWillUpdate in strict mode is not recommended and may indicate bugs in your code. See https://reactjs.org/link/unsafe-component-lifecycles for details.

* Move data fetching code or side effects to componentDidUpdate.

Please update the following components: %s`,M)}if(r.size>0){var te=Fl(r);d(`componentWillMount has been renamed, and is not recommended for use. See https://reactjs.org/link/unsafe-component-lifecycles for details.

* Move code with side effects to componentDidMount, and set initial state in the constructor.
* Rename componentWillMount to UNSAFE_componentWillMount to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run \`npx react-codemod rename-unsafe-lifecycles\` in your project source folder.

Please update the following components: %s`,te)}if(o.size>0){var le=Fl(o);d(`componentWillReceiveProps has been renamed, and is not recommended for use. See https://reactjs.org/link/unsafe-component-lifecycles for details.

* Move data fetching code or side effects to componentDidUpdate.
* If you're updating state whenever props change, refactor your code to use memoization techniques or move it to static getDerivedStateFromProps. Learn more at: https://reactjs.org/link/derived-state
* Rename componentWillReceiveProps to UNSAFE_componentWillReceiveProps to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run \`npx react-codemod rename-unsafe-lifecycles\` in your project source folder.

Please update the following components: %s`,le)}if(m.size>0){var De=Fl(m);d(`componentWillUpdate has been renamed, and is not recommended for use. See https://reactjs.org/link/unsafe-component-lifecycles for details.

* Move data fetching code or side effects to componentDidUpdate.
* Rename componentWillUpdate to UNSAFE_componentWillUpdate to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run \`npx react-codemod rename-unsafe-lifecycles\` in your project source folder.

Please update the following components: %s`,De)}};var am=new Map,kD=new Set;Hs.recordLegacyContextWarning=function(r,a){var o=X_(r);if(o===null){c("Expected to find a StrictMode component in a strict mode tree. This error is likely caused by a bug in React. Please file an issue.");return}if(!kD.has(r.type)){var u=am.get(o);(r.type.contextTypes!=null||r.type.childContextTypes!=null||a!==null&&typeof a.getChildContext=="function")&&(u===void 0&&(u=[],am.set(o,u)),u.push(r))}},Hs.flushLegacyContextWarning=function(){am.forEach(function(r,a){if(r.length!==0){var o=r[0],u=new Set;r.forEach(function(v){u.add(jt(v)||"Component"),kD.add(v.type)});var m=Fl(u);try{yt(o),c(`Legacy context API has been detected within a strict-mode tree.

The old API will be supported in all 16.x releases, but applications using it should migrate to the new version.

Please update the following components: %s

Learn more about this warning here: https://reactjs.org/link/legacy-context`,m)}finally{un()}}})},Hs.discardPendingWarnings=function(){Ud=[],Ad=[],Ld=[],Vd=[],jd=[],Id=[],am=new Map}}var eg,tg,rg,ng,ag,RD=function(r,a){};eg=!1,tg=!1,rg={},ng={},ag={},RD=function(r,a){if(!(r===null||typeof r!="object")&&!(!r._store||r._store.validated||r.key!=null)){if(typeof r._store!="object")throw new Error("React Component in warnForMissingKey should have a _store. This error is likely caused by a bug in React. Please file an issue.");r._store.validated=!0;var o=jt(a)||"Component";ng[o]||(ng[o]=!0,c('Each child in a list should have a unique "key" prop. See https://reactjs.org/link/warning-keys for more information.'))}};function G_(r){return r.prototype&&r.prototype.isReactComponent}function Md(r,a,o){var u=o.ref;if(u!==null&&typeof u!="function"&&typeof u!="object"){if((r.mode&Qr||j)&&!(o._owner&&o._self&&o._owner.stateNode!==o._self)&&!(o._owner&&o._owner.tag!==g)&&!(typeof o.type=="function"&&!G_(o.type))&&o._owner){var m=jt(r)||"Component";rg[m]||(c('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. We recommend using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',m,u),rg[m]=!0)}if(o._owner){var v=o._owner,N;if(v){var k=v;if(k.tag!==g)throw new Error("Function components cannot have string refs. We recommend using useRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref");N=k.stateNode}if(!N)throw new Error("Missing owner for string ref "+u+". This error is likely caused by a bug in React. Please file an issue.");var M=N;er(u,"ref");var te=""+u;if(a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===te)return a.ref;var le=function(De){var Ne=M.refs;De===null?delete Ne[te]:Ne[te]=De};return le._stringRef=te,le}else{if(typeof u!="string")throw new Error("Expected ref to be a function, a string, an object returned by React.createRef(), or null.");if(!o._owner)throw new Error("Element ref was specified as a string ("+u+`) but no owner was set. This could happen for one of the following reasons:
1. You may be adding a ref to a function component
2. You may be adding a ref to a component that was not created inside a component's render method
3. You have multiple copies of React loaded
See https://reactjs.org/link/refs-must-have-owner for more information.`)}}return u}function sm(r,a){var o=Object.prototype.toString.call(a);throw new Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.")}function im(r){{var a=jt(r)||"Component";if(ag[a])return;ag[a]=!0,c("Functions are not valid as a React child. This may happen if you return a Component instead of <Component /> from render. Or maybe you meant to call this function rather than return it.")}}function TD(r){var a=r._payload,o=r._init;return o(a)}function _D(r){function a(Te,We){if(r){var _e=Te.deletions;_e===null?(Te.deletions=[We],Te.flags|=yl):_e.push(We)}}function o(Te,We){if(!r)return null;for(var _e=We;_e!==null;)a(Te,_e),_e=_e.sibling;return null}function u(Te,We){for(var _e=new Map,rt=We;rt!==null;)rt.key!==null?_e.set(rt.key,rt):_e.set(rt.index,rt),rt=rt.sibling;return _e}function m(Te,We){var _e=Kl(Te,We);return _e.index=0,_e.sibling=null,_e}function v(Te,We,_e){if(Te.index=_e,!r)return Te.flags|=AN,We;var rt=Te.alternate;if(rt!==null){var bt=rt.index;return bt<We?(Te.flags|=dn,We):bt}else return Te.flags|=dn,We}function N(Te){return r&&Te.alternate===null&&(Te.flags|=dn),Te}function k(Te,We,_e,rt){if(We===null||We.tag!==R){var bt=Zx(_e,Te.mode,rt);return bt.return=Te,bt}else{var ht=m(We,_e);return ht.return=Te,ht}}function M(Te,We,_e,rt){var bt=_e.type;if(bt===wa)return le(Te,We,_e.props.children,rt,_e.key);if(We!==null&&(We.elementType===bt||Vy(We,_e)||typeof bt=="object"&&bt!==null&&bt.$$typeof===xe&&TD(bt)===We.type)){var ht=m(We,_e.props);return ht.ref=Md(Te,We,_e),ht.return=Te,ht._debugSource=_e._source,ht._debugOwner=_e._owner,ht}var It=Qx(_e,Te.mode,rt);return It.ref=Md(Te,We,_e),It.return=Te,It}function te(Te,We,_e,rt){if(We===null||We.tag!==E||We.stateNode.containerInfo!==_e.containerInfo||We.stateNode.implementation!==_e.implementation){var bt=eb(_e,Te.mode,rt);return bt.return=Te,bt}else{var ht=m(We,_e.children||[]);return ht.return=Te,ht}}function le(Te,We,_e,rt,bt){if(We===null||We.tag!==y){var ht=tl(_e,Te.mode,rt,bt);return ht.return=Te,ht}else{var It=m(We,_e);return It.return=Te,It}}function De(Te,We,_e){if(typeof We=="string"&&We!==""||typeof We=="number"){var rt=Zx(""+We,Te.mode,_e);return rt.return=Te,rt}if(typeof We=="object"&&We!==null){switch(We.$$typeof){case xn:{var bt=Qx(We,Te.mode,_e);return bt.ref=Md(Te,null,We),bt.return=Te,bt}case cn:{var ht=eb(We,Te.mode,_e);return ht.return=Te,ht}case xe:{var It=We._payload,Xt=We._init;return De(Te,Xt(It),_e)}}if(Kt(We)||lt(We)){var Tr=tl(We,Te.mode,_e,null);return Tr.return=Te,Tr}sm(Te,We)}return typeof We=="function"&&im(Te),null}function Ne(Te,We,_e,rt){var bt=We!==null?We.key:null;if(typeof _e=="string"&&_e!==""||typeof _e=="number")return bt!==null?null:k(Te,We,""+_e,rt);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case xn:return _e.key===bt?M(Te,We,_e,rt):null;case cn:return _e.key===bt?te(Te,We,_e,rt):null;case xe:{var ht=_e._payload,It=_e._init;return Ne(Te,We,It(ht),rt)}}if(Kt(_e)||lt(_e))return bt!==null?null:le(Te,We,_e,rt,null);sm(Te,_e)}return typeof _e=="function"&&im(Te),null}function Ae(Te,We,_e,rt,bt){if(typeof rt=="string"&&rt!==""||typeof rt=="number"){var ht=Te.get(_e)||null;return k(We,ht,""+rt,bt)}if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case xn:{var It=Te.get(rt.key===null?_e:rt.key)||null;return M(We,It,rt,bt)}case cn:{var Xt=Te.get(rt.key===null?_e:rt.key)||null;return te(We,Xt,rt,bt)}case xe:var Tr=rt._payload,hr=rt._init;return Ae(Te,We,_e,hr(Tr),bt)}if(Kt(rt)||lt(rt)){var sn=Te.get(_e)||null;return le(We,sn,rt,bt,null)}sm(We,rt)}return typeof rt=="function"&&im(We),null}function Ie(Te,We,_e){{if(typeof Te!="object"||Te===null)return We;switch(Te.$$typeof){case xn:case cn:RD(Te,_e);var rt=Te.key;if(typeof rt!="string")break;if(We===null){We=new Set,We.add(rt);break}if(!We.has(rt)){We.add(rt);break}c("Encountered two children with the same key, `%s`. Keys should be unique so that components maintain their identity across updates. Non-unique keys may cause children to be duplicated and/or omitted  the behavior is unsupported and could change in a future version.",rt);break;case xe:var bt=Te._payload,ht=Te._init;Ie(ht(bt),We,_e);break}}return We}function He(Te,We,_e,rt){for(var bt=null,ht=0;ht<_e.length;ht++){var It=_e[ht];bt=Ie(It,bt,Te)}for(var Xt=null,Tr=null,hr=We,sn=0,pr=0,Zr=null;hr!==null&&pr<_e.length;pr++){hr.index>pr?(Zr=hr,hr=null):Zr=hr.sibling;var va=Ne(Te,hr,_e[pr],rt);if(va===null){hr===null&&(hr=Zr);break}r&&hr&&va.alternate===null&&a(Te,hr),sn=v(va,sn,pr),Tr===null?Xt=va:Tr.sibling=va,Tr=va,hr=Zr}if(pr===_e.length){if(o(Te,hr),Zn()){var ia=pr;jl(Te,ia)}return Xt}if(hr===null){for(;pr<_e.length;pr++){var os=De(Te,_e[pr],rt);os!==null&&(sn=v(os,sn,pr),Tr===null?Xt=os:Tr.sibling=os,Tr=os)}if(Zn()){var Pa=pr;jl(Te,Pa)}return Xt}for(var Ua=u(Te,hr);pr<_e.length;pr++){var ga=Ae(Ua,Te,pr,_e[pr],rt);ga!==null&&(r&&ga.alternate!==null&&Ua.delete(ga.key===null?pr:ga.key),sn=v(ga,sn,pr),Tr===null?Xt=ga:Tr.sibling=ga,Tr=ga)}if(r&&Ua.forEach(function(mu){return a(Te,mu)}),Zn()){var lo=pr;jl(Te,lo)}return Xt}function dt(Te,We,_e,rt){var bt=lt(_e);if(typeof bt!="function")throw new Error("An object is not an iterable. This error is likely caused by a bug in React. Please file an issue.");{typeof Symbol=="function"&&_e[Symbol.toStringTag]==="Generator"&&(tg||c("Using Generators as children is unsupported and will likely yield unexpected results because enumerating a generator mutates it. You may convert it to an array with `Array.from()` or the `[...spread]` operator before rendering. Keep in mind you might need to polyfill these features for older browsers."),tg=!0),_e.entries===bt&&(eg||c("Using Maps as children is not supported. Use an array of keyed ReactElements instead."),eg=!0);var ht=bt.call(_e);if(ht)for(var It=null,Xt=ht.next();!Xt.done;Xt=ht.next()){var Tr=Xt.value;It=Ie(Tr,It,Te)}}var hr=bt.call(_e);if(hr==null)throw new Error("An iterable object provided no iterator.");for(var sn=null,pr=null,Zr=We,va=0,ia=0,os=null,Pa=hr.next();Zr!==null&&!Pa.done;ia++,Pa=hr.next()){Zr.index>ia?(os=Zr,Zr=null):os=Zr.sibling;var Ua=Ne(Te,Zr,Pa.value,rt);if(Ua===null){Zr===null&&(Zr=os);break}r&&Zr&&Ua.alternate===null&&a(Te,Zr),va=v(Ua,va,ia),pr===null?sn=Ua:pr.sibling=Ua,pr=Ua,Zr=os}if(Pa.done){if(o(Te,Zr),Zn()){var ga=ia;jl(Te,ga)}return sn}if(Zr===null){for(;!Pa.done;ia++,Pa=hr.next()){var lo=De(Te,Pa.value,rt);lo!==null&&(va=v(lo,va,ia),pr===null?sn=lo:pr.sibling=lo,pr=lo)}if(Zn()){var mu=ia;jl(Te,mu)}return sn}for(var xf=u(Te,Zr);!Pa.done;ia++,Pa=hr.next()){var Ei=Ae(xf,Te,ia,Pa.value,rt);Ei!==null&&(r&&Ei.alternate!==null&&xf.delete(Ei.key===null?ia:Ei.key),va=v(Ei,va,ia),pr===null?sn=Ei:pr.sibling=Ei,pr=Ei)}if(r&&xf.forEach(function(bU){return a(Te,bU)}),Zn()){var xU=ia;jl(Te,xU)}return sn}function Ut(Te,We,_e,rt){if(We!==null&&We.tag===R){o(Te,We.sibling);var bt=m(We,_e);return bt.return=Te,bt}o(Te,We);var ht=Zx(_e,Te.mode,rt);return ht.return=Te,ht}function Rt(Te,We,_e,rt){for(var bt=_e.key,ht=We;ht!==null;){if(ht.key===bt){var It=_e.type;if(It===wa){if(ht.tag===y){o(Te,ht.sibling);var Xt=m(ht,_e.props.children);return Xt.return=Te,Xt._debugSource=_e._source,Xt._debugOwner=_e._owner,Xt}}else if(ht.elementType===It||Vy(ht,_e)||typeof It=="object"&&It!==null&&It.$$typeof===xe&&TD(It)===ht.type){o(Te,ht.sibling);var Tr=m(ht,_e.props);return Tr.ref=Md(Te,ht,_e),Tr.return=Te,Tr._debugSource=_e._source,Tr._debugOwner=_e._owner,Tr}o(Te,ht);break}else a(Te,ht);ht=ht.sibling}if(_e.type===wa){var hr=tl(_e.props.children,Te.mode,rt,_e.key);return hr.return=Te,hr}else{var sn=Qx(_e,Te.mode,rt);return sn.ref=Md(Te,We,_e),sn.return=Te,sn}}function cr(Te,We,_e,rt){for(var bt=_e.key,ht=We;ht!==null;){if(ht.key===bt)if(ht.tag===E&&ht.stateNode.containerInfo===_e.containerInfo&&ht.stateNode.implementation===_e.implementation){o(Te,ht.sibling);var It=m(ht,_e.children||[]);return It.return=Te,It}else{o(Te,ht);break}else a(Te,ht);ht=ht.sibling}var Xt=eb(_e,Te.mode,rt);return Xt.return=Te,Xt}function sr(Te,We,_e,rt){var bt=typeof _e=="object"&&_e!==null&&_e.type===wa&&_e.key===null;if(bt&&(_e=_e.props.children),typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case xn:return N(Rt(Te,We,_e,rt));case cn:return N(cr(Te,We,_e,rt));case xe:var ht=_e._payload,It=_e._init;return sr(Te,We,It(ht),rt)}if(Kt(_e))return He(Te,We,_e,rt);if(lt(_e))return dt(Te,We,_e,rt);sm(Te,_e)}return typeof _e=="string"&&_e!==""||typeof _e=="number"?N(Ut(Te,We,""+_e,rt)):(typeof _e=="function"&&im(Te),o(Te,We))}return sr}var qc=_D(!0),PD=_D(!1);function Y_(r,a){if(r!==null&&a.child!==r.child)throw new Error("Resuming work not yet implemented.");if(a.child!==null){var o=a.child,u=Kl(o,o.pendingProps);for(a.child=u,u.return=a;o.sibling!==null;)o=o.sibling,u=u.sibling=Kl(o,o.pendingProps),u.return=a;u.sibling=null}}function q_(r,a){for(var o=r.child;o!==null;)VP(o,a),o=o.sibling}var sg=$o(null),ig;ig={};var om=null,Kc=null,og=null,lm=!1;function cm(){om=null,Kc=null,og=null,lm=!1}function UD(){lm=!0}function AD(){lm=!1}function LD(r,a,o){ha(sg,a._currentValue,r),a._currentValue=o,a._currentRenderer!==void 0&&a._currentRenderer!==null&&a._currentRenderer!==ig&&c("Detected multiple renderers concurrently rendering the same context provider. This is currently unsupported."),a._currentRenderer=ig}function lg(r,a){var o=sg.current;ma(sg,a),r._currentValue=o}function cg(r,a,o){for(var u=r;u!==null;){var m=u.alternate;if(Ac(u.childLanes,a)?m!==null&&!Ac(m.childLanes,a)&&(m.childLanes=Qt(m.childLanes,a)):(u.childLanes=Qt(u.childLanes,a),m!==null&&(m.childLanes=Qt(m.childLanes,a))),u===o)break;u=u.return}u!==o&&c("Expected to find the propagation root when scheduling context work. This error is likely caused by a bug in React. Please file an issue.")}function K_(r,a,o){J_(r,a,o)}function J_(r,a,o){var u=r.child;for(u!==null&&(u.return=r);u!==null;){var m=void 0,v=u.dependencies;if(v!==null){m=u.child;for(var N=v.firstContext;N!==null;){if(N.context===a){if(u.tag===g){var k=nd(o),M=ro(Ir,k);M.tag=dm;var te=u.updateQueue;if(te!==null){var le=te.shared,De=le.pending;De===null?M.next=M:(M.next=De.next,De.next=M),le.pending=M}}u.lanes=Qt(u.lanes,o);var Ne=u.alternate;Ne!==null&&(Ne.lanes=Qt(Ne.lanes,o)),cg(u.return,o,r),v.lanes=Qt(v.lanes,o);break}N=N.next}}else if(u.tag===G)m=u.type===r.type?null:u.child;else if(u.tag===A){var Ae=u.return;if(Ae===null)throw new Error("We just came from a parent so we must have had a parent. This is a bug in React.");Ae.lanes=Qt(Ae.lanes,o);var Ie=Ae.alternate;Ie!==null&&(Ie.lanes=Qt(Ie.lanes,o)),cg(Ae,o,r),m=u.sibling}else m=u.child;if(m!==null)m.return=u;else for(m=u;m!==null;){if(m===r){m=null;break}var He=m.sibling;if(He!==null){He.return=m.return,m=He;break}m=m.return}u=m}}function Jc(r,a){om=r,Kc=null,og=null;var o=r.dependencies;if(o!==null){var u=o.firstContext;u!==null&&(ts(o.lanes,a)&&ef(),o.firstContext=null)}}function fn(r){lm&&c("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo().");var a=r._currentValue;if(og!==r){var o={context:r,memoizedValue:a,next:null};if(Kc===null){if(om===null)throw new Error("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo().");Kc=o,om.dependencies={lanes:Je,firstContext:o}}else Kc=Kc.next=o}return a}var Bl=null;function ug(r){Bl===null?Bl=[r]:Bl.push(r)}function Q_(){if(Bl!==null){for(var r=0;r<Bl.length;r++){var a=Bl[r],o=a.interleaved;if(o!==null){a.interleaved=null;var u=o.next,m=a.pending;if(m!==null){var v=m.next;m.next=u,o.next=v}a.pending=o}}Bl=null}}function VD(r,a,o,u){var m=a.interleaved;return m===null?(o.next=o,ug(a)):(o.next=m.next,m.next=o),a.interleaved=o,um(r,u)}function Z_(r,a,o,u){var m=a.interleaved;m===null?(o.next=o,ug(a)):(o.next=m.next,m.next=o),a.interleaved=o}function e2(r,a,o,u){var m=a.interleaved;return m===null?(o.next=o,ug(a)):(o.next=m.next,m.next=o),a.interleaved=o,um(r,u)}function Ha(r,a){return um(r,a)}var t2=um;function um(r,a){r.lanes=Qt(r.lanes,a);var o=r.alternate;o!==null&&(o.lanes=Qt(o.lanes,a)),o===null&&(r.flags&(dn|Xi))!==Vt&&Py(r);for(var u=r,m=r.return;m!==null;)m.childLanes=Qt(m.childLanes,a),o=m.alternate,o!==null?o.childLanes=Qt(o.childLanes,a):(m.flags&(dn|Xi))!==Vt&&Py(r),u=m,m=m.return;if(u.tag===b){var v=u.stateNode;return v}else return null}var jD=0,ID=1,dm=2,dg=3,fm=!1,fg,mm;fg=!1,mm=null;function mg(r){var a={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:Je},effects:null};r.updateQueue=a}function MD(r,a){var o=a.updateQueue,u=r.updateQueue;if(o===u){var m={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects};a.updateQueue=m}}function ro(r,a){var o={eventTime:r,lane:a,tag:jD,payload:null,callback:null,next:null};return o}function zo(r,a,o){var u=r.updateQueue;if(u===null)return null;var m=u.shared;if(mm===m&&!fg&&(c("An update (setState, replaceState, or forceUpdate) was scheduled from inside an update function. Update functions should be pure, with zero side-effects. Consider using componentDidUpdate or a callback."),fg=!0),Z3()){var v=m.pending;return v===null?a.next=a:(a.next=v.next,v.next=a),m.pending=a,t2(r,o)}else return e2(r,m,a,o)}function hm(r,a,o){var u=a.updateQueue;if(u!==null){var m=u.shared;if(QN(o)){var v=m.lanes;v=e1(v,r.pendingLanes);var N=Qt(v,o);m.lanes=N,sv(r,N)}}}function hg(r,a){var o=r.updateQueue,u=r.alternate;if(u!==null){var m=u.updateQueue;if(o===m){var v=null,N=null,k=o.firstBaseUpdate;if(k!==null){var M=k;do{var te={eventTime:M.eventTime,lane:M.lane,tag:M.tag,payload:M.payload,callback:M.callback,next:null};N===null?v=N=te:(N.next=te,N=te),M=M.next}while(M!==null);N===null?v=N=a:(N.next=a,N=a)}else v=N=a;o={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:N,shared:m.shared,effects:m.effects},r.updateQueue=o;return}}var le=o.lastBaseUpdate;le===null?o.firstBaseUpdate=a:le.next=a,o.lastBaseUpdate=a}function r2(r,a,o,u,m,v){switch(o.tag){case ID:{var N=o.payload;if(typeof N=="function"){UD();var k=N.call(v,u,m);{if(r.mode&Qr){Mn(!0);try{N.call(v,u,m)}finally{Mn(!1)}}AD()}return k}return N}case dg:r.flags=r.flags&~ka|Dr;case jD:{var M=o.payload,te;if(typeof M=="function"){UD(),te=M.call(v,u,m);{if(r.mode&Qr){Mn(!0);try{M.call(v,u,m)}finally{Mn(!1)}}AD()}}else te=M;return te==null?u:ot({},u,te)}case dm:return fm=!0,u}return u}function pm(r,a,o,u){var m=r.updateQueue;fm=!1,mm=m.shared;var v=m.firstBaseUpdate,N=m.lastBaseUpdate,k=m.shared.pending;if(k!==null){m.shared.pending=null;var M=k,te=M.next;M.next=null,N===null?v=te:N.next=te,N=M;var le=r.alternate;if(le!==null){var De=le.updateQueue,Ne=De.lastBaseUpdate;Ne!==N&&(Ne===null?De.firstBaseUpdate=te:Ne.next=te,De.lastBaseUpdate=M)}}if(v!==null){var Ae=m.baseState,Ie=Je,He=null,dt=null,Ut=null,Rt=v;do{var cr=Rt.lane,sr=Rt.eventTime;if(Ac(u,cr)){if(Ut!==null){var We={eventTime:sr,lane:Fn,tag:Rt.tag,payload:Rt.payload,callback:Rt.callback,next:null};Ut=Ut.next=We}Ae=r2(r,m,Rt,Ae,a,o);var _e=Rt.callback;if(_e!==null&&Rt.lane!==Fn){r.flags|=UN;var rt=m.effects;rt===null?m.effects=[Rt]:rt.push(Rt)}}else{var Te={eventTime:sr,lane:cr,tag:Rt.tag,payload:Rt.payload,callback:Rt.callback,next:null};Ut===null?(dt=Ut=Te,He=Ae):Ut=Ut.next=Te,Ie=Qt(Ie,cr)}if(Rt=Rt.next,Rt===null){if(k=m.shared.pending,k===null)break;var bt=k,ht=bt.next;bt.next=null,Rt=ht,m.lastBaseUpdate=bt,m.shared.pending=null}}while(!0);Ut===null&&(He=Ae),m.baseState=He,m.firstBaseUpdate=dt,m.lastBaseUpdate=Ut;var It=m.shared.interleaved;if(It!==null){var Xt=It;do Ie=Qt(Ie,Xt.lane),Xt=Xt.next;while(Xt!==It)}else v===null&&(m.shared.lanes=Je);mf(Ie),r.lanes=Ie,r.memoizedState=Ae}mm=null}function n2(r,a){if(typeof r!="function")throw new Error("Invalid argument passed as callback. Expected a function. Instead "+("received: "+r));r.call(a)}function FD(){fm=!1}function vm(){return fm}function $D(r,a,o){var u=a.effects;if(a.effects=null,u!==null)for(var m=0;m<u.length;m++){var v=u[m],N=v.callback;N!==null&&(v.callback=null,n2(N,o))}}var Fd={},Xo=$o(Fd),$d=$o(Fd),gm=$o(Fd);function xm(r){if(r===Fd)throw new Error("Expected host context to exist. This error is likely caused by a bug in React. Please file an issue.");return r}function BD(){var r=xm(gm.current);return r}function pg(r,a){ha(gm,a,r),ha($d,r,r),ha(Xo,Fd,r);var o=N5(a);ma(Xo,r),ha(Xo,o,r)}function Qc(r){ma(Xo,r),ma($d,r),ma(gm,r)}function vg(){var r=xm(Xo.current);return r}function HD(r){xm(gm.current);var a=xm(Xo.current),o=D5(a,r.type);a!==o&&(ha($d,r,r),ha(Xo,o,r))}function gg(r){$d.current===r&&(ma(Xo,r),ma($d,r))}var a2=0,WD=1,zD=1,Bd=2,Ws=$o(a2);function xg(r,a){return(r&a)!==0}function Zc(r){return r&WD}function bg(r,a){return r&WD|a}function s2(r,a){return r|a}function Go(r,a){ha(Ws,a,r)}function eu(r){ma(Ws,r)}function i2(r,a){var o=r.memoizedState;return o!==null?o.dehydrated!==null:(r.memoizedProps,!0)}function bm(r){for(var a=r;a!==null;){if(a.tag===ee){var o=a.memoizedState;if(o!==null){var u=o.dehydrated;if(u===null||lD(u)||jv(u))return a}}else if(a.tag===W&&a.memoizedProps.revealOrder!==void 0){var m=(a.flags&Dr)!==Vt;if(m)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)return null;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Wa=0,yn=1,xi=2,On=4,ea=8,Ng=[];function Dg(){for(var r=0;r<Ng.length;r++){var a=Ng[r];a._workInProgressVersionPrimary=null}Ng.length=0}function o2(r,a){var o=a._getVersion,u=o(a._source);r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[a,u]:r.mutableSourceEagerHydrationData.push(a,u)}var gt=e.ReactCurrentDispatcher,Hd=e.ReactCurrentBatchConfig,Sg,tu;Sg=new Set;var Hl=Je,Rr=null,En=null,wn=null,Nm=!1,Wd=!1,zd=0,l2=0,c2=25,Ye=null,bs=null,Yo=-1,yg=!1;function Or(){{var r=Ye;bs===null?bs=[r]:bs.push(r)}}function ut(){{var r=Ye;bs!==null&&(Yo++,bs[Yo]!==r&&u2(r))}}function ru(r){r!=null&&!Kt(r)&&c("%s received a final argument that is not an array (instead, received `%s`). When specified, the final argument must be an array.",Ye,typeof r)}function u2(r){{var a=jt(Rr);if(!Sg.has(a)&&(Sg.add(a),bs!==null)){for(var o="",u=30,m=0;m<=Yo;m++){for(var v=bs[m],N=m===Yo?r:v,k=m+1+". "+v;k.length<u;)k+=" ";k+=N+`
`,o+=k}c(`React has detected a change in the order of Hooks called by %s. This will lead to bugs and errors if not fixed. For more information, read the Rules of Hooks: https://reactjs.org/link/rules-of-hooks

   Previous render            Next render
   ------------------------------------------------------
%s   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
`,a,o)}}}function pa(){throw new Error(`Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:
1. You might have mismatching versions of React and the renderer (such as React DOM)
2. You might be breaking the Rules of Hooks
3. You might have more than one copy of React in the same app
See https://reactjs.org/link/invalid-hook-call for tips about how to debug and fix this problem.`)}function Og(r,a){if(yg)return!1;if(a===null)return c("%s received a final argument during this render, but not during the previous render. Even though the final argument is optional, its type cannot change between renders.",Ye),!1;r.length!==a.length&&c(`The final argument passed to %s changed size between renders. The order and size of this array must remain constant.

Previous: %s
Incoming: %s`,Ye,"["+a.join(", ")+"]","["+r.join(", ")+"]");for(var o=0;o<a.length&&o<r.length;o++)if(!as(r[o],a[o]))return!1;return!0}function nu(r,a,o,u,m,v){Hl=v,Rr=a,bs=r!==null?r._debugHookTypes:null,Yo=-1,yg=r!==null&&r.type!==a.type,a.memoizedState=null,a.updateQueue=null,a.lanes=Je,r!==null&&r.memoizedState!==null?gt.current=mS:bs!==null?gt.current=fS:gt.current=dS;var N=o(u,m);if(Wd){var k=0;do{if(Wd=!1,zd=0,k>=c2)throw new Error("Too many re-renders. React limits the number of renders to prevent an infinite loop.");k+=1,yg=!1,En=null,wn=null,a.updateQueue=null,Yo=-1,gt.current=hS,N=o(u,m)}while(Wd)}gt.current=Um,a._debugHookTypes=bs;var M=En!==null&&En.next!==null;if(Hl=Je,Rr=null,En=null,wn=null,Ye=null,bs=null,Yo=-1,r!==null&&(r.flags&Gi)!==(a.flags&Gi)&&(r.mode&or)!==At&&c("Internal React error: Expected static flag was missing. Please notify the React team."),Nm=!1,M)throw new Error("Rendered fewer hooks than expected. This may be caused by an accidental early return statement.");return N}function au(){var r=zd!==0;return zd=0,r}function XD(r,a,o){a.updateQueue=r.updateQueue,(a.mode&hi)!==At?a.flags&=-50333701:a.flags&=-2053,r.lanes=D0(r.lanes,o)}function GD(){if(gt.current=Um,Nm){for(var r=Rr.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Nm=!1}Hl=Je,Rr=null,En=null,wn=null,bs=null,Yo=-1,Ye=null,iS=!1,Wd=!1,zd=0}function bi(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wn===null?Rr.memoizedState=wn=r:wn=wn.next=r,wn}function Ns(){var r;if(En===null){var a=Rr.alternate;a!==null?r=a.memoizedState:r=null}else r=En.next;var o;if(wn===null?o=Rr.memoizedState:o=wn.next,o!==null)wn=o,o=wn.next,En=r;else{if(r===null)throw new Error("Rendered more hooks than during the previous render.");En=r;var u={memoizedState:En.memoizedState,baseState:En.baseState,baseQueue:En.baseQueue,queue:En.queue,next:null};wn===null?Rr.memoizedState=wn=u:wn=wn.next=u}return wn}function YD(){return{lastEffect:null,stores:null}}function Eg(r,a){return typeof a=="function"?a(r):a}function wg(r,a,o){var u=bi(),m;o!==void 0?m=o(a):m=a,u.memoizedState=u.baseState=m;var v={pending:null,interleaved:null,lanes:Je,dispatch:null,lastRenderedReducer:r,lastRenderedState:m};u.queue=v;var N=v.dispatch=h2.bind(null,Rr,v);return[u.memoizedState,N]}function Cg(r,a,o){var u=Ns(),m=u.queue;if(m===null)throw new Error("Should have a queue. This is likely a bug in React. Please file an issue.");m.lastRenderedReducer=r;var v=En,N=v.baseQueue,k=m.pending;if(k!==null){if(N!==null){var M=N.next,te=k.next;N.next=te,k.next=M}v.baseQueue!==N&&c("Internal error: Expected work-in-progress queue to be a clone. This is a bug in React."),v.baseQueue=N=k,m.pending=null}if(N!==null){var le=N.next,De=v.baseState,Ne=null,Ae=null,Ie=null,He=le;do{var dt=He.lane;if(Ac(Hl,dt)){if(Ie!==null){var Rt={lane:Fn,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null};Ie=Ie.next=Rt}if(He.hasEagerState)De=He.eagerState;else{var cr=He.action;De=r(De,cr)}}else{var Ut={lane:dt,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null};Ie===null?(Ae=Ie=Ut,Ne=De):Ie=Ie.next=Ut,Rr.lanes=Qt(Rr.lanes,dt),mf(dt)}He=He.next}while(He!==null&&He!==le);Ie===null?Ne=De:Ie.next=Ae,as(De,u.memoizedState)||ef(),u.memoizedState=De,u.baseState=Ne,u.baseQueue=Ie,m.lastRenderedState=De}var sr=m.interleaved;if(sr!==null){var Te=sr;do{var We=Te.lane;Rr.lanes=Qt(Rr.lanes,We),mf(We),Te=Te.next}while(Te!==sr)}else N===null&&(m.lanes=Je);var _e=m.dispatch;return[u.memoizedState,_e]}function kg(r,a,o){var u=Ns(),m=u.queue;if(m===null)throw new Error("Should have a queue. This is likely a bug in React. Please file an issue.");m.lastRenderedReducer=r;var v=m.dispatch,N=m.pending,k=u.memoizedState;if(N!==null){m.pending=null;var M=N.next,te=M;do{var le=te.action;k=r(k,le),te=te.next}while(te!==M);as(k,u.memoizedState)||ef(),u.memoizedState=k,u.baseQueue===null&&(u.baseState=k),m.lastRenderedState=k}return[k,v]}function O9(r,a,o){}function E9(r,a,o){}function Rg(r,a,o){var u=Rr,m=bi(),v,N=Zn();if(N){if(o===void 0)throw new Error("Missing getServerSnapshot, which is required for server-rendered content. Will revert to client rendering.");v=o(),tu||v!==o()&&(c("The result of getServerSnapshot should be cached to avoid an infinite loop"),tu=!0)}else{if(v=a(),!tu){var k=a();as(v,k)||(c("The result of getSnapshot should be cached to avoid an infinite loop"),tu=!0)}var M=Qm();if(M===null)throw new Error("Expected a work-in-progress root. This is a bug in React. Please file an issue.");N0(M,Hl)||qD(u,a,v)}m.memoizedState=v;var te={value:v,getSnapshot:a};return m.queue=te,Em(JD.bind(null,u,te,r),[r]),u.flags|=Po,Xd(yn|ea,KD.bind(null,u,te,v,a),void 0,null),v}function Dm(r,a,o){var u=Rr,m=Ns(),v=a();if(!tu){var N=a();as(v,N)||(c("The result of getSnapshot should be cached to avoid an infinite loop"),tu=!0)}var k=m.memoizedState,M=!as(k,v);M&&(m.memoizedState=v,ef());var te=m.queue;if(Yd(JD.bind(null,u,te,r),[r]),te.getSnapshot!==a||M||wn!==null&&wn.memoizedState.tag&yn){u.flags|=Po,Xd(yn|ea,KD.bind(null,u,te,v,a),void 0,null);var le=Qm();if(le===null)throw new Error("Expected a work-in-progress root. This is a bug in React. Please file an issue.");N0(le,Hl)||qD(u,a,v)}return v}function qD(r,a,o){r.flags|=Ep;var u={getSnapshot:a,value:o},m=Rr.updateQueue;if(m===null)m=YD(),Rr.updateQueue=m,m.stores=[u];else{var v=m.stores;v===null?m.stores=[u]:v.push(u)}}function KD(r,a,o,u){a.value=o,a.getSnapshot=u,QD(a)&&ZD(r)}function JD(r,a,o){var u=function(){QD(a)&&ZD(r)};return o(u)}function QD(r){var a=r.getSnapshot,o=r.value;try{var u=a();return!as(o,u)}catch{return!0}}function ZD(r){var a=Ha(r,Bt);a!==null&&Tn(a,r,Bt,Ir)}function Sm(r){var a=bi();typeof r=="function"&&(r=r()),a.memoizedState=a.baseState=r;var o={pending:null,interleaved:null,lanes:Je,dispatch:null,lastRenderedReducer:Eg,lastRenderedState:r};a.queue=o;var u=o.dispatch=p2.bind(null,Rr,o);return[a.memoizedState,u]}function Tg(r){return Cg(Eg)}function _g(r){return kg(Eg)}function Xd(r,a,o,u){var m={tag:r,create:a,destroy:o,deps:u,next:null},v=Rr.updateQueue;if(v===null)v=YD(),Rr.updateQueue=v,v.lastEffect=m.next=m;else{var N=v.lastEffect;if(N===null)v.lastEffect=m.next=m;else{var k=N.next;N.next=m,m.next=k,v.lastEffect=m}}return m}function Pg(r){var a=bi();{var o={current:r};return a.memoizedState=o,o}}function ym(r){var a=Ns();return a.memoizedState}function Gd(r,a,o,u){var m=bi(),v=u===void 0?null:u;Rr.flags|=r,m.memoizedState=Xd(yn|a,o,void 0,v)}function Om(r,a,o,u){var m=Ns(),v=u===void 0?null:u,N=void 0;if(En!==null){var k=En.memoizedState;if(N=k.destroy,v!==null){var M=k.deps;if(Og(v,M)){m.memoizedState=Xd(a,o,N,v);return}}}Rr.flags|=r,m.memoizedState=Xd(yn|a,o,N,v)}function Em(r,a){return(Rr.mode&hi)!==At?Gd(Rp|Po|kp,ea,r,a):Gd(Po|kp,ea,r,a)}function Yd(r,a){return Om(Po,ea,r,a)}function Ug(r,a){return Gd(Nr,xi,r,a)}function wm(r,a){return Om(Nr,xi,r,a)}function Ag(r,a){var o=Nr;return o|=wl,(Rr.mode&hi)!==At&&(o|=Uo),Gd(o,On,r,a)}function Cm(r,a){return Om(Nr,On,r,a)}function eS(r,a){if(typeof a=="function"){var o=a,u=r();return o(u),function(){o(null)}}else if(a!=null){var m=a;m.hasOwnProperty("current")||c("Expected useImperativeHandle() first argument to either be a ref callback or React.createRef() object. Instead received: %s.","an object with keys {"+Object.keys(m).join(", ")+"}");var v=r();return m.current=v,function(){m.current=null}}}function Lg(r,a,o){typeof a!="function"&&c("Expected useImperativeHandle() second argument to be a function that creates a handle. Instead received: %s.",a!==null?typeof a:"null");var u=o!=null?o.concat([r]):null,m=Nr;return m|=wl,(Rr.mode&hi)!==At&&(m|=Uo),Gd(m,On,eS.bind(null,a,r),u)}function km(r,a,o){typeof a!="function"&&c("Expected useImperativeHandle() second argument to be a function that creates a handle. Instead received: %s.",a!==null?typeof a:"null");var u=o!=null?o.concat([r]):null;return Om(Nr,On,eS.bind(null,a,r),u)}function d2(r,a){}var Rm=d2;function Vg(r,a){var o=bi(),u=a===void 0?null:a;return o.memoizedState=[r,u],r}function Tm(r,a){var o=Ns(),u=a===void 0?null:a,m=o.memoizedState;if(m!==null&&u!==null){var v=m[1];if(Og(u,v))return m[0]}return o.memoizedState=[r,u],r}function jg(r,a){var o=bi(),u=a===void 0?null:a,m=r();return o.memoizedState=[m,u],m}function _m(r,a){var o=Ns(),u=a===void 0?null:a,m=o.memoizedState;if(m!==null&&u!==null){var v=m[1];if(Og(u,v))return m[0]}var N=r();return o.memoizedState=[N,u],N}function Ig(r){var a=bi();return a.memoizedState=r,r}function tS(r){var a=Ns(),o=En,u=o.memoizedState;return nS(a,u,r)}function rS(r){var a=Ns();if(En===null)return a.memoizedState=r,r;var o=En.memoizedState;return nS(a,o,r)}function nS(r,a,o){var u=!Kk(Hl);if(u){if(!as(o,a)){var m=ZN();Rr.lanes=Qt(Rr.lanes,m),mf(m),r.baseState=!0}return a}else return r.baseState&&(r.baseState=!1,ef()),r.memoizedState=o,o}function f2(r,a,o){var u=Fs();$n(sR(u,qi)),r(!0);var m=Hd.transition;Hd.transition={};var v=Hd.transition;Hd.transition._updatedFibers=new Set;try{r(!1),a()}finally{if($n(u),Hd.transition=m,m===null&&v._updatedFibers){var N=v._updatedFibers.size;N>10&&d("Detected a large number of updates inside startTransition. If this is due to a subscription please re-write it to use React provided hooks. Otherwise concurrent mode guarantees are off the table."),v._updatedFibers.clear()}}}function Mg(){var r=Sm(!1),a=r[0],o=r[1],u=f2.bind(null,o),m=bi();return m.memoizedState=u,[a,u]}function aS(){var r=Tg(),a=r[0],o=Ns(),u=o.memoizedState;return[a,u]}function sS(){var r=_g(),a=r[0],o=Ns(),u=o.memoizedState;return[a,u]}var iS=!1;function m2(){return iS}function Fg(){var r=bi(),a=Qm(),o=a.identifierPrefix,u;if(Zn()){var m=T_();u=":"+o+"R"+m;var v=zd++;v>0&&(u+="H"+v.toString(32)),u+=":"}else{var N=l2++;u=":"+o+"r"+N.toString(32)+":"}return r.memoizedState=u,u}function Pm(){var r=Ns(),a=r.memoizedState;return a}function h2(r,a,o){typeof arguments[3]=="function"&&c("State updates from the useState() and useReducer() Hooks don't support the second callback argument. To execute a side effect after rendering, declare it in the component body with useEffect().");var u=Zo(r),m={lane:u,action:o,hasEagerState:!1,eagerState:null,next:null};if(oS(r))lS(a,m);else{var v=VD(r,a,m,u);if(v!==null){var N=_a();Tn(v,r,u,N),cS(v,a,u)}}uS(r,u)}function p2(r,a,o){typeof arguments[3]=="function"&&c("State updates from the useState() and useReducer() Hooks don't support the second callback argument. To execute a side effect after rendering, declare it in the component body with useEffect().");var u=Zo(r),m={lane:u,action:o,hasEagerState:!1,eagerState:null,next:null};if(oS(r))lS(a,m);else{var v=r.alternate;if(r.lanes===Je&&(v===null||v.lanes===Je)){var N=a.lastRenderedReducer;if(N!==null){var k;k=gt.current,gt.current=zs;try{var M=a.lastRenderedState,te=N(M,o);if(m.hasEagerState=!0,m.eagerState=te,as(te,M)){Z_(r,a,m,u);return}}catch{}finally{gt.current=k}}}var le=VD(r,a,m,u);if(le!==null){var De=_a();Tn(le,r,u,De),cS(le,a,u)}}uS(r,u)}function oS(r){var a=r.alternate;return r===Rr||a!==null&&a===Rr}function lS(r,a){Wd=Nm=!0;var o=r.pending;o===null?a.next=a:(a.next=o.next,o.next=a),r.pending=a}function cS(r,a,o){if(QN(o)){var u=a.lanes;u=e1(u,r.pendingLanes);var m=Qt(u,o);a.lanes=m,sv(r,m)}}function uS(r,a,o){Ap(r,a)}var Um={readContext:fn,useCallback:pa,useContext:pa,useEffect:pa,useImperativeHandle:pa,useInsertionEffect:pa,useLayoutEffect:pa,useMemo:pa,useReducer:pa,useRef:pa,useState:pa,useDebugValue:pa,useDeferredValue:pa,useTransition:pa,useMutableSource:pa,useSyncExternalStore:pa,useId:pa,unstable_isNewReconciler:Ge},dS=null,fS=null,mS=null,hS=null,Ni=null,zs=null,Am=null;{var $g=function(){c("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo().")},Ht=function(){c("Do not call Hooks inside useEffect(...), useMemo(...), or other built-in Hooks. You can only call Hooks at the top level of your React function. For more information, see https://reactjs.org/link/rules-of-hooks")};dS={readContext:function(r){return fn(r)},useCallback:function(r,a){return Ye="useCallback",Or(),ru(a),Vg(r,a)},useContext:function(r){return Ye="useContext",Or(),fn(r)},useEffect:function(r,a){return Ye="useEffect",Or(),ru(a),Em(r,a)},useImperativeHandle:function(r,a,o){return Ye="useImperativeHandle",Or(),ru(o),Lg(r,a,o)},useInsertionEffect:function(r,a){return Ye="useInsertionEffect",Or(),ru(a),Ug(r,a)},useLayoutEffect:function(r,a){return Ye="useLayoutEffect",Or(),ru(a),Ag(r,a)},useMemo:function(r,a){Ye="useMemo",Or(),ru(a);var o=gt.current;gt.current=Ni;try{return jg(r,a)}finally{gt.current=o}},useReducer:function(r,a,o){Ye="useReducer",Or();var u=gt.current;gt.current=Ni;try{return wg(r,a,o)}finally{gt.current=u}},useRef:function(r){return Ye="useRef",Or(),Pg(r)},useState:function(r){Ye="useState",Or();var a=gt.current;gt.current=Ni;try{return Sm(r)}finally{gt.current=a}},useDebugValue:function(r,a){return Ye="useDebugValue",Or(),void 0},useDeferredValue:function(r){return Ye="useDeferredValue",Or(),Ig(r)},useTransition:function(){return Ye="useTransition",Or(),Mg()},useMutableSource:function(r,a,o){return Ye="useMutableSource",Or(),void 0},useSyncExternalStore:function(r,a,o){return Ye="useSyncExternalStore",Or(),Rg(r,a,o)},useId:function(){return Ye="useId",Or(),Fg()},unstable_isNewReconciler:Ge},fS={readContext:function(r){return fn(r)},useCallback:function(r,a){return Ye="useCallback",ut(),Vg(r,a)},useContext:function(r){return Ye="useContext",ut(),fn(r)},useEffect:function(r,a){return Ye="useEffect",ut(),Em(r,a)},useImperativeHandle:function(r,a,o){return Ye="useImperativeHandle",ut(),Lg(r,a,o)},useInsertionEffect:function(r,a){return Ye="useInsertionEffect",ut(),Ug(r,a)},useLayoutEffect:function(r,a){return Ye="useLayoutEffect",ut(),Ag(r,a)},useMemo:function(r,a){Ye="useMemo",ut();var o=gt.current;gt.current=Ni;try{return jg(r,a)}finally{gt.current=o}},useReducer:function(r,a,o){Ye="useReducer",ut();var u=gt.current;gt.current=Ni;try{return wg(r,a,o)}finally{gt.current=u}},useRef:function(r){return Ye="useRef",ut(),Pg(r)},useState:function(r){Ye="useState",ut();var a=gt.current;gt.current=Ni;try{return Sm(r)}finally{gt.current=a}},useDebugValue:function(r,a){return Ye="useDebugValue",ut(),void 0},useDeferredValue:function(r){return Ye="useDeferredValue",ut(),Ig(r)},useTransition:function(){return Ye="useTransition",ut(),Mg()},useMutableSource:function(r,a,o){return Ye="useMutableSource",ut(),void 0},useSyncExternalStore:function(r,a,o){return Ye="useSyncExternalStore",ut(),Rg(r,a,o)},useId:function(){return Ye="useId",ut(),Fg()},unstable_isNewReconciler:Ge},mS={readContext:function(r){return fn(r)},useCallback:function(r,a){return Ye="useCallback",ut(),Tm(r,a)},useContext:function(r){return Ye="useContext",ut(),fn(r)},useEffect:function(r,a){return Ye="useEffect",ut(),Yd(r,a)},useImperativeHandle:function(r,a,o){return Ye="useImperativeHandle",ut(),km(r,a,o)},useInsertionEffect:function(r,a){return Ye="useInsertionEffect",ut(),wm(r,a)},useLayoutEffect:function(r,a){return Ye="useLayoutEffect",ut(),Cm(r,a)},useMemo:function(r,a){Ye="useMemo",ut();var o=gt.current;gt.current=zs;try{return _m(r,a)}finally{gt.current=o}},useReducer:function(r,a,o){Ye="useReducer",ut();var u=gt.current;gt.current=zs;try{return Cg(r,a,o)}finally{gt.current=u}},useRef:function(r){return Ye="useRef",ut(),ym()},useState:function(r){Ye="useState",ut();var a=gt.current;gt.current=zs;try{return Tg(r)}finally{gt.current=a}},useDebugValue:function(r,a){return Ye="useDebugValue",ut(),Rm()},useDeferredValue:function(r){return Ye="useDeferredValue",ut(),tS(r)},useTransition:function(){return Ye="useTransition",ut(),aS()},useMutableSource:function(r,a,o){return Ye="useMutableSource",ut(),void 0},useSyncExternalStore:function(r,a,o){return Ye="useSyncExternalStore",ut(),Dm(r,a)},useId:function(){return Ye="useId",ut(),Pm()},unstable_isNewReconciler:Ge},hS={readContext:function(r){return fn(r)},useCallback:function(r,a){return Ye="useCallback",ut(),Tm(r,a)},useContext:function(r){return Ye="useContext",ut(),fn(r)},useEffect:function(r,a){return Ye="useEffect",ut(),Yd(r,a)},useImperativeHandle:function(r,a,o){return Ye="useImperativeHandle",ut(),km(r,a,o)},useInsertionEffect:function(r,a){return Ye="useInsertionEffect",ut(),wm(r,a)},useLayoutEffect:function(r,a){return Ye="useLayoutEffect",ut(),Cm(r,a)},useMemo:function(r,a){Ye="useMemo",ut();var o=gt.current;gt.current=Am;try{return _m(r,a)}finally{gt.current=o}},useReducer:function(r,a,o){Ye="useReducer",ut();var u=gt.current;gt.current=Am;try{return kg(r,a,o)}finally{gt.current=u}},useRef:function(r){return Ye="useRef",ut(),ym()},useState:function(r){Ye="useState",ut();var a=gt.current;gt.current=Am;try{return _g(r)}finally{gt.current=a}},useDebugValue:function(r,a){return Ye="useDebugValue",ut(),Rm()},useDeferredValue:function(r){return Ye="useDeferredValue",ut(),rS(r)},useTransition:function(){return Ye="useTransition",ut(),sS()},useMutableSource:function(r,a,o){return Ye="useMutableSource",ut(),void 0},useSyncExternalStore:function(r,a,o){return Ye="useSyncExternalStore",ut(),Dm(r,a)},useId:function(){return Ye="useId",ut(),Pm()},unstable_isNewReconciler:Ge},Ni={readContext:function(r){return $g(),fn(r)},useCallback:function(r,a){return Ye="useCallback",Ht(),Or(),Vg(r,a)},useContext:function(r){return Ye="useContext",Ht(),Or(),fn(r)},useEffect:function(r,a){return Ye="useEffect",Ht(),Or(),Em(r,a)},useImperativeHandle:function(r,a,o){return Ye="useImperativeHandle",Ht(),Or(),Lg(r,a,o)},useInsertionEffect:function(r,a){return Ye="useInsertionEffect",Ht(),Or(),Ug(r,a)},useLayoutEffect:function(r,a){return Ye="useLayoutEffect",Ht(),Or(),Ag(r,a)},useMemo:function(r,a){Ye="useMemo",Ht(),Or();var o=gt.current;gt.current=Ni;try{return jg(r,a)}finally{gt.current=o}},useReducer:function(r,a,o){Ye="useReducer",Ht(),Or();var u=gt.current;gt.current=Ni;try{return wg(r,a,o)}finally{gt.current=u}},useRef:function(r){return Ye="useRef",Ht(),Or(),Pg(r)},useState:function(r){Ye="useState",Ht(),Or();var a=gt.current;gt.current=Ni;try{return Sm(r)}finally{gt.current=a}},useDebugValue:function(r,a){return Ye="useDebugValue",Ht(),Or(),void 0},useDeferredValue:function(r){return Ye="useDeferredValue",Ht(),Or(),Ig(r)},useTransition:function(){return Ye="useTransition",Ht(),Or(),Mg()},useMutableSource:function(r,a,o){return Ye="useMutableSource",Ht(),Or(),void 0},useSyncExternalStore:function(r,a,o){return Ye="useSyncExternalStore",Ht(),Or(),Rg(r,a,o)},useId:function(){return Ye="useId",Ht(),Or(),Fg()},unstable_isNewReconciler:Ge},zs={readContext:function(r){return $g(),fn(r)},useCallback:function(r,a){return Ye="useCallback",Ht(),ut(),Tm(r,a)},useContext:function(r){return Ye="useContext",Ht(),ut(),fn(r)},useEffect:function(r,a){return Ye="useEffect",Ht(),ut(),Yd(r,a)},useImperativeHandle:function(r,a,o){return Ye="useImperativeHandle",Ht(),ut(),km(r,a,o)},useInsertionEffect:function(r,a){return Ye="useInsertionEffect",Ht(),ut(),wm(r,a)},useLayoutEffect:function(r,a){return Ye="useLayoutEffect",Ht(),ut(),Cm(r,a)},useMemo:function(r,a){Ye="useMemo",Ht(),ut();var o=gt.current;gt.current=zs;try{return _m(r,a)}finally{gt.current=o}},useReducer:function(r,a,o){Ye="useReducer",Ht(),ut();var u=gt.current;gt.current=zs;try{return Cg(r,a,o)}finally{gt.current=u}},useRef:function(r){return Ye="useRef",Ht(),ut(),ym()},useState:function(r){Ye="useState",Ht(),ut();var a=gt.current;gt.current=zs;try{return Tg(r)}finally{gt.current=a}},useDebugValue:function(r,a){return Ye="useDebugValue",Ht(),ut(),Rm()},useDeferredValue:function(r){return Ye="useDeferredValue",Ht(),ut(),tS(r)},useTransition:function(){return Ye="useTransition",Ht(),ut(),aS()},useMutableSource:function(r,a,o){return Ye="useMutableSource",Ht(),ut(),void 0},useSyncExternalStore:function(r,a,o){return Ye="useSyncExternalStore",Ht(),ut(),Dm(r,a)},useId:function(){return Ye="useId",Ht(),ut(),Pm()},unstable_isNewReconciler:Ge},Am={readContext:function(r){return $g(),fn(r)},useCallback:function(r,a){return Ye="useCallback",Ht(),ut(),Tm(r,a)},useContext:function(r){return Ye="useContext",Ht(),ut(),fn(r)},useEffect:function(r,a){return Ye="useEffect",Ht(),ut(),Yd(r,a)},useImperativeHandle:function(r,a,o){return Ye="useImperativeHandle",Ht(),ut(),km(r,a,o)},useInsertionEffect:function(r,a){return Ye="useInsertionEffect",Ht(),ut(),wm(r,a)},useLayoutEffect:function(r,a){return Ye="useLayoutEffect",Ht(),ut(),Cm(r,a)},useMemo:function(r,a){Ye="useMemo",Ht(),ut();var o=gt.current;gt.current=zs;try{return _m(r,a)}finally{gt.current=o}},useReducer:function(r,a,o){Ye="useReducer",Ht(),ut();var u=gt.current;gt.current=zs;try{return kg(r,a,o)}finally{gt.current=u}},useRef:function(r){return Ye="useRef",Ht(),ut(),ym()},useState:function(r){Ye="useState",Ht(),ut();var a=gt.current;gt.current=zs;try{return _g(r)}finally{gt.current=a}},useDebugValue:function(r,a){return Ye="useDebugValue",Ht(),ut(),Rm()},useDeferredValue:function(r){return Ye="useDeferredValue",Ht(),ut(),rS(r)},useTransition:function(){return Ye="useTransition",Ht(),ut(),sS()},useMutableSource:function(r,a,o){return Ye="useMutableSource",Ht(),ut(),void 0},useSyncExternalStore:function(r,a,o){return Ye="useSyncExternalStore",Ht(),ut(),Dm(r,a)},useId:function(){return Ye="useId",Ht(),ut(),Pm()},unstable_isNewReconciler:Ge}}var qo=n.unstable_now,pS=0,Lm=-1,qd=-1,Vm=-1,Bg=!1,jm=!1;function vS(){return Bg}function v2(){jm=!0}function g2(){Bg=!1,jm=!1}function x2(){Bg=jm,jm=!1}function gS(){return pS}function xS(){pS=qo()}function Hg(r){qd=qo(),r.actualStartTime<0&&(r.actualStartTime=qo())}function bS(r){qd=-1}function Im(r,a){if(qd>=0){var o=qo()-qd;r.actualDuration+=o,a&&(r.selfBaseDuration=o),qd=-1}}function Di(r){if(Lm>=0){var a=qo()-Lm;Lm=-1;for(var o=r.return;o!==null;){switch(o.tag){case b:var u=o.stateNode;u.effectDuration+=a;return;case ne:var m=o.stateNode;m.effectDuration+=a;return}o=o.return}}}function Wg(r){if(Vm>=0){var a=qo()-Vm;Vm=-1;for(var o=r.return;o!==null;){switch(o.tag){case b:var u=o.stateNode;u!==null&&(u.passiveEffectDuration+=a);return;case ne:var m=o.stateNode;m!==null&&(m.passiveEffectDuration+=a);return}o=o.return}}}function Si(){Lm=qo()}function zg(){Vm=qo()}function Xg(r){for(var a=r.child;a;)r.actualDuration+=a.actualDuration,a=a.sibling}function Xs(r,a){if(r&&r.defaultProps){var o=ot({},a),u=r.defaultProps;for(var m in u)o[m]===void 0&&(o[m]=u[m]);return o}return a}var Gg={},Yg,qg,Kg,Jg,Qg,NS,Mm,Zg,ex,tx,Kd;{Yg=new Set,qg=new Set,Kg=new Set,Jg=new Set,Zg=new Set,Qg=new Set,ex=new Set,tx=new Set,Kd=new Set;var DS=new Set;Mm=function(r,a){if(!(r===null||typeof r=="function")){var o=a+"_"+r;DS.has(o)||(DS.add(o),c("%s(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",a,r))}},NS=function(r,a){if(a===void 0){var o=mr(r)||"Component";Qg.has(o)||(Qg.add(o),c("%s.getDerivedStateFromProps(): A valid state object (or null) must be returned. You have returned undefined.",o))}},Object.defineProperty(Gg,"_processChildContext",{enumerable:!1,value:function(){throw new Error("_processChildContext is not available in React 16+. This likely means you have multiple copies of React and are attempting to nest a React 15 tree inside a React 16 tree using unstable_renderSubtreeIntoContainer, which isn't supported. Try to make sure you have only one copy of React (and ideally, switch to ReactDOM.createPortal).")}}),Object.freeze(Gg)}function rx(r,a,o,u){var m=r.memoizedState,v=o(u,m);{if(r.mode&Qr){Mn(!0);try{v=o(u,m)}finally{Mn(!1)}}NS(a,v)}var N=v==null?m:ot({},m,v);if(r.memoizedState=N,r.lanes===Je){var k=r.updateQueue;k.baseState=N}}var nx={isMounted:ck,enqueueSetState:function(r,a,o){var u=Ec(r),m=_a(),v=Zo(u),N=ro(m,v);N.payload=a,o!=null&&(Mm(o,"setState"),N.callback=o);var k=zo(u,N,v);k!==null&&(Tn(k,u,v,m),hm(k,u,v)),Ap(u,v)},enqueueReplaceState:function(r,a,o){var u=Ec(r),m=_a(),v=Zo(u),N=ro(m,v);N.tag=ID,N.payload=a,o!=null&&(Mm(o,"replaceState"),N.callback=o);var k=zo(u,N,v);k!==null&&(Tn(k,u,v,m),hm(k,u,v)),Ap(u,v)},enqueueForceUpdate:function(r,a){var o=Ec(r),u=_a(),m=Zo(o),v=ro(u,m);v.tag=dm,a!=null&&(Mm(a,"forceUpdate"),v.callback=a);var N=zo(o,v,m);N!==null&&(Tn(N,o,m,u),hm(N,o,m)),Fk(o,m)}};function SS(r,a,o,u,m,v,N){var k=r.stateNode;if(typeof k.shouldComponentUpdate=="function"){var M=k.shouldComponentUpdate(u,v,N);{if(r.mode&Qr){Mn(!0);try{M=k.shouldComponentUpdate(u,v,N)}finally{Mn(!1)}}M===void 0&&c("%s.shouldComponentUpdate(): Returned undefined instead of a boolean value. Make sure to return true or false.",mr(a)||"Component")}return M}return a.prototype&&a.prototype.isPureReactComponent?!xd(o,u)||!xd(m,v):!0}function b2(r,a,o){var u=r.stateNode;{var m=mr(a)||"Component",v=u.render;v||(a.prototype&&typeof a.prototype.render=="function"?c("%s(...): No `render` method found on the returned component instance: did you accidentally return an object from the constructor?",m):c("%s(...): No `render` method found on the returned component instance: you may have forgotten to define `render`.",m)),u.getInitialState&&!u.getInitialState.isReactClassApproved&&!u.state&&c("getInitialState was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Did you mean to define a state property instead?",m),u.getDefaultProps&&!u.getDefaultProps.isReactClassApproved&&c("getDefaultProps was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Use a static property to define defaultProps instead.",m),u.propTypes&&c("propTypes was defined as an instance property on %s. Use a static property to define propTypes instead.",m),u.contextType&&c("contextType was defined as an instance property on %s. Use a static property to define contextType instead.",m),a.childContextTypes&&!Kd.has(a)&&(r.mode&Qr)===At&&(Kd.add(a),c(`%s uses the legacy childContextTypes API which is no longer supported and will be removed in the next major release. Use React.createContext() instead

.Learn more about this warning here: https://reactjs.org/link/legacy-context`,m)),a.contextTypes&&!Kd.has(a)&&(r.mode&Qr)===At&&(Kd.add(a),c(`%s uses the legacy contextTypes API which is no longer supported and will be removed in the next major release. Use React.createContext() with static contextType instead.

Learn more about this warning here: https://reactjs.org/link/legacy-context`,m)),u.contextTypes&&c("contextTypes was defined as an instance property on %s. Use a static property to define contextTypes instead.",m),a.contextType&&a.contextTypes&&!ex.has(a)&&(ex.add(a),c("%s declares both contextTypes and contextType static properties. The legacy contextTypes property will be ignored.",m)),typeof u.componentShouldUpdate=="function"&&c("%s has a method called componentShouldUpdate(). Did you mean shouldComponentUpdate()? The name is phrased as a question because the function is expected to return a value.",m),a.prototype&&a.prototype.isPureReactComponent&&typeof u.shouldComponentUpdate<"u"&&c("%s has a method called shouldComponentUpdate(). shouldComponentUpdate should not be used when extending React.PureComponent. Please extend React.Component if shouldComponentUpdate is used.",mr(a)||"A pure component"),typeof u.componentDidUnmount=="function"&&c("%s has a method called componentDidUnmount(). But there is no such lifecycle method. Did you mean componentWillUnmount()?",m),typeof u.componentDidReceiveProps=="function"&&c("%s has a method called componentDidReceiveProps(). But there is no such lifecycle method. If you meant to update the state in response to changing props, use componentWillReceiveProps(). If you meant to fetch data or run side-effects or mutations after React has updated the UI, use componentDidUpdate().",m),typeof u.componentWillRecieveProps=="function"&&c("%s has a method called componentWillRecieveProps(). Did you mean componentWillReceiveProps()?",m),typeof u.UNSAFE_componentWillRecieveProps=="function"&&c("%s has a method called UNSAFE_componentWillRecieveProps(). Did you mean UNSAFE_componentWillReceiveProps()?",m);var N=u.props!==o;u.props!==void 0&&N&&c("%s(...): When calling super() in `%s`, make sure to pass up the same props that your component's constructor was passed.",m,m),u.defaultProps&&c("Setting defaultProps as an instance property on %s is not supported and will be ignored. Instead, define defaultProps as a static property on %s.",m,m),typeof u.getSnapshotBeforeUpdate=="function"&&typeof u.componentDidUpdate!="function"&&!Kg.has(a)&&(Kg.add(a),c("%s: getSnapshotBeforeUpdate() should be used with componentDidUpdate(). This component defines getSnapshotBeforeUpdate() only.",mr(a))),typeof u.getDerivedStateFromProps=="function"&&c("%s: getDerivedStateFromProps() is defined as an instance method and will be ignored. Instead, declare it as a static method.",m),typeof u.getDerivedStateFromError=="function"&&c("%s: getDerivedStateFromError() is defined as an instance method and will be ignored. Instead, declare it as a static method.",m),typeof a.getSnapshotBeforeUpdate=="function"&&c("%s: getSnapshotBeforeUpdate() is defined as a static method and will be ignored. Instead, declare it as an instance method.",m);var k=u.state;k&&(typeof k!="object"||Kt(k))&&c("%s.state: must be set to an object or null",m),typeof u.getChildContext=="function"&&typeof a.childContextTypes!="object"&&c("%s.getChildContext(): childContextTypes must be defined in order to use getChildContext().",m)}}function yS(r,a){a.updater=nx,r.stateNode=a,sk(a,r),a._reactInternalInstance=Gg}function OS(r,a,o){var u=!1,m=ss,v=ss,N=a.contextType;if("contextType"in a){var k=N===null||N!==void 0&&N.$$typeof===Z&&N._context===void 0;if(!k&&!tx.has(a)){tx.add(a);var M="";N===void 0?M=" However, it is set to undefined. This can be caused by a typo or by mixing up named and default imports. This can also happen due to a circular dependency, so try moving the createContext() call to a separate file.":typeof N!="object"?M=" However, it is set to a "+typeof N+".":N.$$typeof===L?M=" Did you accidentally pass the Context.Provider instead?":N._context!==void 0?M=" Did you accidentally pass the Context.Consumer instead?":M=" However, it is set to an object with keys {"+Object.keys(N).join(", ")+"}.",c("%s defines an invalid contextType. contextType should point to the Context object returned by React.createContext().%s",mr(a)||"Component",M)}}if(typeof N=="object"&&N!==null)v=fn(N);else{m=Wc(r,a,!0);var te=a.contextTypes;u=te!=null,v=u?zc(r,m):ss}var le=new a(o,v);if(r.mode&Qr){Mn(!0);try{le=new a(o,v)}finally{Mn(!1)}}var De=r.memoizedState=le.state!==null&&le.state!==void 0?le.state:null;yS(r,le);{if(typeof a.getDerivedStateFromProps=="function"&&De===null){var Ne=mr(a)||"Component";qg.has(Ne)||(qg.add(Ne),c("`%s` uses `getDerivedStateFromProps` but its initial state is %s. This is not recommended. Instead, define the initial state by assigning an object to `this.state` in the constructor of `%s`. This ensures that `getDerivedStateFromProps` arguments have a consistent shape.",Ne,le.state===null?"null":"undefined",Ne))}if(typeof a.getDerivedStateFromProps=="function"||typeof le.getSnapshotBeforeUpdate=="function"){var Ae=null,Ie=null,He=null;if(typeof le.componentWillMount=="function"&&le.componentWillMount.__suppressDeprecationWarning!==!0?Ae="componentWillMount":typeof le.UNSAFE_componentWillMount=="function"&&(Ae="UNSAFE_componentWillMount"),typeof le.componentWillReceiveProps=="function"&&le.componentWillReceiveProps.__suppressDeprecationWarning!==!0?Ie="componentWillReceiveProps":typeof le.UNSAFE_componentWillReceiveProps=="function"&&(Ie="UNSAFE_componentWillReceiveProps"),typeof le.componentWillUpdate=="function"&&le.componentWillUpdate.__suppressDeprecationWarning!==!0?He="componentWillUpdate":typeof le.UNSAFE_componentWillUpdate=="function"&&(He="UNSAFE_componentWillUpdate"),Ae!==null||Ie!==null||He!==null){var dt=mr(a)||"Component",Ut=typeof a.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";Jg.has(dt)||(Jg.add(dt),c(`Unsafe legacy lifecycles will not be called for components using new component APIs.

%s uses %s but also contains the following legacy lifecycles:%s%s%s

The above lifecycles should be removed. Learn more about this warning here:
https://reactjs.org/link/unsafe-component-lifecycles`,dt,Ut,Ae!==null?`
  `+Ae:"",Ie!==null?`
  `+Ie:"",He!==null?`
  `+He:""))}}}return u&&mD(r,m,v),le}function N2(r,a){var o=a.state;typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),o!==a.state&&(c("%s.componentWillMount(): Assigning directly to this.state is deprecated (except inside a component's constructor). Use setState instead.",jt(r)||"Component"),nx.enqueueReplaceState(a,a.state,null))}function ES(r,a,o,u){var m=a.state;if(typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,u),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,u),a.state!==m){{var v=jt(r)||"Component";Yg.has(v)||(Yg.add(v),c("%s.componentWillReceiveProps(): Assigning directly to this.state is deprecated (except inside a component's constructor). Use setState instead.",v))}nx.enqueueReplaceState(a,a.state,null)}}function ax(r,a,o,u){b2(r,a,o);var m=r.stateNode;m.props=o,m.state=r.memoizedState,m.refs={},mg(r);var v=a.contextType;if(typeof v=="object"&&v!==null)m.context=fn(v);else{var N=Wc(r,a,!0);m.context=zc(r,N)}{if(m.state===o){var k=mr(a)||"Component";Zg.has(k)||(Zg.add(k),c("%s: It is not recommended to assign props directly to state because updates to props won't be reflected in state. In most cases, it is better to use props directly.",k))}r.mode&Qr&&Hs.recordLegacyContextWarning(r,m),Hs.recordUnsafeLifecycleWarnings(r,m)}m.state=r.memoizedState;var M=a.getDerivedStateFromProps;if(typeof M=="function"&&(rx(r,a,M,o),m.state=r.memoizedState),typeof a.getDerivedStateFromProps!="function"&&typeof m.getSnapshotBeforeUpdate!="function"&&(typeof m.UNSAFE_componentWillMount=="function"||typeof m.componentWillMount=="function")&&(N2(r,m),pm(r,o,m,u),m.state=r.memoizedState),typeof m.componentDidMount=="function"){var te=Nr;te|=wl,(r.mode&hi)!==At&&(te|=Uo),r.flags|=te}}function D2(r,a,o,u){var m=r.stateNode,v=r.memoizedProps;m.props=v;var N=m.context,k=a.contextType,M=ss;if(typeof k=="object"&&k!==null)M=fn(k);else{var te=Wc(r,a,!0);M=zc(r,te)}var le=a.getDerivedStateFromProps,De=typeof le=="function"||typeof m.getSnapshotBeforeUpdate=="function";!De&&(typeof m.UNSAFE_componentWillReceiveProps=="function"||typeof m.componentWillReceiveProps=="function")&&(v!==o||N!==M)&&ES(r,m,o,M),FD();var Ne=r.memoizedState,Ae=m.state=Ne;if(pm(r,o,m,u),Ae=r.memoizedState,v===o&&Ne===Ae&&!K0()&&!vm()){if(typeof m.componentDidMount=="function"){var Ie=Nr;Ie|=wl,(r.mode&hi)!==At&&(Ie|=Uo),r.flags|=Ie}return!1}typeof le=="function"&&(rx(r,a,le,o),Ae=r.memoizedState);var He=vm()||SS(r,a,v,o,Ne,Ae,M);if(He){if(!De&&(typeof m.UNSAFE_componentWillMount=="function"||typeof m.componentWillMount=="function")&&(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"){var dt=Nr;dt|=wl,(r.mode&hi)!==At&&(dt|=Uo),r.flags|=dt}}else{if(typeof m.componentDidMount=="function"){var Ut=Nr;Ut|=wl,(r.mode&hi)!==At&&(Ut|=Uo),r.flags|=Ut}r.memoizedProps=o,r.memoizedState=Ae}return m.props=o,m.state=Ae,m.context=M,He}function S2(r,a,o,u,m){var v=a.stateNode;MD(r,a);var N=a.memoizedProps,k=a.type===a.elementType?N:Xs(a.type,N);v.props=k;var M=a.pendingProps,te=v.context,le=o.contextType,De=ss;if(typeof le=="object"&&le!==null)De=fn(le);else{var Ne=Wc(a,o,!0);De=zc(a,Ne)}var Ae=o.getDerivedStateFromProps,Ie=typeof Ae=="function"||typeof v.getSnapshotBeforeUpdate=="function";!Ie&&(typeof v.UNSAFE_componentWillReceiveProps=="function"||typeof v.componentWillReceiveProps=="function")&&(N!==M||te!==De)&&ES(a,v,u,De),FD();var He=a.memoizedState,dt=v.state=He;if(pm(a,u,v,m),dt=a.memoizedState,N===M&&He===dt&&!K0()&&!vm()&&!ie)return typeof v.componentDidUpdate=="function"&&(N!==r.memoizedProps||He!==r.memoizedState)&&(a.flags|=Nr),typeof v.getSnapshotBeforeUpdate=="function"&&(N!==r.memoizedProps||He!==r.memoizedState)&&(a.flags|=Cc),!1;typeof Ae=="function"&&(rx(a,o,Ae,u),dt=a.memoizedState);var Ut=vm()||SS(a,o,k,u,He,dt,De)||ie;return Ut?(!Ie&&(typeof v.UNSAFE_componentWillUpdate=="function"||typeof v.componentWillUpdate=="function")&&(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,dt,De),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,dt,De)),typeof v.componentDidUpdate=="function"&&(a.flags|=Nr),typeof v.getSnapshotBeforeUpdate=="function"&&(a.flags|=Cc)):(typeof v.componentDidUpdate=="function"&&(N!==r.memoizedProps||He!==r.memoizedState)&&(a.flags|=Nr),typeof v.getSnapshotBeforeUpdate=="function"&&(N!==r.memoizedProps||He!==r.memoizedState)&&(a.flags|=Cc),a.memoizedProps=u,a.memoizedState=dt),v.props=u,v.state=dt,v.context=De,Ut}function Wl(r,a){return{value:r,source:a,stack:li(a),digest:null}}function sx(r,a,o){return{value:r,source:null,stack:o??null,digest:a??null}}function y2(r,a){return!0}function ix(r,a){try{var o=y2(r,a);if(o===!1)return;var u=a.value,m=a.source,v=a.stack,N=v!==null?v:"";if(u!=null&&u._suppressLogging){if(r.tag===g)return;console.error(u)}var k=m?jt(m):null,M=k?"The above error occurred in the <"+k+"> component:":"The above error occurred in one of your React components:",te;if(r.tag===b)te=`Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.`;else{var le=jt(r)||"Anonymous";te="React will try to recreate this component tree from scratch "+("using the error boundary you provided, "+le+".")}var De=M+`
`+N+`

`+(""+te);console.error(De)}catch(Ne){setTimeout(function(){throw Ne})}}var O2=typeof WeakMap=="function"?WeakMap:Map;function wS(r,a,o){var u=ro(Ir,o);u.tag=dg,u.payload={element:null};var m=a.value;return u.callback=function(){vP(m),ix(r,a)},u}function ox(r,a,o){var u=ro(Ir,o);u.tag=dg;var m=r.type.getDerivedStateFromError;if(typeof m=="function"){var v=a.value;u.payload=function(){return m(v)},u.callback=function(){jy(r),ix(r,a)}}var N=r.stateNode;return N!==null&&typeof N.componentDidCatch=="function"&&(u.callback=function(){jy(r),ix(r,a),typeof m!="function"&&hP(this);var M=a.value,te=a.stack;this.componentDidCatch(M,{componentStack:te!==null?te:""}),typeof m!="function"&&(ts(r.lanes,Bt)||c("%s: Error boundaries should implement getDerivedStateFromError(). In that method, return a state update to display an error message or fallback UI.",jt(r)||"Unknown"))}),u}function CS(r,a,o){var u=r.pingCache,m;if(u===null?(u=r.pingCache=new O2,m=new Set,u.set(a,m)):(m=u.get(a),m===void 0&&(m=new Set,u.set(a,m))),!m.has(o)){m.add(o);var v=gP.bind(null,r,a,o);Ms&&hf(r,o),a.then(v,v)}}function E2(r,a,o,u){var m=r.updateQueue;if(m===null){var v=new Set;v.add(o),r.updateQueue=v}else m.add(o)}function w2(r,a){var o=r.tag;if((r.mode&or)===At&&(o===p||o===_||o===z)){var u=r.alternate;u?(r.updateQueue=u.updateQueue,r.memoizedState=u.memoizedState,r.lanes=u.lanes):(r.updateQueue=null,r.memoizedState=null)}}function kS(r){var a=r;do{if(a.tag===ee&&i2(a))return a;a=a.return}while(a!==null);return null}function RS(r,a,o,u,m){if((r.mode&or)===At){if(r===a)r.flags|=ka;else{if(r.flags|=Dr,o.flags|=wp,o.flags&=-52805,o.tag===g){var v=o.alternate;if(v===null)o.tag=S;else{var N=ro(Ir,Bt);N.tag=dm,zo(o,N,Bt)}}o.lanes=Qt(o.lanes,Bt)}return r}return r.flags|=ka,r.lanes=m,r}function C2(r,a,o,u,m){if(o.flags|=h0,Ms&&hf(r,m),u!==null&&typeof u=="object"&&typeof u.then=="function"){var v=u;w2(o),Zn()&&o.mode&or&&ND();var N=kS(a);if(N!==null){N.flags&=~zi,RS(N,a,o,r,m),N.mode&or&&CS(r,v,m),E2(N,r,v);return}else{if(!qk(m)){CS(r,v,m),Fx();return}var k=new Error("A component suspended while responding to synchronous input. This will cause the UI to be replaced with a loading indicator. To fix, updates that suspend should be wrapped with startTransition.");u=k}}else if(Zn()&&o.mode&or){ND();var M=kS(a);if(M!==null){(M.flags&ka)===Vt&&(M.flags|=zi),RS(M,a,o,r,m),Zv(Wl(u,o));return}}u=Wl(u,o),iP(u);var te=a;do{switch(te.tag){case b:{var le=u;te.flags|=ka;var De=nd(m);te.lanes=Qt(te.lanes,De);var Ne=wS(te,le,De);hg(te,Ne);return}case g:var Ae=u,Ie=te.type,He=te.stateNode;if((te.flags&Dr)===Vt&&(typeof Ie.getDerivedStateFromError=="function"||He!==null&&typeof He.componentDidCatch=="function"&&!ky(He))){te.flags|=ka;var dt=nd(m);te.lanes=Qt(te.lanes,dt);var Ut=ox(te,Ae,dt);hg(te,Ut);return}break}te=te.return}while(te!==null)}function k2(){return null}var Jd=e.ReactCurrentOwner,Gs=!1,lx,Qd,cx,ux,dx,zl,fx,Fm,Zd;lx={},Qd={},cx={},ux={},dx={},zl=!1,fx={},Fm={},Zd={};function Ra(r,a,o,u){r===null?a.child=PD(a,null,o,u):a.child=qc(a,r.child,o,u)}function R2(r,a,o,u){a.child=qc(a,r.child,null,u),a.child=qc(a,null,o,u)}function TS(r,a,o,u,m){if(a.type!==a.elementType){var v=o.propTypes;v&&$s(v,u,"prop",mr(o))}var N=o.render,k=a.ref,M,te;Jc(a,m),Ju(a);{if(Jd.current=a,qn(!0),M=nu(r,a,N,u,k,m),te=au(),a.mode&Qr){Mn(!0);try{M=nu(r,a,N,u,k,m),te=au()}finally{Mn(!1)}}qn(!1)}return Tc(),r!==null&&!Gs?(XD(r,a,m),no(r,a,m)):(Zn()&&te&&Gv(a),a.flags|=wc,Ra(r,a,M,m),a.child)}function _S(r,a,o,u,m){if(r===null){var v=o.type;if(AP(v)&&o.compare===null&&o.defaultProps===void 0){var N=v;return N=fu(v),a.tag=z,a.type=N,px(a,v),PS(r,a,N,u,m)}{var k=v.propTypes;if(k&&$s(k,u,"prop",mr(v)),o.defaultProps!==void 0){var M=mr(v)||"Unknown";Zd[M]||(c("%s: Support for defaultProps will be removed from memo components in a future major release. Use JavaScript default parameters instead.",M),Zd[M]=!0)}}var te=Jx(o.type,null,u,a,a.mode,m);return te.ref=a.ref,te.return=a,a.child=te,te}{var le=o.type,De=le.propTypes;De&&$s(De,u,"prop",mr(le))}var Ne=r.child,Ae=Dx(r,m);if(!Ae){var Ie=Ne.memoizedProps,He=o.compare;if(He=He!==null?He:xd,He(Ie,u)&&r.ref===a.ref)return no(r,a,m)}a.flags|=wc;var dt=Kl(Ne,u);return dt.ref=a.ref,dt.return=a,a.child=dt,dt}function PS(r,a,o,u,m){if(a.type!==a.elementType){var v=a.elementType;if(v.$$typeof===xe){var N=v,k=N._payload,M=N._init;try{v=M(k)}catch{v=null}var te=v&&v.propTypes;te&&$s(te,u,"prop",mr(v))}}if(r!==null){var le=r.memoizedProps;if(xd(le,u)&&r.ref===a.ref&&a.type===r.type)if(Gs=!1,a.pendingProps=u=le,Dx(r,m))(r.flags&wp)!==Vt&&(Gs=!0);else return a.lanes=r.lanes,no(r,a,m)}return mx(r,a,o,u,m)}function US(r,a,o){var u=a.pendingProps,m=u.children,v=r!==null?r.memoizedState:null;if(u.mode==="hidden"||Ee)if((a.mode&or)===At){var N={baseLanes:Je,cachePool:null,transitions:null};a.memoizedState=N,Zm(a,o)}else if(ts(o,es)){var De={baseLanes:Je,cachePool:null,transitions:null};a.memoizedState=De;var Ne=v!==null?v.baseLanes:o;Zm(a,Ne)}else{var k=null,M;if(v!==null){var te=v.baseLanes;M=Qt(te,o)}else M=o;a.lanes=a.childLanes=es;var le={baseLanes:M,cachePool:k,transitions:null};return a.memoizedState=le,a.updateQueue=null,Zm(a,M),null}else{var Ae;v!==null?(Ae=Qt(v.baseLanes,o),a.memoizedState=null):Ae=o,Zm(a,Ae)}return Ra(r,a,m,o),a.child}function T2(r,a,o){var u=a.pendingProps;return Ra(r,a,u,o),a.child}function _2(r,a,o){var u=a.pendingProps.children;return Ra(r,a,u,o),a.child}function P2(r,a,o){{a.flags|=Nr;{var u=a.stateNode;u.effectDuration=0,u.passiveEffectDuration=0}}var m=a.pendingProps,v=m.children;return Ra(r,a,v,o),a.child}function AS(r,a){var o=a.ref;(r===null&&o!==null||r!==null&&r.ref!==o)&&(a.flags|=Ol,a.flags|=Cp)}function mx(r,a,o,u,m){if(a.type!==a.elementType){var v=o.propTypes;v&&$s(v,u,"prop",mr(o))}var N;{var k=Wc(a,o,!0);N=zc(a,k)}var M,te;Jc(a,m),Ju(a);{if(Jd.current=a,qn(!0),M=nu(r,a,o,u,N,m),te=au(),a.mode&Qr){Mn(!0);try{M=nu(r,a,o,u,N,m),te=au()}finally{Mn(!1)}}qn(!1)}return Tc(),r!==null&&!Gs?(XD(r,a,m),no(r,a,m)):(Zn()&&te&&Gv(a),a.flags|=wc,Ra(r,a,M,m),a.child)}function LS(r,a,o,u,m){{switch(qP(a)){case!1:{var v=a.stateNode,N=a.type,k=new N(a.memoizedProps,v.context),M=k.state;v.updater.enqueueSetState(v,M,null);break}case!0:{a.flags|=Dr,a.flags|=ka;var te=new Error("Simulated error coming from DevTools"),le=nd(m);a.lanes=Qt(a.lanes,le);var De=ox(a,Wl(te,a),le);hg(a,De);break}}if(a.type!==a.elementType){var Ne=o.propTypes;Ne&&$s(Ne,u,"prop",mr(o))}}var Ae;gi(o)?(Ae=!0,Q0(a)):Ae=!1,Jc(a,m);var Ie=a.stateNode,He;Ie===null?(Bm(r,a),OS(a,o,u),ax(a,o,u,m),He=!0):r===null?He=D2(a,o,u,m):He=S2(r,a,o,u,m);var dt=hx(r,a,o,He,Ae,m);{var Ut=a.stateNode;He&&Ut.props!==u&&(zl||c("It looks like %s is reassigning its own `this.props` while rendering. This is not supported and can lead to confusing bugs.",jt(a)||"a component"),zl=!0)}return dt}function hx(r,a,o,u,m,v){AS(r,a);var N=(a.flags&Dr)!==Vt;if(!u&&!N)return m&&vD(a,o,!1),no(r,a,v);var k=a.stateNode;Jd.current=a;var M;if(N&&typeof o.getDerivedStateFromError!="function")M=null,bS();else{Ju(a);{if(qn(!0),M=k.render(),a.mode&Qr){Mn(!0);try{k.render()}finally{Mn(!1)}}qn(!1)}Tc()}return a.flags|=wc,r!==null&&N?R2(r,a,M,v):Ra(r,a,M,v),a.memoizedState=k.state,m&&vD(a,o,!0),a.child}function VS(r){var a=r.stateNode;a.pendingContext?hD(r,a.pendingContext,a.pendingContext!==a.context):a.context&&hD(r,a.context,!1),pg(r,a.containerInfo)}function U2(r,a,o){if(VS(a),r===null)throw new Error("Should have a current fiber. This is a bug in React.");var u=a.pendingProps,m=a.memoizedState,v=m.element;MD(r,a),pm(a,u,null,o);var N=a.memoizedState;a.stateNode;var k=N.element;if(m.isDehydrated){var M={element:k,isDehydrated:!1,cache:N.cache,pendingSuspenseBoundaries:N.pendingSuspenseBoundaries,transitions:N.transitions},te=a.updateQueue;if(te.baseState=M,a.memoizedState=M,a.flags&zi){var le=Wl(new Error("There was an error while hydrating. Because the error happened outside of a Suspense boundary, the entire root will switch to client rendering."),a);return jS(r,a,k,o,le)}else if(k!==v){var De=Wl(new Error("This root received an early update, before anything was able hydrate. Switched the entire root to client rendering."),a);return jS(r,a,k,o,De)}else{V_(a);var Ne=PD(a,null,k,o);a.child=Ne;for(var Ae=Ne;Ae;)Ae.flags=Ae.flags&~dn|Xi,Ae=Ae.sibling}}else{if(Yc(),k===v)return no(r,a,o);Ra(r,a,k,o)}return a.child}function jS(r,a,o,u,m){return Yc(),Zv(m),a.flags|=zi,Ra(r,a,o,u),a.child}function A2(r,a,o){HD(a),r===null&&Qv(a);var u=a.type,m=a.pendingProps,v=r!==null?r.memoizedProps:null,N=m.children,k=Uv(u,m);return k?N=null:v!==null&&Uv(u,v)&&(a.flags|=qu),AS(r,a),Ra(r,a,N,o),a.child}function L2(r,a){return r===null&&Qv(a),null}function V2(r,a,o,u){Bm(r,a);var m=a.pendingProps,v=o,N=v._payload,k=v._init,M=k(N);a.type=M;var te=a.tag=LP(M),le=Xs(M,m),De;switch(te){case p:return px(a,M),a.type=M=fu(M),De=mx(null,a,M,le,u),De;case g:return a.type=M=zx(M),De=LS(null,a,M,le,u),De;case _:return a.type=M=Xx(M),De=TS(null,a,M,le,u),De;case Q:{if(a.type!==a.elementType){var Ne=M.propTypes;Ne&&$s(Ne,le,"prop",mr(M))}return De=_S(null,a,M,Xs(M.type,le),u),De}}var Ae="";throw M!==null&&typeof M=="object"&&M.$$typeof===xe&&(Ae=" Did you wrap a component in React.lazy() more than once?"),new Error("Element type is invalid. Received a promise that resolves to: "+M+". "+("Lazy element type must resolve to a class or function."+Ae))}function j2(r,a,o,u,m){Bm(r,a),a.tag=g;var v;return gi(o)?(v=!0,Q0(a)):v=!1,Jc(a,m),OS(a,o,u),ax(a,o,u,m),hx(null,a,o,!0,v,m)}function I2(r,a,o,u){Bm(r,a);var m=a.pendingProps,v;{var N=Wc(a,o,!1);v=zc(a,N)}Jc(a,u);var k,M;Ju(a);{if(o.prototype&&typeof o.prototype.render=="function"){var te=mr(o)||"Unknown";lx[te]||(c("The <%s /> component appears to have a render method, but doesn't extend React.Component. This is likely to cause errors. Change %s to extend React.Component instead.",te,te),lx[te]=!0)}a.mode&Qr&&Hs.recordLegacyContextWarning(a,null),qn(!0),Jd.current=a,k=nu(null,a,o,m,v,u),M=au(),qn(!1)}if(Tc(),a.flags|=wc,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0){var le=mr(o)||"Unknown";Qd[le]||(c("The <%s /> component appears to be a function component that returns a class instance. Change %s to a class that extends React.Component instead. If you can't use a class try assigning the prototype on the function as a workaround. `%s.prototype = React.Component.prototype`. Don't use an arrow function since it cannot be called with `new` by React.",le,le,le),Qd[le]=!0)}if(typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0){{var De=mr(o)||"Unknown";Qd[De]||(c("The <%s /> component appears to be a function component that returns a class instance. Change %s to a class that extends React.Component instead. If you can't use a class try assigning the prototype on the function as a workaround. `%s.prototype = React.Component.prototype`. Don't use an arrow function since it cannot be called with `new` by React.",De,De,De),Qd[De]=!0)}a.tag=g,a.memoizedState=null,a.updateQueue=null;var Ne=!1;return gi(o)?(Ne=!0,Q0(a)):Ne=!1,a.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,mg(a),yS(a,k),ax(a,o,m,u),hx(null,a,o,!0,Ne,u)}else{if(a.tag=p,a.mode&Qr){Mn(!0);try{k=nu(null,a,o,m,v,u),M=au()}finally{Mn(!1)}}return Zn()&&M&&Gv(a),Ra(null,a,k,u),px(a,o),a.child}}function px(r,a){{if(a&&a.childContextTypes&&c("%s(...): childContextTypes cannot be defined on a function component.",a.displayName||a.name||"Component"),r.ref!==null){var o="",u=ci();u&&(o+=`

Check the render method of \``+u+"`.");var m=u||"",v=r._debugSource;v&&(m=v.fileName+":"+v.lineNumber),dx[m]||(dx[m]=!0,c("Function components cannot be given refs. Attempts to access this ref will fail. Did you mean to use React.forwardRef()?%s",o))}if(a.defaultProps!==void 0){var N=mr(a)||"Unknown";Zd[N]||(c("%s: Support for defaultProps will be removed from function components in a future major release. Use JavaScript default parameters instead.",N),Zd[N]=!0)}if(typeof a.getDerivedStateFromProps=="function"){var k=mr(a)||"Unknown";ux[k]||(c("%s: Function components do not support getDerivedStateFromProps.",k),ux[k]=!0)}if(typeof a.contextType=="object"&&a.contextType!==null){var M=mr(a)||"Unknown";cx[M]||(c("%s: Function components do not support contextType.",M),cx[M]=!0)}}}var vx={dehydrated:null,treeContext:null,retryLane:Fn};function gx(r){return{baseLanes:r,cachePool:k2(),transitions:null}}function M2(r,a){var o=null;return{baseLanes:Qt(r.baseLanes,a),cachePool:o,transitions:r.transitions}}function F2(r,a,o,u){if(a!==null){var m=a.memoizedState;if(m===null)return!1}return xg(r,Bd)}function $2(r,a){return D0(r.childLanes,a)}function IS(r,a,o){var u=a.pendingProps;KP(a)&&(a.flags|=Dr);var m=Ws.current,v=!1,N=(a.flags&Dr)!==Vt;if(N||F2(m,r)?(v=!0,a.flags&=~Dr):(r===null||r.memoizedState!==null)&&(m=s2(m,zD)),m=Zc(m),Go(a,m),r===null){Qv(a);var k=a.memoizedState;if(k!==null){var M=k.dehydrated;if(M!==null)return X2(a,M)}var te=u.children,le=u.fallback;if(v){var De=B2(a,te,le,o),Ne=a.child;return Ne.memoizedState=gx(o),a.memoizedState=vx,De}else return xx(a,te)}else{var Ae=r.memoizedState;if(Ae!==null){var Ie=Ae.dehydrated;if(Ie!==null)return G2(r,a,N,u,Ie,Ae,o)}if(v){var He=u.fallback,dt=u.children,Ut=W2(r,a,dt,He,o),Rt=a.child,cr=r.child.memoizedState;return Rt.memoizedState=cr===null?gx(o):M2(cr,o),Rt.childLanes=$2(r,o),a.memoizedState=vx,Ut}else{var sr=u.children,Te=H2(r,a,sr,o);return a.memoizedState=null,Te}}}function xx(r,a,o){var u=r.mode,m={mode:"visible",children:a},v=bx(m,u);return v.return=r,r.child=v,v}function B2(r,a,o,u){var m=r.mode,v=r.child,N={mode:"hidden",children:a},k,M;return(m&or)===At&&v!==null?(k=v,k.childLanes=Je,k.pendingProps=N,r.mode&kr&&(k.actualDuration=0,k.actualStartTime=-1,k.selfBaseDuration=0,k.treeBaseDuration=0),M=tl(o,m,u,null)):(k=bx(N,m),M=tl(o,m,u,null)),k.return=r,M.return=r,k.sibling=M,r.child=k,M}function bx(r,a,o){return My(r,a,Je,null)}function MS(r,a){return Kl(r,a)}function H2(r,a,o,u){var m=r.child,v=m.sibling,N=MS(m,{mode:"visible",children:o});if((a.mode&or)===At&&(N.lanes=u),N.return=a,N.sibling=null,v!==null){var k=a.deletions;k===null?(a.deletions=[v],a.flags|=yl):k.push(v)}return a.child=N,N}function W2(r,a,o,u,m){var v=a.mode,N=r.child,k=N.sibling,M={mode:"hidden",children:o},te;if((v&or)===At&&a.child!==N){var le=a.child;te=le,te.childLanes=Je,te.pendingProps=M,a.mode&kr&&(te.actualDuration=0,te.actualStartTime=-1,te.selfBaseDuration=N.selfBaseDuration,te.treeBaseDuration=N.treeBaseDuration),a.deletions=null}else te=MS(N,M),te.subtreeFlags=N.subtreeFlags&Gi;var De;return k!==null?De=Kl(k,u):(De=tl(u,v,m,null),De.flags|=dn),De.return=a,te.return=a,te.sibling=De,a.child=te,De}function $m(r,a,o,u){u!==null&&Zv(u),qc(a,r.child,null,o);var m=a.pendingProps,v=m.children,N=xx(a,v);return N.flags|=dn,a.memoizedState=null,N}function z2(r,a,o,u,m){var v=a.mode,N={mode:"visible",children:o},k=bx(N,v),M=tl(u,v,m,null);return M.flags|=dn,k.return=a,M.return=a,k.sibling=M,a.child=k,(a.mode&or)!==At&&qc(a,r.child,null,m),M}function X2(r,a,o){return(r.mode&or)===At?(c("Cannot hydrate Suspense in legacy mode. Switch from ReactDOM.hydrate(element, container) to ReactDOMClient.hydrateRoot(container, <App />).render(element) or remove the Suspense components from the server rendered components."),r.lanes=Bt):jv(a)?r.lanes=Rl:r.lanes=es,null}function G2(r,a,o,u,m,v,N){if(o)if(a.flags&zi){a.flags&=~zi;var Te=sx(new Error("There was an error while hydrating this Suspense boundary. Switched to client rendering."));return $m(r,a,N,Te)}else{if(a.memoizedState!==null)return a.child=r.child,a.flags|=Dr,null;var We=u.children,_e=u.fallback,rt=z2(r,a,We,_e,N),bt=a.child;return bt.memoizedState=gx(N),a.memoizedState=vx,rt}else{if(A_(),(a.mode&or)===At)return $m(r,a,N,null);if(jv(m)){var k,M,te;{var le=J5(m);k=le.digest,M=le.message,te=le.stack}var De;M?De=new Error(M):De=new Error("The server could not finish this Suspense boundary, likely due to an error during server rendering. Switched to client rendering.");var Ne=sx(De,k,te);return $m(r,a,N,Ne)}var Ae=ts(N,r.childLanes);if(Gs||Ae){var Ie=Qm();if(Ie!==null){var He=nR(Ie,N);if(He!==Fn&&He!==v.retryLane){v.retryLane=He;var dt=Ir;Ha(r,He),Tn(Ie,r,He,dt)}}Fx();var Ut=sx(new Error("This Suspense boundary received an update before it finished hydrating. This caused the boundary to switch to client rendering. The usual way to fix this is to wrap the original update in startTransition."));return $m(r,a,N,Ut)}else if(lD(m)){a.flags|=Dr,a.child=r.child;var Rt=xP.bind(null,r);return Q5(m,Rt),null}else{j_(a,m,v.treeContext);var cr=u.children,sr=xx(a,cr);return sr.flags|=Xi,sr}}}function FS(r,a,o){r.lanes=Qt(r.lanes,a);var u=r.alternate;u!==null&&(u.lanes=Qt(u.lanes,a)),cg(r.return,a,o)}function Y2(r,a,o){for(var u=a;u!==null;){if(u.tag===ee){var m=u.memoizedState;m!==null&&FS(u,o,r)}else if(u.tag===W)FS(u,o,r);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)return;for(;u.sibling===null;){if(u.return===null||u.return===r)return;u=u.return}u.sibling.return=u.return,u=u.sibling}}function q2(r){for(var a=r,o=null;a!==null;){var u=a.alternate;u!==null&&bm(u)===null&&(o=a),a=a.sibling}return o}function K2(r){if(r!==void 0&&r!=="forwards"&&r!=="backwards"&&r!=="together"&&!fx[r])if(fx[r]=!0,typeof r=="string")switch(r.toLowerCase()){case"together":case"forwards":case"backwards":{c('"%s" is not a valid value for revealOrder on <SuspenseList />. Use lowercase "%s" instead.',r,r.toLowerCase());break}case"forward":case"backward":{c('"%s" is not a valid value for revealOrder on <SuspenseList />. React uses the -s suffix in the spelling. Use "%ss" instead.',r,r.toLowerCase());break}default:c('"%s" is not a supported revealOrder on <SuspenseList />. Did you mean "together", "forwards" or "backwards"?',r);break}else c('%s is not a supported value for revealOrder on <SuspenseList />. Did you mean "together", "forwards" or "backwards"?',r)}function J2(r,a){r!==void 0&&!Fm[r]&&(r!=="collapsed"&&r!=="hidden"?(Fm[r]=!0,c('"%s" is not a supported value for tail on <SuspenseList />. Did you mean "collapsed" or "hidden"?',r)):a!=="forwards"&&a!=="backwards"&&(Fm[r]=!0,c('<SuspenseList tail="%s" /> is only valid if revealOrder is "forwards" or "backwards". Did you mean to specify revealOrder="forwards"?',r)))}function $S(r,a){{var o=Kt(r),u=!o&&typeof lt(r)=="function";if(o||u){var m=o?"array":"iterable";return c("A nested %s was passed to row #%s in <SuspenseList />. Wrap it in an additional SuspenseList to configure its revealOrder: <SuspenseList revealOrder=...> ... <SuspenseList revealOrder=...>{%s}</SuspenseList> ... </SuspenseList>",m,a,m),!1}}return!0}function Q2(r,a){if((a==="forwards"||a==="backwards")&&r!==void 0&&r!==null&&r!==!1)if(Kt(r)){for(var o=0;o<r.length;o++)if(!$S(r[o],o))return}else{var u=lt(r);if(typeof u=="function"){var m=u.call(r);if(m)for(var v=m.next(),N=0;!v.done;v=m.next()){if(!$S(v.value,N))return;N++}}else c('A single row was passed to a <SuspenseList revealOrder="%s" />. This is not useful since it needs multiple rows. Did you mean to pass multiple children or an array?',a)}}function Nx(r,a,o,u,m){var v=r.memoizedState;v===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:m}:(v.isBackwards=a,v.rendering=null,v.renderingStartTime=0,v.last=u,v.tail=o,v.tailMode=m)}function BS(r,a,o){var u=a.pendingProps,m=u.revealOrder,v=u.tail,N=u.children;K2(m),J2(v,m),Q2(N,m),Ra(r,a,N,o);var k=Ws.current,M=xg(k,Bd);if(M)k=bg(k,Bd),a.flags|=Dr;else{var te=r!==null&&(r.flags&Dr)!==Vt;te&&Y2(a,a.child,o),k=Zc(k)}if(Go(a,k),(a.mode&or)===At)a.memoizedState=null;else switch(m){case"forwards":{var le=q2(a.child),De;le===null?(De=a.child,a.child=null):(De=le.sibling,le.sibling=null),Nx(a,!1,De,le,v);break}case"backwards":{var Ne=null,Ae=a.child;for(a.child=null;Ae!==null;){var Ie=Ae.alternate;if(Ie!==null&&bm(Ie)===null){a.child=Ae;break}var He=Ae.sibling;Ae.sibling=Ne,Ne=Ae,Ae=He}Nx(a,!0,Ne,null,v);break}case"together":{Nx(a,!1,null,null,void 0);break}default:a.memoizedState=null}return a.child}function Z2(r,a,o){pg(a,a.stateNode.containerInfo);var u=a.pendingProps;return r===null?a.child=qc(a,null,u,o):Ra(r,a,u,o),a.child}var HS=!1;function e3(r,a,o){var u=a.type,m=u._context,v=a.pendingProps,N=a.memoizedProps,k=v.value;{"value"in v||HS||(HS=!0,c("The `value` prop is required for the `<Context.Provider>`. Did you misspell it or forget to pass it?"));var M=a.type.propTypes;M&&$s(M,v,"prop","Context.Provider")}if(LD(a,m,k),N!==null){var te=N.value;if(as(te,k)){if(N.children===v.children&&!K0())return no(r,a,o)}else K_(a,m,o)}var le=v.children;return Ra(r,a,le,o),a.child}var WS=!1;function t3(r,a,o){var u=a.type;u._context===void 0?u!==u.Consumer&&(WS||(WS=!0,c("Rendering <Context> directly is not supported and will be removed in a future major release. Did you mean to render <Context.Consumer> instead?"))):u=u._context;var m=a.pendingProps,v=m.children;typeof v!="function"&&c("A context consumer was rendered with multiple children, or a child that isn't a function. A context consumer expects a single child that is a function. If you did pass a function, make sure there is no trailing or leading whitespace around it."),Jc(a,o);var N=fn(u);Ju(a);var k;return Jd.current=a,qn(!0),k=v(N),qn(!1),Tc(),a.flags|=wc,Ra(r,a,k,o),a.child}function ef(){Gs=!0}function Bm(r,a){(a.mode&or)===At&&r!==null&&(r.alternate=null,a.alternate=null,a.flags|=dn)}function no(r,a,o){return r!==null&&(a.dependencies=r.dependencies),bS(),mf(a.lanes),ts(o,a.childLanes)?(Y_(r,a),a.child):null}function r3(r,a,o){{var u=a.return;if(u===null)throw new Error("Cannot swap the root fiber.");if(r.alternate=null,a.alternate=null,o.index=a.index,o.sibling=a.sibling,o.return=a.return,o.ref=a.ref,a===u.child)u.child=o;else{var m=u.child;if(m===null)throw new Error("Expected parent to have a child.");for(;m.sibling!==a;)if(m=m.sibling,m===null)throw new Error("Expected to find the previous sibling.");m.sibling=o}var v=u.deletions;return v===null?(u.deletions=[r],u.flags|=yl):v.push(r),o.flags|=dn,o}}function Dx(r,a){var o=r.lanes;return!!ts(o,a)}function n3(r,a,o){switch(a.tag){case b:VS(a),a.stateNode,Yc();break;case w:HD(a);break;case g:{var u=a.type;gi(u)&&Q0(a);break}case E:pg(a,a.stateNode.containerInfo);break;case G:{var m=a.memoizedProps.value,v=a.type._context;LD(a,v,m);break}case ne:{var N=ts(o,a.childLanes);N&&(a.flags|=Nr);{var k=a.stateNode;k.effectDuration=0,k.passiveEffectDuration=0}}break;case ee:{var M=a.memoizedState;if(M!==null){if(M.dehydrated!==null)return Go(a,Zc(Ws.current)),a.flags|=Dr,null;var te=a.child,le=te.childLanes;if(ts(o,le))return IS(r,a,o);Go(a,Zc(Ws.current));var De=no(r,a,o);return De!==null?De.sibling:null}else Go(a,Zc(Ws.current));break}case W:{var Ne=(r.flags&Dr)!==Vt,Ae=ts(o,a.childLanes);if(Ne){if(Ae)return BS(r,a,o);a.flags|=Dr}var Ie=a.memoizedState;if(Ie!==null&&(Ie.rendering=null,Ie.tail=null,Ie.lastEffect=null),Go(a,Ws.current),Ae)break;return null}case K:case Oe:return a.lanes=Je,US(r,a,o)}return no(r,a,o)}function zS(r,a,o){if(a._debugNeedsRemount&&r!==null)return r3(r,a,Jx(a.type,a.key,a.pendingProps,a._debugOwner||null,a.mode,a.lanes));if(r!==null){var u=r.memoizedProps,m=a.pendingProps;if(u!==m||K0()||a.type!==r.type)Gs=!0;else{var v=Dx(r,o);if(!v&&(a.flags&Dr)===Vt)return Gs=!1,n3(r,a,o);(r.flags&wp)!==Vt?Gs=!0:Gs=!1}}else if(Gs=!1,Zn()&&k_(a)){var N=a.index,k=R_();bD(a,k,N)}switch(a.lanes=Je,a.tag){case x:return I2(r,a,a.type,o);case ce:{var M=a.elementType;return V2(r,a,M,o)}case p:{var te=a.type,le=a.pendingProps,De=a.elementType===te?le:Xs(te,le);return mx(r,a,te,De,o)}case g:{var Ne=a.type,Ae=a.pendingProps,Ie=a.elementType===Ne?Ae:Xs(Ne,Ae);return LS(r,a,Ne,Ie,o)}case b:return U2(r,a,o);case w:return A2(r,a,o);case R:return L2(r,a);case ee:return IS(r,a,o);case E:return Z2(r,a,o);case _:{var He=a.type,dt=a.pendingProps,Ut=a.elementType===He?dt:Xs(He,dt);return TS(r,a,He,Ut,o)}case y:return T2(r,a,o);case U:return _2(r,a,o);case ne:return P2(r,a,o);case G:return e3(r,a,o);case q:return t3(r,a,o);case Q:{var Rt=a.type,cr=a.pendingProps,sr=Xs(Rt,cr);if(a.type!==a.elementType){var Te=Rt.propTypes;Te&&$s(Te,sr,"prop",mr(Rt))}return sr=Xs(Rt.type,sr),_S(r,a,Rt,sr,o)}case z:return PS(r,a,a.type,a.pendingProps,o);case S:{var We=a.type,_e=a.pendingProps,rt=a.elementType===We?_e:Xs(We,_e);return j2(r,a,We,rt,o)}case W:return BS(r,a,o);case H:break;case K:return US(r,a,o)}throw new Error("Unknown unit of work tag ("+a.tag+"). This error is likely caused by a bug in React. Please file an issue.")}function su(r){r.flags|=Nr}function XS(r){r.flags|=Ol,r.flags|=Cp}var GS,Sx,YS,qS;GS=function(r,a,o,u){for(var m=a.child;m!==null;){if(m.tag===w||m.tag===R)E5(r,m.stateNode);else if(m.tag!==E){if(m.child!==null){m.child.return=m,m=m.child;continue}}if(m===a)return;for(;m.sibling===null;){if(m.return===null||m.return===a)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},Sx=function(r,a){},YS=function(r,a,o,u,m){var v=r.memoizedProps;if(v!==u){var N=a.stateNode,k=vg(),M=C5(N,o,v,u,m,k);a.updateQueue=M,M&&su(a)}},qS=function(r,a,o,u){o!==u&&su(a)};function tf(r,a){if(!Zn())switch(r.tailMode){case"hidden":{for(var o=r.tail,u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r.tail=null:u.sibling=null;break}case"collapsed":{for(var m=r.tail,v=null;m!==null;)m.alternate!==null&&(v=m),m=m.sibling;v===null?!a&&r.tail!==null?r.tail.sibling=null:r.tail=null:v.sibling=null;break}}}function ta(r){var a=r.alternate!==null&&r.alternate.child===r.child,o=Je,u=Vt;if(a){if((r.mode&kr)!==At){for(var M=r.selfBaseDuration,te=r.child;te!==null;)o=Qt(o,Qt(te.lanes,te.childLanes)),u|=te.subtreeFlags&Gi,u|=te.flags&Gi,M+=te.treeBaseDuration,te=te.sibling;r.treeBaseDuration=M}else for(var le=r.child;le!==null;)o=Qt(o,Qt(le.lanes,le.childLanes)),u|=le.subtreeFlags&Gi,u|=le.flags&Gi,le.return=r,le=le.sibling;r.subtreeFlags|=u}else{if((r.mode&kr)!==At){for(var m=r.actualDuration,v=r.selfBaseDuration,N=r.child;N!==null;)o=Qt(o,Qt(N.lanes,N.childLanes)),u|=N.subtreeFlags,u|=N.flags,m+=N.actualDuration,v+=N.treeBaseDuration,N=N.sibling;r.actualDuration=m,r.treeBaseDuration=v}else for(var k=r.child;k!==null;)o=Qt(o,Qt(k.lanes,k.childLanes)),u|=k.subtreeFlags,u|=k.flags,k.return=r,k=k.sibling;r.subtreeFlags|=u}return r.childLanes=o,a}function a3(r,a,o){if(B_()&&(a.mode&or)!==At&&(a.flags&Dr)===Vt)return wD(a),Yc(),a.flags|=zi|h0|ka,!1;var u=nm(a);if(o!==null&&o.dehydrated!==null)if(r===null){if(!u)throw new Error("A dehydrated suspense component was completed without a hydrated node. This is probably a bug in React.");if(F_(a),ta(a),(a.mode&kr)!==At){var m=o!==null;if(m){var v=a.child;v!==null&&(a.treeBaseDuration-=v.treeBaseDuration)}}return!1}else{if(Yc(),(a.flags&Dr)===Vt&&(a.memoizedState=null),a.flags|=Nr,ta(a),(a.mode&kr)!==At){var N=o!==null;if(N){var k=a.child;k!==null&&(a.treeBaseDuration-=k.treeBaseDuration)}}return!1}else return CD(),!0}function KS(r,a,o){var u=a.pendingProps;switch(Yv(a),a.tag){case x:case ce:case z:case p:case _:case y:case U:case ne:case q:case Q:return ta(a),null;case g:{var m=a.type;return gi(m)&&J0(a),ta(a),null}case b:{var v=a.stateNode;if(Qc(a),Wv(a),Dg(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),r===null||r.child===null){var N=nm(a);if(N)su(a);else if(r!==null){var k=r.memoizedState;(!k.isDehydrated||(a.flags&zi)!==Vt)&&(a.flags|=Cc,CD())}}return Sx(r,a),ta(a),null}case w:{gg(a);var M=BD(),te=a.type;if(r!==null&&a.stateNode!=null)YS(r,a,te,u,M),r.ref!==a.ref&&XS(a);else{if(!u){if(a.stateNode===null)throw new Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");return ta(a),null}var le=vg(),De=nm(a);if(De)I_(a,M,le)&&su(a);else{var Ne=O5(te,u,M,le,a);GS(Ne,a,!1,!1),a.stateNode=Ne,w5(Ne,te,u,M)&&su(a)}a.ref!==null&&XS(a)}return ta(a),null}case R:{var Ae=u;if(r&&a.stateNode!=null){var Ie=r.memoizedProps;qS(r,a,Ie,Ae)}else{if(typeof Ae!="string"&&a.stateNode===null)throw new Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");var He=BD(),dt=vg(),Ut=nm(a);Ut?M_(a)&&su(a):a.stateNode=k5(Ae,He,dt,a)}return ta(a),null}case ee:{eu(a);var Rt=a.memoizedState;if(r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){var cr=a3(r,a,Rt);if(!cr)return a.flags&ka?a:null}if((a.flags&Dr)!==Vt)return a.lanes=o,(a.mode&kr)!==At&&Xg(a),a;var sr=Rt!==null,Te=r!==null&&r.memoizedState!==null;if(sr!==Te&&sr){var We=a.child;if(We.flags|=El,(a.mode&or)!==At){var _e=r===null&&(a.memoizedProps.unstable_avoidThisFallback!==!0||!0);_e||xg(Ws.current,zD)?sP():Fx()}}var rt=a.updateQueue;if(rt!==null&&(a.flags|=Nr),ta(a),(a.mode&kr)!==At&&sr){var bt=a.child;bt!==null&&(a.treeBaseDuration-=bt.treeBaseDuration)}return null}case E:return Qc(a),Sx(r,a),r===null&&D_(a.stateNode.containerInfo),ta(a),null;case G:var ht=a.type._context;return lg(ht,a),ta(a),null;case S:{var It=a.type;return gi(It)&&J0(a),ta(a),null}case W:{eu(a);var Xt=a.memoizedState;if(Xt===null)return ta(a),null;var Tr=(a.flags&Dr)!==Vt,hr=Xt.rendering;if(hr===null)if(Tr)tf(Xt,!1);else{var sn=oP()&&(r===null||(r.flags&Dr)===Vt);if(!sn)for(var pr=a.child;pr!==null;){var Zr=bm(pr);if(Zr!==null){Tr=!0,a.flags|=Dr,tf(Xt,!1);var va=Zr.updateQueue;return va!==null&&(a.updateQueue=va,a.flags|=Nr),a.subtreeFlags=Vt,q_(a,o),Go(a,bg(Ws.current,Bd)),a.child}pr=pr.sibling}Xt.tail!==null&&In()>gy()&&(a.flags|=Dr,Tr=!0,tf(Xt,!1),a.lanes=qN)}else{if(!Tr){var ia=bm(hr);if(ia!==null){a.flags|=Dr,Tr=!0;var os=ia.updateQueue;if(os!==null&&(a.updateQueue=os,a.flags|=Nr),tf(Xt,!0),Xt.tail===null&&Xt.tailMode==="hidden"&&!hr.alternate&&!Zn())return ta(a),null}else In()*2-Xt.renderingStartTime>gy()&&o!==es&&(a.flags|=Dr,Tr=!0,tf(Xt,!1),a.lanes=qN)}if(Xt.isBackwards)hr.sibling=a.child,a.child=hr;else{var Pa=Xt.last;Pa!==null?Pa.sibling=hr:a.child=hr,Xt.last=hr}}if(Xt.tail!==null){var Ua=Xt.tail;Xt.rendering=Ua,Xt.tail=Ua.sibling,Xt.renderingStartTime=In(),Ua.sibling=null;var ga=Ws.current;return Tr?ga=bg(ga,Bd):ga=Zc(ga),Go(a,ga),Ua}return ta(a),null}case H:break;case K:case Oe:{Mx(a);var lo=a.memoizedState,mu=lo!==null;if(r!==null){var xf=r.memoizedState,Ei=xf!==null;Ei!==mu&&!Ee&&(a.flags|=El)}return!mu||(a.mode&or)===At?ta(a):ts(Oi,es)&&(ta(a),a.subtreeFlags&(dn|Nr)&&(a.flags|=El)),null}case ye:return null;case Pe:return null}throw new Error("Unknown unit of work tag ("+a.tag+"). This error is likely caused by a bug in React. Please file an issue.")}function s3(r,a,o){switch(Yv(a),a.tag){case g:{var u=a.type;gi(u)&&J0(a);var m=a.flags;return m&ka?(a.flags=m&~ka|Dr,(a.mode&kr)!==At&&Xg(a),a):null}case b:{a.stateNode,Qc(a),Wv(a),Dg();var v=a.flags;return(v&ka)!==Vt&&(v&Dr)===Vt?(a.flags=v&~ka|Dr,a):null}case w:return gg(a),null;case ee:{eu(a);var N=a.memoizedState;if(N!==null&&N.dehydrated!==null){if(a.alternate===null)throw new Error("Threw in newly mounted dehydrated component. This is likely a bug in React. Please file an issue.");Yc()}var k=a.flags;return k&ka?(a.flags=k&~ka|Dr,(a.mode&kr)!==At&&Xg(a),a):null}case W:return eu(a),null;case E:return Qc(a),null;case G:var M=a.type._context;return lg(M,a),null;case K:case Oe:return Mx(a),null;case ye:return null;default:return null}}function JS(r,a,o){switch(Yv(a),a.tag){case g:{var u=a.type.childContextTypes;u!=null&&J0(a);break}case b:{a.stateNode,Qc(a),Wv(a),Dg();break}case w:{gg(a);break}case E:Qc(a);break;case ee:eu(a);break;case W:eu(a);break;case G:var m=a.type._context;lg(m,a);break;case K:case Oe:Mx(a);break}}var QS=null;QS=new Set;var Hm=!1,ra=!1,i3=typeof WeakSet=="function"?WeakSet:Set,wt=null,iu=null,ou=null;function o3(r){Yu(null,function(){throw r}),Op()}var l3=function(r,a){if(a.props=r.memoizedProps,a.state=r.memoizedState,r.mode&kr)try{Si(),a.componentWillUnmount()}finally{Di(r)}else a.componentWillUnmount()};function ZS(r,a){try{Ko(On,r)}catch(o){Vr(r,a,o)}}function yx(r,a,o){try{l3(r,o)}catch(u){Vr(r,a,u)}}function c3(r,a,o){try{o.componentDidMount()}catch(u){Vr(r,a,u)}}function ey(r,a){try{ry(r)}catch(o){Vr(r,a,o)}}function lu(r,a){var o=r.ref;if(o!==null)if(typeof o=="function"){var u;try{if(T&&O&&r.mode&kr)try{Si(),u=o(null)}finally{Di(r)}else u=o(null)}catch(m){Vr(r,a,m)}typeof u=="function"&&c("Unexpected return value from a callback ref in %s. A callback ref should not return a function.",jt(r))}else o.current=null}function Wm(r,a,o){try{o()}catch(u){Vr(r,a,u)}}var ty=!1;function u3(r,a){S5(r.containerInfo),wt=a,d3();var o=ty;return ty=!1,o}function d3(){for(;wt!==null;){var r=wt,a=r.child;(r.subtreeFlags&Tp)!==Vt&&a!==null?(a.return=r,wt=a):f3()}}function f3(){for(;wt!==null;){var r=wt;yt(r);try{m3(r)}catch(o){Vr(r,r.return,o)}un();var a=r.sibling;if(a!==null){a.return=r.return,wt=a;return}wt=r.return}}function m3(r){var a=r.alternate,o=r.flags;if((o&Cc)!==Vt){switch(yt(r),r.tag){case p:case _:case z:break;case g:{if(a!==null){var u=a.memoizedProps,m=a.memoizedState,v=r.stateNode;r.type===r.elementType&&!zl&&(v.props!==r.memoizedProps&&c("Expected %s props to match memoized props before getSnapshotBeforeUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",jt(r)||"instance"),v.state!==r.memoizedState&&c("Expected %s state to match memoized state before getSnapshotBeforeUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",jt(r)||"instance"));var N=v.getSnapshotBeforeUpdate(r.elementType===r.type?u:Xs(r.type,u),m);{var k=QS;N===void 0&&!k.has(r.type)&&(k.add(r.type),c("%s.getSnapshotBeforeUpdate(): A snapshot value (or null) must be returned. You have returned undefined.",jt(r)))}v.__reactInternalSnapshotBeforeUpdate=N}break}case b:{{var M=r.stateNode;G5(M.containerInfo)}break}case w:case R:case E:case S:break;default:throw new Error("This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}un()}}function Ys(r,a,o){var u=a.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var v=m.next,N=v;do{if((N.tag&r)===r){var k=N.destroy;N.destroy=void 0,k!==void 0&&((r&ea)!==Wa?kk(a):(r&On)!==Wa&&WN(a),(r&xi)!==Wa&&pf(!0),Wm(a,o,k),(r&xi)!==Wa&&pf(!1),(r&ea)!==Wa?Rk():(r&On)!==Wa&&zN())}N=N.next}while(N!==v)}}function Ko(r,a){var o=a.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var m=u.next,v=m;do{if((v.tag&r)===r){(r&ea)!==Wa?wk(a):(r&On)!==Wa&&Tk(a);var N=v.create;(r&xi)!==Wa&&pf(!0),v.destroy=N(),(r&xi)!==Wa&&pf(!1),(r&ea)!==Wa?Ck():(r&On)!==Wa&&_k();{var k=v.destroy;if(k!==void 0&&typeof k!="function"){var M=void 0;(v.tag&On)!==Vt?M="useLayoutEffect":(v.tag&xi)!==Vt?M="useInsertionEffect":M="useEffect";var te=void 0;k===null?te=" You returned null. If your effect does not require clean up, return undefined (or nothing).":typeof k.then=="function"?te=`

It looks like you wrote `+M+`(async () => ...) or returned a Promise. Instead, write the async function inside your effect and call it immediately:

`+M+`(() => {
  async function fetchData() {
    // You can await here
    const response = await MyAPI.getData(someId);
    // ...
  }
  fetchData();
}, [someId]); // Or [] if effect doesn't need props or state

Learn more about data fetching with Hooks: https://reactjs.org/link/hooks-data-fetching`:te=" You returned: "+k,c("%s must not return anything besides a function, which is used for clean-up.%s",M,te)}}}v=v.next}while(v!==m)}}function h3(r,a){if((a.flags&Nr)!==Vt)switch(a.tag){case ne:{var o=a.stateNode.passiveEffectDuration,u=a.memoizedProps,m=u.id,v=u.onPostCommit,N=gS(),k=a.alternate===null?"mount":"update";vS()&&(k="nested-update"),typeof v=="function"&&v(m,k,o,N);var M=a.return;e:for(;M!==null;){switch(M.tag){case b:var te=M.stateNode;te.passiveEffectDuration+=o;break e;case ne:var le=M.stateNode;le.passiveEffectDuration+=o;break e}M=M.return}break}}}function p3(r,a,o,u){if((o.flags&Ku)!==Vt)switch(o.tag){case p:case _:case z:{if(!ra)if(o.mode&kr)try{Si(),Ko(On|yn,o)}finally{Di(o)}else Ko(On|yn,o);break}case g:{var m=o.stateNode;if(o.flags&Nr&&!ra)if(a===null)if(o.type===o.elementType&&!zl&&(m.props!==o.memoizedProps&&c("Expected %s props to match memoized props before componentDidMount. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",jt(o)||"instance"),m.state!==o.memoizedState&&c("Expected %s state to match memoized state before componentDidMount. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",jt(o)||"instance")),o.mode&kr)try{Si(),m.componentDidMount()}finally{Di(o)}else m.componentDidMount();else{var v=o.elementType===o.type?a.memoizedProps:Xs(o.type,a.memoizedProps),N=a.memoizedState;if(o.type===o.elementType&&!zl&&(m.props!==o.memoizedProps&&c("Expected %s props to match memoized props before componentDidUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",jt(o)||"instance"),m.state!==o.memoizedState&&c("Expected %s state to match memoized state before componentDidUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",jt(o)||"instance")),o.mode&kr)try{Si(),m.componentDidUpdate(v,N,m.__reactInternalSnapshotBeforeUpdate)}finally{Di(o)}else m.componentDidUpdate(v,N,m.__reactInternalSnapshotBeforeUpdate)}var k=o.updateQueue;k!==null&&(o.type===o.elementType&&!zl&&(m.props!==o.memoizedProps&&c("Expected %s props to match memoized props before processing the update queue. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",jt(o)||"instance"),m.state!==o.memoizedState&&c("Expected %s state to match memoized state before processing the update queue. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",jt(o)||"instance")),$D(o,k,m));break}case b:{var M=o.updateQueue;if(M!==null){var te=null;if(o.child!==null)switch(o.child.tag){case w:te=o.child.stateNode;break;case g:te=o.child.stateNode;break}$D(o,M,te)}break}case w:{var le=o.stateNode;if(a===null&&o.flags&Nr){var De=o.type,Ne=o.memoizedProps;U5(le,De,Ne)}break}case R:break;case E:break;case ne:{{var Ae=o.memoizedProps,Ie=Ae.onCommit,He=Ae.onRender,dt=o.stateNode.effectDuration,Ut=gS(),Rt=a===null?"mount":"update";vS()&&(Rt="nested-update"),typeof He=="function"&&He(o.memoizedProps.id,Rt,o.actualDuration,o.treeBaseDuration,o.actualStartTime,Ut);{typeof Ie=="function"&&Ie(o.memoizedProps.id,Rt,dt,Ut),fP(o);var cr=o.return;e:for(;cr!==null;){switch(cr.tag){case b:var sr=cr.stateNode;sr.effectDuration+=dt;break e;case ne:var Te=cr.stateNode;Te.effectDuration+=dt;break e}cr=cr.return}}}break}case ee:{y3(r,o);break}case W:case S:case H:case K:case Oe:case Pe:break;default:throw new Error("This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}ra||o.flags&Ol&&ry(o)}function v3(r){switch(r.tag){case p:case _:case z:{if(r.mode&kr)try{Si(),ZS(r,r.return)}finally{Di(r)}else ZS(r,r.return);break}case g:{var a=r.stateNode;typeof a.componentDidMount=="function"&&c3(r,r.return,a),ey(r,r.return);break}case w:{ey(r,r.return);break}}}function g3(r,a){for(var o=null,u=r;;){if(u.tag===w){if(o===null){o=u;try{var m=u.stateNode;a?H5(m):z5(u.stateNode,u.memoizedProps)}catch(N){Vr(r,r.return,N)}}}else if(u.tag===R){if(o===null)try{var v=u.stateNode;a?W5(v):X5(v,u.memoizedProps)}catch(N){Vr(r,r.return,N)}}else if(!((u.tag===K||u.tag===Oe)&&u.memoizedState!==null&&u!==r)){if(u.child!==null){u.child.return=u,u=u.child;continue}}if(u===r)return;for(;u.sibling===null;){if(u.return===null||u.return===r)return;o===u&&(o=null),u=u.return}o===u&&(o=null),u.sibling.return=u.return,u=u.sibling}}function ry(r){var a=r.ref;if(a!==null){var o=r.stateNode,u;switch(r.tag){case w:u=o;break;default:u=o}if(typeof a=="function"){var m;if(r.mode&kr)try{Si(),m=a(u)}finally{Di(r)}else m=a(u);typeof m=="function"&&c("Unexpected return value from a callback ref in %s. A callback ref should not return a function.",jt(r))}else a.hasOwnProperty("current")||c("Unexpected ref object provided for %s. Use either a ref-setter function or React.createRef().",jt(r)),a.current=u}}function x3(r){var a=r.alternate;a!==null&&(a.return=null),r.return=null}function ny(r){var a=r.alternate;a!==null&&(r.alternate=null,ny(a));{if(r.child=null,r.deletions=null,r.sibling=null,r.tag===w){var o=r.stateNode;o!==null&&O_(o)}r.stateNode=null,r._debugOwner=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}}function b3(r){for(var a=r.return;a!==null;){if(ay(a))return a;a=a.return}throw new Error("Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue.")}function ay(r){return r.tag===w||r.tag===b||r.tag===E}function sy(r){var a=r;e:for(;;){for(;a.sibling===null;){if(a.return===null||ay(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==w&&a.tag!==R&&a.tag!==A;){if(a.flags&dn||a.child===null||a.tag===E)continue e;a.child.return=a,a=a.child}if(!(a.flags&dn))return a.stateNode}}function N3(r){var a=b3(r);switch(a.tag){case w:{var o=a.stateNode;a.flags&qu&&(oD(o),a.flags&=~qu);var u=sy(r);Ex(r,u,o);break}case b:case E:{var m=a.stateNode.containerInfo,v=sy(r);Ox(r,v,m);break}default:throw new Error("Invalid host parent fiber. This error is likely caused by a bug in React. Please file an issue.")}}function Ox(r,a,o){var u=r.tag,m=u===w||u===R;if(m){var v=r.stateNode;a?M5(o,v,a):j5(o,v)}else if(u!==E){var N=r.child;if(N!==null){Ox(N,a,o);for(var k=N.sibling;k!==null;)Ox(k,a,o),k=k.sibling}}}function Ex(r,a,o){var u=r.tag,m=u===w||u===R;if(m){var v=r.stateNode;a?I5(o,v,a):V5(o,v)}else if(u!==E){var N=r.child;if(N!==null){Ex(N,a,o);for(var k=N.sibling;k!==null;)Ex(k,a,o),k=k.sibling}}}var na=null,qs=!1;function D3(r,a,o){{var u=a;e:for(;u!==null;){switch(u.tag){case w:{na=u.stateNode,qs=!1;break e}case b:{na=u.stateNode.containerInfo,qs=!0;break e}case E:{na=u.stateNode.containerInfo,qs=!0;break e}}u=u.return}if(na===null)throw new Error("Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue.");iy(r,a,o),na=null,qs=!1}x3(o)}function Jo(r,a,o){for(var u=o.child;u!==null;)iy(r,a,u),u=u.sibling}function iy(r,a,o){switch(Sk(o),o.tag){case w:ra||lu(o,a);case R:{{var u=na,m=qs;na=null,Jo(r,a,o),na=u,qs=m,na!==null&&(qs?$5(na,o.stateNode):F5(na,o.stateNode))}return}case A:{na!==null&&(qs?B5(na,o.stateNode):Vv(na,o.stateNode));return}case E:{{var v=na,N=qs;na=o.stateNode.containerInfo,qs=!0,Jo(r,a,o),na=v,qs=N}return}case p:case _:case Q:case z:{if(!ra){var k=o.updateQueue;if(k!==null){var M=k.lastEffect;if(M!==null){var te=M.next,le=te;do{var De=le,Ne=De.destroy,Ae=De.tag;Ne!==void 0&&((Ae&xi)!==Wa?Wm(o,a,Ne):(Ae&On)!==Wa&&(WN(o),o.mode&kr?(Si(),Wm(o,a,Ne),Di(o)):Wm(o,a,Ne),zN())),le=le.next}while(le!==te)}}}Jo(r,a,o);return}case g:{if(!ra){lu(o,a);var Ie=o.stateNode;typeof Ie.componentWillUnmount=="function"&&yx(o,a,Ie)}Jo(r,a,o);return}case H:{Jo(r,a,o);return}case K:{if(o.mode&or){var He=ra;ra=He||o.memoizedState!==null,Jo(r,a,o),ra=He}else Jo(r,a,o);break}default:{Jo(r,a,o);return}}}function S3(r){r.memoizedState}function y3(r,a){var o=a.memoizedState;if(o===null){var u=a.alternate;if(u!==null){var m=u.memoizedState;if(m!==null){var v=m.dehydrated;v!==null&&o_(v)}}}}function oy(r){var a=r.updateQueue;if(a!==null){r.updateQueue=null;var o=r.stateNode;o===null&&(o=r.stateNode=new i3),a.forEach(function(u){var m=bP.bind(null,r,u);if(!o.has(u)){if(o.add(u),Ms)if(iu!==null&&ou!==null)hf(ou,iu);else throw Error("Expected finished root and lanes to be set. This is a bug in React.");u.then(m,m)}})}}function O3(r,a,o){iu=o,ou=r,yt(a),ly(a,r),yt(a),iu=null,ou=null}function Ks(r,a,o){var u=a.deletions;if(u!==null)for(var m=0;m<u.length;m++){var v=u[m];try{D3(r,a,v)}catch(M){Vr(v,a,M)}}var N=Yn();if(a.subtreeFlags&_p)for(var k=a.child;k!==null;)yt(k),ly(k,r),k=k.sibling;yt(N)}function ly(r,a,o){var u=r.alternate,m=r.flags;switch(r.tag){case p:case _:case Q:case z:{if(Ks(a,r),yi(r),m&Nr){try{Ys(xi|yn,r,r.return),Ko(xi|yn,r)}catch(It){Vr(r,r.return,It)}if(r.mode&kr){try{Si(),Ys(On|yn,r,r.return)}catch(It){Vr(r,r.return,It)}Di(r)}else try{Ys(On|yn,r,r.return)}catch(It){Vr(r,r.return,It)}}return}case g:{Ks(a,r),yi(r),m&Ol&&u!==null&&lu(u,u.return);return}case w:{Ks(a,r),yi(r),m&Ol&&u!==null&&lu(u,u.return);{if(r.flags&qu){var v=r.stateNode;try{oD(v)}catch(It){Vr(r,r.return,It)}}if(m&Nr){var N=r.stateNode;if(N!=null){var k=r.memoizedProps,M=u!==null?u.memoizedProps:k,te=r.type,le=r.updateQueue;if(r.updateQueue=null,le!==null)try{A5(N,le,te,M,k,r)}catch(It){Vr(r,r.return,It)}}}}return}case R:{if(Ks(a,r),yi(r),m&Nr){if(r.stateNode===null)throw new Error("This should have a text node initialized. This error is likely caused by a bug in React. Please file an issue.");var De=r.stateNode,Ne=r.memoizedProps,Ae=u!==null?u.memoizedProps:Ne;try{L5(De,Ae,Ne)}catch(It){Vr(r,r.return,It)}}return}case b:{if(Ks(a,r),yi(r),m&Nr&&u!==null){var Ie=u.memoizedState;if(Ie.isDehydrated)try{i_(a.containerInfo)}catch(It){Vr(r,r.return,It)}}return}case E:{Ks(a,r),yi(r);return}case ee:{Ks(a,r),yi(r);var He=r.child;if(He.flags&El){var dt=He.stateNode,Ut=He.memoizedState,Rt=Ut!==null;if(dt.isHidden=Rt,Rt){var cr=He.alternate!==null&&He.alternate.memoizedState!==null;cr||aP()}}if(m&Nr){try{S3(r)}catch(It){Vr(r,r.return,It)}oy(r)}return}case K:{var sr=u!==null&&u.memoizedState!==null;if(r.mode&or){var Te=ra;ra=Te||sr,Ks(a,r),ra=Te}else Ks(a,r);if(yi(r),m&El){var We=r.stateNode,_e=r.memoizedState,rt=_e!==null,bt=r;if(We.isHidden=rt,rt&&!sr&&(bt.mode&or)!==At){wt=bt;for(var ht=bt.child;ht!==null;)wt=ht,w3(ht),ht=ht.sibling}g3(bt,rt)}return}case W:{Ks(a,r),yi(r),m&Nr&&oy(r);return}case H:return;default:{Ks(a,r),yi(r);return}}}function yi(r){var a=r.flags;if(a&dn){try{N3(r)}catch(o){Vr(r,r.return,o)}r.flags&=~dn}a&Xi&&(r.flags&=~Xi)}function E3(r,a,o){iu=o,ou=a,wt=r,cy(r,a,o),iu=null,ou=null}function cy(r,a,o){for(var u=(r.mode&or)!==At;wt!==null;){var m=wt,v=m.child;if(m.tag===K&&u){var N=m.memoizedState!==null,k=N||Hm;if(k){wx(r,a,o);continue}else{var M=m.alternate,te=M!==null&&M.memoizedState!==null,le=te||ra,De=Hm,Ne=ra;Hm=k,ra=le,ra&&!Ne&&(wt=m,C3(m));for(var Ae=v;Ae!==null;)wt=Ae,cy(Ae,a,o),Ae=Ae.sibling;wt=m,Hm=De,ra=Ne,wx(r,a,o);continue}}(m.subtreeFlags&Ku)!==Vt&&v!==null?(v.return=m,wt=v):wx(r,a,o)}}function wx(r,a,o){for(;wt!==null;){var u=wt;if((u.flags&Ku)!==Vt){var m=u.alternate;yt(u);try{p3(a,m,u,o)}catch(N){Vr(u,u.return,N)}un()}if(u===r){wt=null;return}var v=u.sibling;if(v!==null){v.return=u.return,wt=v;return}wt=u.return}}function w3(r){for(;wt!==null;){var a=wt,o=a.child;switch(a.tag){case p:case _:case Q:case z:{if(a.mode&kr)try{Si(),Ys(On,a,a.return)}finally{Di(a)}else Ys(On,a,a.return);break}case g:{lu(a,a.return);var u=a.stateNode;typeof u.componentWillUnmount=="function"&&yx(a,a.return,u);break}case w:{lu(a,a.return);break}case K:{var m=a.memoizedState!==null;if(m){uy(r);continue}break}}o!==null?(o.return=a,wt=o):uy(r)}}function uy(r){for(;wt!==null;){var a=wt;if(a===r){wt=null;return}var o=a.sibling;if(o!==null){o.return=a.return,wt=o;return}wt=a.return}}function C3(r){for(;wt!==null;){var a=wt,o=a.child;if(a.tag===K){var u=a.memoizedState!==null;if(u){dy(r);continue}}o!==null?(o.return=a,wt=o):dy(r)}}function dy(r){for(;wt!==null;){var a=wt;yt(a);try{v3(a)}catch(u){Vr(a,a.return,u)}if(un(),a===r){wt=null;return}var o=a.sibling;if(o!==null){o.return=a.return,wt=o;return}wt=a.return}}function k3(r,a,o,u){wt=a,R3(a,r,o,u)}function R3(r,a,o,u){for(;wt!==null;){var m=wt,v=m.child;(m.subtreeFlags&kc)!==Vt&&v!==null?(v.return=m,wt=v):T3(r,a,o,u)}}function T3(r,a,o,u){for(;wt!==null;){var m=wt;if((m.flags&Po)!==Vt){yt(m);try{_3(a,m,o,u)}catch(N){Vr(m,m.return,N)}un()}if(m===r){wt=null;return}var v=m.sibling;if(v!==null){v.return=m.return,wt=v;return}wt=m.return}}function _3(r,a,o,u){switch(a.tag){case p:case _:case z:{if(a.mode&kr){zg();try{Ko(ea|yn,a)}finally{Wg(a)}}else Ko(ea|yn,a);break}}}function P3(r){wt=r,U3()}function U3(){for(;wt!==null;){var r=wt,a=r.child;if((wt.flags&yl)!==Vt){var o=r.deletions;if(o!==null){for(var u=0;u<o.length;u++){var m=o[u];wt=m,V3(m,r)}{var v=r.alternate;if(v!==null){var N=v.child;if(N!==null){v.child=null;do{var k=N.sibling;N.sibling=null,N=k}while(N!==null)}}}wt=r}}(r.subtreeFlags&kc)!==Vt&&a!==null?(a.return=r,wt=a):A3()}}function A3(){for(;wt!==null;){var r=wt;(r.flags&Po)!==Vt&&(yt(r),L3(r),un());var a=r.sibling;if(a!==null){a.return=r.return,wt=a;return}wt=r.return}}function L3(r){switch(r.tag){case p:case _:case z:{r.mode&kr?(zg(),Ys(ea|yn,r,r.return),Wg(r)):Ys(ea|yn,r,r.return);break}}}function V3(r,a){for(;wt!==null;){var o=wt;yt(o),I3(o,a),un();var u=o.child;u!==null?(u.return=o,wt=u):j3(r)}}function j3(r){for(;wt!==null;){var a=wt,o=a.sibling,u=a.return;if(ny(a),a===r){wt=null;return}if(o!==null){o.return=u,wt=o;return}wt=u}}function I3(r,a){switch(r.tag){case p:case _:case z:{r.mode&kr?(zg(),Ys(ea,r,a),Wg(r)):Ys(ea,r,a);break}}}function M3(r){switch(r.tag){case p:case _:case z:{try{Ko(On|yn,r)}catch(o){Vr(r,r.return,o)}break}case g:{var a=r.stateNode;try{a.componentDidMount()}catch(o){Vr(r,r.return,o)}break}}}function F3(r){switch(r.tag){case p:case _:case z:{try{Ko(ea|yn,r)}catch(a){Vr(r,r.return,a)}break}}}function $3(r){switch(r.tag){case p:case _:case z:{try{Ys(On|yn,r,r.return)}catch(o){Vr(r,r.return,o)}break}case g:{var a=r.stateNode;typeof a.componentWillUnmount=="function"&&yx(r,r.return,a);break}}}function B3(r){switch(r.tag){case p:case _:case z:try{Ys(ea|yn,r,r.return)}catch(a){Vr(r,r.return,a)}}}if(typeof Symbol=="function"&&Symbol.for){var rf=Symbol.for;rf("selector.component"),rf("selector.has_pseudo_class"),rf("selector.role"),rf("selector.test_id"),rf("selector.text")}var H3=[];function W3(){H3.forEach(function(r){return r()})}var z3=e.ReactCurrentActQueue;function X3(r){{var a=typeof IS_REACT_ACT_ENVIRONMENT<"u"?IS_REACT_ACT_ENVIRONMENT:void 0,o=typeof jest<"u";return o&&a!==!1}}function fy(){{var r=typeof IS_REACT_ACT_ENVIRONMENT<"u"?IS_REACT_ACT_ENVIRONMENT:void 0;return!r&&z3.current!==null&&c("The current testing environment is not configured to support act(...)"),r}}var G3=Math.ceil,Cx=e.ReactCurrentDispatcher,kx=e.ReactCurrentOwner,aa=e.ReactCurrentBatchConfig,Js=e.ReactCurrentActQueue,Cn=0,my=1,sa=2,Ds=4,ao=0,nf=1,Xl=2,zm=3,af=4,hy=5,Rx=6,lr=Cn,Ta=null,Gr=null,kn=Je,Oi=Je,Tx=$o(Je),Rn=ao,sf=null,Xm=Je,of=Je,Gm=Je,lf=null,za=null,_x=0,py=500,vy=1/0,Y3=500,so=null;function cf(){vy=In()+Y3}function gy(){return vy}var Ym=!1,Px=null,cu=null,Gl=!1,Qo=null,uf=Je,Ux=[],Ax=null,q3=50,df=0,Lx=null,Vx=!1,qm=!1,K3=50,uu=0,Km=null,ff=Ir,Jm=Je,xy=!1;function Qm(){return Ta}function _a(){return(lr&(sa|Ds))!==Cn?In():(ff!==Ir||(ff=In()),ff)}function Zo(r){var a=r.mode;if((a&or)===At)return Bt;if((lr&sa)!==Cn&&kn!==Je)return nd(kn);var o=z_()!==W_;if(o){if(aa.transition!==null){var u=aa.transition;u._updatedFibers||(u._updatedFibers=new Set),u._updatedFibers.add(r)}return Jm===Fn&&(Jm=ZN()),Jm}var m=Fs();if(m!==Fn)return m;var v=R5();return v}function J3(r){var a=r.mode;return(a&or)===At?Bt:Zk()}function Tn(r,a,o,u){DP(),xy&&c("useInsertionEffect must not schedule updates."),Vx&&(qm=!0),ad(r,o,u),(lr&sa)!==Je&&r===Ta?OP(a):(Ms&&r1(r,a,o),EP(a),r===Ta&&((lr&sa)===Cn&&(of=Qt(of,o)),Rn===af&&el(r,kn)),Xa(r,u),o===Bt&&lr===Cn&&(a.mode&or)===At&&!Js.isBatchingLegacy&&(cf(),xD()))}function Q3(r,a,o){var u=r.current;u.lanes=a,ad(r,a,o),Xa(r,o)}function Z3(r){return(lr&sa)!==Cn}function Xa(r,a){var o=r.callbackNode;Gk(r,a);var u=b0(r,r===Ta?kn:Je);if(u===Je){o!==null&&Ay(o),r.callbackNode=null,r.callbackPriority=Fn;return}var m=_l(u),v=r.callbackPriority;if(v===m&&!(Js.current!==null&&o!==Hx)){o==null&&v!==Bt&&c("Expected scheduled callback to exist. This error is likely caused by a bug in React. Please file an issue.");return}o!=null&&Ay(o);var N;if(m===Bt)r.tag===Bo?(Js.isBatchingLegacy!==null&&(Js.didScheduleLegacyUpdate=!0),C_(Dy.bind(null,r))):gD(Dy.bind(null,r)),Js.current!==null?Js.current.push(Ho):_5(function(){(lr&(sa|Ds))===Cn&&Ho()}),N=null;else{var k;switch(s1(u)){case rs:k=p0;break;case qi:k=Pp;break;case Ki:k=kl;break;case S0:k=Up;break;default:k=kl;break}N=Wx(k,by.bind(null,r))}r.callbackPriority=m,r.callbackNode=N}function by(r,a){if(g2(),ff=Ir,Jm=Je,(lr&(sa|Ds))!==Cn)throw new Error("Should not already be working.");var o=r.callbackNode,u=oo();if(u&&r.callbackNode!==o)return null;var m=b0(r,r===Ta?kn:Je);if(m===Je)return null;var v=!N0(r,m)&&!Qk(r,m)&&!a,N=v?cP(r,m):eh(r,m);if(N!==ao){if(N===Xl){var k=tv(r);k!==Je&&(m=k,N=jx(r,k))}if(N===nf){var M=sf;throw Yl(r,Je),el(r,m),Xa(r,In()),M}if(N===Rx)el(r,m);else{var te=!N0(r,m),le=r.current.alternate;if(te&&!tP(le)){if(N=eh(r,m),N===Xl){var De=tv(r);De!==Je&&(m=De,N=jx(r,De))}if(N===nf){var Ne=sf;throw Yl(r,Je),el(r,m),Xa(r,In()),Ne}}r.finishedWork=le,r.finishedLanes=m,eP(r,N,m)}}return Xa(r,In()),r.callbackNode===o?by.bind(null,r):null}function jx(r,a){var o=lf;if(y0(r)){var u=Yl(r,a);u.flags|=zi,N_(r.containerInfo)}var m=eh(r,a);if(m!==Xl){var v=za;za=o,v!==null&&Ny(v)}return m}function Ny(r){za===null?za=r:za.push.apply(za,r)}function eP(r,a,o){switch(a){case ao:case nf:throw new Error("Root did not complete. This is a bug in React.");case Xl:{ql(r,za,so);break}case zm:{if(el(r,o),JN(o)&&!Ly()){var u=_x+py-In();if(u>10){var m=b0(r,Je);if(m!==Je)break;var v=r.suspendedLanes;if(!Ac(v,o)){_a(),t1(r,v);break}r.timeoutHandle=Av(ql.bind(null,r,za,so),u);break}}ql(r,za,so);break}case af:{if(el(r,o),Jk(o))break;if(!Ly()){var N=zk(r,o),k=N,M=In()-k,te=NP(M)-M;if(te>10){r.timeoutHandle=Av(ql.bind(null,r,za,so),te);break}}ql(r,za,so);break}case hy:{ql(r,za,so);break}default:throw new Error("Unknown root exit status.")}}function tP(r){for(var a=r;;){if(a.flags&Ep){var o=a.updateQueue;if(o!==null){var u=o.stores;if(u!==null)for(var m=0;m<u.length;m++){var v=u[m],N=v.getSnapshot,k=v.value;try{if(!as(N(),k))return!1}catch{return!1}}}}var M=a.child;if(a.subtreeFlags&Ep&&M!==null){M.return=a,a=M;continue}if(a===r)return!0;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}return!0}function el(r,a){a=D0(a,Gm),a=D0(a,of),tR(r,a)}function Dy(r){if(x2(),(lr&(sa|Ds))!==Cn)throw new Error("Should not already be working.");oo();var a=b0(r,Je);if(!ts(a,Bt))return Xa(r,In()),null;var o=eh(r,a);if(r.tag!==Bo&&o===Xl){var u=tv(r);u!==Je&&(a=u,o=jx(r,u))}if(o===nf){var m=sf;throw Yl(r,Je),el(r,a),Xa(r,In()),m}if(o===Rx)throw new Error("Root did not complete. This is a bug in React.");var v=r.current.alternate;return r.finishedWork=v,r.finishedLanes=a,ql(r,za,so),Xa(r,In()),null}function rP(r,a){a!==Je&&(sv(r,Qt(a,Bt)),Xa(r,In()),(lr&(sa|Ds))===Cn&&(cf(),Ho()))}function Ix(r,a){var o=lr;lr|=my;try{return r(a)}finally{lr=o,lr===Cn&&!Js.isBatchingLegacy&&(cf(),xD())}}function nP(r,a,o,u,m){var v=Fs(),N=aa.transition;try{return aa.transition=null,$n(rs),r(a,o,u,m)}finally{$n(v),aa.transition=N,lr===Cn&&cf()}}function io(r){Qo!==null&&Qo.tag===Bo&&(lr&(sa|Ds))===Cn&&oo();var a=lr;lr|=my;var o=aa.transition,u=Fs();try{return aa.transition=null,$n(rs),r?r():void 0}finally{$n(u),aa.transition=o,lr=a,(lr&(sa|Ds))===Cn&&Ho()}}function Sy(){return(lr&(sa|Ds))!==Cn}function Zm(r,a){ha(Tx,Oi,r),Oi=Qt(Oi,a)}function Mx(r){Oi=Tx.current,ma(Tx,r)}function Yl(r,a){r.finishedWork=null,r.finishedLanes=Je;var o=r.timeoutHandle;if(o!==Lv&&(r.timeoutHandle=Lv,T5(o)),Gr!==null)for(var u=Gr.return;u!==null;){var m=u.alternate;JS(m,u),u=u.return}Ta=r;var v=Kl(r.current,null);return Gr=v,kn=Oi=a,Rn=ao,sf=null,Xm=Je,of=Je,Gm=Je,lf=null,za=null,Q_(),Hs.discardPendingWarnings(),v}function yy(r,a){do{var o=Gr;try{if(cm(),GD(),un(),kx.current=null,o===null||o.return===null){Rn=nf,sf=a,Gr=null;return}if(T&&o.mode&kr&&Im(o,!0),X)if(Tc(),a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a;Uk(o,u,kn)}else Pk(o,a,kn);C2(r,o.return,o,a,kn),Cy(o)}catch(m){a=m,Gr===o&&o!==null?(o=o.return,Gr=o):o=Gr;continue}return}while(!0)}function Oy(){var r=Cx.current;return Cx.current=Um,r===null?Um:r}function Ey(r){Cx.current=r}function aP(){_x=In()}function mf(r){Xm=Qt(r,Xm)}function sP(){Rn===ao&&(Rn=zm)}function Fx(){(Rn===ao||Rn===zm||Rn===Xl)&&(Rn=af),Ta!==null&&(rv(Xm)||rv(of))&&el(Ta,kn)}function iP(r){Rn!==af&&(Rn=Xl),lf===null?lf=[r]:lf.push(r)}function oP(){return Rn===ao}function eh(r,a){var o=lr;lr|=sa;var u=Oy();if(Ta!==r||kn!==a){if(Ms){var m=r.memoizedUpdaters;m.size>0&&(hf(r,kn),m.clear()),n1(r,a)}so=a1(),Yl(r,a)}XN(a);do try{lP();break}catch(v){yy(r,v)}while(!0);if(cm(),lr=o,Ey(u),Gr!==null)throw new Error("Cannot commit an incomplete root. This error is likely caused by a bug in React. Please file an issue.");return GN(),Ta=null,kn=Je,Rn}function lP(){for(;Gr!==null;)wy(Gr)}function cP(r,a){var o=lr;lr|=sa;var u=Oy();if(Ta!==r||kn!==a){if(Ms){var m=r.memoizedUpdaters;m.size>0&&(hf(r,kn),m.clear()),n1(r,a)}so=a1(),cf(),Yl(r,a)}XN(a);do try{uP();break}catch(v){yy(r,v)}while(!0);return cm(),Ey(u),lr=o,Gr!==null?(Ik(),ao):(GN(),Ta=null,kn=Je,Rn)}function uP(){for(;Gr!==null&&!fk();)wy(Gr)}function wy(r){var a=r.alternate;yt(r);var o;(r.mode&kr)!==At?(Hg(r),o=$x(a,r,Oi),Im(r,!0)):o=$x(a,r,Oi),un(),r.memoizedProps=r.pendingProps,o===null?Cy(r):Gr=o,kx.current=null}function Cy(r){var a=r;do{var o=a.alternate,u=a.return;if((a.flags&h0)===Vt){yt(a);var m=void 0;if((a.mode&kr)===At?m=KS(o,a,Oi):(Hg(a),m=KS(o,a,Oi),Im(a,!1)),un(),m!==null){Gr=m;return}}else{var v=s3(o,a);if(v!==null){v.flags&=ik,Gr=v;return}if((a.mode&kr)!==At){Im(a,!1);for(var N=a.actualDuration,k=a.child;k!==null;)N+=k.actualDuration,k=k.sibling;a.actualDuration=N}if(u!==null)u.flags|=h0,u.subtreeFlags=Vt,u.deletions=null;else{Rn=Rx,Gr=null;return}}var M=a.sibling;if(M!==null){Gr=M;return}a=u,Gr=a}while(a!==null);Rn===ao&&(Rn=hy)}function ql(r,a,o){var u=Fs(),m=aa.transition;try{aa.transition=null,$n(rs),dP(r,a,o,u)}finally{aa.transition=m,$n(u)}return null}function dP(r,a,o,u){do oo();while(Qo!==null);if(SP(),(lr&(sa|Ds))!==Cn)throw new Error("Should not already be working.");var m=r.finishedWork,v=r.finishedLanes;if(Ek(v),m===null)return HN(),null;if(v===Je&&c("root.finishedLanes should not be empty during a commit. This is a bug in React."),r.finishedWork=null,r.finishedLanes=Je,m===r.current)throw new Error("Cannot commit the same tree as before. This error is likely caused by a bug in React. Please file an issue.");r.callbackNode=null,r.callbackPriority=Fn;var N=Qt(m.lanes,m.childLanes);rR(r,N),r===Ta&&(Ta=null,Gr=null,kn=Je),((m.subtreeFlags&kc)!==Vt||(m.flags&kc)!==Vt)&&(Gl||(Gl=!0,Ax=o,Wx(kl,function(){return oo(),null})));var k=(m.subtreeFlags&(Tp|_p|Ku|kc))!==Vt,M=(m.flags&(Tp|_p|Ku|kc))!==Vt;if(k||M){var te=aa.transition;aa.transition=null;var le=Fs();$n(rs);var De=lr;lr|=Ds,kx.current=null,u3(r,m),xS(),O3(r,m,v),y5(r.containerInfo),r.current=m,Ak(v),E3(m,r,v),Lk(),mk(),lr=De,$n(le),aa.transition=te}else r.current=m,xS();var Ne=Gl;if(Gl?(Gl=!1,Qo=r,uf=v):(uu=0,Km=null),N=r.pendingLanes,N===Je&&(cu=null),Ne||_y(r.current,!1),Nk(m.stateNode,u),Ms&&r.memoizedUpdaters.clear(),W3(),Xa(r,In()),a!==null)for(var Ae=r.onRecoverableError,Ie=0;Ie<a.length;Ie++){var He=a[Ie],dt=He.stack,Ut=He.digest;Ae(He.value,{componentStack:dt,digest:Ut})}if(Ym){Ym=!1;var Rt=Px;throw Px=null,Rt}return ts(uf,Bt)&&r.tag!==Bo&&oo(),N=r.pendingLanes,ts(N,Bt)?(v2(),r===Lx?df++:(df=0,Lx=r)):df=0,Ho(),HN(),null}function oo(){if(Qo!==null){var r=s1(uf),a=iR(Ki,r),o=aa.transition,u=Fs();try{return aa.transition=null,$n(a),mP()}finally{$n(u),aa.transition=o}}return!1}function fP(r){Ux.push(r),Gl||(Gl=!0,Wx(kl,function(){return oo(),null}))}function mP(){if(Qo===null)return!1;var r=Ax;Ax=null;var a=Qo,o=uf;if(Qo=null,uf=Je,(lr&(sa|Ds))!==Cn)throw new Error("Cannot flush passive effects while already rendering.");Vx=!0,qm=!1,Vk(o);var u=lr;lr|=Ds,P3(a.current),k3(a,a.current,o,r);{var m=Ux;Ux=[];for(var v=0;v<m.length;v++){var N=m[v];h3(a,N)}}jk(),_y(a.current,!0),lr=u,Ho(),qm?a===Km?uu++:(uu=0,Km=a):uu=0,Vx=!1,qm=!1,Dk(a);{var k=a.current.stateNode;k.effectDuration=0,k.passiveEffectDuration=0}return!0}function ky(r){return cu!==null&&cu.has(r)}function hP(r){cu===null?cu=new Set([r]):cu.add(r)}function pP(r){Ym||(Ym=!0,Px=r)}var vP=pP;function Ry(r,a,o){var u=Wl(o,a),m=wS(r,u,Bt),v=zo(r,m,Bt),N=_a();v!==null&&(ad(v,Bt,N),Xa(v,N))}function Vr(r,a,o){if(o3(o),pf(!1),r.tag===b){Ry(r,r,o);return}var u=null;for(u=a;u!==null;){if(u.tag===b){Ry(u,r,o);return}else if(u.tag===g){var m=u.type,v=u.stateNode;if(typeof m.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&!ky(v)){var N=Wl(o,r),k=ox(u,N,Bt),M=zo(u,k,Bt),te=_a();M!==null&&(ad(M,Bt,te),Xa(M,te));return}}u=u.return}c(`Internal React error: Attempted to capture a commit phase error inside a detached tree. This indicates a bug in React. Likely causes include deleting the same fiber more than once, committing an already-finished tree, or an inconsistent return pointer.

Error message:

%s`,o)}function gP(r,a,o){var u=r.pingCache;u!==null&&u.delete(a);var m=_a();t1(r,o),wP(r),Ta===r&&Ac(kn,o)&&(Rn===af||Rn===zm&&JN(kn)&&In()-_x<py?Yl(r,Je):Gm=Qt(Gm,o)),Xa(r,m)}function Ty(r,a){a===Fn&&(a=J3(r));var o=_a(),u=Ha(r,a);u!==null&&(ad(u,a,o),Xa(u,o))}function xP(r){var a=r.memoizedState,o=Fn;a!==null&&(o=a.retryLane),Ty(r,o)}function bP(r,a){var o=Fn,u;switch(r.tag){case ee:u=r.stateNode;var m=r.memoizedState;m!==null&&(o=m.retryLane);break;case W:u=r.stateNode;break;default:throw new Error("Pinged unknown suspense boundary type. This is probably a bug in React.")}u!==null&&u.delete(a),Ty(r,o)}function NP(r){return r<120?120:r<480?480:r<1080?1080:r<1920?1920:r<3e3?3e3:r<4320?4320:G3(r/1960)*1960}function DP(){if(df>q3)throw df=0,Lx=null,new Error("Maximum update depth exceeded. This can happen when a component repeatedly calls setState inside componentWillUpdate or componentDidUpdate. React limits the number of nested updates to prevent infinite loops.");uu>K3&&(uu=0,Km=null,c("Maximum update depth exceeded. This can happen when a component calls setState inside useEffect, but useEffect either doesn't have a dependency array, or one of the dependencies changes on every render."))}function SP(){Hs.flushLegacyContextWarning(),Hs.flushPendingUnsafeLifecycleWarnings()}function _y(r,a){yt(r),th(r,Uo,$3),a&&th(r,Rp,B3),th(r,Uo,M3),a&&th(r,Rp,F3),un()}function th(r,a,o){for(var u=r,m=null;u!==null;){var v=u.subtreeFlags&a;u!==m&&u.child!==null&&v!==Vt?u=u.child:((u.flags&a)!==Vt&&o(u),u.sibling!==null?u=u.sibling:u=m=u.return)}}var rh=null;function Py(r){{if((lr&sa)!==Cn||!(r.mode&or))return;var a=r.tag;if(a!==x&&a!==b&&a!==g&&a!==p&&a!==_&&a!==Q&&a!==z)return;var o=jt(r)||"ReactComponent";if(rh!==null){if(rh.has(o))return;rh.add(o)}else rh=new Set([o]);var u=Vn;try{yt(r),c("Can't perform a React state update on a component that hasn't mounted yet. This indicates that you have a side-effect in your render function that asynchronously later calls tries to update the component. Move this work to useEffect instead.")}finally{u?yt(r):un()}}}var $x;{var yP=null;$x=function(r,a,o){var u=Fy(yP,a);try{return zS(r,a,o)}catch(v){if(L_()||v!==null&&typeof v=="object"&&typeof v.then=="function")throw v;if(cm(),GD(),JS(r,a),Fy(a,u),a.mode&kr&&Hg(a),Yu(null,zS,null,r,a,o),nk()){var m=Op();typeof m=="object"&&m!==null&&m._suppressLogging&&typeof v=="object"&&v!==null&&!v._suppressLogging&&(v._suppressLogging=!0)}throw v}}}var Uy=!1,Bx;Bx=new Set;function OP(r){if(Ca&&!m2())switch(r.tag){case p:case _:case z:{var a=Gr&&jt(Gr)||"Unknown",o=a;if(!Bx.has(o)){Bx.add(o);var u=jt(r)||"Unknown";c("Cannot update a component (`%s`) while rendering a different component (`%s`). To locate the bad setState() call inside `%s`, follow the stack trace as described in https://reactjs.org/link/setstate-in-render",u,a,a)}break}case g:{Uy||(c("Cannot update during an existing state transition (such as within `render`). Render methods should be a pure function of props and state."),Uy=!0);break}}}function hf(r,a){if(Ms){var o=r.memoizedUpdaters;o.forEach(function(u){r1(r,u,a)})}}var Hx={};function Wx(r,a){{var o=Js.current;return o!==null?(o.push(a),Hx):BN(r,a)}}function Ay(r){if(r!==Hx)return dk(r)}function Ly(){return Js.current!==null}function EP(r){{if(r.mode&or){if(!fy())return}else if(!X3()||lr!==Cn||r.tag!==p&&r.tag!==_&&r.tag!==z)return;if(Js.current===null){var a=Vn;try{yt(r),c(`An update to %s inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act`,jt(r))}finally{a?yt(r):un()}}}}function wP(r){r.tag!==Bo&&fy()&&Js.current===null&&c(`A suspended resource finished loading inside a test, but the event was not wrapped in act(...).

When testing, code that resolves suspended data should be wrapped into act(...):

act(() => {
  /* finish loading suspended data */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act`)}function pf(r){xy=r}var Ss=null,du=null,CP=function(r){Ss=r};function fu(r){{if(Ss===null)return r;var a=Ss(r);return a===void 0?r:a.current}}function zx(r){return fu(r)}function Xx(r){{if(Ss===null)return r;var a=Ss(r);if(a===void 0){if(r!=null&&typeof r.render=="function"){var o=fu(r.render);if(r.render!==o){var u={$$typeof:J,render:o};return r.displayName!==void 0&&(u.displayName=r.displayName),u}}return r}return a.current}}function Vy(r,a){{if(Ss===null)return!1;var o=r.elementType,u=a.type,m=!1,v=typeof u=="object"&&u!==null?u.$$typeof:null;switch(r.tag){case g:{typeof u=="function"&&(m=!0);break}case p:{(typeof u=="function"||v===xe)&&(m=!0);break}case _:{(v===J||v===xe)&&(m=!0);break}case Q:case z:{(v===se||v===xe)&&(m=!0);break}default:return!1}if(m){var N=Ss(o);if(N!==void 0&&N===Ss(u))return!0}return!1}}function jy(r){{if(Ss===null||typeof WeakSet!="function")return;du===null&&(du=new WeakSet),du.add(r)}}var kP=function(r,a){{if(Ss===null)return;var o=a.staleFamilies,u=a.updatedFamilies;oo(),io(function(){Gx(r.current,u,o)})}},RP=function(r,a){{if(r.context!==ss)return;oo(),io(function(){vf(a,r,null,null)})}};function Gx(r,a,o){{var u=r.alternate,m=r.child,v=r.sibling,N=r.tag,k=r.type,M=null;switch(N){case p:case z:case g:M=k;break;case _:M=k.render;break}if(Ss===null)throw new Error("Expected resolveFamily to be set during hot reload.");var te=!1,le=!1;if(M!==null){var De=Ss(M);De!==void 0&&(o.has(De)?le=!0:a.has(De)&&(N===g?le=!0:te=!0))}if(du!==null&&(du.has(r)||u!==null&&du.has(u))&&(le=!0),le&&(r._debugNeedsRemount=!0),le||te){var Ne=Ha(r,Bt);Ne!==null&&Tn(Ne,r,Bt,Ir)}m!==null&&!le&&Gx(m,a,o),v!==null&&Gx(v,a,o)}}var TP=function(r,a){{var o=new Set,u=new Set(a.map(function(m){return m.current}));return Yx(r.current,u,o),o}};function Yx(r,a,o){{var u=r.child,m=r.sibling,v=r.tag,N=r.type,k=null;switch(v){case p:case z:case g:k=N;break;case _:k=N.render;break}var M=!1;k!==null&&a.has(k)&&(M=!0),M?_P(r,o):u!==null&&Yx(u,a,o),m!==null&&Yx(m,a,o)}}function _P(r,a){{var o=PP(r,a);if(o)return;for(var u=r;;){switch(u.tag){case w:a.add(u.stateNode);return;case E:a.add(u.stateNode.containerInfo);return;case b:a.add(u.stateNode.containerInfo);return}if(u.return===null)throw new Error("Expected to reach root first.");u=u.return}}}function PP(r,a){for(var o=r,u=!1;;){if(o.tag===w)u=!0,a.add(o.stateNode);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)return u;for(;o.sibling===null;){if(o.return===null||o.return===r)return u;o=o.return}o.sibling.return=o.return,o=o.sibling}return!1}var qx;{qx=!1;try{var Iy=Object.preventExtensions({})}catch{qx=!0}}function UP(r,a,o,u){this.tag=r,this.key=o,this.elementType=null,this.type=null,this.stateNode=null,this.return=null,this.child=null,this.sibling=null,this.index=0,this.ref=null,this.pendingProps=a,this.memoizedProps=null,this.updateQueue=null,this.memoizedState=null,this.dependencies=null,this.mode=u,this.flags=Vt,this.subtreeFlags=Vt,this.deletions=null,this.lanes=Je,this.childLanes=Je,this.alternate=null,this.actualDuration=Number.NaN,this.actualStartTime=Number.NaN,this.selfBaseDuration=Number.NaN,this.treeBaseDuration=Number.NaN,this.actualDuration=0,this.actualStartTime=-1,this.selfBaseDuration=0,this.treeBaseDuration=0,this._debugSource=null,this._debugOwner=null,this._debugNeedsRemount=!1,this._debugHookTypes=null,!qx&&typeof Object.preventExtensions=="function"&&Object.preventExtensions(this)}var is=function(r,a,o,u){return new UP(r,a,o,u)};function Kx(r){var a=r.prototype;return!!(a&&a.isReactComponent)}function AP(r){return typeof r=="function"&&!Kx(r)&&r.defaultProps===void 0}function LP(r){if(typeof r=="function")return Kx(r)?g:p;if(r!=null){var a=r.$$typeof;if(a===J)return _;if(a===se)return Q}return x}function Kl(r,a){var o=r.alternate;o===null?(o=is(r.tag,a,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o._debugSource=r._debugSource,o._debugOwner=r._debugOwner,o._debugHookTypes=r._debugHookTypes,o.alternate=r,r.alternate=o):(o.pendingProps=a,o.type=r.type,o.flags=Vt,o.subtreeFlags=Vt,o.deletions=null,o.actualDuration=0,o.actualStartTime=-1),o.flags=r.flags&Gi,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue;var u=r.dependencies;switch(o.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.selfBaseDuration=r.selfBaseDuration,o.treeBaseDuration=r.treeBaseDuration,o._debugNeedsRemount=r._debugNeedsRemount,o.tag){case x:case p:case z:o.type=fu(r.type);break;case g:o.type=zx(r.type);break;case _:o.type=Xx(r.type);break}return o}function VP(r,a){r.flags&=Gi|dn;var o=r.alternate;if(o===null)r.childLanes=Je,r.lanes=a,r.child=null,r.subtreeFlags=Vt,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null,r.selfBaseDuration=0,r.treeBaseDuration=0;else{r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=Vt,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type;var u=o.dependencies;r.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},r.selfBaseDuration=o.selfBaseDuration,r.treeBaseDuration=o.treeBaseDuration}return r}function jP(r,a,o){var u;return r===Z0?(u=or,a===!0&&(u|=Qr,u|=hi)):u=At,Ms&&(u|=kr),is(b,null,null,u)}function Jx(r,a,o,u,m,v){var N=x,k=r;if(typeof r=="function")Kx(r)?(N=g,k=zx(k)):k=fu(k);else if(typeof r=="string")N=w;else e:switch(r){case wa:return tl(o.children,m,v,a);case Ts:N=U,m|=Qr,(m&or)!==At&&(m|=hi);break;case pe:return IP(o,m,v,a);case Y:return MP(o,m,v,a);case ae:return FP(o,m,v,a);case we:return My(o,m,v,a);case Re:case je:case Ue:case Ze:case Se:default:{if(typeof r=="object"&&r!==null)switch(r.$$typeof){case L:N=G;break e;case Z:N=q;break e;case J:N=_,k=Xx(k);break e;case se:N=Q;break e;case xe:N=ce,k=null;break e}var M="";{(r===void 0||typeof r=="object"&&r!==null&&Object.keys(r).length===0)&&(M+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var te=u?jt(u):null;te&&(M+=`

Check the render method of \``+te+"`.")}throw new Error("Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) "+("but got: "+(r==null?r:typeof r)+"."+M))}}var le=is(N,o,a,m);return le.elementType=r,le.type=k,le.lanes=v,le._debugOwner=u,le}function Qx(r,a,o){var u=null;u=r._owner;var m=r.type,v=r.key,N=r.props,k=Jx(m,v,N,u,a,o);return k._debugSource=r._source,k._debugOwner=r._owner,k}function tl(r,a,o,u){var m=is(y,r,u,a);return m.lanes=o,m}function IP(r,a,o,u){typeof r.id!="string"&&c('Profiler must specify an "id" of type `string` as a prop. Received the type `%s` instead.',typeof r.id);var m=is(ne,r,u,a|kr);return m.elementType=pe,m.lanes=o,m.stateNode={effectDuration:0,passiveEffectDuration:0},m}function MP(r,a,o,u){var m=is(ee,r,u,a);return m.elementType=Y,m.lanes=o,m}function FP(r,a,o,u){var m=is(W,r,u,a);return m.elementType=ae,m.lanes=o,m}function My(r,a,o,u){var m=is(K,r,u,a);m.elementType=we,m.lanes=o;var v={isHidden:!1};return m.stateNode=v,m}function Zx(r,a,o){var u=is(R,r,null,a);return u.lanes=o,u}function $P(){var r=is(w,null,null,At);return r.elementType="DELETED",r}function BP(r){var a=is(A,null,null,At);return a.stateNode=r,a}function eb(r,a,o){var u=r.children!==null?r.children:[],m=is(E,u,r.key,a);return m.lanes=o,m.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},m}function Fy(r,a){return r===null&&(r=is(x,null,null,At)),r.tag=a.tag,r.key=a.key,r.elementType=a.elementType,r.type=a.type,r.stateNode=a.stateNode,r.return=a.return,r.child=a.child,r.sibling=a.sibling,r.index=a.index,r.ref=a.ref,r.pendingProps=a.pendingProps,r.memoizedProps=a.memoizedProps,r.updateQueue=a.updateQueue,r.memoizedState=a.memoizedState,r.dependencies=a.dependencies,r.mode=a.mode,r.flags=a.flags,r.subtreeFlags=a.subtreeFlags,r.deletions=a.deletions,r.lanes=a.lanes,r.childLanes=a.childLanes,r.alternate=a.alternate,r.actualDuration=a.actualDuration,r.actualStartTime=a.actualStartTime,r.selfBaseDuration=a.selfBaseDuration,r.treeBaseDuration=a.treeBaseDuration,r._debugSource=a._debugSource,r._debugOwner=a._debugOwner,r._debugNeedsRemount=a._debugNeedsRemount,r._debugHookTypes=a._debugHookTypes,r}function HP(r,a,o,u,m){this.tag=a,this.containerInfo=r,this.pendingChildren=null,this.current=null,this.pingCache=null,this.finishedWork=null,this.timeoutHandle=Lv,this.context=null,this.pendingContext=null,this.callbackNode=null,this.callbackPriority=Fn,this.eventTimes=av(Je),this.expirationTimes=av(Ir),this.pendingLanes=Je,this.suspendedLanes=Je,this.pingedLanes=Je,this.expiredLanes=Je,this.mutableReadLanes=Je,this.finishedLanes=Je,this.entangledLanes=Je,this.entanglements=av(Je),this.identifierPrefix=u,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null,this.effectDuration=0,this.passiveEffectDuration=0;{this.memoizedUpdaters=new Set;for(var v=this.pendingUpdatersLaneMap=[],N=0;N<Lp;N++)v.push(new Set)}switch(a){case Z0:this._debugRootType=o?"hydrateRoot()":"createRoot()";break;case Bo:this._debugRootType=o?"hydrate()":"render()";break}}function $y(r,a,o,u,m,v,N,k,M,te){var le=new HP(r,a,o,k,M),De=jP(a,v);le.current=De,De.stateNode=le;{var Ne={element:u,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null};De.memoizedState=Ne}return mg(De),le}var tb="18.3.1";function WP(r,a,o){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return Ke(u),{$$typeof:cn,key:u==null?null:""+u,children:r,containerInfo:a,implementation:o}}var rb,nb;rb=!1,nb={};function By(r){if(!r)return ss;var a=Ec(r),o=w_(a);if(a.tag===g){var u=a.type;if(gi(u))return pD(a,u,o)}return o}function zP(r,a){{var o=Ec(r);if(o===void 0){if(typeof r.render=="function")throw new Error("Unable to find node on an unmounted component.");var u=Object.keys(r).join(",");throw new Error("Argument appears to not be a ReactComponent. Keys: "+u)}var m=MN(o);if(m===null)return null;if(m.mode&Qr){var v=jt(o)||"Component";if(!nb[v]){nb[v]=!0;var N=Vn;try{yt(m),o.mode&Qr?c("%s is deprecated in StrictMode. %s was passed an instance of %s which is inside StrictMode. Instead, add a ref directly to the element you want to reference. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-find-node",a,a,v):c("%s is deprecated in StrictMode. %s was passed an instance of %s which renders StrictMode children. Instead, add a ref directly to the element you want to reference. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-find-node",a,a,v)}finally{N?yt(N):un()}}}return m.stateNode}}function Hy(r,a,o,u,m,v,N,k){var M=!1,te=null;return $y(r,a,M,te,o,u,m,v,N)}function Wy(r,a,o,u,m,v,N,k,M,te){var le=!0,De=$y(o,u,le,r,m,v,N,k,M);De.context=By(null);var Ne=De.current,Ae=_a(),Ie=Zo(Ne),He=ro(Ae,Ie);return He.callback=a??null,zo(Ne,He,Ie),Q3(De,Ie,Ae),De}function vf(r,a,o,u){bk(a,r);var m=a.current,v=_a(),N=Zo(m);Mk(N);var k=By(o);a.context===null?a.context=k:a.pendingContext=k,Ca&&Vn!==null&&!rb&&(rb=!0,c(`Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate.

Check the render method of %s.`,jt(Vn)||"Unknown"));var M=ro(v,N);M.payload={element:r},u=u===void 0?null:u,u!==null&&(typeof u!="function"&&c("render(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",u),M.callback=u);var te=zo(m,M,N);return te!==null&&(Tn(te,m,N,v),hm(te,m,N)),N}function nh(r){var a=r.current;if(!a.child)return null;switch(a.child.tag){case w:return a.child.stateNode;default:return a.child.stateNode}}function XP(r){switch(r.tag){case b:{var a=r.stateNode;if(y0(a)){var o=Yk(a);rP(a,o)}break}case ee:{io(function(){var m=Ha(r,Bt);if(m!==null){var v=_a();Tn(m,r,Bt,v)}});var u=Bt;ab(r,u);break}}}function zy(r,a){var o=r.memoizedState;o!==null&&o.dehydrated!==null&&(o.retryLane=eR(o.retryLane,a))}function ab(r,a){zy(r,a);var o=r.alternate;o&&zy(o,a)}function GP(r){if(r.tag===ee){var a=ed,o=Ha(r,a);if(o!==null){var u=_a();Tn(o,r,a,u)}ab(r,a)}}function YP(r){if(r.tag===ee){var a=Zo(r),o=Ha(r,a);if(o!==null){var u=_a();Tn(o,r,a,u)}ab(r,a)}}function Xy(r){var a=uk(r);return a===null?null:a.stateNode}var Gy=function(r){return null};function qP(r){return Gy(r)}var Yy=function(r){return!1};function KP(r){return Yy(r)}var qy=null,Ky=null,Jy=null,Qy=null,Zy=null,eO=null,tO=null,rO=null,nO=null;{var aO=function(r,a,o){var u=a[o],m=Kt(r)?r.slice():ot({},r);return o+1===a.length?(Kt(m)?m.splice(u,1):delete m[u],m):(m[u]=aO(r[u],a,o+1),m)},sO=function(r,a){return aO(r,a,0)},iO=function(r,a,o,u){var m=a[u],v=Kt(r)?r.slice():ot({},r);if(u+1===a.length){var N=o[u];v[N]=v[m],Kt(v)?v.splice(m,1):delete v[m]}else v[m]=iO(r[m],a,o,u+1);return v},oO=function(r,a,o){if(a.length!==o.length){d("copyWithRename() expects paths of the same length");return}else for(var u=0;u<o.length-1;u++)if(a[u]!==o[u]){d("copyWithRename() expects paths to be the same except for the deepest key");return}return iO(r,a,o,0)},lO=function(r,a,o,u){if(o>=a.length)return u;var m=a[o],v=Kt(r)?r.slice():ot({},r);return v[m]=lO(r[m],a,o+1,u),v},cO=function(r,a,o){return lO(r,a,0,o)},sb=function(r,a){for(var o=r.memoizedState;o!==null&&a>0;)o=o.next,a--;return o};qy=function(r,a,o,u){var m=sb(r,a);if(m!==null){var v=cO(m.memoizedState,o,u);m.memoizedState=v,m.baseState=v,r.memoizedProps=ot({},r.memoizedProps);var N=Ha(r,Bt);N!==null&&Tn(N,r,Bt,Ir)}},Ky=function(r,a,o){var u=sb(r,a);if(u!==null){var m=sO(u.memoizedState,o);u.memoizedState=m,u.baseState=m,r.memoizedProps=ot({},r.memoizedProps);var v=Ha(r,Bt);v!==null&&Tn(v,r,Bt,Ir)}},Jy=function(r,a,o,u){var m=sb(r,a);if(m!==null){var v=oO(m.memoizedState,o,u);m.memoizedState=v,m.baseState=v,r.memoizedProps=ot({},r.memoizedProps);var N=Ha(r,Bt);N!==null&&Tn(N,r,Bt,Ir)}},Qy=function(r,a,o){r.pendingProps=cO(r.memoizedProps,a,o),r.alternate&&(r.alternate.pendingProps=r.pendingProps);var u=Ha(r,Bt);u!==null&&Tn(u,r,Bt,Ir)},Zy=function(r,a){r.pendingProps=sO(r.memoizedProps,a),r.alternate&&(r.alternate.pendingProps=r.pendingProps);var o=Ha(r,Bt);o!==null&&Tn(o,r,Bt,Ir)},eO=function(r,a,o){r.pendingProps=oO(r.memoizedProps,a,o),r.alternate&&(r.alternate.pendingProps=r.pendingProps);var u=Ha(r,Bt);u!==null&&Tn(u,r,Bt,Ir)},tO=function(r){var a=Ha(r,Bt);a!==null&&Tn(a,r,Bt,Ir)},rO=function(r){Gy=r},nO=function(r){Yy=r}}function JP(r){var a=MN(r);return a===null?null:a.stateNode}function QP(r){return null}function ZP(){return Vn}function eU(r){var a=r.findFiberByHostInstance,o=e.ReactCurrentDispatcher;return xk({bundleType:r.bundleType,version:r.version,rendererPackageName:r.rendererPackageName,rendererConfig:r.rendererConfig,overrideHookState:qy,overrideHookStateDeletePath:Ky,overrideHookStateRenamePath:Jy,overrideProps:Qy,overridePropsDeletePath:Zy,overridePropsRenamePath:eO,setErrorHandler:rO,setSuspenseHandler:nO,scheduleUpdate:tO,currentDispatcherRef:o,findHostInstanceByFiber:JP,findFiberByHostInstance:a||QP,findHostInstancesForRefresh:TP,scheduleRefresh:kP,scheduleRoot:RP,setRefreshHandler:CP,getCurrentFiber:ZP,reconcilerVersion:tb})}var uO=typeof reportError=="function"?reportError:function(r){console.error(r)};function ib(r){this._internalRoot=r}ah.prototype.render=ib.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw new Error("Cannot update an unmounted root.");{typeof arguments[1]=="function"?c("render(...): does not support the second callback argument. To execute a side effect after rendering, declare it in a component body with useEffect()."):sh(arguments[1])?c("You passed a container to the second argument of root.render(...). You don't need to pass it again since you already passed it to create the root."):typeof arguments[1]<"u"&&c("You passed a second argument to root.render(...) but it only accepts one argument.");var o=a.containerInfo;if(o.nodeType!==qr){var u=Xy(a.current);u&&u.parentNode!==o&&c("render(...): It looks like the React-rendered content of the root container was removed without using React. This is not supported and will cause errors. Instead, call root.unmount() to empty a root's container.")}}vf(r,a,null,null)},ah.prototype.unmount=ib.prototype.unmount=function(){typeof arguments[0]=="function"&&c("unmount(...): does not support a callback argument. To execute a side effect after rendering, declare it in a component body with useEffect().");var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;Sy()&&c("Attempted to synchronously unmount a root while React was already rendering. React cannot finish unmounting the root until the current render has completed, which may lead to a race condition."),io(function(){vf(null,r,null,null)}),uD(a)}};function tU(r,a){if(!sh(r))throw new Error("createRoot(...): Target container is not a DOM element.");dO(r);var o=!1,u=!1,m="",v=uO;a!=null&&(a.hydrate?d("hydrate through createRoot is deprecated. Use ReactDOMClient.hydrateRoot(container, <App />) instead."):typeof a=="object"&&a!==null&&a.$$typeof===xn&&c(`You passed a JSX element to createRoot. You probably meant to call root.render instead. Example usage:

  let root = createRoot(domContainer);
  root.render(<App />);`),a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(m=a.identifierPrefix),a.onRecoverableError!==void 0&&(v=a.onRecoverableError),a.transitionCallbacks!==void 0&&a.transitionCallbacks);var N=Hy(r,Z0,null,o,u,m,v);X0(N.current,r);var k=r.nodeType===qr?r.parentNode:r;return Dd(k),new ib(N)}function ah(r){this._internalRoot=r}function rU(r){r&&gR(r)}ah.prototype.unstable_scheduleHydration=rU;function nU(r,a,o){if(!sh(r))throw new Error("hydrateRoot(...): Target container is not a DOM element.");dO(r),a===void 0&&c("Must provide initial children as second argument to hydrateRoot. Example usage: hydrateRoot(domContainer, <App />)");var u=o??null,m=o!=null&&o.hydratedSources||null,v=!1,N=!1,k="",M=uO;o!=null&&(o.unstable_strictMode===!0&&(v=!0),o.identifierPrefix!==void 0&&(k=o.identifierPrefix),o.onRecoverableError!==void 0&&(M=o.onRecoverableError));var te=Wy(a,null,r,Z0,u,v,N,k,M);if(X0(te.current,r),Dd(r),m)for(var le=0;le<m.length;le++){var De=m[le];o2(te,De)}return new ah(te)}function sh(r){return!!(r&&(r.nodeType===da||r.nodeType===js||r.nodeType===wo))}function gf(r){return!!(r&&(r.nodeType===da||r.nodeType===js||r.nodeType===wo||r.nodeType===qr&&r.nodeValue===" react-mount-point-unstable "))}function dO(r){r.nodeType===da&&r.tagName&&r.tagName.toUpperCase()==="BODY"&&c("createRoot(): Creating roots directly with document.body is discouraged, since its children are often manipulated by third-party scripts and browser extensions. This may lead to subtle reconciliation issues. Try using a container element created for your app."),Pd(r)&&(r._reactRootContainer?c("You are calling ReactDOMClient.createRoot() on a container that was previously passed to ReactDOM.render(). This is not supported."):c("You are calling ReactDOMClient.createRoot() on a container that has already been passed to createRoot() before. Instead, call root.render() on the existing root instead if you want to update it."))}var aU=e.ReactCurrentOwner,fO;fO=function(r){if(r._reactRootContainer&&r.nodeType!==qr){var a=Xy(r._reactRootContainer.current);a&&a.parentNode!==r&&c("render(...): It looks like the React-rendered content of this container was removed without using React. This is not supported and will cause errors. Instead, call ReactDOM.unmountComponentAtNode to empty a container.")}var o=!!r._reactRootContainer,u=ob(r),m=!!(u&&Fo(u));m&&!o&&c("render(...): Replacing React-rendered children with a new root component. If you intended to update the children of this node, you should instead have the existing children update their state and render the new components instead of calling ReactDOM.render."),r.nodeType===da&&r.tagName&&r.tagName.toUpperCase()==="BODY"&&c("render(): Rendering components directly into document.body is discouraged, since its children are often manipulated by third-party scripts and browser extensions. This may lead to subtle reconciliation issues. Try rendering into a container element created for your app.")};function ob(r){return r?r.nodeType===js?r.documentElement:r.firstChild:null}function mO(){}function sU(r,a,o,u,m){if(m){if(typeof u=="function"){var v=u;u=function(){var Ne=nh(N);v.call(Ne)}}var N=Wy(a,u,r,Bo,null,!1,!1,"",mO);r._reactRootContainer=N,X0(N.current,r);var k=r.nodeType===qr?r.parentNode:r;return Dd(k),io(),N}else{for(var M;M=r.lastChild;)r.removeChild(M);if(typeof u=="function"){var te=u;u=function(){var Ne=nh(le);te.call(Ne)}}var le=Hy(r,Bo,null,!1,!1,"",mO);r._reactRootContainer=le,X0(le.current,r);var De=r.nodeType===qr?r.parentNode:r;return Dd(De),io(function(){vf(a,le,o,u)}),le}}function iU(r,a){r!==null&&typeof r!="function"&&c("%s(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",a,r)}function ih(r,a,o,u,m){fO(o),iU(m===void 0?null:m,"render");var v=o._reactRootContainer,N;if(!v)N=sU(o,a,r,m,u);else{if(N=v,typeof m=="function"){var k=m;m=function(){var M=nh(N);k.call(M)}}vf(a,N,r,m)}return nh(N)}var hO=!1;function oU(r){{hO||(hO=!0,c("findDOMNode is deprecated and will be removed in the next major release. Instead, add a ref directly to the element you want to reference. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-find-node"));var a=aU.current;if(a!==null&&a.stateNode!==null){var o=a.stateNode._warnedAboutRefsInRender;o||c("%s is accessing findDOMNode inside its render(). render() should be a pure function of props and state. It should never access something that requires stale data from the previous render, such as refs. Move this logic to componentDidMount and componentDidUpdate instead.",mr(a.type)||"A component"),a.stateNode._warnedAboutRefsInRender=!0}}return r==null?null:r.nodeType===da?r:zP(r,"findDOMNode")}function lU(r,a,o){if(c("ReactDOM.hydrate is no longer supported in React 18. Use hydrateRoot instead. Until you switch to the new API, your app will behave as if it's running React 17. Learn more: https://reactjs.org/link/switch-to-createroot"),!gf(a))throw new Error("Target container is not a DOM element.");{var u=Pd(a)&&a._reactRootContainer===void 0;u&&c("You are calling ReactDOM.hydrate() on a container that was previously passed to ReactDOMClient.createRoot(). This is not supported. Did you mean to call hydrateRoot(container, element)?")}return ih(null,r,a,!0,o)}function cU(r,a,o){if(c("ReactDOM.render is no longer supported in React 18. Use createRoot instead. Until you switch to the new API, your app will behave as if it's running React 17. Learn more: https://reactjs.org/link/switch-to-createroot"),!gf(a))throw new Error("Target container is not a DOM element.");{var u=Pd(a)&&a._reactRootContainer===void 0;u&&c("You are calling ReactDOM.render() on a container that was previously passed to ReactDOMClient.createRoot(). This is not supported. Did you mean to call root.render(element)?")}return ih(null,r,a,!1,o)}function uU(r,a,o,u){if(c("ReactDOM.unstable_renderSubtreeIntoContainer() is no longer supported in React 18. Consider using a portal instead. Until you switch to the createRoot API, your app will behave as if it's running React 17. Learn more: https://reactjs.org/link/switch-to-createroot"),!gf(o))throw new Error("Target container is not a DOM element.");if(r==null||!ak(r))throw new Error("parentComponent must be a valid React Component");return ih(r,a,o,!1,u)}var pO=!1;function dU(r){if(pO||(pO=!0,c("unmountComponentAtNode is deprecated and will be removed in the next major release. Switch to the createRoot API. Learn more: https://reactjs.org/link/switch-to-createroot")),!gf(r))throw new Error("unmountComponentAtNode(...): Target container is not a DOM element.");{var a=Pd(r)&&r._reactRootContainer===void 0;a&&c("You are calling ReactDOM.unmountComponentAtNode() on a container that was previously passed to ReactDOMClient.createRoot(). This is not supported. Did you mean to call root.unmount()?")}if(r._reactRootContainer){{var o=ob(r),u=o&&!Fo(o);u&&c("unmountComponentAtNode(): The node you're attempting to unmount was rendered by another copy of React.")}return io(function(){ih(null,null,r,!1,function(){r._reactRootContainer=null,uD(r)})}),!0}else{{var m=ob(r),v=!!(m&&Fo(m)),N=r.nodeType===da&&gf(r.parentNode)&&!!r.parentNode._reactRootContainer;v&&c("unmountComponentAtNode(): The node you're attempting to unmount was rendered by React and is not a top-level container. %s",N?"You may have accidentally passed in a React root node instead of its container.":"Instead, have the parent component update its state and rerender in order to remove this component.")}return!1}}oR(XP),cR(GP),uR(YP),dR(Fs),fR(aR),(typeof Map!="function"||Map.prototype==null||typeof Map.prototype.forEach!="function"||typeof Set!="function"||Set.prototype==null||typeof Set.prototype.clear!="function"||typeof Set.prototype.forEach!="function")&&c("React depends on Map and Set built-in types. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),h(m5),qe(Ix,nP,io);function fU(r,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!sh(a))throw new Error("Target container is not a DOM element.");return WP(r,a,null,o)}function mU(r,a,o,u){return uU(r,a,o,u)}var lb={usingClientEntryPoint:!1,Events:[Fo,Hc,G0,C,V,Ix]};function hU(r,a){return lb.usingClientEntryPoint||c('You are importing createRoot from "react-dom" which is not supported. You should instead import it from "react-dom/client".'),tU(r,a)}function pU(r,a,o){return lb.usingClientEntryPoint||c('You are importing hydrateRoot from "react-dom" which is not supported. You should instead import it from "react-dom/client".'),nU(r,a,o)}function vU(r){return Sy()&&c("flushSync was called from inside a lifecycle method. React cannot flush when React is already rendering. Consider moving this call to a scheduler task or micro task."),io(r)}var gU=eU({findFiberByHostInstance:Ll,bundleType:1,version:tb,rendererPackageName:"react-dom"});if(!gU&&ze&&window.top===window.self&&(navigator.userAgent.indexOf("Chrome")>-1&&navigator.userAgent.indexOf("Edge")===-1||navigator.userAgent.indexOf("Firefox")>-1)){var vO=window.location.protocol;/^(https?|file):$/.test(vO)&&console.info("%cDownload the React DevTools for a better development experience: https://reactjs.org/link/react-devtools"+(vO==="file:"?`
You might need to use a local HTTP server (instead of file://): https://reactjs.org/link/react-devtools-faq`:""),"font-weight:bold")}Ga.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lb,Ga.createPortal=fU,Ga.createRoot=hU,Ga.findDOMNode=oU,Ga.flushSync=vU,Ga.hydrate=lU,Ga.hydrateRoot=pU,Ga.render=cU,Ga.unmountComponentAtNode=dU,Ga.unstable_batchedUpdates=Ix,Ga.unstable_renderSubtreeIntoContainer=mU,Ga.version=tb,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)})(),Ga}var OO;function wU(){return OO||(OO=1,db.exports=EU()),db.exports}var EO;function CU(){if(EO)return lh;EO=1;var t=wU();{var n=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;lh.createRoot=function(e,s){n.usingClientEntryPoint=!0;try{return t.createRoot(e,s)}finally{n.usingClientEntryPoint=!1}},lh.hydrateRoot=function(e,s,i){n.usingClientEntryPoint=!0;try{return t.hydrateRoot(e,s,i)}finally{n.usingClientEntryPoint=!1}}}return lh}var kU=CU();const RU=BE(kU);/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var wO="popstate";function TU(t={}){function n(s,i){let{pathname:d,search:c,hash:f}=s.location;return Rb("",{pathname:d,search:c,hash:f},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function e(s,i){return typeof i=="string"?i:Vf(i)}return PU(n,e,null,t)}function Yr(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function si(t,n){if(!t){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function _U(){return Math.random().toString(36).substring(2,10)}function CO(t,n){return{usr:t.state,key:t.key,idx:n}}function Rb(t,n,e=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof n=="string"?Ou(n):n,state:e,key:n&&n.key||s||_U()}}function Vf({pathname:t="/",search:n="",hash:e=""}){return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),e&&e!=="#"&&(t+=e.charAt(0)==="#"?e:"#"+e),t}function Ou(t){let n={};if(t){let e=t.indexOf("#");e>=0&&(n.hash=t.substring(e),t=t.substring(0,e));let s=t.indexOf("?");s>=0&&(n.search=t.substring(s),t=t.substring(0,s)),t&&(n.pathname=t)}return n}function PU(t,n,e,s={}){let{window:i=document.defaultView,v5Compat:d=!1}=s,c=i.history,f="POP",p=null,g=x();g==null&&(g=0,c.replaceState({...c.state,idx:g},""));function x(){return(c.state||{idx:null}).idx}function b(){f="POP";let U=x(),q=U==null?null:U-g;g=U,p&&p({action:f,location:y.location,delta:q})}function E(U,q){f="PUSH";let G=Rb(y.location,U,q);g=x()+1;let _=CO(G,g),ne=y.createHref(G);try{c.pushState(_,"",ne)}catch(ee){if(ee instanceof DOMException&&ee.name==="DataCloneError")throw ee;i.location.assign(ne)}d&&p&&p({action:f,location:y.location,delta:1})}function w(U,q){f="REPLACE";let G=Rb(y.location,U,q);g=x();let _=CO(G,g),ne=y.createHref(G);c.replaceState(_,"",ne),d&&p&&p({action:f,location:y.location,delta:0})}function R(U){return UU(U)}let y={get action(){return f},get location(){return t(i,c)},listen(U){if(p)throw new Error("A history only accepts one active listener");return i.addEventListener(wO,b),p=U,()=>{i.removeEventListener(wO,b),p=null}},createHref(U){return n(i,U)},createURL:R,encodeLocation(U){let q=R(U);return{pathname:q.pathname,search:q.search,hash:q.hash}},push:E,replace:w,go(U){return c.go(U)}};return y}function UU(t,n=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),Yr(e,"No window.location.(origin|href) available to create URL");let s=typeof t=="string"?t:Vf(t);return s=s.replace(/ $/,"%20"),!n&&s.startsWith("//")&&(s=e+s),new URL(s,e)}function HE(t,n,e="/"){return AU(t,n,e,!1)}function AU(t,n,e,s){let i=typeof n=="string"?Ou(n):n,d=ho(i.pathname||"/",e);if(d==null)return null;let c=WE(t);LU(c);let f=null;for(let p=0;f==null&&p<c.length;++p){let g=XU(d);f=WU(c[p],g,s)}return f}function WE(t,n=[],e=[],s="",i=!1){let d=(c,f,p=i,g)=>{let x={relativePath:g===void 0?c.path||"":g,caseSensitive:c.caseSensitive===!0,childrenIndex:f,route:c};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(s)&&p)return;Yr(x.relativePath.startsWith(s),`Absolute route path "${x.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(s.length)}let b=uo([s,x.relativePath]),E=e.concat(x);c.children&&c.children.length>0&&(Yr(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${b}".`),WE(c.children,n,E,b,p)),!(c.path==null&&!c.index)&&n.push({path:b,score:BU(b,c.index),routesMeta:E})};return t.forEach((c,f)=>{if(c.path===""||!c.path?.includes("?"))d(c,f);else for(let p of zE(c.path))d(c,f,!0,p)}),n}function zE(t){let n=t.split("/");if(n.length===0)return[];let[e,...s]=n,i=e.endsWith("?"),d=e.replace(/\?$/,"");if(s.length===0)return i?[d,""]:[d];let c=zE(s.join("/")),f=[];return f.push(...c.map(p=>p===""?d:[d,p].join("/"))),i&&f.push(...c),f.map(p=>t.startsWith("/")&&p===""?"/":p)}function LU(t){t.sort((n,e)=>n.score!==e.score?e.score-n.score:HU(n.routesMeta.map(s=>s.childrenIndex),e.routesMeta.map(s=>s.childrenIndex)))}var VU=/^:[\w-]+$/,jU=3,IU=2,MU=1,FU=10,$U=-2,kO=t=>t==="*";function BU(t,n){let e=t.split("/"),s=e.length;return e.some(kO)&&(s+=$U),n&&(s+=IU),e.filter(i=>!kO(i)).reduce((i,d)=>i+(VU.test(d)?jU:d===""?MU:FU),s)}function HU(t,n){return t.length===n.length&&t.slice(0,-1).every((s,i)=>s===n[i])?t[t.length-1]-n[n.length-1]:0}function WU(t,n,e=!1){let{routesMeta:s}=t,i={},d="/",c=[];for(let f=0;f<s.length;++f){let p=s[f],g=f===s.length-1,x=d==="/"?n:n.slice(d.length)||"/",b=Th({path:p.relativePath,caseSensitive:p.caseSensitive,end:g},x),E=p.route;if(!b&&g&&e&&!s[s.length-1].route.index&&(b=Th({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},x)),!b)return null;Object.assign(i,b.params),c.push({params:i,pathname:uo([d,b.pathname]),pathnameBase:KU(uo([d,b.pathnameBase])),route:E}),b.pathnameBase!=="/"&&(d=uo([d,b.pathnameBase]))}return c}function Th(t,n){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[e,s]=zU(t.path,t.caseSensitive,t.end),i=n.match(e);if(!i)return null;let d=i[0],c=d.replace(/(.)\/+$/,"$1"),f=i.slice(1);return{params:s.reduce((g,{paramName:x,isOptional:b},E)=>{if(x==="*"){let R=f[E]||"";c=d.slice(0,d.length-R.length).replace(/(.)\/+$/,"$1")}const w=f[E];return b&&!w?g[x]=void 0:g[x]=(w||"").replace(/%2F/g,"/"),g},{}),pathname:d,pathnameBase:c,pattern:t}}function zU(t,n=!1,e=!0){si(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,f,p)=>(s.push({paramName:f,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(s.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,n?void 0:"i"),s]}function XU(t){try{return t.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return si(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),t}}function ho(t,n){if(n==="/")return t;if(!t.toLowerCase().startsWith(n.toLowerCase()))return null;let e=n.endsWith("/")?n.length-1:n.length,s=t.charAt(e);return s&&s!=="/"?null:t.slice(e)||"/"}function GU(t,n="/"){let{pathname:e,search:s="",hash:i=""}=typeof t=="string"?Ou(t):t;return{pathname:e?e.startsWith("/")?e:YU(e,n):n,search:JU(s),hash:QU(i)}}function YU(t,n){let e=n.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?e.length>1&&e.pop():i!=="."&&e.push(i)}),e.length>1?e.join("/"):"/"}function hb(t,n,e,s){return`Cannot include a '${t}' character in a manually specified \`to.${n}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function qU(t){return t.filter((n,e)=>e===0||n.route.path&&n.route.path.length>0)}function XE(t){let n=qU(t);return n.map((e,s)=>s===n.length-1?e.pathname:e.pathnameBase)}function GE(t,n,e,s=!1){let i;typeof t=="string"?i=Ou(t):(i={...t},Yr(!i.pathname||!i.pathname.includes("?"),hb("?","pathname","search",i)),Yr(!i.pathname||!i.pathname.includes("#"),hb("#","pathname","hash",i)),Yr(!i.search||!i.search.includes("#"),hb("#","search","hash",i)));let d=t===""||i.pathname==="",c=d?"/":i.pathname,f;if(c==null)f=e;else{let b=n.length-1;if(!s&&c.startsWith("..")){let E=c.split("/");for(;E[0]==="..";)E.shift(),b-=1;i.pathname=E.join("/")}f=b>=0?n[b]:"/"}let p=GU(i,f),g=c&&c!=="/"&&c.endsWith("/"),x=(d||c===".")&&e.endsWith("/");return!p.pathname.endsWith("/")&&(g||x)&&(p.pathname+="/"),p}var uo=t=>t.join("/").replace(/\/\/+/g,"/"),KU=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),JU=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,QU=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function ZU(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var YE=["POST","PUT","PATCH","DELETE"];new Set(YE);var e4=["GET",...YE];new Set(e4);var Eu=I.createContext(null);Eu.displayName="DataRouter";var Hh=I.createContext(null);Hh.displayName="DataRouterState";I.createContext(!1);var qE=I.createContext({isTransitioning:!1});qE.displayName="ViewTransition";var t4=I.createContext(new Map);t4.displayName="Fetchers";var r4=I.createContext(null);r4.displayName="Await";var _i=I.createContext(null);_i.displayName="Navigation";var Xf=I.createContext(null);Xf.displayName="Location";var vo=I.createContext({outlet:null,matches:[],isDataRoute:!1});vo.displayName="Route";var Kb=I.createContext(null);Kb.displayName="RouteError";function n4(t,{relative:n}={}){Yr(Gf(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:s}=I.useContext(_i),{hash:i,pathname:d,search:c}=Yf(t,{relative:n}),f=d;return e!=="/"&&(f=d==="/"?e:uo([e,d])),s.createHref({pathname:f,search:c,hash:i})}function Gf(){return I.useContext(Xf)!=null}function Oa(){return Yr(Gf(),"useLocation() may be used only in the context of a <Router> component."),I.useContext(Xf).location}var KE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function JE(t){I.useContext(_i).static||I.useLayoutEffect(t)}function fl(){let{isDataRoute:t}=I.useContext(vo);return t?v4():a4()}function a4(){Yr(Gf(),"useNavigate() may be used only in the context of a <Router> component.");let t=I.useContext(Eu),{basename:n,navigator:e}=I.useContext(_i),{matches:s}=I.useContext(vo),{pathname:i}=Oa(),d=JSON.stringify(XE(s)),c=I.useRef(!1);return JE(()=>{c.current=!0}),I.useCallback((p,g={})=>{if(si(c.current,KE),!c.current)return;if(typeof p=="number"){e.go(p);return}let x=GE(p,JSON.parse(d),i,g.relative==="path");t==null&&n!=="/"&&(x.pathname=x.pathname==="/"?n:uo([n,x.pathname])),(g.replace?e.replace:e.push)(x,g.state,g)},[n,e,d,i,t])}I.createContext(null);function Yf(t,{relative:n}={}){let{matches:e}=I.useContext(vo),{pathname:s}=Oa(),i=JSON.stringify(XE(e));return I.useMemo(()=>GE(t,JSON.parse(i),s,n==="path"),[t,i,s,n])}function s4(t,n){return QE(t,n)}function QE(t,n,e,s,i){Yr(Gf(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:d}=I.useContext(_i),{matches:c}=I.useContext(vo),f=c[c.length-1],p=f?f.params:{},g=f?f.pathname:"/",x=f?f.pathnameBase:"/",b=f&&f.route;{let G=b&&b.path||"";ZE(g,!b||G.endsWith("*")||G.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${G}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${G}"> to <Route path="${G==="/"?"*":`${G}/*`}">.`)}let E=Oa(),w;if(n){let G=typeof n=="string"?Ou(n):n;Yr(x==="/"||G.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${G.pathname}" was given in the \`location\` prop.`),w=G}else w=E;let R=w.pathname||"/",y=R;if(x!=="/"){let G=x.replace(/^\//,"").split("/");y="/"+R.replace(/^\//,"").split("/").slice(G.length).join("/")}let U=HE(t,{pathname:y});si(b||U!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),si(U==null||U[U.length-1].route.element!==void 0||U[U.length-1].route.Component!==void 0||U[U.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let q=u4(U&&U.map(G=>Object.assign({},G,{params:Object.assign({},p,G.params),pathname:uo([x,d.encodeLocation?d.encodeLocation(G.pathname).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?x:uo([x,d.encodeLocation?d.encodeLocation(G.pathnameBase).pathname:G.pathnameBase])})),c,e,s,i);return n&&q?I.createElement(Xf.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},q):q}function i4(){let t=p4(),n=ZU(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),e=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:s},d={padding:"2px 4px",backgroundColor:s},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=I.createElement(I.Fragment,null,I.createElement("p",null," Hey developer "),I.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",I.createElement("code",{style:d},"ErrorBoundary")," or"," ",I.createElement("code",{style:d},"errorElement")," prop on your route.")),I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},n),e?I.createElement("pre",{style:i},e):null,c)}var o4=I.createElement(i4,null),l4=class extends I.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){this.props.unstable_onError?this.props.unstable_onError(t,n):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?I.createElement(vo.Provider,{value:this.props.routeContext},I.createElement(Kb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function c4({routeContext:t,match:n,children:e}){let s=I.useContext(Eu);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),I.createElement(vo.Provider,{value:t},e)}function u4(t,n=[],e=null,s=null,i=null){if(t==null){if(!e)return null;if(e.errors)t=e.matches;else if(n.length===0&&!e.initialized&&e.matches.length>0)t=e.matches;else return null}let d=t,c=e?.errors;if(c!=null){let g=d.findIndex(x=>x.route.id&&c?.[x.route.id]!==void 0);Yr(g>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),d=d.slice(0,Math.min(d.length,g+1))}let f=!1,p=-1;if(e)for(let g=0;g<d.length;g++){let x=d[g];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(p=g),x.route.id){let{loaderData:b,errors:E}=e,w=x.route.loader&&!b.hasOwnProperty(x.route.id)&&(!E||E[x.route.id]===void 0);if(x.route.lazy||w){f=!0,p>=0?d=d.slice(0,p+1):d=[d[0]];break}}}return d.reduceRight((g,x,b)=>{let E,w=!1,R=null,y=null;e&&(E=c&&x.route.id?c[x.route.id]:void 0,R=x.route.errorElement||o4,f&&(p<0&&b===0?(ZE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,y=null):p===b&&(w=!0,y=x.route.hydrateFallbackElement||null)));let U=n.concat(d.slice(0,b+1)),q=()=>{let G;return E?G=R:w?G=y:x.route.Component?G=I.createElement(x.route.Component,null):x.route.element?G=x.route.element:G=g,I.createElement(c4,{match:x,routeContext:{outlet:g,matches:U,isDataRoute:e!=null},children:G})};return e&&(x.route.ErrorBoundary||x.route.errorElement||b===0)?I.createElement(l4,{location:e.location,revalidation:e.revalidation,component:R,error:E,children:q(),routeContext:{outlet:null,matches:U,isDataRoute:!0},unstable_onError:s}):q()},null)}function Jb(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function d4(t){let n=I.useContext(Eu);return Yr(n,Jb(t)),n}function f4(t){let n=I.useContext(Hh);return Yr(n,Jb(t)),n}function m4(t){let n=I.useContext(vo);return Yr(n,Jb(t)),n}function Qb(t){let n=m4(t),e=n.matches[n.matches.length-1];return Yr(e.route.id,`${t} can only be used on routes that contain a unique "id"`),e.route.id}function h4(){return Qb("useRouteId")}function p4(){let t=I.useContext(Kb),n=f4("useRouteError"),e=Qb("useRouteError");return t!==void 0?t:n.errors?.[e]}function v4(){let{router:t}=d4("useNavigate"),n=Qb("useNavigate"),e=I.useRef(!1);return JE(()=>{e.current=!0}),I.useCallback(async(i,d={})=>{si(e.current,KE),e.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:n,...d}))},[t,n])}var RO={};function ZE(t,n,e){!n&&!RO[t]&&(RO[t]=!0,si(!1,e))}I.memo(g4);function g4({routes:t,future:n,state:e,unstable_onError:s}){return QE(t,void 0,e,s,n)}function ls(t){Yr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function x4({basename:t="/",children:n=null,location:e,navigationType:s="POP",navigator:i,static:d=!1}){Yr(!Gf(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),f=I.useMemo(()=>({basename:c,navigator:i,static:d,future:{}}),[c,i,d]);typeof e=="string"&&(e=Ou(e));let{pathname:p="/",search:g="",hash:x="",state:b=null,key:E="default"}=e,w=I.useMemo(()=>{let R=ho(p,c);return R==null?null:{location:{pathname:R,search:g,hash:x,state:b,key:E},navigationType:s}},[c,p,g,x,b,E,s]);return si(w!=null,`<Router basename="${c}"> is not able to match the URL "${p}${g}${x}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:I.createElement(_i.Provider,{value:f},I.createElement(Xf.Provider,{children:n,value:w}))}function TO({children:t,location:n}){return s4(Tb(t),n)}function Tb(t,n=[]){let e=[];return I.Children.forEach(t,(s,i)=>{if(!I.isValidElement(s))return;let d=[...n,i];if(s.type===I.Fragment){e.push.apply(e,Tb(s.props.children,d));return}Yr(s.type===ls,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Yr(!s.props.index||!s.props.children,"An index route cannot have child routes.");let c={id:s.props.id||d.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=Tb(s.props.children,d)),e.push(c)}),e}var yh="get",Oh="application/x-www-form-urlencoded";function Wh(t){return t!=null&&typeof t.tagName=="string"}function b4(t){return Wh(t)&&t.tagName.toLowerCase()==="button"}function N4(t){return Wh(t)&&t.tagName.toLowerCase()==="form"}function D4(t){return Wh(t)&&t.tagName.toLowerCase()==="input"}function S4(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function y4(t,n){return t.button===0&&(!n||n==="_self")&&!S4(t)}function _b(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((n,e)=>{let s=t[e];return n.concat(Array.isArray(s)?s.map(i=>[e,i]):[[e,s]])},[]))}function O4(t,n){let e=_b(t);return n&&n.forEach((s,i)=>{e.has(i)||n.getAll(i).forEach(d=>{e.append(i,d)})}),e}var ch=null;function E4(){if(ch===null)try{new FormData(document.createElement("form"),0),ch=!1}catch{ch=!0}return ch}var w4=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function pb(t){return t!=null&&!w4.has(t)?(si(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Oh}"`),null):t}function C4(t,n){let e,s,i,d,c;if(N4(t)){let f=t.getAttribute("action");s=f?ho(f,n):null,e=t.getAttribute("method")||yh,i=pb(t.getAttribute("enctype"))||Oh,d=new FormData(t)}else if(b4(t)||D4(t)&&(t.type==="submit"||t.type==="image")){let f=t.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=t.getAttribute("formaction")||f.getAttribute("action");if(s=p?ho(p,n):null,e=t.getAttribute("formmethod")||f.getAttribute("method")||yh,i=pb(t.getAttribute("formenctype"))||pb(f.getAttribute("enctype"))||Oh,d=new FormData(f,t),!E4()){let{name:g,type:x,value:b}=t;if(x==="image"){let E=g?`${g}.`:"";d.append(`${E}x`,"0"),d.append(`${E}y`,"0")}else g&&d.append(g,b)}}else{if(Wh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=yh,s=null,i=Oh,c=t}return d&&i==="text/plain"&&(c=d,d=void 0),{action:s,method:e.toLowerCase(),encType:i,formData:d,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Zb(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function k4(t,n,e){let s=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return s.pathname==="/"?s.pathname=`_root.${e}`:n&&ho(s.pathname,n)==="/"?s.pathname=`${n.replace(/\/$/,"")}/_root.${e}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${e}`,s}async function R4(t,n){if(t.id in n)return n[t.id];try{let e=await import(t.module);return n[t.id]=e,e}catch(e){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function T4(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function _4(t,n,e){let s=await Promise.all(t.map(async i=>{let d=n.routes[i.route.id];if(d){let c=await R4(d,e);return c.links?c.links():[]}return[]}));return L4(s.flat(1).filter(T4).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function _O(t,n,e,s,i,d){let c=(p,g)=>e[g]?p.route.id!==e[g].route.id:!0,f=(p,g)=>e[g].pathname!==p.pathname||e[g].route.path?.endsWith("*")&&e[g].params["*"]!==p.params["*"];return d==="assets"?n.filter((p,g)=>c(p,g)||f(p,g)):d==="data"?n.filter((p,g)=>{let x=s.routes[p.route.id];if(!x||!x.hasLoader)return!1;if(c(p,g)||f(p,g))return!0;if(p.route.shouldRevalidate){let b=p.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function P4(t,n,{includeHydrateFallback:e}={}){return U4(t.map(s=>{let i=n.routes[s.route.id];if(!i)return[];let d=[i.module];return i.clientActionModule&&(d=d.concat(i.clientActionModule)),i.clientLoaderModule&&(d=d.concat(i.clientLoaderModule)),e&&i.hydrateFallbackModule&&(d=d.concat(i.hydrateFallbackModule)),i.imports&&(d=d.concat(i.imports)),d}).flat(1))}function U4(t){return[...new Set(t)]}function A4(t){let n={},e=Object.keys(t).sort();for(let s of e)n[s]=t[s];return n}function L4(t,n){let e=new Set;return new Set(n),t.reduce((s,i)=>{let d=JSON.stringify(A4(i));return e.has(d)||(e.add(d),s.push({key:d,link:i})),s},[])}function ew(){let t=I.useContext(Eu);return Zb(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function V4(){let t=I.useContext(Hh);return Zb(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var eN=I.createContext(void 0);eN.displayName="FrameworkContext";function tw(){let t=I.useContext(eN);return Zb(t,"You must render this element inside a <HydratedRouter> element"),t}function j4(t,n){let e=I.useContext(eN),[s,i]=I.useState(!1),[d,c]=I.useState(!1),{onFocus:f,onBlur:p,onMouseEnter:g,onMouseLeave:x,onTouchStart:b}=n,E=I.useRef(null);I.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let y=q=>{q.forEach(G=>{c(G.isIntersecting)})},U=new IntersectionObserver(y,{threshold:.5});return E.current&&U.observe(E.current),()=>{U.disconnect()}}},[t]),I.useEffect(()=>{if(s){let y=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(y)}}},[s]);let w=()=>{i(!0)},R=()=>{i(!1),c(!1)};return e?t!=="intent"?[d,E,{}]:[d,E,{onFocus:bf(f,w),onBlur:bf(p,R),onMouseEnter:bf(g,w),onMouseLeave:bf(x,R),onTouchStart:bf(b,w)}]:[!1,E,{}]}function bf(t,n){return e=>{t&&t(e),e.defaultPrevented||n(e)}}function I4({page:t,...n}){let{router:e}=ew(),s=I.useMemo(()=>HE(e.routes,t,e.basename),[e.routes,t,e.basename]);return s?I.createElement(F4,{page:t,matches:s,...n}):null}function M4(t){let{manifest:n,routeModules:e}=tw(),[s,i]=I.useState([]);return I.useEffect(()=>{let d=!1;return _4(t,n,e).then(c=>{d||i(c)}),()=>{d=!0}},[t,n,e]),s}function F4({page:t,matches:n,...e}){let s=Oa(),{manifest:i,routeModules:d}=tw(),{basename:c}=ew(),{loaderData:f,matches:p}=V4(),g=I.useMemo(()=>_O(t,n,p,i,s,"data"),[t,n,p,i,s]),x=I.useMemo(()=>_O(t,n,p,i,s,"assets"),[t,n,p,i,s]),b=I.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let R=new Set,y=!1;if(n.forEach(q=>{let G=i.routes[q.route.id];!G||!G.hasLoader||(!g.some(_=>_.route.id===q.route.id)&&q.route.id in f&&d[q.route.id]?.shouldRevalidate||G.hasClientLoader?y=!0:R.add(q.route.id))}),R.size===0)return[];let U=k4(t,c,"data");return y&&R.size>0&&U.searchParams.set("_routes",n.filter(q=>R.has(q.route.id)).map(q=>q.route.id).join(",")),[U.pathname+U.search]},[c,f,s,i,g,n,t,d]),E=I.useMemo(()=>P4(x,i),[x,i]),w=M4(x);return I.createElement(I.Fragment,null,b.map(R=>I.createElement("link",{key:R,rel:"prefetch",as:"fetch",href:R,...e})),E.map(R=>I.createElement("link",{key:R,rel:"modulepreload",href:R,...e})),w.map(({key:R,link:y})=>I.createElement("link",{key:R,nonce:e.nonce,...y})))}function $4(...t){return n=>{t.forEach(e=>{typeof e=="function"?e(n):e!=null&&(e.current=n)})}}var rw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{rw&&(window.__reactRouterVersion="7.8.2")}catch{}function B4({basename:t,children:n,window:e}){let s=I.useRef();s.current==null&&(s.current=TU({window:e,v5Compat:!0}));let i=s.current,[d,c]=I.useState({action:i.action,location:i.location}),f=I.useCallback(p=>{I.startTransition(()=>c(p))},[c]);return I.useLayoutEffect(()=>i.listen(f),[i,f]),I.createElement(x4,{basename:t,children:n,location:d.location,navigationType:d.action,navigator:i})}var nw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,aw=I.forwardRef(function({onClick:n,discover:e="render",prefetch:s="none",relative:i,reloadDocument:d,replace:c,state:f,target:p,to:g,preventScrollReset:x,viewTransition:b,...E},w){let{basename:R}=I.useContext(_i),y=typeof g=="string"&&nw.test(g),U,q=!1;if(typeof g=="string"&&y&&(U=g,rw))try{let S=new URL(window.location.href),A=g.startsWith("//")?new URL(S.protocol+g):new URL(g),W=ho(A.pathname,R);A.origin===S.origin&&W!=null?g=W+A.search+A.hash:q=!0}catch{si(!1,`<Link to="${g}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let G=n4(g,{relative:i}),[_,ne,ee]=j4(s,E),Q=X4(g,{replace:c,state:f,target:p,preventScrollReset:x,relative:i,viewTransition:b});function z(S){n&&n(S),S.defaultPrevented||Q(S)}let ce=I.createElement("a",{...E,...ee,href:U||G,onClick:q||d?n:z,ref:$4(w,ne),target:p,"data-discover":!y&&e==="render"?"true":void 0});return _&&!y?I.createElement(I.Fragment,null,ce,I.createElement(I4,{page:G})):ce});aw.displayName="Link";var H4=I.forwardRef(function({"aria-current":n="page",caseSensitive:e=!1,className:s="",end:i=!1,style:d,to:c,viewTransition:f,children:p,...g},x){let b=Yf(c,{relative:g.relative}),E=Oa(),w=I.useContext(Hh),{navigator:R,basename:y}=I.useContext(_i),U=w!=null&&J4(b)&&f===!0,q=R.encodeLocation?R.encodeLocation(b).pathname:b.pathname,G=E.pathname,_=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;e||(G=G.toLowerCase(),_=_?_.toLowerCase():null,q=q.toLowerCase()),_&&y&&(_=ho(_,y)||_);const ne=q!=="/"&&q.endsWith("/")?q.length-1:q.length;let ee=G===q||!i&&G.startsWith(q)&&G.charAt(ne)==="/",Q=_!=null&&(_===q||!i&&_.startsWith(q)&&_.charAt(q.length)==="/"),z={isActive:ee,isPending:Q,isTransitioning:U},ce=ee?n:void 0,S;typeof s=="function"?S=s(z):S=[s,ee?"active":null,Q?"pending":null,U?"transitioning":null].filter(Boolean).join(" ");let A=typeof d=="function"?d(z):d;return I.createElement(aw,{...g,"aria-current":ce,className:S,ref:x,style:A,to:c,viewTransition:f},typeof p=="function"?p(z):p)});H4.displayName="NavLink";var W4=I.forwardRef(({discover:t="render",fetcherKey:n,navigate:e,reloadDocument:s,replace:i,state:d,method:c=yh,action:f,onSubmit:p,relative:g,preventScrollReset:x,viewTransition:b,...E},w)=>{let R=q4(),y=K4(f,{relative:g}),U=c.toLowerCase()==="get"?"get":"post",q=typeof f=="string"&&nw.test(f),G=_=>{if(p&&p(_),_.defaultPrevented)return;_.preventDefault();let ne=_.nativeEvent.submitter,ee=ne?.getAttribute("formmethod")||c;R(ne||_.currentTarget,{fetcherKey:n,method:ee,navigate:e,replace:i,state:d,relative:g,preventScrollReset:x,viewTransition:b})};return I.createElement("form",{ref:w,method:U,action:y,onSubmit:s?p:G,...E,"data-discover":!q&&t==="render"?"true":void 0})});W4.displayName="Form";function z4(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function sw(t){let n=I.useContext(Eu);return Yr(n,z4(t)),n}function X4(t,{target:n,replace:e,state:s,preventScrollReset:i,relative:d,viewTransition:c}={}){let f=fl(),p=Oa(),g=Yf(t,{relative:d});return I.useCallback(x=>{if(y4(x,n)){x.preventDefault();let b=e!==void 0?e:Vf(p)===Vf(g);f(t,{replace:b,state:s,preventScrollReset:i,relative:d,viewTransition:c})}},[p,f,g,e,s,n,t,i,d,c])}function qf(t){si(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let n=I.useRef(_b(t)),e=I.useRef(!1),s=Oa(),i=I.useMemo(()=>O4(s.search,e.current?null:n.current),[s.search]),d=fl(),c=I.useCallback((f,p)=>{const g=_b(typeof f=="function"?f(new URLSearchParams(i)):f);e.current=!0,d("?"+g,p)},[d,i]);return[i,c]}var G4=0,Y4=()=>`__${String(++G4)}__`;function q4(){let{router:t}=sw("useSubmit"),{basename:n}=I.useContext(_i),e=h4();return I.useCallback(async(s,i={})=>{let{action:d,method:c,encType:f,formData:p,body:g}=C4(s,n);if(i.navigate===!1){let x=i.fetcherKey||Y4();await t.fetch(x,e,i.action||d,{preventScrollReset:i.preventScrollReset,formData:p,body:g,formMethod:i.method||c,formEncType:i.encType||f,flushSync:i.flushSync})}else await t.navigate(i.action||d,{preventScrollReset:i.preventScrollReset,formData:p,body:g,formMethod:i.method||c,formEncType:i.encType||f,replace:i.replace,state:i.state,fromRouteId:e,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,n,e])}function K4(t,{relative:n}={}){let{basename:e}=I.useContext(_i),s=I.useContext(vo);Yr(s,"useFormAction must be used inside a RouteContext");let[i]=s.matches.slice(-1),d={...Yf(t||".",{relative:n})},c=Oa();if(t==null){d.search=c.search;let f=new URLSearchParams(d.search),p=f.getAll("index");if(p.some(x=>x==="")){f.delete("index"),p.filter(b=>b).forEach(b=>f.append("index",b));let x=f.toString();d.search=x?`?${x}`:""}}return(!t||t===".")&&i.route.index&&(d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(d.pathname=d.pathname==="/"?e:uo([e,d.pathname])),Vf(d)}function J4(t,{relative:n}={}){let e=I.useContext(qE);Yr(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=sw("useViewTransitionState"),i=Yf(t,{relative:n});if(!e.isTransitioning)return!1;let d=ho(e.currentLocation.pathname,s)||e.currentLocation.pathname,c=ho(e.nextLocation.pathname,s)||e.nextLocation.pathname;return Th(i.pathname,c)!=null||Th(i.pathname,d)!=null}class gu{constructor(){this.authState={user:null,isAuthenticated:!1,loading:!0},this.loadFromStorage()}static getInstance(){return gu.instance||(gu.instance=new gu),gu.instance}loadFromStorage(){try{const n=localStorage.getItem("ros_user_session");if(n){const e=JSON.parse(n);this.authState={user:e.user,isAuthenticated:!0,loading:!1}}else this.authState.loading=!1}catch(n){console.error("Error loading auth from storage:",n),this.authState.loading=!1}}async signIn(n,e){try{const s={id:`user_${Date.now()}`,email:n,full_name:e,role:"VIEWER"},i={user:s,created_at:new Date().toISOString()};return localStorage.setItem("ros_user_session",JSON.stringify(i)),this.authState={user:s,isAuthenticated:!0,loading:!1},{error:null}}catch(s){return{error:s}}}async signUp(n,e){return this.signIn(n,e)}async signOut(){localStorage.removeItem("ros_user_session"),this.authState={user:null,isAuthenticated:!1,loading:!1}}getCurrentUser(){return this.authState.user}isAuthenticated(){return this.authState.isAuthenticated}isLoading(){return this.authState.loading}getAuthState(){return{...this.authState}}updateUserRole(n){if(this.authState.user){this.authState.user.role=n;const e=localStorage.getItem("ros_user_session");if(e){const s=JSON.parse(e);s.user.role=n,localStorage.setItem("ros_user_session",JSON.stringify(s))}}}}const rl=gu.getInstance(),iw=I.createContext(void 0),ic=()=>{const t=I.useContext(iw);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},Q4=({children:t})=>{const[n,e]=I.useState(null),[s,i]=I.useState(!0);I.useEffect(()=>{const x=rl.getAuthState();e(x.user),i(x.loading)},[]);const g={user:n,loading:s,signUp:async(x,b,E)=>{const w=await rl.signUp(x,b,E);return w.error||e(rl.getCurrentUser()),w},signIn:async(x,b)=>{const E=await rl.signIn(x,b);return E.error||e(rl.getCurrentUser()),E},signOut:async()=>{await rl.signOut(),e(null)},updateProfile:async x=>{try{return x.role&&rl.updateUserRole(x.role),e(rl.getCurrentUser()),{error:null}}catch(b){return{error:b}}}};return l.jsxDEV(iw.Provider,{value:g,children:t},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/contexts/AuthContext.tsx",lineNumber:80,columnNumber:10},void 0)},Z4=({isOpen:t,onClose:n,onSuccess:e})=>{const[s,i]=I.useState(""),[d,c]=I.useState(""),[f,p]=I.useState(!1),[g,x]=I.useState(null),{signIn:b}=ic(),E=async w=>{w.preventDefault(),p(!0),x(null);try{const R=await b(s,d);R.error?x(R.error.message||"An error occurred"):(e(),n())}catch{x("An unexpected error occurred")}finally{p(!1)}};return t?l.jsxDEV("div",{className:"bg-slate-800 p-8 rounded-xl shadow-2xl w-full max-w-md mx-auto border border-slate-700",children:[l.jsxDEV("div",{className:"mb-6",children:l.jsxDEV("h2",{className:"text-2xl font-bold text-white text-center",children:"Enter Your Information"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthModal.tsx",lineNumber:50,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthModal.tsx",lineNumber:49,columnNumber:7},void 0),l.jsxDEV("form",{onSubmit:E,className:"space-y-4",children:[l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Full Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthModal.tsx",lineNumber:57,columnNumber:11},void 0),l.jsxDEV("input",{type:"text",value:d,onChange:w=>c(w.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",placeholder:"Enter your full name",required:!0},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthModal.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthModal.tsx",lineNumber:56,columnNumber:9},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"Email"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthModal.tsx",lineNumber:71,columnNumber:11},void 0),l.jsxDEV("input",{type:"email",value:s,onChange:w=>i(w.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",placeholder:"Enter your email",required:!0},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthModal.tsx",lineNumber:74,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthModal.tsx",lineNumber:70,columnNumber:9},void 0),g&&l.jsxDEV("div",{className:"bg-red-900 border border-red-700 text-red-200 px-4 py-3 rounded-lg text-sm",children:g},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthModal.tsx",lineNumber:85,columnNumber:11},void 0),l.jsxDEV("button",{type:"submit",disabled:f,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors",children:f?"Loading...":"Continue"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthModal.tsx",lineNumber:90,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthModal.tsx",lineNumber:55,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthModal.tsx",lineNumber:48,columnNumber:5},void 0):null},eA=({onClose:t})=>{const{user:n,signOut:e,updateProfile:s}=ic(),[i,d]=I.useState(null),[c,f]=I.useState(!0),[p,g]=I.useState(!1),[x,b]=I.useState(""),[E,w]=I.useState("VIEWER"),[R,y]=I.useState(!1),[U,q]=I.useState(null),G=[{value:"VIEWER",label:"Viewer (Read Only)"},{value:"OPERATOR",label:"Operator (Limited Edit)"},{value:"EDITOR",label:"Editor (Full Access)"}];I.useEffect(()=>{n&&_()},[n]);const _=async()=>{if(n)try{const Q={id:n.id,full_name:n.full_name||n.email||"Unknown",role:n.role||"VIEWER",email:n.email||"",created_at:n.created_at||new Date().toISOString()};d(Q),b(Q.full_name),w(Q.role)}catch(Q){console.error("Error fetching profile:",Q)}finally{f(!1)}},ne=async()=>{if(n){y(!0);try{await s({full_name:x,role:E}),d(Q=>Q?{...Q,full_name:x,role:E}:null),g(!1),q(null)}catch(Q){console.error("Error saving profile:",Q),q("Failed to update profile")}finally{y(!1)}}},ee=async()=>{confirm("Are you sure you want to sign out?")&&await e()};return c?l.jsxDEV("div",{className:"flex items-center gap-2 text-slate-300",children:[l.jsxDEV("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:97,columnNumber:9},void 0),"Loading..."]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:96,columnNumber:7},void 0):i?l.jsxDEV("div",{className:"bg-slate-800 p-4 rounded-lg shadow-2xl w-80 border border-slate-700",children:[l.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[l.jsxDEV("h3",{className:"text-lg font-bold text-white",children:"Profile"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:114,columnNumber:9},void 0),t&&l.jsxDEV("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:116,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:113,columnNumber:7},void 0),p?l.jsxDEV("div",{className:"space-y-3",children:[l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Full Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:128,columnNumber:13},void 0),l.jsxDEV("input",{type:"text",value:x,onChange:Q=>b(Q.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-sm",placeholder:"Enter your full name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:131,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:127,columnNumber:11},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Role"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:141,columnNumber:13},void 0),l.jsxDEV("select",{value:E,onChange:Q=>w(Q.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-sm",children:G.map(Q=>l.jsxDEV("option",{value:Q.value,children:Q.label},Q.value,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:150,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:144,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:140,columnNumber:11},void 0),U&&l.jsxDEV("div",{className:"bg-red-900 border border-red-700 text-red-200 px-3 py-2 rounded text-sm",children:U},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:158,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex gap-2",children:[l.jsxDEV("button",{onClick:ne,disabled:R,className:"flex-1 px-3 py-2 bg-green-600 hover:bg-green-500 disabled:bg-slate-600 text-white text-sm rounded transition-colors",children:R?"Saving...":"Save"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:164,columnNumber:13},void 0),l.jsxDEV("button",{onClick:()=>g(!1),className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded transition-colors",children:"Cancel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:171,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:163,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:126,columnNumber:9},void 0):l.jsxDEV("div",{className:"space-y-4",children:[l.jsxDEV("div",{className:"flex items-center gap-3",children:[l.jsxDEV("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center text-white font-medium",children:(i.full_name||"U").charAt(0).toUpperCase()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:182,columnNumber:13},void 0),l.jsxDEV("div",{children:[l.jsxDEV("div",{className:"text-white font-medium",children:i.full_name},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:186,columnNumber:15},void 0),l.jsxDEV("div",{className:"text-slate-400 text-sm",children:i.role},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:187,columnNumber:15},void 0),l.jsxDEV("div",{className:"text-slate-500 text-xs",children:n?.email},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:188,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:185,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:181,columnNumber:11},void 0),l.jsxDEV("div",{className:"flex gap-2",children:[l.jsxDEV("button",{onClick:()=>g(!0),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Edit Profile"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:193,columnNumber:13},void 0),l.jsxDEV("button",{onClick:ee,className:"px-3 py-2 bg-red-600 hover:bg-red-500 text-white text-sm rounded transition-colors",title:"Sign out",children:"Sign Out"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:199,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:192,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:180,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:112,columnNumber:5},void 0):l.jsxDEV("div",{className:"text-slate-300",children:"Profile not found"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/UserProfile.tsx",lineNumber:105,columnNumber:7},void 0)},Pb=()=>{const{user:t,signOut:n}=ic(),[e,s]=I.useState(!1);return l.jsxDEV("header",{className:"fixed top-0 left-0 right-0 z-50 bg-slate-800 border-b border-slate-700 px-6 py-4",children:l.jsxDEV("div",{className:"flex items-center justify-between",children:[l.jsxDEV("div",{className:"flex items-center gap-4",children:l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:l.jsxDEV("span",{className:"text-white font-bold text-lg",children:"R"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:16,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:15,columnNumber:13},void 0),l.jsxDEV("h1",{className:"text-xl font-bold text-white",children:"Run of Show"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:18,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:14,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:13,columnNumber:9},void 0),t?l.jsxDEV("div",{className:"flex items-center gap-4",children:[l.jsxDEV("div",{className:"text-right",children:[l.jsxDEV("p",{className:"text-white font-semibold text-base",children:t.full_name||t.email},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:27,columnNumber:15},void 0),l.jsxDEV("p",{className:"text-slate-300 text-xs",children:t.email},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:30,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:26,columnNumber:13},void 0),l.jsxDEV("button",{onClick:()=>{confirm("Are you sure you want to sign out?")&&n()},className:"px-3 py-1.5 bg-red-600 hover:bg-red-500 text-white text-sm rounded-md transition-colors",title:"Sign out",children:"Sign Out"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:36,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:24,columnNumber:11},void 0):l.jsxDEV("div",{className:"flex items-center gap-4",children:l.jsxDEV("div",{className:"text-slate-400 text-sm",children:"Please sign in to continue"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:50,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:49,columnNumber:11},void 0),e&&l.jsxDEV("div",{className:"absolute top-16 right-6 z-50",children:l.jsxDEV(eA,{onClose:()=>s(!1)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:59,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:58,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:11,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AppHeader.tsx",lineNumber:10,columnNumber:5},void 0)},tA=({children:t})=>{const{user:n,loading:e}=ic(),[s,i]=Rh.useState(!1);return Rh.useEffect(()=>{!e&&!n?i(!0):n&&i(!1)},[n,e]),e?l.jsxDEV("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 pt-16",children:[l.jsxDEV(Pb,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:25,columnNumber:9},void 0),l.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-80px)]",children:l.jsxDEV("div",{className:"text-center",children:[l.jsxDEV("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:28,columnNumber:13},void 0),l.jsxDEV("p",{className:"text-slate-300",children:"Loading..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:29,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:27,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:26,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:24,columnNumber:7},void 0):n?l.jsxDEV(l.Fragment,{children:t},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:65,columnNumber:10},void 0):l.jsxDEV("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 pt-16",children:[l.jsxDEV(Pb,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:39,columnNumber:9},void 0),l.jsxDEV("div",{className:"flex items-center justify-center h-[calc(100vh-80px)]",children:l.jsxDEV("div",{className:"text-center max-w-2xl mx-auto p-8",children:[l.jsxDEV("div",{className:"mb-8",children:[l.jsxDEV("div",{className:"flex items-center justify-center gap-3 mb-4",children:[l.jsxDEV("div",{className:"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center",children:l.jsxDEV("span",{className:"text-white font-bold text-2xl",children:"R"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:45,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:44,columnNumber:17},void 0),l.jsxDEV("h1",{className:"text-4xl font-bold text-white",children:"Run of Show"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:47,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:43,columnNumber:15},void 0),l.jsxDEV("p",{className:"text-slate-300 text-lg",children:"Please sign in to access the Run of Show application."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:49,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:42,columnNumber:13},void 0),l.jsxDEV(Z4,{isOpen:s,onClose:()=>{},onSuccess:()=>{i(!1)}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:51,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:41,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:40,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/AuthGuard.tsx",lineNumber:38,columnNumber:7},void 0)},uh=[{value:"Great Hall",label:"Great Hall",color:"bg-blue-600"},{value:"Briefing Center",label:"Briefing Center",color:"bg-green-600"},{value:"Lee Anderson",label:"Lee Anderson",color:"bg-purple-600"},{value:"Virtual Show",label:"Virtual Show",color:"bg-orange-600"},{value:"Off Site",label:"Off Site",color:"bg-red-600"}],PO=[1,2,3,4,5],rA="https://ros-50-production.up.railway.app";class nA{constructor(){this.cache=new Map,this.CACHE_TTL={calendarEvents:300*1e3,runOfShowData:30*1e3,completedCues:120*1e3,activeTimers:10*1e3,changeLog:60*1e3,timerMessages:60*1e3}}getCacheKey(n,e){return`${n}${e?`_${JSON.stringify(e)}`:""}`}getCachedData(n){const e=this.cache.get(n);return e?Date.now()-e.timestamp>e.ttl?(this.cache.delete(n),null):e.data:null}setCachedData(n,e,s){this.cache.set(n,{data:e,timestamp:Date.now(),ttl:s})}async request(n,e={},s,i){if(e.method==="GET"||!e.method){const f=s||this.getCacheKey(n),p=this.getCachedData(f);if(p)return console.log(` Cache hit for: ${n}`),p}const d=`${rA}${n}`,c={headers:{"Content-Type":"application/json",...e.headers},...e};try{const f=await fetch(d,c);if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);const p=await f.json();if(e.method==="GET"||!e.method){const g=s||this.getCacheKey(n),x=i||this.CACHE_TTL.calendarEvents;this.setCachedData(g,p,x)}return p}catch(f){throw console.error(`API request failed for ${n}:`,f),f}}async healthCheck(){return this.request("/health")}async getCalendarEvents(){return this.request("/api/calendar-events",{},"calendarEvents",this.CACHE_TTL.calendarEvents)}async createCalendarEvent(n){const e=await this.request("/api/calendar-events",{method:"POST",body:JSON.stringify(n)});return this.cache.delete("calendarEvents"),e}async getCalendarEvent(n){return this.request(`/api/calendar-events/${n}`,{},`calendarEvent_${n}`,this.CACHE_TTL.calendarEvents)}async updateCalendarEvent(n,e){const s=await this.request(`/api/calendar-events/${n}`,{method:"PUT",body:JSON.stringify(e)});return this.cache.delete("calendarEvents"),this.cache.delete(`calendarEvent_${n}`),s}async deleteCalendarEvent(n){const e=await this.request(`/api/calendar-events/${n}`,{method:"DELETE"});return this.cache.delete("calendarEvents"),this.cache.delete(`calendarEvent_${n}`),e}async getRunOfShowData(n){return this.request(`/api/run-of-show-data/${n}`,{},`runOfShowData_${n}`,this.CACHE_TTL.runOfShowData)}async saveRunOfShowData(n){const e=await this.request("/api/run-of-show-data",{method:"POST",body:JSON.stringify(n)});return this.cache.delete(`runOfShowData_${n.event_id}`),e}async getCompletedCues(n){return this.request(`/api/completed-cues/${n}`,{},`completedCues_${n}`,this.CACHE_TTL.completedCues)}async markCueAsCompleted(n,e,s){const i=await this.request("/api/completed-cues",{method:"POST",body:JSON.stringify({event_id:n,item_id:e,user_id:s})});return this.cache.delete(`completedCues_${n}`),i}async unmarkCueAsCompleted(n,e,s){const i=await this.request("/api/completed-cues",{method:"DELETE",body:JSON.stringify({event_id:n,item_id:e,user_id:s})});return this.cache.delete(`completedCues_${n}`),i}async getActiveTimers(n){return this.request(`/api/active-timers/${n}`,{},`activeTimers_${n}`,this.CACHE_TTL.activeTimers)}async saveActiveTimer(n){const e=await this.request("/api/active-timers",{method:"POST",body:JSON.stringify(n)});return this.cache.delete(`activeTimers_${n.event_id}`),e}async getSubCueTimers(n){return this.request(`/api/sub-cue-timers/${n}`)}async getChangeLog(n,e=100){return this.request(`/api/change-log/${n}?limit=${e}`)}async getTimerMessages(n){return this.request(`/api/timer-messages/${n}`)}async logChange(n){return await this.request("/api/change-log",{method:"POST",body:JSON.stringify(n)})}}const Es=new nA,on="https://ros-50-production.up.railway.app";class it{static async saveCalendarEvent(n){try{console.log(" Saving calendar event to API:",n);const e=await Es.createCalendarEvent(n);return console.log(" Calendar event saved to API:",e),e}catch(e){return console.error("Error saving calendar event:",e),console.log(" Falling back to localStorage..."),this.saveCalendarToLocalStorage(n)}}static async updateCalendarEvent(n,e){try{console.log(" Updating calendar event via API:",n,e);const s=await Es.updateCalendarEvent(n,e);return console.log(" Calendar event updated successfully:",s),s}catch(s){return console.error(" Exception updating calendar event:",s),null}}static async getCalendarEvents(){try{console.log(" Loading calendar events from API...");const n=await Es.getCalendarEvents();return console.log(" Calendar events loaded from API:",n?.length||0),n||[]}catch(n){return console.error("Error fetching calendar events:",n),console.log(" Falling back to localStorage..."),this.getCalendarFromLocalStorage()}}static async getCalendarEvent(n){try{return console.log(" Loading calendar event from API:",n),await Es.getCalendarEvent(n)}catch(e){return console.error("Error fetching calendar event:",e),this.getCalendarFromLocalStorageById(n)}}static async deleteCalendarEvent(n){try{return console.log(" Deleting calendar event via API:",n),await Es.deleteCalendarEvent(n)}catch(e){return console.error("Error deleting calendar event:",e),this.deleteCalendarFromLocalStorage(n)}}static async logChange(n,e,s,i,d,c,f,p,g,x,b,E,w,R){try{console.log(" Logging change via API:",{eventId:n,userId:e,userName:s,userRole:i,action:d,tableName:c,recordId:f,fieldName:p,rowNumber:E,cueNumber:w});const y={event_id:n,user_id:e,user_name:s,user_role:i,action:d,table_name:c,record_id:f||null,field_name:p||null,old_value:g?JSON.stringify(g):null,new_value:x?JSON.stringify(x):null,description:b||null,metadata:R||{},row_number:E||null,cue_number:w?typeof w=="string"?parseInt(w,10):w:null},U=await Es.logChange(y);return console.log(" Change logged:",{action:d,tableName:c,recordId:f,changeId:U}),U}catch(y){return console.error("Error logging change:",y),null}}static async logFieldChanges(n,e,s,i,d,c,f,p){try{for(const g of f)await this.logChange(n,e,s,i,"UPDATE",d,c,g.fieldName,g.oldValue,g.newValue,p)}catch(g){console.error("Error logging field changes:",g)}}static async getChangeLog(n,e=50,s=0){try{return console.log(" Loading change log from API:",{eventId:n,limit:e,offset:s}),await Es.getChangeLog(n,e)||[]}catch(i){return console.error("Error fetching change log:",i),[]}}static async getRecordChangeLog(n,e,s,i=20){try{return console.log(" Loading record change log from API:",{eventId:n,tableName:e,recordId:s,limit:i}),[]}catch(d){return console.error("Error fetching record change log:",d),[]}}static async getChangeLogSummary(n){try{return console.log(" Loading change log summary from API:",{eventId:n}),null}catch(e){return console.error("Error fetching change log summary:",e),null}}static async cleanupOldChangeLogs(){try{return console.log(" Cleaning up old change logs via API"),0}catch(n){return console.error("Error cleaning up old change logs:",n),0}}static async saveRunOfShowData(n,e){try{console.log(" Saving run of show data to Neon:",{eventId:n.event_id,scheduleItemsCount:n.schedule_items?.length||0,customColumnsCount:n.custom_columns?.length||0,settingsKeys:Object.keys(n.settings||{}),userInfo:e?`${e.userName} (${e.userRole})`:"No user info"});const s={...n,last_modified_by:e?.userId,last_modified_by_name:e?.userName,last_modified_by_role:e?.userRole};return await Es.saveRunOfShowData(s)}catch(s){console.error(" Error saving run of show data:",s),console.error(" Error details:",s.message,s.details,s.hint);const i={...n,last_modified_by:e?.userId,last_modified_by_name:e?.userName,last_modified_by_role:e?.userRole,updated_at:new Date().toISOString()};return this.saveRunOfShowToLocalStorage(i)}}static async updateRunOfShowData(n,e){try{return console.log(" Updating run of show data via API for event:",n,e),console.log(" Updating run of show data via API:",n,e),null}catch(s){return console.error(" Exception updating run of show data:",s),null}}static async getRunOfShowData(n){try{console.log(" Loading run of show data from API for event:",n);const e=await Es.getRunOfShowData(n);return console.log(" Run of show data loaded from API:",e?"Found":"Not found"),e&&console.log(" Data structure:",{hasScheduleItems:!!e.schedule_items,scheduleItemsLength:e.schedule_items?.length||0,hasCustomColumns:!!e.custom_columns,customColumnsLength:e.custom_columns?.length||0,hasSettings:!!e.settings}),e}catch(e){return console.error(" Exception in getRunOfShowData:",e),console.log(" Falling back to localStorage due to exception..."),this.getRunOfShowFromLocalStorageById(n)}}static async deleteRunOfShowData(n){try{return console.warn("Supabase not configured, using localStorage fallback"),this.deleteRunOfShowFromLocalStorage(n)}catch(e){return console.error("Error deleting run of show data:",e),this.deleteRunOfShowFromLocalStorage(n)}}static saveCalendarToLocalStorage(n){const e=this.getCalendarFromLocalStorage(),s={...n,id:Date.now().toString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return e.unshift(s),localStorage.setItem("calendar_events",JSON.stringify(e)),console.log(" Calendar event saved to localStorage"),s}static getCalendarFromLocalStorage(){try{const n=localStorage.getItem("calendar_events"),e=n?JSON.parse(n):[];return console.log(" Calendar events loaded from localStorage:",e.length),e}catch(n){return console.error("Error reading from localStorage:",n),[]}}static getCalendarFromLocalStorageById(n){return this.getCalendarFromLocalStorage().find(s=>s.id===n)||null}static deleteCalendarFromLocalStorage(n){try{const s=this.getCalendarFromLocalStorage().filter(i=>i.id!==n);return localStorage.setItem("calendar_events",JSON.stringify(s)),!0}catch(e){return console.error("Error deleting from localStorage:",e),!1}}static saveRunOfShowToLocalStorage(n){const e=this.getAllRunOfShowFromLocalStorage(),s=new Date().toISOString(),i=e.findIndex(c=>c.event_id===n.event_id);let d;if(i>=0){const c=e[i],f=c.last_change_at||s;d={...n,id:c.id,created_at:c.created_at,updated_at:s,last_change_at:f},e[i]=d}else d={...n,id:Date.now().toString(),created_at:s,updated_at:s,last_change_at:s},e.push(d);return localStorage.setItem("run_of_show_data",JSON.stringify(e)),console.log(" Run of show data saved to localStorage"),d}static getAllRunOfShowFromLocalStorage(){try{const n=localStorage.getItem("run_of_show_data");return n?JSON.parse(n):[]}catch(n){return console.error("Error reading run of show data from localStorage:",n),[]}}static getRunOfShowFromLocalStorageById(n){console.log(" Loading from localStorage for event:",n);const e=this.getAllRunOfShowFromLocalStorage();console.log(" All localStorage data:",e);const s=e.find(i=>i.event_id===n);return console.log(" Found data for event:",s?"Yes":"No"),s&&console.log(" Found data structure:",{hasScheduleItems:!!s.schedule_items,scheduleItemsLength:s.schedule_items?.length||0,hasCustomColumns:!!s.custom_columns,customColumnsLength:s.custom_columns?.length||0,hasSettings:!!s.settings}),s||null}static deleteRunOfShowFromLocalStorage(n){try{const s=this.getAllRunOfShowFromLocalStorage().filter(i=>i.event_id!==n);return localStorage.setItem("run_of_show_data",JSON.stringify(s)),!0}catch(e){return console.error("Error deleting run of show data from localStorage:",e),!1}}static async checkForChanges(n,e){try{return console.log(" Checking for changes via API:",{eventId:n,localLastChangeAt:e}),console.log(" Checking for changes via API:",{eventId:n,localLastChangeAt:e}),{hasChanges:!1}}catch(s){return console.error(" Error checking for changes:",s),{hasChanges:!1}}}static async loadChangesDynamically(n){try{return console.log(" Loading changes dynamically for event:",n),this.getRunOfShowFromLocalStorageById(n);const{data:e,error:s}=await supabase.from("run_of_show_data").select("*").eq("event_id",n).single();return s?(console.error(" Error loading changes:",s),null):(console.log(" Changes loaded successfully"),e)}catch(e){return console.error(" Error loading changes dynamically:",e),null}}static async saveUserSession(n,e,s,i){try{return console.log(" Saving authenticated user session via API:",{eventId:n,userId:e,username:s,role:i}),console.log(" Saving user session via API:",{eventId:n,userId:e,username:s,role:i}),this.saveUserSessionToLocalStorage(n,s,i)}catch(d){return console.error("Error saving user session:",d),this.saveUserSessionToLocalStorage(n,s,i)}}static async getCurrentUserSession(n,e){try{return console.log(" Getting current user session via API:",{userId:n,eventId:e}),console.log(" Getting current user session via API:",{userId:n,eventId:e}),this.getCurrentUserSessionFromLocalStorage()}catch(s){return console.error("Error getting current user session:",s),this.getCurrentUserSessionFromLocalStorage()}}static async updateUserActivity(n){try{console.log(" Updating user activity via API:",n),console.log(" Updating user activity via API:",n)}catch(e){console.error("Error updating user activity:",e)}}static async cleanupInactiveSessions(){try{console.log(" Cleaning up inactive sessions via API"),console.log(" Cleaning up inactive sessions via API")}catch(n){console.error("Error cleaning up inactive sessions:",n)}}static saveUserSessionToLocalStorage(n,e,s){try{const i={event_id:n,username:e,role:s,session_started_at:new Date().toISOString(),last_activity_at:new Date().toISOString(),is_active:!0};return localStorage.setItem(`current_user_session_${e}`,JSON.stringify(i)),localStorage.setItem(`user_role_${n}_${e}`,s),console.log(" User session saved to localStorage"),!0}catch(i){return console.error("Error saving user session to localStorage:",i),!1}}static getCurrentUserSessionFromLocalStorage(){try{const n=Object.keys(localStorage);let e=null,s=0;for(const i of n)if(i.startsWith("current_user_session_")){const d=JSON.parse(localStorage.getItem(i)||"{}");if(d.is_active&&d.last_activity_at){const c=new Date(d.last_activity_at).getTime();c>s&&(s=c,e=d)}}return console.log(" Retrieved user session from localStorage:",e),e}catch(n){return console.error("Error getting current user session from localStorage:",n),null}}static async loadCue(n,e,s,i,d,c,f){try{console.log(" Loading CUE via API:",{eventId:n,itemId:e,userId:s,totalDurationSeconds:i,rowNumber:d,cueDisplay:c,timerId:f}),console.log(" DatabaseService.loadCue parameters:",{eventId:n,itemId:e,userId:s,totalDurationSeconds:i,rowNumber:d,cueDisplay:c,timerId:f});const p=await fetch(`${on}/api/active-timers`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:n,item_id:e,user_id:s,timer_state:"loaded",is_active:!0,is_running:!1,started_at:null,last_loaded_cue_id:e,cue_is:c,duration_seconds:i})});return p.ok?(console.log(" CUE loaded successfully via API"),!0):(console.error(" Failed to load CUE via API:",p.status,p.statusText),!1)}catch(p){return console.error(" Error loading CUE:",p),!1}}static async startTimer(n,e,s,i,d,c,f,p){try{console.log(" Starting timer via API:",{eventId:n,itemId:e,userId:s,totalDurationSeconds:i,startedAt:d,rowNumber:c,cueDisplay:f,timerId:p});const g=await fetch(`${on}/api/active-timers`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:n,item_id:e,user_id:s,timer_state:"running",is_active:!0,is_running:!0,started_at:d||new Date().toISOString(),last_loaded_cue_id:e,cue_is:f,duration_seconds:i})});return g.ok?(console.log(" Timer started successfully via API"),!0):(console.error(" Failed to start timer via API:",g.status,g.statusText),!1)}catch(g){return console.error(" Error starting timer:",g),!1}}static async stopTimer(n,e,s,i,d){try{console.log(" Stopping timer via API:",{eventId:n,itemId:e,userId:s,userName:i,userRole:d});const c=await fetch(`${on}/api/active-timers/stop`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:n,item_id:e,user_id:s,user_name:i||"Unknown User",user_role:d||"VIEWER"})});if(c.ok){const f=await c.json();return console.log(" Timer stopped successfully via API:",f.stopped?"Timer stopped":"No active timer found"),f.stopped}else return console.error(" Failed to stop timer via API:",c.status,c.statusText),!1}catch(c){return console.error(" Error stopping timer:",c),!1}}static async updateTimerDuration(n,e,s){try{console.log(` Updating timer duration via API for event ${n}, item ${e} to ${s}s`);const i=await fetch(`${on}/api/active-timers/${n}/${e}/duration`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({duration_seconds:s})});if(i.ok){const d=await i.json();return console.log(" Timer duration updated successfully via API:",d),!0}else return console.error(" Failed to update timer duration via API:",i.status,i.statusText),!1}catch(i){return console.error(" Error updating timer duration:",i),!1}}static async stopAllTimersForEvent(n,e,s,i){try{console.log(" Stopping all timers via API:",{eventId:n,userId:e,userName:s,userRole:i});const d=await fetch(`${on}/api/active-timers/stop-all`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:n,user_id:e,user_name:s||"Unknown User",user_role:i||"VIEWER"})});if(d.ok){const c=await d.json();return console.log(" All timers stopped successfully via API:",c.message),!0}else return console.error(" Failed to stop all timers via API:",d.status,d.statusText),!1}catch(d){return console.error(" Error stopping all timers:",d),!1}}static async getActiveTimer(n){try{console.log(" Getting active timer via API:",n);const e=await fetch(`${on}/api/active-timers/${n}`);if(e.ok){const s=await e.json();return s.length>0?s[0]:null}return null}catch(e){return console.error("Error getting active timer:",e),null}}static subscribeToTimerChanges(n,e){return console.warn("Real-time updates handled via Socket.IO and SSE"),null}static async hasActiveSubCueTimer(n){try{console.log(" Checking active sub-cue timer via API:",n);const e=await fetch(`${on}/api/sub-cue-timers/${n}`);return e.ok?{data:(await e.json()).length>0,error:null}:{data:!1,error:null}}catch(e){return console.error(" Error checking active sub-cue timer:",e),{data:!1,error:e}}}static async getActiveSubCueTimer(n){try{console.log(" Getting active sub-cue timer via API:",n);const e=await fetch(`${on}/api/sub-cue-timers/${n}`);if(e.ok){const s=await e.json();return{data:s.length>0?s[0]:null,error:null}}return{data:null,error:null}}catch(e){return console.error(" Error getting active sub-cue timer:",e),{data:null,error:e}}}static async getActiveSubCueTimers(n){try{console.log(" Getting active sub-cue timers via API:",n);const e=await fetch(`${on}/api/sub-cue-timers/${n}`);return e.ok?{data:await e.json(),error:null}:{data:[],error:null}}catch(e){return console.error(" Error getting active sub-cue timers:",e),{data:[],error:e}}}static async startSubCueTimer(n,e,s,i,d,c,f,p,g){try{console.log(" Starting sub-cue timer via API:",{eventId:n,itemId:e,userId:s,durationSeconds:i,rowNumber:d,cueDisplay:c,timerId:f,userName:p,userRole:g});const x=await fetch(`${on}/api/sub-cue-timers`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:n,item_id:e,user_id:s,user_name:p||"Unknown User",user_role:g||"VIEWER",duration_seconds:i,row_number:d,cue_display:c,timer_id:f,is_active:!0,is_running:!0,started_at:new Date().toISOString()})});if(x.ok){const b=await x.json();return console.log(" Sub-cue timer started successfully via API:",b),{data:b,error:null}}else return console.error(" Failed to start sub-cue timer via API:",x.status,x.statusText),{data:null,error:{message:`HTTP ${x.status}`}}}catch(x){return console.error(" Error starting sub-cue timer:",x),{data:null,error:x}}}static async expireCompletedSubCueTimers(){try{return console.warn(" Supabase client not initialized, skipping expire completed sub-cue timers"),{data:0,error:null}}catch(n){return console.error(" Error expiring completed sub-cue timers:",n),{data:0,error:n}}}static async stopSubCueTimer(n,e){try{console.log(" Stopping sub-cue timer via API:",{eventId:n,itemId:e});const s=await fetch(`${on}/api/sub-cue-timers/stop`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:n,item_id:e||null})});if(s.ok){const i=await s.json();return console.log(" Sub-cue timer stopped successfully via API:",i),{data:i,error:null}}else return console.error(" Failed to stop sub-cue timer via API:",s.status,s.statusText),{data:null,error:{message:`HTTP ${s.status}`}}}catch(s){return console.error(" Error stopping sub-cue timer:",s),{data:null,error:s}}}static async getActiveSecondaryTimer(n){try{return console.warn(" Supabase client not initialized, skipping get active secondary timer"),{data:null,error:null}}catch(e){return console.error(" Error getting active secondary timer:",e),{data:null,error:e}}}static async startSecondaryTimer(n,e,s,i){try{return console.warn(" Supabase client not initialized, skipping start secondary timer"),{data:null,error:null}}catch(d){return console.error(" Error starting secondary timer:",d),{data:null,error:d}}}static async stopSecondaryTimer(n){try{return console.warn(" Supabase client not initialized, skipping stop secondary timer"),{data:null,error:null}}catch(e){return console.error(" Error stopping secondary timer:",e),{data:null,error:e}}}static async updateSecondaryTimerRemaining(n,e){try{return console.warn(" Supabase client not initialized, skipping update secondary timer remaining"),{data:null,error:null}}catch(s){return console.error(" Error updating secondary timer remaining:",s),{data:null,error:s}}}static async updateSubCueTimerRemaining(n,e,s){try{return console.warn(" Supabase client not initialized, skipping update sub-cue timer remaining"),!1}catch(i){return console.error("Error updating sub-cue timer remaining time:",i),!1}}static async clearAllActiveTimersForEvent(n){try{console.log(" Clearing all active timers for event via API:",n);const e=await fetch(`${on}/api/active-timers/stop-all`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:n})});if(!e.ok)return console.error(" Error clearing all active timers via API:",e.statusText),!1;const s=await e.json();return console.log(" All active timers cleared for event via API:",n,s),!0}catch(e){return console.error(" Error clearing all active timers:",e),!1}}static async getCompletedCues(n){try{return console.log(" Getting completed cues via API:",n),console.log(" Getting completed cues via API:",n),null}catch(e){return console.error(" Error getting completed cues:",e),null}}static async markCueCompleted(n,e,s,i,d,c){try{console.log(" Marking cue as completed via API:",{eventId:n,itemId:e,userId:i,userName:d,userRole:c});const f=await fetch("https://ros-50-production.up.railway.app/api/completed-cues",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:n,item_id:e,cue_id:s,user_id:i,user_name:d,user_role:c})});if(!f.ok)return console.error(" Failed to mark cue as completed:",f.status,f.statusText),!1;const p=await f.json();return console.log(" Cue marked as completed successfully:",{eventId:n,itemId:e,data:p}),!0}catch(f){return console.error(" Error marking cue as completed:",f),!1}}static async unmarkCueCompleted(n,e){try{console.log(" Unmarking cue as completed via API:",{eventId:n,itemId:e});const s=await fetch("https://ros-50-production.up.railway.app/api/completed-cues",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:n,item_id:e})});if(!s.ok)return console.error(" Failed to unmark cue as completed:",s.status,s.statusText),!1;const i=await s.json();return console.log(" Cue unmarked as completed:",{eventId:n,itemId:e,data:i}),!0}catch(s){return console.error(" Error unmarking cue as completed:",s),!1}}static async clearCompletedCues(n){try{console.log(" Clearing all completed cues from Neon database via API:",{eventId:n});const e=await fetch(`${on}/api/completed-cues/${n}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});return e.ok?(console.log(" Successfully deleted all completed cues from Neon database for event:",n),!0):(console.error(" Error clearing completed cues from Neon via API:",e.statusText),!1)}catch(e){return console.error(" Error clearing completed cues from Neon:",e),!1}}static async getIndentedCues(n){try{console.log(" Getting indented cues via API:",n);const e=await fetch(`${on}/api/indented-cues/${n}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)return console.error(" Failed to get indented cues:",e.status,e.statusText),null;const s=await e.json();return console.log(" Indented cues retrieved successfully:",s),s}catch(e){return console.error(" Error getting indented cues:",e),null}}static async markCueIndented(n,e,s,i,d,c){try{console.log(" Marking cue as indented via API:",{eventId:n,itemId:e,parentItemId:s,userId:i,userName:d,userRole:c});const f=await fetch(`${on}/api/indented-cues`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:n,item_id:e,parent_item_id:s,user_id:i,user_name:d,user_role:c})});if(!f.ok)return console.error(" Failed to mark cue as indented:",f.status,f.statusText),!1;const p=await f.json();return console.log(" Cue marked as indented successfully:",{eventId:n,itemId:e,parentItemId:s,data:p}),!0}catch(f){return console.error(" Error marking cue as indented:",f),!1}}static async unmarkCueIndented(n,e){try{console.log(" Unmarking cue as indented via API:",{eventId:n,itemId:e});const s=await fetch(`${on}/api/indented-cues/${n}/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});return s.ok?(console.log(" Cue unmarked as indented successfully"),!0):(console.error(" Failed to unmark cue as indented:",s.status,s.statusText),!1)}catch(s){return console.error(" Error unmarking cue as indented:",s),!1}}static async clearIndentedCues(n){try{console.log(" Clearing indented cues via API:",n);const e=await fetch(`${on}/api/indented-cues/${n}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});return e.ok?(console.log(" Indented cues cleared successfully"),!0):(console.error(" Failed to clear indented cues:",e.status,e.statusText),!1)}catch(e){return console.error(" Error clearing indented cues:",e),!1}}static subscribeToTableChanges(n,e,s){try{return console.error(" Supabase client not initialized"),null}catch(i){return console.error(` Error setting up ${n} subscription:`,i),null}}static async updateLastLoadedCue(n,e,s){try{return console.log(" Updating last loaded CUE via API:",{eventId:n,cueId:e,state:s}),{data:{success:!0},error:null}}catch(i){return console.error(" Error updating last loaded CUE:",i),{data:null,error:i}}}static async getLastLoadedCue(n){try{return console.log(" Getting last loaded CUE via API:",n),console.log(" Getting last loaded CUE via API:",n),{data:null,error:null}}catch(e){return console.error(" Error getting last loaded CUE:",e),{data:null,error:e}}}static async saveTimerMessage(n){try{console.log(" Saving timer message via API:",n);const e=await fetch(`${on}/api/timer-messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(e.ok){const s=await e.json();return console.log(" Timer message saved via API:",s),s}else return console.error(" Failed to save timer message via API:",e.status,e.statusText),this.saveTimerMessageToLocalStorage(n)}catch(e){return console.error(" Error saving timer message:",e),this.saveTimerMessageToLocalStorage(n)}}static async getTimerMessage(n){try{console.log(" Getting timer message via API:",n);const e=await fetch(`${on}/api/timer-messages/${n}`);if(e.ok){const s=await e.json();return s.length>0?s[0]:null}return null}catch(e){return console.error(" Error loading timer message:",e),null}}static async updateTimerMessage(n,e){try{console.log(" Updating timer message via API:",{id:n,updates:e});const s=await fetch(`${on}/api/timer-messages/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return s.ok?(console.log(" Timer message updated via API"),!0):(console.error(" Failed to update timer message via API:",s.status,s.statusText),this.updateTimerMessageInLocalStorage(n,e))}catch(s){return console.error(" Error updating timer message:",s),this.updateTimerMessageInLocalStorage(n,e)}}static async disableTimerMessage(n){return this.updateTimerMessage(n,{enabled:!1})}static async getTimerMessagesForEvent(n){try{console.log(" Getting timer messages via API:",n);const e=await fetch(`${on}/api/timer-messages/${n}`);if(e.ok){const s=await e.json();return console.log(" Timer messages loaded via API:",s.length),s}else return console.error(" Failed to load timer messages via API:",e.status,e.statusText),this.getTimerMessagesFromLocalStorage().filter(s=>s.event_id===n)}catch(e){return console.error(" Error loading timer messages:",e),this.getTimerMessagesFromLocalStorage().filter(s=>s.event_id===n)}}static async getCueDataForItem(n,e){try{return console.warn(" Supabase client not initialized, skipping get CUE data"),null}catch(s){return console.error(" Error getting CUE data for item:",s),null}}static async getHybridTimerData(n){try{return console.warn("Supabase not configured, cannot fetch hybrid timer data"),null}catch(e){return console.error(" Error fetching hybrid timer data:",e),null}}static saveTimerMessageToLocalStorage(n){const e=this.getTimerMessagesFromLocalStorage(),s={...n,id:`local_${Date.now()}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return e.push(s),localStorage.setItem("timer_messages",JSON.stringify(e)),s}static getTimerMessagesFromLocalStorage(){try{const n=localStorage.getItem("timer_messages");return n?JSON.parse(n):[]}catch(n){return console.error("Error loading timer messages from localStorage:",n),[]}}static getTimerMessageFromLocalStorage(n){return this.getTimerMessagesFromLocalStorage().find(s=>s.event_id===n&&s.enabled)||null}static updateTimerMessageInLocalStorage(n,e){try{const s=this.getTimerMessagesFromLocalStorage(),i=s.findIndex(d=>d.id===n);return i!==-1?(s[i]={...s[i],...e,updated_at:new Date().toISOString()},localStorage.setItem("timer_messages",JSON.stringify(s)),!0):!1}catch(s){return console.error("Error updating timer message in localStorage:",s),!1}}}const ow=({isOpen:t,onClose:n,onRoleSelected:e,eventId:s})=>{const{user:i}=ic(),[d,c]=I.useState("VIEWER"),[f,p]=I.useState(!1);I.useEffect(()=>{if(t&&i?.id&&s){const b=localStorage.getItem(`user_role_${s}_${i.id}`);b&&["VIEWER","EDITOR","OPERATOR"].includes(b)&&c(b)}},[t,i?.id,s]);const g=[{value:"VIEWER",label:"Viewer (Read Only)",description:"Can view but cannot edit any content",icon:""},{value:"OPERATOR",label:"Operator (Limited Edit)",description:"Can control timers and view data",icon:""},{value:"EDITOR",label:"Editor (Full Access)",description:"Can edit all content and settings",icon:""}],x=async()=>{if(!(!i||!s)){p(!0);try{await it.saveUserSession(s,i.id,i.user_metadata?.full_name||i.email||"Unknown",d)?(e(d),n()):alert("Failed to save user session. Please try again.")}catch(b){console.error("Error saving user session:",b),alert("Error saving user session. Please try again.")}finally{p(!1)}}};return t?l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[9999] p-4",children:l.jsxDEV("div",{className:"bg-slate-800 p-8 rounded-xl shadow-2xl max-w-2xl w-full",children:[l.jsxDEV("div",{className:"text-center mb-6",children:[l.jsxDEV("h2",{className:"text-3xl font-bold text-white mb-2",children:"Select Your Role"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:86,columnNumber:11},void 0),l.jsxDEV("p",{className:"text-slate-300 text-lg",children:["Welcome, ",i?.user_metadata?.full_name||i?.email,"! Please select your role for this session."]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:87,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:85,columnNumber:9},void 0),l.jsxDEV("div",{className:"space-y-4 mb-8",children:g.map(b=>l.jsxDEV("label",{className:`flex items-start gap-4 cursor-pointer p-4 rounded-lg border-2 transition-colors ${d===b.value?"border-blue-500 bg-blue-900/20":"border-slate-600 hover:border-blue-400"}`,children:[l.jsxDEV("input",{type:"radio",name:"role",value:b.value,checked:d===b.value,onChange:E=>c(E.target.value),className:"w-5 h-5 text-blue-600 mt-1"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:103,columnNumber:15},void 0),l.jsxDEV("div",{className:"flex-1",children:[l.jsxDEV("div",{className:"flex items-center gap-2 mb-1",children:[l.jsxDEV("span",{className:"text-2xl",children:b.icon},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:113,columnNumber:19},void 0),l.jsxDEV("span",{className:"text-white font-bold text-lg",children:b.label},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:114,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:112,columnNumber:17},void 0),l.jsxDEV("p",{className:"text-slate-300 text-sm",children:b.description},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:116,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:111,columnNumber:15},void 0)]},b.value,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:95,columnNumber:13},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:93,columnNumber:9},void 0),l.jsxDEV("div",{className:"flex gap-4",children:[l.jsxDEV("button",{onClick:x,disabled:f,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors",children:f?"Loading...":"Continue with Selected Role"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:123,columnNumber:11},void 0),l.jsxDEV("button",{onClick:n,className:"px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:130,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:122,columnNumber:9},void 0),l.jsxDEV("div",{className:"mt-4 p-3 bg-blue-900 rounded-lg",children:l.jsxDEV("p",{className:"text-blue-200 text-sm",children:[l.jsxDEV("strong",{children:"Note:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:140,columnNumber:13},void 0)," You can change your role later from your profile menu."]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:139,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:138,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:84,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/RoleSelectionModal.tsx",lineNumber:83,columnNumber:5},void 0):null},aA=()=>{const t=fl(),{user:n}=ic(),[e,s]=I.useState([]),[i,d]=I.useState("upcoming"),[c,f]=I.useState(!1),[p,g]=I.useState("all"),[x,b]=I.useState("all"),[E,w]=I.useState(""),[R,y]=I.useState(null),[U,q]=I.useState({name:"",date:"",location:"Great Hall",numberOfDays:1}),[G,_]=I.useState({name:"",date:"",location:"Great Hall",numberOfDays:1}),[ne,ee]=I.useState(!1),[Q,z]=I.useState(null),[ce,S]=I.useState(!1);I.useEffect(()=>{A()},[]),I.useEffect(()=>{const j=setInterval(()=>{console.log(" Auto-refreshing events list..."),A()},3e4);return()=>clearInterval(j)},[]);const A=async()=>{try{S(!0),console.log(" Loading events from Neon database...");const j=await it.getCalendarEvents();if(console.log(" Raw calendar events from Neon:",j),j&&j.length>0){console.log(" Processing calendar events:",j.length);const X=j.map((T,O)=>{console.log(` Processing event ${O}:`,{id:T.id,name:T.name,date:T.date,schedule_data:T.schedule_data,created_at:T.created_at});const F=new Date(T.date).toISOString().split("T")[0],de={id:T.id||Date.now().toString(),name:T.name,date:F,originalDate:T.date,location:T.schedule_data?.location||"Great Hall",numberOfDays:T.schedule_data?.numberOfDays||1,created_at:T.created_at||new Date().toISOString(),updated_at:T.updated_at||new Date().toISOString()};return console.log(` Transformed event ${O}:`,de),de});console.log(" All transformed events:",X),s(X),console.log(" Loaded events from Neon:",X.length),console.log(" Final events state:",X)}else{console.log(" No events found in Neon, checking localStorage...");const X=localStorage.getItem("events");if(X)try{const T=JSON.parse(X);s(T),console.log(" Loaded events from localStorage fallback:",T.length)}catch(T){console.error("Error loading events from localStorage:",T)}else console.log(" No events found in either Neon or localStorage"),s([])}}catch(j){console.error(" Error loading events from Neon:",j);const X=localStorage.getItem("events");if(X)try{const T=JSON.parse(X);s(T),console.log(" Fallback to localStorage due to error:",T.length)}catch(T){console.error("Error parsing localStorage events:",T),s([])}else s([])}finally{S(!1)}};I.useEffect(()=>{localStorage.setItem("events",JSON.stringify(e))},[e]);const W=async()=>{if(!G.name||!G.date||!G.location){alert("Please fill in all fields");return}const X={id:`event-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:G.name,date:G.date,location:G.location,numberOfDays:G.numberOfDays,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};f(!1),_({name:"",date:"",location:"Great Hall",numberOfDays:1}),s(T=>[...T,X]);try{console.log(" Saving new event to Neon:",X);const T={name:X.name,date:X.date,schedule_data:{location:X.location,numberOfDays:X.numberOfDays,eventId:X.id}},O=await it.saveCalendarEvent(T);console.log(" Calendar event saved to Neon:",O);const P=await it.saveRunOfShowData({event_id:X.id,event_name:X.name,event_date:X.date,schedule_items:[],custom_columns:[],settings:{eventName:X.name,masterStartTime:"",lastSaved:new Date().toISOString()}},{userId:n?.id||"unknown",userName:n?.user_metadata?.full_name||n?.email||"Unknown User",userRole:"EDITOR"});console.log(" Run of Show data created in Neon:",P),setTimeout(()=>{console.log(" Reloading events after save..."),A()},1e3)}catch(T){console.error(" Error auto-saving event to Neon:",T)}},H=async()=>{if(!R||!U.name||!U.date||!U.location){alert("Please fill in all fields");return}const j={...R,name:U.name,date:U.date,location:U.location,numberOfDays:U.numberOfDays,updated_at:new Date().toISOString()};y(null),q({name:"",date:"",location:"Great Hall",numberOfDays:1}),s(X=>X.map(T=>T.id===R.id?j:T));try{const T=(await it.getCalendarEvents()).find(O=>O.schedule_data?.eventId===R.id||O.name===R.name);if(T?.id){const O={name:j.name,date:j.date,schedule_data:{location:j.location,numberOfDays:j.numberOfDays,eventId:j.id}};await it.updateCalendarEvent(T.id,O),console.log("Calendar event updated in Supabase")}await it.updateRunOfShowData(R.id,{event_name:j.name,event_date:j.date,settings:{eventName:j.name,lastSaved:new Date().toISOString()}}),console.log("Run of Show data updated in Supabase")}catch(X){console.error("Error auto-updating event in Supabase:",X)}},K=async j=>{if(window.confirm("Are you sure you want to delete this event?")){s(X=>X.filter(T=>T.id!==j));try{const X=e.find(T=>T.id===j);if(X){await it.deleteRunOfShowData(j),console.log("Run of Show data deleted from Supabase automatically");const O=(await it.getCalendarEvents()).find(P=>P.schedule_data?.eventId===j||P.name===X.name);O?.id&&(await it.deleteCalendarEvent(O.id),console.log("Calendar event deleted from Supabase automatically"))}}catch(X){console.error("Error auto-deleting event from Supabase:",X)}}},Oe=j=>{y(j),q({name:j.name,date:j.date,location:j.location,numberOfDays:j.numberOfDays})},ye=j=>{z(j),ee(!0)},Pe=async j=>{if(Q&&n?.id){try{const X=n.user_metadata?.full_name||n.email||"Unknown";await it.saveUserSession(Q.id,n.id,X,j),console.log(" Role saved to Supabase from EventListPage:",j)}catch(X){console.error(" Failed to save role to Supabase from EventListPage:",X)}t("/run-of-show",{state:{event:Q,userRole:j}}),ee(!1),z(null)}},ve=j=>{const X=uh.find(T=>T.value===j);return X?X.color:"bg-gray-600"},Ge=j=>j instanceof Date&&!isNaN(j.getTime()),ie=j=>{const[X,T,O]=j.split("-").map(Number);return new Date(X,T-1,O).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"America/New_York"})},Ce=(()=>{console.log(" Filtering events:",{totalEvents:e.length,activeTab:i,filterLocation:p,filterDays:x,searchTerm:E,events:e.map(O=>({id:O.id,name:O.name,date:O.date}))});const j=new Date,X=new Date(j.getFullYear(),j.getMonth(),j.getDate()),T=e.filter(O=>{const[P,F,de]=O.date.split("-").map(Number),fe=new Date(P,F-1,de),ge=i==="upcoming"?fe>=X:fe<X,ze=p==="all"||O.location===p,oe=x==="all"||O.numberOfDays.toString()===x,Tt=E===""||O.name.toLowerCase().includes(E.toLowerCase())||O.location.toLowerCase().includes(E.toLowerCase()),ft=ge&&ze&&oe&&Tt;return console.log(` Event "${O.name}" filter result:`,{dateMatch:ge,locationMatch:ze,daysMatch:oe,searchMatch:Tt,passes:ft,eventDate:Ge(fe)?fe.toISOString():"Invalid Date",now:Ge(j)?j.toISOString():"Invalid Date"}),ft}).sort((O,P)=>{const F=new Date(O.date),de=new Date(P.date);return i==="upcoming"?F.getTime()-de.getTime():de.getTime()-F.getTime()});return console.log(" Filtered events result:",T.length,T.map(O=>O.name)),T})();return l.jsxDEV("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 text-slate-200 pt-16",children:[l.jsxDEV("div",{className:"text-center py-8",children:[l.jsxDEV("h1",{className:"text-4xl font-bold text-white mb-2",children:" Event List Calendar"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:430,columnNumber:9},void 0),l.jsxDEV("p",{className:"text-xl text-slate-400 mb-4",children:"Manage your events and schedules"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:433,columnNumber:9},void 0),n&&l.jsxDEV("div",{className:"text-center mb-6",children:l.jsxDEV("p",{className:"text-white font-medium text-lg",children:["Welcome back, ",n.user_metadata?.full_name||n.email,"!"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:438,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:437,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:429,columnNumber:7},void 0),l.jsxDEV("div",{className:"max-w-6xl mx-auto px-6",children:[l.jsxDEV("div",{className:"flex justify-center mb-8",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg p-1 flex",children:[l.jsxDEV("button",{onClick:()=>d("upcoming"),className:`px-6 py-3 rounded-md font-semibold transition-colors ${i==="upcoming"?"bg-green-600 text-white":"text-slate-400 hover:text-white"}`,children:" Upcoming Events"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:450,columnNumber:13},void 0),l.jsxDEV("button",{onClick:()=>d("past"),className:`px-6 py-3 rounded-md font-semibold transition-colors ${i==="past"?"bg-orange-600 text-white":"text-slate-400 hover:text-white"}`,children:" Past Events"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:460,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:449,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:448,columnNumber:9},void 0),l.jsxDEV("div",{className:"flex justify-center mb-6",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg p-4 w-full max-w-4xl",children:l.jsxDEV("div",{className:"flex items-center gap-6",children:[l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("span",{className:"text-white font-semibold",children:" Search:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:478,columnNumber:17},void 0),l.jsxDEV("input",{type:"text",value:E,onChange:j=>w(j.target.value),placeholder:"Search events by name or location...",className:"w-80 px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:479,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:477,columnNumber:15},void 0),l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("span",{className:"text-white font-semibold",children:" Filter by location:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:488,columnNumber:17},void 0),l.jsxDEV("select",{value:p,onChange:j=>g(j.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:[l.jsxDEV("option",{value:"all",children:"All Locations"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:494,columnNumber:19},void 0),uh.map(j=>l.jsxDEV("option",{value:j.value,children:j.label},j.value,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:496,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:489,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:487,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:476,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:475,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:474,columnNumber:9},void 0),l.jsxDEV("div",{className:"flex justify-center mb-8",children:l.jsxDEV("button",{onClick:()=>f(!0),className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors",children:"+ Add New Event"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:508,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:507,columnNumber:9},void 0),l.jsxDEV("div",{className:"bg-slate-800 rounded-xl p-6 shadow-2xl",children:[ce&&l.jsxDEV("div",{className:"text-center py-4 mb-4",children:l.jsxDEV("div",{className:"text-blue-400 text-lg",children:" Loading events..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:520,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:519,columnNumber:13},void 0),l.jsxDEV("div",{className:"bg-slate-800 rounded-lg overflow-hidden border border-slate-600",children:l.jsxDEV("div",{className:"overflow-x-auto",children:l.jsxDEV("table",{className:"w-full",children:[l.jsxDEV("thead",{className:"bg-slate-700",children:l.jsxDEV("tr",{children:[l.jsxDEV("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Event Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:528,columnNumber:21},void 0),l.jsxDEV("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Date"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:529,columnNumber:21},void 0),l.jsxDEV("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Location"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:530,columnNumber:21},void 0),l.jsxDEV("th",{className:"px-4 py-3 text-left text-slate-300 font-semibold border-r border-slate-600",children:"Duration"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:531,columnNumber:21},void 0),l.jsxDEV("th",{className:"px-4 py-3 text-center text-slate-300 font-semibold",children:"Actions"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:532,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:527,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:526,columnNumber:17},void 0),l.jsxDEV("tbody",{children:Ce.length===0?l.jsxDEV("tr",{children:l.jsxDEV("td",{colSpan:5,className:"px-4 py-12 text-center",children:[l.jsxDEV("div",{className:"text-6xl mb-4",children:i==="upcoming"?"":""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:539,columnNumber:25},void 0),l.jsxDEV("h3",{className:"text-2xl font-bold text-white mb-2",children:["No ",i," events"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:542,columnNumber:25},void 0),l.jsxDEV("p",{className:"text-slate-400",children:i==="upcoming"?"Add your first upcoming event to get started!":"Past events will appear here once you have some."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:545,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:538,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:537,columnNumber:21},void 0):Ce.map(j=>l.jsxDEV("tr",{className:"border-b border-slate-600",children:[l.jsxDEV("td",{className:"px-4 py-3 text-white font-medium border-r border-slate-600",children:j.name},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:556,columnNumber:25},void 0),l.jsxDEV("td",{className:"px-4 py-3 text-slate-300 border-r border-slate-600",children:ie(j.date)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:559,columnNumber:25},void 0),l.jsxDEV("td",{className:"px-4 py-3 border-r border-slate-600",children:l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("div",{className:`w-3 h-3 rounded-full ${ve(j.location)}`},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:564,columnNumber:29},void 0),l.jsxDEV("span",{className:"text-slate-300",children:j.location},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:565,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:563,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:562,columnNumber:25},void 0),l.jsxDEV("td",{className:"px-4 py-3 text-slate-300 border-r border-slate-600",children:[j.numberOfDays," day",j.numberOfDays>1?"s":""]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:568,columnNumber:25},void 0),l.jsxDEV("td",{className:"px-4 py-3",children:l.jsxDEV("div",{className:"flex gap-2 justify-center",children:[l.jsxDEV("button",{onClick:()=>ye(j),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm font-medium rounded transition-colors",children:"Launch"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:573,columnNumber:29},void 0),l.jsxDEV("button",{onClick:()=>Oe(j),className:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white text-sm font-medium rounded transition-colors",children:"Edit"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:579,columnNumber:29},void 0),l.jsxDEV("button",{onClick:()=>K(j.id),className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white text-sm font-medium rounded transition-colors",children:"Delete"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:585,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:572,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:571,columnNumber:25},void 0)]},j.id,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:555,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:535,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:525,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:524,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:523,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:517,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:446,columnNumber:7},void 0),c&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg p-4 max-w-sm w-full",children:[l.jsxDEV("h2",{className:"text-lg font-bold text-white mb-4",children:[l.jsxDEV("span",{style:{filter:"brightness(0) invert(1)"},children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:608,columnNumber:15},void 0)," Add New Event"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:607,columnNumber:13},void 0),l.jsxDEV("div",{className:"space-y-3",children:[l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Event Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:612,columnNumber:17},void 0),l.jsxDEV("input",{type:"text",value:G.name,onChange:j=>_(X=>({...X,name:j.target.value})),placeholder:"Enter event name",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:613,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:611,columnNumber:15},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Date"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:622,columnNumber:17},void 0),l.jsxDEV("input",{type:"date",value:G.date,onChange:j=>_(X=>({...X,date:j.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",style:{colorScheme:"dark"}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:623,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:621,columnNumber:15},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Location"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:634,columnNumber:17},void 0),l.jsxDEV("select",{value:G.location,onChange:j=>_(X=>({...X,location:j.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:uh.map(j=>l.jsxDEV("option",{value:j.value,children:j.label},j.value,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:641,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:635,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:633,columnNumber:15},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Duration"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:648,columnNumber:17},void 0),l.jsxDEV("select",{value:G.numberOfDays,onChange:j=>_(X=>({...X,numberOfDays:parseInt(j.target.value)})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:PO.map(j=>l.jsxDEV("option",{value:j,children:[j," day",j>1?"s":""]},j,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:655,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:649,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:647,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:610,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex gap-2 mt-4",children:[l.jsxDEV("button",{onClick:()=>{f(!1),_({name:"",date:"",location:"Great Hall",numberOfDays:1})},className:"flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded text-sm font-medium",children:"Cancel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:663,columnNumber:15},void 0),l.jsxDEV("button",{onClick:W,className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded text-sm font-medium",children:"Add Event"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:672,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:662,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:606,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:605,columnNumber:9},void 0),R&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg p-4 max-w-sm w-full",children:[l.jsxDEV("h2",{className:"text-lg font-bold text-white mb-4",children:[l.jsxDEV("span",{style:{filter:"brightness(0) invert(1)"},children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:688,columnNumber:15},void 0)," Edit Event"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:687,columnNumber:13},void 0),l.jsxDEV("div",{className:"space-y-3",children:[l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Event Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:692,columnNumber:17},void 0),l.jsxDEV("input",{type:"text",value:U.name,onChange:j=>q(X=>({...X,name:j.target.value})),placeholder:"Enter event name",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:693,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:691,columnNumber:15},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Date"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:702,columnNumber:17},void 0),l.jsxDEV("input",{type:"date",value:U.date,onChange:j=>q(X=>({...X,date:j.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",style:{colorScheme:"dark"}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:703,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:701,columnNumber:15},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Location"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:714,columnNumber:17},void 0),l.jsxDEV("select",{value:U.location,onChange:j=>q(X=>({...X,location:j.target.value})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:uh.map(j=>l.jsxDEV("option",{value:j.value,children:j.label},j.value,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:721,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:715,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:713,columnNumber:15},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Duration"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:728,columnNumber:17},void 0),l.jsxDEV("select",{value:U.numberOfDays,onChange:j=>q(X=>({...X,numberOfDays:parseInt(j.target.value)})),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:border-blue-500 focus:outline-none text-sm",children:PO.map(j=>l.jsxDEV("option",{value:j,children:[j," day",j>1?"s":""]},j,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:735,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:729,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:727,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:690,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex gap-2 mt-4",children:[l.jsxDEV("button",{onClick:()=>{y(null),q({name:"",date:"",location:"Great Hall",numberOfDays:1})},className:"flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded text-sm font-medium",children:"Cancel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:743,columnNumber:15},void 0),l.jsxDEV("button",{onClick:H,className:"flex-1 px-3 py-2 bg-green-600 hover:bg-green-500 text-white rounded text-sm font-medium",children:"Update Event"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:752,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:742,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:686,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:685,columnNumber:9},void 0),l.jsxDEV(ow,{isOpen:ne,onClose:()=>{ee(!1),z(null)},onRoleSelected:Pe,eventId:Q?.id||""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:764,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/EventListPage.tsx",lineNumber:427,columnNumber:5},void 0)};class sA{constructor(){this.localChanges=[],this.syncTimer=null,this.SYNC_DELAY=5e3,this.MAX_BATCH_SIZE=10,this.MAX_SYNC_ATTEMPTS=3,this.loadLocalChanges(),this.startSyncTimer()}addChange(n){const e={...n,id:`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date,synced:!1};this.localChanges.unshift(e),this.localChanges.length>1e3&&(this.localChanges=this.localChanges.slice(0,1e3)),this.saveLocalChanges(),console.log(" Change logged:",e.changeType,e.details),this.localChanges.filter(s=>!s.synced).length>=this.MAX_BATCH_SIZE&&this.syncChanges()}getLocalChanges(){return[...this.localChanges]}getUnsyncedChanges(){return this.localChanges.filter(n=>!n.synced)}getChangesCount(){const n=this.localChanges.length,e=this.localChanges.filter(s=>!s.synced).length;return{total:n,unsynced:e}}reloadLocalChanges(){this.loadLocalChanges(),console.log(" Reloaded local changes:",this.localChanges.length)}startSyncTimer(){this.syncTimer&&clearInterval(this.syncTimer),this.syncTimer=setInterval(()=>{const n=this.getUnsyncedChanges();n.length>0&&(console.log(` Auto-syncing ${n.length} changes...`),this.syncChanges())},this.SYNC_DELAY)}stopSyncTimer(){this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null)}async syncChanges(){try{const n=this.getUnsyncedChanges();if(n.length===0)return!0;console.log(` Syncing ${n.length} changes to API...`);try{return this.localChanges=this.localChanges.map(e=>({...e,synced:!0})),this.saveLocalChanges(),console.log(" All changes synced to localStorage (API sync disabled)"),!0}catch(e){return console.error(" Error syncing changes:",e),!1}}catch(n){return console.error(" Error syncing changes:",n),!1}}groupChangesByEvent(n){const e=new Map;for(const s of n)e.has(s.eventId)||e.set(s.eventId,[]),e.get(s.eventId).push(s);return e}async syncEventChanges(n,e){try{console.log(` Syncing ${e.length} changes for event ${n}`),console.log(" Changes to sync:",e.map(s=>({type:s.changeType,details:s.details,timestamp:s.timestamp})))}catch(s){throw console.error(" Error syncing event changes:",s),new Error(`Failed to sync changes for event ${n}: ${s.message}`)}}loadLocalChanges(){try{const n=localStorage.getItem("runofshow_local_changes");if(n){const e=JSON.parse(n);this.localChanges=e.map(s=>({...s,timestamp:new Date(s.timestamp)}))}}catch(n){console.error("Error loading local changes:",n),this.localChanges=[]}}saveLocalChanges(){try{localStorage.setItem("runofshow_local_changes",JSON.stringify(this.localChanges))}catch(n){console.error("Error saving local changes:",n)}}clearLocalChanges(){this.localChanges=[],this.saveLocalChanges(),console.log(" Local changes cleared")}async clearMasterChangeLog(n){try{return console.log(" Clearing master change log for event:",n),console.log(" Would clear master change log for event:",n),{success:!0,error:null,deletedCount:0}}catch(e){return console.error(" Error clearing master change log:",e),{success:!1,error:e.message||"Unexpected error",deletedCount:0}}}async getMasterChangeLog(n,e=100){try{return console.log(" Fetching master change log from API for event:",n),console.log(" Master change log disabled - using localStorage only"),[]}catch(s){return console.error(" Error getting master change log:",s),[]}}exportChangesAsJSON(){return JSON.stringify(this.localChanges,null,2)}exportChangesAsCSV(){if(this.localChanges.length===0)return"No changes to export";const n=["Timestamp","Event ID","Change Type","Row Number","Cue Number","Details","Segment Name","Synced"],e=this.localChanges.map(s=>[s.timestamp.toISOString(),s.eventId,s.changeType,s.rowNumber?.toString()||"",s.cueNumber?.toString()||"",s.details||"",s.segmentName||"",s.synced?"Yes":"No"]);return[n,...e].map(s=>s.join(",")).join(`
`)}}const Bn=new sA,Jl="https://ros-50-production.up.railway.app";class Ql{static async testBackupTable(){try{console.log(" Testing Neon backup table access...");const n=await fetch(`${Jl}/api/backups/test`,{method:"GET",headers:{"Content-Type":"application/json"}});return n.ok?(console.log(" Neon backup table is accessible"),!0):(console.error(" Backup table test failed:",n.statusText),!1)}catch(n){return console.error(" Backup table test error:",n),!1}}static async createBackup(n,e,s,i,d="auto",c,f,p,g){try{console.log(` Creating/updating ${d} backup for event: ${n}`),console.log(` API_BASE_URL: ${Jl}`);const x=i?.name||"Unknown Event",b=i?.date?new Date(i.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],E=i?.location||null,w=new Date().toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),R=c||`${d==="auto"?"Auto Backup":"Manual Backup"} - ${w}`,y={event_id:n,event_name:x,event_date:b,event_location:E,backup_name:R,backup_type:d,schedule_data:e,custom_columns_data:s,event_data:i,schedule_items_count:e?.length||0,custom_columns_count:s?.length||0,created_by:f||"unknown",created_by_name:p||"Unknown User",created_by_role:g||"VIEWER"},U=`${Jl}/api/backups`;console.log(` Full URL: ${U}`);const q=await fetch(U,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)});if(!q.ok){const _=await q.json();throw new Error(_.error||`HTTP ${q.status}: ${q.statusText}`)}const G=await q.json();return console.log(` Backup ${d==="auto"?"created/updated":"created"} successfully: ${G.backup_name}`),G}catch(x){throw console.error(" Error creating/updating backup:",x),new Error(`Failed to create/update backup: ${x.message}`)}}static async getBackupsForEvent(n){try{console.log(` Fetching backups for event: ${n}`);const e=await fetch(`${Jl}/api/backups/event/${n}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){const i=await e.json();throw new Error(i.error||`HTTP ${e.status}: ${e.statusText}`)}const s=await e.json();return console.log(` Found ${s?.length||0} backups for event: ${n}`),s||[]}catch(e){throw console.error(" Error fetching backups:",e),new Error(`Failed to fetch backups: ${e.message}`)}}static async getBackupsWithFilters(n={}){try{console.log(" Fetching backups with filters:",n);const e=new URLSearchParams;n.eventId&&e.append("eventId",n.eventId),n.eventName&&e.append("eventName",n.eventName),n.eventDate&&e.append("eventDate",n.eventDate),n.backupType&&e.append("backupType",n.backupType),n.sortBy&&e.append("sortBy",n.sortBy),n.limit&&e.append("limit",n.limit.toString());const s=await fetch(`${Jl}/api/backups?${e.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!s.ok){const d=await s.json();throw new Error(d.error||`HTTP ${s.status}: ${s.statusText}`)}const i=await s.json();return console.log(` Found ${i?.length||0} backups with filters`),i||[]}catch(e){throw console.error(" Error fetching backups with filters:",e),new Error(`Failed to fetch backups: ${e.message}`)}}static async restoreFromBackup(n){try{console.log(` Restoring from backup: ${n}`);const e=await fetch(`${Jl}/api/backups/${n}/restore`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){const i=await e.json();throw new Error(i.error||`HTTP ${e.status}: ${e.statusText}`)}const s=await e.json();if(!s)throw new Error("Backup not found");return console.log(` Restored from backup: ${s.backup_name}`),{scheduleData:s.schedule_data||[],customColumnsData:s.custom_columns_data||[],eventData:s.event_data||{},backupName:s.backup_name,backupTimestamp:s.backup_timestamp}}catch(e){throw console.error(" Error restoring from backup:",e),new Error(`Failed to restore from backup: ${e.message}`)}}static async deleteBackup(n){try{console.log(` Deleting backup: ${n}`);const e=await fetch(`${Jl}/api/backups/${n}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!e.ok){const s=await e.json();throw new Error(s.error||`HTTP ${e.status}: ${e.statusText}`)}return console.log(` Backup deleted successfully: ${n}`),!0}catch(e){throw console.error(" Error deleting backup:",e),new Error(`Failed to delete backup: ${e.message}`)}}static async getBackupStats(n){try{const e=await this.getBackupsForEvent(n),s=e.filter(c=>c.backup_type==="auto").length,i=e.filter(c=>c.backup_type==="manual").length,d=e.length>0?e[0].backup_timestamp:null;return{totalBackups:e.length,lastBackup:d,autoBackups:s,manualBackups:i}}catch(e){throw console.error(" Error getting backup stats:",e),new Error(`Failed to get backup stats: ${e.message}`)}}}const Ri=Object.create(null);Ri.open="0";Ri.close="1";Ri.ping="2";Ri.pong="3";Ri.message="4";Ri.upgrade="5";Ri.noop="6";const Eh=Object.create(null);Object.keys(Ri).forEach(t=>{Eh[Ri[t]]=t});const Ub={type:"error",data:"parser error"},lw=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",cw=typeof ArrayBuffer=="function",uw=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,tN=({type:t,data:n},e,s)=>lw&&n instanceof Blob?e?s(n):UO(n,s):cw&&(n instanceof ArrayBuffer||uw(n))?e?s(n):UO(new Blob([n]),s):s(Ri[t]+(n||"")),UO=(t,n)=>{const e=new FileReader;return e.onload=function(){const s=e.result.split(",")[1];n("b"+(s||""))},e.readAsDataURL(t)};function AO(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let vb;function iA(t,n){if(lw&&t.data instanceof Blob)return t.data.arrayBuffer().then(AO).then(n);if(cw&&(t.data instanceof ArrayBuffer||uw(t.data)))return n(AO(t.data));tN(t,!1,e=>{vb||(vb=new TextEncoder),n(vb.encode(e))})}const LO="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Sf=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<LO.length;t++)Sf[LO.charCodeAt(t)]=t;const oA=t=>{let n=t.length*.75,e=t.length,s,i=0,d,c,f,p;t[t.length-1]==="="&&(n--,t[t.length-2]==="="&&n--);const g=new ArrayBuffer(n),x=new Uint8Array(g);for(s=0;s<e;s+=4)d=Sf[t.charCodeAt(s)],c=Sf[t.charCodeAt(s+1)],f=Sf[t.charCodeAt(s+2)],p=Sf[t.charCodeAt(s+3)],x[i++]=d<<2|c>>4,x[i++]=(c&15)<<4|f>>2,x[i++]=(f&3)<<6|p&63;return g},lA=typeof ArrayBuffer=="function",rN=(t,n)=>{if(typeof t!="string")return{type:"message",data:dw(t,n)};const e=t.charAt(0);return e==="b"?{type:"message",data:cA(t.substring(1),n)}:Eh[e]?t.length>1?{type:Eh[e],data:t.substring(1)}:{type:Eh[e]}:Ub},cA=(t,n)=>{if(lA){const e=oA(t);return dw(e,n)}else return{base64:!0,data:t}},dw=(t,n)=>{switch(n){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},fw="",uA=(t,n)=>{const e=t.length,s=new Array(e);let i=0;t.forEach((d,c)=>{tN(d,!1,f=>{s[c]=f,++i===e&&n(s.join(fw))})})},dA=(t,n)=>{const e=t.split(fw),s=[];for(let i=0;i<e.length;i++){const d=rN(e[i],n);if(s.push(d),d.type==="error")break}return s};function fA(){return new TransformStream({transform(t,n){iA(t,e=>{const s=e.length;let i;if(s<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,s);else if(s<65536){i=new Uint8Array(3);const d=new DataView(i.buffer);d.setUint8(0,126),d.setUint16(1,s)}else{i=new Uint8Array(9);const d=new DataView(i.buffer);d.setUint8(0,127),d.setBigUint64(1,BigInt(s))}t.data&&typeof t.data!="string"&&(i[0]|=128),n.enqueue(i),n.enqueue(e)})}})}let gb;function dh(t){return t.reduce((n,e)=>n+e.length,0)}function fh(t,n){if(t[0].length===n)return t.shift();const e=new Uint8Array(n);let s=0;for(let i=0;i<n;i++)e[i]=t[0][s++],s===t[0].length&&(t.shift(),s=0);return t.length&&s<t[0].length&&(t[0]=t[0].slice(s)),e}function mA(t,n){gb||(gb=new TextDecoder);const e=[];let s=0,i=-1,d=!1;return new TransformStream({transform(c,f){for(e.push(c);;){if(s===0){if(dh(e)<1)break;const p=fh(e,1);d=(p[0]&128)===128,i=p[0]&127,i<126?s=3:i===126?s=1:s=2}else if(s===1){if(dh(e)<2)break;const p=fh(e,2);i=new DataView(p.buffer,p.byteOffset,p.length).getUint16(0),s=3}else if(s===2){if(dh(e)<8)break;const p=fh(e,8),g=new DataView(p.buffer,p.byteOffset,p.length),x=g.getUint32(0);if(x>Math.pow(2,21)-1){f.enqueue(Ub);break}i=x*Math.pow(2,32)+g.getUint32(4),s=3}else{if(dh(e)<i)break;const p=fh(e,i);f.enqueue(rN(d?p:gb.decode(p),n)),s=0}if(i===0||i>t){f.enqueue(Ub);break}}}})}const mw=4;function vn(t){if(t)return hA(t)}function hA(t){for(var n in vn.prototype)t[n]=vn.prototype[n];return t}vn.prototype.on=vn.prototype.addEventListener=function(t,n){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(n),this};vn.prototype.once=function(t,n){function e(){this.off(t,e),n.apply(this,arguments)}return e.fn=n,this.on(t,e),this};vn.prototype.off=vn.prototype.removeListener=vn.prototype.removeAllListeners=vn.prototype.removeEventListener=function(t,n){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+t];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var s,i=0;i<e.length;i++)if(s=e[i],s===n||s.fn===n){e.splice(i,1);break}return e.length===0&&delete this._callbacks["$"+t],this};vn.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var n=new Array(arguments.length-1),e=this._callbacks["$"+t],s=1;s<arguments.length;s++)n[s-1]=arguments[s];if(e){e=e.slice(0);for(var s=0,i=e.length;s<i;++s)e[s].apply(this,n)}return this};vn.prototype.emitReserved=vn.prototype.emit;vn.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};vn.prototype.hasListeners=function(t){return!!this.listeners(t).length};const zh=typeof Promise=="function"&&typeof Promise.resolve=="function"?n=>Promise.resolve().then(n):(n,e)=>e(n,0),Cs=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),pA="arraybuffer";function hw(t,...n){return n.reduce((e,s)=>(t.hasOwnProperty(s)&&(e[s]=t[s]),e),{})}const vA=Cs.setTimeout,gA=Cs.clearTimeout;function Xh(t,n){n.useNativeTimers?(t.setTimeoutFn=vA.bind(Cs),t.clearTimeoutFn=gA.bind(Cs)):(t.setTimeoutFn=Cs.setTimeout.bind(Cs),t.clearTimeoutFn=Cs.clearTimeout.bind(Cs))}const xA=1.33;function bA(t){return typeof t=="string"?NA(t):Math.ceil((t.byteLength||t.size)*xA)}function NA(t){let n=0,e=0;for(let s=0,i=t.length;s<i;s++)n=t.charCodeAt(s),n<128?e+=1:n<2048?e+=2:n<55296||n>=57344?e+=3:(s++,e+=4);return e}function pw(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function DA(t){let n="";for(let e in t)t.hasOwnProperty(e)&&(n.length&&(n+="&"),n+=encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return n}function SA(t){let n={},e=t.split("&");for(let s=0,i=e.length;s<i;s++){let d=e[s].split("=");n[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}return n}class yA extends Error{constructor(n,e,s){super(n),this.description=e,this.context=s,this.type="TransportError"}}class nN extends vn{constructor(n){super(),this.writable=!1,Xh(this,n),this.opts=n,this.query=n.query,this.socket=n.socket,this.supportsBinary=!n.forceBase64}onError(n,e,s){return super.emitReserved("error",new yA(n,e,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(n){this.readyState==="open"&&this.write(n)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(n){const e=rN(n,this.socket.binaryType);this.onPacket(e)}onPacket(n){super.emitReserved("packet",n)}onClose(n){this.readyState="closed",super.emitReserved("close",n)}pause(n){}createUri(n,e={}){return n+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const n=this.opts.hostname;return n.indexOf(":")===-1?n:"["+n+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(n){const e=DA(n);return e.length?"?"+e:""}}class OA extends nN{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(n){this.readyState="pausing";const e=()=>{this.readyState="paused",n()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||e()})),this.writable||(s++,this.once("drain",function(){--s||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(n){const e=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};dA(n,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const n=()=>{this.write([{type:"close"}])};this.readyState==="open"?n():this.once("open",n)}write(n){this.writable=!1,uA(n,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const n=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=pw()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(n,e)}}let vw=!1;try{vw=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const EA=vw;function wA(){}class CA extends OA{constructor(n){if(super(n),typeof location<"u"){const e=location.protocol==="https:";let s=location.port;s||(s=e?"443":"80"),this.xd=typeof location<"u"&&n.hostname!==location.hostname||s!==n.port}}doWrite(n,e){const s=this.request({method:"POST",data:n});s.on("success",e),s.on("error",(i,d)=>{this.onError("xhr post error",i,d)})}doPoll(){const n=this.request();n.on("data",this.onData.bind(this)),n.on("error",(e,s)=>{this.onError("xhr poll error",e,s)}),this.pollXhr=n}}class ki extends vn{constructor(n,e,s){super(),this.createRequest=n,Xh(this,s),this._opts=s,this._method=s.method||"GET",this._uri=e,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var n;const e=hw(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(e);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&s.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(n=this._opts.cookieJar)===null||n===void 0||n.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var i;s.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=ki.requestsCount++,ki.requests[this._index]=this)}_onError(n){this.emitReserved("error",n,this._xhr),this._cleanup(!0)}_cleanup(n){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=wA,n)try{this._xhr.abort()}catch{}typeof document<"u"&&delete ki.requests[this._index],this._xhr=null}}_onLoad(){const n=this._xhr.responseText;n!==null&&(this.emitReserved("data",n),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}ki.requestsCount=0;ki.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",VO);else if(typeof addEventListener=="function"){const t="onpagehide"in Cs?"pagehide":"unload";addEventListener(t,VO,!1)}}function VO(){for(let t in ki.requests)ki.requests.hasOwnProperty(t)&&ki.requests[t].abort()}const kA=(function(){const t=gw({xdomain:!1});return t&&t.responseType!==null})();class RA extends CA{constructor(n){super(n);const e=n&&n.forceBase64;this.supportsBinary=kA&&!e}request(n={}){return Object.assign(n,{xd:this.xd},this.opts),new ki(gw,this.uri(),n)}}function gw(t){const n=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!n||EA))return new XMLHttpRequest}catch{}if(!n)try{return new Cs[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const xw=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class TA extends nN{get name(){return"websocket"}doOpen(){const n=this.uri(),e=this.opts.protocols,s=xw?{}:hw(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(n,e,s)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=n=>this.onClose({description:"websocket connection closed",context:n}),this.ws.onmessage=n=>this.onData(n.data),this.ws.onerror=n=>this.onError("websocket error",n)}write(n){this.writable=!1;for(let e=0;e<n.length;e++){const s=n[e],i=e===n.length-1;tN(s,this.supportsBinary,d=>{try{this.doWrite(s,d)}catch{}i&&zh(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const n=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=pw()),this.supportsBinary||(e.b64=1),this.createUri(n,e)}}const xb=Cs.WebSocket||Cs.MozWebSocket;class _A extends TA{createSocket(n,e,s){return xw?new xb(n,e,s):e?new xb(n,e):new xb(n)}doWrite(n,e){this.ws.send(e)}}class PA extends nN{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(n){return this.emitReserved("error",n)}this._transport.closed.then(()=>{this.onClose()}).catch(n=>{this.onError("webtransport error",n)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(n=>{const e=mA(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=n.readable.pipeThrough(e).getReader(),i=fA();i.readable.pipeTo(n.writable),this._writer=i.writable.getWriter();const d=()=>{s.read().then(({done:f,value:p})=>{f||(this.onPacket(p),d())}).catch(f=>{})};d();const c={type:"open"};this.query.sid&&(c.data=`{"sid":"${this.query.sid}"}`),this._writer.write(c).then(()=>this.onOpen())})})}write(n){this.writable=!1;for(let e=0;e<n.length;e++){const s=n[e],i=e===n.length-1;this._writer.write(s).then(()=>{i&&zh(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var n;(n=this._transport)===null||n===void 0||n.close()}}const UA={websocket:_A,webtransport:PA,polling:RA},AA=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,LA=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Ab(t){if(t.length>8e3)throw"URI too long";const n=t,e=t.indexOf("["),s=t.indexOf("]");e!=-1&&s!=-1&&(t=t.substring(0,e)+t.substring(e,s).replace(/:/g,";")+t.substring(s,t.length));let i=AA.exec(t||""),d={},c=14;for(;c--;)d[LA[c]]=i[c]||"";return e!=-1&&s!=-1&&(d.source=n,d.host=d.host.substring(1,d.host.length-1).replace(/;/g,":"),d.authority=d.authority.replace("[","").replace("]","").replace(/;/g,":"),d.ipv6uri=!0),d.pathNames=VA(d,d.path),d.queryKey=jA(d,d.query),d}function VA(t,n){const e=/\/{2,9}/g,s=n.replace(e,"/").split("/");return(n.slice(0,1)=="/"||n.length===0)&&s.splice(0,1),n.slice(-1)=="/"&&s.splice(s.length-1,1),s}function jA(t,n){const e={};return n.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,i,d){i&&(e[i]=d)}),e}const Lb=typeof addEventListener=="function"&&typeof removeEventListener=="function",wh=[];Lb&&addEventListener("offline",()=>{wh.forEach(t=>t())},!1);class ll extends vn{constructor(n,e){if(super(),this.binaryType=pA,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,n&&typeof n=="object"&&(e=n,n=null),n){const s=Ab(n);e.hostname=s.host,e.secure=s.protocol==="https"||s.protocol==="wss",e.port=s.port,s.query&&(e.query=s.query)}else e.host&&(e.hostname=Ab(e.host).host);Xh(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(s=>{const i=s.prototype.name;this.transports.push(i),this._transportsByName[i]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=SA(this.opts.query)),Lb&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},wh.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(n){const e=Object.assign({},this.opts.query);e.EIO=mw,e.transport=n,this.id&&(e.sid=this.id);const s=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[n]);return new this._transportsByName[n](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const n=this.opts.rememberUpgrade&&ll.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(n);e.open(),this.setTransport(e)}setTransport(n){this.transport&&this.transport.removeAllListeners(),this.transport=n,n.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",ll.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",n),this.emitReserved("heartbeat"),n.type){case"open":this.onHandshake(JSON.parse(n.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=n.data,this._onError(e);break;case"message":this.emitReserved("data",n.data),this.emitReserved("message",n.data);break}}onHandshake(n){this.emitReserved("handshake",n),this.id=n.sid,this.transport.query.sid=n.sid,this._pingInterval=n.pingInterval,this._pingTimeout=n.pingTimeout,this._maxPayload=n.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const n=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+n,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},n),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const n=this._getWritablePackets();this.transport.send(n),this._prevBufferLen=n.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let s=0;s<this.writeBuffer.length;s++){const i=this.writeBuffer[s].data;if(i&&(e+=bA(i)),s>0&&e>this._maxPayload)return this.writeBuffer.slice(0,s);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const n=Date.now()>this._pingTimeoutTime;return n&&(this._pingTimeoutTime=0,zh(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),n}write(n,e,s){return this._sendPacket("message",n,e,s),this}send(n,e,s){return this._sendPacket("message",n,e,s),this}_sendPacket(n,e,s,i){if(typeof e=="function"&&(i=e,e=void 0),typeof s=="function"&&(i=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const d={type:n,data:e,options:s};this.emitReserved("packetCreate",d),this.writeBuffer.push(d),i&&this.once("flush",i),this.flush()}close(){const n=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),n()},s=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():n()}):this.upgrading?s():n()),this}_onError(n){if(ll.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",n),this._onClose("transport error",n)}_onClose(n,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Lb&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=wh.indexOf(this._offlineEventListener);s!==-1&&wh.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",n,e),this.writeBuffer=[],this._prevBufferLen=0}}}ll.protocol=mw;class IA extends ll{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let n=0;n<this._upgrades.length;n++)this._probe(this._upgrades[n])}_probe(n){let e=this.createTransport(n),s=!1;ll.priorWebsocketSuccess=!1;const i=()=>{s||(e.send([{type:"ping",data:"probe"}]),e.once("packet",b=>{if(!s)if(b.type==="pong"&&b.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;ll.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(x(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const E=new Error("probe error");E.transport=e.name,this.emitReserved("upgradeError",E)}}))};function d(){s||(s=!0,x(),e.close(),e=null)}const c=b=>{const E=new Error("probe error: "+b);E.transport=e.name,d(),this.emitReserved("upgradeError",E)};function f(){c("transport closed")}function p(){c("socket closed")}function g(b){e&&b.name!==e.name&&d()}const x=()=>{e.removeListener("open",i),e.removeListener("error",c),e.removeListener("close",f),this.off("close",p),this.off("upgrading",g)};e.once("open",i),e.once("error",c),e.once("close",f),this.once("close",p),this.once("upgrading",g),this._upgrades.indexOf("webtransport")!==-1&&n!=="webtransport"?this.setTimeoutFn(()=>{s||e.open()},200):e.open()}onHandshake(n){this._upgrades=this._filterUpgrades(n.upgrades),super.onHandshake(n)}_filterUpgrades(n){const e=[];for(let s=0;s<n.length;s++)~this.transports.indexOf(n[s])&&e.push(n[s]);return e}}let MA=class extends IA{constructor(n,e={}){const s=typeof n=="object"?n:e;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(i=>UA[i]).filter(i=>!!i)),super(n,s)}};function FA(t,n="",e){let s=t;e=e||typeof location<"u"&&location,t==null&&(t=e.protocol+"//"+e.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=e.protocol+t:t=e.host+t),/^(https?|wss?):\/\//.test(t)||(typeof e<"u"?t=e.protocol+"//"+t:t="https://"+t),s=Ab(t)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const d=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+d+":"+s.port+n,s.href=s.protocol+"://"+d+(e&&e.port===s.port?"":":"+s.port),s}const $A=typeof ArrayBuffer=="function",BA=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,bw=Object.prototype.toString,HA=typeof Blob=="function"||typeof Blob<"u"&&bw.call(Blob)==="[object BlobConstructor]",WA=typeof File=="function"||typeof File<"u"&&bw.call(File)==="[object FileConstructor]";function aN(t){return $A&&(t instanceof ArrayBuffer||BA(t))||HA&&t instanceof Blob||WA&&t instanceof File}function Ch(t,n){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let e=0,s=t.length;e<s;e++)if(Ch(t[e]))return!0;return!1}if(aN(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Ch(t.toJSON(),!0);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&Ch(t[e]))return!0;return!1}function zA(t){const n=[],e=t.data,s=t;return s.data=Vb(e,n),s.attachments=n.length,{packet:s,buffers:n}}function Vb(t,n){if(!t)return t;if(aN(t)){const e={_placeholder:!0,num:n.length};return n.push(t),e}else if(Array.isArray(t)){const e=new Array(t.length);for(let s=0;s<t.length;s++)e[s]=Vb(t[s],n);return e}else if(typeof t=="object"&&!(t instanceof Date)){const e={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=Vb(t[s],n));return e}return t}function XA(t,n){return t.data=jb(t.data,n),delete t.attachments,t}function jb(t,n){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<n.length)return n[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let e=0;e<t.length;e++)t[e]=jb(t[e],n);else if(typeof t=="object")for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(t[e]=jb(t[e],n));return t}const GA=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],YA=5;var dr;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(dr||(dr={}));class qA{constructor(n){this.replacer=n}encode(n){return(n.type===dr.EVENT||n.type===dr.ACK)&&Ch(n)?this.encodeAsBinary({type:n.type===dr.EVENT?dr.BINARY_EVENT:dr.BINARY_ACK,nsp:n.nsp,data:n.data,id:n.id}):[this.encodeAsString(n)]}encodeAsString(n){let e=""+n.type;return(n.type===dr.BINARY_EVENT||n.type===dr.BINARY_ACK)&&(e+=n.attachments+"-"),n.nsp&&n.nsp!=="/"&&(e+=n.nsp+","),n.id!=null&&(e+=n.id),n.data!=null&&(e+=JSON.stringify(n.data,this.replacer)),e}encodeAsBinary(n){const e=zA(n),s=this.encodeAsString(e.packet),i=e.buffers;return i.unshift(s),i}}function jO(t){return Object.prototype.toString.call(t)==="[object Object]"}class sN extends vn{constructor(n){super(),this.reviver=n}add(n){let e;if(typeof n=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(n);const s=e.type===dr.BINARY_EVENT;s||e.type===dr.BINARY_ACK?(e.type=s?dr.EVENT:dr.ACK,this.reconstructor=new KA(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(aN(n)||n.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(n),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+n)}decodeString(n){let e=0;const s={type:Number(n.charAt(0))};if(dr[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===dr.BINARY_EVENT||s.type===dr.BINARY_ACK){const d=e+1;for(;n.charAt(++e)!=="-"&&e!=n.length;);const c=n.substring(d,e);if(c!=Number(c)||n.charAt(e)!=="-")throw new Error("Illegal attachments");s.attachments=Number(c)}if(n.charAt(e+1)==="/"){const d=e+1;for(;++e&&!(n.charAt(e)===","||e===n.length););s.nsp=n.substring(d,e)}else s.nsp="/";const i=n.charAt(e+1);if(i!==""&&Number(i)==i){const d=e+1;for(;++e;){const c=n.charAt(e);if(c==null||Number(c)!=c){--e;break}if(e===n.length)break}s.id=Number(n.substring(d,e+1))}if(n.charAt(++e)){const d=this.tryParse(n.substr(e));if(sN.isPayloadValid(s.type,d))s.data=d;else throw new Error("invalid payload")}return s}tryParse(n){try{return JSON.parse(n,this.reviver)}catch{return!1}}static isPayloadValid(n,e){switch(n){case dr.CONNECT:return jO(e);case dr.DISCONNECT:return e===void 0;case dr.CONNECT_ERROR:return typeof e=="string"||jO(e);case dr.EVENT:case dr.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&GA.indexOf(e[0])===-1);case dr.ACK:case dr.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class KA{constructor(n){this.packet=n,this.buffers=[],this.reconPack=n}takeBinaryData(n){if(this.buffers.push(n),this.buffers.length===this.reconPack.attachments){const e=XA(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const JA=Object.freeze(Object.defineProperty({__proto__:null,Decoder:sN,Encoder:qA,get PacketType(){return dr},protocol:YA},Symbol.toStringTag,{value:"Module"}));function ei(t,n,e){return t.on(n,e),function(){t.off(n,e)}}const QA=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Nw extends vn{constructor(n,e,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=n,this.nsp=e,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const n=this.io;this.subs=[ei(n,"open",this.onopen.bind(this)),ei(n,"packet",this.onpacket.bind(this)),ei(n,"error",this.onerror.bind(this)),ei(n,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...n){return n.unshift("message"),this.emit.apply(this,n),this}emit(n,...e){var s,i,d;if(QA.hasOwnProperty(n))throw new Error('"'+n.toString()+'" is a reserved event name');if(e.unshift(n),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const c={type:dr.EVENT,data:e};if(c.options={},c.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const x=this.ids++,b=e.pop();this._registerAckCallback(x,b),c.id=x}const f=(i=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||i===void 0?void 0:i.writable,p=this.connected&&!(!((d=this.io.engine)===null||d===void 0)&&d._hasPingExpired());return this.flags.volatile&&!f||(p?(this.notifyOutgoingListeners(c),this.packet(c)):this.sendBuffer.push(c)),this.flags={},this}_registerAckCallback(n,e){var s;const i=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(i===void 0){this.acks[n]=e;return}const d=this.io.setTimeoutFn(()=>{delete this.acks[n];for(let f=0;f<this.sendBuffer.length;f++)this.sendBuffer[f].id===n&&this.sendBuffer.splice(f,1);e.call(this,new Error("operation has timed out"))},i),c=(...f)=>{this.io.clearTimeoutFn(d),e.apply(this,f)};c.withError=!0,this.acks[n]=c}emitWithAck(n,...e){return new Promise((s,i)=>{const d=(c,f)=>c?i(c):s(f);d.withError=!0,e.push(d),this.emit(n,...e)})}_addToQueue(n){let e;typeof n[n.length-1]=="function"&&(e=n.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:n,flags:Object.assign({fromQueue:!0},this.flags)};n.push((i,...d)=>s!==this._queue[0]?void 0:(i!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(i)):(this._queue.shift(),e&&e(null,...d)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(n=!1){if(!this.connected||this._queue.length===0)return;const e=this._queue[0];e.pending&&!n||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(n){n.nsp=this.nsp,this.io._packet(n)}onopen(){typeof this.auth=="function"?this.auth(n=>{this._sendConnectPacket(n)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(n){this.packet({type:dr.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},n):n})}onerror(n){this.connected||this.emitReserved("connect_error",n)}onclose(n,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",n,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(n=>{if(!this.sendBuffer.some(s=>String(s.id)===n)){const s=this.acks[n];delete this.acks[n],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(n){if(n.nsp===this.nsp)switch(n.type){case dr.CONNECT:n.data&&n.data.sid?this.onconnect(n.data.sid,n.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case dr.EVENT:case dr.BINARY_EVENT:this.onevent(n);break;case dr.ACK:case dr.BINARY_ACK:this.onack(n);break;case dr.DISCONNECT:this.ondisconnect();break;case dr.CONNECT_ERROR:this.destroy();const s=new Error(n.data.message);s.data=n.data.data,this.emitReserved("connect_error",s);break}}onevent(n){const e=n.data||[];n.id!=null&&e.push(this.ack(n.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(n){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const s of e)s.apply(this,n)}super.emit.apply(this,n),this._pid&&n.length&&typeof n[n.length-1]=="string"&&(this._lastOffset=n[n.length-1])}ack(n){const e=this;let s=!1;return function(...i){s||(s=!0,e.packet({type:dr.ACK,id:n,data:i}))}}onack(n){const e=this.acks[n.id];typeof e=="function"&&(delete this.acks[n.id],e.withError&&n.data.unshift(null),e.apply(this,n.data))}onconnect(n,e){this.id=n,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(n=>this.emitEvent(n)),this.receiveBuffer=[],this.sendBuffer.forEach(n=>{this.notifyOutgoingListeners(n),this.packet(n)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(n=>n()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:dr.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(n){return this.flags.compress=n,this}get volatile(){return this.flags.volatile=!0,this}timeout(n){return this.flags.timeout=n,this}onAny(n){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(n),this}prependAny(n){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(n),this}offAny(n){if(!this._anyListeners)return this;if(n){const e=this._anyListeners;for(let s=0;s<e.length;s++)if(n===e[s])return e.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(n){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(n),this}prependAnyOutgoing(n){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(n),this}offAnyOutgoing(n){if(!this._anyOutgoingListeners)return this;if(n){const e=this._anyOutgoingListeners;for(let s=0;s<e.length;s++)if(n===e[s])return e.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(n){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const s of e)s.apply(this,n.data)}}}function wu(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}wu.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var n=Math.random(),e=Math.floor(n*this.jitter*t);t=(Math.floor(n*10)&1)==0?t-e:t+e}return Math.min(t,this.max)|0};wu.prototype.reset=function(){this.attempts=0};wu.prototype.setMin=function(t){this.ms=t};wu.prototype.setMax=function(t){this.max=t};wu.prototype.setJitter=function(t){this.jitter=t};class Ib extends vn{constructor(n,e){var s;super(),this.nsps={},this.subs=[],n&&typeof n=="object"&&(e=n,n=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,Xh(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((s=e.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new wu({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=n;const i=e.parser||JA;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(n){return arguments.length?(this._reconnection=!!n,n||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(n){return n===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=n,this)}reconnectionDelay(n){var e;return n===void 0?this._reconnectionDelay:(this._reconnectionDelay=n,(e=this.backoff)===null||e===void 0||e.setMin(n),this)}randomizationFactor(n){var e;return n===void 0?this._randomizationFactor:(this._randomizationFactor=n,(e=this.backoff)===null||e===void 0||e.setJitter(n),this)}reconnectionDelayMax(n){var e;return n===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=n,(e=this.backoff)===null||e===void 0||e.setMax(n),this)}timeout(n){return arguments.length?(this._timeout=n,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(n){if(~this._readyState.indexOf("open"))return this;this.engine=new MA(this.uri,this.opts);const e=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const i=ei(e,"open",function(){s.onopen(),n&&n()}),d=f=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",f),n?n(f):this.maybeReconnectOnOpen()},c=ei(e,"error",d);if(this._timeout!==!1){const f=this._timeout,p=this.setTimeoutFn(()=>{i(),d(new Error("timeout")),e.close()},f);this.opts.autoUnref&&p.unref(),this.subs.push(()=>{this.clearTimeoutFn(p)})}return this.subs.push(i),this.subs.push(c),this}connect(n){return this.open(n)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const n=this.engine;this.subs.push(ei(n,"ping",this.onping.bind(this)),ei(n,"data",this.ondata.bind(this)),ei(n,"error",this.onerror.bind(this)),ei(n,"close",this.onclose.bind(this)),ei(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(n){try{this.decoder.add(n)}catch(e){this.onclose("parse error",e)}}ondecoded(n){zh(()=>{this.emitReserved("packet",n)},this.setTimeoutFn)}onerror(n){this.emitReserved("error",n)}socket(n,e){let s=this.nsps[n];return s?this._autoConnect&&!s.active&&s.connect():(s=new Nw(this,n,e),this.nsps[n]=s),s}_destroy(n){const e=Object.keys(this.nsps);for(const s of e)if(this.nsps[s].active)return;this._close()}_packet(n){const e=this.encoder.encode(n);for(let s=0;s<e.length;s++)this.engine.write(e[s],n.options)}cleanup(){this.subs.forEach(n=>n()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(n,e){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",n,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const n=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{n.skipReconnect||(this.emitReserved("reconnect_attempt",n.backoff.attempts),!n.skipReconnect&&n.open(i=>{i?(n._reconnecting=!1,n.reconnect(),this.emitReserved("reconnect_error",i)):n.onreconnect()}))},e);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const n=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",n)}}const Nf={};function kh(t,n){typeof t=="object"&&(n=t,t=void 0),n=n||{};const e=FA(t,n.path||"/socket.io"),s=e.source,i=e.id,d=e.path,c=Nf[i]&&d in Nf[i].nsps,f=n.forceNew||n["force new connection"]||n.multiplex===!1||c;let p;return f?p=new Ib(s,n):(Nf[i]||(Nf[i]=new Ib(s,n)),p=Nf[i]),e.query&&!n.query&&(n.query=e.queryKey),p.socket(e.path,n)}Object.assign(kh,{Manager:Ib,Socket:Nw,io:kh,connect:kh});const ZA="https://ros-50-production.up.railway.app";class eL{constructor(){this.socket=null,this.eventId=null,this.callbacks={},this.reconnectAttempts=0,this.maxReconnectAttempts=5}connect(n,e){if(this.socket&&this.eventId===n){console.log("Socket.IO already connected for this event.");return}this.disconnect(),this.eventId=n,this.callbacks=e,this.socket=kh(ZA,{transports:["websocket","polling"],timeout:1e4}),this.socket.on("connect",()=>{console.log(` Socket.IO connected for event: ${n}`),this.reconnectAttempts=0,this.callbacks.onConnectionChange?.(!0),this.socket?.emit("joinEvent",n),this.performInitialSync(n)}),this.socket.on("update",s=>{switch(console.log(" Socket.IO update received:",s.type),s.type){case"runOfShowDataUpdated":this.callbacks.onRunOfShowDataUpdated?.(s.data);break;case"completedCuesUpdated":this.callbacks.onCompletedCuesUpdated?.(s.data);break;case"timerUpdated":console.log(" SocketClient: Received timerUpdated event:",s.data),this.callbacks.onTimerUpdated?.(s.data);break;case"timerStopped":this.callbacks.onTimerStopped?.(s.data);break;case"timersStopped":this.callbacks.onTimersStopped?.(s.data);break;case"timerStarted":this.callbacks.onTimerStarted?.(s.data);break;case"subCueTimerStarted":this.callbacks.onSubCueTimerStarted?.(s.data);break;case"subCueTimerStopped":this.callbacks.onSubCueTimerStopped?.(s.data);break;case"activeTimersUpdated":console.log(" SocketClient: Received activeTimersUpdated event:",s.data),this.callbacks.onActiveTimersUpdated?.(s.data);break;case"resetAllStates":this.callbacks.onResetAllStates?.(s.data);break;case"timerMessageUpdated":console.log(" SocketClient: Received timerMessageUpdated event:",s.data),this.callbacks.onTimerMessageUpdated?.(s.data);break;default:console.log("Unknown Socket.IO message type:",s.type,s)}}),this.socket.on("disconnect",s=>{console.log(` Socket.IO disconnected: ${s}`),this.callbacks.onConnectionChange?.(!1),s!=="io client disconnect"&&this.reconnectAttempts<this.maxReconnectAttempts&&(this.reconnectAttempts++,console.log(` Attempting to reconnect Socket.IO (${this.reconnectAttempts}/${this.maxReconnectAttempts})...`),setTimeout(()=>{this.eventId&&this.connect(this.eventId,this.callbacks)},2e3*this.reconnectAttempts))}),this.socket.on("connect_error",s=>{console.error(" Socket.IO connection error:",s),this.callbacks.onConnectionChange?.(!1)})}disconnect(n){if(this.socket){if(n&&this.eventId!==n){console.log(`Socket.IO: Not disconnecting, current eventId (${this.eventId}) does not match requested eventId (${n}).`);return}console.log(` Disconnecting Socket.IO for event: ${this.eventId}`),this.eventId&&this.socket.emit("leaveEvent",this.eventId),this.socket.disconnect(),this.socket=null,this.eventId=null,this.callbacks.onConnectionChange?.(!1)}}isConnected(){return this.socket?.connected||!1}getEventId(){return this.eventId}emitResetAllStates(){this.socket&&this.eventId&&(console.log(" Emitting reset all states event"),this.socket.emit("resetAllStates",{eventId:this.eventId}))}emitSyncRequest(){this.socket&&this.eventId&&(console.log(" Emitting sync request event"),this.socket.emit("requestSync",{eventId:this.eventId}))}async performInitialSync(n){try{console.log(" Performing initial sync on WebSocket connect..."),this.callbacks.onInitialSync?(await this.callbacks.onInitialSync(),console.log(" Initial sync completed via callback")):console.log(" No initial sync callback provided")}catch(e){console.error(" Initial sync failed:",e)}}}const _r=new eL,tL=({isOpen:t,onClose:n,event:e})=>t?l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg p-6 w-full max-w-5xl max-h-[80vh] flex flex-col",children:[l.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[l.jsxDEV("h2",{className:"text-xl font-bold text-white",children:"OSC Control Panel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:21,columnNumber:11},void 0),l.jsxDEV("button",{onClick:n,className:"text-slate-400 hover:text-white text-xl",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:22,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:20,columnNumber:9},void 0),l.jsxDEV("div",{className:"flex-1 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxDEV("div",{className:"space-y-4",children:[l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-4",children:[l.jsxDEV("h3",{className:"text-sm font-semibold text-white mb-3",children:"Event Information"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:37,columnNumber:15},void 0),l.jsxDEV("div",{className:"space-y-2",children:[l.jsxDEV("div",{children:[l.jsxDEV("div",{className:"text-xs text-slate-400 mb-1",children:"Event ID:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:40,columnNumber:19},void 0),l.jsxDEV("div",{className:"px-3 py-2 bg-slate-600 border border-slate-500 rounded text-blue-400 font-mono text-sm",children:e?.id||"No event selected"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:41,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:39,columnNumber:17},void 0),l.jsxDEV("div",{children:[l.jsxDEV("div",{className:"text-xs text-slate-400 mb-1",children:"Event Name:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:46,columnNumber:19},void 0),l.jsxDEV("div",{className:"px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm",children:e?.name||"No event selected"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:47,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:45,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:38,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:36,columnNumber:13},void 0),l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-4",children:[l.jsxDEV("h3",{className:"text-sm font-semibold text-white mb-3 text-center",children:" Download Python OSC App"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:56,columnNumber:15},void 0),l.jsxDEV("div",{className:"text-center",children:[l.jsxDEV("a",{href:"/OSC_GUI_App_Enhanced_Updated.zip",download:"OSC_GUI_App_Enhanced_Updated.zip",className:"block bg-green-600 hover:bg-green-700 text-white text-sm py-3 px-6 rounded text-center transition-colors font-semibold",children:" Python OSC GUI App (Latest Version)"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:58,columnNumber:17},void 0),l.jsxDEV("div",{className:"text-xs text-green-400 mt-2",children:" Multi-day events  Day selection  Enhanced GUI  Latest fixes"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:65,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:57,columnNumber:15},void 0),l.jsxDEV("div",{className:"text-xs text-slate-500 mt-3 text-center",children:[l.jsxDEV("strong",{children:"Instructions:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:70,columnNumber:17},void 0)," Extract zip, run install.bat to install dependencies, then run_app.bat to start"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:69,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:55,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:34,columnNumber:11},void 0),l.jsxDEV("div",{className:"space-y-4",children:l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-4",children:[l.jsxDEV("h3",{className:"text-sm font-semibold text-white mb-3",children:"OSC Commands Reference"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:78,columnNumber:15},void 0),l.jsxDEV("div",{className:"text-xs text-slate-400 space-y-3",children:[l.jsxDEV("div",{children:[l.jsxDEV("div",{className:"font-semibold text-slate-300 mb-2",children:"Main Cue Commands (Day-Aware):"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:81,columnNumber:19},void 0),l.jsxDEV("div",{className:"font-mono bg-slate-800 p-2 rounded text-xs space-y-1",children:[l.jsxDEV("div",{children:"/cue/1/load"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:83,columnNumber:21},void 0),l.jsxDEV("div",{children:"/cue/1.1/load"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:84,columnNumber:21},void 0),l.jsxDEV("div",{children:"/cue/1A/load"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:85,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:82,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:80,columnNumber:17},void 0),l.jsxDEV("div",{children:[l.jsxDEV("div",{className:"font-semibold text-slate-300 mb-2",children:"Timer Commands:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:89,columnNumber:19},void 0),l.jsxDEV("div",{className:"font-mono bg-slate-800 p-2 rounded text-xs space-y-1",children:[l.jsxDEV("div",{children:"/timer/start"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:91,columnNumber:21},void 0),l.jsxDEV("div",{children:"/timer/stop"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:92,columnNumber:21},void 0),l.jsxDEV("div",{children:"/timer/reset"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:93,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:90,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:88,columnNumber:17},void 0),l.jsxDEV("div",{children:[l.jsxDEV("div",{className:"font-semibold text-slate-300 mb-2",children:"Sub-Timer Commands (Day-Aware):"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:97,columnNumber:19},void 0),l.jsxDEV("div",{className:"font-mono bg-slate-800 p-2 rounded text-xs space-y-1",children:[l.jsxDEV("div",{children:"/subtimer/cue/5/start"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:99,columnNumber:21},void 0),l.jsxDEV("div",{children:"/subtimer/cue/5/stop"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:100,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:98,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:96,columnNumber:17},void 0),l.jsxDEV("div",{children:[l.jsxDEV("div",{className:"font-semibold text-slate-300 mb-2",children:" Multi-Day Commands:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:104,columnNumber:19},void 0),l.jsxDEV("div",{className:"font-mono bg-slate-800 p-2 rounded text-xs space-y-1",children:[l.jsxDEV("div",{children:"/set-day 2"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:106,columnNumber:21},void 0),l.jsxDEV("div",{children:"/get-day"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:107,columnNumber:21},void 0),l.jsxDEV("div",{children:"/list-cues (shows current day only)"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:108,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:105,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:103,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:79,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:77,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:76,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:31,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:18,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/OSCModalSimplified.tsx",lineNumber:17,columnNumber:5},void 0):null,rL=({isOpen:t,onClose:n,onSelectFullscreenTimer:e,onSelectClock:s})=>t?l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg p-6 w-full max-w-2xl",children:[l.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[l.jsxDEV("h2",{className:"text-xl font-bold text-white",children:"Select Display Mode"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:23,columnNumber:11},void 0),l.jsxDEV("button",{onClick:n,className:"text-slate-400 hover:text-white text-2xl",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:24,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:22,columnNumber:9},void 0),l.jsxDEV("div",{className:"space-y-4",children:[l.jsxDEV("p",{className:"text-slate-300 text-sm mb-6",children:"Choose how you want to display the timer information:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:34,columnNumber:11},void 0),l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-3 mb-4",children:l.jsxDEV("p",{className:"text-slate-400 text-xs",children:[l.jsxDEV("strong",{children:"Fullscreen Timer:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:40,columnNumber:15},void 0)," Browser dependent - opens in new browser window",l.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:40,columnNumber:97},void 0),l.jsxDEV("strong",{children:"Clock:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:41,columnNumber:15},void 0)," Full web based - integrated web display"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:39,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:38,columnNumber:11},void 0),l.jsxDEV("button",{onClick:()=>{e(),n()},className:"w-full p-4 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors text-left",children:l.jsxDEV("div",{className:"flex items-center gap-3",children:[l.jsxDEV("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:l.jsxDEV("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:56,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:55,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:54,columnNumber:15},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h3",{className:"text-white font-semibold",children:"Fullscreen Timer"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:60,columnNumber:17},void 0),l.jsxDEV("p",{className:"text-slate-400 text-sm",children:"Browser dependent - opens in new browser window"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:61,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:59,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:53,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:46,columnNumber:11},void 0),l.jsxDEV("button",{onClick:()=>{s(),n()},className:"w-full p-4 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors text-left",children:l.jsxDEV("div",{className:"flex items-center gap-3",children:[l.jsxDEV("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:l.jsxDEV("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:77,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:76,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:75,columnNumber:15},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h3",{className:"text-white font-semibold",children:"Clock"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:81,columnNumber:17},void 0),l.jsxDEV("p",{className:"text-slate-400 text-sm",children:"Full web based - integrated web display"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:82,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:80,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:74,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:67,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:33,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:20,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DisplayModal.tsx",lineNumber:19,columnNumber:5},void 0):null;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Dw=1252,nL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],iN={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},oN=function(t){nL.indexOf(t)!=-1&&(Dw=iN[0]=t)};function aL(){oN(1252)}var ri=function(t){oN(t)};function Sw(){ri(1200),aL()}function IO(t){for(var n=[],e=0,s=t.length;e<s;++e)n[e]=t.charCodeAt(e);return n}function sL(t){for(var n=[],e=0;e<t.length>>1;++e)n[e]=String.fromCharCode(t.charCodeAt(2*e)+(t.charCodeAt(2*e+1)<<8));return n.join("")}function yw(t){for(var n=[],e=0;e<t.length>>1;++e)n[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return n.join("")}var yf=function(t){var n=t.charCodeAt(0),e=t.charCodeAt(1);return n==255&&e==254?sL(t.slice(2)):n==254&&e==255?yw(t.slice(2)):n==65279?t.slice(1):t},mh=function(n){return String.fromCharCode(n)},MO=function(n){return String.fromCharCode(n)},jf,il="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function FO(t){for(var n="",e=0,s=0,i=0,d=0,c=0,f=0,p=0,g=0;g<t.length;)e=t.charCodeAt(g++),d=e>>2,s=t.charCodeAt(g++),c=(e&3)<<4|s>>4,i=t.charCodeAt(g++),f=(s&15)<<2|i>>6,p=i&63,isNaN(s)?f=p=64:isNaN(i)&&(p=64),n+=il.charAt(d)+il.charAt(c)+il.charAt(f)+il.charAt(p);return n}function ds(t){var n="",e=0,s=0,i=0,d=0,c=0,f=0,p=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var g=0;g<t.length;)d=il.indexOf(t.charAt(g++)),c=il.indexOf(t.charAt(g++)),e=d<<2|c>>4,n+=String.fromCharCode(e),f=il.indexOf(t.charAt(g++)),s=(c&15)<<4|f>>2,f!==64&&(n+=String.fromCharCode(s)),p=il.indexOf(t.charAt(g++)),i=(f&3)<<6|p,p!==64&&(n+=String.fromCharCode(i));return n}var fr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),oc=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(n,e){return e?new Buffer(n,e):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function ul(t){return fr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function $O(t){return fr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ti=function(n){return fr?oc(n,"binary"):n.split("").map(function(e){return e.charCodeAt(0)&255})};function lc(t){if(Array.isArray(t))return t.map(function(s){return String.fromCharCode(s)}).join("");for(var n=[],e=0;e<t.length;++e)n[e]=String.fromCharCode(t[e]);return n.join("")}function lN(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return lN(new Uint8Array(t));for(var n=new Array(t.length),e=0;e<t.length;++e)n[e]=t[e];return n}var sl=fr?function(t){return Buffer.concat(t.map(function(n){return Buffer.isBuffer(n)?n:oc(n)}))}:function(t){if(typeof Uint8Array<"u"){var n=0,e=0;for(n=0;n<t.length;++n)e+=t[n].length;var s=new Uint8Array(e),i=0;for(n=0,e=0;n<t.length;e+=i,++n)if(i=t[n].length,t[n]instanceof Uint8Array)s.set(t[n],e);else{if(typeof t[n]=="string")throw"wtf";s.set(new Uint8Array(t[n]),e)}return s}return[].concat.apply([],t.map(function(d){return Array.isArray(d)?d:[].slice.call(d)}))};function iL(t){for(var n=[],e=0,s=t.length+250,i=ul(t.length+255),d=0;d<t.length;++d){var c=t.charCodeAt(d);if(c<128)i[e++]=c;else if(c<2048)i[e++]=192|c>>6&31,i[e++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var f=t.charCodeAt(++d)&1023;i[e++]=240|c>>8&7,i[e++]=128|c>>2&63,i[e++]=128|f>>6&15|(c&3)<<4,i[e++]=128|f&63}else i[e++]=224|c>>12&15,i[e++]=128|c>>6&63,i[e++]=128|c&63;e>s&&(n.push(i.slice(0,e)),e=0,i=ul(65535),s=65530)}return n.push(i.slice(0,e)),sl(n)}var ja=/\u0000/g,Of=/[\u0001-\u0006]/g;function bu(t){for(var n="",e=t.length-1;e>=0;)n+=t.charAt(e--);return n}function ni(t,n){var e=""+t;return e.length>=n?e:en("0",n-e.length)+e}function cN(t,n){var e=""+t;return e.length>=n?e:en(" ",n-e.length)+e}function _h(t,n){var e=""+t;return e.length>=n?e:e+en(" ",n-e.length)}function oL(t,n){var e=""+Math.round(t);return e.length>=n?e:en("0",n-e.length)+e}function lL(t,n){var e=""+t;return e.length>=n?e:en("0",n-e.length)+e}var BO=Math.pow(2,32);function hu(t,n){if(t>BO||t<-BO)return oL(t,n);var e=Math.round(t);return lL(e,n)}function Ph(t,n){return n=n||0,t.length>=7+n&&(t.charCodeAt(n)|32)===103&&(t.charCodeAt(n+1)|32)===101&&(t.charCodeAt(n+2)|32)===110&&(t.charCodeAt(n+3)|32)===101&&(t.charCodeAt(n+4)|32)===114&&(t.charCodeAt(n+5)|32)===97&&(t.charCodeAt(n+6)|32)===108}var HO=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],bb=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function cL(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Zt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},WO={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},uL={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Uh(t,n,e){for(var s=t<0?-1:1,i=t*s,d=0,c=1,f=0,p=1,g=0,x=0,b=Math.floor(i);g<n&&(b=Math.floor(i),f=b*c+d,x=b*g+p,!(i-b<5e-8));)i=1/(i-b),d=c,c=f,p=g,g=x;if(x>n&&(g>n?(x=p,f=d):(x=g,f=c)),!e)return[0,s*f,x];var E=Math.floor(s*f/x);return[E,s*f-E*x,x]}function ec(t,n,e){if(t>2958465||t<0)return null;var s=t|0,i=Math.floor(86400*(t-s)),d=0,c=[],f={D:s,T:i,u:86400*(t-s)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),n&&n.date1904&&(s+=1462),f.u>.9999&&(f.u=0,++i==86400&&(f.T=i=0,++s,++f.D)),s===60)c=e?[1317,10,29]:[1900,2,29],d=3;else if(s===0)c=e?[1317,8,29]:[1900,1,0],d=6;else{s>60&&--s;var p=new Date(1900,0,1);p.setDate(p.getDate()+s-1),c=[p.getFullYear(),p.getMonth()+1,p.getDate()],d=p.getDay(),s<60&&(d=(d+6)%7),e&&(d=vL(p,c))}return f.y=c[0],f.m=c[1],f.d=c[2],f.S=i%60,i=Math.floor(i/60),f.M=i%60,i=Math.floor(i/60),f.H=i,f.q=d,f}var Ow=new Date(1899,11,31,0,0,0),dL=Ow.getTime(),fL=new Date(1900,2,1,0,0,0);function Ew(t,n){var e=t.getTime();return n?e-=1461*24*60*60*1e3:t>=fL&&(e+=1440*60*1e3),(e-(dL+(t.getTimezoneOffset()-Ow.getTimezoneOffset())*6e4))/(1440*60*1e3)}function uN(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function mL(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function hL(t){var n=t<0?12:11,e=uN(t.toFixed(12));return e.length<=n||(e=t.toPrecision(10),e.length<=n)?e:t.toExponential(5)}function pL(t){var n=uN(t.toFixed(11));return n.length>(t<0?12:11)||n==="0"||n==="-0"?t.toPrecision(6):n}function If(t){var n=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return n>=-4&&n<=-1?e=t.toPrecision(10+n):Math.abs(n)<=9?e=hL(t):n===10?e=t.toFixed(10).substr(0,12):e=pL(t),uN(mL(e.toUpperCase()))}function nc(t,n){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):If(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ks(14,Ew(t,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+t)}function vL(t,n){n[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function gL(t,n,e,s){var i="",d=0,c=0,f=e.y,p,g=0;switch(t){case 98:f=e.y+543;case 121:switch(n.length){case 1:case 2:p=f%100,g=2;break;default:p=f%1e4,g=4;break}break;case 109:switch(n.length){case 1:case 2:p=e.m,g=n.length;break;case 3:return bb[e.m-1][1];case 5:return bb[e.m-1][0];default:return bb[e.m-1][2]}break;case 100:switch(n.length){case 1:case 2:p=e.d,g=n.length;break;case 3:return HO[e.q][0];default:return HO[e.q][1]}break;case 104:switch(n.length){case 1:case 2:p=1+(e.H+11)%12,g=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:p=e.H,g=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:p=e.M,g=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return e.u===0&&(n=="s"||n=="ss")?ni(e.S,n.length):(s>=2?c=s===3?1e3:100:c=s===1?10:1,d=Math.round(c*(e.S+e.u)),d>=60*c&&(d=0),n==="s"?d===0?"0":""+d/c:(i=ni(d,2+s),n==="ss"?i.substr(0,2):"."+i.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":p=e.D*24+e.H;break;case"[m]":case"[mm]":p=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":p=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+n}g=n.length===3?1:2;break;case 101:p=f,g=1;break}var x=g>0?ni(p,g):"";return x}function ol(t){var n=3;if(t.length<=n)return t;for(var e=t.length%n,s=t.substr(0,e);e!=t.length;e+=n)s+=(s.length>0?",":"")+t.substr(e,n);return s}var ww=/%/g;function xL(t,n,e){var s=n.replace(ww,""),i=n.length-s.length;return fo(t,s,e*Math.pow(10,2*i))+en("%",i)}function bL(t,n,e){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return fo(t,n.substr(0,s),e/Math.pow(10,3*(n.length-s)))}function Cw(t,n){var e,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Cw(t,-n);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var d=Math.floor(Math.log(n)*Math.LOG10E)%i;if(d<0&&(d+=i),e=(n/Math.pow(10,d)).toPrecision(s+1+(i+d)%i),e.indexOf("e")===-1){var c=Math.floor(Math.log(n)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(c-e.length+d):e+="E+"+(c-d);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,i)+"."+e.substr(2+i),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,p,g,x){return p+g+x.substr(0,(i+d)%i)+"."+x.substr(d)+"E"})}else e=n.toExponential(s);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var kw=/# (\?+)( ?)\/( ?)(\d+)/;function NL(t,n,e){var s=parseInt(t[4],10),i=Math.round(n*s),d=Math.floor(i/s),c=i-d*s,f=s;return e+(d===0?"":""+d)+" "+(c===0?en(" ",t[1].length+1+t[4].length):cN(c,t[1].length)+t[2]+"/"+t[3]+ni(f,t[4].length))}function DL(t,n,e){return e+(n===0?"":""+n)+en(" ",t[1].length+2+t[4].length)}var Rw=/^#*0*\.([0#]+)/,Tw=/\).*[0#]/,_w=/\(###\) ###\\?-####/;function Aa(t){for(var n="",e,s=0;s!=t.length;++s)switch(e=t.charCodeAt(s)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(e)}return n}function zO(t,n){var e=Math.pow(10,n);return""+Math.round(t*e)/e}function XO(t,n){var e=t-Math.floor(t),s=Math.pow(10,n);return n<(""+Math.round(e*s)).length?0:Math.round(e*s)}function SL(t,n){return n<(""+Math.round((t-Math.floor(t))*Math.pow(10,n))).length?1:0}function yL(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Os(t,n,e){if(t.charCodeAt(0)===40&&!n.match(Tw)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Os("n",s,e):"("+Os("n",s,-e)+")"}if(n.charCodeAt(n.length-1)===44)return bL(t,n,e);if(n.indexOf("%")!==-1)return xL(t,n,e);if(n.indexOf("E")!==-1)return Cw(n,e);if(n.charCodeAt(0)===36)return"$"+Os(t,n.substr(n.charAt(1)==" "?2:1),e);var i,d,c,f,p=Math.abs(e),g=e<0?"-":"";if(n.match(/^00+$/))return g+hu(p,n.length);if(n.match(/^[#?]+$/))return i=hu(e,0),i==="0"&&(i=""),i.length>n.length?i:Aa(n.substr(0,n.length-i.length))+i;if(d=n.match(kw))return NL(d,p,g);if(n.match(/^#+0+$/))return g+hu(p,n.length-n.indexOf("0"));if(d=n.match(Rw))return i=zO(e,d[1].length).replace(/^([^\.]+)$/,"$1."+Aa(d[1])).replace(/\.$/,"."+Aa(d[1])).replace(/\.(\d*)$/,function(R,y){return"."+y+en("0",Aa(d[1]).length-y.length)}),n.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),d=n.match(/^(0*)\.(#*)$/))return g+zO(p,d[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,d[1].length?"0.":".");if(d=n.match(/^#{1,3},##0(\.?)$/))return g+ol(hu(p,0));if(d=n.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Os(t,n,-e):ol(""+(Math.floor(e)+SL(e,d[1].length)))+"."+ni(XO(e,d[1].length),d[1].length);if(d=n.match(/^#,#*,#0/))return Os(t,n.replace(/^#,#*,/,""),e);if(d=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bu(Os(t,n.replace(/[\\-]/g,""),e)),c=0,bu(bu(n.replace(/\\/g,"")).replace(/[0#]/g,function(R){return c<i.length?i.charAt(c++):R==="0"?"0":""}));if(n.match(_w))return i=Os(t,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var x="";if(d=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(d[4].length,7),f=Uh(p,Math.pow(10,c)-1,!1),i=""+g,x=fo("n",d[1],f[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),i+=x+d[2]+"/"+d[3],x=_h(f[2],c),x.length<d[4].length&&(x=Aa(d[4].substr(d[4].length-x.length))+x),i+=x,i;if(d=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(d[1].length,d[4].length),7),f=Uh(p,Math.pow(10,c)-1,!0),g+(f[0]||(f[1]?"":"0"))+" "+(f[1]?cN(f[1],c)+d[2]+"/"+d[3]+_h(f[2],c):en(" ",2*c+1+d[2].length+d[3].length));if(d=n.match(/^[#0?]+$/))return i=hu(e,0),n.length<=i.length?i:Aa(n.substr(0,n.length-i.length))+i;if(d=n.match(/^([#0?]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(d[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var b=n.indexOf(".")-c,E=n.length-i.length-b;return Aa(n.substr(0,b)+i+n.substr(n.length-E))}if(d=n.match(/^00,000\.([#0]*0)$/))return c=XO(e,d[1].length),e<0?"-"+Os(t,n,-e):ol(yL(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(R){return"00,"+(R.length<3?ni(0,3-R.length):"")+R})+"."+ni(c,d[1].length);switch(n){case"###,##0.00":return Os(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var w=ol(hu(p,0));return w!=="0"?g+w:"";case"###,###.00":return Os(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Os(t,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function OL(t,n,e){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return fo(t,n.substr(0,s),e/Math.pow(10,3*(n.length-s)))}function EL(t,n,e){var s=n.replace(ww,""),i=n.length-s.length;return fo(t,s,e*Math.pow(10,2*i))+en("%",i)}function Pw(t,n){var e,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Pw(t,-n);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var d=Math.floor(Math.log(n)*Math.LOG10E)%i;if(d<0&&(d+=i),e=(n/Math.pow(10,d)).toPrecision(s+1+(i+d)%i),!e.match(/[Ee]/)){var c=Math.floor(Math.log(n)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(c-e.length+d):e+="E+"+(c-d),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,p,g,x){return p+g+x.substr(0,(i+d)%i)+"."+x.substr(d)+"E"})}else e=n.toExponential(s);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Ci(t,n,e){if(t.charCodeAt(0)===40&&!n.match(Tw)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ci("n",s,e):"("+Ci("n",s,-e)+")"}if(n.charCodeAt(n.length-1)===44)return OL(t,n,e);if(n.indexOf("%")!==-1)return EL(t,n,e);if(n.indexOf("E")!==-1)return Pw(n,e);if(n.charCodeAt(0)===36)return"$"+Ci(t,n.substr(n.charAt(1)==" "?2:1),e);var i,d,c,f,p=Math.abs(e),g=e<0?"-":"";if(n.match(/^00+$/))return g+ni(p,n.length);if(n.match(/^[#?]+$/))return i=""+e,e===0&&(i=""),i.length>n.length?i:Aa(n.substr(0,n.length-i.length))+i;if(d=n.match(kw))return DL(d,p,g);if(n.match(/^#+0+$/))return g+ni(p,n.length-n.indexOf("0"));if(d=n.match(Rw))return i=(""+e).replace(/^([^\.]+)$/,"$1."+Aa(d[1])).replace(/\.$/,"."+Aa(d[1])),i=i.replace(/\.(\d*)$/,function(R,y){return"."+y+en("0",Aa(d[1]).length-y.length)}),n.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),d=n.match(/^(0*)\.(#*)$/))return g+(""+p).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,d[1].length?"0.":".");if(d=n.match(/^#{1,3},##0(\.?)$/))return g+ol(""+p);if(d=n.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ci(t,n,-e):ol(""+e)+"."+en("0",d[1].length);if(d=n.match(/^#,#*,#0/))return Ci(t,n.replace(/^#,#*,/,""),e);if(d=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bu(Ci(t,n.replace(/[\\-]/g,""),e)),c=0,bu(bu(n.replace(/\\/g,"")).replace(/[0#]/g,function(R){return c<i.length?i.charAt(c++):R==="0"?"0":""}));if(n.match(_w))return i=Ci(t,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var x="";if(d=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(d[4].length,7),f=Uh(p,Math.pow(10,c)-1,!1),i=""+g,x=fo("n",d[1],f[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),i+=x+d[2]+"/"+d[3],x=_h(f[2],c),x.length<d[4].length&&(x=Aa(d[4].substr(d[4].length-x.length))+x),i+=x,i;if(d=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(d[1].length,d[4].length),7),f=Uh(p,Math.pow(10,c)-1,!0),g+(f[0]||(f[1]?"":"0"))+" "+(f[1]?cN(f[1],c)+d[2]+"/"+d[3]+_h(f[2],c):en(" ",2*c+1+d[2].length+d[3].length));if(d=n.match(/^[#0?]+$/))return i=""+e,n.length<=i.length?i:Aa(n.substr(0,n.length-i.length))+i;if(d=n.match(/^([#0]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(d[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var b=n.indexOf(".")-c,E=n.length-i.length-b;return Aa(n.substr(0,b)+i+n.substr(n.length-E))}if(d=n.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Ci(t,n,-e):ol(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(R){return"00,"+(R.length<3?ni(0,3-R.length):"")+R})+"."+ni(0,d[1].length);switch(n){case"###,###":case"##,###":case"#,###":var w=ol(""+p);return w!=="0"?g+w:"";default:if(n.match(/\.[0#?]*$/))return Ci(t,n.slice(0,n.lastIndexOf(".")),e)+Aa(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function fo(t,n,e){return(e|0)===e?Ci(t,n,e):Os(t,n,e)}function wL(t){for(var n=[],e=!1,s=0,i=0;s<t.length;++s)switch(t.charCodeAt(s)){case 34:e=!e;break;case 95:case 42:case 92:++s;break;case 59:n[n.length]=t.substr(i,s-i),i=s+1}if(n[n.length]=t.substr(i),e===!0)throw new Error("Format |"+t+"| unterminated string ");return n}var Uw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Cu(t){for(var n=0,e="",s="";n<t.length;)switch(e=t.charAt(n)){case"G":Ph(t,n)&&(n+=6),n++;break;case'"':for(;t.charCodeAt(++n)!==34&&n<t.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(t.charAt(n+1)==="1"||t.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(n,3).toUpperCase()==="A/P"||t.substr(n,5).toUpperCase()==="AM/PM"||t.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(s=e;t.charAt(n++)!=="]"&&n<t.length;)s+=t.charAt(n);if(s.match(Uw))return!0;break;case".":case"0":case"#":for(;n<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++n))>-1||e=="\\"&&t.charAt(n+1)=="-"&&"0#".indexOf(t.charAt(n+2))>-1););break;case"?":for(;t.charAt(++n)===e;);break;case"*":++n,(t.charAt(n)==" "||t.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<t.length&&"0123456789".indexOf(t.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function CL(t,n,e,s){for(var i=[],d="",c=0,f="",p="t",g,x,b,E="H";c<t.length;)switch(f=t.charAt(c)){case"G":if(!Ph(t,c))throw new Error("unrecognized character "+f+" in "+t);i[i.length]={t:"G",v:"General"},c+=7;break;case'"':for(d="";(b=t.charCodeAt(++c))!==34&&c<t.length;)d+=String.fromCharCode(b);i[i.length]={t:"t",v:d},++c;break;case"\\":var w=t.charAt(++c),R=w==="("||w===")"?w:"t";i[i.length]={t:R,v:w},++c;break;case"_":i[i.length]={t:"t",v:" "},c+=2;break;case"@":i[i.length]={t:"T",v:n},++c;break;case"B":case"b":if(t.charAt(c+1)==="1"||t.charAt(c+1)==="2"){if(g==null&&(g=ec(n,e,t.charAt(c+1)==="2"),g==null))return"";i[i.length]={t:"X",v:t.substr(c,2)},p=f,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||g==null&&(g=ec(n,e),g==null))return"";for(d=f;++c<t.length&&t.charAt(c).toLowerCase()===f;)d+=f;f==="m"&&p.toLowerCase()==="h"&&(f="M"),f==="h"&&(f=E),i[i.length]={t:f,v:d},p=f;break;case"A":case"a":case"":var y={t:f,v:f};if(g==null&&(g=ec(n,e)),t.substr(c,3).toUpperCase()==="A/P"?(g!=null&&(y.v=g.H>=12?"P":"A"),y.t="T",E="h",c+=3):t.substr(c,5).toUpperCase()==="AM/PM"?(g!=null&&(y.v=g.H>=12?"PM":"AM"),y.t="T",c+=5,E="h"):t.substr(c,5).toUpperCase()==="/"?(g!=null&&(y.v=g.H>=12?"":""),y.t="T",c+=5,E="h"):(y.t="t",++c),g==null&&y.t==="T")return"";i[i.length]=y,p=f;break;case"[":for(d=f;t.charAt(c++)!=="]"&&c<t.length;)d+=t.charAt(c);if(d.slice(-1)!=="]")throw'unterminated "[" block: |'+d+"|";if(d.match(Uw)){if(g==null&&(g=ec(n,e),g==null))return"";i[i.length]={t:"Z",v:d.toLowerCase()},p=d.charAt(1)}else d.indexOf("$")>-1&&(d=(d.match(/\$([^-\[\]]*)/)||[])[1]||"$",Cu(t)||(i[i.length]={t:"t",v:d}));break;case".":if(g!=null){for(d=f;++c<t.length&&(f=t.charAt(c))==="0";)d+=f;i[i.length]={t:"s",v:d};break}case"0":case"#":for(d=f;++c<t.length&&"0#?.,E+-%".indexOf(f=t.charAt(c))>-1;)d+=f;i[i.length]={t:"n",v:d};break;case"?":for(d=f;t.charAt(++c)===f;)d+=f;i[i.length]={t:f,v:d},p=f;break;case"*":++c,(t.charAt(c)==" "||t.charAt(c)=="*")&&++c;break;case"(":case")":i[i.length]={t:s===1?"t":f,v:f},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(d=f;c<t.length&&"0123456789".indexOf(t.charAt(++c))>-1;)d+=t.charAt(c);i[i.length]={t:"D",v:d};break;case" ":i[i.length]={t:f,v:f},++c;break;case"$":i[i.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(f)===-1)throw new Error("unrecognized character "+f+" in "+t);i[i.length]={t:"t",v:f},++c;break}var U=0,q=0,G;for(c=i.length-1,p="t";c>=0;--c)switch(i[c].t){case"h":case"H":i[c].t=E,p="h",U<1&&(U=1);break;case"s":(G=i[c].v.match(/\.0+$/))&&(q=Math.max(q,G[0].length-1)),U<3&&(U=3);case"d":case"y":case"M":case"e":p=i[c].t;break;case"m":p==="s"&&(i[c].t="M",U<2&&(U=2));break;case"X":break;case"Z":U<1&&i[c].v.match(/[Hh]/)&&(U=1),U<2&&i[c].v.match(/[Mm]/)&&(U=2),U<3&&i[c].v.match(/[Ss]/)&&(U=3)}switch(U){case 0:break;case 1:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M),g.M>=60&&(g.M=0,++g.H);break;case 2:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M);break}var _="",ne;for(c=0;c<i.length;++c)switch(i[c].t){case"t":case"T":case" ":case"D":break;case"X":i[c].v="",i[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[c].v=gL(i[c].t.charCodeAt(0),i[c].v,g,q),i[c].t="t";break;case"n":case"?":for(ne=c+1;i[ne]!=null&&((f=i[ne].t)==="?"||f==="D"||(f===" "||f==="t")&&i[ne+1]!=null&&(i[ne+1].t==="?"||i[ne+1].t==="t"&&i[ne+1].v==="/")||i[c].t==="("&&(f===" "||f==="n"||f===")")||f==="t"&&(i[ne].v==="/"||i[ne].v===" "&&i[ne+1]!=null&&i[ne+1].t=="?"));)i[c].v+=i[ne].v,i[ne]={v:"",t:";"},++ne;_+=i[c].v,c=ne-1;break;case"G":i[c].t="t",i[c].v=nc(n,e);break}var ee="",Q,z;if(_.length>0){_.charCodeAt(0)==40?(Q=n<0&&_.charCodeAt(0)===45?-n:n,z=fo("n",_,Q)):(Q=n<0&&s>1?-n:n,z=fo("n",_,Q),Q<0&&i[0]&&i[0].t=="t"&&(z=z.substr(1),i[0].v="-"+i[0].v)),ne=z.length-1;var ce=i.length;for(c=0;c<i.length;++c)if(i[c]!=null&&i[c].t!="t"&&i[c].v.indexOf(".")>-1){ce=c;break}var S=i.length;if(ce===i.length&&z.indexOf("E")===-1){for(c=i.length-1;c>=0;--c)i[c]==null||"n?".indexOf(i[c].t)===-1||(ne>=i[c].v.length-1?(ne-=i[c].v.length,i[c].v=z.substr(ne+1,i[c].v.length)):ne<0?i[c].v="":(i[c].v=z.substr(0,ne+1),ne=-1),i[c].t="t",S=c);ne>=0&&S<i.length&&(i[S].v=z.substr(0,ne+1)+i[S].v)}else if(ce!==i.length&&z.indexOf("E")===-1){for(ne=z.indexOf(".")-1,c=ce;c>=0;--c)if(!(i[c]==null||"n?".indexOf(i[c].t)===-1)){for(x=i[c].v.indexOf(".")>-1&&c===ce?i[c].v.indexOf(".")-1:i[c].v.length-1,ee=i[c].v.substr(x+1);x>=0;--x)ne>=0&&(i[c].v.charAt(x)==="0"||i[c].v.charAt(x)==="#")&&(ee=z.charAt(ne--)+ee);i[c].v=ee,i[c].t="t",S=c}for(ne>=0&&S<i.length&&(i[S].v=z.substr(0,ne+1)+i[S].v),ne=z.indexOf(".")+1,c=ce;c<i.length;++c)if(!(i[c]==null||"n?(".indexOf(i[c].t)===-1&&c!==ce)){for(x=i[c].v.indexOf(".")>-1&&c===ce?i[c].v.indexOf(".")+1:0,ee=i[c].v.substr(0,x);x<i[c].v.length;++x)ne<z.length&&(ee+=z.charAt(ne++));i[c].v=ee,i[c].t="t",S=c}}}for(c=0;c<i.length;++c)i[c]!=null&&"n?".indexOf(i[c].t)>-1&&(Q=s>1&&n<0&&c>0&&i[c-1].v==="-"?-n:n,i[c].v=fo(i[c].t,i[c].v,Q),i[c].t="t");var A="";for(c=0;c!==i.length;++c)i[c]!=null&&(A+=i[c].v);return A}var GO=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function YO(t,n){if(n==null)return!1;var e=parseFloat(n[2]);switch(n[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function kL(t,n){var e=wL(t),s=e.length,i=e[s-1].indexOf("@");if(s<4&&i>-1&&--s,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof n!="number")return[4,e.length===4||i>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=i>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=i>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=i>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var d=n>0?e[0]:n<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[s,d];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var c=e[0].match(GO),f=e[1].match(GO);return YO(n,c)?[s,e[0]]:YO(n,f)?[s,e[1]]:[s,e[c!=null&&f!=null?2:1]]}return[s,d]}function ks(t,n,e){e==null&&(e={});var s="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?s=e.dateNF:s=t;break;case"number":t==14&&e.dateNF?s=e.dateNF:s=(e.table!=null?e.table:Zt)[t],s==null&&(s=e.table&&e.table[WO[t]]||Zt[WO[t]]),s==null&&(s=uL[t]||"General");break}if(Ph(s,0))return nc(n,e);n instanceof Date&&(n=Ew(n,e.date1904));var i=kL(s,n);if(Ph(i[1]))return nc(n,e);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return CL(i[1],n,e,i[0])}function tc(t,n){if(typeof n!="number"){n=+n||-1;for(var e=0;e<392;++e){if(Zt[e]==null){n<0&&(n=e);continue}if(Zt[e]==t){n=e;break}}n<0&&(n=391)}return Zt[n]=t,n}function Aw(){Zt=cL()}var RL={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Lw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function TL(t){var n=typeof t=="number"?Zt[t]:t;return n=n.replace(Lw,"(\\d+)"),new RegExp("^"+n+"$")}function _L(t,n,e){var s=-1,i=-1,d=-1,c=-1,f=-1,p=-1;(n.match(Lw)||[]).forEach(function(b,E){var w=parseInt(e[E+1],10);switch(b.toLowerCase().charAt(0)){case"y":s=w;break;case"d":d=w;break;case"h":c=w;break;case"s":p=w;break;case"m":c>=0?f=w:i=w;break}}),p>=0&&f==-1&&i>=0&&(f=i,i=-1);var g=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(d>=1?d:1)).slice(-2);g.length==7&&(g="0"+g),g.length==8&&(g="20"+g);var x=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(p>=0?p:0)).slice(-2);return c==-1&&f==-1&&p==-1?g:s==-1&&i==-1&&d==-1?x:g+"T"+x}var PL=(function(){var t={};t.version="1.2.0";function n(){for(var z=0,ce=new Array(256),S=0;S!=256;++S)z=S,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,ce[S]=z;return typeof Int32Array<"u"?new Int32Array(ce):ce}var e=n();function s(z){var ce=0,S=0,A=0,W=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(A=0;A!=256;++A)W[A]=z[A];for(A=0;A!=256;++A)for(S=z[A],ce=256+A;ce<4096;ce+=256)S=W[ce]=S>>>8^z[S&255];var H=[];for(A=1;A!=16;++A)H[A-1]=typeof Int32Array<"u"?W.subarray(A*256,A*256+256):W.slice(A*256,A*256+256);return H}var i=s(e),d=i[0],c=i[1],f=i[2],p=i[3],g=i[4],x=i[5],b=i[6],E=i[7],w=i[8],R=i[9],y=i[10],U=i[11],q=i[12],G=i[13],_=i[14];function ne(z,ce){for(var S=ce^-1,A=0,W=z.length;A<W;)S=S>>>8^e[(S^z.charCodeAt(A++))&255];return~S}function ee(z,ce){for(var S=ce^-1,A=z.length-15,W=0;W<A;)S=_[z[W++]^S&255]^G[z[W++]^S>>8&255]^q[z[W++]^S>>16&255]^U[z[W++]^S>>>24]^y[z[W++]]^R[z[W++]]^w[z[W++]]^E[z[W++]]^b[z[W++]]^x[z[W++]]^g[z[W++]]^p[z[W++]]^f[z[W++]]^c[z[W++]]^d[z[W++]]^e[z[W++]];for(A+=15;W<A;)S=S>>>8^e[(S^z[W++])&255];return~S}function Q(z,ce){for(var S=ce^-1,A=0,W=z.length,H=0,K=0;A<W;)H=z.charCodeAt(A++),H<128?S=S>>>8^e[(S^H)&255]:H<2048?(S=S>>>8^e[(S^(192|H>>6&31))&255],S=S>>>8^e[(S^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,K=z.charCodeAt(A++)&1023,S=S>>>8^e[(S^(240|H>>8&7))&255],S=S>>>8^e[(S^(128|H>>2&63))&255],S=S>>>8^e[(S^(128|K>>6&15|(H&3)<<4))&255],S=S>>>8^e[(S^(128|K&63))&255]):(S=S>>>8^e[(S^(224|H>>12&15))&255],S=S>>>8^e[(S^(128|H>>6&63))&255],S=S>>>8^e[(S^(128|H&63))&255]);return~S}return t.table=e,t.bstr=ne,t.buf=ee,t.str=Q,t})(),vr=(function(){var n={};n.version="1.2.1";function e(L,Z){for(var J=L.split("/"),Y=Z.split("/"),ae=0,se=0,xe=Math.min(J.length,Y.length);ae<xe;++ae){if(se=J[ae].length-Y[ae].length)return se;if(J[ae]!=Y[ae])return J[ae]<Y[ae]?-1:1}return J.length-Y.length}function s(L){if(L.charAt(L.length-1)=="/")return L.slice(0,-1).indexOf("/")===-1?L:s(L.slice(0,-1));var Z=L.lastIndexOf("/");return Z===-1?L:L.slice(0,Z+1)}function i(L){if(L.charAt(L.length-1)=="/")return i(L.slice(0,-1));var Z=L.lastIndexOf("/");return Z===-1?L:L.slice(Z+1)}function d(L,Z){typeof Z=="string"&&(Z=new Date(Z));var J=Z.getHours();J=J<<6|Z.getMinutes(),J=J<<5|Z.getSeconds()>>>1,L.write_shift(2,J);var Y=Z.getFullYear()-1980;Y=Y<<4|Z.getMonth()+1,Y=Y<<5|Z.getDate(),L.write_shift(2,Y)}function c(L){var Z=L.read_shift(2)&65535,J=L.read_shift(2)&65535,Y=new Date,ae=J&31;J>>>=5;var se=J&15;J>>>=4,Y.setMilliseconds(0),Y.setFullYear(J+1980),Y.setMonth(se-1),Y.setDate(ae);var xe=Z&31;Z>>>=5;var je=Z&63;return Z>>>=6,Y.setHours(Z),Y.setMinutes(je),Y.setSeconds(xe<<1),Y}function f(L){oa(L,0);for(var Z={},J=0;L.l<=L.length-4;){var Y=L.read_shift(2),ae=L.read_shift(2),se=L.l+ae,xe={};switch(Y){case 21589:J=L.read_shift(1),J&1&&(xe.mtime=L.read_shift(4)),ae>5&&(J&2&&(xe.atime=L.read_shift(4)),J&4&&(xe.ctime=L.read_shift(4))),xe.mtime&&(xe.mt=new Date(xe.mtime*1e3));break}L.l=se,Z[Y]=xe}return Z}var p;function g(){return p||(p={})}function x(L,Z){if(L[0]==80&&L[1]==75)return nr(L,Z);if((L[0]|32)==109&&(L[1]|32)==105)return qt(L,Z);if(L.length<512)throw new Error("CFB file size "+L.length+" < 512");var J=3,Y=512,ae=0,se=0,xe=0,je=0,Se=0,we=[],Re=L.slice(0,512);oa(Re,0);var Ue=b(Re);switch(J=Ue[0],J){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Ue[1]==0)return nr(L,Z);default:throw new Error("Major Version: Expected 3 or 4 saw "+J)}Y!==512&&(Re=L.slice(0,Y),oa(Re,28));var Ze=L.slice(0,Y);E(Re,J);var at=Re.read_shift(4,"i");if(J===3&&at!==0)throw new Error("# Directory Sectors: Expected 0 saw "+at);Re.l+=4,xe=Re.read_shift(4,"i"),Re.l+=4,Re.chk("00100000","Mini Stream Cutoff Size: "),je=Re.read_shift(4,"i"),ae=Re.read_shift(4,"i"),Se=Re.read_shift(4,"i"),se=Re.read_shift(4,"i");for(var et=-1,lt=0;lt<109&&(et=Re.read_shift(4,"i"),!(et<0));++lt)we[lt]=et;var ot=w(L,Y);U(Se,se,ot,Y,we);var yr=G(ot,xe,we,Y);yr[xe].name="!Directory",ae>0&&je!==K&&(yr[je].name="!MiniFAT"),yr[we[0]].name="!FAT",yr.fat_addrs=we,yr.ssz=Y;var ir={},Wr=[],Ar=[],Fr=[];_(xe,yr,ot,Wr,ae,ir,Ar,je),R(Ar,Fr,Wr),Wr.shift();var Ka={FileIndex:Ar,FullPaths:Fr};return Z&&Z.raw&&(Ka.raw={header:Ze,sectors:ot}),Ka}function b(L){if(L[L.l]==80&&L[L.l+1]==75)return[0,0];L.chk(Oe,"Header Signature: "),L.l+=16;var Z=L.read_shift(2,"u");return[L.read_shift(2,"u"),Z]}function E(L,Z){var J=9;switch(L.l+=2,J=L.read_shift(2)){case 9:if(Z!=3)throw new Error("Sector Shift: Expected 9 saw "+J);break;case 12:if(Z!=4)throw new Error("Sector Shift: Expected 12 saw "+J);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+J)}L.chk("0600","Mini Sector Shift: "),L.chk("000000000000","Reserved: ")}function w(L,Z){for(var J=Math.ceil(L.length/Z)-1,Y=[],ae=1;ae<J;++ae)Y[ae-1]=L.slice(ae*Z,(ae+1)*Z);return Y[J-1]=L.slice(J*Z),Y}function R(L,Z,J){for(var Y=0,ae=0,se=0,xe=0,je=0,Se=J.length,we=[],Re=[];Y<Se;++Y)we[Y]=Re[Y]=Y,Z[Y]=J[Y];for(;je<Re.length;++je)Y=Re[je],ae=L[Y].L,se=L[Y].R,xe=L[Y].C,we[Y]===Y&&(ae!==-1&&we[ae]!==ae&&(we[Y]=we[ae]),se!==-1&&we[se]!==se&&(we[Y]=we[se])),xe!==-1&&(we[xe]=Y),ae!==-1&&Y!=we[Y]&&(we[ae]=we[Y],Re.lastIndexOf(ae)<je&&Re.push(ae)),se!==-1&&Y!=we[Y]&&(we[se]=we[Y],Re.lastIndexOf(se)<je&&Re.push(se));for(Y=1;Y<Se;++Y)we[Y]===Y&&(se!==-1&&we[se]!==se?we[Y]=we[se]:ae!==-1&&we[ae]!==ae&&(we[Y]=we[ae]));for(Y=1;Y<Se;++Y)if(L[Y].type!==0){if(je=Y,je!=we[je])do je=we[je],Z[Y]=Z[je]+"/"+Z[Y];while(je!==0&&we[je]!==-1&&je!=we[je]);we[Y]=-1}for(Z[0]+="/",Y=1;Y<Se;++Y)L[Y].type!==2&&(Z[Y]+="/")}function y(L,Z,J){for(var Y=L.start,ae=L.size,se=[],xe=Y;J&&ae>0&&xe>=0;)se.push(Z.slice(xe*H,xe*H+H)),ae-=H,xe=Zl(J,xe*4);return se.length===0?_n(0):sl(se).slice(0,L.size)}function U(L,Z,J,Y,ae){var se=K;if(L===K){if(Z!==0)throw new Error("DIFAT chain shorter than expected")}else if(L!==-1){var xe=J[L],je=(Y>>>2)-1;if(!xe)return;for(var Se=0;Se<je&&(se=Zl(xe,Se*4))!==K;++Se)ae.push(se);U(Zl(xe,Y-4),Z-1,J,Y,ae)}}function q(L,Z,J,Y,ae){var se=[],xe=[];ae||(ae=[]);var je=Y-1,Se=0,we=0;for(Se=Z;Se>=0;){ae[Se]=!0,se[se.length]=Se,xe.push(L[Se]);var Re=J[Math.floor(Se*4/Y)];if(we=Se*4&je,Y<4+we)throw new Error("FAT boundary crossed: "+Se+" 4 "+Y);if(!L[Re])break;Se=Zl(L[Re],we)}return{nodes:se,data:aE([xe])}}function G(L,Z,J,Y){var ae=L.length,se=[],xe=[],je=[],Se=[],we=Y-1,Re=0,Ue=0,Ze=0,at=0;for(Re=0;Re<ae;++Re)if(je=[],Ze=Re+Z,Ze>=ae&&(Ze-=ae),!xe[Ze]){Se=[];var et=[];for(Ue=Ze;Ue>=0;){et[Ue]=!0,xe[Ue]=!0,je[je.length]=Ue,Se.push(L[Ue]);var lt=J[Math.floor(Ue*4/Y)];if(at=Ue*4&we,Y<4+at)throw new Error("FAT boundary crossed: "+Ue+" 4 "+Y);if(!L[lt]||(Ue=Zl(L[lt],at),et[Ue]))break}se[Ze]={nodes:je,data:aE([Se])}}return se}function _(L,Z,J,Y,ae,se,xe,je){for(var Se=0,we=Y.length?2:0,Re=Z[L].data,Ue=0,Ze=0,at;Ue<Re.length;Ue+=128){var et=Re.slice(Ue,Ue+128);oa(et,64),Ze=et.read_shift(2),at=pN(et,0,Ze-we),Y.push(at);var lt={name:at,type:et.read_shift(1),color:et.read_shift(1),L:et.read_shift(4,"i"),R:et.read_shift(4,"i"),C:et.read_shift(4,"i"),clsid:et.read_shift(16),state:et.read_shift(4,"i"),start:0,size:0},ot=et.read_shift(2)+et.read_shift(2)+et.read_shift(2)+et.read_shift(2);ot!==0&&(lt.ct=ne(et,et.l-8));var yr=et.read_shift(2)+et.read_shift(2)+et.read_shift(2)+et.read_shift(2);yr!==0&&(lt.mt=ne(et,et.l-8)),lt.start=et.read_shift(4,"i"),lt.size=et.read_shift(4,"i"),lt.size<0&&lt.start<0&&(lt.size=lt.type=0,lt.start=K,lt.name=""),lt.type===5?(Se=lt.start,ae>0&&Se!==K&&(Z[Se].name="!StreamData")):lt.size>=4096?(lt.storage="fat",Z[lt.start]===void 0&&(Z[lt.start]=q(J,lt.start,Z.fat_addrs,Z.ssz)),Z[lt.start].name=lt.name,lt.content=Z[lt.start].data.slice(0,lt.size)):(lt.storage="minifat",lt.size<0?lt.size=0:Se!==K&&lt.start!==K&&Z[Se]&&(lt.content=y(lt,Z[Se].data,(Z[je]||{}).data))),lt.content&&oa(lt.content,0),se[at]=lt,xe.push(lt)}}function ne(L,Z){return new Date((cs(L,Z+4)/1e7*Math.pow(2,32)+cs(L,Z)/1e7-11644473600)*1e3)}function ee(L,Z){return g(),x(p.readFileSync(L),Z)}function Q(L,Z){var J=Z&&Z.type;switch(J||fr&&Buffer.isBuffer(L)&&(J="buffer"),J||"base64"){case"file":return ee(L,Z);case"base64":return x(ti(ds(L)),Z);case"binary":return x(ti(L),Z)}return x(L,Z)}function z(L,Z){var J=Z||{},Y=J.root||"Root Entry";if(L.FullPaths||(L.FullPaths=[]),L.FileIndex||(L.FileIndex=[]),L.FullPaths.length!==L.FileIndex.length)throw new Error("inconsistent CFB structure");L.FullPaths.length===0&&(L.FullPaths[0]=Y+"/",L.FileIndex[0]={name:Y,type:5}),J.CLSID&&(L.FileIndex[0].clsid=J.CLSID),ce(L)}function ce(L){var Z="Sh33tJ5";if(!vr.find(L,"/"+Z)){var J=_n(4);J[0]=55,J[1]=J[3]=50,J[2]=54,L.FileIndex.push({name:Z,type:2,content:J,size:4,L:69,R:69,C:69}),L.FullPaths.push(L.FullPaths[0]+Z),S(L)}}function S(L,Z){z(L);for(var J=!1,Y=!1,ae=L.FullPaths.length-1;ae>=0;--ae){var se=L.FileIndex[ae];switch(se.type){case 0:Y?J=!0:(L.FileIndex.pop(),L.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(se.R*se.L*se.C)&&(J=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(J=!0);break;default:J=!0;break}}if(!(!J&&!Z)){var xe=new Date(1987,1,19),je=0,Se=Object.create?Object.create(null):{},we=[];for(ae=0;ae<L.FullPaths.length;++ae)Se[L.FullPaths[ae]]=!0,L.FileIndex[ae].type!==0&&we.push([L.FullPaths[ae],L.FileIndex[ae]]);for(ae=0;ae<we.length;++ae){var Re=s(we[ae][0]);Y=Se[Re],Y||(we.push([Re,{name:i(Re).replace("/",""),type:1,clsid:Pe,ct:xe,mt:xe,content:null}]),Se[Re]=!0)}for(we.sort(function(at,et){return e(at[0],et[0])}),L.FullPaths=[],L.FileIndex=[],ae=0;ae<we.length;++ae)L.FullPaths[ae]=we[ae][0],L.FileIndex[ae]=we[ae][1];for(ae=0;ae<we.length;++ae){var Ue=L.FileIndex[ae],Ze=L.FullPaths[ae];if(Ue.name=i(Ze).replace("/",""),Ue.L=Ue.R=Ue.C=-(Ue.color=1),Ue.size=Ue.content?Ue.content.length:0,Ue.start=0,Ue.clsid=Ue.clsid||Pe,ae===0)Ue.C=we.length>1?1:-1,Ue.size=0,Ue.type=5;else if(Ze.slice(-1)=="/"){for(je=ae+1;je<we.length&&s(L.FullPaths[je])!=Ze;++je);for(Ue.C=je>=we.length?-1:je,je=ae+1;je<we.length&&s(L.FullPaths[je])!=s(Ze);++je);Ue.R=je>=we.length?-1:je,Ue.type=1}else s(L.FullPaths[ae+1]||"")==s(Ze)&&(Ue.R=ae+1),Ue.type=2}}}function A(L,Z){var J=Z||{};if(J.fileType=="mad")return Ln(L,J);switch(S(L),J.fileType){case"zip":return An(L,J)}var Y=(function(at){for(var et=0,lt=0,ot=0;ot<at.FileIndex.length;++ot){var yr=at.FileIndex[ot];if(yr.content){var ir=yr.content.length;ir>0&&(ir<4096?et+=ir+63>>6:lt+=ir+511>>9)}}for(var Wr=at.FullPaths.length+3>>2,Ar=et+7>>3,Fr=et+127>>7,Ka=Ar+lt+Wr+Fr,zn=Ka+127>>7,_s=zn<=109?0:Math.ceil((zn-109)/127);Ka+zn+_s+127>>7>zn;)_s=++zn<=109?0:Math.ceil((zn-109)/127);var Xn=[1,_s,zn,Fr,Wr,lt,et,0];return at.FileIndex[0].size=et<<6,Xn[7]=(at.FileIndex[0].start=Xn[0]+Xn[1]+Xn[2]+Xn[3]+Xn[4]+Xn[5])+(Xn[6]+7>>3),Xn})(L),ae=_n(Y[7]<<9),se=0,xe=0;{for(se=0;se<8;++se)ae.write_shift(1,ye[se]);for(se=0;se<8;++se)ae.write_shift(2,0);for(ae.write_shift(2,62),ae.write_shift(2,3),ae.write_shift(2,65534),ae.write_shift(2,9),ae.write_shift(2,6),se=0;se<3;++se)ae.write_shift(2,0);for(ae.write_shift(4,0),ae.write_shift(4,Y[2]),ae.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),ae.write_shift(4,0),ae.write_shift(4,4096),ae.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:K),ae.write_shift(4,Y[3]),ae.write_shift(-4,Y[1]?Y[0]-1:K),ae.write_shift(4,Y[1]),se=0;se<109;++se)ae.write_shift(-4,se<Y[2]?Y[1]+se:-1)}if(Y[1])for(xe=0;xe<Y[1];++xe){for(;se<236+xe*127;++se)ae.write_shift(-4,se<Y[2]?Y[1]+se:-1);ae.write_shift(-4,xe===Y[1]-1?K:xe+1)}var je=function(at){for(xe+=at;se<xe-1;++se)ae.write_shift(-4,se+1);at&&(++se,ae.write_shift(-4,K))};for(xe=se=0,xe+=Y[1];se<xe;++se)ae.write_shift(-4,ve.DIFSECT);for(xe+=Y[2];se<xe;++se)ae.write_shift(-4,ve.FATSECT);je(Y[3]),je(Y[4]);for(var Se=0,we=0,Re=L.FileIndex[0];Se<L.FileIndex.length;++Se)Re=L.FileIndex[Se],Re.content&&(we=Re.content.length,!(we<4096)&&(Re.start=xe,je(we+511>>9)));for(je(Y[6]+7>>3);ae.l&511;)ae.write_shift(-4,ve.ENDOFCHAIN);for(xe=se=0,Se=0;Se<L.FileIndex.length;++Se)Re=L.FileIndex[Se],Re.content&&(we=Re.content.length,!(!we||we>=4096)&&(Re.start=xe,je(we+63>>6)));for(;ae.l&511;)ae.write_shift(-4,ve.ENDOFCHAIN);for(se=0;se<Y[4]<<2;++se){var Ue=L.FullPaths[se];if(!Ue||Ue.length===0){for(Se=0;Se<17;++Se)ae.write_shift(4,0);for(Se=0;Se<3;++Se)ae.write_shift(4,-1);for(Se=0;Se<12;++Se)ae.write_shift(4,0);continue}Re=L.FileIndex[se],se===0&&(Re.start=Re.size?Re.start-1:K);var Ze=se===0&&J.root||Re.name;if(we=2*(Ze.length+1),ae.write_shift(64,Ze,"utf16le"),ae.write_shift(2,we),ae.write_shift(1,Re.type),ae.write_shift(1,Re.color),ae.write_shift(-4,Re.L),ae.write_shift(-4,Re.R),ae.write_shift(-4,Re.C),Re.clsid)ae.write_shift(16,Re.clsid,"hex");else for(Se=0;Se<4;++Se)ae.write_shift(4,0);ae.write_shift(4,Re.state||0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,Re.start),ae.write_shift(4,Re.size),ae.write_shift(4,0)}for(se=1;se<L.FileIndex.length;++se)if(Re=L.FileIndex[se],Re.size>=4096)if(ae.l=Re.start+1<<9,fr&&Buffer.isBuffer(Re.content))Re.content.copy(ae,ae.l,0,Re.size),ae.l+=Re.size+511&-512;else{for(Se=0;Se<Re.size;++Se)ae.write_shift(1,Re.content[Se]);for(;Se&511;++Se)ae.write_shift(1,0)}for(se=1;se<L.FileIndex.length;++se)if(Re=L.FileIndex[se],Re.size>0&&Re.size<4096)if(fr&&Buffer.isBuffer(Re.content))Re.content.copy(ae,ae.l,0,Re.size),ae.l+=Re.size+63&-64;else{for(Se=0;Se<Re.size;++Se)ae.write_shift(1,Re.content[Se]);for(;Se&63;++Se)ae.write_shift(1,0)}if(fr)ae.l=ae.length;else for(;ae.l<ae.length;)ae.write_shift(1,0);return ae}function W(L,Z){var J=L.FullPaths.map(function(Se){return Se.toUpperCase()}),Y=J.map(function(Se){var we=Se.split("/");return we[we.length-(Se.slice(-1)=="/"?2:1)]}),ae=!1;Z.charCodeAt(0)===47?(ae=!0,Z=J[0].slice(0,-1)+Z):ae=Z.indexOf("/")!==-1;var se=Z.toUpperCase(),xe=ae===!0?J.indexOf(se):Y.indexOf(se);if(xe!==-1)return L.FileIndex[xe];var je=!se.match(Of);for(se=se.replace(ja,""),je&&(se=se.replace(Of,"!")),xe=0;xe<J.length;++xe)if((je?J[xe].replace(Of,"!"):J[xe]).replace(ja,"")==se||(je?Y[xe].replace(Of,"!"):Y[xe]).replace(ja,"")==se)return L.FileIndex[xe];return null}var H=64,K=-2,Oe="d0cf11e0a1b11ae1",ye=[208,207,17,224,161,177,26,225],Pe="00000000000000000000000000000000",ve={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:K,FREESECT:-1,HEADER_SIGNATURE:Oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Pe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ge(L,Z,J){g();var Y=A(L,J);p.writeFileSync(Z,Y)}function ie(L){for(var Z=new Array(L.length),J=0;J<L.length;++J)Z[J]=String.fromCharCode(L[J]);return Z.join("")}function Ee(L,Z){var J=A(L,Z);switch(Z&&Z.type||"buffer"){case"file":return g(),p.writeFileSync(Z.filename,J),J;case"binary":return typeof J=="string"?J:ie(J);case"base64":return FO(typeof J=="string"?J:ie(J));case"buffer":if(fr)return Buffer.isBuffer(J)?J:oc(J);case"array":return typeof J=="string"?ti(J):J}return J}var Ce;function j(L){try{var Z=L.InflateRaw,J=new Z;if(J._processChunk(new Uint8Array([3,0]),J._finishFlushFlag),J.bytesRead)Ce=L;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function X(L,Z){if(!Ce)return Yt(L,Z);var J=Ce.InflateRaw,Y=new J,ae=Y._processChunk(L.slice(L.l),Y._finishFlushFlag);return L.l+=Y.bytesRead,ae}function T(L){return Ce?Ce.deflateRawSync(L):$e(L)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],F=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(L){var Z=(L<<1|L<<11)&139536|(L<<5|L<<15)&558144;return(Z>>16|Z>>8|Z)&255}for(var fe=typeof Uint8Array<"u",ge=fe?new Uint8Array(256):[],ze=0;ze<256;++ze)ge[ze]=de(ze);function oe(L,Z){var J=ge[L&255];return Z<=8?J>>>8-Z:(J=J<<8|ge[L>>8&255],Z<=16?J>>>16-Z:(J=J<<8|ge[L>>16&255],J>>>24-Z))}function Tt(L,Z){var J=Z&7,Y=Z>>>3;return(L[Y]|(J<=6?0:L[Y+1]<<8))>>>J&3}function ft(L,Z){var J=Z&7,Y=Z>>>3;return(L[Y]|(J<=5?0:L[Y+1]<<8))>>>J&7}function xt(L,Z){var J=Z&7,Y=Z>>>3;return(L[Y]|(J<=4?0:L[Y+1]<<8))>>>J&15}function Dt(L,Z){var J=Z&7,Y=Z>>>3;return(L[Y]|(J<=3?0:L[Y+1]<<8))>>>J&31}function Ke(L,Z){var J=Z&7,Y=Z>>>3;return(L[Y]|(J<=1?0:L[Y+1]<<8))>>>J&127}function er(L,Z,J){var Y=Z&7,ae=Z>>>3,se=(1<<J)-1,xe=L[ae]>>>Y;return J<8-Y||(xe|=L[ae+1]<<8-Y,J<16-Y)||(xe|=L[ae+2]<<16-Y,J<24-Y)||(xe|=L[ae+3]<<24-Y),xe&se}function wr(L,Z,J){var Y=Z&7,ae=Z>>>3;return Y<=5?L[ae]|=(J&7)<<Y:(L[ae]|=J<<Y&255,L[ae+1]=(J&7)>>8-Y),Z+3}function ur(L,Z,J){var Y=Z&7,ae=Z>>>3;return J=(J&1)<<Y,L[ae]|=J,Z+1}function ar(L,Z,J){var Y=Z&7,ae=Z>>>3;return J<<=Y,L[ae]|=J&255,J>>>=8,L[ae+1]=J,Z+8}function Ve(L,Z,J){var Y=Z&7,ae=Z>>>3;return J<<=Y,L[ae]|=J&255,J>>>=8,L[ae+1]=J&255,L[ae+2]=J>>>8,Z+16}function Xe(L,Z){var J=L.length,Y=2*J>Z?2*J:Z+5,ae=0;if(J>=Z)return L;if(fr){var se=$O(Y);if(L.copy)L.copy(se);else for(;ae<L.length;++ae)se[ae]=L[ae];return se}else if(fe){var xe=new Uint8Array(Y);if(xe.set)xe.set(L);else for(;ae<J;++ae)xe[ae]=L[ae];return xe}return L.length=Y,L}function he(L){for(var Z=new Array(L),J=0;J<L;++J)Z[J]=0;return Z}function Be(L,Z,J){var Y=1,ae=0,se=0,xe=0,je=0,Se=L.length,we=fe?new Uint16Array(32):he(32);for(se=0;se<32;++se)we[se]=0;for(se=Se;se<J;++se)L[se]=0;Se=L.length;var Re=fe?new Uint16Array(Se):he(Se);for(se=0;se<Se;++se)we[ae=L[se]]++,Y<ae&&(Y=ae),Re[se]=0;for(we[0]=0,se=1;se<=Y;++se)we[se+16]=je=je+we[se-1]<<1;for(se=0;se<Se;++se)je=L[se],je!=0&&(Re[se]=we[je+16]++);var Ue=0;for(se=0;se<Se;++se)if(Ue=L[se],Ue!=0)for(je=oe(Re[se],Y)>>Y-Ue,xe=(1<<Y+4-Ue)-1;xe>=0;--xe)Z[je|xe<<Ue]=Ue&15|se<<4;return Y}var Qe=fe?new Uint16Array(512):he(512),vt=fe?new Uint16Array(32):he(32);if(!fe){for(var St=0;St<512;++St)Qe[St]=0;for(St=0;St<32;++St)vt[St]=0}(function(){for(var L=[],Z=0;Z<32;Z++)L.push(5);Be(L,vt,32);var J=[];for(Z=0;Z<=143;Z++)J.push(8);for(;Z<=255;Z++)J.push(9);for(;Z<=279;Z++)J.push(7);for(;Z<=287;Z++)J.push(8);Be(J,Qe,288)})();var tr=(function(){for(var Z=fe?new Uint8Array(32768):[],J=0,Y=0;J<F.length-1;++J)for(;Y<F[J+1];++Y)Z[Y]=J;for(;Y<32768;++Y)Z[Y]=29;var ae=fe?new Uint8Array(259):[];for(J=0,Y=0;J<P.length-1;++J)for(;Y<P[J+1];++Y)ae[Y]=J;function se(je,Se){for(var we=0;we<je.length;){var Re=Math.min(65535,je.length-we),Ue=we+Re==je.length;for(Se.write_shift(1,+Ue),Se.write_shift(2,Re),Se.write_shift(2,~Re&65535);Re-- >0;)Se[Se.l++]=je[we++]}return Se.l}function xe(je,Se){for(var we=0,Re=0,Ue=fe?new Uint16Array(32768):[];Re<je.length;){var Ze=Math.min(65535,je.length-Re);if(Ze<10){for(we=wr(Se,we,+(Re+Ze==je.length)),we&7&&(we+=8-(we&7)),Se.l=we/8|0,Se.write_shift(2,Ze),Se.write_shift(2,~Ze&65535);Ze-- >0;)Se[Se.l++]=je[Re++];we=Se.l*8;continue}we=wr(Se,we,+(Re+Ze==je.length)+2);for(var at=0;Ze-- >0;){var et=je[Re];at=(at<<5^et)&32767;var lt=-1,ot=0;if((lt=Ue[at])&&(lt|=Re&-32768,lt>Re&&(lt-=32768),lt<Re))for(;je[lt+ot]==je[Re+ot]&&ot<250;)++ot;if(ot>2){et=ae[ot],et<=22?we=ar(Se,we,ge[et+1]>>1)-1:(ar(Se,we,3),we+=5,ar(Se,we,ge[et-23]>>5),we+=3);var yr=et<8?0:et-4>>2;yr>0&&(Ve(Se,we,ot-P[et]),we+=yr),et=Z[Re-lt],we=ar(Se,we,ge[et]>>3),we-=3;var ir=et<4?0:et-2>>1;ir>0&&(Ve(Se,we,Re-lt-F[et]),we+=ir);for(var Wr=0;Wr<ot;++Wr)Ue[at]=Re&32767,at=(at<<5^je[Re])&32767,++Re;Ze-=ot-1}else et<=143?et=et+48:we=ur(Se,we,1),we=ar(Se,we,ge[et]),Ue[at]=Re&32767,++Re}we=ar(Se,we,0)-1}return Se.l=(we+7)/8|0,Se.l}return function(Se,we){return Se.length<8?se(Se,we):xe(Se,we)}})();function $e(L){var Z=_n(50+Math.floor(L.length*1.1)),J=tr(L,Z);return Z.slice(0,J)}var tt=fe?new Uint16Array(32768):he(32768),Ct=fe?new Uint16Array(32768):he(32768),Nt=fe?new Uint16Array(128):he(128),Ot=1,kt=1;function Ft(L,Z){var J=Dt(L,Z)+257;Z+=5;var Y=Dt(L,Z)+1;Z+=5;var ae=xt(L,Z)+4;Z+=4;for(var se=0,xe=fe?new Uint8Array(19):he(19),je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Se=1,we=fe?new Uint8Array(8):he(8),Re=fe?new Uint8Array(8):he(8),Ue=xe.length,Ze=0;Ze<ae;++Ze)xe[O[Ze]]=se=ft(L,Z),Se<se&&(Se=se),we[se]++,Z+=3;var at=0;for(we[0]=0,Ze=1;Ze<=Se;++Ze)Re[Ze]=at=at+we[Ze-1]<<1;for(Ze=0;Ze<Ue;++Ze)(at=xe[Ze])!=0&&(je[Ze]=Re[at]++);var et=0;for(Ze=0;Ze<Ue;++Ze)if(et=xe[Ze],et!=0){at=ge[je[Ze]]>>8-et;for(var lt=(1<<7-et)-1;lt>=0;--lt)Nt[at|lt<<et]=et&7|Ze<<3}var ot=[];for(Se=1;ot.length<J+Y;)switch(at=Nt[Ke(L,Z)],Z+=at&7,at>>>=3){case 16:for(se=3+Tt(L,Z),Z+=2,at=ot[ot.length-1];se-- >0;)ot.push(at);break;case 17:for(se=3+ft(L,Z),Z+=3;se-- >0;)ot.push(0);break;case 18:for(se=11+Ke(L,Z),Z+=7;se-- >0;)ot.push(0);break;default:ot.push(at),Se<at&&(Se=at);break}var yr=ot.slice(0,J),ir=ot.slice(J);for(Ze=J;Ze<286;++Ze)yr[Ze]=0;for(Ze=Y;Ze<30;++Ze)ir[Ze]=0;return Ot=Be(yr,tt,286),kt=Be(ir,Ct,30),Z}function Lt(L,Z){if(L[0]==3&&!(L[1]&3))return[ul(Z),2];for(var J=0,Y=0,ae=$O(Z||1<<18),se=0,xe=ae.length>>>0,je=0,Se=0;(Y&1)==0;){if(Y=ft(L,J),J+=3,Y>>>1)Y>>1==1?(je=9,Se=5):(J=Ft(L,J),je=Ot,Se=kt);else{J&7&&(J+=8-(J&7));var we=L[J>>>3]|L[(J>>>3)+1]<<8;if(J+=32,we>0)for(!Z&&xe<se+we&&(ae=Xe(ae,se+we),xe=ae.length);we-- >0;)ae[se++]=L[J>>>3],J+=8;continue}for(;;){!Z&&xe<se+32767&&(ae=Xe(ae,se+32767),xe=ae.length);var Re=er(L,J,je),Ue=Y>>>1==1?Qe[Re]:tt[Re];if(J+=Ue&15,Ue>>>=4,(Ue>>>8&255)===0)ae[se++]=Ue;else{if(Ue==256)break;Ue-=257;var Ze=Ue<8?0:Ue-4>>2;Ze>5&&(Ze=0);var at=se+P[Ue];Ze>0&&(at+=er(L,J,Ze),J+=Ze),Re=er(L,J,Se),Ue=Y>>>1==1?vt[Re]:Ct[Re],J+=Ue&15,Ue>>>=4;var et=Ue<4?0:Ue-2>>1,lt=F[Ue];for(et>0&&(lt+=er(L,J,et),J+=et),!Z&&xe<at&&(ae=Xe(ae,at+100),xe=ae.length);se<at;)ae[se]=ae[se-lt],++se}}}return Z?[ae,J+7>>>3]:[ae.slice(0,se),J+7>>>3]}function Yt(L,Z){var J=L.slice(L.l||0),Y=Lt(J,Z);return L.l+=Y[1],Y[0]}function ct(L,Z){if(L)typeof console<"u"&&console.error(Z);else throw new Error(Z)}function nr(L,Z){var J=L;oa(J,0);var Y=[],ae=[],se={FileIndex:Y,FullPaths:ae};z(se,{root:Z.root});for(var xe=J.length-4;(J[xe]!=80||J[xe+1]!=75||J[xe+2]!=5||J[xe+3]!=6)&&xe>=0;)--xe;J.l=xe+4,J.l+=4;var je=J.read_shift(2);J.l+=6;var Se=J.read_shift(4);for(J.l=Se,xe=0;xe<je;++xe){J.l+=20;var we=J.read_shift(4),Re=J.read_shift(4),Ue=J.read_shift(2),Ze=J.read_shift(2),at=J.read_shift(2);J.l+=8;var et=J.read_shift(4),lt=f(J.slice(J.l+Ue,J.l+Ue+Ze));J.l+=Ue+Ze+at;var ot=J.l;J.l=et+4,rn(J,we,Re,se,lt),J.l=ot}return se}function rn(L,Z,J,Y,ae){L.l+=2;var se=L.read_shift(2),xe=L.read_shift(2),je=c(L);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var Se=L.read_shift(4),we=L.read_shift(4),Re=L.read_shift(4),Ue=L.read_shift(2),Ze=L.read_shift(2),at="",et=0;et<Ue;++et)at+=String.fromCharCode(L[L.l++]);if(Ze){var lt=f(L.slice(L.l,L.l+Ze));(lt[21589]||{}).mt&&(je=lt[21589].mt),((ae||{})[21589]||{}).mt&&(je=ae[21589].mt)}L.l+=Ze;var ot=L.slice(L.l,L.l+we);switch(xe){case 8:ot=X(L,Re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+xe)}var yr=!1;se&8&&(Se=L.read_shift(4),Se==134695760&&(Se=L.read_shift(4),yr=!0),we=L.read_shift(4),Re=L.read_shift(4)),we!=Z&&ct(yr,"Bad compressed size: "+Z+" != "+we),Re!=J&&ct(yr,"Bad uncompressed size: "+J+" != "+Re),cn(Y,at,ot,{unsafe:!0,mt:je})}function An(L,Z){var J=Z||{},Y=[],ae=[],se=_n(1),xe=J.compression?8:0,je=0,Se=0,we=0,Re=0,Ue=0,Ze=L.FullPaths[0],at=Ze,et=L.FileIndex[0],lt=[],ot=0;for(Se=1;Se<L.FullPaths.length;++Se)if(at=L.FullPaths[Se].slice(Ze.length),et=L.FileIndex[Se],!(!et.size||!et.content||at=="Sh33tJ5")){var yr=Re,ir=_n(at.length);for(we=0;we<at.length;++we)ir.write_shift(1,at.charCodeAt(we)&127);ir=ir.slice(0,ir.l),lt[Ue]=PL.buf(et.content,0);var Wr=et.content;xe==8&&(Wr=T(Wr)),se=_n(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,je),se.write_shift(2,xe),et.mt?d(se,et.mt):se.write_shift(4,0),se.write_shift(-4,lt[Ue]),se.write_shift(4,Wr.length),se.write_shift(4,et.content.length),se.write_shift(2,ir.length),se.write_shift(2,0),Re+=se.length,Y.push(se),Re+=ir.length,Y.push(ir),Re+=Wr.length,Y.push(Wr),se=_n(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,je),se.write_shift(2,xe),se.write_shift(4,0),se.write_shift(-4,lt[Ue]),se.write_shift(4,Wr.length),se.write_shift(4,et.content.length),se.write_shift(2,ir.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,yr),ot+=se.l,ae.push(se),ot+=ir.length,ae.push(ir),++Ue}return se=_n(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,Ue),se.write_shift(2,Ue),se.write_shift(4,ot),se.write_shift(4,Re),se.write_shift(2,0),sl([sl(Y),sl(ae),se])}var Cr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function gn(L,Z){if(L.ctype)return L.ctype;var J=L.name||"",Y=J.match(/\.([^\.]+)$/);return Y&&Cr[Y[1]]||Z&&(Y=(J=Z).match(/[\.\\]([^\.\\])+$/),Y&&Cr[Y[1]])?Cr[Y[1]]:"application/octet-stream"}function ii(L){for(var Z=FO(L),J=[],Y=0;Y<Z.length;Y+=76)J.push(Z.slice(Y,Y+76));return J.join(`\r
`)+`\r
`}function Lr(L){var Z=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(we){var Re=we.charCodeAt(0).toString(16).toUpperCase();return"="+(Re.length==1?"0"+Re:Re)});Z=Z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Z.charAt(0)==`
`&&(Z="=0D"+Z.slice(1)),Z=Z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var J=[],Y=Z.split(`\r
`),ae=0;ae<Y.length;++ae){var se=Y[ae];if(se.length==0){J.push("");continue}for(var xe=0;xe<se.length;){var je=76,Se=se.slice(xe,xe+je);Se.charAt(je-1)=="="?je--:Se.charAt(je-2)=="="?je-=2:Se.charAt(je-3)=="="&&(je-=3),Se=se.slice(xe,xe+je),xe+=je,xe<se.length&&(Se+="="),J.push(Se)}}return J.join(`\r
`)}function Xr(L){for(var Z=[],J=0;J<L.length;++J){for(var Y=L[J];J<=L.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+L[++J];Z.push(Y)}for(var ae=0;ae<Z.length;++ae)Z[ae]=Z[ae].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return ti(Z.join(`\r
`))}function qa(L,Z,J){for(var Y="",ae="",se="",xe,je=0;je<10;++je){var Se=Z[je];if(!Se||Se.match(/^\s*$/))break;var we=Se.match(/^(.*?):\s*([^\s].*)$/);if(we)switch(we[1].toLowerCase()){case"content-location":Y=we[2].trim();break;case"content-type":se=we[2].trim();break;case"content-transfer-encoding":ae=we[2].trim();break}}switch(++je,ae.toLowerCase()){case"base64":xe=ti(ds(Z.slice(je).join("")));break;case"quoted-printable":xe=Xr(Z.slice(je));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ae)}var Re=cn(L,Y.slice(J.length),xe,{unsafe:!0});se&&(Re.ctype=se)}function qt(L,Z){if(ie(L.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var J=Z&&Z.root||"",Y=(fr&&Buffer.isBuffer(L)?L.toString("binary"):ie(L)).split(`\r
`),ae=0,se="";for(ae=0;ae<Y.length;++ae)if(se=Y[ae],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),J||(J=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,J.length)!=J))for(;J.length>0&&(J=J.slice(0,J.length-1),J=J.slice(0,J.lastIndexOf("/")+1),se.slice(0,J.length)!=J););var xe=(Y[1]||"").match(/boundary="(.*?)"/);if(!xe)throw new Error("MAD cannot find boundary");var je="--"+(xe[1]||""),Se=[],we=[],Re={FileIndex:Se,FullPaths:we};z(Re);var Ue,Ze=0;for(ae=0;ae<Y.length;++ae){var at=Y[ae];at!==je&&at!==je+"--"||(Ze++&&qa(Re,Y.slice(Ue,ae),J),Ue=ae)}return Re}function Ln(L,Z){var J=Z||{},Y=J.boundary||"SheetJS";Y="------="+Y;for(var ae=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],se=L.FullPaths[0],xe=se,je=L.FileIndex[0],Se=1;Se<L.FullPaths.length;++Se)if(xe=L.FullPaths[Se].slice(se.length),je=L.FileIndex[Se],!(!je.size||!je.content||xe=="Sh33tJ5")){xe=xe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ot){return"_x"+ot.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ot){return"_u"+ot.charCodeAt(0).toString(16)+"_"});for(var we=je.content,Re=fr&&Buffer.isBuffer(we)?we.toString("binary"):ie(we),Ue=0,Ze=Math.min(1024,Re.length),at=0,et=0;et<=Ze;++et)(at=Re.charCodeAt(et))>=32&&at<128&&++Ue;var lt=Ue>=Ze*4/5;ae.push(Y),ae.push("Content-Location: "+(J.root||"file:///C:/SheetJS/")+xe),ae.push("Content-Transfer-Encoding: "+(lt?"quoted-printable":"base64")),ae.push("Content-Type: "+gn(je,xe)),ae.push(""),ae.push(lt?Lr(Re):ii(Re))}return ae.push(Y+`--\r
`),ae.join(`\r
`)}function xn(L){var Z={};return z(Z,L),Z}function cn(L,Z,J,Y){var ae=Y&&Y.unsafe;ae||z(L);var se=!ae&&vr.find(L,Z);if(!se){var xe=L.FullPaths[0];Z.slice(0,xe.length)==xe?xe=Z:(xe.slice(-1)!="/"&&(xe+="/"),xe=(xe+Z).replace("//","/")),se={name:i(Z),type:2},L.FileIndex.push(se),L.FullPaths.push(xe),ae||vr.utils.cfb_gc(L)}return se.content=J,se.size=J?J.length:0,Y&&(Y.CLSID&&(se.clsid=Y.CLSID),Y.mt&&(se.mt=Y.mt),Y.ct&&(se.ct=Y.ct)),se}function wa(L,Z){z(L);var J=vr.find(L,Z);if(J){for(var Y=0;Y<L.FileIndex.length;++Y)if(L.FileIndex[Y]==J)return L.FileIndex.splice(Y,1),L.FullPaths.splice(Y,1),!0}return!1}function Ts(L,Z,J){z(L);var Y=vr.find(L,Z);if(Y){for(var ae=0;ae<L.FileIndex.length;++ae)if(L.FileIndex[ae]==Y)return L.FileIndex[ae].name=i(J),L.FullPaths[ae]=J,!0}return!1}function pe(L){S(L,!0)}return n.find=W,n.read=Q,n.parse=x,n.write=Ee,n.writeFile=Ge,n.utils={cfb_new:xn,cfb_add:cn,cfb_del:wa,cfb_mov:Ts,cfb_gc:pe,ReadShift:Cf,CheckField:nC,prep_blob:oa,bconcat:sl,use_zlib:j,_deflateRaw:$e,_inflateRaw:Yt,consts:ve},n})();function UL(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(t);n.open("r"),n.encoding="binary";var e=n.read();return n.close(),e}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+t)}function Ti(t){for(var n=Object.keys(t),e=[],s=0;s<n.length;++s)Object.prototype.hasOwnProperty.call(t,n[s])&&e.push(n[s]);return e}function dN(t){for(var n=[],e=Ti(t),s=0;s!==e.length;++s)n[t[e[s]]]=e[s];return n}var Ah=new Date(1899,11,30,0,0,0);function Ia(t,n){var e=t.getTime(),s=Ah.getTime()+(t.getTimezoneOffset()-Ah.getTimezoneOffset())*6e4;return(e-s)/(1440*60*1e3)}var Vw=new Date,AL=Ah.getTime()+(Vw.getTimezoneOffset()-Ah.getTimezoneOffset())*6e4,qO=Vw.getTimezoneOffset();function Gh(t){var n=new Date;return n.setTime(t*24*60*60*1e3+AL),n.getTimezoneOffset()!==qO&&n.setTime(n.getTime()+(n.getTimezoneOffset()-qO)*6e4),n}function LL(t){var n=0,e=0,s=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var d=1;d!=i.length;++d)if(i[d]){switch(e=1,d>3&&(s=!0),i[d].slice(i[d].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[d].slice(i[d].length-1));case"D":e*=24;case"H":e*=60;case"M":if(s)e*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=e*parseInt(i[d],10)}return n}var KO=new Date("2017-02-19T19:06:09.000Z"),jw=isNaN(KO.getFullYear())?new Date("2/19/17"):KO,VL=jw.getFullYear()==2017;function Wn(t,n){var e=new Date(t);if(VL)return n>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):n<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(jw.getFullYear()==1917&&!isNaN(e.getFullYear())){var s=e.getFullYear();return t.indexOf(""+s)>-1||e.setFullYear(e.getFullYear()+100),e}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],d=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(d=new Date(d.getTime()-d.getTimezoneOffset()*60*1e3)),d}function ac(t,n){if(fr&&Buffer.isBuffer(t)){if(n){if(t[0]==255&&t[1]==254)return wf(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return wf(yw(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(t[0]==255&&t[1]==254)return wf(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return wf(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(d){return e[d]||d})}catch{}for(var s=[],i=0;i!=t.length;++i)s.push(String.fromCharCode(t[i]));return s.join("")}function la(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var n={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=la(t[e]));return n}function en(t,n){for(var e="";e.length<n;)e+=t;return e}function ai(t){var n=Number(t);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(t))return n;var e=1,s=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(n=Number(s))||(s=s.replace(/[(](.*)[)]/,function(i,d){return e=-e,d}),!isNaN(n=Number(s)))?n/e:n}var jL=["january","february","march","april","may","june","july","august","september","october","november","december"];function Su(t){var n=new Date(t),e=new Date(NaN),s=n.getYear(),i=n.getMonth(),d=n.getDate();if(isNaN(d))return e;var c=t.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&jL.indexOf(c)==-1)return e}else if(c.match(/[a-z]/))return e;return s<0||s>8099?e:(i>0||d>1)&&s!=101?n:t.match(/[^-0-9:,\/\\]/)?e:n}var IL=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(e,s,i){if(t||typeof s=="string")return e.split(s);for(var d=e.split(s),c=[d[0]],f=1;f<d.length;++f)c.push(i),c.push(d[f]);return c}})();function Iw(t){return t?t.content&&t.type?ac(t.content,!0):t.data?yf(t.data):t.asNodeBuffer&&fr?yf(t.asNodeBuffer().toString("binary")):t.asBinary?yf(t.asBinary()):t._data&&t._data.getContent?yf(ac(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Mw(t){if(!t)return null;if(t.data)return IO(t.data);if(t.asNodeBuffer&&fr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var n=t._data.getContent();return typeof n=="string"?IO(n):Array.prototype.slice.call(n)}return t.content&&t.type?t.content:null}function ML(t){return t&&t.name.slice(-4)===".bin"?Mw(t):Iw(t)}function ws(t,n){for(var e=t.FullPaths||Ti(t.files),s=n.toLowerCase().replace(/[\/]/g,"\\"),i=s.replace(/\\/g,"/"),d=0;d<e.length;++d){var c=e[d].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==c||i==c)return t.files?t.files[e[d]]:t.FileIndex[d]}return null}function fN(t,n){var e=ws(t,n);if(e==null)throw new Error("Cannot find file "+n+" in zip");return e}function hn(t,n,e){if(!e)return ML(fN(t,n));if(!n)return null;try{return hn(t,n)}catch{return null}}function us(t,n,e){if(!e)return Iw(fN(t,n));if(!n)return null;try{return us(t,n)}catch{return null}}function FL(t,n,e){return Mw(fN(t,n))}function JO(t){for(var n=t.FullPaths||Ti(t.files),e=[],s=0;s<n.length;++s)n[s].slice(-1)!="/"&&e.push(n[s].replace(/^Root Entry[\/]/,""));return e.sort()}function $L(t,n,e){if(t.FullPaths){if(typeof e=="string"){var s;return fr?s=oc(e):s=iL(e),vr.utils.cfb_add(t,n,s)}vr.utils.cfb_add(t,n,e)}else t.file(n,e)}function Fw(t,n){switch(n.type){case"base64":return vr.read(t,{type:"base64"});case"binary":return vr.read(t,{type:"binary"});case"buffer":case"array":return vr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function Ef(t,n){if(t.charAt(0)=="/")return t.slice(1);var e=n.split("/");n.slice(-1)!="/"&&e.pop();for(var s=t.split("/");s.length!==0;){var i=s.shift();i===".."?e.pop():i!=="."&&e.push(i)}return e.join("/")}var $w=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,BL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,QO=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,HL=/<[^>]*>/g,Ea=$w.match(QO)?QO:HL,WL=/<\w*:/,zL=/<(\/?)\w+:/;function Wt(t,n,e){for(var s={},i=0,d=0;i!==t.length&&!((d=t.charCodeAt(i))===32||d===10||d===13);++i);if(n||(s[0]=t.slice(0,i)),i===t.length)return s;var c=t.match(BL),f=0,p="",g=0,x="",b="",E=1;if(c)for(g=0;g!=c.length;++g){for(b=c[g],d=0;d!=b.length&&b.charCodeAt(d)!==61;++d);for(x=b.slice(0,d).trim();b.charCodeAt(d+1)==32;)++d;for(E=(i=b.charCodeAt(d+1))==34||i==39?1:0,p=b.slice(d+1+E,b.length-E),f=0;f!=x.length&&x.charCodeAt(f)!==58;++f);if(f===x.length)x.indexOf("_")>0&&(x=x.slice(0,x.indexOf("_"))),s[x]=p,s[x.toLowerCase()]=p;else{var w=(f===5&&x.slice(0,5)==="xmlns"?"xmlns":"")+x.slice(f+1);if(s[w]&&x.slice(f-3,f)=="ext")continue;s[w]=p,s[w.toLowerCase()]=p}}return s}function Pi(t){return t.replace(zL,"<$1")}var Bw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},XL=dN(Bw),Sr=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function e(s){var i=s+"",d=i.indexOf("<![CDATA[");if(d==-1)return i.replace(t,function(f,p){return Bw[f]||String.fromCharCode(parseInt(p,f.indexOf("x")>-1?16:10))||f}).replace(n,function(f,p){return String.fromCharCode(parseInt(p,16))});var c=i.indexOf("]]>");return e(i.slice(0,d))+i.slice(d+9,c)+e(i.slice(c+3))}})(),GL=/[&<>'"]/g,YL=/[\u0000-\u001f]/g;function mN(t){var n=t+"";return n.replace(GL,function(e){return XL[e]}).replace(/\n/g,"<br/>").replace(YL,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var ZO=(function(){var t=/&#(\d+);/g;function n(e,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(t,n)}})();function zr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Nb(t){for(var n="",e=0,s=0,i=0,d=0,c=0,f=0;e<t.length;){if(s=t.charCodeAt(e++),s<128){n+=String.fromCharCode(s);continue}if(i=t.charCodeAt(e++),s>191&&s<224){c=(s&31)<<6,c|=i&63,n+=String.fromCharCode(c);continue}if(d=t.charCodeAt(e++),s<240){n+=String.fromCharCode((s&15)<<12|(i&63)<<6|d&63);continue}c=t.charCodeAt(e++),f=((s&7)<<18|(i&63)<<12|(d&63)<<6|c&63)-65536,n+=String.fromCharCode(55296+(f>>>10&1023)),n+=String.fromCharCode(56320+(f&1023))}return n}function eE(t){var n=ul(2*t.length),e,s,i=1,d=0,c=0,f;for(s=0;s<t.length;s+=i)i=1,(f=t.charCodeAt(s))<128?e=f:f<224?(e=(f&31)*64+(t.charCodeAt(s+1)&63),i=2):f<240?(e=(f&15)*4096+(t.charCodeAt(s+1)&63)*64+(t.charCodeAt(s+2)&63),i=3):(i=4,e=(f&7)*262144+(t.charCodeAt(s+1)&63)*4096+(t.charCodeAt(s+2)&63)*64+(t.charCodeAt(s+3)&63),e-=65536,c=55296+(e>>>10&1023),e=56320+(e&1023)),c!==0&&(n[d++]=c&255,n[d++]=c>>>8,c=0),n[d++]=e%256,n[d++]=e>>>8;return n.slice(0,d).toString("ucs2")}function tE(t){return oc(t,"binary").toString("utf8")}var hh="foo bar baz",Mr=fr&&(tE(hh)==Nb(hh)&&tE||eE(hh)==Nb(hh)&&eE)||Nb,wf=fr?function(t){return oc(t,"utf8").toString("binary")}:function(t){for(var n=[],e=0,s=0,i=0;e<t.length;)switch(s=t.charCodeAt(e++),!0){case s<128:n.push(String.fromCharCode(s));break;case s<2048:n.push(String.fromCharCode(192+(s>>6))),n.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,i=t.charCodeAt(e++)-56320+(s<<10),n.push(String.fromCharCode(240+(i>>18&7))),n.push(String.fromCharCode(144+(i>>12&63))),n.push(String.fromCharCode(128+(i>>6&63))),n.push(String.fromCharCode(128+(i&63)));break;default:n.push(String.fromCharCode(224+(s>>12))),n.push(String.fromCharCode(128+(s>>6&63))),n.push(String.fromCharCode(128+(s&63)))}return n.join("")},Mf=(function(){var t={};return function(e,s){var i=e+"|"+(s||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",s||"")}})(),Hw=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(e){for(var s=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)s=s.replace(t[i][0],t[i][1]);return s}})(),qL=(function(){var t={};return function(e){return t[e]!==void 0?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}})(),KL=/<\/?(?:vt:)?variant>/g,JL=/<(?:vt:)([^>]*)>([\s\S]*)</;function rE(t,n){var e=Wt(t),s=t.match(qL(e.baseType))||[],i=[];if(s.length!=e.size){if(n.WTF)throw new Error("unexpected vector length "+s.length+" != "+e.size);return i}return s.forEach(function(d){var c=d.replace(KL,"").match(JL);c&&i.push({v:Mr(c[2]),t:c[1]})}),i}var QL=/(^\s|\s$|\n)/;function ZL(t){return Ti(t).map(function(n){return" "+n+'="'+t[n]+'"'}).join("")}function eV(t,n,e){return"<"+t+(e!=null?ZL(e):"")+(n!=null?(n.match(QL)?' xml:space="preserve"':"")+">"+n+"</"+t:"/")+">"}function hN(t){if(fr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Mr(lc(lN(t)));throw new Error("Bad input format: expected Buffer or string")}var Ff=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,tV={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},rV=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function nV(t,n){for(var e=1-2*(t[n+7]>>>7),s=((t[n+7]&127)<<4)+(t[n+6]>>>4&15),i=t[n+6]&15,d=5;d>=0;--d)i=i*256+t[n+d];return s==2047?i==0?e*(1/0):NaN:(s==0?s=-1022:(s-=1023,i+=Math.pow(2,52)),e*Math.pow(2,s-52)*i)}function aV(t,n,e){var s=(n<0||1/n==-1/0?1:0)<<7,i=0,d=0,c=s?-n:n;isFinite(c)?c==0?i=d=0:(i=Math.floor(Math.log(c)/Math.LN2),d=c*Math.pow(2,52-i),i<=-1023&&(!isFinite(d)||d<Math.pow(2,52))?i=-1022:(d-=Math.pow(2,52),i+=1023)):(i=2047,d=isNaN(n)?26985:0);for(var f=0;f<=5;++f,d/=256)t[e+f]=d&255;t[e+6]=(i&15)<<4|d&15,t[e+7]=i>>4|s}var nE=function(t){for(var n=[],e=10240,s=0;s<t[0].length;++s)if(t[0][s])for(var i=0,d=t[0][s].length;i<d;i+=e)n.push.apply(n,t[0][s].slice(i,i+e));return n},aE=fr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(n){return Buffer.isBuffer(n)?n:oc(n)})):nE(t)}:nE,sE=function(t,n,e){for(var s=[],i=n;i<e;i+=2)s.push(String.fromCharCode(co(t,i)));return s.join("").replace(ja,"")},pN=fr?function(t,n,e){return Buffer.isBuffer(t)?t.toString("utf16le",n,e).replace(ja,""):sE(t,n,e)}:sE,iE=function(t,n,e){for(var s=[],i=n;i<n+e;++i)s.push(("0"+t[i].toString(16)).slice(-2));return s.join("")},Ww=fr?function(t,n,e){return Buffer.isBuffer(t)?t.toString("hex",n,n+e):iE(t,n,e)}:iE,oE=function(t,n,e){for(var s=[],i=n;i<e;i++)s.push(String.fromCharCode(vu(t,i)));return s.join("")},Kf=fr?function(n,e,s){return Buffer.isBuffer(n)?n.toString("utf8",e,s):oE(n,e,s)}:oE,zw=function(t,n){var e=cs(t,n);return e>0?Kf(t,n+4,n+4+e-1):""},Xw=zw,Gw=function(t,n){var e=cs(t,n);return e>0?Kf(t,n+4,n+4+e-1):""},Yw=Gw,qw=function(t,n){var e=2*cs(t,n);return e>0?Kf(t,n+4,n+4+e-1):""},Kw=qw,Jw=function(n,e){var s=cs(n,e);return s>0?pN(n,e+4,e+4+s):""},Qw=Jw,Zw=function(t,n){var e=cs(t,n);return e>0?Kf(t,n+4,n+4+e):""},eC=Zw,tC=function(t,n){return nV(t,n)},Lh=tC,rC=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};fr&&(Xw=function(n,e){if(!Buffer.isBuffer(n))return zw(n,e);var s=n.readUInt32LE(e);return s>0?n.toString("utf8",e+4,e+4+s-1):""},Yw=function(n,e){if(!Buffer.isBuffer(n))return Gw(n,e);var s=n.readUInt32LE(e);return s>0?n.toString("utf8",e+4,e+4+s-1):""},Kw=function(n,e){if(!Buffer.isBuffer(n))return qw(n,e);var s=2*n.readUInt32LE(e);return n.toString("utf16le",e+4,e+4+s-1)},Qw=function(n,e){if(!Buffer.isBuffer(n))return Jw(n,e);var s=n.readUInt32LE(e);return n.toString("utf16le",e+4,e+4+s)},eC=function(n,e){if(!Buffer.isBuffer(n))return Zw(n,e);var s=n.readUInt32LE(e);return n.toString("utf8",e+4,e+4+s)},Lh=function(n,e){return Buffer.isBuffer(n)?n.readDoubleLE(e):tC(n,e)},rC=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var vu=function(t,n){return t[n]},co=function(t,n){return t[n+1]*256+t[n]},sV=function(t,n){var e=t[n+1]*256+t[n];return e<32768?e:(65535-e+1)*-1},cs=function(t,n){return t[n+3]*(1<<24)+(t[n+2]<<16)+(t[n+1]<<8)+t[n]},Zl=function(t,n){return t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]},iV=function(t,n){return t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]};function Cf(t,n){var e="",s,i,d=[],c,f,p,g;switch(n){case"dbcs":if(g=this.l,fr&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(p=0;p<t;++p)e+=String.fromCharCode(co(this,g)),g+=2;t*=2;break;case"utf8":e=Kf(this,this.l,this.l+t);break;case"utf16le":t*=2,e=pN(this,this.l,this.l+t);break;case"wstr":return Cf.call(this,t,"dbcs");case"lpstr-ansi":e=Xw(this,this.l),t=4+cs(this,this.l);break;case"lpstr-cp":e=Yw(this,this.l),t=4+cs(this,this.l);break;case"lpwstr":e=Kw(this,this.l),t=4+2*cs(this,this.l);break;case"lpp4":t=4+cs(this,this.l),e=Qw(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+cs(this,this.l),e=eC(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(c=vu(this,this.l+t++))!==0;)d.push(mh(c));e=d.join("");break;case"_wstr":for(t=0,e="";(c=co(this,this.l+t))!==0;)d.push(mh(c)),t+=2;t+=2,e=d.join("");break;case"dbcs-cont":for(e="",g=this.l,p=0;p<t;++p){if(this.lens&&this.lens.indexOf(g)!==-1)return c=vu(this,g),this.l=g+1,f=Cf.call(this,t-p,c?"dbcs-cont":"sbcs-cont"),d.join("")+f;d.push(mh(co(this,g))),g+=2}e=d.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(e="",g=this.l,p=0;p!=t;++p){if(this.lens&&this.lens.indexOf(g)!==-1)return c=vu(this,g),this.l=g+1,f=Cf.call(this,t-p,c?"dbcs-cont":"sbcs-cont"),d.join("")+f;d.push(mh(vu(this,g))),g+=1}e=d.join("");break;default:switch(t){case 1:return s=vu(this,this.l),this.l++,s;case 2:return s=(n==="i"?sV:co)(this,this.l),this.l+=2,s;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(s=(t>0?Zl:iV)(this,this.l),this.l+=4,s):(i=cs(this,this.l),this.l+=4,i);case 8:case-8:if(n==="f")return t==8?i=Lh(this,this.l):i=Lh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:e=Ww(this,this.l,t);break}}return this.l+=t,e}var oV=function(t,n,e){t[e]=n&255,t[e+1]=n>>>8&255,t[e+2]=n>>>16&255,t[e+3]=n>>>24&255},lV=function(t,n,e){t[e]=n&255,t[e+1]=n>>8&255,t[e+2]=n>>16&255,t[e+3]=n>>24&255},cV=function(t,n,e){t[e]=n&255,t[e+1]=n>>>8&255};function uV(t,n,e){var s=0,i=0;if(e==="dbcs"){for(i=0;i!=n.length;++i)cV(this,n.charCodeAt(i),this.l+2*i);s=2*n.length}else if(e==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=n.length;++i)this[this.l+i]=n.charCodeAt(i)&255;s=n.length}else if(e==="hex"){for(;i<t;++i)this[this.l++]=parseInt(n.slice(2*i,2*i+2),16)||0;return this}else if(e==="utf16le"){var d=Math.min(this.l+t,this.length);for(i=0;i<Math.min(n.length,t);++i){var c=n.charCodeAt(i);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<d;)this[this.l++]=0;return this}else switch(t){case 1:s=1,this[this.l]=n&255;break;case 2:s=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:s=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:s=4,oV(this,n,this.l);break;case 8:if(s=8,e==="f"){aV(this,n,this.l);break}case 16:break;case-4:s=4,lV(this,n,this.l);break}return this.l+=s,this}function nC(t,n){var e=Ww(this,this.l,t.length>>1);if(e!==t)throw new Error(n+"Expected "+t+" saw "+e);this.l+=t.length>>1}function oa(t,n){t.l=n,t.read_shift=Cf,t.chk=nC,t.write_shift=uV}function ya(t,n){t.l+=n}function _n(t){var n=ul(t);return oa(n,0),n}function go(t,n,e){if(t){var s,i,d;oa(t,t.l||0);for(var c=t.length,f=0,p=0;t.l<c;){f=t.read_shift(1),f&128&&(f=(f&127)+((t.read_shift(1)&127)<<7));var g=$h[f]||$h[65535];for(s=t.read_shift(1),d=s&127,i=1;i<4&&s&128;++i)d+=((s=t.read_shift(1))&127)<<7*i;p=t.l+d;var x=g.f&&g.f(t,d,e);if(t.l=p,n(x,g,f))return}}}function Mb(){var t=[],n=fr?256:2048,e=function(g){var x=_n(g);return oa(x,0),x},s=e(n),i=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&t.push(s),s=null)},d=function(g){return s&&g<s.length-s.l?s:(i(),s=e(Math.max(g+1,n)))},c=function(){return i(),sl(t)},f=function(g){i(),s=g,s.l==null&&(s.l=s.length),d(n)};return{next:d,push:f,end:c,_bufs:t}}function kf(t,n,e){var s=la(t);if(n.s?(s.cRel&&(s.c+=n.s.c),s.rRel&&(s.r+=n.s.r)):(s.cRel&&(s.c+=n.c),s.rRel&&(s.r+=n.r)),!e||e.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function lE(t,n,e){var s=la(t);return s.s=kf(s.s,n.s,e),s.e=kf(s.e,n.s,e),s}function Rf(t,n){if(t.cRel&&t.c<0)for(t=la(t);t.c<0;)t.c+=n>8?16384:256;if(t.rRel&&t.r<0)for(t=la(t);t.r<0;)t.r+=n>8?1048576:n>5?65536:16384;var e=Jt(t);return!t.cRel&&t.cRel!=null&&(e=mV(e)),!t.rRel&&t.rRel!=null&&(e=dV(e)),e}function Db(t,n){return t.s.r==0&&!t.s.rRel&&t.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Pn(t.s.c)+":"+(t.e.cRel?"":"$")+Pn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(n.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+ca(t.s.r)+":"+(t.e.rRel?"":"$")+ca(t.e.r):Rf(t.s,n.biff)+":"+Rf(t.e,n.biff)}function vN(t){return parseInt(fV(t),10)-1}function ca(t){return""+(t+1)}function dV(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function fV(t){return t.replace(/\$(\d+)$/,"$1")}function gN(t){for(var n=hV(t),e=0,s=0;s!==n.length;++s)e=26*e+n.charCodeAt(s)-64;return e-1}function Pn(t){if(t<0)throw new Error("invalid column "+t);var n="";for(++t;t;t=Math.floor((t-1)/26))n=String.fromCharCode((t-1)%26+65)+n;return n}function mV(t){return t.replace(/^([A-Z])/,"$$$1")}function hV(t){return t.replace(/^\$([A-Z])/,"$1")}function pV(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Va(t){for(var n=0,e=0,s=0;s<t.length;++s){var i=t.charCodeAt(s);i>=48&&i<=57?n=10*n+(i-48):i>=65&&i<=90&&(e=26*e+(i-64))}return{c:e-1,r:n-1}}function Jt(t){for(var n=t.c+1,e="";n;n=(n-1)/26|0)e=String.fromCharCode((n-1)%26+65)+e;return e+(t.r+1)}function ku(t){var n=t.indexOf(":");return n==-1?{s:Va(t),e:Va(t)}:{s:Va(t.slice(0,n)),e:Va(t.slice(n+1))}}function gr(t,n){return typeof n>"u"||typeof n=="number"?gr(t.s,t.e):(typeof t!="string"&&(t=Jt(t)),typeof n!="string"&&(n=Jt(n)),t==n?t:t+":"+n)}function tn(t){var n={s:{c:0,r:0},e:{c:0,r:0}},e=0,s=0,i=0,d=t.length;for(e=0;s<d&&!((i=t.charCodeAt(s)-64)<1||i>26);++s)e=26*e+i;for(n.s.c=--e,e=0;s<d&&!((i=t.charCodeAt(s)-48)<0||i>9);++s)e=10*e+i;if(n.s.r=--e,s===d||i!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++s,e=0;s!=d&&!((i=t.charCodeAt(s)-64)<1||i>26);++s)e=26*e+i;for(n.e.c=--e,e=0;s!=d&&!((i=t.charCodeAt(s)-48)<0||i>9);++s)e=10*e+i;return n.e.r=--e,n}function cE(t,n){var e=t.t=="d"&&n instanceof Date;if(t.z!=null)try{return t.w=ks(t.z,e?Ia(n):n)}catch{}try{return t.w=ks((t.XF||{}).numFmtId||(e?14:0),e?Ia(n):n)}catch{return""+n}}function po(t,n,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?dc[t.v]||t.v:n==null?cE(t,t.v):cE(t,n))}function ml(t,n){var e=n&&n.sheet?n.sheet:"Sheet1",s={};return s[e]=t,{SheetNames:[e],Sheets:s}}function aC(t,n,e){var s=e||{},i=t?Array.isArray(t):s.dense,d=t||(i?[]:{}),c=0,f=0;if(d&&s.origin!=null){if(typeof s.origin=="number")c=s.origin;else{var p=typeof s.origin=="string"?Va(s.origin):s.origin;c=p.r,f=p.c}d["!ref"]||(d["!ref"]="A1:A1")}var g={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(d["!ref"]){var x=tn(d["!ref"]);g.s.c=x.s.c,g.s.r=x.s.r,g.e.c=Math.max(g.e.c,x.e.c),g.e.r=Math.max(g.e.r,x.e.r),c==-1&&(g.e.r=c=x.e.r+1)}for(var b=0;b!=n.length;++b)if(n[b]){if(!Array.isArray(n[b]))throw new Error("aoa_to_sheet expects an array of arrays");for(var E=0;E!=n[b].length;++E)if(!(typeof n[b][E]>"u")){var w={v:n[b][E]},R=c+b,y=f+E;if(g.s.r>R&&(g.s.r=R),g.s.c>y&&(g.s.c=y),g.e.r<R&&(g.e.r=R),g.e.c<y&&(g.e.c=y),n[b][E]&&typeof n[b][E]=="object"&&!Array.isArray(n[b][E])&&!(n[b][E]instanceof Date))w=n[b][E];else if(Array.isArray(w.v)&&(w.f=n[b][E][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(s.nullError)w.t="e",w.v=0;else if(s.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?w.t="n":typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=s.dateNF||Zt[14],s.cellDates?(w.t="d",w.w=ks(w.z,Ia(w.v))):(w.t="n",w.v=Ia(w.v),w.w=ks(w.z,w.v))):w.t="s";if(i)d[R]||(d[R]=[]),d[R][y]&&d[R][y].z&&(w.z=d[R][y].z),d[R][y]=w;else{var U=Jt({c:y,r:R});d[U]&&d[U].z&&(w.z=d[U].z),d[U]=w}}}return g.s.c<1e7&&(d["!ref"]=gr(g)),d}function Ru(t,n){return aC(null,t,n)}function vV(t){return t.read_shift(4,"i")}function Sa(t){var n=t.read_shift(4);return n===0?"":t.read_shift(n,"dbcs")}function gV(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function xN(t,n){var e=t.l,s=t.read_shift(1),i=Sa(t),d=[],c={t:i,h:i};if((s&1)!==0){for(var f=t.read_shift(4),p=0;p!=f;++p)d.push(gV(t));c.r=d}else c.r=[{ich:0,ifnt:0}];return t.l=e+n,c}var xV=xN;function Rs(t){var n=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:n,iStyleRef:e}}function cc(t){var n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:n}}var bV=Sa;function bN(t){var n=t.read_shift(4);return n===0||n===4294967295?"":t.read_shift(n,"dbcs")}var NV=Sa,Fb=bN;function NN(t){var n=t.slice(t.l,t.l+4),e=n[0]&1,s=n[0]&2;t.l+=4;var i=s===0?Lh([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Zl(n,0)>>2;return e?i/100:i}function sC(t){var n={s:{},e:{}};return n.s.r=t.read_shift(4),n.e.r=t.read_shift(4),n.s.c=t.read_shift(4),n.e.c=t.read_shift(4),n}var uc=sC;function Na(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function DV(t){var n={},e=t.read_shift(1),s=e>>>1,i=t.read_shift(1),d=t.read_shift(2,"i"),c=t.read_shift(1),f=t.read_shift(1),p=t.read_shift(1);switch(t.l++,s){case 0:n.auto=1;break;case 1:n.index=i;var g=rc[i];g&&(n.rgb=Bf(g));break;case 2:n.rgb=Bf([c,f,p]);break;case 3:n.theme=i;break}return d!=0&&(n.tint=d>0?d/32767:d/32768),n}function SV(t){var n=t.read_shift(1);t.l++;var e={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return e}function iC(t,n){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=t.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return e[t.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return t.l-=4,t.read_shift(0,n==1?"lpstr":"lpwstr")}function yV(t){return iC(t,1)}function OV(t){return iC(t,2)}var DN=2,Ya=3,ph=11,uE=12,Vh=19,vh=64,EV=65,wV=71,CV=4108,kV=4126,Hn=80,oC=81,RV=[Hn,oC],TV={1:{n:"CodePage",t:DN},2:{n:"Category",t:Hn},3:{n:"PresentationFormat",t:Hn},4:{n:"ByteCount",t:Ya},5:{n:"LineCount",t:Ya},6:{n:"ParagraphCount",t:Ya},7:{n:"SlideCount",t:Ya},8:{n:"NoteCount",t:Ya},9:{n:"HiddenCount",t:Ya},10:{n:"MultimediaClipCount",t:Ya},11:{n:"ScaleCrop",t:ph},12:{n:"HeadingPairs",t:CV},13:{n:"TitlesOfParts",t:kV},14:{n:"Manager",t:Hn},15:{n:"Company",t:Hn},16:{n:"LinksUpToDate",t:ph},17:{n:"CharacterCount",t:Ya},19:{n:"SharedDoc",t:ph},22:{n:"HyperlinksChanged",t:ph},23:{n:"AppVersion",t:Ya,p:"version"},24:{n:"DigSig",t:EV},26:{n:"ContentType",t:Hn},27:{n:"ContentStatus",t:Hn},28:{n:"Language",t:Hn},29:{n:"Version",t:Hn},255:{},2147483648:{n:"Locale",t:Vh},2147483651:{n:"Behavior",t:Vh},1919054434:{}},_V={1:{n:"CodePage",t:DN},2:{n:"Title",t:Hn},3:{n:"Subject",t:Hn},4:{n:"Author",t:Hn},5:{n:"Keywords",t:Hn},6:{n:"Comments",t:Hn},7:{n:"Template",t:Hn},8:{n:"LastAuthor",t:Hn},9:{n:"RevNumber",t:Hn},10:{n:"EditTime",t:vh},11:{n:"LastPrinted",t:vh},12:{n:"CreatedDate",t:vh},13:{n:"ModifiedDate",t:vh},14:{n:"PageCount",t:Ya},15:{n:"WordCount",t:Ya},16:{n:"CharCount",t:Ya},17:{n:"Thumbnail",t:wV},18:{n:"Application",t:Hn},19:{n:"DocSecurity",t:Ya},255:{},2147483648:{n:"Locale",t:Vh},2147483651:{n:"Behavior",t:Vh},1919054434:{}},dE={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},PV=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function UV(t){return t.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var AV=UV([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rc=la(AV),dc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},lC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},fE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function LV(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function VV(t){var n=LV();if(!t||!t.match)return n;var e={};if((t.match(Ea)||[]).forEach(function(s){var i=Wt(s);switch(i[0].replace(WL,"<")){case"<?xml":break;case"<Types":n.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[i.Extension]=i.ContentType;break;case"<Override":n[fE[i.ContentType]]!==void 0&&n[fE[i.ContentType]].push(i.PartName);break}}),n.xmlns!==tV.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=e,delete n.calcchains,n}var xu={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function $b(t){var n=t.lastIndexOf("/");return t.slice(0,n+1)+"_rels/"+t.slice(n+1)+".rels"}function Tf(t,n){var e={"!id":{}};if(!t)return e;n.charAt(0)!=="/"&&(n="/"+n);var s={};return(t.match(Ea)||[]).forEach(function(i){var d=Wt(i);if(d[0]==="<Relationship"){var c={};c.Type=d.Type,c.Target=d.Target,c.Id=d.Id,d.TargetMode&&(c.TargetMode=d.TargetMode);var f=d.TargetMode==="External"?d.Target:Ef(d.Target,n);e[f]=c,s[d.Id]=c}}),e["!id"]=s,e}var jV="application/vnd.oasis.opendocument.spreadsheet";function IV(t,n){for(var e=hN(t),s,i;s=Ff.exec(e);)switch(s[3]){case"manifest":break;case"file-entry":if(i=Wt(s[0],!1),i.path=="/"&&i.type!==jV)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw s}}var _f=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],MV=(function(){for(var t=new Array(_f.length),n=0;n<_f.length;++n){var e=_f[n],s="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);t[n]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return t})();function cC(t){var n={};t=Mr(t);for(var e=0;e<_f.length;++e){var s=_f[e],i=t.match(MV[e]);i!=null&&i.length>0&&(n[s[1]]=Sr(i[1])),s[2]==="date"&&n[s[1]]&&(n[s[1]]=Wn(n[s[1]]))}return n}var FV=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function uC(t,n,e,s){var i=[];if(typeof t=="string")i=rE(t,s);else for(var d=0;d<t.length;++d)i=i.concat(t[d].map(function(x){return{v:x}}));var c=typeof n=="string"?rE(n,s).map(function(x){return x.v}):n,f=0,p=0;if(c.length>0)for(var g=0;g!==i.length;g+=2){switch(p=+i[g+1].v,i[g].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":e.Worksheets=p,e.SheetNames=c.slice(f,f+p);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":e.NamedRanges=p,e.DefinedNames=c.slice(f,f+p);break;case"Charts":case"Diagramme":e.Chartsheets=p,e.ChartNames=c.slice(f,f+p);break}f+=p}}function $V(t,n,e){var s={};return n||(n={}),t=Mr(t),FV.forEach(function(i){var d=(t.match(Mf(i[0]))||[])[1];switch(i[2]){case"string":d&&(n[i[1]]=Sr(d));break;case"bool":n[i[1]]=d==="true";break;case"raw":var c=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));c&&c.length>0&&(s[i[1]]=c[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&uC(s.HeadingPairs,s.TitlesOfParts,n,e),n}var BV=/<[^>]+>[^<]*/g;function HV(t,n){var e={},s="",i=t.match(BV);if(i)for(var d=0;d!=i.length;++d){var c=i[d],f=Wt(c);switch(f[0]){case"<?xml":break;case"<Properties":break;case"<property":s=Sr(f.name);break;case"</property>":s=null;break;default:if(c.indexOf("<vt:")===0){var p=c.split(">"),g=p[0].slice(4),x=p[1];switch(g){case"lpstr":case"bstr":case"lpwstr":e[s]=Sr(x);break;case"bool":e[s]=zr(x);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[s]=parseInt(x,10);break;case"r4":case"r8":case"decimal":e[s]=parseFloat(x);break;case"filetime":case"date":e[s]=Wn(x);break;case"cy":case"error":e[s]=Sr(x);break;default:if(g.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",c,g,p)}}else if(c.slice(0,2)!=="</"){if(n.WTF)throw new Error(c)}}}return e}var WV={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Sb;function zV(t,n,e){Sb||(Sb=dN(WV)),n=Sb[n]||n,t[n]=e}function SN(t){var n=t.read_shift(4),e=t.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function dC(t,n,e){var s=t.l,i=t.read_shift(0,"lpstr-cp");if(e)for(;t.l-s&3;)++t.l;return i}function fC(t,n,e){var s=t.read_shift(0,"lpwstr");return s}function mC(t,n,e){return n===31?fC(t):dC(t,n,e)}function Bb(t,n,e){return mC(t,n,e===!1?0:4)}function XV(t,n){if(!n)throw new Error("VtUnalignedString must have positive length");return mC(t,n,0)}function GV(t){for(var n=t.read_shift(4),e=[],s=0;s!=n;++s){var i=t.l;e[s]=t.read_shift(0,"lpwstr").replace(ja,""),t.l-i&2&&(t.l+=2)}return e}function YV(t){for(var n=t.read_shift(4),e=[],s=0;s!=n;++s)e[s]=t.read_shift(0,"lpstr-cp").replace(ja,"");return e}function qV(t){var n=t.l,e=jh(t,oC);t[t.l]==0&&t[t.l+1]==0&&t.l-n&2&&(t.l+=2);var s=jh(t,Ya);return[e,s]}function KV(t){for(var n=t.read_shift(4),e=[],s=0;s<n/2;++s)e.push(qV(t));return e}function mE(t,n){for(var e=t.read_shift(4),s={},i=0;i!=e;++i){var d=t.read_shift(4),c=t.read_shift(4);s[d]=t.read_shift(c,n===1200?"utf16le":"utf8").replace(ja,"").replace(Of,"!"),n===1200&&c%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),s}function hC(t){var n=t.read_shift(4),e=t.slice(t.l,t.l+n);return t.l+=n,(n&3)>0&&(t.l+=4-(n&3)&3),e}function JV(t){var n={};return n.Size=t.read_shift(4),t.l+=n.Size+3-(n.Size-1)%4,n}function jh(t,n,e){var s=t.read_shift(2),i,d=e||{};if(t.l+=2,n!==uE&&s!==n&&RV.indexOf(n)===-1&&!((n&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+n+" saw "+s);switch(n===uE?s:n){case 2:return i=t.read_shift(2,"i"),d.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return dC(t,s,4).replace(ja,"");case 31:return fC(t);case 64:return SN(t);case 65:return hC(t);case 71:return JV(t);case 80:return Bb(t,s,!d.raw).replace(ja,"");case 81:return XV(t,s).replace(ja,"");case 4108:return KV(t);case 4126:case 4127:return s==4127?GV(t):YV(t);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+s)}}function hE(t,n){var e=t.l,s=t.read_shift(4),i=t.read_shift(4),d=[],c=0,f=0,p=-1,g={};for(c=0;c!=i;++c){var x=t.read_shift(4),b=t.read_shift(4);d[c]=[x,b+e]}d.sort(function(G,_){return G[1]-_[1]});var E={};for(c=0;c!=i;++c){if(t.l!==d[c][1]){var w=!0;if(c>0&&n)switch(n[d[c-1][0]].t){case 2:t.l+2===d[c][1]&&(t.l+=2,w=!1);break;case 80:t.l<=d[c][1]&&(t.l=d[c][1],w=!1);break;case 4108:t.l<=d[c][1]&&(t.l=d[c][1],w=!1);break}if((!n||c==0)&&t.l<=d[c][1]&&(w=!1,t.l=d[c][1]),w)throw new Error("Read Error: Expected address "+d[c][1]+" at "+t.l+" :"+c)}if(n){var R=n[d[c][0]];if(E[R.n]=jh(t,R.t,{raw:!0}),R.p==="version"&&(E[R.n]=String(E[R.n]>>16)+"."+("0000"+String(E[R.n]&65535)).slice(-4)),R.n=="CodePage")switch(E[R.n]){case 0:E[R.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ri(f=E[R.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+E[R.n])}}else if(d[c][0]===1){if(f=E.CodePage=jh(t,DN),ri(f),p!==-1){var y=t.l;t.l=d[p][1],g=mE(t,f),t.l=y}}else if(d[c][0]===0){if(f===0){p=c,t.l=d[c+1][1];continue}g=mE(t,f)}else{var U=g[d[c][0]],q;switch(t[t.l]){case 65:t.l+=4,q=hC(t);break;case 30:t.l+=4,q=Bb(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,q=Bb(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,q=t.read_shift(4,"i");break;case 19:t.l+=4,q=t.read_shift(4);break;case 5:t.l+=4,q=t.read_shift(8,"f");break;case 11:t.l+=4,q=ln(t,4);break;case 64:t.l+=4,q=Wn(SN(t));break;default:throw new Error("unparsed value: "+t[t.l])}E[U]=q}}return t.l=e+s,E}function pE(t,n,e){var s=t.content;if(!s)return{};oa(s,0);var i,d,c,f,p=0;s.chk("feff","Byte Order: "),s.read_shift(2);var g=s.read_shift(4),x=s.read_shift(16);if(x!==vr.utils.consts.HEADER_CLSID&&x!==e)throw new Error("Bad PropertySet CLSID "+x);if(i=s.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(d=s.read_shift(16),f=s.read_shift(4),i===1&&f!==s.l)throw new Error("Length mismatch: "+f+" !== "+s.l);i===2&&(c=s.read_shift(16),p=s.read_shift(4));var b=hE(s,n),E={SystemIdentifier:g};for(var w in b)E[w]=b[w];if(E.FMTID=d,i===1)return E;if(p-s.l==2&&(s.l+=2),s.l!==p)throw new Error("Length mismatch 2: "+s.l+" !== "+p);var R;try{R=hE(s,null)}catch{}for(w in R)E[w]=R[w];return E.FMTID=[d,c],E}function nl(t,n){return t.read_shift(n),null}function QV(t,n,e){for(var s=[],i=t.l+n;t.l<i;)s.push(e(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return s}function ln(t,n){return t.read_shift(n)===1}function pn(t){return t.read_shift(2,"u")}function pC(t,n){return QV(t,n,pn)}function ZV(t){var n=t.read_shift(1),e=t.read_shift(1);return e===1?n:n===1}function Jf(t,n,e){var s=t.read_shift(e&&e.biff>=12?2:1),i="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var d=t.read_shift(1);d&&(i="dbcs-cont")}else e.biff==12&&(i="wstr");e.biff>=2&&e.biff<=5&&(i="cpstr");var c=s?t.read_shift(s,i):"";return c}function e6(t){var n=t.read_shift(2),e=t.read_shift(1),s=e&4,i=e&8,d=1+(e&1),c=0,f,p={};i&&(c=t.read_shift(2)),s&&(f=t.read_shift(4));var g=d==2?"dbcs-cont":"sbcs-cont",x=n===0?"":t.read_shift(n,g);return i&&(t.l+=4*c),s&&(t.l+=f),p.t=x,i||(p.raw="<t>"+p.t+"</t>",p.r=p.t),p}function sc(t,n,e){var s;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(n,"cpstr");if(e.biff>=12)return t.read_shift(n,"dbcs-cont")}var i=t.read_shift(1);return i===0?s=t.read_shift(n,"sbcs-cont"):s=t.read_shift(n,"dbcs-cont"),s}function Qf(t,n,e){var s=t.read_shift(e&&e.biff==2?1:2);return s===0?(t.l++,""):sc(t,s,e)}function fc(t,n,e){if(e.biff>5)return Qf(t,n,e);var s=t.read_shift(1);return s===0?(t.l++,""):t.read_shift(s,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function t6(t){var n=t.read_shift(1);t.l++;var e=t.read_shift(2);return t.l+=2,[n,e]}function r6(t){var n=t.read_shift(4),e=t.l,s=!1;n>24&&(t.l+=n-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),t.l=e);var i=t.read_shift((s?n-24:n)>>1,"utf16le").replace(ja,"");return s&&(t.l+=24),i}function n6(t){for(var n=t.read_shift(2),e="";n-- >0;)e+="../";var s=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return e+s.replace(/\\/g,"/");var d=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=t.read_shift(d>>1,"utf16le").replace(ja,"");return e+c}function a6(t,n){var e=t.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return r6(t);case"0303000000000000c000000000000046":return n6(t);default:throw new Error("Unsupported Moniker "+e)}}function gh(t){var n=t.read_shift(4),e=n>0?t.read_shift(n,"utf16le").replace(ja,""):"";return e}function s6(t,n){var e=t.l+n,s=t.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var i=t.read_shift(2);t.l+=2;var d,c,f,p,g="",x,b;i&16&&(d=gh(t,e-t.l)),i&128&&(c=gh(t,e-t.l)),(i&257)===257&&(f=gh(t,e-t.l)),(i&257)===1&&(p=a6(t,e-t.l)),i&8&&(g=gh(t,e-t.l)),i&32&&(x=t.read_shift(16)),i&64&&(b=SN(t)),t.l=e;var E=c||f||p||"";E&&g&&(E+="#"+g),E||(E="#"+g),i&2&&E.charAt(0)=="/"&&E.charAt(1)!="/"&&(E="file://"+E);var w={Target:E};return x&&(w.guid=x),b&&(w.time=b),d&&(w.Tooltip=d),w}function vC(t){var n=t.read_shift(1),e=t.read_shift(1),s=t.read_shift(1),i=t.read_shift(1);return[n,e,s,i]}function gC(t,n){var e=vC(t);return e[3]=0,e}function Ui(t){var n=t.read_shift(2),e=t.read_shift(2),s=t.read_shift(2);return{r:n,c:e,ixfe:s}}function i6(t){var n=t.read_shift(2),e=t.read_shift(2);return t.l+=8,{type:n,flags:e}}function o6(t,n,e){return n===0?"":fc(t,n,e)}function l6(t,n,e){var s=e.biff>8?4:2,i=t.read_shift(s),d=t.read_shift(s,"i"),c=t.read_shift(s,"i");return[i,d,c]}function xC(t){var n=t.read_shift(2),e=NN(t);return[n,e]}function c6(t,n,e){t.l+=4,n-=4;var s=t.l+n,i=Jf(t,n,e),d=t.read_shift(2);if(s-=t.l,d!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+d);return t.l+=d,i}function Yh(t){var n=t.read_shift(2),e=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);return{s:{c:s,r:n},e:{c:i,r:e}}}function bC(t){var n=t.read_shift(2),e=t.read_shift(2),s=t.read_shift(1),i=t.read_shift(1);return{s:{c:s,r:n},e:{c:i,r:e}}}var u6=bC;function NC(t){t.l+=4;var n=t.read_shift(2),e=t.read_shift(2),s=t.read_shift(2);return t.l+=12,[e,n,s]}function d6(t){var n={};return t.l+=4,t.l+=16,n.fSharedNote=t.read_shift(2),t.l+=4,n}function f6(t){var n={};return t.l+=4,t.cf=t.read_shift(2),n}function xa(t){t.l+=2,t.l+=t.read_shift(2)}var m6={0:xa,4:xa,5:xa,6:xa,7:f6,8:xa,9:xa,10:xa,11:xa,12:xa,13:d6,14:xa,15:xa,16:xa,17:xa,18:xa,19:xa,20:xa,21:NC};function h6(t,n){for(var e=t.l+n,s=[];t.l<e;){var i=t.read_shift(2);t.l-=2;try{s.push(m6[i](t,e-t.l))}catch{return t.l=e,s}}return t.l!=e&&(t.l=e),s}function xh(t,n){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=t.read_shift(2),n-=2,n>=2&&(e.dt=t.read_shift(2),t.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return t.read_shift(n),e}function p6(t,n){return n===0||t.read_shift(2),1200}function v6(t,n,e){if(e.enc)return t.l+=n,"";var s=t.l,i=fc(t,0,e);return t.read_shift(n+s-t.l),i}function g6(t,n,e){var s=e&&e.biff==8||n==2?t.read_shift(2):(t.l+=n,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function x6(t,n,e){var s=t.read_shift(4),i=t.read_shift(1)&3,d=t.read_shift(1);switch(d){case 0:d="Worksheet";break;case 1:d="Macrosheet";break;case 2:d="Chartsheet";break;case 6:d="VBAModule";break}var c=Jf(t,0,e);return c.length===0&&(c="Sheet1"),{pos:s,hs:i,dt:d,name:c}}function b6(t,n){for(var e=t.l+n,s=t.read_shift(4),i=t.read_shift(4),d=[],c=0;c!=i&&t.l<e;++c)d.push(e6(t));return d.Count=s,d.Unique=i,d}function N6(t,n){var e={};return e.dsst=t.read_shift(2),t.l+=n-2,e}function D6(t){var n={};n.r=t.read_shift(2),n.c=t.read_shift(2),n.cnt=t.read_shift(2)-n.c;var e=t.read_shift(2);t.l+=4;var s=t.read_shift(1);return t.l+=3,s&7&&(n.level=s&7),s&32&&(n.hidden=!0),s&64&&(n.hpt=e/20),n}function S6(t){var n=i6(t);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var e=t.read_shift(4);return e!==0}function y6(t){return t.read_shift(2),t.read_shift(4)}function vE(t,n,e){var s=0;e&&e.biff==2||(s=t.read_shift(2));var i=t.read_shift(2);e&&e.biff==2&&(s=1-(i>>15),i&=32767);var d={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[d,i]}function O6(t){var n=t.read_shift(2),e=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),d=t.read_shift(2),c=t.read_shift(2),f=t.read_shift(2),p=t.read_shift(2),g=t.read_shift(2);return{Pos:[n,e],Dim:[s,i],Flags:d,CurTab:c,FirstTab:f,Selected:p,TabRatio:g}}function E6(t,n,e){if(e&&e.biff>=2&&e.biff<5)return{};var s=t.read_shift(2);return{RTL:s&64}}function w6(){}function C6(t,n,e){var s={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return s.name=Jf(t,0,e),s}function k6(t){var n=Ui(t);return n.isst=t.read_shift(4),n}function R6(t,n,e){e.biffguess&&e.biff==2&&(e.biff=5);var s=t.l+n,i=Ui(t);e.biff==2&&t.l++;var d=Qf(t,s-t.l,e);return i.val=d,i}function T6(t,n,e){var s=t.read_shift(2),i=fc(t,0,e);return[s,i]}var _6=fc;function gE(t,n,e){var s=t.l+n,i=e.biff==8||!e.biff?4:2,d=t.read_shift(i),c=t.read_shift(i),f=t.read_shift(2),p=t.read_shift(2);return t.l=s,{s:{r:d,c:f},e:{r:c,c:p}}}function P6(t){var n=t.read_shift(2),e=t.read_shift(2),s=xC(t);return{r:n,c:e,ixfe:s[0],rknum:s[1]}}function U6(t,n){for(var e=t.l+n-2,s=t.read_shift(2),i=t.read_shift(2),d=[];t.l<e;)d.push(xC(t));if(t.l!==e)throw new Error("MulRK read error");var c=t.read_shift(2);if(d.length!=c-i+1)throw new Error("MulRK length mismatch");return{r:s,c:i,C:c,rkrec:d}}function A6(t,n){for(var e=t.l+n-2,s=t.read_shift(2),i=t.read_shift(2),d=[];t.l<e;)d.push(t.read_shift(2));if(t.l!==e)throw new Error("MulBlank read error");var c=t.read_shift(2);if(d.length!=c-i+1)throw new Error("MulBlank length mismatch");return{r:s,c:i,C:c,ixfe:d}}function L6(t,n,e,s){var i={},d=t.read_shift(4),c=t.read_shift(4),f=t.read_shift(4),p=t.read_shift(2);return i.patternType=PV[f>>26],s.cellStyles&&(i.alc=d&7,i.fWrap=d>>3&1,i.alcV=d>>4&7,i.fJustLast=d>>7&1,i.trot=d>>8&255,i.cIndent=d>>16&15,i.fShrinkToFit=d>>20&1,i.iReadOrder=d>>22&2,i.fAtrNum=d>>26&1,i.fAtrFnt=d>>27&1,i.fAtrAlc=d>>28&1,i.fAtrBdr=d>>29&1,i.fAtrPat=d>>30&1,i.fAtrProt=d>>31&1,i.dgLeft=c&15,i.dgRight=c>>4&15,i.dgTop=c>>8&15,i.dgBottom=c>>12&15,i.icvLeft=c>>16&127,i.icvRight=c>>23&127,i.grbitDiag=c>>30&3,i.icvTop=f&127,i.icvBottom=f>>7&127,i.icvDiag=f>>14&127,i.dgDiag=f>>21&15,i.icvFore=p&127,i.icvBack=p>>7&127,i.fsxButton=p>>14&1),i}function V6(t,n,e){var s={};return s.ifnt=t.read_shift(2),s.numFmtId=t.read_shift(2),s.flags=t.read_shift(2),s.fStyle=s.flags>>2&1,n-=6,s.data=L6(t,n,s.fStyle,e),s}function j6(t){t.l+=4;var n=[t.read_shift(2),t.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function xE(t,n,e){var s=Ui(t);(e.biff==2||n==9)&&++t.l;var i=ZV(t);return s.val=i,s.t=i===!0||i===!1?"b":"e",s}function I6(t,n,e){e.biffguess&&e.biff==2&&(e.biff=5);var s=Ui(t),i=Na(t);return s.val=i,s}var bE=o6;function M6(t,n,e){var s=t.l+n,i=t.read_shift(2),d=t.read_shift(2);if(e.sbcch=d,d==1025||d==14849)return[d,i];if(d<1||d>255)throw new Error("Unexpected SupBook type: "+d);for(var c=sc(t,d),f=[];s>t.l;)f.push(Qf(t));return[d,i,c,f]}function NE(t,n,e){var s=t.read_shift(2),i,d={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return e.sbcch===14849&&(i=c6(t,n-2,e)),d.body=i||t.read_shift(n-2),typeof i=="string"&&(d.Name=i),d}var F6=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function DE(t,n,e){var s=t.l+n,i=t.read_shift(2),d=t.read_shift(1),c=t.read_shift(1),f=t.read_shift(e&&e.biff==2?1:2),p=0;(!e||e.biff>=5)&&(e.biff!=5&&(t.l+=2),p=t.read_shift(2),e.biff==5&&(t.l+=2),t.l+=4);var g=sc(t,c,e);i&32&&(g=F6[g.charCodeAt(0)]);var x=s-t.l;e&&e.biff==2&&--x;var b=s==t.l||f===0||!(x>0)?[]:DF(t,x,e,f);return{chKey:d,Name:g,itab:p,rgce:b}}function DC(t,n,e){if(e.biff<8)return $6(t,n,e);for(var s=[],i=t.l+n,d=t.read_shift(e.biff>8?4:2);d--!==0;)s.push(l6(t,e.biff>8?12:6,e));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return s}function $6(t,n,e){t[t.l+1]==3&&t[t.l]++;var s=Jf(t,n,e);return s.charCodeAt(0)==3?s.slice(1):s}function B6(t,n,e){if(e.biff<8){t.l+=n;return}var s=t.read_shift(2),i=t.read_shift(2),d=sc(t,s,e),c=sc(t,i,e);return[d,c]}function H6(t,n,e){var s=bC(t);t.l++;var i=t.read_shift(1);return n-=8,[SF(t,n,e),i,s]}function SE(t,n,e){var s=u6(t);switch(e.biff){case 2:t.l++,n-=7;break;case 3:case 4:t.l+=2,n-=8;break;default:t.l+=6,n-=12}return[s,bF(t,n,e)]}function W6(t){var n=t.read_shift(4)!==0,e=t.read_shift(4)!==0,s=t.read_shift(4);return[n,e,s]}function z6(t,n,e){if(!(e.biff<8)){var s=t.read_shift(2),i=t.read_shift(2),d=t.read_shift(2),c=t.read_shift(2),f=fc(t,0,e);return e.biff<8&&t.read_shift(1),[{r:s,c:i},f,c,d]}}function X6(t,n,e){return z6(t,n,e)}function G6(t,n){for(var e=[],s=t.read_shift(2);s--;)e.push(Yh(t));return e}function Y6(t,n,e){if(e&&e.biff<8)return K6(t,n,e);var s=NC(t),i=h6(t,n-22,s[1]);return{cmo:s,ft:i}}var q6={8:function(t,n){var e=t.l+n;t.l+=10;var s=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=e,{fmt:s}}};function K6(t,n,e){t.l+=4;var s=t.read_shift(2),i=t.read_shift(2),d=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,n-=36;var c=[];return c.push((q6[s]||ya)(t,n,e)),{cmo:[i,s,d],ft:c}}function J6(t,n,e){var s=t.l,i="";try{t.l+=4;var d=(e.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(d)==-1?t.l+=6:c=t6(t,6,e);var f=t.read_shift(2);t.read_shift(2),pn(t,2);var p=t.read_shift(2);t.l+=p;for(var g=1;g<t.lens.length-1;++g){if(t.l-s!=t.lens[g])throw new Error("TxO: bad continue record");var x=t[t.l],b=sc(t,t.lens[g+1]-t.lens[g]-1);if(i+=b,i.length>=(x?f:2*f))break}if(i.length!==f&&i.length!==f*2)throw new Error("cchText: "+f+" != "+i.length);return t.l=s+n,{t:i}}catch{return t.l=s+n,{t:i}}}function Q6(t,n){var e=Yh(t);t.l+=16;var s=s6(t,n-24);return[e,s]}function Z6(t,n){t.read_shift(2);var e=Yh(t),s=t.read_shift((n-10)/2,"dbcs-cont");return s=s.replace(ja,""),[e,s]}function ej(t){var n=[0,0],e;return e=t.read_shift(2),n[0]=dE[e]||e,e=t.read_shift(2),n[1]=dE[e]||e,n}function tj(t){for(var n=t.read_shift(2),e=[];n-- >0;)e.push(gC(t));return e}function rj(t){for(var n=t.read_shift(2),e=[];n-- >0;)e.push(gC(t));return e}function nj(t){t.l+=2;var n={cxfs:0,crc:0};return n.cxfs=t.read_shift(2),n.crc=t.read_shift(4),n}function SC(t,n,e){if(!e.cellStyles)return ya(t,n);var s=e&&e.biff>=12?4:2,i=t.read_shift(s),d=t.read_shift(s),c=t.read_shift(s),f=t.read_shift(s),p=t.read_shift(2);s==2&&(t.l+=2);var g={s:i,e:d,w:c,ixfe:f,flags:p};return(e.biff>=5||!e.biff)&&(g.level=p>>8&7),g}function aj(t,n){var e={};return n<32||(t.l+=16,e.header=Na(t),e.footer=Na(t),t.l+=2),e}function sj(t,n,e){var s={area:!1};if(e.biff!=5)return t.l+=n,s;var i=t.read_shift(1);return t.l+=3,i&16&&(s.area=!0),s}var ij=Ui,oj=pC,lj=Qf;function cj(t){var n=t.read_shift(2),e=t.read_shift(2),s=t.read_shift(4),i={fmt:n,env:e,len:s,data:t.slice(t.l,t.l+s)};return t.l+=s,i}function uj(t,n,e){e.biffguess&&e.biff==5&&(e.biff=2);var s=Ui(t);++t.l;var i=fc(t,n-7,e);return s.t="str",s.val=i,s}function dj(t){var n=Ui(t);++t.l;var e=Na(t);return n.t="n",n.val=e,n}function fj(t){var n=Ui(t);++t.l;var e=t.read_shift(2);return n.t="n",n.val=e,n}function mj(t){var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,"sbcs-cont")}function hj(t,n){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=n-13}function pj(t,n,e){var s=t.l+n,i=Ui(t),d=t.read_shift(2),c=sc(t,d,e);return t.l=s,i.t="str",i.val=c,i}var vj=[2,3,48,49,131,139,140,245],yE=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=dN({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(f,p){var g=[],x=ul(1);switch(p.type){case"base64":x=ti(ds(f));break;case"binary":x=ti(f);break;case"buffer":case"array":x=f;break}oa(x,0);var b=x.read_shift(1),E=!!(b&136),w=!1,R=!1;switch(b){case 2:break;case 3:break;case 48:w=!0,E=!0;break;case 49:w=!0,E=!0;break;case 131:break;case 139:break;case 140:R=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+b.toString(16))}var y=0,U=521;b==2&&(y=x.read_shift(2)),x.l+=3,b!=2&&(y=x.read_shift(4)),y>1048576&&(y=1e6),b!=2&&(U=x.read_shift(2));var q=x.read_shift(2),G=p.codepage||1252;b!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(G=t[x[x.l]]),x.l+=1,x.l+=2),R&&(x.l+=36);for(var _=[],ne={},ee=Math.min(x.length,b==2?521:U-10-(w?264:0)),Q=R?32:11;x.l<ee&&x[x.l]!=13;)switch(ne={},ne.name=jf.utils.decode(G,x.slice(x.l,x.l+Q)).replace(/[\u0000\r\n].*$/g,""),x.l+=Q,ne.type=String.fromCharCode(x.read_shift(1)),b!=2&&!R&&(ne.offset=x.read_shift(4)),ne.len=x.read_shift(1),b==2&&(ne.offset=x.read_shift(2)),ne.dec=x.read_shift(1),ne.name.length&&_.push(ne),b!=2&&(x.l+=R?13:14),ne.type){case"B":(!w||ne.len!=8)&&p.WTF&&console.log("Skipping "+ne.name+":"+ne.type);break;case"G":case"P":p.WTF&&console.log("Skipping "+ne.name+":"+ne.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+ne.type)}if(x[x.l]!==13&&(x.l=U-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=U;var z=0,ce=0;for(g[0]=[],ce=0;ce!=_.length;++ce)g[0][ce]=_[ce].name;for(;y-- >0;){if(x[x.l]===42){x.l+=q;continue}for(++x.l,g[++z]=[],ce=0,ce=0;ce!=_.length;++ce){var S=x.slice(x.l,x.l+_[ce].len);x.l+=_[ce].len,oa(S,0);var A=jf.utils.decode(G,S);switch(_[ce].type){case"C":A.trim().length&&(g[z][ce]=A.replace(/\s+$/,""));break;case"D":A.length===8?g[z][ce]=new Date(+A.slice(0,4),+A.slice(4,6)-1,+A.slice(6,8)):g[z][ce]=A;break;case"F":g[z][ce]=parseFloat(A.trim());break;case"+":case"I":g[z][ce]=R?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(A.trim().toUpperCase()){case"Y":case"T":g[z][ce]=!0;break;case"N":case"F":g[z][ce]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+A+"|")}break;case"M":if(!E)throw new Error("DBF Unexpected MEMO for type "+b.toString(16));g[z][ce]="##MEMO##"+(R?parseInt(A.trim(),10):S.read_shift(4));break;case"N":A=A.replace(/\u0000/g,"").trim(),A&&A!="."&&(g[z][ce]=+A||0);break;case"@":g[z][ce]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":g[z][ce]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":g[z][ce]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":g[z][ce]=-S.read_shift(-8,"f");break;case"B":if(w&&_[ce].len==8){g[z][ce]=S.read_shift(8,"f");break}case"G":case"P":S.l+=_[ce].len;break;case"0":if(_[ce].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[ce].type)}}}if(b!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return p&&p.sheetRows&&(g=g.slice(0,p.sheetRows)),p.DBF=_,g}function s(f,p){var g=p||{};g.dateNF||(g.dateNF="yyyymmdd");var x=Ru(e(f,g),g);return x["!cols"]=g.DBF.map(function(b){return{wch:b.len,DBF:b}}),delete g.DBF,x}function i(f,p){try{return ml(s(f,p),p)}catch(g){if(p&&p.WTF)throw g}return{SheetNames:[],Sheets:{}}}var d={B:8,C:250,L:1,D:8,"?":0,"":0};function c(f,p){var g=p||{};if(+g.codepage>=0&&ri(+g.codepage),g.type=="string")throw new Error("Cannot write DBF to JS string");var x=Mb(),b=Yb(f,{header:1,raw:!0,cellDates:!0}),E=b[0],w=b.slice(1),R=f["!cols"]||[],y=0,U=0,q=0,G=1;for(y=0;y<E.length;++y){if(((R[y]||{}).DBF||{}).name){E[y]=R[y].DBF.name,++q;continue}if(E[y]!=null){if(++q,typeof E[y]=="number"&&(E[y]=E[y].toString(10)),typeof E[y]!="string")throw new Error("DBF Invalid column name "+E[y]+" |"+typeof E[y]+"|");if(E.indexOf(E[y])!==y){for(U=0;U<1024;++U)if(E.indexOf(E[y]+"_"+U)==-1){E[y]+="_"+U;break}}}}var _=tn(f["!ref"]),ne=[],ee=[],Q=[];for(y=0;y<=_.e.c-_.s.c;++y){var z="",ce="",S=0,A=[];for(U=0;U<w.length;++U)w[U][y]!=null&&A.push(w[U][y]);if(A.length==0||E[y]==null){ne[y]="?";continue}for(U=0;U<A.length;++U){switch(typeof A[U]){case"number":ce="B";break;case"string":ce="C";break;case"boolean":ce="L";break;case"object":ce=A[U]instanceof Date?"D":"C";break;default:ce="C"}S=Math.max(S,String(A[U]).length),z=z&&z!=ce?"C":ce}S>250&&(S=250),ce=((R[y]||{}).DBF||{}).type,ce=="C"&&R[y].DBF.len>S&&(S=R[y].DBF.len),z=="B"&&ce=="N"&&(z="N",Q[y]=R[y].DBF.dec,S=R[y].DBF.len),ee[y]=z=="C"||ce=="N"?S:d[z]||0,G+=ee[y],ne[y]=z}var W=x.next(32);for(W.write_shift(4,318902576),W.write_shift(4,w.length),W.write_shift(2,296+32*q),W.write_shift(2,G),y=0;y<4;++y)W.write_shift(4,0);for(W.write_shift(4,0|(+n[Dw]||3)<<8),y=0,U=0;y<E.length;++y)if(E[y]!=null){var H=x.next(32),K=(E[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,K,"sbcs"),H.write_shift(1,ne[y]=="?"?"C":ne[y],"sbcs"),H.write_shift(4,U),H.write_shift(1,ee[y]||d[ne[y]]||0),H.write_shift(1,Q[y]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),U+=ee[y]||d[ne[y]]||0}var Oe=x.next(264);for(Oe.write_shift(4,13),y=0;y<65;++y)Oe.write_shift(4,0);for(y=0;y<w.length;++y){var ye=x.next(G);for(ye.write_shift(1,0),U=0;U<E.length;++U)if(E[U]!=null)switch(ne[U]){case"L":ye.write_shift(1,w[y][U]==null?63:w[y][U]?84:70);break;case"B":ye.write_shift(8,w[y][U]||0,"f");break;case"N":var Pe="0";for(typeof w[y][U]=="number"&&(Pe=w[y][U].toFixed(Q[U]||0)),q=0;q<ee[U]-Pe.length;++q)ye.write_shift(1,32);ye.write_shift(1,Pe,"sbcs");break;case"D":w[y][U]?(ye.write_shift(4,("0000"+w[y][U].getFullYear()).slice(-4),"sbcs"),ye.write_shift(2,("00"+(w[y][U].getMonth()+1)).slice(-2),"sbcs"),ye.write_shift(2,("00"+w[y][U].getDate()).slice(-2),"sbcs")):ye.write_shift(8,"00000000","sbcs");break;case"C":var ve=String(w[y][U]!=null?w[y][U]:"").slice(0,ee[U]);for(ye.write_shift(1,ve,"sbcs"),q=0;q<ee[U]-ve.length;++q)ye.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:i,to_sheet:s,from_sheet:c}})(),gj=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Ti(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(E,w){var R=t[w];return typeof R=="number"?MO(R):R},s=function(E,w,R){var y=w.charCodeAt(0)-32<<4|R.charCodeAt(0)-48;return y==59?E:MO(y)};t["|"]=254;function i(E,w){switch(w.type){case"base64":return d(ds(E),w);case"binary":return d(E,w);case"buffer":return d(fr&&Buffer.isBuffer(E)?E.toString("binary"):lc(E),w);case"array":return d(ac(E),w)}throw new Error("Unrecognized type "+w.type)}function d(E,w){var R=E.split(/[\n\r]+/),y=-1,U=-1,q=0,G=0,_=[],ne=[],ee=null,Q={},z=[],ce=[],S=[],A=0,W;for(+w.codepage>=0&&ri(+w.codepage);q!==R.length;++q){A=0;var H=R[q].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(n,e),K=H.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),Oe=K[0],ye;if(H.length>0)switch(Oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":K[1].charAt(0)=="P"&&ne.push(H.slice(3).replace(/;;/g,";"));break;case"C":var Pe=!1,ve=!1,Ge=!1,ie=!1,Ee=-1,Ce=-1;for(G=1;G<K.length;++G)switch(K[G].charAt(0)){case"A":break;case"X":U=parseInt(K[G].slice(1))-1,ve=!0;break;case"Y":for(y=parseInt(K[G].slice(1))-1,ve||(U=0),W=_.length;W<=y;++W)_[W]=[];break;case"K":ye=K[G].slice(1),ye.charAt(0)==='"'?ye=ye.slice(1,ye.length-1):ye==="TRUE"?ye=!0:ye==="FALSE"?ye=!1:isNaN(ai(ye))?isNaN(Su(ye).getDate())||(ye=Wn(ye)):(ye=ai(ye),ee!==null&&Cu(ee)&&(ye=Gh(ye))),Pe=!0;break;case"E":ie=!0;var j=Nu(K[G].slice(1),{r:y,c:U});_[y][U]=[_[y][U],j];break;case"S":Ge=!0,_[y][U]=[_[y][U],"S5S"];break;case"G":break;case"R":Ee=parseInt(K[G].slice(1))-1;break;case"C":Ce=parseInt(K[G].slice(1))-1;break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+H)}if(Pe&&(_[y][U]&&_[y][U].length==2?_[y][U][0]=ye:_[y][U]=ye,ee=null),Ge){if(ie)throw new Error("SYLK shared formula cannot have own formula");var X=Ee>-1&&_[Ee][Ce];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");_[y][U][1]=PC(X[1],{r:y-Ee,c:U-Ce})}break;case"F":var T=0;for(G=1;G<K.length;++G)switch(K[G].charAt(0)){case"X":U=parseInt(K[G].slice(1))-1,++T;break;case"Y":for(y=parseInt(K[G].slice(1))-1,W=_.length;W<=y;++W)_[W]=[];break;case"M":A=parseInt(K[G].slice(1))/20;break;case"F":break;case"G":break;case"P":ee=ne[parseInt(K[G].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=K[G].slice(1).split(" "),W=parseInt(S[0],10);W<=parseInt(S[1],10);++W)A=parseInt(S[2],10),ce[W-1]=A===0?{hidden:!0}:{wch:A},yu(ce[W-1]);break;case"C":U=parseInt(K[G].slice(1))-1,ce[U]||(ce[U]={});break;case"R":y=parseInt(K[G].slice(1))-1,z[y]||(z[y]={}),A>0?(z[y].hpt=A,z[y].hpx=Hf(A)):A===0&&(z[y].hidden=!0);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+H)}T<1&&(ee=null);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+H)}}return z.length>0&&(Q["!rows"]=z),ce.length>0&&(Q["!cols"]=ce),w&&w.sheetRows&&(_=_.slice(0,w.sheetRows)),[_,Q]}function c(E,w){var R=i(E,w),y=R[0],U=R[1],q=Ru(y,w);return Ti(U).forEach(function(G){q[G]=U[G]}),q}function f(E,w){return ml(c(E,w),w)}function p(E,w,R,y){var U="C;Y"+(R+1)+";X"+(y+1)+";K";switch(E.t){case"n":U+=E.v||0,E.f&&!E.F&&(U+=";E"+nM(E.f,{r:R,c:y}));break;case"b":U+=E.v?"TRUE":"FALSE";break;case"e":U+=E.w||E.v;break;case"d":U+='"'+(E.w||E.v)+'"';break;case"s":U+='"'+E.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return U}function g(E,w){w.forEach(function(R,y){var U="F;W"+(y+1)+" "+(y+1)+" ";R.hidden?U+="0":(typeof R.width=="number"&&!R.wpx&&(R.wpx=Mh(R.width)),typeof R.wpx=="number"&&!R.wch&&(R.wch=Fh(R.wpx)),typeof R.wch=="number"&&(U+=Math.round(R.wch))),U.charAt(U.length-1)!=" "&&E.push(U)})}function x(E,w){w.forEach(function(R,y){var U="F;";R.hidden?U+="M0;":R.hpt?U+="M"+20*R.hpt+";":R.hpx&&(U+="M"+20*RC(R.hpx)+";"),U.length>2&&E.push(U+"R"+(y+1))})}function b(E,w){var R=["ID;PWXL;N;E"],y=[],U=tn(E["!ref"]),q,G=Array.isArray(E),_=`\r
`;R.push("P;PGeneral"),R.push("F;P0;DG0G8;M255"),E["!cols"]&&g(R,E["!cols"]),E["!rows"]&&x(R,E["!rows"]),R.push("B;Y"+(U.e.r-U.s.r+1)+";X"+(U.e.c-U.s.c+1)+";D"+[U.s.c,U.s.r,U.e.c,U.e.r].join(" "));for(var ne=U.s.r;ne<=U.e.r;++ne)for(var ee=U.s.c;ee<=U.e.c;++ee){var Q=Jt({r:ne,c:ee});q=G?(E[ne]||[])[ee]:E[Q],!(!q||q.v==null&&(!q.f||q.F))&&y.push(p(q,E,ne,ee))}return R.join(_)+_+y.join(_)+_+"E"+_}return{to_workbook:f,to_sheet:c,from_sheet:b}})(),xj=(function(){function t(d,c){switch(c.type){case"base64":return n(ds(d),c);case"binary":return n(d,c);case"buffer":return n(fr&&Buffer.isBuffer(d)?d.toString("binary"):lc(d),c);case"array":return n(ac(d),c)}throw new Error("Unrecognized type "+c.type)}function n(d,c){for(var f=d.split(`
`),p=-1,g=-1,x=0,b=[];x!==f.length;++x){if(f[x].trim()==="BOT"){b[++p]=[],g=0;continue}if(!(p<0)){var E=f[x].trim().split(","),w=E[0],R=E[1];++x;for(var y=f[x]||"";(y.match(/["]/g)||[]).length&1&&x<f.length-1;)y+=`
`+f[++x];switch(y=y.trim(),+w){case-1:if(y==="BOT"){b[++p]=[],g=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?b[p][g]=!0:y==="FALSE"?b[p][g]=!1:isNaN(ai(R))?isNaN(Su(R).getDate())?b[p][g]=R:b[p][g]=Wn(R):b[p][g]=ai(R),++g;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),b[p][g++]=y!==""?y:null;break}if(y==="EOD")break}}return c&&c.sheetRows&&(b=b.slice(0,c.sheetRows)),b}function e(d,c){return Ru(t(d,c),c)}function s(d,c){return ml(e(d,c),c)}var i=(function(){var d=function(p,g,x,b,E){p.push(g),p.push(x+","+b),p.push('"'+E.replace(/"/g,'""')+'"')},c=function(p,g,x,b){p.push(g+","+x),p.push(g==1?'"'+b.replace(/"/g,'""')+'"':b)};return function(p){var g=[],x=tn(p["!ref"]),b,E=Array.isArray(p);d(g,"TABLE",0,1,"sheetjs"),d(g,"VECTORS",0,x.e.r-x.s.r+1,""),d(g,"TUPLES",0,x.e.c-x.s.c+1,""),d(g,"DATA",0,0,"");for(var w=x.s.r;w<=x.e.r;++w){c(g,-1,0,"BOT");for(var R=x.s.c;R<=x.e.c;++R){var y=Jt({r:w,c:R});if(b=E?(p[w]||[])[R]:p[y],!b){c(g,1,0,"");continue}switch(b.t){case"n":var U=b.w;!U&&b.v!=null&&(U=b.v),U==null?b.f&&!b.F?c(g,1,0,"="+b.f):c(g,1,0,""):c(g,0,U,"V");break;case"b":c(g,0,b.v?1:0,b.v?"TRUE":"FALSE");break;case"s":c(g,1,0,isNaN(b.v)?b.v:'="'+b.v+'"');break;case"d":b.w||(b.w=ks(b.z||Zt[14],Ia(Wn(b.v)))),c(g,0,b.w,"V");break;default:c(g,1,0,"")}}}c(g,-1,0,"EOD");var q=`\r
`,G=g.join(q);return G}})();return{to_workbook:s,to_sheet:e,from_sheet:i}})(),bj=(function(){function t(b){return b.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(b){return b.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(b,E){for(var w=b.split(`
`),R=-1,y=-1,U=0,q=[];U!==w.length;++U){var G=w[U].trim().split(":");if(G[0]==="cell"){var _=Va(G[1]);if(q.length<=_.r)for(R=q.length;R<=_.r;++R)q[R]||(q[R]=[]);switch(R=_.r,y=_.c,G[2]){case"t":q[R][y]=t(G[3]);break;case"v":q[R][y]=+G[3];break;case"vtf":var ne=G[G.length-1];case"vtc":switch(G[3]){case"nl":q[R][y]=!!+G[4];break;default:q[R][y]=+G[4];break}G[2]=="vtf"&&(q[R][y]=[q[R][y],ne])}}}return E&&E.sheetRows&&(q=q.slice(0,E.sheetRows)),q}function s(b,E){return Ru(e(b,E),E)}function i(b,E){return ml(s(b,E),E)}var d=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,f=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),p="--SocialCalcSpreadsheetControlSave--";function g(b){if(!b||!b["!ref"])return"";for(var E=[],w=[],R,y="",U=ku(b["!ref"]),q=Array.isArray(b),G=U.s.r;G<=U.e.r;++G)for(var _=U.s.c;_<=U.e.c;++_)if(y=Jt({r:G,c:_}),R=q?(b[G]||[])[_]:b[y],!(!R||R.v==null||R.t==="z")){switch(w=["cell",y,"t"],R.t){case"s":case"str":w.push(n(R.v));break;case"n":R.f?(w[2]="vtf",w[3]="n",w[4]=R.v,w[5]=n(R.f)):(w[2]="v",w[3]=R.v);break;case"b":w[2]="vt"+(R.f?"f":"c"),w[3]="nl",w[4]=R.v?"1":"0",w[5]=n(R.f||(R.v?"TRUE":"FALSE"));break;case"d":var ne=Ia(Wn(R.v));w[2]="vtc",w[3]="nd",w[4]=""+ne,w[5]=R.w||ks(R.z||Zt[14],ne);break;case"e":continue}E.push(w.join(":"))}return E.push("sheet:c:"+(U.e.c-U.s.c+1)+":r:"+(U.e.r-U.s.r+1)+":tvf:1"),E.push("valueformat:1:text-wiki"),E.join(`
`)}function x(b){return[d,c,f,c,g(b),p].join(`
`)}return{to_workbook:i,to_sheet:s,from_sheet:x}})(),$f=(function(){function t(x,b,E,w,R){R.raw?b[E][w]=x:x===""||(x==="TRUE"?b[E][w]=!0:x==="FALSE"?b[E][w]=!1:isNaN(ai(x))?isNaN(Su(x).getDate())?b[E][w]=x:b[E][w]=Wn(x):b[E][w]=ai(x))}function n(x,b){var E=b||{},w=[];if(!x||x.length===0)return w;for(var R=x.split(/[\r\n]/),y=R.length-1;y>=0&&R[y].length===0;)--y;for(var U=10,q=0,G=0;G<=y;++G)q=R[G].indexOf(" "),q==-1?q=R[G].length:q++,U=Math.max(U,q);for(G=0;G<=y;++G){w[G]=[];var _=0;for(t(R[G].slice(0,U).trim(),w,G,_,E),_=1;_<=(R[G].length-U)/10+1;++_)t(R[G].slice(U+(_-1)*10,U+_*10).trim(),w,G,_,E)}return E.sheetRows&&(w=w.slice(0,E.sheetRows)),w}var e={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function i(x){for(var b={},E=!1,w=0,R=0;w<x.length;++w)(R=x.charCodeAt(w))==34?E=!E:!E&&R in e&&(b[R]=(b[R]||0)+1);R=[];for(w in b)Object.prototype.hasOwnProperty.call(b,w)&&R.push([b[w],w]);if(!R.length){b=s;for(w in b)Object.prototype.hasOwnProperty.call(b,w)&&R.push([b[w],w])}return R.sort(function(y,U){return y[0]-U[0]||s[y[1]]-s[U[1]]}),e[R.pop()[1]]||44}function d(x,b){var E=b||{},w="",R=E.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(w=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(w=x.charAt(4),x=x.slice(6)):w=i(x.slice(0,1024)):E&&E.FS?w=E.FS:w=i(x.slice(0,1024));var U=0,q=0,G=0,_=0,ne=0,ee=w.charCodeAt(0),Q=!1,z=0,ce=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var S=E.dateNF!=null?TL(E.dateNF):null;function A(){var W=x.slice(_,ne),H={};if(W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'&&(W=W.slice(1,-1).replace(/""/g,'"')),W.length===0)H.t="z";else if(E.raw)H.t="s",H.v=W;else if(W.trim().length===0)H.t="s",H.v=W;else if(W.charCodeAt(0)==61)W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(H.t="s",H.v=W.slice(2,-1).replace(/""/g,'"')):sM(W)?(H.t="n",H.f=W.slice(1)):(H.t="s",H.v=W);else if(W=="TRUE")H.t="b",H.v=!0;else if(W=="FALSE")H.t="b",H.v=!1;else if(!isNaN(G=ai(W)))H.t="n",E.cellText!==!1&&(H.w=W),H.v=G;else if(!isNaN(Su(W).getDate())||S&&W.match(S)){H.z=E.dateNF||Zt[14];var K=0;S&&W.match(S)&&(W=_L(W,E.dateNF,W.match(S)||[]),K=1),E.cellDates?(H.t="d",H.v=Wn(W,K)):(H.t="n",H.v=Ia(Wn(W,K))),E.cellText!==!1&&(H.w=ks(H.z,H.v instanceof Date?Ia(H.v):H.v)),E.cellNF||delete H.z}else H.t="s",H.v=W;if(H.t=="z"||(E.dense?(R[U]||(R[U]=[]),R[U][q]=H):R[Jt({c:q,r:U})]=H),_=ne+1,ce=x.charCodeAt(_),y.e.c<q&&(y.e.c=q),y.e.r<U&&(y.e.r=U),z==ee)++q;else if(q=0,++U,E.sheetRows&&E.sheetRows<=U)return!0}e:for(;ne<x.length;++ne)switch(z=x.charCodeAt(ne)){case 34:ce===34&&(Q=!Q);break;case ee:case 10:case 13:if(!Q&&A())break e;break}return ne-_>0&&A(),R["!ref"]=gr(y),R}function c(x,b){return!(b&&b.PRN)||b.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?d(x,b):Ru(n(x,b),b)}function f(x,b){var E="",w=b.type=="string"?[0,0,0,0]:TN(x,b);switch(b.type){case"base64":E=ds(x);break;case"binary":E=x;break;case"buffer":b.codepage==65001?E=x.toString("utf8"):b.codepage&&typeof jf<"u"||(E=fr&&Buffer.isBuffer(x)?x.toString("binary"):lc(x));break;case"array":E=ac(x);break;case"string":E=x;break;default:throw new Error("Unrecognized type "+b.type)}return w[0]==239&&w[1]==187&&w[2]==191?E=Mr(E.slice(3)):b.type!="string"&&b.type!="buffer"&&b.codepage==65001?E=Mr(E):b.type=="binary"&&typeof jf<"u",E.slice(0,19)=="socialcalc:version:"?bj.to_sheet(b.type=="string"?E:Mr(E),b):c(E,b)}function p(x,b){return ml(f(x,b),b)}function g(x){for(var b=[],E=tn(x["!ref"]),w,R=Array.isArray(x),y=E.s.r;y<=E.e.r;++y){for(var U=[],q=E.s.c;q<=E.e.c;++q){var G=Jt({r:y,c:q});if(w=R?(x[y]||[])[q]:x[G],!w||w.v==null){U.push("          ");continue}for(var _=(w.w||(po(w),w.w)||"").slice(0,10);_.length<10;)_+=" ";U.push(_+(q===0?" ":""))}b.push(U.join(""))}return b.join(`
`)}return{to_workbook:p,to_sheet:f,from_sheet:g}})();function Nj(t,n){var e=n||{},s=!!e.WTF;e.WTF=!0;try{var i=gj.to_workbook(t,e);return e.WTF=s,i}catch(d){if(e.WTF=s,!d.message.match(/SYLK bad record ID/)&&s)throw d;return $f.to_workbook(t,n)}}var Pf=(function(){function t(j,X,T){if(j){oa(j,j.l||0);for(var O=T.Enum||Ee;j.l<j.length;){var P=j.read_shift(2),F=O[P]||O[65535],de=j.read_shift(2),fe=j.l+de,ge=F.f&&F.f(j,de,T);if(j.l=fe,X(ge,F,P))return}}}function n(j,X){switch(X.type){case"base64":return e(ti(ds(j)),X);case"binary":return e(ti(j),X);case"buffer":case"array":return e(j,X)}throw"Unsupported type "+X.type}function e(j,X){if(!j)return j;var T=X||{},O=T.dense?[]:{},P="Sheet1",F="",de=0,fe={},ge=[],ze=[],oe={s:{r:0,c:0},e:{r:0,c:0}},Tt=T.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)T.Enum=Ee,t(j,function(Ke,er,wr){switch(wr){case 0:T.vers=Ke,Ke>=4096&&(T.qpro=!0);break;case 6:oe=Ke;break;case 204:Ke&&(F=Ke);break;case 222:F=Ke;break;case 15:case 51:T.qpro||(Ke[1].v=Ke[1].v.slice(1));case 13:case 14:case 16:wr==14&&(Ke[2]&112)==112&&(Ke[2]&15)>1&&(Ke[2]&15)<15&&(Ke[1].z=T.dateNF||Zt[14],T.cellDates&&(Ke[1].t="d",Ke[1].v=Gh(Ke[1].v))),T.qpro&&Ke[3]>de&&(O["!ref"]=gr(oe),fe[P]=O,ge.push(P),O=T.dense?[]:{},oe={s:{r:0,c:0},e:{r:0,c:0}},de=Ke[3],P=F||"Sheet"+(de+1),F="");var ur=T.dense?(O[Ke[0].r]||[])[Ke[0].c]:O[Jt(Ke[0])];if(ur){ur.t=Ke[1].t,ur.v=Ke[1].v,Ke[1].z!=null&&(ur.z=Ke[1].z),Ke[1].f!=null&&(ur.f=Ke[1].f);break}T.dense?(O[Ke[0].r]||(O[Ke[0].r]=[]),O[Ke[0].r][Ke[0].c]=Ke[1]):O[Jt(Ke[0])]=Ke[1];break}},T);else if(j[2]==26||j[2]==14)T.Enum=Ce,j[2]==14&&(T.qpro=!0,j.l=0),t(j,function(Ke,er,wr){switch(wr){case 204:P=Ke;break;case 22:Ke[1].v=Ke[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ke[3]>de&&(O["!ref"]=gr(oe),fe[P]=O,ge.push(P),O=T.dense?[]:{},oe={s:{r:0,c:0},e:{r:0,c:0}},de=Ke[3],P="Sheet"+(de+1)),Tt>0&&Ke[0].r>=Tt)break;T.dense?(O[Ke[0].r]||(O[Ke[0].r]=[]),O[Ke[0].r][Ke[0].c]=Ke[1]):O[Jt(Ke[0])]=Ke[1],oe.e.c<Ke[0].c&&(oe.e.c=Ke[0].c),oe.e.r<Ke[0].r&&(oe.e.r=Ke[0].r);break;case 27:Ke[14e3]&&(ze[Ke[14e3][0]]=Ke[14e3][1]);break;case 1537:ze[Ke[0]]=Ke[1],Ke[0]==de&&(P=Ke[1]);break}},T);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(O["!ref"]=gr(oe),fe[F||P]=O,ge.push(F||P),!ze.length)return{SheetNames:ge,Sheets:fe};for(var ft={},xt=[],Dt=0;Dt<ze.length;++Dt)fe[ge[Dt]]?(xt.push(ze[Dt]||ge[Dt]),ft[ze[Dt]]=fe[ze[Dt]]||fe[ge[Dt]]):(xt.push(ze[Dt]),ft[ze[Dt]]={"!ref":"A1"});return{SheetNames:xt,Sheets:ft}}function s(j,X){var T=X||{};if(+T.codepage>=0&&ri(+T.codepage),T.type=="string")throw new Error("Cannot write WK1 to JS string");var O=Mb(),P=tn(j["!ref"]),F=Array.isArray(j),de=[];Zs(O,0,d(1030)),Zs(O,6,p(P));for(var fe=Math.min(P.e.r,8191),ge=P.s.r;ge<=fe;++ge)for(var ze=ca(ge),oe=P.s.c;oe<=P.e.c;++oe){ge===P.s.r&&(de[oe]=Pn(oe));var Tt=de[oe]+ze,ft=F?(j[ge]||[])[oe]:j[Tt];if(!(!ft||ft.t=="z"))if(ft.t=="n")(ft.v|0)==ft.v&&ft.v>=-32768&&ft.v<=32767?Zs(O,13,w(ge,oe,ft.v)):Zs(O,14,y(ge,oe,ft.v));else{var xt=po(ft);Zs(O,15,b(ge,oe,xt.slice(0,239)))}}return Zs(O,1),O.end()}function i(j,X){var T=X||{};if(+T.codepage>=0&&ri(+T.codepage),T.type=="string")throw new Error("Cannot write WK3 to JS string");var O=Mb();Zs(O,0,c(j));for(var P=0,F=0;P<j.SheetNames.length;++P)(j.Sheets[j.SheetNames[P]]||{})["!ref"]&&Zs(O,27,ie(j.SheetNames[P],F++));var de=0;for(P=0;P<j.SheetNames.length;++P){var fe=j.Sheets[j.SheetNames[P]];if(!(!fe||!fe["!ref"])){for(var ge=tn(fe["!ref"]),ze=Array.isArray(fe),oe=[],Tt=Math.min(ge.e.r,8191),ft=ge.s.r;ft<=Tt;++ft)for(var xt=ca(ft),Dt=ge.s.c;Dt<=ge.e.c;++Dt){ft===ge.s.r&&(oe[Dt]=Pn(Dt));var Ke=oe[Dt]+xt,er=ze?(fe[ft]||[])[Dt]:fe[Ke];if(!(!er||er.t=="z"))if(er.t=="n")Zs(O,23,A(ft,Dt,de,er.v));else{var wr=po(er);Zs(O,22,z(ft,Dt,de,wr.slice(0,239)))}}++de}}return Zs(O,1),O.end()}function d(j){var X=_n(2);return X.write_shift(2,j),X}function c(j){var X=_n(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var T=0,O=0,P=0,F=0;F<j.SheetNames.length;++F){var de=j.SheetNames[F],fe=j.Sheets[de];if(!(!fe||!fe["!ref"])){++P;var ge=ku(fe["!ref"]);T<ge.e.r&&(T=ge.e.r),O<ge.e.c&&(O=ge.e.c)}}return T>8191&&(T=8191),X.write_shift(2,T),X.write_shift(1,P),X.write_shift(1,O),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function f(j,X,T){var O={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&T.qpro?(O.s.c=j.read_shift(1),j.l++,O.s.r=j.read_shift(2),O.e.c=j.read_shift(1),j.l++,O.e.r=j.read_shift(2),O):(O.s.c=j.read_shift(2),O.s.r=j.read_shift(2),X==12&&T.qpro&&(j.l+=2),O.e.c=j.read_shift(2),O.e.r=j.read_shift(2),X==12&&T.qpro&&(j.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function p(j){var X=_n(8);return X.write_shift(2,j.s.c),X.write_shift(2,j.s.r),X.write_shift(2,j.e.c),X.write_shift(2,j.e.r),X}function g(j,X,T){var O=[{c:0,r:0},{t:"n",v:0},0,0];return T.qpro&&T.vers!=20768?(O[0].c=j.read_shift(1),O[3]=j.read_shift(1),O[0].r=j.read_shift(2),j.l+=2):(O[2]=j.read_shift(1),O[0].c=j.read_shift(2),O[0].r=j.read_shift(2)),O}function x(j,X,T){var O=j.l+X,P=g(j,X,T);if(P[1].t="s",T.vers==20768){j.l++;var F=j.read_shift(1);return P[1].v=j.read_shift(F,"utf8"),P}return T.qpro&&j.l++,P[1].v=j.read_shift(O-j.l,"cstr"),P}function b(j,X,T){var O=_n(7+T.length);O.write_shift(1,255),O.write_shift(2,X),O.write_shift(2,j),O.write_shift(1,39);for(var P=0;P<O.length;++P){var F=T.charCodeAt(P);O.write_shift(1,F>=128?95:F)}return O.write_shift(1,0),O}function E(j,X,T){var O=g(j,X,T);return O[1].v=j.read_shift(2,"i"),O}function w(j,X,T){var O=_n(7);return O.write_shift(1,255),O.write_shift(2,X),O.write_shift(2,j),O.write_shift(2,T,"i"),O}function R(j,X,T){var O=g(j,X,T);return O[1].v=j.read_shift(8,"f"),O}function y(j,X,T){var O=_n(13);return O.write_shift(1,255),O.write_shift(2,X),O.write_shift(2,j),O.write_shift(8,T,"f"),O}function U(j,X,T){var O=j.l+X,P=g(j,X,T);if(P[1].v=j.read_shift(8,"f"),T.qpro)j.l=O;else{var F=j.read_shift(2);ne(j.slice(j.l,j.l+F),P),j.l+=F}return P}function q(j,X,T){var O=X&32768;return X&=-32769,X=(O?j:0)+(X>=8192?X-16384:X),(O?"":"$")+(T?Pn(X):ca(X))}var G={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function ne(j,X){oa(j,0);for(var T=[],O=0,P="",F="",de="",fe="";j.l<j.length;){var ge=j[j.l++];switch(ge){case 0:T.push(j.read_shift(8,"f"));break;case 1:F=q(X[0].c,j.read_shift(2),!0),P=q(X[0].r,j.read_shift(2),!1),T.push(F+P);break;case 2:{var ze=q(X[0].c,j.read_shift(2),!0),oe=q(X[0].r,j.read_shift(2),!1);F=q(X[0].c,j.read_shift(2),!0),P=q(X[0].r,j.read_shift(2),!1),T.push(ze+oe+":"+F+P)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:T.push("("+T.pop()+")");break;case 5:T.push(j.read_shift(2));break;case 6:{for(var Tt="";ge=j[j.l++];)Tt+=String.fromCharCode(ge);T.push('"'+Tt.replace(/"/g,'""')+'"')}break;case 8:T.push("-"+T.pop());break;case 23:T.push("+"+T.pop());break;case 22:T.push("NOT("+T.pop()+")");break;case 20:case 21:fe=T.pop(),de=T.pop(),T.push(["AND","OR"][ge-20]+"("+de+","+fe+")");break;default:if(ge<32&&_[ge])fe=T.pop(),de=T.pop(),T.push(de+_[ge]+fe);else if(G[ge]){if(O=G[ge][1],O==69&&(O=j[j.l++]),O>T.length){console.error("WK1 bad formula parse 0x"+ge.toString(16)+":|"+T.join("|")+"|");return}var ft=T.slice(-O);T.length-=O,T.push(G[ge][0]+"("+ft.join(",")+")")}else return ge<=7?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=24?console.error("WK1 unsupported op "+ge.toString(16)):ge<=30?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=115?console.error("WK1 unsupported function opcode "+ge.toString(16)):console.error("WK1 unrecognized opcode "+ge.toString(16))}}T.length==1?X[1].f=""+T[0]:console.error("WK1 bad formula parse |"+T.join("|")+"|")}function ee(j){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=j.read_shift(2),X[3]=j[j.l++],X[0].c=j[j.l++],X}function Q(j,X){var T=ee(j);return T[1].t="s",T[1].v=j.read_shift(X-4,"cstr"),T}function z(j,X,T,O){var P=_n(6+O.length);P.write_shift(2,j),P.write_shift(1,T),P.write_shift(1,X),P.write_shift(1,39);for(var F=0;F<O.length;++F){var de=O.charCodeAt(F);P.write_shift(1,de>=128?95:de)}return P.write_shift(1,0),P}function ce(j,X){var T=ee(j);T[1].v=j.read_shift(2);var O=T[1].v>>1;if(T[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return T[1].v=O,T}function S(j,X){var T=ee(j),O=j.read_shift(4),P=j.read_shift(4),F=j.read_shift(2);if(F==65535)return O===0&&P===3221225472?(T[1].t="e",T[1].v=15):O===0&&P===3489660928?(T[1].t="e",T[1].v=42):T[1].v=0,T;var de=F&32768;return F=(F&32767)-16446,T[1].v=(1-de*2)*(P*Math.pow(2,F+32)+O*Math.pow(2,F)),T}function A(j,X,T,O){var P=_n(14);if(P.write_shift(2,j),P.write_shift(1,T),P.write_shift(1,X),O==0)return P.write_shift(4,0),P.write_shift(4,0),P.write_shift(2,65535),P;var F=0,de=0,fe=0,ge=0;return O<0&&(F=1,O=-O),de=Math.log2(O)|0,O/=Math.pow(2,de-31),ge=O>>>0,(ge&2147483648)==0&&(O/=2,++de,ge=O>>>0),O-=ge,ge|=2147483648,ge>>>=0,O*=Math.pow(2,32),fe=O>>>0,P.write_shift(4,fe),P.write_shift(4,ge),de+=16383+(F?32768:0),P.write_shift(2,de),P}function W(j,X){var T=S(j);return j.l+=X-14,T}function H(j,X){var T=ee(j),O=j.read_shift(4);return T[1].v=O>>6,T}function K(j,X){var T=ee(j),O=j.read_shift(8,"f");return T[1].v=O,T}function Oe(j,X){var T=K(j);return j.l+=X-10,T}function ye(j,X){return j[j.l+X-1]==0?j.read_shift(X,"cstr"):""}function Pe(j,X){var T=j[j.l++];T>X-1&&(T=X-1);for(var O="";O.length<T;)O+=String.fromCharCode(j[j.l++]);return O}function ve(j,X,T){if(!(!T.qpro||X<21)){var O=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var P=j.read_shift(X-21,"cstr");return[O,P]}}function Ge(j,X){for(var T={},O=j.l+X;j.l<O;){var P=j.read_shift(2);if(P==14e3){for(T[P]=[0,""],T[P][0]=j.read_shift(2);j[j.l];)T[P][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return T}function ie(j,X){var T=_n(5+j.length);T.write_shift(2,14e3),T.write_shift(2,X);for(var O=0;O<j.length;++O){var P=j.charCodeAt(O);T[T.l++]=P>127?95:P}return T[T.l++]=0,T}var Ee={0:{n:"BOF",f:pn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:E},14:{n:"NUMBER",f:R},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:U},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ye},222:{n:"SHEETNAMELP",f:Pe},65535:{n:""}},Ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Q},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:ce},25:{n:"FORMULA19",f:W},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ge},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:K},40:{n:"FORMULA28",f:Oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ye},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ve},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:i,to_workbook:n}})();function Dj(t){var n={},e=t.match(Ea),s=0,i=!1;if(e)for(;s!=e.length;++s){var d=Wt(e[s]);switch(d[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!d.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(d.val=="1")break;n.cp=iN[parseInt(d.val,10)];break;case"<outline":if(!d.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=d.val;break;case"<sz":n.sz=d.val;break;case"<strike":if(!d.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!d.val)break;switch(d.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(d.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(d.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":d.rgb&&(n.color=d.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=d.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=d.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(d[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+d[0])}}return n}var Sj=(function(){var t=Mf("t"),n=Mf("rPr");function e(d){var c=d.match(t);if(!c)return{t:"s",v:""};var f={t:"s",v:Sr(c[1])},p=d.match(n);return p&&(f.s=Dj(p[1])),f}var s=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(c){return c.replace(s,"").split(i).map(e).filter(function(f){return f.v})}})(),yj=(function(){var n=/(\r\n|\n)/g;function e(i,d,c){var f=[];i.u&&f.push("text-decoration: underline;"),i.uval&&f.push("text-underline-style:"+i.uval+";"),i.sz&&f.push("font-size:"+i.sz+"pt;"),i.outline&&f.push("text-effect: outline;"),i.shadow&&f.push("text-shadow: auto;"),d.push('<span style="'+f.join("")+'">'),i.b&&(d.push("<b>"),c.push("</b>")),i.i&&(d.push("<i>"),c.push("</i>")),i.strike&&(d.push("<s>"),c.push("</s>"));var p=i.valign||"";return p=="superscript"||p=="super"?p="sup":p=="subscript"&&(p="sub"),p!=""&&(d.push("<"+p+">"),c.push("</"+p+">")),c.push("</span>"),i}function s(i){var d=[[],i.v,[]];return i.v?(i.s&&e(i.s,d[0],d[2]),d[0].join("")+d[1].replace(n,"<br/>")+d[2].join("")):""}return function(d){return d.map(s).join("")}})(),Oj=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Ej=/<(?:\w+:)?r>/,wj=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function yN(t,n){var e=n?n.cellHTML:!0,s={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=Sr(Mr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=Mr(t),e&&(s.h=mN(s.t))):t.match(Ej)&&(s.r=Mr(t),s.t=Sr(Mr((t.replace(wj,"").match(Oj)||[]).join("").replace(Ea,""))),e&&(s.h=yj(Sj(s.r)))),s):{t:""}}var Cj=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,kj=/<(?:\w+:)?(?:si|sstItem)>/g,Rj=/<\/(?:\w+:)?(?:si|sstItem)>/;function Tj(t,n){var e=[],s="";if(!t)return e;var i=t.match(Cj);if(i){s=i[2].replace(kj,"").split(Rj);for(var d=0;d!=s.length;++d){var c=yN(s[d].trim(),n);c!=null&&(e[e.length]=c)}i=Wt(i[1]),e.Count=i.count,e.Unique=i.uniqueCount}return e}function _j(t){return[t.read_shift(4),t.read_shift(4)]}function Pj(t,n){var e=[],s=!1;return go(t,function(d,c,f){switch(f){case 159:e.Count=d[0],e.Unique=d[1];break;case 19:e.push(d);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(c.T,!s||n.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}),e}function yC(t){for(var n=[],e=t.split(""),s=0;s<e.length;++s)n[s]=e[s].charCodeAt(0);return n}function mo(t,n){var e={};return e.Major=t.read_shift(2),e.Minor=t.read_shift(2),n>=4&&(t.l+=n-4),e}function Uj(t){var n={};return n.id=t.read_shift(0,"lpp4"),n.R=mo(t,4),n.U=mo(t,4),n.W=mo(t,4),n}function Aj(t){for(var n=t.read_shift(4),e=t.l+n-4,s={},i=t.read_shift(4),d=[];i-- >0;)d.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(s.name=t.read_shift(0,"lpp4"),s.comps=d,t.l!=e)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+e);return s}function Lj(t){var n=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)n.push(Aj(t));return n}function Vj(t){var n=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)n.push(t.read_shift(0,"lpp4"));return n}function jj(t){var n={};return t.read_shift(4),t.l+=4,n.id=t.read_shift(0,"lpp4"),n.name=t.read_shift(0,"lpp4"),n.R=mo(t,4),n.U=mo(t,4),n.W=mo(t,4),n}function Ij(t){var n=jj(t);if(n.ename=t.read_shift(0,"8lpp4"),n.blksz=t.read_shift(4),n.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function OC(t,n){var e=t.l+n,s={};s.Flags=t.read_shift(4)&63,t.l+=4,s.AlgID=t.read_shift(4);var i=!1;switch(s.AlgID){case 26126:case 26127:case 26128:i=s.Flags==36;break;case 26625:i=s.Flags==4;break;case 0:i=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=t.read_shift(4),s.KeySize=t.read_shift(4),s.ProviderType=t.read_shift(4),t.l+=8,s.CSPName=t.read_shift(e-t.l>>1,"utf16le"),t.l=e,s}function EC(t,n){var e={},s=t.l+n;return t.l+=4,e.Salt=t.slice(t.l,t.l+16),t.l+=16,e.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),e.VerifierHash=t.slice(t.l,s),t.l=s,e}function Mj(t){var n=mo(t);switch(n.Minor){case 2:return[n.Minor,Fj(t)];case 3:return[n.Minor,$j()];case 4:return[n.Minor,Bj(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function Fj(t){var n=t.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4),s=OC(t,e),i=EC(t,t.length-t.l);return{t:"Std",h:s,v:i}}function $j(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Bj(t){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var e=t.read_shift(t.length-t.l,"utf8"),s={};return e.replace(Ea,function(d){var c=Wt(d);switch(Pi(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(f){s[f]=c[f]});break;case"<dataIntegrity":s.encryptedHmacKey=c.encryptedHmacKey,s.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(c);break;default:throw c[0]}}),s}function Hj(t,n){var e={},s=e.EncryptionVersionInfo=mo(t,4);if(n-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);e.Flags=t.read_shift(4),n-=4;var i=t.read_shift(4);return n-=4,e.EncryptionHeader=OC(t,i),n-=i,e.EncryptionVerifier=EC(t,n),e}function Wj(t){var n={},e=n.EncryptionVersionInfo=mo(t,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return n.Salt=t.read_shift(16),n.EncryptedVerifier=t.read_shift(16),n.EncryptedVerifierHash=t.read_shift(16),n}function zj(t){var n=0,e,s=yC(t),i=s.length+1,d,c,f,p,g;for(e=ul(i),e[0]=s.length,d=1;d!=i;++d)e[d]=s[d-1];for(d=i-1;d>=0;--d)c=e[d],f=(n&16384)===0?0:1,p=n<<1&32767,g=f|p,n=g^c;return n^52811}var wC=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(c){return(c/2|c*128)&255},i=function(c,f){return s(c^f)},d=function(c){for(var f=n[c.length-1],p=104,g=c.length-1;g>=0;--g)for(var x=c[g],b=0;b!=7;++b)x&64&&(f^=e[p]),x*=2,--p;return f};return function(c){for(var f=yC(c),p=d(f),g=f.length,x=ul(16),b=0;b!=16;++b)x[b]=0;var E,w,R;for((g&1)===1&&(E=p>>8,x[g]=i(t[0],E),--g,E=p&255,w=f[f.length-1],x[g]=i(w,E));g>0;)--g,E=p>>8,x[g]=i(f[g],E),--g,E=p&255,x[g]=i(f[g],E);for(g=15,R=15-f.length;R>0;)E=p>>8,x[g]=i(t[R],E),--g,--R,E=p&255,x[g]=i(f[g],E),--g,--R;return x}})(),Xj=function(t,n,e,s,i){i||(i=n),s||(s=wC(t));var d,c;for(d=0;d!=n.length;++d)c=n[d],c^=s[e],c=(c>>5|c<<3)&255,i[d]=c,++e;return[i,e,s]},Gj=function(t){var n=0,e=wC(t);return function(s){var i=Xj("",s,n,e);return n=i[1],i[0]}};function Yj(t,n,e,s){var i={key:pn(t),verificationBytes:pn(t)};return e.password&&(i.verifier=zj(e.password)),s.valid=i.verificationBytes===i.verifier,s.valid&&(s.insitu=Gj(e.password)),i}function qj(t,n,e){var s=e||{};return s.Info=t.read_shift(2),t.l-=2,s.Info===1?s.Data=Wj(t):s.Data=Hj(t,n),s}function Kj(t,n,e){var s={Type:e.biff>=8?t.read_shift(2):0};return s.Type?qj(t,n-2,s):Yj(t,e.biff>=8?n:n-2,e,s),s}var Jj=(function(){function t(i,d){switch(d.type){case"base64":return n(ds(i),d);case"binary":return n(i,d);case"buffer":return n(fr&&Buffer.isBuffer(i)?i.toString("binary"):lc(i),d);case"array":return n(ac(i),d)}throw new Error("Unrecognized type "+d.type)}function n(i,d){var c=d||{},f=c.dense?[]:{},p=i.match(/\\trowd.*?\\row\b/g);if(!p.length)throw new Error("RTF missing table");var g={s:{c:0,r:0},e:{c:0,r:p.length-1}};return p.forEach(function(x,b){Array.isArray(f)&&(f[b]=[]);for(var E=/\\\w+\b/g,w=0,R,y=-1;R=E.exec(x);){switch(R[0]){case"\\cell":var U=x.slice(w,E.lastIndex-R[0].length);if(U[0]==" "&&(U=U.slice(1)),++y,U.length){var q={v:U,t:"s"};Array.isArray(f)?f[b][y]=q:f[Jt({r:b,c:y})]=q}break}w=E.lastIndex}y>g.e.c&&(g.e.c=y)}),f["!ref"]=gr(g),f}function e(i,d){return ml(t(i,d),d)}function s(i){for(var d=["{\\rtf1\\ansi"],c=tn(i["!ref"]),f,p=Array.isArray(i),g=c.s.r;g<=c.e.r;++g){d.push("\\trowd\\trautofit1");for(var x=c.s.c;x<=c.e.c;++x)d.push("\\cellx"+(x+1));for(d.push("\\pard\\intbl"),x=c.s.c;x<=c.e.c;++x){var b=Jt({r:g,c:x});f=p?(i[g]||[])[x]:i[b],!(!f||f.v==null&&(!f.f||f.F))&&(d.push(" "+(f.w||(po(f),f.w))),d.push("\\cell"))}d.push("\\pard\\intbl\\row")}return d.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:s}})();function Qj(t){var n=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function Bf(t){for(var n=0,e=1;n!=3;++n)e=e*256+(t[n]>255?255:t[n]<0?0:t[n]);return e.toString(16).toUpperCase().slice(1)}function Zj(t){var n=t[0]/255,e=t[1]/255,s=t[2]/255,i=Math.max(n,e,s),d=Math.min(n,e,s),c=i-d;if(c===0)return[0,0,n];var f=0,p=0,g=i+d;switch(p=c/(g>1?2-g:g),i){case n:f=((e-s)/c+6)%6;break;case e:f=(s-n)/c+2;break;case s:f=(n-e)/c+4;break}return[f/6,p,g/2]}function eI(t){var n=t[0],e=t[1],s=t[2],i=e*2*(s<.5?s:1-s),d=s-i/2,c=[d,d,d],f=6*n,p;if(e!==0)switch(f|0){case 0:case 6:p=i*f,c[0]+=i,c[1]+=p;break;case 1:p=i*(2-f),c[0]+=p,c[1]+=i;break;case 2:p=i*(f-2),c[1]+=i,c[2]+=p;break;case 3:p=i*(4-f),c[1]+=p,c[2]+=i;break;case 4:p=i*(f-4),c[2]+=i,c[0]+=p;break;case 5:p=i*(6-f),c[2]+=p,c[0]+=i;break}for(var g=0;g!=3;++g)c[g]=Math.round(c[g]*255);return c}function Ih(t,n){if(n===0)return t;var e=Zj(Qj(t));return n<0?e[2]=e[2]*(1+n):e[2]=1-(1-e[2])*(1-n),Bf(eI(e))}var CC=6,tI=15,rI=1,La=CC;function Mh(t){return Math.floor((t+Math.round(128/La)/256)*La)}function Fh(t){return Math.floor((t-5)/La*100+.5)/100}function Hb(t){return Math.round((t*La+5)/La*256)/256}function yb(t){return Hb(Fh(Mh(t)))}function ON(t){var n=Math.abs(t-yb(t)),e=La;if(n>.005)for(La=rI;La<tI;++La)Math.abs(t-yb(t))<=n&&(n=Math.abs(t-yb(t)),e=La);La=e}function yu(t){t.width?(t.wpx=Mh(t.width),t.wch=Fh(t.wpx),t.MDW=La):t.wpx?(t.wch=Fh(t.wpx),t.width=Hb(t.wch),t.MDW=La):typeof t.wch=="number"&&(t.width=Hb(t.wch),t.wpx=Mh(t.width),t.MDW=La),t.customWidth&&delete t.customWidth}var nI=96,kC=nI;function RC(t){return t*96/kC}function Hf(t){return t*kC/96}var aI={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function sI(t,n,e,s){n.Borders=[];var i={},d=!1;(t[0].match(Ea)||[]).forEach(function(c){var f=Wt(c);switch(Pi(f[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},f.diagonalUp&&(i.diagonalUp=zr(f.diagonalUp)),f.diagonalDown&&(i.diagonalDown=zr(f.diagonalDown)),n.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":d=!0;break;case"</ext>":d=!1;break;default:if(s&&s.WTF&&!d)throw new Error("unrecognized "+f[0]+" in borders")}})}function iI(t,n,e,s){n.Fills=[];var i={},d=!1;(t[0].match(Ea)||[]).forEach(function(c){var f=Wt(c);switch(Pi(f[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},n.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":f.patternType&&(i.patternType=f.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),f.indexed&&(i.bgColor.indexed=parseInt(f.indexed,10)),f.theme&&(i.bgColor.theme=parseInt(f.theme,10)),f.tint&&(i.bgColor.tint=parseFloat(f.tint)),f.rgb&&(i.bgColor.rgb=f.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),f.theme&&(i.fgColor.theme=parseInt(f.theme,10)),f.tint&&(i.fgColor.tint=parseFloat(f.tint)),f.rgb!=null&&(i.fgColor.rgb=f.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":d=!0;break;case"</ext>":d=!1;break;default:if(s&&s.WTF&&!d)throw new Error("unrecognized "+f[0]+" in fills")}})}function oI(t,n,e,s){n.Fonts=[];var i={},d=!1;(t[0].match(Ea)||[]).forEach(function(c){var f=Wt(c);switch(Pi(f[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(i),i={};break;case"<name":f.val&&(i.name=Mr(f.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=f.val?zr(f.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=f.val?zr(f.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(f.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=f.val?zr(f.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=f.val?zr(f.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=f.val?zr(f.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=f.val?zr(f.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=f.val?zr(f.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":f.val&&(i.sz=+f.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":f.val&&(i.vertAlign=f.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":f.val&&(i.family=parseInt(f.val,10));break;case"<family/>":case"</family>":break;case"<scheme":f.val&&(i.scheme=f.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(f.val=="1")break;f.codepage=iN[parseInt(f.val,10)];break;case"<color":if(i.color||(i.color={}),f.auto&&(i.color.auto=zr(f.auto)),f.rgb)i.color.rgb=f.rgb.slice(-6);else if(f.indexed){i.color.index=parseInt(f.indexed,10);var p=rc[i.color.index];i.color.index==81&&(p=rc[1]),p||(p=rc[1]),i.color.rgb=p[0].toString(16)+p[1].toString(16)+p[2].toString(16)}else f.theme&&(i.color.theme=parseInt(f.theme,10),f.tint&&(i.color.tint=parseFloat(f.tint)),f.theme&&e.themeElements&&e.themeElements.clrScheme&&(i.color.rgb=Ih(e.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":d=!0;break;case"</AlternateContent>":d=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":d=!0;break;case"</ext>":d=!1;break;default:if(s&&s.WTF&&!d)throw new Error("unrecognized "+f[0]+" in fonts")}})}function lI(t,n,e){n.NumberFmt=[];for(var s=Ti(Zt),i=0;i<s.length;++i)n.NumberFmt[s[i]]=Zt[s[i]];var d=t[0].match(Ea);if(d)for(i=0;i<d.length;++i){var c=Wt(d[i]);switch(Pi(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var f=Sr(Mr(c.formatCode)),p=parseInt(c.numFmtId,10);if(n.NumberFmt[p]=f,p>0){if(p>392){for(p=392;p>60&&n.NumberFmt[p]!=null;--p);n.NumberFmt[p]=f}tc(f,p)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var bh=["numFmtId","fillId","fontId","borderId","xfId"],Nh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function cI(t,n,e){n.CellXf=[];var s,i=!1;(t[0].match(Ea)||[]).forEach(function(d){var c=Wt(d),f=0;switch(Pi(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=c,delete s[0],f=0;f<bh.length;++f)s[bh[f]]&&(s[bh[f]]=parseInt(s[bh[f]],10));for(f=0;f<Nh.length;++f)s[Nh[f]]&&(s[Nh[f]]=zr(s[Nh[f]]));if(n.NumberFmt&&s.numFmtId>392){for(f=392;f>60;--f)if(n.NumberFmt[s.numFmtId]==n.NumberFmt[f]){s.numFmtId=f;break}}n.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var p={};c.vertical&&(p.vertical=c.vertical),c.horizontal&&(p.horizontal=c.horizontal),c.textRotation!=null&&(p.textRotation=c.textRotation),c.indent&&(p.indent=c.indent),c.wrapText&&(p.wrapText=zr(c.wrapText)),s.alignment=p;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(e&&e.WTF&&!i)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var uI=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,d=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(f,p,g){var x={};if(!f)return x;f=f.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var b;return(b=f.match(n))&&lI(b,x,g),(b=f.match(i))&&oI(b,x,p,g),(b=f.match(s))&&iI(b,x,p,g),(b=f.match(d))&&sI(b,x,p,g),(b=f.match(e))&&cI(b,x,g),x}})();function dI(t,n){var e=t.read_shift(2),s=Sa(t);return[e,s]}function fI(t,n,e){var s={};s.sz=t.read_shift(2)/20;var i=SV(t);i.fItalic&&(s.italic=1),i.fCondense&&(s.condense=1),i.fExtend&&(s.extend=1),i.fShadow&&(s.shadow=1),i.fOutline&&(s.outline=1),i.fStrikeout&&(s.strike=1);var d=t.read_shift(2);switch(d===700&&(s.bold=1),t.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var c=t.read_shift(1);c!=0&&(s.underline=c);var f=t.read_shift(1);f>0&&(s.family=f);var p=t.read_shift(1);switch(p>0&&(s.charset=p),t.l++,s.color=DV(t),t.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=Sa(t),s}var mI=ya;function hI(t,n){var e=t.l+n,s=t.read_shift(2),i=t.read_shift(2);return t.l=e,{ixfe:s,numFmtId:i}}var pI=ya;function vI(t,n,e){var s={};s.NumberFmt=[];for(var i in Zt)s.NumberFmt[i]=Zt[i];s.CellXf=[],s.Fonts=[];var d=[],c=!1;return go(t,function(p,g,x){switch(x){case 44:s.NumberFmt[p[0]]=p[1],tc(p[1],p[0]);break;case 43:s.Fonts.push(p),p.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(p.color.rgb=Ih(n.themeElements.clrScheme[p.color.theme].rgb,p.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:d[d.length-1]==617&&s.CellXf.push(p);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:d.push(x),c=!0;break;case 38:d.pop(),c=!1;break;default:if(g.T>0)d.push(x);else if(g.T<0)d.pop();else if(!c||e.WTF&&d[d.length-1]!=37)throw new Error("Unexpected record 0x"+x.toString(16))}}),s}var gI=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function xI(t,n,e){n.themeElements.clrScheme=[];var s={};(t[0].match(Ea)||[]).forEach(function(i){var d=Wt(i);switch(d[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=d.val;break;case"<a:sysClr":s.rgb=d.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":d[0].charAt(1)==="/"?(n.themeElements.clrScheme[gI.indexOf(d[0])]=s,s={}):s.name=d[0].slice(3,d[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+d[0]+" in clrScheme")}})}function bI(){}function NI(){}var DI=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,SI=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,yI=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function OI(t,n,e){n.themeElements={};var s;[["clrScheme",DI,xI],["fontScheme",SI,bI],["fmtScheme",yI,NI]].forEach(function(i){if(!(s=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](s,n,e)})}var EI=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function TC(t,n){(!t||t.length===0)&&(t=wI());var e,s={};if(!(e=t.match(EI)))throw new Error("themeElements not found in theme");return OI(e[0],s,n),s.raw=t,s}function wI(t,n){var e=[$w];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function CI(t,n,e){var s=t.l+n,i=t.read_shift(4);if(i!==124226){if(!e.cellStyles){t.l=s;return}var d=t.slice(t.l);t.l=s;var c;try{c=Fw(d,{type:"array"})}catch{return}var f=us(c,"theme/theme/theme1.xml",!0);if(f)return TC(f,e)}}function kI(t){return t.read_shift(4)}function RI(t){var n={};switch(n.xclrType=t.read_shift(2),n.nTintShade=t.read_shift(2),n.xclrType){case 0:t.l+=4;break;case 1:n.xclrValue=TI(t,4);break;case 2:n.xclrValue=vC(t);break;case 3:n.xclrValue=kI(t);break;case 4:t.l+=4;break}return t.l+=8,n}function TI(t,n){return ya(t,n)}function _I(t,n){return ya(t,n)}function PI(t){var n=t.read_shift(2),e=t.read_shift(2)-4,s=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=RI(t);break;case 6:s[1]=_I(t,e);break;case 14:case 15:s[1]=t.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+e)}return s}function UI(t,n){var e=t.l+n;t.l+=2;var s=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),d=[];i-- >0;)d.push(PI(t,e-t.l));return{ixfe:s,ext:d}}function AI(t,n){n.forEach(function(e){e[0]})}function LI(t,n){return{flags:t.read_shift(4),version:t.read_shift(4),name:Sa(t)}}function VI(t){for(var n=[],e=t.read_shift(4);e-- >0;)n.push([t.read_shift(4),t.read_shift(4)]);return n}function jI(t){return t.l+=4,t.read_shift(4)!=0}function II(t,n,e){var s={Types:[],Cell:[],Value:[]},i=e||{},d=[],c=!1,f=2;return go(t,function(p,g,x){switch(x){case 335:s.Types.push({name:p.name});break;case 51:p.forEach(function(b){f==1?s.Cell.push({type:s.Types[b[0]-1].name,index:b[1]}):f==0&&s.Value.push({type:s.Types[b[0]-1].name,index:b[1]})});break;case 337:f=p?1:0;break;case 338:f=2;break;case 35:d.push(x),c=!0;break;case 36:d.pop(),c=!1;break;default:if(!g.T){if(!c||i.WTF&&d[d.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}}),s}function MI(t,n,e){var s={Types:[],Cell:[],Value:[]};if(!t)return s;var i=!1,d=2,c;return t.replace(Ea,function(f){var p=Wt(f);switch(Pi(p[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:p.name});break;case"</metadataType>":break;case"<futureMetadata":for(var g=0;g<s.Types.length;++g)s.Types[g].name==p.name&&(c=s.Types[g]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":d==1?s.Cell.push({type:s.Types[p.t-1].name,index:+p.v}):d==0&&s.Value.push({type:s.Types[p.t-1].name,index:+p.v});break;case"</rc>":break;case"<cellMetadata":d=1;break;case"</cellMetadata>":d=2;break;case"<valueMetadata":d=0;break;case"</valueMetadata>":d=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+p.i);break;default:if(!i&&e.WTF)throw new Error("unrecognized "+p[0]+" in metadata")}return f}),s}function FI(t){var n=[];if(!t)return n;var e=1;return(t.match(Ea)||[]).forEach(function(s){var i=Wt(s);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?e=i.i:i.i=e,n.push(i);break}}),n}function $I(t){var n={};n.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),n.r=Jt(e);var s=t.read_shift(1);return s&2&&(n.l="1"),s&8&&(n.a="1"),n}function BI(t,n,e){var s=[];return go(t,function(d,c,f){switch(f){case 63:s.push(d);break;default:if(!c.T)throw new Error("Unexpected record 0x"+f.toString(16))}}),s}function HI(t,n,e,s){if(!t)return t;var i=s||{},d=!1;go(t,function(f,p,g){switch(g){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:d=!0;break;case 36:d=!1;break;default:if(!p.T){if(!d||i.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}},i)}function WI(t,n){if(!t)return"??";var e=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][e].Target}function OE(t,n,e,s){var i=Array.isArray(t),d;n.forEach(function(c){var f=Va(c.ref);if(i?(t[f.r]||(t[f.r]=[]),d=t[f.r][f.c]):d=t[c.ref],!d){d={t:"z"},i?t[f.r][f.c]=d:t[c.ref]=d;var p=tn(t["!ref"]||"BDWGO1000001:A1");p.s.r>f.r&&(p.s.r=f.r),p.e.r<f.r&&(p.e.r=f.r),p.s.c>f.c&&(p.s.c=f.c),p.e.c<f.c&&(p.e.c=f.c);var g=gr(p);g!==t["!ref"]&&(t["!ref"]=g)}d.c||(d.c=[]);var x={a:c.author,t:c.t,r:c.r,T:e};c.h&&(x.h=c.h);for(var b=d.c.length-1;b>=0;--b){if(!e&&d.c[b].T)return;e&&!d.c[b].T&&d.c.splice(b,1)}if(e&&s){for(b=0;b<s.length;++b)if(x.a==s[b].id){x.a=s[b].name||x.a;break}}d.c.push(x)})}function zI(t,n){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],s=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var f=c.match(/<(?:\w+:)?author[^>]*>(.*)/);f&&e.push(f[1])}});var d=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return d&&d[1]&&d[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var f=c.match(/<(?:\w+:)?comment[^>]*>/);if(f){var p=Wt(f[0]),g={author:p.authorId&&e[p.authorId]||"sheetjsghost",ref:p.ref,guid:p.guid},x=Va(p.ref);if(!(n.sheetRows&&n.sheetRows<=x.r)){var b=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),E=!!b&&!!b[1]&&yN(b[1])||{r:"",t:"",h:""};g.r=E.r,E.r=="<t></t>"&&(E.t=E.h=""),g.t=(E.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(g.h=E.h),s.push(g)}}}}),s}function XI(t,n){var e=[],s=!1,i={},d=0;return t.replace(Ea,function(f,p){var g=Wt(f);switch(Pi(g[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:g.personId,guid:g.id,ref:g.ref,T:1};break;case"</threadedComment>":i.t!=null&&e.push(i);break;case"<text>":case"<text":d=p+f.length;break;case"</text>":i.t=t.slice(d,p).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&n.WTF)throw new Error("unrecognized "+g[0]+" in threaded comments")}return f}),e}function GI(t,n){var e=[],s=!1;return t.replace(Ea,function(d){var c=Wt(d);switch(Pi(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&n.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return d}),e}function YI(t){var n={};n.iauthor=t.read_shift(4);var e=uc(t);return n.rfx=e.s,n.ref=Jt(e.s),t.l+=16,n}var qI=Sa;function KI(t,n){var e=[],s=[],i={},d=!1;return go(t,function(f,p,g){switch(g){case 632:s.push(f);break;case 635:i=f;break;case 637:i.t=f.t,i.h=f.h,i.r=f.r;break;case 636:if(i.author=s[i.iauthor],delete i.iauthor,n.sheetRows&&i.rfx&&n.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,e.push(i);break;case 3072:break;case 35:d=!0;break;case 36:d=!1;break;case 37:break;case 38:break;default:if(!p.T){if(!d||n.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}),e}var JI="application/vnd.ms-office.vbaProject";function QI(t){var n=vr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(e,s){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var i=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");vr.utils.cfb_add(n,i,t.FileIndex[s].content)}}),vr.write(n)}function ZI(){return{"!type":"dialog"}}function eM(){return{"!type":"dialog"}}function tM(){return{"!type":"macro"}}function rM(){return{"!type":"macro"}}var Nu=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function e(s,i,d,c){var f=!1,p=!1;d.length==0?p=!0:d.charAt(0)=="["&&(p=!0,d=d.slice(1,-1)),c.length==0?f=!0:c.charAt(0)=="["&&(f=!0,c=c.slice(1,-1));var g=d.length>0?parseInt(d,10)|0:0,x=c.length>0?parseInt(c,10)|0:0;return f?x+=n.c:--x,p?g+=n.r:--g,i+(f?"":"$")+Pn(x)+(p?"":"$")+ca(g)}return function(i,d){return n=d,i.replace(t,e)}})(),_C=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,nM=(function(){return function(n,e){return n.replace(_C,function(s,i,d,c,f,p){var g=gN(c)-(d?0:e.c),x=vN(p)-(f?0:e.r),b=x==0?"":f?x+1:"["+x+"]",E=g==0?"":d?g+1:"["+g+"]";return i+"R"+b+"C"+E})}})();function PC(t,n){return t.replace(_C,function(e,s,i,d,c,f){return s+(i=="$"?i+d:Pn(gN(d)+n.c))+(c=="$"?c+f:ca(vN(f)+n.r))})}function aM(t,n,e){var s=ku(n),i=s.s,d=Va(e),c={r:d.r-i.r,c:d.c-i.c};return PC(t,c)}function sM(t){return t.length!=1}function EE(t){return t.replace(/_xlfn\./g,"")}function mn(t){t.l+=1}function dl(t,n){var e=t.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function UC(t,n,e){var s=2;if(e){if(e.biff>=2&&e.biff<=5)return AC(t);e.biff==12&&(s=4)}var i=t.read_shift(s),d=t.read_shift(s),c=dl(t),f=dl(t);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:d,c:f[0],cRel:f[1],rRel:f[2]}}}function AC(t){var n=dl(t),e=dl(t),s=t.read_shift(1),i=t.read_shift(1);return{s:{r:n[0],c:s,cRel:n[1],rRel:n[2]},e:{r:e[0],c:i,cRel:e[1],rRel:e[2]}}}function iM(t,n,e){if(e.biff<8)return AC(t);var s=t.read_shift(e.biff==12?4:2),i=t.read_shift(e.biff==12?4:2),d=dl(t),c=dl(t);return{s:{r:s,c:d[0],cRel:d[1],rRel:d[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function LC(t,n,e){if(e&&e.biff>=2&&e.biff<=5)return oM(t);var s=t.read_shift(e&&e.biff==12?4:2),i=dl(t);return{r:s,c:i[0],cRel:i[1],rRel:i[2]}}function oM(t){var n=dl(t),e=t.read_shift(1);return{r:n[0],c:e,cRel:n[1],rRel:n[2]}}function lM(t){var n=t.read_shift(2),e=t.read_shift(2);return{r:n,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function cM(t,n,e){var s=e&&e.biff?e.biff:8;if(s>=2&&s<=5)return uM(t);var i=t.read_shift(s>=12?4:2),d=t.read_shift(2),c=(d&16384)>>14,f=(d&32768)>>15;if(d&=16383,f==1)for(;i>524287;)i-=1048576;if(c==1)for(;d>8191;)d=d-16384;return{r:i,c:d,cRel:c,rRel:f}}function uM(t){var n=t.read_shift(2),e=t.read_shift(1),s=(n&32768)>>15,i=(n&16384)>>14;return n&=16383,s==1&&n>=8192&&(n=n-16384),i==1&&e>=128&&(e=e-256),{r:n,c:e,cRel:i,rRel:s}}function dM(t,n,e){var s=(t[t.l++]&96)>>5,i=UC(t,e.biff>=2&&e.biff<=5?6:8,e);return[s,i]}function fM(t,n,e){var s=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),d=8;if(e)switch(e.biff){case 5:t.l+=12,d=6;break;case 12:d=12;break}var c=UC(t,d,e);return[s,i,c]}function mM(t,n,e){var s=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[s]}function hM(t,n,e){var s=(t[t.l++]&96)>>5,i=t.read_shift(2),d=8;if(e)switch(e.biff){case 5:t.l+=12,d=6;break;case 12:d=12;break}return t.l+=d,[s,i]}function pM(t,n,e){var s=(t[t.l++]&96)>>5,i=iM(t,n-1,e);return[s,i]}function vM(t,n,e){var s=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[s]}function wE(t){var n=t[t.l+1]&1,e=1;return t.l+=4,[n,e]}function gM(t,n,e){t.l+=2;for(var s=t.read_shift(e&&e.biff==2?1:2),i=[],d=0;d<=s;++d)i.push(t.read_shift(e&&e.biff==2?1:2));return i}function xM(t,n,e){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(e&&e.biff==2?1:2)]}function bM(t,n,e){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(e&&e.biff==2?1:2)]}function NM(t){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(2)]}function DM(t,n,e){var s=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[s]}function VC(t){var n=t.read_shift(1),e=t.read_shift(1);return[n,e]}function SM(t){return t.read_shift(2),VC(t)}function yM(t){return t.read_shift(2),VC(t)}function OM(t,n,e){var s=(t[t.l]&96)>>5;t.l+=1;var i=LC(t,0,e);return[s,i]}function EM(t,n,e){var s=(t[t.l]&96)>>5;t.l+=1;var i=cM(t,0,e);return[s,i]}function wM(t,n,e){var s=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var d=LC(t,0,e);return[s,i,d]}function CM(t,n,e){var s=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(e&&e.biff<=3?1:2);return[kF[i],MC[i],s]}function kM(t,n,e){var s=t[t.l++],i=t.read_shift(1),d=e&&e.biff<=3?[s==88?-1:0,t.read_shift(1)]:RM(t);return[i,(d[0]===0?MC:CF)[d[1]]]}function RM(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function TM(t,n,e){t.l+=e&&e.biff==2?3:4}function _M(t,n,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var s=t.read_shift(2),i=t.read_shift(e&&e.biff==2?1:2);return[s,i]}function PM(t){return t.l++,dc[t.read_shift(1)]}function UM(t){return t.l++,t.read_shift(2)}function AM(t){return t.l++,t.read_shift(1)!==0}function LM(t){return t.l++,Na(t)}function VM(t,n,e){return t.l++,Jf(t,n-1,e)}function jM(t,n){var e=[t.read_shift(1)];if(n==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=ln(t,1)?"TRUE":"FALSE",n!=12&&(t.l+=7);break;case 37:case 16:e[1]=dc[t[t.l]],t.l+=n==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=Na(t);break;case 2:e[1]=fc(t,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function IM(t,n,e){for(var s=t.read_shift(e.biff==12?4:2),i=[],d=0;d!=s;++d)i.push((e.biff==12?uc:Yh)(t));return i}function MM(t,n,e){var s=0,i=0;e.biff==12?(s=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),s=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--s,--i==0&&(i=256));for(var d=0,c=[];d!=s&&(c[d]=[]);++d)for(var f=0;f!=i;++f)c[d][f]=jM(t,e.biff);return c}function FM(t,n,e){var s=t.read_shift(1)>>>5&3,i=!e||e.biff>=8?4:2,d=t.read_shift(i);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[s,0,d]}function $M(t,n,e){if(e.biff==5)return BM(t);var s=t.read_shift(1)>>>5&3,i=t.read_shift(2),d=t.read_shift(4);return[s,i,d]}function BM(t){var n=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var s=t.read_shift(2);return t.l+=12,[n,e,s]}function HM(t,n,e){var s=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var i=t.read_shift(e&&e.biff==2?1:2);return[s,i]}function WM(t,n,e){var s=t.read_shift(1)>>>5&3,i=t.read_shift(e&&e.biff==2?1:2);return[s,i]}function zM(t,n,e){var s=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[s]}function XM(t,n,e){var s=(t[t.l++]&96)>>5,i=t.read_shift(2),d=4;if(e)switch(e.biff){case 5:d=15;break;case 12:d=6;break}return t.l+=d,[s,i]}var GM=ya,YM=ya,qM=ya;function Zf(t,n,e){return t.l+=2,[lM(t)]}function EN(t){return t.l+=6,[]}var KM=Zf,JM=EN,QM=EN,ZM=Zf;function jC(t){return t.l+=2,[pn(t),t.read_shift(2)&1]}var eF=Zf,tF=jC,rF=EN,nF=Zf,aF=Zf,sF=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function iF(t){t.l+=2;var n=t.read_shift(2),e=t.read_shift(2),s=t.read_shift(4),i=t.read_shift(2),d=t.read_shift(2),c=sF[e>>2&31];return{ixti:n,coltype:e&3,rt:c,idx:s,c:i,C:d}}function oF(t){return t.l+=2,[t.read_shift(4)]}function lF(t,n,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function cF(t,n,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function uF(t){var n=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[n,e]}function dF(t){var n=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[n,e]}function fF(t){return t.l+=4,[0,0]}var CE={1:{n:"PtgExp",f:_M},2:{n:"PtgTbl",f:qM},3:{n:"PtgAdd",f:mn},4:{n:"PtgSub",f:mn},5:{n:"PtgMul",f:mn},6:{n:"PtgDiv",f:mn},7:{n:"PtgPower",f:mn},8:{n:"PtgConcat",f:mn},9:{n:"PtgLt",f:mn},10:{n:"PtgLe",f:mn},11:{n:"PtgEq",f:mn},12:{n:"PtgGe",f:mn},13:{n:"PtgGt",f:mn},14:{n:"PtgNe",f:mn},15:{n:"PtgIsect",f:mn},16:{n:"PtgUnion",f:mn},17:{n:"PtgRange",f:mn},18:{n:"PtgUplus",f:mn},19:{n:"PtgUminus",f:mn},20:{n:"PtgPercent",f:mn},21:{n:"PtgParen",f:mn},22:{n:"PtgMissArg",f:mn},23:{n:"PtgStr",f:VM},26:{n:"PtgSheet",f:lF},27:{n:"PtgEndSheet",f:cF},28:{n:"PtgErr",f:PM},29:{n:"PtgBool",f:AM},30:{n:"PtgInt",f:UM},31:{n:"PtgNum",f:LM},32:{n:"PtgArray",f:vM},33:{n:"PtgFunc",f:CM},34:{n:"PtgFuncVar",f:kM},35:{n:"PtgName",f:FM},36:{n:"PtgRef",f:OM},37:{n:"PtgArea",f:dM},38:{n:"PtgMemArea",f:HM},39:{n:"PtgMemErr",f:GM},40:{n:"PtgMemNoMem",f:YM},41:{n:"PtgMemFunc",f:WM},42:{n:"PtgRefErr",f:zM},43:{n:"PtgAreaErr",f:mM},44:{n:"PtgRefN",f:EM},45:{n:"PtgAreaN",f:pM},46:{n:"PtgMemAreaN",f:uF},47:{n:"PtgMemNoMemN",f:dF},57:{n:"PtgNameX",f:$M},58:{n:"PtgRef3d",f:wM},59:{n:"PtgArea3d",f:fM},60:{n:"PtgRefErr3d",f:XM},61:{n:"PtgAreaErr3d",f:hM},255:{}},mF={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},hF={1:{n:"PtgElfLel",f:jC},2:{n:"PtgElfRw",f:nF},3:{n:"PtgElfCol",f:KM},6:{n:"PtgElfRwV",f:aF},7:{n:"PtgElfColV",f:ZM},10:{n:"PtgElfRadical",f:eF},11:{n:"PtgElfRadicalS",f:rF},13:{n:"PtgElfColS",f:JM},15:{n:"PtgElfColSV",f:QM},16:{n:"PtgElfRadicalLel",f:tF},25:{n:"PtgList",f:iF},29:{n:"PtgSxName",f:oF},255:{}},pF={0:{n:"PtgAttrNoop",f:fF},1:{n:"PtgAttrSemi",f:DM},2:{n:"PtgAttrIf",f:bM},4:{n:"PtgAttrChoose",f:gM},8:{n:"PtgAttrGoto",f:xM},16:{n:"PtgAttrSum",f:TM},32:{n:"PtgAttrBaxcel",f:wE},33:{n:"PtgAttrBaxcel",f:wE},64:{n:"PtgAttrSpace",f:SM},65:{n:"PtgAttrSpaceSemi",f:yM},128:{n:"PtgAttrIfError",f:NM},255:{}};function e0(t,n,e,s){if(s.biff<8)return ya(t,n);for(var i=t.l+n,d=[],c=0;c!==e.length;++c)switch(e[c][0]){case"PtgArray":e[c][1]=MM(t,0,s),d.push(e[c][1]);break;case"PtgMemArea":e[c][2]=IM(t,e[c][1],s),d.push(e[c][2]);break;case"PtgExp":s&&s.biff==12&&(e[c][1][1]=t.read_shift(4),d.push(e[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[c][0]}return n=i-t.l,n!==0&&d.push(ya(t,n)),d}function t0(t,n,e){for(var s=t.l+n,i,d,c=[];s!=t.l;)n=s-t.l,d=t[t.l],i=CE[d]||CE[mF[d]],(d===24||d===25)&&(i=(d===24?hF:pF)[t[t.l+1]]),!i||!i.f?ya(t,n):c.push([i.n,i.f(t,n,e)]);return c}function vF(t){for(var n=[],e=0;e<t.length;++e){for(var s=t[e],i=[],d=0;d<s.length;++d){var c=s[d];if(c)switch(c[0]){case 2:i.push('"'+c[1].replace(/"/g,'""')+'"');break;default:i.push(c[1])}else i.push("")}n.push(i.join(","))}return n.join(";")}var gF={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function xF(t,n){if(!t&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function IC(t,n,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[n]))return t.SheetNames[n];if(!t.XTI)return"SH33TJSERR6";var s=t.XTI[n];if(e.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":t.XTI[n-1];if(!s)return"SH33TJSERR1";var i="";if(e.biff>8)switch(t[s[0]][0]){case 357:return i=s[1]==-1?"#REF":t.SheetNames[s[1]],s[1]==s[2]?i:i+":"+t.SheetNames[s[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[s[0]][0];case 355:default:return"SH33TJSSRC"+t[s[0]][0]}switch(t[s[0]][0][0]){case 1025:return i=s[1]==-1?"#REF":t.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?i:i+":"+t.SheetNames[s[2]];case 14849:return t[s[0]].slice(1).map(function(d){return d.Name}).join(";;");default:return t[s[0]][0][3]?(i=s[1]==-1?"#REF":t[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?i:i+":"+t[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function kE(t,n,e){var s=IC(t,n,e);return s=="#REF"?s:xF(s,e)}function ba(t,n,e,s,i){var d=i&&i.biff||8,c={s:{c:0,r:0}},f=[],p,g,x,b=0,E=0,w,R="";if(!t[0]||!t[0][0])return"";for(var y=-1,U="",q=0,G=t[0].length;q<G;++q){var _=t[0][q];switch(_[0]){case"PtgUminus":f.push("-"+f.pop());break;case"PtgUplus":f.push("+"+f.pop());break;case"PtgPercent":f.push(f.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(p=f.pop(),g=f.pop(),y>=0){switch(t[0][y][1][0]){case 0:U=en(" ",t[0][y][1][1]);break;case 1:U=en("\r",t[0][y][1][1]);break;default:if(U="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}g=g+U,y=-1}f.push(g+gF[_[0]]+p);break;case"PtgIsect":p=f.pop(),g=f.pop(),f.push(g+" "+p);break;case"PtgUnion":p=f.pop(),g=f.pop(),f.push(g+","+p);break;case"PtgRange":p=f.pop(),g=f.pop(),f.push(g+":"+p);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=kf(_[1][1],c,i),f.push(Rf(x,d));break;case"PtgRefN":x=e?kf(_[1][1],e,i):_[1][1],f.push(Rf(x,d));break;case"PtgRef3d":b=_[1][1],x=kf(_[1][2],c,i),R=kE(s,b,i),f.push(R+"!"+Rf(x,d));break;case"PtgFunc":case"PtgFuncVar":var ne=_[1][0],ee=_[1][1];ne||(ne=0),ne&=127;var Q=ne==0?[]:f.slice(-ne);f.length-=ne,ee==="User"&&(ee=Q.shift()),f.push(ee+"("+Q.join(",")+")");break;case"PtgBool":f.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":f.push(_[1]);break;case"PtgNum":f.push(String(_[1]));break;case"PtgStr":f.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":f.push(_[1]);break;case"PtgAreaN":w=lE(_[1][1],e?{s:e}:c,i),f.push(Db(w,i));break;case"PtgArea":w=lE(_[1][1],c,i),f.push(Db(w,i));break;case"PtgArea3d":b=_[1][1],w=_[1][2],R=kE(s,b,i),f.push(R+"!"+Db(w,i));break;case"PtgAttrSum":f.push("SUM("+f.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":E=_[1][2];var z=(s.names||[])[E-1]||(s[0]||[])[E],ce=z?z.Name:"SH33TJSNAME"+String(E);ce&&ce.slice(0,6)=="_xlfn."&&!i.xlfn&&(ce=ce.slice(6)),f.push(ce);break;case"PtgNameX":var S=_[1][1];E=_[1][2];var A;if(i.biff<=5)S<0&&(S=-S),s[S]&&(A=s[S][E]);else{var W="";if(((s[S]||[])[0]||[])[0]==14849||(((s[S]||[])[0]||[])[0]==1025?s[S][E]&&s[S][E].itab>0&&(W=s.SheetNames[s[S][E].itab-1]+"!"):W=s.SheetNames[E-1]+"!"),s[S]&&s[S][E])W+=s[S][E].Name;else if(s[0]&&s[0][E])W+=s[0][E].Name;else{var H=(IC(s,S,i)||"").split(";;");H[E-1]?W=H[E-1]:W+="SH33TJSERRX"}f.push(W);break}A||(A={Name:"SH33TJSERRY"}),f.push(A.Name);break;case"PtgParen":var K="(",Oe=")";if(y>=0){switch(U="",t[0][y][1][0]){case 2:K=en(" ",t[0][y][1][1])+K;break;case 3:K=en("\r",t[0][y][1][1])+K;break;case 4:Oe=en(" ",t[0][y][1][1])+Oe;break;case 5:Oe=en("\r",t[0][y][1][1])+Oe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}y=-1}f.push(K+f.pop()+Oe);break;case"PtgRefErr":f.push("#REF!");break;case"PtgRefErr3d":f.push("#REF!");break;case"PtgExp":x={c:_[1][1],r:_[1][0]};var ye={c:e.c,r:e.r};if(s.sharedf[Jt(x)]){var Pe=s.sharedf[Jt(x)];f.push(ba(Pe,c,ye,s,i))}else{var ve=!1;for(p=0;p!=s.arrayf.length;++p)if(g=s.arrayf[p],!(x.c<g[0].s.c||x.c>g[0].e.c)&&!(x.r<g[0].s.r||x.r>g[0].e.r)){f.push(ba(g[1],c,ye,s,i)),ve=!0;break}ve||f.push(_[1])}break;case"PtgArray":f.push("{"+vF(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=q;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":f.push("");break;case"PtgAreaErr":f.push("#REF!");break;case"PtgAreaErr3d":f.push("#REF!");break;case"PtgList":f.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var Ge=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&y>=0&&Ge.indexOf(t[0][q][0])==-1){_=t[0][y];var ie=!0;switch(_[1][0]){case 4:ie=!1;case 0:U=en(" ",_[1][1]);break;case 5:ie=!1;case 1:U=en("\r",_[1][1]);break;default:if(U="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}f.push((ie?U:"")+f.pop()+(ie?"":U)),y=-1}}if(f.length>1&&i.WTF)throw new Error("bad formula stack");return f[0]}function bF(t,n,e){var s=t.l+n,i=e.biff==2?1:2,d,c=t.read_shift(i);if(c==65535)return[[],ya(t,n-2)];var f=t0(t,c,e);return n!==c+i&&(d=e0(t,n-c-i,f,e)),t.l=s,[f,d]}function NF(t,n,e){var s=t.l+n,i=e.biff==2?1:2,d,c=t.read_shift(i);if(c==65535)return[[],ya(t,n-2)];var f=t0(t,c,e);return n!==c+i&&(d=e0(t,n-c-i,f,e)),t.l=s,[f,d]}function DF(t,n,e,s){var i=t.l+n,d=t0(t,s,e),c;return i!==t.l&&(c=e0(t,i-t.l,d,e)),[d,c]}function SF(t,n,e){var s=t.l+n,i,d=t.read_shift(2),c=t0(t,d,e);return d==65535?[[],ya(t,n-2)]:(n!==d+2&&(i=e0(t,s-d-2,c,e)),[c,i])}function yF(t){var n;if(co(t,t.l+6)!==65535)return[Na(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return n=t[t.l+2]===1,t.l+=8,[n,"b"];case 2:return n=t[t.l+2],t.l+=8,[n,"e"];case 3:return t.l+=8,["","s"]}return[]}function Ob(t,n,e){var s=t.l+n,i=Ui(t);e.biff==2&&++t.l;var d=yF(t),c=t.read_shift(1);e.biff!=2&&(t.read_shift(1),e.biff>=5&&t.read_shift(4));var f=NF(t,s-t.l,e);return{cell:i,val:d[0],formula:f,shared:c>>3&1,tt:d[1]}}function qh(t,n,e){var s=t.read_shift(4),i=t0(t,s,e),d=t.read_shift(4),c=d>0?e0(t,d,i,e):null;return[i,c]}var OF=qh,Kh=qh,EF=qh,wF=qh,CF={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},MC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},kF={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function RE(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,e){return e.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Eb(t){var n=t.split(":"),e=n[0].split(".")[0];return[e,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var Uf={},Du={};function Af(t,n){if(t){var e=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function FC(t,n,e,s,i,d){try{s.cellNF&&(t.z=Zt[n])}catch(f){if(s.WTF)throw f}if(!(t.t==="z"&&!s.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Wn(t.v)),(!s||s.cellText!==!1)&&t.t!=="z")try{if(Zt[n]==null&&tc(RL[n]||"General",n),t.t==="e")t.w=t.w||dc[t.v];else if(n===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=If(t.v);else if(t.t==="d"){var c=Ia(t.v);(c|0)===c?t.w=c.toString(10):t.w=If(c)}else{if(t.v===void 0)return"";t.w=nc(t.v,Du)}else t.t==="d"?t.w=ks(n,Ia(t.v),Du):t.w=ks(n,t.v,Du)}catch(f){if(s.WTF)throw f}if(s.cellStyles&&e!=null)try{t.s=d.Fills[e],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Ih(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),s.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Ih(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),s.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(f){if(s.WTF&&d.Fills)throw f}}}function RF(t,n){var e=tn(n);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(t["!ref"]=gr(e))}var TF=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,_F=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,PF=/<(?:\w:)?hyperlink [^>]*>/mg,UF=/"(\w*:\w*)"/,AF=/<(?:\w:)?col\b[^>]*[\/]?>/g,LF=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,VF=/<(?:\w:)?pageMargins[^>]*\/>/g,$C=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,jF=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,IF=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function MF(t,n,e,s,i,d,c){if(!t)return t;s||(s={"!id":{}});var f=n.dense?[]:{},p={s:{r:2e6,c:2e6},e:{r:0,c:0}},g="",x="",b=t.match(_F);b?(g=t.slice(0,b.index),x=t.slice(b.index+b[0].length)):g=x=t;var E=g.match($C);E?wN(E[0],f,i,e):(E=g.match(jF))&&FF(E[0],E[1]||"",f,i,e);var w=(g.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(w>0){var R=g.slice(w,w+50).match(UF);R&&RF(f,R[1])}var y=g.match(IF);y&&y[1]&&XF(y[1],i);var U=[];if(n.cellStyles){var q=g.match(AF);q&&HF(U,q)}b&&GF(b[1],f,n,p,d,c);var G=x.match(LF);G&&(f["!autofilter"]=WF(G[0]));var _=[],ne=x.match(TF);if(ne)for(w=0;w!=ne.length;++w)_[w]=tn(ne[w].slice(ne[w].indexOf('"')+1));var ee=x.match(PF);ee&&$F(f,ee,s);var Q=x.match(VF);if(Q&&(f["!margins"]=BF(Wt(Q[0]))),!f["!ref"]&&p.e.c>=p.s.c&&p.e.r>=p.s.r&&(f["!ref"]=gr(p)),n.sheetRows>0&&f["!ref"]){var z=tn(f["!ref"]);n.sheetRows<=+z.e.r&&(z.e.r=n.sheetRows-1,z.e.r>p.e.r&&(z.e.r=p.e.r),z.e.r<z.s.r&&(z.s.r=z.e.r),z.e.c>p.e.c&&(z.e.c=p.e.c),z.e.c<z.s.c&&(z.s.c=z.e.c),f["!fullref"]=f["!ref"],f["!ref"]=gr(z))}return U.length>0&&(f["!cols"]=U),_.length>0&&(f["!merges"]=_),f}function wN(t,n,e,s){var i=Wt(t);e.Sheets[s]||(e.Sheets[s]={}),i.codeName&&(e.Sheets[s].CodeName=Sr(Mr(i.codeName)))}function FF(t,n,e,s,i){wN(t.slice(0,t.indexOf(">")),e,s,i)}function $F(t,n,e){for(var s=Array.isArray(t),i=0;i!=n.length;++i){var d=Wt(Mr(n[i]),!0);if(!d.ref)return;var c=((e||{})["!id"]||[])[d.id];c?(d.Target=c.Target,d.location&&(d.Target+="#"+Sr(d.location))):(d.Target="#"+Sr(d.location),c={Target:d.Target,TargetMode:"Internal"}),d.Rel=c,d.tooltip&&(d.Tooltip=d.tooltip,delete d.tooltip);for(var f=tn(d.ref),p=f.s.r;p<=f.e.r;++p)for(var g=f.s.c;g<=f.e.c;++g){var x=Jt({c:g,r:p});s?(t[p]||(t[p]=[]),t[p][g]||(t[p][g]={t:"z",v:void 0}),t[p][g].l=d):(t[x]||(t[x]={t:"z",v:void 0}),t[x].l=d)}}}function BF(t){var n={};return["left","right","top","bottom","header","footer"].forEach(function(e){t[e]&&(n[e]=parseFloat(t[e]))}),n}function HF(t,n){for(var e=!1,s=0;s!=n.length;++s){var i=Wt(n[s],!0);i.hidden&&(i.hidden=zr(i.hidden));var d=parseInt(i.min,10)-1,c=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!e&&i.width&&(e=!0,ON(i.width)),yu(i);d<=c;)t[d++]=la(i)}}function WF(t){var n={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return n}var zF=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function XF(t,n){n.Views||(n.Views=[{}]),(t.match(zF)||[]).forEach(function(e,s){var i=Wt(e);n.Views[s]||(n.Views[s]={}),+i.zoomScale&&(n.Views[s].zoom=+i.zoomScale),zr(i.rightToLeft)&&(n.Views[s].RTL=!0)})}var GF=(function(){var t=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,d=Mf("v"),c=Mf("f");return function(p,g,x,b,E,w){for(var R=0,y="",U=[],q=[],G=0,_=0,ne=0,ee="",Q,z,ce=0,S=0,A,W,H=0,K=0,Oe=Array.isArray(w.CellXf),ye,Pe=[],ve=[],Ge=Array.isArray(g),ie=[],Ee={},Ce=!1,j=!!x.sheetStubs,X=p.split(n),T=0,O=X.length;T!=O;++T){y=X[T].trim();var P=y.length;if(P!==0){var F=0;e:for(R=0;R<P;++R)switch(y[R]){case">":if(y[R-1]!="/"){++R;break e}if(x&&x.cellStyles){if(z=Wt(y.slice(F,R),!0),ce=z.r!=null?parseInt(z.r,10):ce+1,S=-1,x.sheetRows&&x.sheetRows<ce)continue;Ee={},Ce=!1,z.ht&&(Ce=!0,Ee.hpt=parseFloat(z.ht),Ee.hpx=Hf(Ee.hpt)),z.hidden=="1"&&(Ce=!0,Ee.hidden=!0),z.outlineLevel!=null&&(Ce=!0,Ee.level=+z.outlineLevel),Ce&&(ie[ce-1]=Ee)}break;case"<":F=R;break}if(F>=R)break;if(z=Wt(y.slice(F,R),!0),ce=z.r!=null?parseInt(z.r,10):ce+1,S=-1,!(x.sheetRows&&x.sheetRows<ce)){b.s.r>ce-1&&(b.s.r=ce-1),b.e.r<ce-1&&(b.e.r=ce-1),x&&x.cellStyles&&(Ee={},Ce=!1,z.ht&&(Ce=!0,Ee.hpt=parseFloat(z.ht),Ee.hpx=Hf(Ee.hpt)),z.hidden=="1"&&(Ce=!0,Ee.hidden=!0),z.outlineLevel!=null&&(Ce=!0,Ee.level=+z.outlineLevel),Ce&&(ie[ce-1]=Ee)),U=y.slice(R).split(t);for(var de=0;de!=U.length&&U[de].trim().charAt(0)=="<";++de);for(U=U.slice(de),R=0;R!=U.length;++R)if(y=U[R].trim(),y.length!==0){if(q=y.match(e),G=R,_=0,ne=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,q!=null&&q.length===2){for(G=0,ee=q[1],_=0;_!=ee.length&&!((ne=ee.charCodeAt(_)-64)<1||ne>26);++_)G=26*G+ne;--G,S=G}else++S;for(_=0;_!=y.length&&y.charCodeAt(_)!==62;++_);if(++_,z=Wt(y.slice(0,_),!0),z.r||(z.r=Jt({r:ce-1,c:S})),ee=y.slice(_),Q={t:""},(q=ee.match(d))!=null&&q[1]!==""&&(Q.v=Sr(q[1])),x.cellFormula){if((q=ee.match(c))!=null&&q[1]!==""){if(Q.f=Sr(Mr(q[1])).replace(/\r\n/g,`
`),x.xlfn||(Q.f=EE(Q.f)),q[0].indexOf('t="array"')>-1)Q.F=(ee.match(i)||[])[1],Q.F.indexOf(":")>-1&&Pe.push([tn(Q.F),Q.F]);else if(q[0].indexOf('t="shared"')>-1){W=Wt(q[0]);var fe=Sr(Mr(q[1]));x.xlfn||(fe=EE(fe)),ve[parseInt(W.si,10)]=[W,fe,z.r]}}else(q=ee.match(/<f[^>]*\/>/))&&(W=Wt(q[0]),ve[W.si]&&(Q.f=aM(ve[W.si][1],ve[W.si][2],z.r)));var ge=Va(z.r);for(_=0;_<Pe.length;++_)ge.r>=Pe[_][0].s.r&&ge.r<=Pe[_][0].e.r&&ge.c>=Pe[_][0].s.c&&ge.c<=Pe[_][0].e.c&&(Q.F=Pe[_][1])}if(z.t==null&&Q.v===void 0)if(Q.f||Q.F)Q.v=0,Q.t="n";else if(j)Q.t="z";else continue;else Q.t=z.t||"n";switch(b.s.c>S&&(b.s.c=S),b.e.c<S&&(b.e.c=S),Q.t){case"n":if(Q.v==""||Q.v==null){if(!j)continue;Q.t="z"}else Q.v=parseFloat(Q.v);break;case"s":if(typeof Q.v>"u"){if(!j)continue;Q.t="z"}else A=Uf[parseInt(Q.v,10)],Q.v=A.t,Q.r=A.r,x.cellHTML&&(Q.h=A.h);break;case"str":Q.t="s",Q.v=Q.v!=null?Mr(Q.v):"",x.cellHTML&&(Q.h=mN(Q.v));break;case"inlineStr":q=ee.match(s),Q.t="s",q!=null&&(A=yN(q[1]))?(Q.v=A.t,x.cellHTML&&(Q.h=A.h)):Q.v="";break;case"b":Q.v=zr(Q.v);break;case"d":x.cellDates?Q.v=Wn(Q.v,1):(Q.v=Ia(Wn(Q.v,1)),Q.t="n");break;case"e":(!x||x.cellText!==!1)&&(Q.w=Q.v),Q.v=lC[Q.v];break}if(H=K=0,ye=null,Oe&&z.s!==void 0&&(ye=w.CellXf[z.s],ye!=null&&(ye.numFmtId!=null&&(H=ye.numFmtId),x.cellStyles&&ye.fillId!=null&&(K=ye.fillId))),FC(Q,H,K,x,E,w),x.cellDates&&Oe&&Q.t=="n"&&Cu(Zt[H])&&(Q.t="d",Q.v=Gh(Q.v)),z.cm&&x.xlmeta){var ze=(x.xlmeta.Cell||[])[+z.cm-1];ze&&ze.type=="XLDAPR"&&(Q.D=!0)}if(Ge){var oe=Va(z.r);g[oe.r]||(g[oe.r]=[]),g[oe.r][oe.c]=Q}else g[z.r]=Q}}}}ie.length>0&&(g["!rows"]=ie)}})();function YF(t,n){var e={},s=t.l+n;e.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var d=t.read_shift(1);return t.l=s,d&7&&(e.level=d&7),d&16&&(e.hidden=!0),d&32&&(e.hpt=i/20),e}var qF=uc;function KF(){}function JF(t,n){var e={},s=t[t.l];return++t.l,e.above=!(s&64),e.left=!(s&128),t.l+=18,e.name=bV(t),e}function QF(t){var n=Rs(t);return[n]}function ZF(t){var n=cc(t);return[n]}function e8(t){var n=Rs(t),e=t.read_shift(1);return[n,e,"b"]}function t8(t){var n=cc(t),e=t.read_shift(1);return[n,e,"b"]}function r8(t){var n=Rs(t),e=t.read_shift(1);return[n,e,"e"]}function n8(t){var n=cc(t),e=t.read_shift(1);return[n,e,"e"]}function a8(t){var n=Rs(t),e=t.read_shift(4);return[n,e,"s"]}function s8(t){var n=cc(t),e=t.read_shift(4);return[n,e,"s"]}function i8(t){var n=Rs(t),e=Na(t);return[n,e,"n"]}function BC(t){var n=cc(t),e=Na(t);return[n,e,"n"]}function o8(t){var n=Rs(t),e=NN(t);return[n,e,"n"]}function l8(t){var n=cc(t),e=NN(t);return[n,e,"n"]}function c8(t){var n=Rs(t),e=xN(t);return[n,e,"is"]}function u8(t){var n=Rs(t),e=Sa(t);return[n,e,"str"]}function d8(t){var n=cc(t),e=Sa(t);return[n,e,"str"]}function f8(t,n,e){var s=t.l+n,i=Rs(t);i.r=e["!row"];var d=t.read_shift(1),c=[i,d,"b"];if(e.cellFormula){t.l+=2;var f=Kh(t,s-t.l,e);c[3]=ba(f,null,i,e.supbooks,e)}else t.l=s;return c}function m8(t,n,e){var s=t.l+n,i=Rs(t);i.r=e["!row"];var d=t.read_shift(1),c=[i,d,"e"];if(e.cellFormula){t.l+=2;var f=Kh(t,s-t.l,e);c[3]=ba(f,null,i,e.supbooks,e)}else t.l=s;return c}function h8(t,n,e){var s=t.l+n,i=Rs(t);i.r=e["!row"];var d=Na(t),c=[i,d,"n"];if(e.cellFormula){t.l+=2;var f=Kh(t,s-t.l,e);c[3]=ba(f,null,i,e.supbooks,e)}else t.l=s;return c}function p8(t,n,e){var s=t.l+n,i=Rs(t);i.r=e["!row"];var d=Sa(t),c=[i,d,"str"];if(e.cellFormula){t.l+=2;var f=Kh(t,s-t.l,e);c[3]=ba(f,null,i,e.supbooks,e)}else t.l=s;return c}var v8=uc;function g8(t,n){var e=t.l+n,s=uc(t),i=bN(t),d=Sa(t),c=Sa(t),f=Sa(t);t.l=e;var p={rfx:s,relId:i,loc:d,display:f};return c&&(p.Tooltip=c),p}function x8(){}function b8(t,n,e){var s=t.l+n,i=sC(t),d=t.read_shift(1),c=[i];if(c[2]=d,e.cellFormula){var f=OF(t,s-t.l,e);c[1]=f}else t.l=s;return c}function N8(t,n,e){var s=t.l+n,i=uc(t),d=[i];if(e.cellFormula){var c=wF(t,s-t.l,e);d[1]=c,t.l=s}else t.l=s;return d}var D8=["left","right","top","bottom","header","footer"];function S8(t){var n={};return D8.forEach(function(e){n[e]=Na(t)}),n}function y8(t){var n=t.read_shift(2);return t.l+=28,{RTL:n&32}}function O8(){}function E8(){}function w8(t,n,e,s,i,d,c){if(!t)return t;var f=n||{};s||(s={"!id":{}});var p=f.dense?[]:{},g,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=!1,E=!1,w,R,y,U,q,G,_,ne,ee,Q=[];f.biff=12,f["!row"]=0;var z=0,ce=!1,S=[],A={},W=f.supbooks||i.supbooks||[[]];if(W.sharedf=A,W.arrayf=S,W.SheetNames=i.SheetNames||i.Sheets.map(function(Ge){return Ge.name}),!f.supbooks&&(f.supbooks=W,i.Names))for(var H=0;H<i.Names.length;++H)W[0][H+1]=i.Names[H];var K=[],Oe=[],ye=!1;$h[16]={n:"BrtShortReal",f:BC};var Pe;if(go(t,function(ie,Ee,Ce){if(!E)switch(Ce){case 148:g=ie;break;case 0:w=ie,f.sheetRows&&f.sheetRows<=w.r&&(E=!0),ne=ca(U=w.r),f["!row"]=w.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=Hf(ie.hpt)),Oe[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(R={t:ie[2]},ie[2]){case"n":R.v=ie[1];break;case"s":_=Uf[ie[1]],R.v=_.t,R.r=_.r;break;case"b":R.v=!!ie[1];break;case"e":R.v=ie[1],f.cellText!==!1&&(R.w=dc[R.v]);break;case"str":R.t="s",R.v=ie[1];break;case"is":R.t="s",R.v=ie[1].t;break}if((y=c.CellXf[ie[0].iStyleRef])&&FC(R,y.numFmtId,null,f,d,c),q=ie[0].c==-1?q+1:ie[0].c,f.dense?(p[U]||(p[U]=[]),p[U][q]=R):p[Pn(q)+ne]=R,f.cellFormula){for(ce=!1,z=0;z<S.length;++z){var j=S[z];w.r>=j[0].s.r&&w.r<=j[0].e.r&&q>=j[0].s.c&&q<=j[0].e.c&&(R.F=gr(j[0]),ce=!0)}!ce&&ie.length>3&&(R.f=ie[3])}if(x.s.r>w.r&&(x.s.r=w.r),x.s.c>q&&(x.s.c=q),x.e.r<w.r&&(x.e.r=w.r),x.e.c<q&&(x.e.c=q),f.cellDates&&y&&R.t=="n"&&Cu(Zt[y.numFmtId])){var X=ec(R.v);X&&(R.t="d",R.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}Pe&&(Pe.type=="XLDAPR"&&(R.D=!0),Pe=void 0);break;case 1:case 12:if(!f.sheetStubs||b)break;R={t:"z",v:void 0},q=ie[0].c==-1?q+1:ie[0].c,f.dense?(p[U]||(p[U]=[]),p[U][q]=R):p[Pn(q)+ne]=R,x.s.r>w.r&&(x.s.r=w.r),x.s.c>q&&(x.s.c=q),x.e.r<w.r&&(x.e.r=w.r),x.e.c<q&&(x.e.c=q),Pe&&(Pe.type=="XLDAPR"&&(R.D=!0),Pe=void 0);break;case 176:Q.push(ie);break;case 49:Pe=((f.xlmeta||{}).Cell||[])[ie-1];break;case 494:var T=s["!id"][ie.relId];for(T?(ie.Target=T.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=T):ie.relId==""&&(ie.Target="#"+ie.loc),U=ie.rfx.s.r;U<=ie.rfx.e.r;++U)for(q=ie.rfx.s.c;q<=ie.rfx.e.c;++q)f.dense?(p[U]||(p[U]=[]),p[U][q]||(p[U][q]={t:"z",v:void 0}),p[U][q].l=ie):(G=Jt({c:q,r:U}),p[G]||(p[G]={t:"z",v:void 0}),p[G].l=ie);break;case 426:if(!f.cellFormula)break;S.push(ie),ee=f.dense?p[U][q]:p[Pn(q)+ne],ee.f=ba(ie[1],x,{r:w.r,c:q},W,f),ee.F=gr(ie[0]);break;case 427:if(!f.cellFormula)break;A[Jt(ie[0].s)]=ie[1],ee=f.dense?p[U][q]:p[Pn(q)+ne],ee.f=ba(ie[1],x,{r:w.r,c:q},W,f);break;case 60:if(!f.cellStyles)break;for(;ie.e>=ie.s;)K[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},ye||(ye=!0,ON(ie.w/256)),yu(K[ie.e+1]);break;case 161:p["!autofilter"]={ref:gr(ie)};break;case 476:p["!margins"]=ie;break;case 147:i.Sheets[e]||(i.Sheets[e]={}),ie.name&&(i.Sheets[e].CodeName=ie.name),(ie.above||ie.left)&&(p["!outline"]={above:ie.above,left:ie.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ie.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:b=!0;break;case 36:b=!1;break;case 37:b=!0;break;case 38:b=!1;break;default:if(!Ee.T){if(!b||f.WTF)throw new Error("Unexpected record 0x"+Ce.toString(16))}}},f),delete f.supbooks,delete f["!row"],!p["!ref"]&&(x.s.r<2e6||g&&(g.e.r>0||g.e.c>0||g.s.r>0||g.s.c>0))&&(p["!ref"]=gr(g||x)),f.sheetRows&&p["!ref"]){var ve=tn(p["!ref"]);f.sheetRows<=+ve.e.r&&(ve.e.r=f.sheetRows-1,ve.e.r>x.e.r&&(ve.e.r=x.e.r),ve.e.r<ve.s.r&&(ve.s.r=ve.e.r),ve.e.c>x.e.c&&(ve.e.c=x.e.c),ve.e.c<ve.s.c&&(ve.s.c=ve.e.c),p["!fullref"]=p["!ref"],p["!ref"]=gr(ve))}return Q.length>0&&(p["!merges"]=Q),K.length>0&&(p["!cols"]=K),Oe.length>0&&(p["!rows"]=Oe),p}function C8(t){var n=[],e=t.match(/^<c:numCache>/),s;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(d){var c=d.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(n[+c[1]]=e?+c[2]:c[2])});var i=Sr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(d){s=d.replace(/<.*?>/g,"")}),[n,i,s]}function k8(t,n,e,s,i,d){var c=d||{"!type":"chart"};if(!t)return d;var f=0,p=0,g="A",x={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(b){var E=C8(b);x.s.r=x.s.c=0,x.e.c=f,g=Pn(f),E[0].forEach(function(w,R){c[g+ca(R)]={t:"n",v:w,z:E[1]},p=R}),x.e.r<p&&(x.e.r=p),++f}),f>0&&(c["!ref"]=gr(x)),c}function R8(t,n,e,s,i){if(!t)return t;s||(s={"!id":{}});var d={"!type":"chart","!drawel":null,"!rel":""},c,f=t.match($C);return f&&wN(f[0],d,i,e),(c=t.match(/drawing r:id="(.*?)"/))&&(d["!rel"]=c[1]),s["!id"][d["!rel"]]&&(d["!drawel"]=s["!id"][d["!rel"]]),d}function T8(t,n){t.l+=10;var e=Sa(t);return{name:e}}function _8(t,n,e,s,i){if(!t)return t;s||(s={"!id":{}});var d={"!type":"chart","!drawel":null,"!rel":""},c=!1;return go(t,function(p,g,x){switch(x){case 550:d["!rel"]=p;break;case 651:i.Sheets[e]||(i.Sheets[e]={}),p.name&&(i.Sheets[e].CodeName=p.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(g.T>0)){if(!(g.T<0)){if(!c||n.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}},n),s["!id"][d["!rel"]]&&(d["!drawel"]=s["!id"][d["!rel"]]),d}var HC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],P8=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],U8=[],A8=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function TE(t,n){for(var e=0;e!=t.length;++e)for(var s=t[e],i=0;i!=n.length;++i){var d=n[i];if(s[d[0]]==null)s[d[0]]=d[1];else switch(d[2]){case"bool":typeof s[d[0]]=="string"&&(s[d[0]]=zr(s[d[0]]));break;case"int":typeof s[d[0]]=="string"&&(s[d[0]]=parseInt(s[d[0]],10));break}}}function _E(t,n){for(var e=0;e!=n.length;++e){var s=n[e];if(t[s[0]]==null)t[s[0]]=s[1];else switch(s[2]){case"bool":typeof t[s[0]]=="string"&&(t[s[0]]=zr(t[s[0]]));break;case"int":typeof t[s[0]]=="string"&&(t[s[0]]=parseInt(t[s[0]],10));break}}}function WC(t){_E(t.WBProps,HC),_E(t.CalcPr,A8),TE(t.WBView,P8),TE(t.Sheets,U8),Du.date1904=zr(t.WBProps.date1904)}var L8="][*?/\\".split("");function V8(t,n){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return L8.forEach(function(s){if(t.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}var j8=/<\w+:workbook/;function I8(t,n){if(!t)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,i="xmlns",d={},c=0;if(t.replace(Ea,function(p,g){var x=Wt(p);switch(Pi(x[0])){case"<?xml":break;case"<workbook":p.match(j8)&&(i="xmlns"+p.match(/<(\w+):/)[1]),e.xmlns=x[i];break;case"</workbook>":break;case"<fileVersion":delete x[0],e.AppVersion=x;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":HC.forEach(function(b){if(x[b[0]]!=null)switch(b[2]){case"bool":e.WBProps[b[0]]=zr(x[b[0]]);break;case"int":e.WBProps[b[0]]=parseInt(x[b[0]],10);break;default:e.WBProps[b[0]]=x[b[0]]}}),x.codeName&&(e.WBProps.CodeName=Mr(x.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete x[0],e.WBView.push(x);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(x.state){case"hidden":x.Hidden=1;break;case"veryHidden":x.Hidden=2;break;default:x.Hidden=0}delete x.state,x.name=Sr(Mr(x.name)),delete x[0],e.Sheets.push(x);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":d={},d.Name=Mr(x.name),x.comment&&(d.Comment=x.comment),x.localSheetId&&(d.Sheet=+x.localSheetId),zr(x.hidden||"0")&&(d.Hidden=!0),c=g+p.length;break;case"</definedName>":d.Ref=Sr(Mr(t.slice(c,g))),e.Names.push(d);break;case"<definedName/>":break;case"<calcPr":delete x[0],e.CalcPr=x;break;case"<calcPr/>":delete x[0],e.CalcPr=x;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&n.WTF)throw new Error("unrecognized "+x[0]+" in workbook")}return p}),rV.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return WC(e),e}function M8(t,n){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=Fb(t),e.name=Sa(t),e}function F8(t,n){var e={},s=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var i=n>8?Sa(t):"";return i.length>0&&(e.CodeName=i),e.autoCompressPictures=!!(s&65536),e.backupFile=!!(s&64),e.checkCompatibility=!!(s&4096),e.date1904=!!(s&1),e.filterPrivacy=!!(s&8),e.hidePivotFieldList=!!(s&1024),e.promptedSolutions=!!(s&16),e.publishItems=!!(s&2048),e.refreshAllConnections=!!(s&262144),e.saveExternalLinkValues=!!(s&128),e.showBorderUnselectedTables=!!(s&4),e.showInkAnnotation=!!(s&32),e.showObjects=["all","placeholders","none"][s>>13&3],e.showPivotChartFilter=!!(s&32768),e.updateLinks=["userSet","never","always"][s>>8&3],e}function $8(t,n){var e={};return t.read_shift(4),e.ArchID=t.read_shift(4),t.l+=n-8,e}function B8(t,n,e){var s=t.l+n;t.l+=4,t.l+=1;var i=t.read_shift(4),d=NV(t),c=EF(t,0,e),f=bN(t);t.l=s;var p={Name:d,Ptg:c};return i<268435455&&(p.Sheet=i),f&&(p.Comment=f),p}function H8(t,n){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],i=!1;n||(n={}),n.biff=12;var d=[],c=[[]];return c.SheetNames=[],c.XTI=[],$h[16]={n:"BrtFRTArchID$",f:$8},go(t,function(p,g,x){switch(x){case 156:c.SheetNames.push(p.name),e.Sheets.push(p);break;case 153:e.WBProps=p;break;case 39:p.Sheet!=null&&(n.SID=p.Sheet),p.Ref=ba(p.Ptg,null,null,c,n),delete n.SID,delete p.Ptg,d.push(p);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([x,p]):c[0]=[x,p],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(p),c.XTI=c.XTI.concat(p);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(x),i=!0;break;case 36:s.pop(),i=!1;break;case 37:s.push(x),i=!0;break;case 38:s.pop(),i=!1;break;case 16:break;default:if(!g.T){if(!i||n.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}},n),WC(e),e.Names=d,e.supbooks=c,e}function W8(t,n,e){return n.slice(-4)===".bin"?H8(t,e):I8(t,e)}function z8(t,n,e,s,i,d,c,f){return n.slice(-4)===".bin"?w8(t,s,e,i,d,c,f):MF(t,s,e,i,d,c,f)}function X8(t,n,e,s,i,d,c,f){return n.slice(-4)===".bin"?_8(t,s,e,i,d):R8(t,s,e,i,d)}function G8(t,n,e,s,i,d,c,f){return n.slice(-4)===".bin"?tM():rM()}function Y8(t,n,e,s,i,d,c,f){return n.slice(-4)===".bin"?ZI():eM()}function q8(t,n,e,s){return n.slice(-4)===".bin"?vI(t,e,s):uI(t,e,s)}function K8(t,n,e){return TC(t,e)}function J8(t,n,e){return n.slice(-4)===".bin"?Pj(t,e):Tj(t,e)}function Q8(t,n,e){return n.slice(-4)===".bin"?KI(t,e):zI(t,e)}function Z8(t,n,e){return n.slice(-4)===".bin"?BI(t):FI(t)}function e7(t,n,e,s){return e.slice(-4)===".bin"?HI(t,n,e,s):void 0}function t7(t,n,e){return n.slice(-4)===".bin"?II(t,n,e):MI(t,n,e)}var zC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,XC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Qs(t,n){var e=t.split(/\s+/),s=[];if(s[0]=e[0],e.length===1)return s;var i=t.match(zC),d,c,f,p;if(i)for(p=0;p!=i.length;++p)d=i[p].match(XC),(c=d[1].indexOf(":"))===-1?s[d[1]]=d[2].slice(1,d[2].length-1):(d[1].slice(0,6)==="xmlns:"?f="xmlns"+d[1].slice(6):f=d[1].slice(c+1),s[f]=d[2].slice(1,d[2].length-1));return s}function r7(t){var n=t.split(/\s+/),e={};if(n.length===1)return e;var s=t.match(zC),i,d,c,f;if(s)for(f=0;f!=s.length;++f)i=s[f].match(XC),(d=i[1].indexOf(":"))===-1?e[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(d+1),e[c]=i[2].slice(1,i[2].length-1));return e}var Lf;function n7(t,n){var e=Lf[t]||Sr(t);return e==="General"?nc(n):ks(e,n)}function a7(t,n,e,s){var i=s;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=zr(s);break;case"i2":case"int":i=parseInt(s,10);break;case"r4":case"float":i=parseFloat(s);break;case"date":case"dateTime.tz":i=Wn(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}t[Sr(n)]=i}function s7(t,n,e){if(t.t!=="z"){if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||dc[t.v]:n==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=If(t.v):t.w=nc(t.v):t.w=n7(n||"General",t.v)}catch(d){if(e.WTF)throw d}try{var s=Lf[n]||n||"General";if(e.cellNF&&(t.z=s),e.cellDates&&t.t=="n"&&Cu(s)){var i=ec(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(d){if(e.WTF)throw d}}}function i7(t,n,e){if(e.cellStyles&&n.Interior){var s=n.Interior;s.Pattern&&(s.patternType=aI[s.Pattern]||s.Pattern)}t[n.ID]=n}function o7(t,n,e,s,i,d,c,f,p,g){var x="General",b=s.StyleID,E={};g=g||{};var w=[],R=0;for(b===void 0&&f&&(b=f.StyleID),b===void 0&&c&&(b=c.StyleID);d[b]!==void 0&&(d[b].nf&&(x=d[b].nf),d[b].Interior&&w.push(d[b].Interior),!!d[b].Parent);)b=d[b].Parent;switch(e.Type){case"Boolean":s.t="b",s.v=zr(t);break;case"String":s.t="s",s.r=ZO(Sr(t)),s.v=t.indexOf("<")>-1?Sr(n||t).replace(/<.*?>/g,""):s.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),s.v=(Wn(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),s.v!==s.v?s.v=Sr(t):s.v<60&&(s.v=s.v-1),(!x||x=="General")&&(x="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+t),s.t||(s.t="n");break;case"Error":s.t="e",s.v=lC[t],g.cellText!==!1&&(s.w=t);break;default:t==""&&n==""?s.t="z":(s.t="s",s.v=ZO(n||t));break}if(s7(s,x,g),g.cellFormula!==!1)if(s.Formula){var y=Sr(s.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),s.f=Nu(y,i),delete s.Formula,s.ArrayRange=="RC"?s.F=Nu("RC:RC",i):s.ArrayRange&&(s.F=Nu(s.ArrayRange,i),p.push([tn(s.F),s.F]))}else for(R=0;R<p.length;++R)i.r>=p[R][0].s.r&&i.r<=p[R][0].e.r&&i.c>=p[R][0].s.c&&i.c<=p[R][0].e.c&&(s.F=p[R][1]);g.cellStyles&&(w.forEach(function(U){!E.patternType&&U.patternType&&(E.patternType=U.patternType)}),s.s=E),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function l7(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function wb(t,n){var e=n||{};Aw();var s=yf(hN(t));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(s=Mr(s));var i=s.slice(0,1024).toLowerCase(),d=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var c=la(e);return c.type="string",$f.to_workbook(s,c)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(er){i.indexOf("<"+er)>=0&&(d=!0)}),d)return g7(s,e);Lf={"General Number":"General","General Date":Zt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Zt[15],"Short Date":Zt[14],"Long Time":Zt[19],"Medium Time":Zt[18],"Short Time":Zt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Zt[2],Standard:Zt[4],Percent:Zt[10],Scientific:Zt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var f,p=[],g,x={},b=[],E=e.dense?[]:{},w="",R={},y={},U=Qs('<Data ss:Type="String">'),q=0,G=0,_=0,ne={s:{r:2e6,c:2e6},e:{r:0,c:0}},ee={},Q={},z="",ce=0,S=[],A={},W={},H=0,K=[],Oe=[],ye={},Pe=[],ve,Ge=!1,ie=[],Ee=[],Ce={},j=0,X=0,T={Sheets:[],WBProps:{date1904:!1}},O={};Ff.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var P="";f=Ff.exec(s);)switch(f[3]=(P=f[3]).toLowerCase()){case"data":if(P=="data"){if(f[1]==="/"){if((g=p.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&p.push([f[3],!0]);break}if(p[p.length-1][1])break;f[1]==="/"?o7(s.slice(q,f.index),z,U,p[p.length-1][0]=="comment"?ye:R,{c:G,r:_},ee,Pe[G],y,ie,e):(z="",U=Qs(f[0]),q=f.index+f[0].length);break;case"cell":if(f[1]==="/")if(Oe.length>0&&(R.c=Oe),(!e.sheetRows||e.sheetRows>_)&&R.v!==void 0&&(e.dense?(E[_]||(E[_]=[]),E[_][G]=R):E[Pn(G)+ca(_)]=R),R.HRef&&(R.l={Target:Sr(R.HRef)},R.HRefScreenTip&&(R.l.Tooltip=R.HRefScreenTip),delete R.HRef,delete R.HRefScreenTip),(R.MergeAcross||R.MergeDown)&&(j=G+(parseInt(R.MergeAcross,10)|0),X=_+(parseInt(R.MergeDown,10)|0),S.push({s:{c:G,r:_},e:{c:j,r:X}})),!e.sheetStubs)R.MergeAcross?G=j+1:++G;else if(R.MergeAcross||R.MergeDown){for(var F=G;F<=j;++F)for(var de=_;de<=X;++de)(F>G||de>_)&&(e.dense?(E[de]||(E[de]=[]),E[de][F]={t:"z"}):E[Pn(F)+ca(de)]={t:"z"});G=j+1}else++G;else R=r7(f[0]),R.Index&&(G=+R.Index-1),G<ne.s.c&&(ne.s.c=G),G>ne.e.c&&(ne.e.c=G),f[0].slice(-2)==="/>"&&++G,Oe=[];break;case"row":f[1]==="/"||f[0].slice(-2)==="/>"?(_<ne.s.r&&(ne.s.r=_),_>ne.e.r&&(ne.e.r=_),f[0].slice(-2)==="/>"&&(y=Qs(f[0]),y.Index&&(_=+y.Index-1)),G=0,++_):(y=Qs(f[0]),y.Index&&(_=+y.Index-1),Ce={},(y.AutoFitHeight=="0"||y.Height)&&(Ce.hpx=parseInt(y.Height,10),Ce.hpt=RC(Ce.hpx),Ee[_]=Ce),y.Hidden=="1"&&(Ce.hidden=!0,Ee[_]=Ce));break;case"worksheet":if(f[1]==="/"){if((g=p.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"));b.push(w),ne.s.r<=ne.e.r&&ne.s.c<=ne.e.c&&(E["!ref"]=gr(ne),e.sheetRows&&e.sheetRows<=ne.e.r&&(E["!fullref"]=E["!ref"],ne.e.r=e.sheetRows-1,E["!ref"]=gr(ne))),S.length&&(E["!merges"]=S),Pe.length>0&&(E["!cols"]=Pe),Ee.length>0&&(E["!rows"]=Ee),x[w]=E}else ne={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=G=0,p.push([f[3],!1]),g=Qs(f[0]),w=Sr(g.Name),E=e.dense?[]:{},S=[],ie=[],Ee=[],O={name:w,Hidden:0},T.Sheets.push(O);break;case"table":if(f[1]==="/"){if((g=p.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"))}else{if(f[0].slice(-2)=="/>")break;p.push([f[3],!1]),Pe=[],Ge=!1}break;case"style":f[1]==="/"?i7(ee,Q,e):Q=Qs(f[0]);break;case"numberformat":Q.nf=Sr(Qs(f[0]).Format||"General"),Lf[Q.nf]&&(Q.nf=Lf[Q.nf]);for(var fe=0;fe!=392&&Zt[fe]!=Q.nf;++fe);if(fe==392){for(fe=57;fe!=392;++fe)if(Zt[fe]==null){tc(Q.nf,fe);break}}break;case"column":if(p[p.length-1][0]!=="table")break;if(ve=Qs(f[0]),ve.Hidden&&(ve.hidden=!0,delete ve.Hidden),ve.Width&&(ve.wpx=parseInt(ve.Width,10)),!Ge&&ve.wpx>10){Ge=!0,La=CC;for(var ge=0;ge<Pe.length;++ge)Pe[ge]&&yu(Pe[ge])}Ge&&yu(ve),Pe[ve.Index-1||Pe.length]=ve;for(var ze=0;ze<+ve.Span;++ze)Pe[Pe.length]=la(ve);break;case"namedrange":if(f[1]==="/")break;T.Names||(T.Names=[]);var oe=Wt(f[0]),Tt={Name:oe.Name,Ref:Nu(oe.RefersTo.slice(1),{r:0,c:0})};T.Sheets.length>0&&(Tt.Sheet=T.Sheets.length-1),T.Names.push(Tt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(f[0].slice(-2)==="/>")break;f[1]==="/"?z+=s.slice(ce,f.index):ce=f.index+f[0].length;break;case"interior":if(!e.cellStyles)break;Q.Interior=Qs(f[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(f[0].slice(-2)==="/>")break;f[1]==="/"?zV(A,P,s.slice(H,f.index)):H=f.index+f[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(f[1]==="/"){if((g=p.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"))}else p.push([f[3],!1]);break;case"comment":if(f[1]==="/"){if((g=p.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"));l7(ye),Oe.push(ye)}else p.push([f[3],!1]),g=Qs(f[0]),ye={a:g.Author};break;case"autofilter":if(f[1]==="/"){if((g=p.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"))}else if(f[0].charAt(f[0].length-2)!=="/"){var ft=Qs(f[0]);E["!autofilter"]={ref:Nu(ft.Range).replace(/\$/g,"")},p.push([f[3],!0])}break;case"name":break;case"datavalidation":if(f[1]==="/"){if((g=p.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&p.push([f[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(f[1]==="/"){if((g=p.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&p.push([f[3],!0]);break;case"null":break;default:if(p.length==0&&f[3]=="document"||p.length==0&&f[3]=="uof")return jE(s,e);var xt=!0;switch(p[p.length-1][0]){case"officedocumentsettings":switch(f[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:xt=!1}break;case"componentoptions":switch(f[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:xt=!1}break;case"excelworkbook":switch(f[3]){case"date1904":T.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:xt=!1}break;case"workbookoptions":switch(f[3]){case"owcversion":break;case"height":break;case"width":break;default:xt=!1}break;case"worksheetoptions":switch(f[3]){case"visible":if(f[0].slice(-2)!=="/>")if(f[1]==="/")switch(s.slice(H,f.index)){case"SheetHidden":O.Hidden=1;break;case"SheetVeryHidden":O.Hidden=2;break}else H=f.index+f[0].length;break;case"header":E["!margins"]||Af(E["!margins"]={},"xlml"),isNaN(+Wt(f[0]).Margin)||(E["!margins"].header=+Wt(f[0]).Margin);break;case"footer":E["!margins"]||Af(E["!margins"]={},"xlml"),isNaN(+Wt(f[0]).Margin)||(E["!margins"].footer=+Wt(f[0]).Margin);break;case"pagemargins":var Dt=Wt(f[0]);E["!margins"]||Af(E["!margins"]={},"xlml"),isNaN(+Dt.Top)||(E["!margins"].top=+Dt.Top),isNaN(+Dt.Left)||(E["!margins"].left=+Dt.Left),isNaN(+Dt.Right)||(E["!margins"].right=+Dt.Right),isNaN(+Dt.Bottom)||(E["!margins"].bottom=+Dt.Bottom);break;case"displayrighttoleft":T.Views||(T.Views=[]),T.Views[0]||(T.Views[0]={}),T.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":E["!outline"]||(E["!outline"]={}),E["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":E["!outline"]||(E["!outline"]={}),E["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:xt=!1}break;case"pivottable":case"pivotcache":switch(f[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:xt=!1}break;case"pagebreaks":switch(f[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:xt=!1}break;case"autofilter":switch(f[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:xt=!1}break;case"querytable":switch(f[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:xt=!1}break;case"datavalidation":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:xt=!1}break;case"sorting":case"conditionalformatting":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:xt=!1}break;case"mapinfo":case"schema":case"data":switch(f[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:xt=!1}break;case"smarttags":break;default:xt=!1;break}if(xt||f[3].match(/!\[CDATA/))break;if(!p[p.length-1][1])throw"Unrecognized tag: "+f[3]+"|"+p.join("|");if(p[p.length-1][0]==="customdocumentproperties"){if(f[0].slice(-2)==="/>")break;f[1]==="/"?a7(W,P,K,s.slice(H,f.index)):(K=f,H=f.index+f[0].length);break}if(e.WTF)throw"Unrecognized tag: "+f[3]+"|"+p.join("|")}var Ke={};return!e.bookSheets&&!e.bookProps&&(Ke.Sheets=x),Ke.SheetNames=b,Ke.Workbook=T,Ke.SSF=la(Zt),Ke.Props=A,Ke.Custprops=W,Ke}function Wb(t,n){switch(RN(n=n||{}),n.type||"base64"){case"base64":return wb(ds(t),n);case"binary":case"buffer":case"file":return wb(t,n);case"array":return wb(lc(t),n)}}function c7(t){var n={},e=t.content;if(e.l=28,n.AnsiUserType=e.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=yV(e),e.length-e.l<=4)return n;var s=e.read_shift(4);if(s==0||s>40||(e.l-=4,n.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(s=e.read_shift(4),s!==1907505652)||(n.UnicodeClipboardFormat=OV(e),s=e.read_shift(4),s==0||s>40))return n;e.l-=4,n.Reserved2=e.read_shift(0,"lpwstr")}var u7=[60,1084,2066,2165,2175];function d7(t,n,e,s,i){var d=s,c=[],f=e.slice(e.l,e.l+d);if(i&&i.enc&&i.enc.insitu&&f.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(f)}c.push(f),e.l+=d;for(var p=co(e,e.l),g=zb[p],x=0;g!=null&&u7.indexOf(p)>-1;)d=co(e,e.l+2),x=e.l+4,p==2066?x+=4:(p==2165||p==2175)&&(x+=12),f=e.slice(x,e.l+4+d),c.push(f),e.l+=4+d,g=zb[p=co(e,e.l)];var b=sl(c);oa(b,0);var E=0;b.lens=[];for(var w=0;w<c.length;++w)b.lens.push(E),E+=c[w].length;if(b.length<s)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+b.length+" < "+s;return n.f(b,b.length,i)}function wi(t,n,e){if(t.t!=="z"&&t.XF){var s=0;try{s=t.z||t.XF.numFmtId||0,n.cellNF&&(t.z=Zt[s])}catch(d){if(n.WTF)throw d}if(!n||n.cellText!==!1)try{t.t==="e"?t.w=t.w||dc[t.v]:s===0||s=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=If(t.v):t.w=nc(t.v):t.w=ks(s,t.v,{date1904:!!e,dateNF:n&&n.dateNF})}catch(d){if(n.WTF)throw d}if(n.cellDates&&s&&t.t=="n"&&Cu(Zt[s]||String(s))){var i=ec(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Dh(t,n,e){return{v:t,ixfe:n,t:e}}function f7(t,n){var e={opts:{}},s={},i=n.dense?[]:{},d={},c={},f=null,p=[],g="",x={},b,E="",w,R,y,U,q={},G=[],_,ne,ee=[],Q=[],z={Sheets:[],WBProps:{date1904:!1},Views:[{}]},ce={},S=function($e){return $e<8?rc[$e]:$e<64&&Q[$e-8]||rc[$e]},A=function($e,tt,Ct){var Nt=tt.XF.data;if(!(!Nt||!Nt.patternType||!Ct||!Ct.cellStyles)){tt.s={},tt.s.patternType=Nt.patternType;var Ot;(Ot=Bf(S(Nt.icvFore)))&&(tt.s.fgColor={rgb:Ot}),(Ot=Bf(S(Nt.icvBack)))&&(tt.s.bgColor={rgb:Ot})}},W=function($e,tt,Ct){if(!(Ce>1)&&!(Ct.sheetRows&&$e.r>=Ct.sheetRows)){if(Ct.cellStyles&&tt.XF&&tt.XF.data&&A($e,tt,Ct),delete tt.ixfe,delete tt.XF,b=$e,E=Jt($e),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),$e.r<c.s.r&&(c.s.r=$e.r),$e.c<c.s.c&&(c.s.c=$e.c),$e.r+1>c.e.r&&(c.e.r=$e.r+1),$e.c+1>c.e.c&&(c.e.c=$e.c+1),Ct.cellFormula&&tt.f){for(var Nt=0;Nt<G.length;++Nt)if(!(G[Nt][0].s.c>$e.c||G[Nt][0].s.r>$e.r)&&!(G[Nt][0].e.c<$e.c||G[Nt][0].e.r<$e.r)){tt.F=gr(G[Nt][0]),(G[Nt][0].s.c!=$e.c||G[Nt][0].s.r!=$e.r)&&delete tt.f,tt.f&&(tt.f=""+ba(G[Nt][1],c,$e,ie,H));break}}Ct.dense?(i[$e.r]||(i[$e.r]=[]),i[$e.r][$e.c]=tt):i[E]=tt}},H={enc:!1,sbcch:0,snames:[],sharedf:q,arrayf:G,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(H.password=n.password);var K,Oe=[],ye=[],Pe=[],ve=[],Ge=!1,ie=[];ie.SheetNames=H.snames,ie.sharedf=H.sharedf,ie.arrayf=H.arrayf,ie.names=[],ie.XTI=[];var Ee=0,Ce=0,j=0,X=[],T=[],O;H.codepage=1200,ri(1200);for(var P=!1;t.l<t.length-1;){var F=t.l,de=t.read_shift(2);if(de===0&&Ee===10)break;var fe=t.l===t.length?0:t.read_shift(2),ge=zb[de];if(ge&&ge.f){if(n.bookSheets&&Ee===133&&de!==133)break;if(Ee=de,ge.r===2||ge.r==12){var ze=t.read_shift(2);if(fe-=2,!H.enc&&ze!==de&&((ze&255)<<8|ze>>8)!==de)throw new Error("rt mismatch: "+ze+"!="+de);ge.r==12&&(t.l+=10,fe-=10)}var oe={};if(de===10?oe=ge.f(t,fe,H):oe=d7(de,ge,t,fe,H),Ce==0&&[9,521,1033,2057].indexOf(Ee)===-1)continue;switch(de){case 34:e.opts.Date1904=z.WBProps.date1904=oe;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(H.enc||(t.l=0),H.enc=oe,!n.password)throw new Error("File is password-protected");if(oe.valid==null)throw new Error("Encryption scheme unsupported");if(!oe.valid)throw new Error("Password is incorrect");break;case 92:H.lastuser=oe;break;case 66:var Tt=Number(oe);switch(Tt){case 21010:Tt=1200;break;case 32768:Tt=1e4;break;case 32769:Tt=1252;break}ri(H.codepage=Tt),P=!0;break;case 317:H.rrtabid=oe;break;case 25:H.winlocked=oe;break;case 439:e.opts.RefreshAll=oe;break;case 12:e.opts.CalcCount=oe;break;case 16:e.opts.CalcDelta=oe;break;case 17:e.opts.CalcIter=oe;break;case 13:e.opts.CalcMode=oe;break;case 14:e.opts.CalcPrecision=oe;break;case 95:e.opts.CalcSaveRecalc=oe;break;case 15:H.CalcRefMode=oe;break;case 2211:e.opts.FullCalc=oe;break;case 129:oe.fDialog&&(i["!type"]="dialog"),oe.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),oe.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:ee.push(oe);break;case 430:ie.push([oe]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(oe);break;case 24:case 536:O={Name:oe.Name,Ref:ba(oe.rgce,c,null,ie,H)},oe.itab>0&&(O.Sheet=oe.itab-1),ie.names.push(O),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(oe),oe.Name=="_xlnm._FilterDatabase"&&oe.itab>0&&oe.rgce&&oe.rgce[0]&&oe.rgce[0][0]&&oe.rgce[0][0][0]=="PtgArea3d"&&(T[oe.itab-1]={ref:gr(oe.rgce[0][0][1][2])});break;case 22:H.ExternCount=oe;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(oe),ie.XTI=ie.XTI.concat(oe);break;case 2196:if(H.biff<8)break;O!=null&&(O.Comment=oe[1]);break;case 18:i["!protect"]=oe;break;case 19:oe!==0&&H.WTF&&console.error("Password verifier: "+oe);break;case 133:d[oe.pos]=oe,H.snames.push(oe.name);break;case 10:{if(--Ce)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,i["!ref"]=gr(c),n.sheetRows&&n.sheetRows<=c.e.r){var ft=c.e.r;c.e.r=n.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=gr(c),c.e.r=ft}c.e.r++,c.e.c++}Oe.length>0&&(i["!merges"]=Oe),ye.length>0&&(i["!objects"]=ye),Pe.length>0&&(i["!cols"]=Pe),ve.length>0&&(i["!rows"]=ve),z.Sheets.push(ce)}g===""?x=i:s[g]=i,i=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(H.biff===8&&(H.biff={9:2,521:3,1033:4}[de]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[oe.BIFFVer]||8),H.biffguess=oe.BIFFVer==0,oe.BIFFVer==0&&oe.dt==4096&&(H.biff=5,P=!0,ri(H.codepage=28591)),H.biff==8&&oe.BIFFVer==0&&oe.dt==16&&(H.biff=2),Ce++)break;if(i=n.dense?[]:{},H.biff<8&&!P&&(P=!0,ri(H.codepage=n.codepage||1252)),H.biff<5||oe.BIFFVer==0&&oe.dt==4096){g===""&&(g="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var xt={pos:t.l-fe,name:g};d[xt.pos]=xt,H.snames.push(g)}else g=(d[F]||{name:""}).name;oe.dt==32&&(i["!type"]="chart"),oe.dt==64&&(i["!type"]="macro"),Oe=[],ye=[],H.arrayf=G=[],Pe=[],ve=[],Ge=!1,ce={Hidden:(d[F]||{hs:0}).hs,name:g}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(n.dense?(i[oe.r]||[])[oe.c]:i[Jt({c:oe.c,r:oe.r})])&&++oe.c,_={ixfe:oe.ixfe,XF:ee[oe.ixfe]||{},v:oe.val,t:"n"},j>0&&(_.z=X[_.ixfe>>8&63]),wi(_,n,e.opts.Date1904),W({c:oe.c,r:oe.r},_,n);break;case 5:case 517:_={ixfe:oe.ixfe,XF:ee[oe.ixfe],v:oe.val,t:oe.t},j>0&&(_.z=X[_.ixfe>>8&63]),wi(_,n,e.opts.Date1904),W({c:oe.c,r:oe.r},_,n);break;case 638:_={ixfe:oe.ixfe,XF:ee[oe.ixfe],v:oe.rknum,t:"n"},j>0&&(_.z=X[_.ixfe>>8&63]),wi(_,n,e.opts.Date1904),W({c:oe.c,r:oe.r},_,n);break;case 189:for(var Dt=oe.c;Dt<=oe.C;++Dt){var Ke=oe.rkrec[Dt-oe.c][0];_={ixfe:Ke,XF:ee[Ke],v:oe.rkrec[Dt-oe.c][1],t:"n"},j>0&&(_.z=X[_.ixfe>>8&63]),wi(_,n,e.opts.Date1904),W({c:Dt,r:oe.r},_,n)}break;case 6:case 518:case 1030:{if(oe.val=="String"){f=oe;break}if(_=Dh(oe.val,oe.cell.ixfe,oe.tt),_.XF=ee[_.ixfe],n.cellFormula){var er=oe.formula;if(er&&er[0]&&er[0][0]&&er[0][0][0]=="PtgExp"){var wr=er[0][0][1][0],ur=er[0][0][1][1],ar=Jt({r:wr,c:ur});q[ar]?_.f=""+ba(oe.formula,c,oe.cell,ie,H):_.F=((n.dense?(i[wr]||[])[ur]:i[ar])||{}).F}else _.f=""+ba(oe.formula,c,oe.cell,ie,H)}j>0&&(_.z=X[_.ixfe>>8&63]),wi(_,n,e.opts.Date1904),W(oe.cell,_,n),f=oe}break;case 7:case 519:if(f)f.val=oe,_=Dh(oe,f.cell.ixfe,"s"),_.XF=ee[_.ixfe],n.cellFormula&&(_.f=""+ba(f.formula,c,f.cell,ie,H)),j>0&&(_.z=X[_.ixfe>>8&63]),wi(_,n,e.opts.Date1904),W(f.cell,_,n),f=null;else throw new Error("String record expects Formula");break;case 33:case 545:{G.push(oe);var Ve=Jt(oe[0].s);if(w=n.dense?(i[oe[0].s.r]||[])[oe[0].s.c]:i[Ve],n.cellFormula&&w){if(!f||!Ve||!w)break;w.f=""+ba(oe[1],c,oe[0],ie,H),w.F=gr(oe[0])}}break;case 1212:{if(!n.cellFormula)break;if(E){if(!f)break;q[Jt(f.cell)]=oe[0],w=n.dense?(i[f.cell.r]||[])[f.cell.c]:i[Jt(f.cell)],(w||{}).f=""+ba(oe[0],c,b,ie,H)}}break;case 253:_=Dh(p[oe.isst].t,oe.ixfe,"s"),p[oe.isst].h&&(_.h=p[oe.isst].h),_.XF=ee[_.ixfe],j>0&&(_.z=X[_.ixfe>>8&63]),wi(_,n,e.opts.Date1904),W({c:oe.c,r:oe.r},_,n);break;case 513:n.sheetStubs&&(_={ixfe:oe.ixfe,XF:ee[oe.ixfe],t:"z"},j>0&&(_.z=X[_.ixfe>>8&63]),wi(_,n,e.opts.Date1904),W({c:oe.c,r:oe.r},_,n));break;case 190:if(n.sheetStubs)for(var Xe=oe.c;Xe<=oe.C;++Xe){var he=oe.ixfe[Xe-oe.c];_={ixfe:he,XF:ee[he],t:"z"},j>0&&(_.z=X[_.ixfe>>8&63]),wi(_,n,e.opts.Date1904),W({c:Xe,r:oe.r},_,n)}break;case 214:case 516:case 4:_=Dh(oe.val,oe.ixfe,"s"),_.XF=ee[_.ixfe],j>0&&(_.z=X[_.ixfe>>8&63]),wi(_,n,e.opts.Date1904),W({c:oe.c,r:oe.r},_,n);break;case 0:case 512:Ce===1&&(c=oe);break;case 252:p=oe;break;case 1054:if(H.biff==4){X[j++]=oe[1];for(var Be=0;Be<j+163&&Zt[Be]!=oe[1];++Be);Be>=163&&tc(oe[1],j+163)}else tc(oe[1],oe[0]);break;case 30:{X[j++]=oe;for(var Qe=0;Qe<j+163&&Zt[Qe]!=oe;++Qe);Qe>=163&&tc(oe,j+163)}break;case 229:Oe=Oe.concat(oe);break;case 93:ye[oe.cmo[0]]=H.lastobj=oe;break;case 438:H.lastobj.TxO=oe;break;case 127:H.lastobj.ImData=oe;break;case 440:for(U=oe[0].s.r;U<=oe[0].e.r;++U)for(y=oe[0].s.c;y<=oe[0].e.c;++y)w=n.dense?(i[U]||[])[y]:i[Jt({c:y,r:U})],w&&(w.l=oe[1]);break;case 2048:for(U=oe[0].s.r;U<=oe[0].e.r;++U)for(y=oe[0].s.c;y<=oe[0].e.c;++y)w=n.dense?(i[U]||[])[y]:i[Jt({c:y,r:U})],w&&w.l&&(w.l.Tooltip=oe[1]);break;case 28:{if(H.biff<=5&&H.biff>=2)break;w=n.dense?(i[oe[0].r]||[])[oe[0].c]:i[Jt(oe[0])];var vt=ye[oe[2]];w||(n.dense?(i[oe[0].r]||(i[oe[0].r]=[]),w=i[oe[0].r][oe[0].c]={t:"z"}):w=i[Jt(oe[0])]={t:"z"},c.e.r=Math.max(c.e.r,oe[0].r),c.s.r=Math.min(c.s.r,oe[0].r),c.e.c=Math.max(c.e.c,oe[0].c),c.s.c=Math.min(c.s.c,oe[0].c)),w.c||(w.c=[]),R={a:oe[1],t:vt.TxO.t},w.c.push(R)}break;case 2173:AI(ee[oe.ixfe],oe.ext);break;case 125:{if(!H.cellStyles)break;for(;oe.e>=oe.s;)Pe[oe.e--]={width:oe.w/256,level:oe.level||0,hidden:!!(oe.flags&1)},Ge||(Ge=!0,ON(oe.w/256)),yu(Pe[oe.e+1])}break;case 520:{var St={};oe.level!=null&&(ve[oe.r]=St,St.level=oe.level),oe.hidden&&(ve[oe.r]=St,St.hidden=!0),oe.hpt&&(ve[oe.r]=St,St.hpt=oe.hpt,St.hpx=Hf(oe.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Af(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[de]]=oe;break;case 161:i["!margins"]||Af(i["!margins"]={}),i["!margins"].header=oe.header,i["!margins"].footer=oe.footer;break;case 574:oe.RTL&&(z.Views[0].RTL=!0);break;case 146:Q=oe;break;case 2198:K=oe;break;case 140:ne=oe;break;case 442:g?ce.CodeName=oe||ce.name:z.WBProps.CodeName=oe||"ThisWorkbook";break}}else ge||console.error("Missing Info for XLS Record 0x"+de.toString(16)),t.l+=fe}return e.SheetNames=Ti(d).sort(function(tr,$e){return Number(tr)-Number($e)}).map(function(tr){return d[tr].name}),n.bookSheets||(e.Sheets=s),!e.SheetNames.length&&x["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=x)):e.Preamble=x,e.Sheets&&T.forEach(function(tr,$e){e.Sheets[e.SheetNames[$e]]["!autofilter"]=tr}),e.Strings=p,e.SSF=la(Zt),H.enc&&(e.Encryption=H.enc),K&&(e.Themes=K),e.Metadata={},ne!==void 0&&(e.Metadata.Country=ne),ie.names.length>0&&(z.Names=ie.names),e.Workbook=z,e}var PE={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function m7(t,n,e){var s=vr.find(t,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var i=pE(s,TV,PE.DSI);for(var d in i)n[d]=i[d]}catch(g){if(e.WTF)throw g}var c=vr.find(t,"/!SummaryInformation");if(c&&c.size>0)try{var f=pE(c,_V,PE.SI);for(var p in f)n[p]==null&&(n[p]=f[p])}catch(g){if(e.WTF)throw g}n.HeadingPairs&&n.TitlesOfParts&&(uC(n.HeadingPairs,n.TitlesOfParts,n,e),delete n.HeadingPairs,delete n.TitlesOfParts)}function GC(t,n){n||(n={}),RN(n),Sw(),n.codepage&&oN(n.codepage);var e,s;if(t.FullPaths){if(vr.find(t,"/encryption"))throw new Error("File is password-protected");e=vr.find(t,"!CompObj"),s=vr.find(t,"/Workbook")||vr.find(t,"/Book")}else{switch(n.type){case"base64":t=ti(ds(t));break;case"binary":t=ti(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}oa(t,0),s={content:t}}var i,d;if(e&&c7(e),n.bookProps&&!n.bookSheets)i={};else{var c=fr?"buffer":"array";if(s&&s.content)i=f7(s.content,n);else if((d=vr.find(t,"PerfectOffice_MAIN"))&&d.content)i=Pf.to_workbook(d.content,(n.type=c,n));else if((d=vr.find(t,"NativeContent_MAIN"))&&d.content)i=Pf.to_workbook(d.content,(n.type=c,n));else throw(d=vr.find(t,"MN0"))&&d.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&t.FullPaths&&vr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=QI(t))}var f={};return t.FullPaths&&m7(t,f,n),i.Props=i.Custprops=f,n.bookFiles&&(i.cfb=t),i}var $h={0:{f:YF},1:{f:QF},2:{f:o8},3:{f:r8},4:{f:e8},5:{f:i8},6:{f:u8},7:{f:a8},8:{f:p8},9:{f:h8},10:{f:f8},11:{f:m8},12:{f:ZF},13:{f:l8},14:{f:n8},15:{f:t8},16:{f:BC},17:{f:d8},18:{f:s8},19:{f:xN},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:B8},40:{},42:{},43:{f:fI},44:{f:dI},45:{f:mI},46:{f:pI},47:{f:hI},48:{},49:{f:vV},50:{},51:{f:VI},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:SC},62:{f:c8},63:{f:$I},64:{f:O8},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ya,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:y8},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:JF},148:{f:qF,p:16},151:{f:x8},152:{},153:{f:F8},154:{},155:{},156:{f:M8},157:{},158:{},159:{T:1,f:_j},160:{T:-1},161:{T:1,f:uc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:v8},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:LI},336:{T:-1},337:{f:jI,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Fb},357:{},358:{},359:{},360:{T:1},361:{},362:{f:DC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:b8},427:{f:N8},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:S8},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:KF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:g8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Fb},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:qI},633:{T:1},634:{T:-1},635:{T:1,f:YI},636:{T:-1},637:{f:xV},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:T8},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:E8},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},zb={6:{f:Ob},10:{f:nl},12:{f:pn},13:{f:pn},14:{f:ln},15:{f:ln},16:{f:Na},17:{f:ln},18:{f:ln},19:{f:pn},20:{f:bE},21:{f:bE},23:{f:DC},24:{f:DE},25:{f:ln},26:{},27:{},28:{f:X6},29:{},34:{f:ln},35:{f:NE},38:{f:Na},39:{f:Na},40:{f:Na},41:{f:Na},42:{f:ln},43:{f:ln},47:{f:Kj},49:{f:C6},51:{f:pn},60:{},61:{f:O6},64:{f:ln},65:{f:w6},66:{f:pn},77:{},80:{},81:{},82:{},85:{f:pn},89:{},90:{},91:{},92:{f:v6},93:{f:Y6},94:{},95:{f:ln},96:{},97:{},99:{f:ln},125:{f:SC},128:{f:j6},129:{f:g6},130:{f:pn},131:{f:ln},132:{f:ln},133:{f:x6},134:{},140:{f:ej},141:{f:pn},144:{},146:{f:rj},151:{},152:{},153:{},154:{},155:{},156:{f:pn},157:{},158:{},160:{f:oj},161:{f:aj},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:U6},190:{f:A6},193:{f:nl},197:{},198:{},199:{},200:{},201:{},202:{f:ln},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:pn},220:{},221:{f:ln},222:{},224:{f:V6},225:{f:p6},226:{f:nl},227:{},229:{f:G6},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:b6},253:{f:k6},255:{f:N6},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:pC},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ln},353:{f:nl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:M6},431:{f:ln},432:{},433:{},434:{},437:{},438:{f:J6},439:{f:ln},440:{f:Q6},441:{},442:{f:Qf},443:{},444:{f:pn},445:{},446:{},448:{f:nl},449:{f:y6,r:2},450:{f:nl},512:{f:gE},513:{f:ij},515:{f:I6},516:{f:R6},517:{f:xE},519:{f:lj},520:{f:D6},523:{},545:{f:SE},549:{f:vE},566:{},574:{f:E6},638:{f:P6},659:{},1048:{},1054:{f:T6},1084:{},1212:{f:H6},2048:{f:Z6},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:xh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:nl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:nj,r:12},2173:{f:UI,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ln,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:B6,r:12},2197:{},2198:{f:CI,r:12},2199:{},2200:{},2201:{},2202:{f:W6,r:12},2203:{f:nl},2204:{},2205:{},2206:{},2207:{},2211:{f:S6},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:pn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:sj},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:tj},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:gE},1:{},2:{f:fj},3:{f:dj},4:{f:uj},5:{f:xE},7:{f:mj},8:{},9:{f:xh},11:{},22:{f:pn},30:{f:_6},31:{},32:{},33:{f:SE},36:{},37:{f:vE},50:{f:hj},62:{},52:{},67:{},68:{f:pn},69:{},86:{},126:{},127:{f:cj},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:pj},223:{},234:{},354:{},421:{},518:{f:Ob},521:{f:xh},536:{f:DE},547:{f:NE},561:{},579:{},1030:{f:Ob},1033:{f:xh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Zs(t,n,e,s){var i=n;if(!isNaN(i)){var d=(e||[]).length||0,c=t.next(4);c.write_shift(2,i),c.write_shift(2,d),d>0&&rC(e)&&t.push(e)}}function UE(t,n){var e=n||{},s=e.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var d=t.match(/<\/table/i),c=i.index,f=d&&d.index||t.length,p=IL(t.slice(c,f),/(:?<tr[^>]*>)/i,"<tr>"),g=-1,x=0,b=0,E=0,w={s:{r:1e7,c:1e7},e:{r:0,c:0}},R=[];for(c=0;c<p.length;++c){var y=p[c].trim(),U=y.slice(0,3).toLowerCase();if(U=="<tr"){if(++g,e.sheetRows&&e.sheetRows<=g){--g;break}x=0;continue}if(!(U!="<td"&&U!="<th")){var q=y.split(/<\/t[dh]>/i);for(f=0;f<q.length;++f){var G=q[f].trim();if(G.match(/<t[dh]/i)){for(var _=G,ne=0;_.charAt(0)=="<"&&(ne=_.indexOf(">"))>-1;)_=_.slice(ne+1);for(var ee=0;ee<R.length;++ee){var Q=R[ee];Q.s.c==x&&Q.s.r<g&&g<=Q.e.r&&(x=Q.e.c+1,ee=-1)}var z=Wt(G.slice(0,G.indexOf(">")));E=z.colspan?+z.colspan:1,((b=+z.rowspan)>1||E>1)&&R.push({s:{r:g,c:x},e:{r:g+(b||1)-1,c:x+E-1}});var ce=z.t||z["data-t"]||"";if(!_.length){x+=E;continue}if(_=Hw(_),w.s.r>g&&(w.s.r=g),w.e.r<g&&(w.e.r=g),w.s.c>x&&(w.s.c=x),w.e.c<x&&(w.e.c=x),!_.length){x+=E;continue}var S={t:"s",v:_};e.raw||!_.trim().length||ce=="s"||(_==="TRUE"?S={t:"b",v:!0}:_==="FALSE"?S={t:"b",v:!1}:isNaN(ai(_))?isNaN(Su(_).getDate())||(S={t:"d",v:Wn(_)},e.cellDates||(S={t:"n",v:Ia(S.v)}),S.z=e.dateNF||Zt[14]):S={t:"n",v:ai(_)}),e.dense?(s[g]||(s[g]=[]),s[g][x]=S):s[Jt({r:g,c:x})]=S,x+=E}}}}return s["!ref"]=gr(w),R.length&&(s["!merges"]=R),s}function h7(t,n,e,s){for(var i=t["!merges"]||[],d=[],c=n.s.c;c<=n.e.c;++c){for(var f=0,p=0,g=0;g<i.length;++g)if(!(i[g].s.r>e||i[g].s.c>c)&&!(i[g].e.r<e||i[g].e.c<c)){if(i[g].s.r<e||i[g].s.c<c){f=-1;break}f=i[g].e.r-i[g].s.r+1,p=i[g].e.c-i[g].s.c+1;break}if(!(f<0)){var x=Jt({r:e,c}),b=s.dense?(t[e]||[])[c]:t[x],E=b&&b.v!=null&&(b.h||mN(b.w||(po(b),b.w)||""))||"",w={};f>1&&(w.rowspan=f),p>1&&(w.colspan=p),s.editable?E='<span contenteditable="true">'+E+"</span>":b&&(w["data-t"]=b&&b.t||"z",b.v!=null&&(w["data-v"]=b.v),b.z!=null&&(w["data-z"]=b.z),b.l&&(b.l.Target||"#").charAt(0)!="#"&&(E='<a href="'+b.l.Target+'">'+E+"</a>")),w.id=(s.id||"sjs")+"-"+x,d.push(eV("td",E,w))}}var R="<tr>";return R+d.join("")+"</tr>"}var p7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',v7="</body></html>";function g7(t,n){var e=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return ml(UE(e[0],n),n);var s=_N();return e.forEach(function(i,d){PN(s,UE(i,n),"Sheet"+(d+1))}),s}function x7(t,n,e){var s=[];return s.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function b7(t,n){var e=n||{},s=e.header!=null?e.header:p7,i=e.footer!=null?e.footer:v7,d=[s],c=ku(t["!ref"]);e.dense=Array.isArray(t),d.push(x7(t,c,e));for(var f=c.s.r;f<=c.e.r;++f)d.push(h7(t,c,f,e));return d.push("</table>"+i),d.join("")}function YC(t,n,e){var s=e||{},i=0,d=0;if(s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var c=typeof s.origin=="string"?Va(s.origin):s.origin;i=c.r,d=c.c}var f=n.getElementsByTagName("tr"),p=Math.min(s.sheetRows||1e7,f.length),g={s:{r:0,c:0},e:{r:i,c:d}};if(t["!ref"]){var x=ku(t["!ref"]);g.s.r=Math.min(g.s.r,x.s.r),g.s.c=Math.min(g.s.c,x.s.c),g.e.r=Math.max(g.e.r,x.e.r),g.e.c=Math.max(g.e.c,x.e.c),i==-1&&(g.e.r=i=x.e.r+1)}var b=[],E=0,w=t["!rows"]||(t["!rows"]=[]),R=0,y=0,U=0,q=0,G=0,_=0;for(t["!cols"]||(t["!cols"]=[]);R<f.length&&y<p;++R){var ne=f[R];if(AE(ne)){if(s.display)continue;w[y]={hidden:!0}}var ee=ne.children;for(U=q=0;U<ee.length;++U){var Q=ee[U];if(!(s.display&&AE(Q))){var z=Q.hasAttribute("data-v")?Q.getAttribute("data-v"):Q.hasAttribute("v")?Q.getAttribute("v"):Hw(Q.innerHTML),ce=Q.getAttribute("data-z")||Q.getAttribute("z");for(E=0;E<b.length;++E){var S=b[E];S.s.c==q+d&&S.s.r<y+i&&y+i<=S.e.r&&(q=S.e.c+1-d,E=-1)}_=+Q.getAttribute("colspan")||1,((G=+Q.getAttribute("rowspan")||1)>1||_>1)&&b.push({s:{r:y+i,c:q+d},e:{r:y+i+(G||1)-1,c:q+d+(_||1)-1}});var A={t:"s",v:z},W=Q.getAttribute("data-t")||Q.getAttribute("t")||"";z!=null&&(z.length==0?A.t=W||"z":s.raw||z.trim().length==0||W=="s"||(z==="TRUE"?A={t:"b",v:!0}:z==="FALSE"?A={t:"b",v:!1}:isNaN(ai(z))?isNaN(Su(z).getDate())||(A={t:"d",v:Wn(z)},s.cellDates||(A={t:"n",v:Ia(A.v)}),A.z=s.dateNF||Zt[14]):A={t:"n",v:ai(z)})),A.z===void 0&&ce!=null&&(A.z=ce);var H="",K=Q.getElementsByTagName("A");if(K&&K.length)for(var Oe=0;Oe<K.length&&!(K[Oe].hasAttribute("href")&&(H=K[Oe].getAttribute("href"),H.charAt(0)!="#"));++Oe);H&&H.charAt(0)!="#"&&(A.l={Target:H}),s.dense?(t[y+i]||(t[y+i]=[]),t[y+i][q+d]=A):t[Jt({c:q+d,r:y+i})]=A,g.e.c<q+d&&(g.e.c=q+d),q+=_}}++y}return b.length&&(t["!merges"]=(t["!merges"]||[]).concat(b)),g.e.r=Math.max(g.e.r,y-1+i),t["!ref"]=gr(g),y>=p&&(t["!fullref"]=gr((g.e.r=f.length-R+y-1+i,g))),t}function qC(t,n){var e=n||{},s=e.dense?[]:{};return YC(s,t,n)}function N7(t,n){return ml(qC(t,n),n)}function AE(t){var n="",e=D7(t);return e&&(n=e(t).getPropertyValue("display")),n||(n=t.style&&t.style.display),n==="none"}function D7(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function S7(t){var n=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=Sr(n.replace(/<[^>]*>/g,""));return[e]}var LE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function KC(t,n){var e=n||{},s=hN(t),i=[],d,c,f={name:""},p="",g=0,x,b,E={},w=[],R=e.dense?[]:{},y,U,q={value:""},G="",_=0,ne=[],ee=-1,Q=-1,z={s:{r:1e6,c:1e7},e:{r:0,c:0}},ce=0,S={},A=[],W={},H=0,K=0,Oe=[],ye=1,Pe=1,ve=[],Ge={Names:[]},ie={},Ee=["",""],Ce=[],j={},X="",T=0,O=!1,P=!1,F=0;for(Ff.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=Ff.exec(s);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(z.e.c>=z.s.c&&z.e.r>=z.s.r?R["!ref"]=gr(z):R["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=z.e.r&&(R["!fullref"]=R["!ref"],z.e.r=e.sheetRows-1,R["!ref"]=gr(z)),A.length&&(R["!merges"]=A),Oe.length&&(R["!rows"]=Oe),x.name=x.||x.name,typeof JSON<"u"&&JSON.stringify(x),w.push(x.name),E[x.name]=R,P=!1):y[0].charAt(y[0].length-2)!=="/"&&(x=Wt(y[0],!1),ee=Q=-1,z.s.r=z.s.c=1e7,z.e.r=z.e.c=0,R=e.dense?[]:{},A=[],Oe=[],P=!0);break;case"table-row-group":y[1]==="/"?--ce:++ce;break;case"table-row":case"":if(y[1]==="/"){ee+=ye,ye=1;break}if(b=Wt(y[0],!1),b.?ee=b.-1:ee==-1&&(ee=0),ye=+b["number-rows-repeated"]||1,ye<10)for(F=0;F<ye;++F)ce>0&&(Oe[ee+F]={level:ce});Q=-1;break;case"covered-table-cell":y[1]!=="/"&&++Q,e.sheetStubs&&(e.dense?(R[ee]||(R[ee]=[]),R[ee][Q]={t:"z"}):R[Jt({r:ee,c:Q})]={t:"z"}),G="",ne=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++Q,q=Wt(y[0],!1),Pe=parseInt(q["number-columns-repeated"]||"1",10),U={t:"z",v:null},q.formula&&e.cellFormula!=!1&&(U.f=RE(Sr(q.formula))),(q.||q["value-type"])=="string"&&(U.t="s",U.v=Sr(q["string-value"]||""),e.dense?(R[ee]||(R[ee]=[]),R[ee][Q]=U):R[Jt({r:ee,c:Q})]=U),Q+=Pe-1;else if(y[1]!=="/"){++Q,G="",_=0,ne=[],Pe=1;var de=ye?ee+ye-1:ee;if(Q>z.e.c&&(z.e.c=Q),Q<z.s.c&&(z.s.c=Q),ee<z.s.r&&(z.s.r=ee),de>z.e.r&&(z.e.r=de),q=Wt(y[0],!1),Ce=[],j={},U={t:q.||q["value-type"],v:null},e.cellFormula)if(q.formula&&(q.formula=Sr(q.formula)),q["number-matrix-columns-spanned"]&&q["number-matrix-rows-spanned"]&&(H=parseInt(q["number-matrix-rows-spanned"],10)||0,K=parseInt(q["number-matrix-columns-spanned"],10)||0,W={s:{r:ee,c:Q},e:{r:ee+H-1,c:Q+K-1}},U.F=gr(W),ve.push([W,U.F])),q.formula)U.f=RE(q.formula);else for(F=0;F<ve.length;++F)ee>=ve[F][0].s.r&&ee<=ve[F][0].e.r&&Q>=ve[F][0].s.c&&Q<=ve[F][0].e.c&&(U.F=ve[F][1]);switch((q["number-columns-spanned"]||q["number-rows-spanned"])&&(H=parseInt(q["number-rows-spanned"],10)||0,K=parseInt(q["number-columns-spanned"],10)||0,W={s:{r:ee,c:Q},e:{r:ee+H-1,c:Q+K-1}},A.push(W)),q["number-columns-repeated"]&&(Pe=parseInt(q["number-columns-repeated"],10)),U.t){case"boolean":U.t="b",U.v=zr(q["boolean-value"]);break;case"float":U.t="n",U.v=parseFloat(q.value);break;case"percentage":U.t="n",U.v=parseFloat(q.value);break;case"currency":U.t="n",U.v=parseFloat(q.value);break;case"date":U.t="d",U.v=Wn(q["date-value"]),e.cellDates||(U.t="n",U.v=Ia(U.v)),U.z="m/d/yy";break;case"time":U.t="n",U.v=LL(q["time-value"])/86400,e.cellDates&&(U.t="d",U.v=Gh(U.v)),U.z="HH:MM:SS";break;case"number":U.t="n",U.v=parseFloat(q.);break;default:if(U.t==="string"||U.t==="text"||!U.t)U.t="s",q["string-value"]!=null&&(G=Sr(q["string-value"]),ne=[]);else throw new Error("Unsupported value type "+U.t)}}else{if(O=!1,U.t==="s"&&(U.v=G||"",ne.length&&(U.R=ne),O=_==0),ie.Target&&(U.l=ie),Ce.length>0&&(U.c=Ce,Ce=[]),G&&e.cellText!==!1&&(U.w=G),O&&(U.t="z",delete U.v),(!O||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=ee))for(var fe=0;fe<ye;++fe){if(Pe=parseInt(q["number-columns-repeated"]||"1",10),e.dense)for(R[ee+fe]||(R[ee+fe]=[]),R[ee+fe][Q]=fe==0?U:la(U);--Pe>0;)R[ee+fe][Q+Pe]=la(U);else for(R[Jt({r:ee+fe,c:Q})]=U;--Pe>0;)R[Jt({r:ee+fe,c:Q+Pe})]=la(U);z.e.c<=Q&&(z.e.c=Q)}Pe=parseInt(q["number-columns-repeated"]||"1",10),Q+=Pe-1,Pe=0,U={},G="",ne=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((d=i.pop())[0]!==y[3])throw"Bad state: "+d}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((d=i.pop())[0]!==y[3])throw"Bad state: "+d;j.t=G,ne.length&&(j.R=ne),j.a=X,Ce.push(j)}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);X="",T=0,G="",_=0,ne=[];break;case"creator":y[1]==="/"?X=s.slice(T,y.index):T=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((d=i.pop())[0]!==y[3])throw"Bad state: "+d}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);G="",_=0,ne=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(S[f.name]=p,(d=i.pop())[0]!==y[3])throw"Bad state: "+d}else y[0].charAt(y[0].length-2)!=="/"&&(p="",f=Wt(y[0],!1),i.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":c=Wt(y[0],!1),p+=LE[y[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":c=Wt(y[0],!1),p+=LE[y[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":p+=s.slice(g,y.index);break}else g=y.index+y[0].length;break;case"named-range":c=Wt(y[0],!1),Ee=Eb(c["cell-range-address"]);var ge={Name:c.name,Ref:Ee[0]+"!"+Ee[1]};P&&(ge.Sheet=w.length),Ge.Names.push(ge);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(y[1]==="/"&&(!q||!q["string-value"])){var ze=S7(s.slice(_,y.index));G=(G.length>0?G+`
`:"")+ze[0]}else Wt(y[0],!1),_=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{Ee=Eb(Wt(y[0])["target-range-address"]),E[Ee[0]]["!autofilter"]={ref:Ee[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(ie=Wt(y[0],!1),!ie.href)break;ie.Target=Sr(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(Ee=Eb(ie.Target.slice(1)),ie.Target="#"+Ee[0]+"!"+Ee[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(e.WTF)throw new Error(y)}}var oe={Sheets:E,SheetNames:w,Workbook:Ge};return e.bookSheets&&delete oe.Sheets,oe}function VE(t,n){n=n||{},ws(t,"META-INF/manifest.xml")&&IV(hn(t,"META-INF/manifest.xml"),n);var e=us(t,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var s=KC(Mr(e),n);return ws(t,"meta.xml")&&(s.Props=cC(hn(t,"meta.xml"))),s}function jE(t,n){return KC(t,n)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function CN(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Xb(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Mr(lc(t))}function Gb(t){var n=t.reduce(function(i,d){return i+d.length},0),e=new Uint8Array(n),s=0;return t.forEach(function(i){e.set(i,s),s+=i.length}),e}function IE(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function y7(t,n){for(var e=(t[n+15]&127)<<7|t[n+14]>>1,s=t[n+14]&1,i=n+13;i>=n;--i)s=s*256+t[i];return(t[n+15]&128?-s:s)*Math.pow(10,e-6176)}function Wf(t,n){var e=n?n[0]:0,s=t[e]&127;e:if(t[e++]>=128&&(s|=(t[e]&127)<<7,t[e++]<128||(s|=(t[e]&127)<<14,t[e++]<128)||(s|=(t[e]&127)<<21,t[e++]<128)||(s+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(s+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(s+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return n&&(n[0]=e),s}function Un(t){var n=0,e=t[n]&127;e:if(t[n++]>=128){if(e|=(t[n]&127)<<7,t[n++]<128||(e|=(t[n]&127)<<14,t[n++]<128)||(e|=(t[n]&127)<<21,t[n++]<128))break e;e|=(t[n]&127)<<28}return e}function Da(t){for(var n=[],e=[0];e[0]<t.length;){var s=e[0],i=Wf(t,e),d=i&7;i=Math.floor(i/8);var c=0,f;if(i==0)break;switch(d){case 0:{for(var p=e[0];t[e[0]++]>=128;);f=t.slice(p,e[0])}break;case 5:c=4,f=t.slice(e[0],e[0]+c),e[0]+=c;break;case 1:c=8,f=t.slice(e[0],e[0]+c),e[0]+=c;break;case 2:c=Wf(t,e),f=t.slice(e[0],e[0]+c),e[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(d," for Field ").concat(i," at offset ").concat(s))}var g={data:f,type:d};n[i]==null?n[i]=[g]:n[i].push(g)}return n}function kN(t,n){return t?.map(function(e){return n(e.data)})||[]}function O7(t){for(var n,e=[],s=[0];s[0]<t.length;){var i=Wf(t,s),d=Da(t.slice(s[0],s[0]+i));s[0]+=i;var c={id:Un(d[1][0].data),messages:[]};d[2].forEach(function(f){var p=Da(f.data),g=Un(p[3][0].data);c.messages.push({meta:p,data:t.slice(s[0],s[0]+g)}),s[0]+=g}),(n=d[3])!=null&&n[0]&&(c.merge=Un(d[3][0].data)>>>0>0),e.push(c)}return e}function E7(t,n){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],s=Wf(n,e),i=[];e[0]<n.length;){var d=n[e[0]]&3;if(d==0){var c=n[e[0]++]>>2;if(c<60)++c;else{var f=c-59;c=n[e[0]],f>1&&(c|=n[e[0]+1]<<8),f>2&&(c|=n[e[0]+2]<<16),f>3&&(c|=n[e[0]+3]<<24),c>>>=0,c++,e[0]+=f}i.push(n.slice(e[0],e[0]+c)),e[0]+=c;continue}else{var p=0,g=0;if(d==1?(g=(n[e[0]]>>2&7)+4,p=(n[e[0]++]&224)<<3,p|=n[e[0]++]):(g=(n[e[0]++]>>2)+1,d==2?(p=n[e[0]]|n[e[0]+1]<<8,e[0]+=2):(p=(n[e[0]]|n[e[0]+1]<<8|n[e[0]+2]<<16|n[e[0]+3]<<24)>>>0,e[0]+=4)),i=[Gb(i)],p==0)throw new Error("Invalid offset 0");if(p>i[0].length)throw new Error("Invalid offset beyond length");if(g>=p)for(i.push(i[0].slice(-p)),g-=p;g>=i[i.length-1].length;)i.push(i[i.length-1]),g-=i[i.length-1].length;i.push(i[0].slice(-p,-p+g))}}var x=Gb(i);if(x.length!=s)throw new Error("Unexpected length: ".concat(x.length," != ").concat(s));return x}function w7(t){for(var n=[],e=0;e<t.length;){var s=t[e++],i=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,n.push(E7(s,t.slice(e,e+i))),e+=i}if(e!==t.length)throw new Error("data is not a valid framed stream!");return Gb(n)}function C7(t,n,e,s){var i=CN(t),d=i.getUint32(4,!0),c=(s>1?12:8)+IE(d&(s>1?3470:398))*4,f=-1,p=-1,g=NaN,x=new Date(2001,0,1);d&512&&(f=i.getUint32(c,!0),c+=4),c+=IE(d&(s>1?12288:4096))*4,d&16&&(p=i.getUint32(c,!0),c+=4),d&32&&(g=i.getFloat64(c,!0),c+=8),d&64&&(x.setTime(x.getTime()+i.getFloat64(c,!0)*1e3),c+=8);var b;switch(t[2]){case 0:break;case 2:b={t:"n",v:g};break;case 3:b={t:"s",v:n[p]};break;case 5:b={t:"d",v:x};break;case 6:b={t:"b",v:g>0};break;case 7:b={t:"n",v:g/86400};break;case 8:b={t:"e",v:0};break;case 9:if(f>-1)b={t:"s",v:e[f]};else if(p>-1)b={t:"s",v:n[p]};else if(!isNaN(g))b={t:"n",v:g};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return b}function k7(t,n,e){var s=CN(t),i=s.getUint32(8,!0),d=12,c=-1,f=-1,p=NaN,g=NaN,x=new Date(2001,0,1);i&1&&(p=y7(t,d),d+=16),i&2&&(g=s.getFloat64(d,!0),d+=8),i&4&&(x.setTime(x.getTime()+s.getFloat64(d,!0)*1e3),d+=8),i&8&&(f=s.getUint32(d,!0),d+=4),i&16&&(c=s.getUint32(d,!0),d+=4);var b;switch(t[1]){case 0:break;case 2:b={t:"n",v:p};break;case 3:b={t:"s",v:n[f]};break;case 5:b={t:"d",v:x};break;case 6:b={t:"b",v:g>0};break;case 7:b={t:"n",v:g/86400};break;case 8:b={t:"e",v:0};break;case 9:if(c>-1)b={t:"s",v:e[c]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:b={t:"n",v:p};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return b}function R7(t,n,e){switch(t[0]){case 0:case 1:case 2:case 3:return C7(t,n,e,t[0]);case 5:return k7(t,n,e);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function cl(t){var n=Da(t);return Wf(n[1][0].data)}function ME(t,n){var e=Da(n.data),s=Un(e[1][0].data),i=e[3],d=[];return(i||[]).forEach(function(c){var f=Da(c.data),p=Un(f[1][0].data)>>>0;switch(s){case 1:d[p]=Xb(f[3][0].data);break;case 8:{var g=t[cl(f[9][0].data)][0],x=Da(g.data),b=t[cl(x[1][0].data)][0],E=Un(b.meta[1][0].data);if(E!=2001)throw new Error("2000 unexpected reference to ".concat(E));var w=Da(b.data);d[p]=w[3].map(function(R){return Xb(R.data)}).join("")}break}}),d}function T7(t,n){var e,s,i,d,c,f,p,g,x,b,E,w,R,y,U=Da(t),q=Un(U[1][0].data)>>>0,G=Un(U[2][0].data)>>>0,_=((s=(e=U[8])==null?void 0:e[0])==null?void 0:s.data)&&Un(U[8][0].data)>0||!1,ne,ee;if((d=(i=U[7])==null?void 0:i[0])!=null&&d.data&&n!=0)ne=(f=(c=U[7])==null?void 0:c[0])==null?void 0:f.data,ee=(g=(p=U[6])==null?void 0:p[0])==null?void 0:g.data;else if((b=(x=U[4])==null?void 0:x[0])!=null&&b.data&&n!=1)ne=(w=(E=U[4])==null?void 0:E[0])==null?void 0:w.data,ee=(y=(R=U[3])==null?void 0:R[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var Q=_?4:1,z=CN(ne),ce=[],S=0;S<ne.length/2;++S){var A=z.getUint16(S*2,!0);A<65535&&ce.push([S,A])}if(ce.length!=G)throw"Expected ".concat(G," cells, found ").concat(ce.length);var W=[];for(S=0;S<ce.length-1;++S)W[ce[S][0]]=ee.subarray(ce[S][1]*Q,ce[S+1][1]*Q);return ce.length>=1&&(W[ce[ce.length-1][0]]=ee.subarray(ce[ce.length-1][1]*Q)),{R:q,cells:W}}function _7(t,n){var e,s=Da(n.data),i=(e=s?.[7])!=null&&e[0]?Un(s[7][0].data)>>>0>0?1:0:-1,d=kN(s[5],function(c){return T7(c,i)});return{nrows:Un(s[4][0].data)>>>0,data:d.reduce(function(c,f){return c[f.R]||(c[f.R]=[]),f.cells.forEach(function(p,g){if(c[f.R][g])throw new Error("Duplicate cell r=".concat(f.R," c=").concat(g));c[f.R][g]=p}),c},[])}}function P7(t,n,e){var s,i=Da(n.data),d={s:{r:0,c:0},e:{r:0,c:0}};if(d.e.r=(Un(i[6][0].data)>>>0)-1,d.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(d.e.c=(Un(i[7][0].data)>>>0)-1,d.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));e["!ref"]=gr(d);var c=Da(i[4][0].data),f=ME(t,t[cl(c[4][0].data)][0]),p=(s=c[17])!=null&&s[0]?ME(t,t[cl(c[17][0].data)][0]):[],g=Da(c[3][0].data),x=0;g[1].forEach(function(b){var E=Da(b.data),w=t[cl(E[2][0].data)][0],R=Un(w.meta[1][0].data);if(R!=6002)throw new Error("6001 unexpected reference to ".concat(R));var y=_7(t,w);y.data.forEach(function(U,q){U.forEach(function(G,_){var ne=Jt({r:x+q,c:_}),ee=R7(G,f,p);ee&&(e[ne]=ee)})}),x+=y.nrows})}function U7(t,n){var e=Da(n.data),s={"!ref":"A1"},i=t[cl(e[2][0].data)],d=Un(i[0].meta[1][0].data);if(d!=6001)throw new Error("6000 unexpected reference to ".concat(d));return P7(t,i[0],s),s}function A7(t,n){var e,s=Da(n.data),i={name:(e=s[1])!=null&&e[0]?Xb(s[1][0].data):"",sheets:[]},d=kN(s[2],cl);return d.forEach(function(c){t[c].forEach(function(f){var p=Un(f.meta[1][0].data);p==6e3&&i.sheets.push(U7(t,f))})}),i}function L7(t,n){var e=_N(),s=Da(n.data),i=kN(s[1],cl);if(i.forEach(function(d){t[d].forEach(function(c){var f=Un(c.meta[1][0].data);if(f==2){var p=A7(t,c);p.sheets.forEach(function(g,x){PN(e,g,x==0?p.name:p.name+"_"+x,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function Cb(t){var n,e,s,i,d={},c=[];if(t.FullPaths.forEach(function(p){if(p.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(p){if(p.name.match(/\.iwa$/)){var g;try{g=w7(p.content)}catch(b){return console.log("?? "+p.content.length+" "+(b.message||b))}var x;try{x=O7(g)}catch(b){return console.log("## "+(b.message||b))}x.forEach(function(b){d[b.id]=b.messages,c.push(b.id)})}}),!c.length)throw new Error("File has no messages");var f=((i=(s=(e=(n=d?.[1])==null?void 0:n[0])==null?void 0:e.meta)==null?void 0:s[1])==null?void 0:i[0].data)&&Un(d[1][0].meta[1][0].data)==1&&d[1][0];if(f||c.forEach(function(p){d[p].forEach(function(g){var x=Un(g.meta[1][0].data)>>>0;if(x==1)if(!f)f=g;else throw new Error("Document has multiple roots")})}),!f)throw new Error("Cannot find Document root");return L7(d,f)}function V7(t){return function(e){for(var s=0;s!=t.length;++s){var i=t[s];e[i[0]]===void 0&&(e[i[0]]=i[1]),i[2]==="n"&&(e[i[0]]=Number(e[i[0]]))}}}function RN(t){V7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function j7(t){return xu.WS.indexOf(t)>-1?"sheet":t==xu.CS?"chart":t==xu.DS?"dialog":t==xu.MS?"macro":t&&t.length?t:"sheet"}function I7(t,n){if(!t)return 0;try{t=n.map(function(s){return s.id||(s.id=s.strRelID),[s.name,t["!id"][s.id].Target,j7(t["!id"][s.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function M7(t,n,e,s,i,d,c,f,p,g,x,b){try{d[s]=Tf(us(t,e,!0),n);var E=hn(t,n),w;switch(f){case"sheet":w=z8(E,n,i,p,d[s],g,x,b);break;case"chart":if(w=X8(E,n,i,p,d[s],g,x,b),!w||!w["!drawel"])break;var R=Ef(w["!drawel"].Target,n),y=$b(R),U=WI(us(t,R,!0),Tf(us(t,y,!0),R)),q=Ef(U,R),G=$b(q);w=k8(us(t,q,!0),q,p,Tf(us(t,G,!0),q),g,w);break;case"macro":w=G8(E,n,i,p,d[s],g,x,b);break;case"dialog":w=Y8(E,n,i,p,d[s],g,x,b);break;default:throw new Error("Unrecognized sheet type "+f)}c[s]=w;var _=[];d&&d[s]&&Ti(d[s]).forEach(function(ne){var ee="";if(d[s][ne].Type==xu.CMNT){ee=Ef(d[s][ne].Target,n);var Q=Q8(hn(t,ee,!0),ee,p);if(!Q||!Q.length)return;OE(w,Q,!1)}d[s][ne].Type==xu.TCMNT&&(ee=Ef(d[s][ne].Target,n),_=_.concat(XI(hn(t,ee,!0),p)))}),_&&_.length&&OE(w,_,!0,p.people||[])}catch(ne){if(p.WTF)throw ne}}function ys(t){return t.charAt(0)=="/"?t.slice(1):t}function F7(t,n){if(Aw(),n=n||{},RN(n),ws(t,"META-INF/manifest.xml")||ws(t,"objectdata.xml"))return VE(t,n);if(ws(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Cb<"u"){if(t.FileIndex)return Cb(t);var e=vr.utils.cfb_new();return JO(t).forEach(function(Oe){$L(e,Oe,FL(t,Oe))}),Cb(e)}throw new Error("Unsupported NUMBERS file")}if(!ws(t,"[Content_Types].xml"))throw ws(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ws(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=JO(t),i=VV(us(t,"[Content_Types].xml")),d=!1,c,f;if(i.workbooks.length===0&&(f="xl/workbook.xml",hn(t,f,!0)&&i.workbooks.push(f)),i.workbooks.length===0){if(f="xl/workbook.bin",!hn(t,f,!0))throw new Error("Could not find workbook");i.workbooks.push(f),d=!0}i.workbooks[0].slice(-3)=="bin"&&(d=!0);var p={},g={};if(!n.bookSheets&&!n.bookProps){if(Uf=[],i.sst)try{Uf=J8(hn(t,ys(i.sst)),i.sst,n)}catch(Oe){if(n.WTF)throw Oe}n.cellStyles&&i.themes.length&&(p=K8(us(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],n)),i.style&&(g=q8(hn(t,ys(i.style)),i.style,p,n))}i.links.map(function(Oe){try{var ye=Tf(us(t,$b(ys(Oe))),Oe);return e7(hn(t,ys(Oe)),ye,Oe,n)}catch{}});var x=W8(hn(t,ys(i.workbooks[0])),i.workbooks[0],n),b={},E="";i.coreprops.length&&(E=hn(t,ys(i.coreprops[0]),!0),E&&(b=cC(E)),i.extprops.length!==0&&(E=hn(t,ys(i.extprops[0]),!0),E&&$V(E,b,n)));var w={};(!n.bookSheets||n.bookProps)&&i.custprops.length!==0&&(E=us(t,ys(i.custprops[0]),!0),E&&(w=HV(E,n)));var R={};if((n.bookSheets||n.bookProps)&&(x.Sheets?c=x.Sheets.map(function(ye){return ye.name}):b.Worksheets&&b.SheetNames.length>0&&(c=b.SheetNames),n.bookProps&&(R.Props=b,R.Custprops=w),n.bookSheets&&typeof c<"u"&&(R.SheetNames=c),n.bookSheets?R.SheetNames:n.bookProps))return R;c={};var y={};n.bookDeps&&i.calcchain&&(y=Z8(hn(t,ys(i.calcchain)),i.calcchain));var U=0,q={},G,_;{var ne=x.Sheets;b.Worksheets=ne.length,b.SheetNames=[];for(var ee=0;ee!=ne.length;++ee)b.SheetNames[ee]=ne[ee].name}var Q=d?"bin":"xml",z=i.workbooks[0].lastIndexOf("/"),ce=(i.workbooks[0].slice(0,z+1)+"_rels/"+i.workbooks[0].slice(z+1)+".rels").replace(/^\//,"");ws(t,ce)||(ce="xl/_rels/workbook."+Q+".rels");var S=Tf(us(t,ce,!0),ce.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(n.xlmeta=t7(hn(t,ys(i.metadata[0])),i.metadata[0],n)),(i.people||[]).length>=1&&(n.people=GI(hn(t,ys(i.people[0])),n)),S&&(S=I7(S,x.Sheets));var A=hn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(U=0;U!=b.Worksheets;++U){var W="sheet";if(S&&S[U]?(G="xl/"+S[U][1].replace(/[\/]?xl\//,""),ws(t,G)||(G=S[U][1]),ws(t,G)||(G=ce.replace(/_rels\/.*$/,"")+S[U][1]),W=S[U][2]):(G="xl/worksheets/sheet"+(U+1-A)+"."+Q,G=G.replace(/sheet0\./,"sheet.")),_=G.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(U!=n.sheets)continue e;break;case"string":if(b.SheetNames[U].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var H=!1,K=0;K!=n.sheets.length;++K)typeof n.sheets[K]=="number"&&n.sheets[K]==U&&(H=1),typeof n.sheets[K]=="string"&&n.sheets[K].toLowerCase()==b.SheetNames[U].toLowerCase()&&(H=1);if(!H)continue e}}M7(t,G,_,b.SheetNames[U],U,q,c,W,n,x,p,g)}return R={Directory:i,Workbook:x,Props:b,Custprops:w,Deps:y,Sheets:c,SheetNames:b.SheetNames,Strings:Uf,Styles:g,Themes:p,SSF:la(Zt)},n&&n.bookFiles&&(t.files?(R.keys=s,R.files=t.files):(R.keys=[],R.files={},t.FullPaths.forEach(function(Oe,ye){Oe=Oe.replace(/^Root Entry[\/]/,""),R.keys.push(Oe),R.files[Oe]=t.FileIndex[ye]}))),n&&n.bookVBA&&(i.vba.length>0?R.vbaraw=hn(t,ys(i.vba[0]),!0):i.defaults&&i.defaults.bin===JI&&(R.vbaraw=hn(t,"xl/vbaProject.bin",!0))),R}function $7(t,n){var e=n||{},s="Workbook",i=vr.find(t,s);try{if(s="/!DataSpaces/Version",i=vr.find(t,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(Uj(i.content),s="/!DataSpaces/DataSpaceMap",i=vr.find(t,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var d=Lj(i.content);if(d.length!==1||d[0].comps.length!==1||d[0].comps[0].t!==0||d[0].name!=="StrongEncryptionDataSpace"||d[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=vr.find(t,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var c=Vj(i.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=vr.find(t,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);Ij(i.content)}catch{}if(s="/EncryptionInfo",i=vr.find(t,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var f=Mj(i.content);if(s="/EncryptedPackage",i=vr.find(t,s),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(f[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(f[1],i.content,e.password||"",e);if(f[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(f[1],i.content,e.password||"",e);throw new Error("File is password-protected")}function TN(t,n){var e="";switch((n||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=ds(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function B7(t,n){return vr.find(t,"EncryptedPackage")?$7(t,n):GC(t,n)}function H7(t,n){var e,s=t,i=n||{};return i.type||(i.type=fr&&Buffer.isBuffer(t)?"buffer":"base64"),e=Fw(s,i),F7(e,i)}function JC(t,n){var e=0;e:for(;e<t.length;)switch(t.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return Wb(t.slice(e),n);default:break e}return $f.to_workbook(t,n)}function W7(t,n){var e="",s=TN(t,n);switch(n.type){case"base64":e=ds(t);break;case"binary":e=t;break;case"buffer":e=t.toString("binary");break;case"array":e=ac(t);break;default:throw new Error("Unrecognized type "+n.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(e=Mr(e)),n.type="binary",JC(e,n)}function z7(t,n){var e=t;return n.type=="base64"&&(e=ds(e)),e=jf.utils.decode(1200,e.slice(2),"str"),n.type="binary",JC(e,n)}function X7(t){return t.match(/[^\x00-\x7F]/)?wf(t):t}function kb(t,n,e,s){return s?(e.type="string",$f.to_workbook(t,e)):$f.to_workbook(n,e)}function Bh(t,n){Sw();var e=n||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Bh(new Uint8Array(t),(e=la(e),e.type="array",e));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var s=t,i=[0,0,0,0],d=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),Du={},e.dateNF&&(Du.dateNF=e.dateNF),e.type||(e.type=fr&&Buffer.isBuffer(t)?"buffer":"base64"),e.type=="file"&&(e.type=fr?"buffer":"binary",s=UL(t),typeof Uint8Array<"u"&&!fr&&(e.type="array")),e.type=="string"&&(d=!0,e.type="binary",e.codepage=65001,s=X7(t)),e.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),f=new Uint8Array(c);if(f.foo="bar",!f.foo)return e=la(e),e.type="array",Bh(lN(s),e)}switch((i=TN(s,e))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return B7(vr.read(s,e),e);break;case 9:if(i[1]<=8)return GC(s,e);break;case 60:return Wb(s,e);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return Nj(s,e);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return xj.to_workbook(s,e);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?H7(s,e):kb(t,s,e,d);case 239:return i[3]===60?Wb(s,e):kb(t,s,e,d);case 255:if(i[1]===254)return z7(s,e);if(i[1]===0&&i[2]===2&&i[3]===0)return Pf.to_workbook(s,e);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Pf.to_workbook(s,e);break;case 3:case 131:case 139:case 140:return yE.to_workbook(s,e);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return Jj.to_workbook(s,e);break;case 10:case 13:case 32:return W7(s,e);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return vj.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?yE.to_workbook(s,e):kb(t,s,e,d)}function G7(t,n,e,s,i,d,c,f){var p=ca(e),g=f.defval,x=f.raw||!Object.prototype.hasOwnProperty.call(f,"raw"),b=!0,E=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(E,"__rowNum__",{value:e,enumerable:!1})}catch{E.__rowNum__=e}else E.__rowNum__=e;if(!c||t[e])for(var w=n.s.c;w<=n.e.c;++w){var R=c?t[e][w]:t[s[w]+p];if(R===void 0||R.t===void 0){if(g===void 0)continue;d[w]!=null&&(E[d[w]]=g);continue}var y=R.v;switch(R.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+R.t)}if(d[w]!=null){if(y==null)if(R.t=="e"&&y===null)E[d[w]]=null;else if(g!==void 0)E[d[w]]=g;else if(x&&y===null)E[d[w]]=null;else continue;else E[d[w]]=x&&(R.t!=="n"||R.t==="n"&&f.rawNumbers!==!1)?y:po(R,y,f);y!=null&&(b=!1)}}return{row:E,isempty:b}}function Yb(t,n){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},s=0,i=1,d=[],c=0,f="",p={s:{r:0,c:0},e:{r:0,c:0}},g=n||{},x=g.range!=null?g.range:t["!ref"];switch(g.header===1?s=1:g.header==="A"?s=2:Array.isArray(g.header)?s=3:g.header==null&&(s=0),typeof x){case"string":p=tn(x);break;case"number":p=tn(t["!ref"]),p.s.r=x;break;default:p=x}s>0&&(i=0);var b=ca(p.s.r),E=[],w=[],R=0,y=0,U=Array.isArray(t),q=p.s.r,G=0,_={};U&&!t[q]&&(t[q]=[]);var ne=g.skipHidden&&t["!cols"]||[],ee=g.skipHidden&&t["!rows"]||[];for(G=p.s.c;G<=p.e.c;++G)if(!(ne[G]||{}).hidden)switch(E[G]=Pn(G),e=U?t[q][G]:t[E[G]+b],s){case 1:d[G]=G-p.s.c;break;case 2:d[G]=E[G];break;case 3:d[G]=g.header[G-p.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),f=c=po(e,null,g),y=_[c]||0,!y)_[c]=1;else{do f=c+"_"+y++;while(_[f]);_[c]=y,_[f]=1}d[G]=f}for(q=p.s.r+i;q<=p.e.r;++q)if(!(ee[q]||{}).hidden){var Q=G7(t,p,q,E,s,d,U,g);(Q.isempty===!1||(s===1?g.blankrows!==!1:g.blankrows))&&(w[R++]=Q.row)}return w.length=R,w}var FE=/"/g;function Y7(t,n,e,s,i,d,c,f){for(var p=!0,g=[],x="",b=ca(e),E=n.s.c;E<=n.e.c;++E)if(s[E]){var w=f.dense?(t[e]||[])[E]:t[s[E]+b];if(w==null)x="";else if(w.v!=null){p=!1,x=""+(f.rawNumbers&&w.t=="n"?w.v:po(w,null,f));for(var R=0,y=0;R!==x.length;++R)if((y=x.charCodeAt(R))===i||y===d||y===34||f.forceQuotes){x='"'+x.replace(FE,'""')+'"';break}x=="ID"&&(x='"ID"')}else w.f!=null&&!w.F?(p=!1,x="="+w.f,x.indexOf(",")>=0&&(x='"'+x.replace(FE,'""')+'"')):x="";g.push(x)}return f.blankrows===!1&&p?null:g.join(c)}function QC(t,n){var e=[],s=n??{};if(t==null||t["!ref"]==null)return"";var i=tn(t["!ref"]),d=s.FS!==void 0?s.FS:",",c=d.charCodeAt(0),f=s.RS!==void 0?s.RS:`
`,p=f.charCodeAt(0),g=new RegExp((d=="|"?"\\|":d)+"+$"),x="",b=[];s.dense=Array.isArray(t);for(var E=s.skipHidden&&t["!cols"]||[],w=s.skipHidden&&t["!rows"]||[],R=i.s.c;R<=i.e.c;++R)(E[R]||{}).hidden||(b[R]=Pn(R));for(var y=0,U=i.s.r;U<=i.e.r;++U)(w[U]||{}).hidden||(x=Y7(t,i,U,b,c,p,d,s),x!=null&&(s.strip&&(x=x.replace(g,"")),(x||s.blankrows!==!1)&&e.push((y++?f:"")+x)));return delete s.dense,e.join("")}function q7(t,n){n||(n={}),n.FS="	",n.RS=`
`;var e=QC(t,n);return e}function K7(t){var n="",e,s="";if(t==null||t["!ref"]==null)return[];var i=tn(t["!ref"]),d="",c=[],f,p=[],g=Array.isArray(t);for(f=i.s.c;f<=i.e.c;++f)c[f]=Pn(f);for(var x=i.s.r;x<=i.e.r;++x)for(d=ca(x),f=i.s.c;f<=i.e.c;++f)if(n=c[f]+d,e=g?(t[x]||[])[f]:t[n],s="",e!==void 0){if(e.F!=null){if(n=e.F,!e.f)continue;s=e.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(e.f!=null)s=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)s=""+e.v;else if(e.t=="b")s=e.v?"TRUE":"FALSE";else if(e.w!==void 0)s="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?s="'"+e.v:s=""+e.v}}p[p.length]=n+"="+s}return p}function ZC(t,n,e){var s=e||{},i=+!s.skipHeader,d=t||{},c=0,f=0;if(d&&s.origin!=null)if(typeof s.origin=="number")c=s.origin;else{var p=typeof s.origin=="string"?Va(s.origin):s.origin;c=p.r,f=p.c}var g,x={s:{c:0,r:0},e:{c:f,r:c+n.length-1+i}};if(d["!ref"]){var b=tn(d["!ref"]);x.e.c=Math.max(x.e.c,b.e.c),x.e.r=Math.max(x.e.r,b.e.r),c==-1&&(c=b.e.r+1,x.e.r=c+n.length-1+i)}else c==-1&&(c=0,x.e.r=n.length-1+i);var E=s.header||[],w=0;n.forEach(function(y,U){Ti(y).forEach(function(q){(w=E.indexOf(q))==-1&&(E[w=E.length]=q);var G=y[q],_="z",ne="",ee=Jt({c:f+w,r:c+U+i});g=zf(d,ee),G&&typeof G=="object"&&!(G instanceof Date)?d[ee]=G:(typeof G=="number"?_="n":typeof G=="boolean"?_="b":typeof G=="string"?_="s":G instanceof Date?(_="d",s.cellDates||(_="n",G=Ia(G)),ne=s.dateNF||Zt[14]):G===null&&s.nullError&&(_="e",G=0),g?(g.t=_,g.v=G,delete g.w,delete g.R,ne&&(g.z=ne)):d[ee]=g={t:_,v:G},ne&&(g.z=ne))})}),x.e.c=Math.max(x.e.c,f+E.length-1);var R=ca(c);if(i)for(w=0;w<E.length;++w)d[Pn(w+f)+R]={t:"s",v:E[w]};return d["!ref"]=gr(x),d}function J7(t,n){return ZC(null,t,n)}function zf(t,n,e){if(typeof n=="string"){if(Array.isArray(t)){var s=Va(n);return t[s.r]||(t[s.r]=[]),t[s.r][s.c]||(t[s.r][s.c]={t:"z"})}return t[n]||(t[n]={t:"z"})}return typeof n!="number"?zf(t,Jt(n)):zf(t,Jt({r:n,c:e||0}))}function Q7(t,n){if(typeof n=="number"){if(n>=0&&t.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var e=t.SheetNames.indexOf(n);if(e>-1)return e;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function _N(){return{SheetNames:[],Sheets:{}}}function PN(t,n,e,s){var i=1;if(!e)for(;i<=65535&&t.SheetNames.indexOf(e="Sheet"+i)!=-1;++i,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&t.SheetNames.indexOf(e)>=0){var d=e.match(/(^.*?)(\d+)$/);i=d&&+d[2]||0;var c=d&&d[1]||e;for(++i;i<=65535&&t.SheetNames.indexOf(e=c+i)!=-1;++i);}if(V8(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=n,e}function Z7(t,n,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var s=Q7(t,n);switch(t.Workbook.Sheets[s]||(t.Workbook.Sheets[s]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[s].Hidden=e}function e9(t,n){return t.z=n,t}function ek(t,n,e){return n?(t.l={Target:n},e&&(t.l.Tooltip=e)):delete t.l,t}function t9(t,n,e){return ek(t,"#"+n,e)}function r9(t,n,e){t.c||(t.c=[]),t.c.push({t:n,a:e||"SheetJS"})}function n9(t,n,e,s){for(var i=typeof n!="string"?n:tn(n),d=typeof n=="string"?n:gr(n),c=i.s.r;c<=i.e.r;++c)for(var f=i.s.c;f<=i.e.c;++f){var p=zf(t,c,f);p.t="n",p.F=d,delete p.v,c==i.s.r&&f==i.s.c&&(p.f=e,s&&(p.D=!0))}return t}var $E={encode_col:Pn,encode_row:ca,encode_cell:Jt,encode_range:gr,decode_col:gN,decode_row:vN,split_cell:pV,decode_cell:Va,decode_range:ku,format_cell:po,sheet_add_aoa:aC,sheet_add_json:ZC,sheet_add_dom:YC,aoa_to_sheet:Ru,json_to_sheet:J7,table_to_sheet:qC,table_to_book:N7,sheet_to_csv:QC,sheet_to_txt:q7,sheet_to_json:Yb,sheet_to_html:b7,sheet_to_formulae:K7,sheet_to_row_object_array:Yb,sheet_get_cell:zf,book_new:_N,book_append_sheet:PN,book_set_sheet_visibility:Z7,cell_set_number_format:e9,cell_set_hyperlink:ek,cell_set_internal_link:t9,cell_add_comment:r9,sheet_set_array_formula:n9,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const a9=({isOpen:t,onClose:n,onImport:e,onDeleteAll:s})=>{const[i,d]=I.useState(null),[c,f]=I.useState([]),[p,g]=I.useState(!1),[x,b]=I.useState(null),[E,w]=I.useState([]),[R,y]=I.useState(""),U=I.useRef(null),q=A=>{const W=A.target.files?.[0];W&&(d(W),b(null),f([]),w([]),y(""))},G=A=>{const W=Math.round(A*24*60*60),H=Math.floor(W/3600),K=Math.floor(W%3600/60),Oe=W%60;return`${H.toString().padStart(2,"0")}:${K.toString().padStart(2,"0")}:${Oe.toString().padStart(2,"0")}`},_=A=>{const W=A.toString().toLowerCase();let H=A,K=!1,Oe=!1;return(W.includes("ppt")||W.includes("powerpoint"))&&(K=!0,H=H.replace(/\+?\s*ppt\s*\+?/gi,"").replace(/\+?\s*powerpoint\s*\+?/gi,"")),(W.includes("q&a")||W.includes("qa"))&&(Oe=!0,H=H.replace(/\+?\s*q&a\s*\+?/gi,"").replace(/\s*\+\s*qa\s*\+?/gi,"")),H=H.replace(/^\++|\++$/g,"").replace(/\s*\+\s*/g," ").trim(),{shotType:H,hasPPT:K,hasQA:Oe}},ne=(A,W)=>{if(!A.trim())return null;const H=A.split(/\r?\n/).map(K=>K.trim()).filter(K=>K.length>0);if(H.length>=2){let K=H[0],Oe="Seat";K.startsWith("*P*")?(Oe="Podium",K=K.replace("*P*","").trim()):K.startsWith("*M*")?(Oe="Moderator",K=K.replace("*M*","").trim()):K.startsWith("*V*")&&(Oe="Virtual",K=K.replace("*V*","").trim());const ye=H[1];let Pe="",ve="";for(let ie=H.length-1;ie>=2;ie--){const Ee=H[ie];if(Ee&&[/^https?:\/\/.+/i,/^www\..+/i,/^[a-zA-Z0-9-]+\.[a-zA-Z]{2,}/i,/^\/.+\.(jpg|jpeg|png|gif|webp)$/i,/^.+\/(.+)\.(jpg|jpeg|png|gif|webp)$/i].some(X=>X.test(Ee))){let X=Ee.trim();!X.startsWith("http://")&&!X.startsWith("https://")&&(X.startsWith("www.")||X.includes(".")&&!X.startsWith("/"))&&(X="https://"+X),Pe=X,ie>2&&H[ie-1]&&(ve=H[ie-1]);break}}if(!Pe&&H.length>2){for(let ie=2;ie<H.length;ie++){const Ee=H[ie];if(Ee&&(Ee.includes(".jpg")||Ee.includes(".jpeg")||Ee.includes(".png")||Ee.includes(".gif")||Ee.includes(".webp")||Ee.includes("http")||Ee.includes("www.")||Ee.includes(".")&&Ee.length>10)){let Ce=Ee.trim();!Ce.startsWith("http://")&&!Ce.startsWith("https://")&&(Ce.startsWith("www.")||Ce.includes(".")&&!Ce.startsWith("/"))&&(Ce="https://"+Ce),Pe=Ce;break}}Pe||(H.length===3||H.length>3)&&(ve=H[2])}return{id:`speaker-${W}`,slot:W,location:Oe,fullName:K,title:ye,org:ve,photoUrl:Pe}}return null},ee=async()=>{if(i){g(!0),b(null);try{const A=await i.arrayBuffer(),W=Bh(A),H=W.SheetNames;if(w(H),H.length>1){y(H[0]),f([]);return}const K=H[0],Oe=W.Sheets[K],ye=$E.sheet_to_json(Oe,{header:1});if(ye.length<12)throw new Error("Excel file must have at least 12 rows. Headers should be in row 11, data should start from row 12.");const Pe=ye[10];if(!Pe||Pe.length===0)throw new Error("No headers found in row 11. Please ensure headers are in row 11.");const ve=[];for(let Ge=11;Ge<ye.length;Ge++){const ie=ye[Ge];if(!ie||ie.length===0)continue;const Ee={row:Ge-10,cue:"",segmentName:"",duration:"",shotType:"",hasPPT:!1,hasQA:!1,programType:"",notes:"",assets:"",speakers:""};if(ie[0]&&(Ee.cue=ie[0].toString()),ie[2]){let j=ie[2].toString();j.toLowerCase()==="pod transition"&&(j="Podium Transition"),Ee.programType=j}if(ie[3]){const j=ie[3];typeof j=="number"&&j<1?Ee.duration=G(j):Ee.duration=j.toString()}if(ie[9]&&(Ee.segmentName=ie[9].toString()),ie[10]){const j=ie[10].toString(),{shotType:X,hasPPT:T,hasQA:O}=_(j);Ee.shotType=X,Ee.hasPPT=T,Ee.hasQA=O}ie[11]&&(Ee.notes=ie[11].toString()),ie[13]&&(Ee.assets=ie[13].toString());const Ce=[];for(let j=21;j<=27;j++)if(ie[j]){const X=ie[j].toString().trim();if(X&&X.length>0&&X!==""){const T=j-20,O=ne(X,T);O&&O.fullName&&O.fullName.trim()!==""&&Ce.push(O)}}Ce.length>0&&(Ee.speakers=JSON.stringify(Ce)),ve.push(Ee)}f(ve),console.log(" Excel parsing completed:",ve.length,"rows")}catch(A){console.error(" Error parsing Excel:",A),b(A instanceof Error?A.message:"Failed to parse Excel file")}finally{g(!1)}}},Q=async()=>{if(!(!i||!R)){g(!0),b(null);try{const A=await i.arrayBuffer(),H=Bh(A).Sheets[R],K=$E.sheet_to_json(H,{header:1});if(K.length<12)throw new Error("Excel file must have at least 12 rows. Headers should be in row 11, data should start from row 12.");const Oe=K[10];if(!Oe||Oe.length===0)throw new Error("No headers found in row 11. Please ensure headers are in row 11.");const ye=[];for(let Pe=11;Pe<K.length;Pe++){const ve=K[Pe];if(!ve||ve.length===0)continue;const Ge={row:Pe-10,cue:"",segmentName:"",duration:"",shotType:"",hasPPT:!1,hasQA:!1,programType:"",notes:"",assets:"",speakers:""};if(ve[0]&&(Ge.cue=ve[0].toString()),ve[2]){let Ee=ve[2].toString();Ee.toLowerCase()==="pod transition"&&(Ee="Podium Transition"),Ge.programType=Ee}if(ve[3]){const Ee=ve[3];typeof Ee=="number"&&Ee<1?Ge.duration=G(Ee):Ge.duration=Ee.toString()}if(ve[9]&&(Ge.segmentName=ve[9].toString()),ve[10]){const Ee=ve[10].toString(),{shotType:Ce,hasPPT:j,hasQA:X}=_(Ee);Ge.shotType=Ce,Ge.hasPPT=j,Ge.hasQA=X}ve[11]&&(Ge.notes=ve[11].toString()),ve[13]&&(Ge.assets=ve[13].toString());const ie=[];for(let Ee=21;Ee<=27;Ee++)if(ve[Ee]){const Ce=ve[Ee].toString().trim();if(Ce&&Ce.length>0&&Ce!==""){const j=Ee-20,X=ne(Ce,j);X&&X.fullName&&X.fullName.trim()!==""&&ie.push(X)}}ie.length>0&&(Ge.speakers=JSON.stringify(ie)),ye.push(Ge)}f(ye),console.log(" Excel parsing completed:",ye.length,"rows")}catch(A){console.error(" Error parsing Excel:",A),b(A instanceof Error?A.message:"Failed to parse Excel file")}finally{g(!1)}}},z=()=>{c.length!==0&&(e(c),n())},ce=()=>{window.confirm("Are you sure you want to delete ALL existing schedule items? This action cannot be undone.")&&s()},S=()=>{d(null),f([]),b(null),w([]),y(""),n()};return t?l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg p-6 w-full max-w-4xl max-h-[80vh] overflow-y-auto",children:[l.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[l.jsxDEV("h2",{className:"text-xl font-bold text-white",children:"Import Excel File"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:475,columnNumber:11},void 0),l.jsxDEV("button",{onClick:S,className:"text-gray-400 hover:text-white text-2xl",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:476,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:474,columnNumber:9},void 0),l.jsxDEV("div",{className:"space-y-4",children:[c.length===0&&l.jsxDEV("div",{className:"bg-red-900/20 border border-red-600 rounded-md p-4",children:l.jsxDEV("div",{className:"flex items-center justify-between",children:[l.jsxDEV("div",{children:[l.jsxDEV("h3",{className:"text-red-400 font-semibold mb-1",children:"Clear Existing Data"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:490,columnNumber:19},void 0),l.jsxDEV("p",{className:"text-gray-300 text-sm",children:"Delete all existing schedule items before importing new data"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:491,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:489,columnNumber:17},void 0),l.jsxDEV("button",{onClick:ce,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-md transition-colors",children:"Delete All Rows"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:493,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:488,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:487,columnNumber:13},void 0),c.length===0&&l.jsxDEV("div",{className:"bg-slate-700 p-4 rounded-md",children:[l.jsxDEV("h3",{className:"text-white font-semibold mb-2",children:"Excel File Format Requirements:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:506,columnNumber:15},void 0),l.jsxDEV("ul",{className:"text-gray-300 text-sm space-y-1",children:[l.jsxDEV("li",{children:" Headers should be in row 11, data should start from row 12"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:508,columnNumber:17},void 0),l.jsxDEV("li",{children:" Expected columns: A=CUE, C=Program Type, D=Duration, J=Segment Name, K=Shot Type+PPT+QA, L=Notes, N=Assets, V-AB=Speakers"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:509,columnNumber:17},void 0),l.jsxDEV("li",{children:' "Pod Transition" will be converted to "Podium Transition"'},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:510,columnNumber:17},void 0),l.jsxDEV("li",{children:" Excel decimal time format (0.002083...) will be converted to HH:MM:SS"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:511,columnNumber:17},void 0),l.jsxDEV("li",{children:" Speaker format: Name, Title, [Org], Photo URL (with line breaks). Use *P* (Podium), *M* (Moderator), *V* (Virtual) prefixes"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:512,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:507,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:505,columnNumber:13},void 0),c.length===0&&l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Select Excel File (.xlsx, .xls)"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:520,columnNumber:15},void 0),l.jsxDEV("input",{ref:U,type:"file",accept:".xlsx,.xls",onChange:q,className:"block w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:523,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:519,columnNumber:13},void 0),i&&c.length===0&&l.jsxDEV("div",{className:"bg-slate-700 p-3 rounded-md",children:[l.jsxDEV("p",{className:"text-white text-sm",children:[l.jsxDEV("strong",{children:"Selected file:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:537,columnNumber:17},void 0)," ",i.name]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:536,columnNumber:15},void 0),l.jsxDEV("p",{className:"text-gray-300 text-sm",children:[l.jsxDEV("strong",{children:"Size:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:540,columnNumber:17},void 0)," ",(i.size/1024).toFixed(2)," KB"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:539,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:535,columnNumber:13},void 0),E.length>1&&c.length===0&&l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:["Select Sheet (",E.length," sheets found)"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:548,columnNumber:15},void 0),l.jsxDEV("select",{value:R,onChange:A=>y(A.target.value),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:E.map(A=>l.jsxDEV("option",{value:A,children:A},A,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:557,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:551,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:547,columnNumber:13},void 0),c.length===0&&l.jsxDEV("div",{className:"flex justify-center gap-4",children:[l.jsxDEV("button",{onClick:E.length>1?Q:ee,disabled:!i||p||E.length>1&&!R,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-medium rounded-md transition-colors",children:p?"Parsing...":"Parse Excel File"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:568,columnNumber:15},void 0),l.jsxDEV("button",{onClick:S,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-md transition-colors",children:"Cancel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:575,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:567,columnNumber:13},void 0),x&&l.jsxDEV("div",{className:"bg-red-600 text-white p-3 rounded-md",children:[l.jsxDEV("strong",{children:"Error:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:587,columnNumber:15},void 0)," ",x]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:586,columnNumber:13},void 0),c.length>0&&l.jsxDEV("div",{children:[l.jsxDEV("h3",{className:"text-lg font-semibold text-white mb-3",children:["Preview (",c.length," rows found)"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:594,columnNumber:15},void 0),l.jsxDEV("div",{className:"border border-slate-600 rounded-md bg-slate-700 max-h-96 overflow-auto",children:l.jsxDEV("table",{className:"w-full",children:[l.jsxDEV("thead",{className:"sticky top-0 bg-slate-600",children:l.jsxDEV("tr",{children:[l.jsxDEV("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Row"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:603,columnNumber:23},void 0),l.jsxDEV("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"CUE"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:604,columnNumber:23},void 0),l.jsxDEV("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Segment Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:605,columnNumber:23},void 0),l.jsxDEV("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Duration"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:606,columnNumber:23},void 0),l.jsxDEV("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Shot Type"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:607,columnNumber:23},void 0),l.jsxDEV("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"PPT/QA"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:608,columnNumber:23},void 0),l.jsxDEV("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Program Type"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:609,columnNumber:23},void 0),l.jsxDEV("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Notes"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:610,columnNumber:23},void 0),l.jsxDEV("th",{className:"px-3 py-2 text-left text-white text-sm border-r border-slate-500",children:"Assets"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:611,columnNumber:23},void 0),l.jsxDEV("th",{className:"px-3 py-2 text-left text-white text-sm",children:"Speakers"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:612,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:602,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:601,columnNumber:19},void 0),l.jsxDEV("tbody",{children:c.map((A,W)=>l.jsxDEV("tr",{className:"border-t border-slate-600 hover:bg-slate-600",children:[l.jsxDEV("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:A.row},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:618,columnNumber:25},void 0),l.jsxDEV("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:A.cue},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:619,columnNumber:25},void 0),l.jsxDEV("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:A.segmentName},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:620,columnNumber:25},void 0),l.jsxDEV("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:A.duration},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:621,columnNumber:25},void 0),l.jsxDEV("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:A.shotType},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:622,columnNumber:25},void 0),l.jsxDEV("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:[A.hasPPT&&"PPT ",A.hasQA&&"QA",!A.hasPPT&&!A.hasQA&&"-"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:623,columnNumber:25},void 0),l.jsxDEV("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:A.programType},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:628,columnNumber:25},void 0),l.jsxDEV("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:A.notes?A.notes.length>30?`${A.notes.substring(0,30)}...`:A.notes:"None"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:629,columnNumber:25},void 0),l.jsxDEV("td",{className:"px-3 py-2 text-white text-sm border-r border-slate-500",children:A.assets?A.assets.length>30?`${A.assets.substring(0,30)}...`:A.assets:"None"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:632,columnNumber:25},void 0),l.jsxDEV("td",{className:"px-3 py-2 text-white text-sm",children:A.speakers?(()=>{try{const H=JSON.parse(A.speakers);return H.length>0?l.jsxDEV("div",{className:"space-y-1",children:[l.jsxDEV("div",{className:"font-medium",children:[H.length," speaker(s)"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:642,columnNumber:37},void 0),H.map((K,Oe)=>l.jsxDEV("div",{className:"text-xs text-gray-300",children:[l.jsxDEV("div",{children:[" ",K.fullName," (",K.location,")"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:645,columnNumber:41},void 0),l.jsxDEV("div",{className:"text-gray-400",children:["  ",K.title]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:646,columnNumber:41},void 0),K.org&&l.jsxDEV("div",{className:"text-gray-400",children:["  ",K.org]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:647,columnNumber:57},void 0),K.photoUrl&&l.jsxDEV("div",{className:"text-blue-300 text-xs truncate max-w-xs",children:[" ",K.photoUrl.length>40?`${K.photoUrl.substring(0,40)}...`:K.photoUrl]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:649,columnNumber:43},void 0)]},Oe,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:644,columnNumber:39},void 0))]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:641,columnNumber:35},void 0):"None"}catch{return"None"}})():"None"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:635,columnNumber:25},void 0)]},W,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:617,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:615,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:600,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:599,columnNumber:15},void 0),l.jsxDEV("div",{className:"flex justify-center gap-4 mt-4",children:[l.jsxDEV("button",{onClick:z,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-md transition-colors",children:["Import ",c.length," Items"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:672,columnNumber:17},void 0),l.jsxDEV("button",{onClick:()=>{d(null),f([]),b(null),U.current&&(U.current.value="")},className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:"Import Another File"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:678,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:671,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:593,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:484,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:473,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/ExcelImportModal.tsx",lineNumber:472,columnNumber:5},void 0):null},s9=()=>{const t=Oa(),n=fl();let e=t.state?.event,s=t.state?.userRole;const{user:i,loading:d}=ic(),[c,f]=I.useState("VIEWER"),[p,g]=I.useState(!1),[x,b]=I.useState(!1),[E,w]=I.useState([]),[R,y]=I.useState([]),[U,q]=I.useState(!1),[G,_]=I.useState(new Map),ne=I.useRef(new Map),ee=I.useRef(new Set),Q=(h,C,D)=>{if(c!=="EDITOR"&&c!=="OPERATOR"||!i||!e?.id){console.log(" Not logging change - missing requirements:",{role:c,user:!!i,event:!!e?.id});return}let V=C,re,ue;D?.itemId&&(re=S.findIndex(Fe=>Fe.id===D.itemId)+1,ue=S.find(Fe=>Fe.id===D.itemId)?.customFields?.cue||"CUE",V=`ROW ${re} - ${nn(ue)}: ${C}`),Bn.addChange({eventId:e.id,userId:i.id,userName:i.full_name||i.email||"Unknown",userRole:c,action:h,description:V,details:D,rowNumber:re,cueNumber:ue,segmentName:D?.itemName||D?.segmentName});const be=Bn.getLocalChanges();w(be.slice(0,100)),console.log(" Change logged to buffer:",V)},z=(h,C,D,V)=>{if(c!=="EDITOR"&&c!=="OPERATOR"){console.log(" Not logging change - user role is not EDITOR or OPERATOR:",c);return}const re=V?.fieldName?.includes("Name")||V?.fieldName?.includes("segmentName")||V?.fieldName?.includes("cue")||V?.fieldName?.includes("custom"),ue=re?`text_${V?.itemId}_${V?.fieldName}`:h,be=ne.current.get(ue);be&&(clearTimeout(be),ne.current.delete(ue)),_(nt=>{const mt=new Map(nt);for(const[Pt,$t]of mt.entries())$t.originalKey===ue&&mt.delete(Pt);return mt});let ke=D,Fe={...V};if(V?.itemId){const nt=S.findIndex($t=>$t.id===V.itemId)+1,Pt=S.find($t=>$t.id===V.itemId)?.customFields?.cue||"CUE";ke=`ROW ${nt} - ${nn(Pt)}: ${D}`,Fe={...V,rowNumber:nt,cueNumber:Pt}}if(re)_(nt=>{const mt=new Map(nt);for(const[$t,Kr]of mt.entries())Kr.originalKey===ue&&mt.delete($t);const Pt=`${ue}_${Date.now()}`;return mt.set(Pt,{action:C,description:ke,details:Fe,timestamp:new Date,user:i?.full_name||i?.email||"Unknown User",originalKey:ue}),console.log(" Updated text field pending change:",Pt,"for baseKey:",ue),console.log(" Total pending changes:",mt.size),console.log(" Pending change details:",{action:C,description:ke,baseKey:ue,uniqueKey:Pt}),mt});else{const nt=`${ue}_${Date.now()}`;_(mt=>{const Pt=new Map(mt.set(nt,{action:C,description:ke,details:Fe,timestamp:new Date,user:i?.full_name||i?.email||"Unknown User",originalKey:ue}));return console.log(" Added pending change:",nt,"for baseKey:",ue),console.log(" Total pending changes:",Pt.size),console.log(" Pending change details:",{action:C,description:ke,baseKey:ue,uniqueKey:nt}),Pt})}const qe=setTimeout(async()=>{console.log(" TIMEOUT FIRED for baseKey:",ue),_(nt=>{let mt=null,Pt=null;console.log(" TIMEOUT: Looking for baseKey:",ue),console.log(" TIMEOUT: Available pending changes:",Array.from(nt.entries()).map(([Kr,Jr])=>({key:Kr,originalKey:Jr.originalKey})));for(const[Kr,Jr]of nt.entries())if(Jr.originalKey===ue){mt=Jr,Pt=Kr,console.log(" TIMEOUT: Found match - key:",Kr,"originalKey:",Jr.originalKey);break}console.log(" TIMEOUT: Found pending change:",mt?"YES":"NO"),console.log(" TIMEOUT: Change key:",Pt),console.log(" TIMEOUT: Has change key in prev:",nt.has(Pt||""));const $t=`${ue}-${mt?.timestamp?.getTime()||Date.now()}`;if(console.log(" TIMEOUT: Change ID:",$t),console.log(" TIMEOUT: Already processed:",ee.current.has($t)),mt&&Pt&&nt.has(Pt)&&i&&e?.id&&!ee.current.has($t)){console.log(" TIMEOUT: Processing change..."),ee.current.add($t);const Kr={eventId:e.id,userId:i.id,userName:i.full_name||i.email||"Unknown",userRole:c||"VIEWER",action:mt?.action||"unknown",description:mt?.description||"unknown",details:mt?.details||{},rowNumber:mt?.details?.rowNumber,cueNumber:mt?.details?.cueNumber,segmentName:mt?.details?.itemName||mt?.details?.segmentName};console.log(" Adding change to service:",Kr),Bn.addChange(Kr);const Jr=Bn.getLocalChanges();console.log(" Local changes after adding to service:",Jr.length),console.log(" Latest change:",Jr[Jr.length-1]),console.log(" Current changeLog state length:",E.length),w(Jr.slice(0,100)),console.log(" Set changeLog to:",Jr.slice(0,100).length,"changes"),console.log(" Debounced change logged to change log service:",mt?.description||"unknown"),console.log(" Removed pending change from queue:",Pt),console.log(" Auto-syncing changes after timeout... (with 3s additional delay)"),setTimeout(()=>{ju().then(()=>{console.log(" Auto-sync completed after timeout + 3s delay"),rr(!0),console.log(" Set skipNextSync flag to prevent false reset")}).catch($a=>{console.error(" Auto-sync failed after timeout + 3s delay:",$a)})},3e3),ne.current.delete(ue);const Za=new Map(nt);return Za.delete(Pt),console.log(" Pending changes after removal:",Za.size),console.log(" Remaining pending keys:",Array.from(Za.keys())),Za}else{ne.current.delete(ue),ee.current.has($t)?console.log(" Prevented duplicate processing of change:",$t):console.log(" Pending change already processed or removed:",ue);const Kr=Date.now(),Jr=new Map(nt);let Za=0;for(const[$a,zu]of Jr.entries()){const Is=Kr-zu.timestamp.getTime();Is>15e3&&(console.log(" Removing stale pending change:",$a,"age:",Is+"ms"),Jr.delete($a),Za++)}return Za>0?(console.log(" Removed",Za,"stale pending changes"),Jr):nt}})},5e3);ne.current.set(ue,qe),console.log(" Set timeout for baseKey:",ue,"in",5e3,"ms"),console.log(" Total active timeouts:",ne.current.size)},ce=async()=>{console.log(" Finalizing all pending changes...");const h=Array.from(G.entries());if(h.length===0){console.log(" No pending changes to finalize");return}ne.current.forEach(V=>{clearTimeout(V)}),ne.current.clear(),console.log(` Processing ${h.length} pending changes immediately...`);const C=new Set;for(const[V,re]of h)if(re&&i&&e?.id){const ue=`${re.originalKey||V}-${re.timestamp.getTime()}`;if(ee.current.has(ue)){console.log(" Skipping already processed change:",ue);continue}ee.current.add(ue),C.add(ue);let be=re.description,ke,Fe;re.details?.itemId&&(ke=S.findIndex(nt=>nt.id===re.details.itemId)+1,Fe=S.find(nt=>nt.id===re.details.itemId)?.customFields?.cue||"CUE",be=`ROW ${ke} - ${nn(Fe)}: ${re.description}`),Bn.addChange({eventId:e.id,userId:i.id,userName:i.full_name||i.email||"Unknown",userRole:c||"VIEWER",action:re.action,description:be,details:re.details,rowNumber:ke,cueNumber:Fe,segmentName:re.details?.itemName||re.details?.segmentName}),console.log(" Processed pending change immediately:",be)}_(new Map);const D=Bn.getLocalChanges();w(D.slice(0,100)),console.log(` All ${C.size} pending changes processed immediately`),console.log(" Auto-syncing changes after manual finalization...");try{await ju(),console.log(" Auto-sync completed after manual finalization")}catch(V){console.error(" Auto-sync failed after manual finalization:",V)}setTimeout(()=>{C.forEach(V=>{ee.current.delete(V)}),console.log(" Cleaned up processed change tracking for",C.size,"changes")},6e4)};if(I.useEffect(()=>()=>{ne.current.forEach(h=>clearTimeout(h))},[]),I.useEffect(()=>{const h=setInterval(()=>{_(C=>{const D=Date.now(),V=new Map(C);let re=0;for(const[ue,be]of V.entries()){const ke=D-be.timestamp.getTime();ke>2e4&&(console.log(" Periodic cleanup: Removing stale pending change:",ue,"age:",ke+"ms"),V.delete(ue),re++)}return re>0&&console.log(" Periodic cleanup: Removed",re,"stale pending changes"),V})},5e3);return()=>clearInterval(h)},[]),I.useEffect(()=>{const h=Bn.getChangesCount().unsynced;Le(h)},[E,G]),!e){const h=localStorage.getItem("events");if(h){const C=JSON.parse(h);e=C[C.length-1]}}Math.random()<.01&&(console.log("Event from location.state:",t.state?.event),console.log("Final event data:",e));const[S,A]=I.useState([]),[W,H]=I.useState([]),[K,Oe]=I.useState(e?.name||""),[ye,Pe]=I.useState(""),[ve,Ge]=I.useState({}),[ie,Ee]=I.useState(1),[Ce,j]=I.useState(null),[X,T]=I.useState(!1),[O,P]=I.useState({show:!1}),[F,de]=I.useState(!1),[fe,ge]=I.useState(!1),[ze,oe]=I.useState(null),[Tt,ft]=I.useState(!1),[xt,Dt]=I.useState(!1),[Ke,er]=I.useState(null),[wr,ur]=I.useState(!1),[ar,Ve]=I.useState(null),[Xe,he]=I.useState([]),[Be,Qe]=I.useState(!1),[vt,St]=I.useState(null),[tr,$e]=I.useState(!1),[tt,Ct]=I.useState(null),[Nt,Ot]=I.useState(!1),[kt,Ft]=I.useState(null),[Lt,Yt]=I.useState([]),[ct,nr]=I.useState({}),[rn,An]=I.useState({}),[Cr,gn]=I.useState({}),[ii,Lr]=I.useState({}),[Xr,qa]=I.useState({}),[qt,Ln]=I.useState(null),[xn,cn]=I.useState(null),[wa,Ts]=I.useState(!1),[pe,L]=I.useState(null),[Z,J]=I.useState(null),[Y,ae]=I.useState(null),[se,xe]=I.useState({}),[je,Se]=I.useState({}),[we,Re]=I.useState(new Set),[Ue,Ze]=I.useState({activeTimer:null}),[at,et]=I.useState({elapsed:0,total:0}),[lt,ot]=I.useState(null),[yr,ir]=I.useState({}),[Wr,Ar]=I.useState(!1),[Fr,Ka]=I.useState(null),[zn,_s]=I.useState(null),[Xn,Ai]=I.useState(!1),[fs,Ps]=I.useState(""),[xo,Ja]=I.useState(!1),[Li,ms]=I.useState(!1),[bo,oi]=I.useState(!1),[No,Do]=I.useState(!1),[Vi,ji]=I.useState(!1),[Tu,li]=I.useState(!1),[hl,So]=I.useState([]),[mr,pl]=I.useState({totalBackups:0,lastBackup:null,autoBackups:0,manualBackups:0}),[Us,jt]=I.useState(!1),[Gn,Vn]=I.useState(null),[Ca,ci]=I.useState(!0),[vl,un]=I.useState(null),[yt,Yn]=I.useState({start:!0,programType:!0,duration:!0,segmentName:!0,shotType:!0,pptQA:!0,notes:!0,assets:!0,participants:!1,speakers:!0,public:!0,custom:!0}),[qn,bn]=I.useState({}),[zt,_u]=I.useState({start:128,programType:224,duration:224,segmentName:320,shotType:192,pptQA:192,notes:384,assets:192,participants:256,speakers:384,public:128}),[ui,mc]=I.useState({}),[Kn,Ii]=I.useState(!1);I.useEffect(()=>{const h=localStorage.getItem(`followEnabled_${e?.id}`);h!==null&&Ii(h==="true")},[e?.id]),I.useEffect(()=>{localStorage.setItem(`followEnabled_${e?.id}`,Kn.toString())},[Kn,e?.id]),I.useEffect(()=>{if(Kn&&Y){const h=localStorage.getItem(`scrollPosition_${e?.id}`);if(h){const C=parseInt(h);setTimeout(()=>{window.scrollTo({top:C,behavior:"smooth"})},100)}}},[Y,Kn,e?.id]);const[hc,Nn]=I.useState(new Set),nn=h=>h?h.includes("CUE ")?h:h.match(/^CUE\d+$/)?h.replace(/^CUE(\d+)$/,"CUE $1"):`CUE ${h}`:"CUE",[yo,jn]=I.useState(new Set),[Mi,Ma]=I.useState(null),[Oo,Pu]=I.useState(!1),[pc,hs]=I.useState(!1),[As,B]=I.useState(!0),[me,Le]=I.useState(0),[Me,st]=I.useState(null),[_t,Et]=I.useState(0),[Mt,rr]=I.useState(!1),[Gt,xr]=I.useState(!1),[br,Kt]=I.useState(null),[jr,$r]=I.useState(20),[Fi,di]=I.useState(!1),ua=I.useRef(null),Pr=()=>{console.log(" User started editing - pausing sync"),xr(!0),br&&clearTimeout(br);const h=setTimeout(()=>{console.log(" User stopped editing - resuming sync"),xr(!1),Eo()},5e3);Kt(h)},Dn=()=>{console.log(" Modal opened - pausing sync until closed"),xr(!0),br&&(clearTimeout(br),Kt(null))},Eo=I.useCallback(()=>{ua.current&&clearInterval(ua.current),$r(20),di(!1);const h=setInterval(()=>{$r(C=>C<=1?(console.log(" Countdown sync: Triggering WebSocket sync request"),di(!0),_r&&e?.id&&(_r.emitSyncRequest(),console.log(" Countdown sync: Emitted sync request via WebSocket")),setTimeout(()=>{di(!1),$r(20)},3e3),0):C-1)},1e3);ua.current=h},[_r,e?.id]),gl=I.useCallback(()=>{ua.current&&(clearInterval(ua.current),ua.current=null),$r(20),di(!1)},[]),Sn=()=>{console.log(" Modal closed - resuming sync in 5 seconds");const h=setTimeout(()=>{console.log(" User stopped editing - resuming sync"),xr(!1),Eo()},5e3);Kt(h)};I.useEffect(()=>{if(d){console.log(" Authentication still loading, waiting...");return}i&&e?.id?(async()=>{try{console.log(" Loading role from API for user:",i.id,"event:",e.id);const C=await it.getCurrentUserSession(i.id,e.id);if(console.log(" User session from API:",C),C&&C.event_id===e.id&&C.role)return f(C.role),console.log(" Loaded role from localStorage:",C.role),localStorage.setItem(`userRole_${e.id}`,C.role),console.log(" Updated localStorage with role:",C.role),!0;console.log(" No valid role found in localStorage:",{hasSession:!!C,eventIdMatch:C?.event_id===e.id,hasRole:!!C?.role,userSessionEventId:C?.event_id,currentEventId:e.id,userRole:C?.role})}catch(C){console.log(" Failed to load role from API:",C)}return!1})().then(C=>{if(C){console.log(" Using role from API");return}if(s&&["VIEWER","EDITOR","OPERATOR"].includes(s)){f(s),it.saveUserSession(e.id,i.id,i.full_name||i.email||"Unknown",s).then(ue=>{ue?console.log(" Role saved to API from navigation state:",s):console.log(" Failed to save role to API, using localStorage only")}),localStorage.setItem(`userRole_${e.id}`,s),console.log(" Saved role to localStorage:",s),console.log(" Using role from navigation state (no API role found):",s);return}const D=localStorage.getItem(`userRole_${e.id}`);if(console.log(" Checking localStorage for role:",{eventId:e.id,savedRole:D}),D&&["VIEWER","EDITOR","OPERATOR"].includes(D)){f(D),console.log(" Using role from localStorage fallback:",D),it.saveUserSession(e.id,i.id,i.full_name||i.email||"Unknown",D).then(ue=>{ue?console.log(" Role synced to API from localStorage:",D):console.log(" Failed to sync role to API, keeping localStorage only")});return}const V=Object.keys(localStorage),re=V.filter(ue=>ue.startsWith("userRole_"));if(console.log(" Checking all localStorage role keys:",re),console.log(" Current event ID:",e.id),console.log(" All localStorage keys:",V),re.length>0){const ue=re[re.length-1],be=localStorage.getItem(ue);if(console.log(" Found latest role in localStorage:",{key:ue,role:be}),be&&["VIEWER","EDITOR","OPERATOR"].includes(be)){f(be),console.log(" Using latest role from localStorage:",be),localStorage.setItem(`userRole_${e.id}`,be),it.saveUserSession(e.id,i.id,i.full_name||i.email||"Unknown",be).then(ke=>{ke?console.log(" Role synced to API from latest localStorage:",be):console.log(" Failed to sync role to API, keeping localStorage only")});return}}console.log(" No role found, showing role selection modal"),g(!0)}):!i&&e?.id&&(console.log(" No user authenticated, defaulting to VIEWER role"),f("VIEWER"))},[i,e?.id,d,s,n]),I.useEffect(()=>{if(e?.id){console.log(" Loading change log data for event:",e.id),Bn.reloadLocalChanges();const h=Bn.getLocalChanges();w(h.slice(0,100)),console.log(" Loaded local changes:",h.length),Co(),Au(),Lu(),da(),bl(),Vs();const C=setInterval(()=>{const D=Bn.getLocalChanges();w(D.slice(0,100))},2e3);return()=>clearInterval(C)}},[e?.id]);const[r0,xl]=I.useState(!1),[vc,n0]=I.useState(null),[Uu,Jh]=I.useState(!1);I.useEffect(()=>{e?.id&&S.length>0&&!Uu&&(console.log(" Schedule loaded, checking for running timers for event:",e.id),qr(),Jh(!0))},[e?.id,S.length,Uu]);const Ls=async()=>{if(e?.id)try{const h=await Es.getCompletedCues(e.id);if(h){const C={};h.forEach(D=>{D.item_id&&(C[D.item_id]=!0)}),Lr(C),console.log(" Synced completed cues:",C)}}catch(h){console.warn(" Error syncing completed cues:",h)}},Qh=async()=>{if(e?.id)try{await bl()}catch(h){console.warn(" Error syncing sub-cue timers:",h)}};I.useEffect(()=>{e?.id&&Ls()},[e?.id]),I.useEffect(()=>{e?.id&&Qh()},[e?.id]),I.useEffect(()=>{if(!e?.id||!i?.id)return;(async()=>{try{const C=await Es.getActiveTimers(e.id);if(!C){console.warn(" No timer data found");return}const D=C?.[0];if(D&&D.user_id===i.id)return;if(D){const V=D.timer_state||"unknown",re=parseInt(D.item_id),ue=D.is_active,be=D.started_at;let ke=V;if((V==="unknown"||!V)&&(ue&&be?ke="running":ue?ke="loaded":ke="stopped"),ke==="running"){ae(re),ir(nt=>({...nt,[re]:!0})),nr(nt=>({...nt,[re]:!0}));const Fe=S.findIndex(nt=>nt.id===re),qe=new Set;if(Fe!==-1)for(let nt=Fe+1;nt<S.length&&S[nt].isIndented;nt++)qe.add(S[nt].id);jn(qe),Ma(re)}else if(ke==="loaded"){ae(re),ir(nt=>({...nt,[re]:!0})),nr({});const Fe=S.findIndex(nt=>nt.id===re),qe=new Set;if(Fe!==-1)for(let nt=Fe+1;nt<S.length&&S[nt].isIndented;nt++)qe.add(S[nt].id);jn(qe),Ma(re)}else ke==="stopped"&&(ae(null),ir({}),nr({}),jn(new Set),Ma(null))}else ae(null),ir({}),nr({}),jn(new Set),Ma(null)}catch(C){console.warn(" Top text sync error:",C)}})()},[e?.id,i?.id,S]),I.useEffect(()=>{if(!e?.id||!i)return;console.log(" Setting up real-time WebSocket sync with 5-second reliability check");const h=setInterval(()=>{console.log(" 5s reliability: Ensuring WebSocket updates are processed"),j(C=>C)},5e3);return()=>{console.log(" Cleaning up 5-second reliability check timer"),clearInterval(h)}},[e?.id,i?.id]),I.useEffect(()=>()=>{console.log(" Cleaning up on component unmount")},[]),I.useEffect(()=>{if(e?.id&&i?.id&&c&&c!=="VIEWER"){console.log(" Saving current role to API:",c);try{const h=i.full_name||i.email||"Unknown";it.saveUserSession(e.id,i.id,h,c),console.log(" Role saved to API:",c)}catch(h){console.error(" Failed to save role to API:",h)}}},[e?.id,i?.id,c]),I.useEffect(()=>()=>{if(e?.id&&i?.id&&c&&c!=="VIEWER"){console.log(" Saving current role to API before navigating away:",c);try{const h=i.full_name||i.email||"Unknown";it.saveUserSession(e.id,i.id,h,c),console.log(" Role saved to API on navigation away:",c)}catch(h){console.error(" Failed to save role to API on navigation away:",h)}}},[e?.id,i?.id,c]);const Au=async()=>{if(e?.id)try{console.log(" Loading completed cues from API for event:",e.id);const h=await it.getCompletedCues(e.id);if(h&&h.length>0){console.log(" Found completed cues:",h);const C={};h.forEach(D=>{if(D.item_id){if(Y&&D.item_id===Y){console.log(" Skipping currently loaded cue from completed cues:",D.item_id);return}C[D.item_id]=!0}}),Lr(C),console.log(" Set completedCues state:",C)}else console.log(" No completed cues found")}catch(h){console.error(" Error loading completed cues from API:",h),console.log(" This means the completed_cues table or functions need to be created first"),console.log(" Please check your Neon database setup")}},Lu=async()=>{if(e?.id)try{console.log(" Loading indented cues from API for event:",e.id);const h=await it.getIndentedCues(e.id);if(h&&h.length>0){console.log(" Found indented cues:",h);const C={};h.forEach(D=>{D.item_id&&D.parent_item_id&&(C[D.item_id]={parentId:D.parent_item_id,userId:D.user_id||"",userName:D.user_name||""})}),qa(C),console.log(" Set indentedCues state:",C)}else console.log(" No indented cues found"),qa({})}catch(h){console.error(" Error loading indented cues from API:",h),console.log(" This means the indented_cues table or functions need to be created first"),console.log(" Please check your Neon database setup")}},Vu=h=>{const C=S.findIndex(D=>D.id===h);if(C===-1)return null;for(let D=C-1;D>=0;D--){const V=S[D];if(!Xr[V.id])return V.id}return null},Zh=async h=>{if(!(!e?.id||!i?.id))try{if(Xr[h])console.log(" Removing indented status for item:",h),await it.unmarkCueIndented(e.id,h)&&(qa(D=>{const V={...D};return delete V[h],V}),console.log(" Successfully removed indented status"));else{const C=Vu(h);if(!C){console.log(" No parent cue found for item:",h);return}console.log(" Adding indented status for item:",h,"with parent:",C),await it.markCueIndented(e.id,h,C,i.id,i.name||"Unknown User",c||"VIEWER")&&(qa(V=>({...V,[h]:{parentId:C,userId:i.id,userName:i.name||"Unknown User"}})),console.log(" Successfully added indented status"))}}catch(C){console.error(" Error toggling indented status:",C)}};I.useCallback(()=>e?.id?(console.log(" Starting countdown sync for Browser B"),setInterval(async()=>{try{const C=await it.getActiveTimer(e.id);C&&C.timer_state==="running"&&C.started_at&&C.elapsed_seconds!==void 0&&C.duration_seconds!==void 0&&xe(D=>({...D,[C.item_id]:{elapsed:C.elapsed_seconds,total:C.duration_seconds,startedAt:new Date(C.started_at)}}))}catch(C){console.warn(" Failed to sync countdown from server:",C)}},1e3)):void 0,[e?.id]),I.useEffect(()=>{!e?.id||i?.id},[e?.id,i?.id]);const gc=async()=>{if(e?.id)try{console.log(" Checking for active timer in API for event:",e.id);const h=await it.getActiveTimer(e.id);if(console.log(" API response:",h),h){if(console.log(" Loading timer from API:",h),ae(h.item_id),ir(D=>({...D,[h.item_id]:!0})),h.timer_state==="running"){console.log(" Timer is running, setting up with server timing"),xe(V=>({...V,[h.item_id]:{elapsed:h.elapsed_seconds,total:h.duration_seconds,startedAt:new Date(h.started_at)}}));const D=setInterval(async()=>{try{const V=await it.getActiveTimer(e.id);V&&V.item_id===h.item_id&&xe(re=>({...re,[h.item_id]:{elapsed:V.elapsed_seconds,total:V.duration_seconds,startedAt:new Date(V.started_at)}}))}catch(V){console.warn(" Failed to sync timer from server:",V)}},1e3);An(V=>({...V,[h.item_id]:D}))}else h.timer_state==="loaded"&&(console.log(" Timer is loaded but not started"),xe(D=>({...D,[h.item_id]:{elapsed:0,total:h.duration_seconds,startedAt:null}})),Object.keys(ct).forEach(D=>{ct[parseInt(D)]&&clearInterval(rn[parseInt(D)])}),nr({}));if(S.find(D=>D.id===h.item_id)){const D=S.findIndex(re=>re.id===h.item_id),V=new Set;if(D!==-1)for(let re=D+1;re<S.length&&S[re].isIndented;re++)V.add(S[re].id);jn(V)}console.log(" Active timer loaded from API with accurate timing")}else{console.log(" No active timer found in API - checking for recently completed cues");let C=!0;try{const D=[];if(D&&D.length>0){console.log(" Found recent timer actions:",D);const V=D.filter(ue=>ue.action_type==="LOAD_CUE"&&new Date(ue.action_timestamp).getTime()>Date.now()-5e3);console.log(" Recent LOAD_CUE actions found:",V.length,V),V.length>0&&(console.log(" Recent LOAD_CUE action found, keeping local state"),C=!1);const re=D.filter(ue=>ue.action_type==="STOP_TIMER"&&new Date(ue.action_timestamp).getTime()>Date.now()-3e4);re.length>0&&(console.log(" Found recent stop actions, updating completed cues:",re),re.forEach(ue=>{if(ue.item_id){Lr(ke=>({...ke,[ue.item_id]:!0})),Nn(ke=>new Set([...ke,ue.item_id]));const be=S.findIndex(ke=>ke.id===ue.item_id);if(be!==-1)for(let ke=be+1;ke<S.length&&S[ke].isIndented;ke++)Lr(Fe=>({...Fe,[S[ke].id]:!0})),Nn(Fe=>new Set([...Fe,S[ke].id]))}}))}}catch(D){console.warn(" Failed to check for recent timer actions:",D)}C?(console.log(" No recent LOAD_CUE actions, clearing local timer state - activeItemId was:",Y),ae(null),ir({}),xe({}),Object.keys(ct).forEach(D=>{ct[parseInt(D)]&&clearInterval(rn[parseInt(D)])}),nr({})):console.log(" Recent LOAD_CUE action found, keeping local state - activeItemId:",Y)}}catch(h){console.error(" Error loading active timer from API:",h)}},bl=async()=>{e?.id},da=async()=>{if(e?.id)try{const{data:h,error:C}=await it.getActiveSubCueTimers(e.id);if(C){console.error(" Error loading sub-cue timers:",C);return}h&&h.length>0&&(console.log(" Loaded sub-cue timers from API:",h),console.log(" Setting up sub-cue timer states..."),h.forEach(D=>{const V=D.item_id,re=D.duration_seconds||0;if(console.log(` Setting up sub-cue timer for item ${V}:`,{elapsed:D.elapsed_seconds||0,total:re,startedAt:D.started_at?new Date(D.started_at):null,timer_state:D.timer_state}),Se(ue=>({...ue,[V]:{elapsed:D.elapsed_seconds||0,total:re,startedAt:D.started_at?new Date(D.started_at):null}})),D.timer_state==="running"){console.log(` Starting local timer interval for sub-cue item ${V}`);const ue=setInterval(()=>{Se(be=>{if(be[V]&&be[V].startedAt){const ke=be[V].startedAt,Fe=ke instanceof Date?ke.getTime():new Date(ke).getTime(),qe=Math.floor((Date.now()-Fe)/1e3);return{...be,[V]:{...be[V],elapsed:qe}}}return be})},100);gn(be=>(console.log(` Setting sub-cue timer state for item ${V}`),{...be,[V]:ue}))}else console.log(` Sub-cue timer for item ${V} is not running, state: ${D.timer_state}`)}))}catch(h){console.error(" Error loading sub-cue timers:",h)}},Vs=async()=>{if(e?.id){console.log(" Testing database connection...");try{const{data:h,error:C}=await it.getLastLoadedCue(e.id);C?(console.error(" Database test failed:",C),console.log(" This means the SQL migration needs to be run first"),console.log(" Please check your Neon database setup")):(console.log(" Database connection test passed"),console.log(" Test data received:",h))}catch(h){console.error(" Database connection test error:",h)}}},qr=async()=>{if(!e?.id){console.log(" No event ID for checking running timers");return}console.log(" Checking for running timers for event:",e.id);try{console.log(" Using fallback timer detection..."),n0({cueName:"Timer Detected",remainingTime:"Check Console"}),xl(!0),console.log(" Fallback timer popup shown")}catch(h){console.error(" Error checking running timers:",h)}},js=async()=>{if(console.log(" Master sync: Getting active timer from database..."),!e?.id){console.warn(" No event selected for sync");return}try{const h=await it.getActiveTimer(e.id);if(!h){console.log(" No active timer found in database");return}console.log(" Found active timer in database:",h);const C=new Date,D=Math.floor(C.getTime()/1e3),V=new Date(h.started_at),re=Math.floor(V.getTime()/1e3),ue=h.duration_seconds||0,be=h.is_running;if(console.log(" Timer calculation:",{currentTime:D,startTimeSeconds:re,durationSeconds:ue,isRunning:be,currentTimeFormatted:C.toISOString(),startTimeFormatted:V.toISOString()}),ae(h.item_id),be){const ke=D-re,Fe=ue-ke;if(console.log(" Time calculation for running timer:",{elapsedSeconds:ke,remainingSeconds:Fe,isOverdue:Fe<0}),xe(qe=>({...qe,[h.item_id]:{elapsed:ke,total:ue,startedAt:V}})),Fe!==0){Fe>0?console.log(` Timer synced: ${Fe} seconds remaining - starting countdown`):console.log(` Timer synced: ${Math.abs(Fe)} seconds overdue - starting count up`),ct[h.item_id]&&clearInterval(rn[h.item_id]);const qe=setInterval(()=>{xe(nt=>{const mt=nt[h.item_id];if(!mt)return nt;const Pt=mt.elapsed+1,$t=mt.total-Pt;return $t>0?console.log(` Timer countdown: ${$t} seconds remaining`):console.log($t===0?" Timer just expired":` Timer count up: ${Math.abs($t)} seconds overdue`),{...nt,[h.item_id]:{...mt,elapsed:Pt}}})},1e3);An(nt=>({...nt,[h.item_id]:qe}))}else console.log(" Timer just expired")}else console.log(" Timer is loaded but not running - setting duration only"),xe(ke=>({...ke,[h.item_id]:{elapsed:0,total:ue,startedAt:null}})),console.log(` Timer synced: Set loaded duration to ${ue} seconds`)}catch(h){console.error(" Error during master sync:",h)}},wo=async()=>{if(!(!e?.id||!i?.id))try{console.log(" Backing up schedule data..."),await it.saveRunOfShowData({event_id:e.id,event_name:e.name,event_date:e.date,schedule_items:S,custom_columns:W,settings:{}}),console.log(" Schedule data backed up")}catch(h){console.error(" Error backing up schedule data:",h)}},Co=async()=>{if(!e?.id){console.log(" No event ID for loading master change log");return}try{console.log(" Loading master change log for event:",e.id);const h=await Bn.getMasterChangeLog(e.id,100);y(h),console.log(" Loaded master change log:",h.length,"changes"),h.length===0&&console.log(" No master changes found - this might be normal for new events")}catch(h){console.error(" Error loading master change log:",h),y([])}},ju=async()=>{if(!e?.id||!i){console.log(" Cannot sync - missing event ID or user");return}if(!Ca){console.log(" Skipping sync - page not visible");return}if(wr||xt||Be||Nt||Vi){console.log(" Skipping sync - modal is open");return}if(Gt){console.log(" Skipping sync - user is actively editing");return}try{console.log(" Syncing schedule data to database...");const h={event_id:e.id,event_name:e.name,event_date:e.date,schedule_items:S,custom_columns:W,settings:{eventName:K,masterStartTime:ye,dayStartTimes:ve}};await it.saveRunOfShowData(h,{userId:i.id,userName:i.full_name||i.email||"Unknown User",userRole:c||"VIEWER"})?(console.log(" Schedule data synced to database successfully"),Co()):console.log(" Failed to sync schedule data to database")}catch(h){console.error(" Error syncing schedule data to database:",h)}},Nl=async()=>{if(prompt("Enter password to clear all change logs:")!=="1615"){alert("Incorrect password. Change logs not cleared.");return}if(confirm(` WARNING: This will permanently delete ALL change logs (local and master) for this event. This action cannot be undone.

Are you sure you want to continue?`))try{if(Bn.clearLocalChanges(),w([]),console.log(" Local changes cleared"),e?.id){if(console.log(" Attempting to clear master change log for event:",e.id),console.log(" Current user:",i?.id,i?.email),!i){console.error(" No user found"),alert(" Authentication error. Please refresh and try again.");return}const D=await Bn.clearMasterChangeLog(e.id);if(D.success){y([]),console.log(" Master change log cleared successfully"),console.log(" Verifying master change log is cleared...");const V=await Bn.getMasterChangeLog(e.id);console.log(" Master change log after clearing:",V.length,"records"),y(V),V.length===0?alert(` All change logs cleared successfully!

- Local changes:  Cleared
- Master changes:  Cleared (${D.deletedCount} records deleted)`):alert(` Partial success:

- Local changes:  Cleared
- Master changes:  ${D.deletedCount} deleted, but ${V.length} remain

Some records may be protected by RLS policies.`)}else console.log(" Failed to clear master change log:",D.error),alert(` Partial success:

- Local changes:  Cleared
- Master changes:  Failed

Error: ${D.error}

This might be due to database permissions. Check the console for details.`)}else alert(" Error: No event ID found. Cannot clear master change log.")}catch(D){console.error("Error clearing change logs:",D),alert(" Error clearing change logs. Check the console for details.")}};I.useEffect(()=>{if(Object.keys(ct).length===0){hs(!1);return}if(!As)return;const h=parseInt(Object.keys(ct)[0]),C=S.find(D=>D.id===h);if(C)try{const D=new Date,V=S.findIndex(ue=>ue.id===C.id),re=fi(V);if(re){const[ue,be]=re.split(" "),[ke,Fe]=ue.split(":").map(Number);let qe=ke;be==="PM"&&ke!==12&&(qe+=12),be==="AM"&&ke===12&&(qe=0);const nt=new Date,mt=new Date(nt.getFullYear(),nt.getMonth(),nt.getDate(),qe,Fe),Pt=D.getTime()-mt.getTime(),$t=Math.round(Pt/(1e3*60));Et(Math.abs($t)),$t<-1?(st("early"),hs(!0)):$t>1?(st("late"),hs(!0)):(st("on-time"),hs(!0))}}catch(D){console.error("Error calculating time status:",D),hs(!1)}},[ct,S,As]);const ep=()=>{if(!Kn)return;const h=document.querySelector(`[data-item-id="${Y}"]`);if(h){const C=h.getBoundingClientRect(),D=window.pageYOffset||document.documentElement.scrollTop,V=C.top+D,re=document.querySelector("#main-scroll-container .h-24");let ue=100;re&&(ue=re.getBoundingClientRect().height+20);const ke=V-ue-230;window.scrollTo({top:Math.max(0,ke),behavior:"smooth"}),localStorage.setItem(`scrollPosition_${e?.id}`,ke.toString())}},[Er,an]=I.useState({cue:"",day:1,programType:"PreShow/End",shotType:"",segmentName:"",durationHours:0,durationMinutes:0,durationSeconds:0,notes:"",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!1,timerId:"",isPublic:!1,isIndented:!1,customFields:{}});I.useEffect(()=>{an(h=>({...h,day:ie}))},[ie]);const a0=["PreShow/End","Podium Transition","Panel Transition","Sub Cue","No Transition","Video","Panel+Remote","Remote Only","Break","TBD","KILLED"],xc={"PreShow/End":"#8B5CF6","Podium Transition":"#8B4513","Panel Transition":"#404040","Sub Cue":"#F3F4F6","No Transition":"#059669",Video:"#F59E0B","Panel+Remote":"#1E40AF","Remote Only":"#60A5FA",Break:"#EC4899",TBD:"#6B7280",KILLED:"#DC2626"},Fa=(h,C,D,V,re)=>{let ue=6.5;if(h&&h.trim()!==""){const be=document.createElement("div");be.style.position="absolute",be.style.visibility="hidden";const mt=(zt.notes-32-1)/16;be.style.width=`${mt}rem`,be.style.padding="0.75rem",be.style.fontSize="1rem",be.style.lineHeight="1.5",be.style.fontFamily="system-ui, -apple-system, sans-serif",be.style.whiteSpace="pre-wrap",be.style.wordWrap="break-word",be.innerHTML=h,document.body.appendChild(be);const Pt=be.scrollHeight;document.body.removeChild(be);const Jr=Pt/16+3;ue=Math.max(ue,Jr)}if(D&&D.trim()!=="")try{const be=JSON.parse(D);if(Array.isArray(be)&&be.length>0){const ke=be.filter(Fe=>Fe.fullName&&Fe.fullName.trim()!=="");if(ke.length>0){const nt=4+ke.length*1.5;ue=Math.max(ue,nt)}}}catch{if(D.includes(`
`)){const Fe=4+D.split(`
`).filter(qe=>qe.trim()!=="").length*1.5;ue=Math.max(ue,Fe)}}if(C&&C.trim()!=="")try{const be=JSON.parse(C);if(Array.isArray(be)&&be.length>0){const ke=be.filter(Fe=>Fe.fullName&&Fe.fullName.trim()!=="");if(ke.length>0){const nt=4+ke.length*1.5;ue=Math.max(ue,nt)}}}catch{if(C.includes(`
`)){const Fe=4+C.split(`
`).filter(qe=>qe.trim()!=="").length*1.5;ue=Math.max(ue,Fe)}}return V&&re&&re.length>0&&re.forEach(be=>{const ke=V[be.name];if(ke&&ke.trim()!==""){const Fe=ke.split(`
`),$t=3+Math.max(2,Fe.length)*1.6+1;ue=Math.max(ue,$t)}}),`${ue}rem`},Iu=h=>{if(!h||h.trim()==="")return"3.5rem";let C=1;try{const ue=JSON.parse(h);if(Array.isArray(ue)){const be=ue.filter(ke=>ke.fullName&&ke.fullName.trim()!=="");C=Math.max(1,be.length)}}catch{C=Math.max(1,h.split(`
`).filter(be=>be.trim()!=="").length)}const re=3+(C-1)*1.5;return`${Math.max(3.5,re)}rem`},tp=()=>{let h=0;S.forEach(re=>{!re.isIndented&&(re.day||1)===ie&&(h+=(re.durationHours||0)*3600+(re.durationMinutes||0)*60+(re.durationSeconds||0))});const C=Math.floor(h/3600),D=Math.floor(h%3600/60),V=h%60;return{hours:C,minutes:D,seconds:V,totalSeconds:h}},Ur=(h,C)=>{const D=document.getElementById("notes-editor");if(D){D.focus();try{switch(h){case"bold":document.execCommand("bold",!1);break;case"italic":document.execCommand("italic",!1);break;case"underline":document.execCommand("underline",!1);break;case"color":C&&document.execCommand("foreColor",!1,C);break;case"highlight":C&&C!=="none"?document.execCommand("backColor",!1,C):document.execCommand("removeFormat",!1);break;case"fontSize":C&&document.execCommand("fontSize",!1,C);break;case"bullet":document.execCommand("insertUnorderedList",!1);break;case"list":document.execCommand("insertOrderedList",!1);break;case"left":document.execCommand("justifyLeft",!1);break;case"center":document.execCommand("justifyCenter",!1);break;case"right":document.execCommand("justifyRight",!1);break;case"undo":document.execCommand("undo",!1);break;case"redo":document.execCommand("redo",!1);break}}catch{console.warn("Formatting command not supported:",h)}}},rp=()=>{const h=document.getElementById("notes-editor");if(h&&Ke!==null){const C=h.innerHTML;if(Ke===-1)an(D=>({...D,notes:C}));else{const D=S.find(re=>re.id===Ke)?.notes||"",V=S.find(re=>re.id===Ke);A(re=>re.map(ue=>ue.id===Ke?{...ue,notes:C}:ue)),V&&Q("FIELD_UPDATE",`Updated notes for "${V.segmentName}"`,{changeType:"FIELD_CHANGE",itemId:V.id,itemName:V.segmentName,fieldName:"notes",oldValue:D,newValue:C,details:{fieldType:"text",characterChange:C.length-D.length}})}Dt(!1),er(null),Sn()}},s0=()=>{if(ar!==null){const h=JSON.stringify(Xe);if(ar===-1)an(C=>({...C,speakersText:h}));else{const C=S.find(V=>V.id===ar)?.speakersText||"",D=S.find(V=>V.id===ar);A(V=>V.map(re=>re.id===ar?{...re,speakersText:h}:re)),D&&Q("FIELD_UPDATE",`Updated speakers for "${D.segmentName}"`,{changeType:"FIELD_CHANGE",itemId:D.id,itemName:D.segmentName,fieldName:"speakers",oldValue:C,newValue:h,details:{fieldType:"speakers",speakerCount:Xe.length,characterChange:h.length-C.length}})}ur(!1),Ve(null),Sn()}},ko=()=>{if(vt!==null){const h=document.getElementById("assets-list");if(h){const C=h.querySelectorAll(".asset-item"),D=[];C.forEach(re=>{const ue=re.querySelector(".asset-name"),be=re.querySelector(".asset-link");if(ue&&be){const ke=ue.value.trim(),Fe=be.value.trim();ke&&D.push(Fe?`${ke}|${Fe}`:ke)}});const V=D.join("||");if(vt===-1)an(re=>({...re,assets:V}));else{const re=S.find(be=>be.id===vt)?.assets||"",ue=S.find(be=>be.id===vt);A(be=>be.map(ke=>ke.id===vt?{...ke,assets:V}:ke)),ue&&Q("FIELD_UPDATE",`Updated assets for "${ue.segmentName}"`,{changeType:"FIELD_CHANGE",itemId:ue.id,itemName:ue.segmentName,fieldName:"assets",oldValue:re,newValue:V,details:{fieldType:"assets",assetCount:D.length,characterChange:V.length-re.length}})}Qe(!1),St(null),Sn()}}},bc=()=>{const h=document.getElementById("assets-list");if(h){const C=document.createElement("div");C.className="asset-item p-3 bg-slate-700 rounded-lg space-y-3",C.innerHTML=`
        <div class="flex gap-3 items-center">
          <input type="text" class="asset-name flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Asset name..." />
          <button type="button" class="toggle-link px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded transition-colors text-sm">
            + Link
          </button>
          <button type="button" class="remove-asset px-3 py-2 bg-red-600 hover:bg-red-500 text-white rounded transition-colors">Remove</button>
        </div>
        <div class="asset-link-container hidden">
          <input type="url" class="asset-link w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Enter asset URL..." />
        </div>
      `;const D=C.querySelector(".toggle-link"),V=C.querySelector(".asset-link-container"),re=C.querySelector(".asset-link");D?.addEventListener("click",()=>{V?.classList.contains("hidden")?(V.classList.remove("hidden"),D.textContent=" Link",D.classList.remove("bg-blue-600","hover:bg-blue-500"),D.classList.add("bg-slate-600","hover:bg-slate-500"),re?.focus()):(V?.classList.add("hidden"),D.textContent="+ Link",D.classList.remove("bg-slate-600","hover:bg-slate-500"),D.classList.add("bg-blue-600","hover:bg-blue-500"),re&&(re.value=""))}),C.querySelector(".remove-asset")?.addEventListener("click",()=>{C.remove()}),h.appendChild(C)}},Mu=()=>{if(Lt.length>=7)return;const h=Lt.map(V=>V.slot),C=[1,2,3,4,5,6,7].find(V=>!h.includes(V))||1,D={id:`speaker_${Date.now()}`,slot:C,location:"Podium",fullName:"",title:"",org:"",photoLink:""};Yt(V=>[...V,D].sort((re,ue)=>re.slot-ue.slot))},i0=h=>{Yt(C=>C.filter(D=>D.id!==h))},Ro=(h,C,D)=>{Yt(V=>V.map(re=>re.id===h?{...re,[C]:D}:re).sort((re,ue)=>re.slot-ue.slot))},np=()=>{if(kt!==null){const h=JSON.stringify(Lt);kt===-1?an(C=>({...C,speakers:h})):A(C=>C.map(D=>D.id===kt?{...D,speakers:h}:D)),Ot(!1),Ft(null)}},ap=()=>{if(Xe.length>=7)return;const h=Xe.map(V=>V.slot),C=[1,2,3,4,5,6,7].find(V=>!h.includes(V))||1,D={id:Date.now().toString(),fullName:"",location:"Podium",slot:C,title:"",org:"",photoLink:""};he(V=>[...V,D])},sp=h=>{he(C=>C.filter(D=>D.id!==h))},$i=(h,C,D)=>{he(V=>V.map(re=>re.id===h?{...re,[C]:D}:re))},ip=(h,C)=>{if(Xe.some(V=>V.id!==h&&V.slot===C)){const V=Xe.find(re=>re.id!==h&&re.slot===C);if(V){const re=Xe.find(ue=>ue.id===h);re&&$i(V.id,"slot",re.slot)}}$i(h,"slot",C)},op=(h,C)=>{const D=Lt.find(re=>re.id===h);if(!D)return;const V=Lt.find(re=>re.id!==h&&re.slot===C);if(V){const re=Lt.map(ue=>ue.id===h?{...ue,slot:C}:ue.id===V.id?{...ue,slot:D.slot}:ue);Yt(re)}else Ro(h,"slot",C)},o0=h=>{if(!h)return"Click to add participants...";try{const C=JSON.parse(h);return!Array.isArray(C)||C.length===0?"Click to add participants...":C.sort((D,V)=>D.slot-V.slot).map(D=>`${D.location==="Podium"?"P":D.location==="Seat"?"S":D.location==="Virtual"?"V":"M"}${D.slot} - ${D.fullName||"Unnamed"}`).join(`
`)}catch{return"Click to add participants..."}},Nc=h=>{if(!h)return"Click to add speakers...";try{const C=JSON.parse(h);return!Array.isArray(C)||C.length===0?"Click to add speakers...":C.sort((D,V)=>D.slot-V.slot).filter(D=>D.fullName&&D.fullName.trim()!=="").map(D=>`${D.location==="Podium"?"P":D.location==="Seat"?"S":D.location==="Virtual"?"V":"M"}${D.slot} - ${D.fullName||"Unnamed"}`).join(`
`)}catch{return"Click to add speakers..."}},l0=["Podium","2-Shot","3-Shot","4-Shot","5-Shot","6-Shot","7-Shot","Ted-Talk"],c0=h=>{if(isNaN(h)||h===void 0||h===null)return console.warn(" formatTime received invalid value:",h),"00:00:00";const C=h<0,D=Math.abs(h),V=Math.floor(D/3600),re=Math.floor(D%3600/60),ue=Math.floor(D%60);return`${C?"-":""}${V.toString().padStart(2,"0")}:${re.toString().padStart(2,"0")}:${ue.toString().padStart(2,"0")}`},Fu=h=>{if(isNaN(h)||h===void 0||h===null)return console.warn(" formatSubCueTime received invalid value:",h),"00:00";const C=h<0,D=Math.abs(h),V=Math.floor(D/3600),re=Math.floor(D%3600/60),ue=Math.floor(D%60),be=C?"-":"";return V===0?`${be}${re.toString().padStart(2,"0")}:${ue.toString().padStart(2,"0")}`:`${be}${V.toString().padStart(2,"0")}:${re.toString().padStart(2,"0")}:${ue.toString().padStart(2,"0")}`},Dl=h=>{if(!Xr[h])return!1;const C=Xr[h].parentId;return C?ct[C]!==void 0:!1},lp=()=>{if(Ue?.activeTimer){const D=at;return D.total-D.elapsed}const h=Object.keys(ct);if(h.length>0){const D=parseInt(h[0]);if(se[D]){const V=se[D];return V.total-V.elapsed}}const C=Object.keys(Cr);if(C.length>0){const D=parseInt(C[0]);if(je[D]){const V=je[D];return V.total-V.elapsed}}if(Y&&se[Y]){const D=se[Y];return D.total-D.elapsed}return 0},cp=()=>{if(Ue?.activeTimer){const D=at,V=D.total-D.elapsed;return V<0?0:D.total>0?V/D.total*100:0}const h=Object.keys(ct);if(h.length>0){const D=parseInt(h[0]);if(se[D]){const V=se[D],re=V.total-V.elapsed;return re<0?0:V.total>0?re/V.total*100:0}}const C=Object.keys(Cr);if(C.length>0){const D=parseInt(C[0]);if(je[D]){const V=je[D],re=V.total-V.elapsed;return V.total>0?re/V.total*100:0}}if(Y&&se[Y]){const D=se[Y],V=D.total-D.elapsed;return D.total>0?V/D.total*100:0}return 0},$u=()=>{if(Ue?.activeTimer){const D=at,V=D.total-D.elapsed;return V<0?"bg-red-500":V>120?"#10b981":V>30?"#f59e0b":"#ef4444"}const h=Object.keys(ct);if(h.length>0){const D=parseInt(h[0]);if(se[D]){const V=se[D],re=V.total-V.elapsed;return re<0?"bg-red-500":re>120?"#10b981":re>30?"#f59e0b":"#ef4444"}}const C=Object.keys(Cr);if(C.length>0){const D=parseInt(C[0]);if(je[D]){const V=je[D],re=V.total-V.elapsed;return re>120?"#10b981":re>30?"#f59e0b":"#ef4444"}}if(Y&&se[Y]){const D=se[Y],V=D.total-D.elapsed;return V>120?"#10b981":V>30?"#f59e0b":"#ef4444"}return"transparent"},Bi=()=>{if(Ue?.activeTimer){const C=at,D=C.total-C.elapsed;return D>120?"#10b981":D>30?"#f59e0b":"#ef4444"}const h=Object.keys(ct);if(h.length>0){const C=parseInt(h[0]);if(se[C]){const D=se[C],V=D.total-D.elapsed;return V>120?"#10b981":V>30?"#f59e0b":"#ef4444"}}if(Y&&se[Y]){const C=se[Y],D=C.total-C.elapsed;return D>120?"#10b981":D>30?"#f59e0b":"#ef4444"}return"#ffffff"},Hi=async h=>{if(!Y||!i||!e?.id)return;const C=S.find(be=>be.id===Y);if(!C)return;const D=Math.max(0,C.durationHours*3600+C.durationMinutes*60+C.durationSeconds+h),V=Math.floor(D/3600),re=Math.floor(D%3600/60),ue=D%60;A(be=>be.map(ke=>ke.id===Y?{...ke,durationHours:V,durationMinutes:re,durationSeconds:ue}:ke)),se[Y]&&(console.log(" Updating timer duration for item:",Y,"new duration:",D),xe(be=>({...be,[Y]:{...be[Y],total:D}})),ct[Y]?(console.log(" Timer duration updated locally for running timer"),await it.updateTimerDuration(e.id,Y,D)?console.log(" Timer duration updated on server - Browser B will see the change"):console.warn(" Failed to update timer duration on server"),await wo(),console.log(" Time adjustment completed locally and on server")):console.log(" Timer duration updated locally for loaded timer"))},u0=async h=>{if(console.log(" loadCue function STARTED with itemId:",h),console.log(" user:",i),console.log(" event:",e),console.log(" currentUserRole:",c),!i||!e?.id){console.log(" Missing user or event ID:",{user:!!i,eventId:e?.id});return}Object.keys(ct).forEach(async ue=>{if(ct[parseInt(ue)]){clearInterval(rn[parseInt(ue)]),Lr(ke=>({...ke,[parseInt(ue)]:!0}));const be=S.find(ke=>ke.id===parseInt(ue));console.log(" About to mark cue as completed:",{eventId:e.id,itemId:parseInt(ue),userId:i.id,cueId:be?.customFields?.cue||"CUE"});try{const ke=await it.markCueCompleted(e.id,parseInt(ue),be?.customFields?.cue||"CUE",i.id,i.full_name||i.email||"Unknown User",c||"VIEWER");console.log(" Mark completed result:",ke)}catch(ke){console.error(" Error marking cue as completed:",ke)}}}),nr({}),console.log(" Stopping all timers in API for event:",e.id,"user:",i.id);const C=await it.stopAllTimersForEvent(e.id,i.id,i.full_name||i.email||"Unknown User",c||"VIEWER");if(console.log(" Stop all timers result:",C),qt&&(console.log(" Stopping sub-cue timer because new cue is being loaded"),await Wi()),Y&&Y!==h){Nn(ke=>new Set([...ke,Y])),Lr(ke=>({...ke,[Y]:!0}));const ue=S.find(ke=>ke.id===Y);console.log(" About to mark active cue as completed:",{eventId:e.id,itemId:Y,userId:i.id,cueId:ue?.customFields?.cue||"CUE"});try{const ke=await it.markCueCompleted(e.id,Y,ue?.customFields?.cue||"CUE",i.id,i.full_name||i.email||"Unknown User",c||"VIEWER");console.log(" Mark active completed result:",ke)}catch(ke){console.error(" Error marking active cue as completed:",ke)}const be=S.findIndex(ke=>ke.id===Y);if(be!==-1)for(let ke=be+1;ke<S.length&&S[ke].isIndented;ke++)Lr(Fe=>({...Fe,[S[ke].id]:!0})),Nn(Fe=>new Set([...Fe,S[ke].id])),await it.markCueCompleted(e.id,S[ke].id,S[ke].customFields?.cue||"CUE",i.id,i.full_name||i.email||"Unknown User",c||"VIEWER")}Lr(ue=>{const be={...ue};delete be[h];const ke=S.findIndex(Fe=>Fe.id===h);if(ke!==-1)for(let Fe=ke+1;Fe<S.length&&S[Fe].isIndented;Fe++)delete be[S[Fe].id];return be}),Nn(ue=>{const be=new Set(ue);be.delete(h);const ke=S.findIndex(Fe=>Fe.id===h);if(ke!==-1)for(let Fe=ke+1;Fe<S.length&&S[Fe].isIndented;Fe++)be.delete(S[Fe].id);return be});const D=S.find(ue=>ue.id===h);if(D){console.log(" Item found:",D),console.log(" Item ID type:",typeof D.id,"Value:",D.id),console.log(" Item duration values:",{durationHours:D.durationHours,durationMinutes:D.durationMinutes,durationSeconds:D.durationSeconds});const ue=D.durationHours*3600+D.durationMinutes*60+D.durationSeconds;console.log(" Calculated total seconds:",ue),console.log(" Item duration breakdown:",{durationHours:D.durationHours,durationMinutes:D.durationMinutes,durationSeconds:D.durationSeconds,totalSeconds:ue});const be=typeof h=="string"?parseInt(h):h;console.log(" Numeric item ID:",be),console.log(" Optimistic UI update - showing loaded state immediately"),xe(mt=>({...mt,[h]:{elapsed:0,total:ue,startedAt:null}})),ae(h),ir(mt=>({...mt,[h]:!0}));const Fe=S.findIndex(mt=>mt.id===h)+1,qe=nn(D.customFields.cue),nt=D.timerId;console.log(" Loading CUE in API:",{eventId:e.id,itemId:be,userId:i.id,totalSeconds:ue,rowNumber:Fe,cueDisplay:qe,timerId:nt}),console.log(" About to call DatabaseService.loadCue..."),console.log(" DatabaseService object:",typeof it),console.log(" DatabaseService.loadCue function:",typeof it.loadCue),console.log(" Testing API configuration...");try{await Es.healthCheck(),console.log(" API server is running")}catch(mt){console.error(" Error connecting to API server:",mt)}try{console.log(" Calling DatabaseService.loadCue now...");const mt=await it.loadCue(e.id,be,i.id,ue,Fe,qe,nt);console.log(" Load CUE result:",mt),mt?console.log(" Load CUE succeeded!"):console.error(" Load CUE failed - check database connection and functions")}catch(mt){console.error(" Load CUE error:",mt),console.error(" Error stack:",mt.stack)}console.log(" Finished loadCue database call"),Ma(be);try{await it.updateLastLoadedCue(e.id,be,"loaded"),console.log(" Last loaded CUE saved")}catch(mt){console.log(" Could not save last loaded CUE (migration may not be run):",mt)}await wo(),console.log(" Load CUE action completed locally")}const V=S.findIndex(ue=>ue.id===h),re=new Set;if(V!==-1)for(let ue=V+1;ue<S.length&&S[ue].isIndented;ue++)re.add(S[ue].id);jn(re)},To=async()=>{if(Object.keys(ct).forEach(h=>{ct[parseInt(h)]&&clearInterval(rn[parseInt(h)])}),Object.keys(Cr).forEach(h=>{Cr[parseInt(h)]&&clearInterval(Cr[parseInt(h)])}),e?.id)try{await it.clearCompletedCues(e.id),console.log(" Cleared completed cues from database"),await it.clearAllActiveTimersForEvent(e.id),console.log(" Cleared all active timers from API")}catch(h){console.warn(" Failed to clear database:",h)}nr({}),gn({}),xe({}),Se({}),Lr({}),ae(null),Nn(new Set),jn(new Set),Ma(null),console.log(" RunOfShow: Emitting reset all states event to other pages"),_r.emitResetAllStates(),console.log(" RunOfShow: Reset all states event emitted")},up=()=>{Ar(!1),Fr&&!Fr.closed&&Fr.close();const h=Object.keys(ct),C=h.length>0?S.find(re=>ct[re.id]):S.find(re=>re.id===Y),D={isRunning:h.length>0,elapsedTime:C&&se[C.id]?se[C.id].elapsed:0,totalDuration:C?C.durationHours*3600+C.durationMinutes*60+C.durationSeconds:0,eventId:e?.id,mainTimer:C?{cue:C.customFields.cue||"CUE",segmentName:C.segmentName||""}:null,secondaryTimer:qt?{itemId:qt.itemId,remaining:qt.remaining,duration:qt.duration,cue:S.find(re=>re.id===qt.itemId)?.customFields.cue||"CUE",segmentName:S.find(re=>re.id===qt.itemId)?.segmentName||""}:null},V=window.open("/fullscreen-timer","fullScreenTimer","width=1920,height=1080,fullscreen=yes,menubar=no,toolbar=no,location=no,status=no,scrollbars=no,resizable=yes");V&&(Ka(V),V.addEventListener("load",()=>{V.postMessage({type:"TIMER_UPDATE",...D},"*")}))},dp=()=>{Ar(!1),zn&&!zn.closed&&zn.close();const h=Object.keys(ct),C=h.length>0?S.find(ue=>ct[ue.id]):S.find(ue=>ue.id===Y),D={isRunning:h.length>0,elapsedTime:C&&se[C.id]?se[C.id].elapsed:0,totalDuration:C?C.durationHours*3600+C.durationMinutes*60+C.durationSeconds:0,eventId:e?.id,mainTimer:C?{cue:C.customFields.cue||"CUE",segmentName:C.segmentName||""}:null,secondaryTimer:qt?{itemId:qt.itemId,remaining:qt.remaining,duration:qt.duration,cue:S.find(ue=>ue.id===qt.itemId)?.customFields.cue||"CUE",segmentName:S.find(ue=>ue.id===qt.itemId)?.segmentName||""}:null},V=e?.id?`/clock?eventId=${e.id}`:"/clock",re=window.open(V,"clock","width=1920,height=1080,fullscreen=yes,menubar=no,toolbar=no,location=no,status=no,scrollbars=no,resizable=yes");re&&(_s(re),re.addEventListener("load",()=>{re.postMessage({type:"TIMER_UPDATE",...D},"*")}))};I.useEffect(()=>{const h=()=>{J(null),L(null),Ar(!1)};return document.addEventListener("click",h),()=>document.removeEventListener("click",h)},[]),I.useEffect(()=>{if(xt&&Ke!==null){const h=document.getElementById("notes-editor");if(h)if(Ke===-1)h.innerHTML=Er.notes||"";else{const C=S.find(D=>D.id===Ke);h.innerHTML=C?.notes||""}}},[xt,Ke,S,Er.notes]),I.useEffect(()=>{if(wr&&ar!==null)if(ar===-1)if(Er.speakersText)try{const h=JSON.parse(Er.speakersText);he(Array.isArray(h)?h:[])}catch{he([])}else he([]);else{const h=S.find(C=>C.id===ar);if(h?.speakersText)try{const C=JSON.parse(h.speakersText);he(Array.isArray(C)?C:[])}catch{he([])}else he([])}},[wr,ar,S,Er.speakersText]),I.useEffect(()=>{if(Be&&vt!==null){const h=document.getElementById("assets-list");if(h){h.innerHTML="";let C="";vt===-1?C=Er.assets||"":C=S.find(V=>V.id===vt)?.assets||"",C&&C.split("||").forEach(V=>{if(V.trim()){const[re,ue]=V.split("|"),be=ue&&ue.trim()!=="",ke=document.createElement("div");ke.className="asset-item p-3 bg-slate-700 rounded-lg space-y-3",ke.innerHTML=`
                <div class="flex gap-3 items-center">
                  <input type="text" class="asset-name flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Asset name..." value="${re||""}" />
                  <button type="button" class="toggle-link px-3 py-2 text-white rounded transition-colors text-sm ${be?"bg-slate-600 hover:bg-slate-500":"bg-blue-600 hover:bg-blue-500"}">
                    ${be?" Link":"+ Link"}
                  </button>
                  <button type="button" class="remove-asset px-3 py-2 bg-red-600 hover:bg-red-500 text-white rounded transition-colors">Remove</button>
                </div>
                <div class="asset-link-container ${be?"":"hidden"}">
                  <input type="url" class="asset-link w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500" placeholder="Enter asset URL..." value="${ue||""}" />
                </div>
              `;const Fe=ke.querySelector(".toggle-link"),qe=ke.querySelector(".asset-link-container"),nt=ke.querySelector(".asset-link");Fe?.addEventListener("click",()=>{qe?.classList.contains("hidden")?(qe.classList.remove("hidden"),Fe.textContent=" Link",Fe.classList.remove("bg-blue-600","hover:bg-blue-500"),Fe.classList.add("bg-slate-600","hover:bg-slate-500"),nt?.focus()):(qe?.classList.add("hidden"),Fe.textContent="+ Link",Fe.classList.remove("bg-slate-600","hover:bg-slate-500"),Fe.classList.add("bg-blue-600","hover:bg-blue-500"),nt&&(nt.value=""))}),ke.querySelector(".remove-asset")?.addEventListener("click",()=>{ke.remove()}),h.appendChild(ke)}}),h.children.length===0&&bc()}}},[Be,vt,S,Er.assets]),I.useEffect(()=>{if(Nt&&kt!==null)if(kt===-1)if(Er.speakers)try{const h=JSON.parse(Er.speakers);Yt(Array.isArray(h)?h:[])}catch{Yt([])}else Yt([]);else{const h=S.find(C=>C.id===kt);if(h?.speakers)try{const C=JSON.parse(h.speakers);Yt(Array.isArray(C)?C:[])}catch{Yt([])}else Yt([])}},[Nt,kt,S,Er.speakers]);const ps=Rh.useCallback(fp(async()=>{if(e?.id)try{const h={event_id:e.id,event_name:e.name,event_date:e.date,schedule_items:S,custom_columns:W,settings:{eventName:K,masterStartTime:ye,dayStartTimes:ve,lastSaved:new Date().toISOString()}};Math.random()<.05&&console.log(" Auto-saving to API:",{eventId:e.id,scheduleItemsCount:S.length,customColumnsCount:W.length,eventName:K,masterStartTime:ye,sampleScheduleItem:S[0]?{id:S[0].id,segmentName:S[0].segmentName,speakersText:S[0].speakersText?"Has speakers data":"No speakers data",speakers:S[0].speakers?"Has speakers data":"No speakers data"}:"No schedule items"});const C=await it.saveRunOfShowData(h,{userId:i?.id||"unknown",userName:i?.full_name||i?.email||"Unknown User",userRole:c||"VIEWER"});Math.random()<.1&&console.log(" Auto-saved to API successfully")}catch(h){console.error(" Error auto-saving to API:",h)}},3e4),[e?.id,e?.name,e?.date,S,W,K,ye,ve]);function fp(h,C){let D;return((...V)=>{clearTimeout(D),D=setTimeout(()=>h(...V),C)})}const mp=I.useCallback(async()=>{if(e?.id)try{console.log(" Loading from API for event:",e.id);const h=it.getRunOfShowData(e.id),C=new Promise((V,re)=>setTimeout(()=>re(new Error("Database query timeout after 10 seconds")),1e4)),D=await Promise.race([h,C]);if(console.log(" Debug - Raw data from API:",D),console.log(" Debug - schedule_items:",D?.schedule_items),console.log(" Debug - custom_columns:",D?.custom_columns),console.log(" Debug - settings:",D?.settings),D){console.log(" Data loaded from API:",{scheduleItemsCount:D.schedule_items?.length||0,customColumnsCount:D.custom_columns?.length||0,eventName:D.settings?.eventName,masterStartTime:D.settings?.masterStartTime,sampleScheduleItem:D.schedule_items?.[0]?{id:D.schedule_items[0].id,segmentName:D.schedule_items[0].segmentName,speakersText:D.schedule_items[0].speakersText?"Has speakers data":"No speakers data",speakers:D.schedule_items[0].speakers?"Has speakers data":"No speakers data"}:"No schedule items"});const V=D.schedule_items?[...D.schedule_items]:[];A(V),H(D.custom_columns||[]),D.settings?.eventName&&Oe(D.settings.eventName),D.settings?.masterStartTime&&Pe(D.settings.masterStartTime),D.settings?.dayStartTimes&&Ge(D.settings.dayStartTimes),j(D.updated_at||null),T(!1),P({show:!1}),console.log(" Run of Show data loaded from API successfully"),setTimeout(()=>{gc()},100)}else{console.log(" No data found in API, falling back to localStorage for event:",e.id);const V=localStorage.getItem(`runOfShowSchedule_${e.id}`),re=localStorage.getItem(`customColumns_${e.id}`),ue=localStorage.getItem(`eventName_${e.id}`),be=localStorage.getItem(`masterStartTime_${e.id}`),ke=localStorage.getItem(`dayStartTimes_${e.id}`);if(V)try{const Fe=JSON.parse(V);console.log(" Parsed schedule from localStorage:",Fe);const qe=Fe.map(nt=>({...nt,day:nt.day||1}));A(qe),console.log(" Loaded schedule from localStorage:",qe.length,"items"),console.log(" First few items:",qe.slice(0,3))}catch(Fe){console.error(" Error parsing schedule from localStorage:",Fe),console.log(" Raw localStorage data:",V)}else console.log(" No schedule found in localStorage for event:",e.id);re&&(H(JSON.parse(re)),console.log(" Loaded custom columns from localStorage")),ue&&(Oe(ue),console.log(" Loaded event name from localStorage")),be&&(Pe(be),console.log(" Loaded master start time from localStorage")),ke&&(Ge(JSON.parse(ke)),console.log(" Loaded day start times from localStorage"))}}catch(h){console.error(" Error loading run of show data from API:",h),console.error(" Error details:",{message:h.message,stack:h.stack,eventId:e?.id}),console.log(" Falling back to localStorage due to error");const C=localStorage.getItem(`runOfShowSchedule_${e.id}`);if(C)try{const V=JSON.parse(C).map(re=>({...re,day:re.day||1}));A(V),console.log(" Loaded schedule from localStorage after error:",V.length,"items"),console.log(" First few items after error:",V.slice(0,3))}catch(D){console.error(" Error parsing schedule from localStorage after error:",D),console.log(" Raw localStorage data after error:",C)}else console.log(" No schedule found in localStorage after error for event:",e.id)}},[e?.id]),Bu=I.useCallback(async()=>{if(e?.id)try{console.log(" Loading changes dynamically for event:",e.id);const h=await it.loadChangesDynamically(e.id);if(h){console.log(" Dynamic changes loaded:",{scheduleItemsCount:h.schedule_items?.length||0,customColumnsCount:h.custom_columns?.length||0,lastModifiedBy:h.last_modified_by_name});const C=h.schedule_items?[...h.schedule_items]:[];A(C),H(h.custom_columns||[]),h.settings?.eventName&&Oe(h.settings.eventName),h.settings?.masterStartTime&&Pe(h.settings.masterStartTime),h.settings?.dayStartTimes&&Ge(h.settings.dayStartTimes),j(h.updated_at||null),T(!1),P({show:!1}),console.log(" Changes loaded dynamically - timers preserved")}}catch(h){console.error(" Error loading changes dynamically:",h)}},[e?.id]);I.useEffect(()=>{console.log(" useEffect triggered for event ID:",e?.id),e?.id?(console.log(" Calling loadFromAPI for event:",e.id),mp()):console.log(" No event ID available for loading data")},[e?.id]),I.useEffect(()=>{if(!e?.id)return;console.log(" Setting up WebSocket-only real-time connections for event:",e.id);const h={onRunOfShowDataUpdated:D=>{if(console.log(" Real-time: Run of show data updated via WebSocket"),D&&D.last_modified_by===i?.id){console.log(" Skipping WebSocket update - change made by current user");return}if(Gt){console.log(" Skipping WebSocket update - user is actively editing");return}console.log(" Real-time: Updating local data with remote changes"),setTimeout(()=>{D.schedule_items&&Array.isArray(D.schedule_items)&&(A(D.schedule_items),console.log(" Real-time: Schedule items updated")),D.custom_columns&&Array.isArray(D.custom_columns)&&(H(D.custom_columns),console.log(" Real-time: Custom columns updated")),D.settings&&(D.settings.eventName!==void 0&&(Oe(D.settings.eventName),console.log(" Real-time: Event name updated")),D.settings.masterStartTime!==void 0&&(Pe(D.settings.masterStartTime),console.log(" Real-time: Master start time updated")),D.settings.dayStartTimes!==void 0&&(Ge(D.settings.dayStartTimes),console.log(" Real-time: Day start times updated"))),rr(!0),console.log(" Real-time: Skipping change detection to prevent delays"),D.updated_at&&j(D.updated_at),console.log(" Real-time: All schedule data updated via WebSocket")},100)},onCompletedCuesUpdated:D=>{if(console.log(" Real-time: Completed cues updated via WebSocket"),D&&D.cleared)console.log(" Real-time: All completed cues cleared via WebSocket"),Lr({});else if(D&&D.removed&&D.item_id)Lr(V=>{const re={...V};return delete re[D.item_id],re});else if(D&&Array.isArray(D)){const V=D.reduce((re,ue)=>(re[ue.item_id]=!0,re),{});Lr(V)}else D&&D.item_id&&Lr(V=>({...V,[D.item_id]:!0}))},onResetAllStates:D=>{console.log(" Real-time: Reset all states received via WebSocket"),nr({}),gn({}),xe({}),Se({}),Lr({}),ae(null),Nn(new Set),jn(new Set),Ma(null),Ze({activeTimer:null}),console.log(" RunOfShow: All states reset via WebSocket")},onTimerUpdated:D=>{console.log(" Real-time: Timer updated via WebSocket"),console.log(" RunOfShow: Event ID check:",{received:D?.event_id,expected:e?.id,match:D?.event_id===e?.id}),D&&D.event_id===e?.id?(Ze(V=>({...V,activeTimer:D})),console.log(" RunOfShow: Timer updated via WebSocket:",D)):console.log(" RunOfShow: Timer update ignored - event ID mismatch or no data")},onTimerStopped:D=>{console.log(" Real-time: Timer stopped via WebSocket"),D&&D.event_id===e?.id&&(Ze(V=>({...V,activeTimer:null})),console.log(" RunOfShow: Timer cleared via WebSocket"))},onTimersStopped:D=>{console.log(" Real-time: All timers stopped via WebSocket"),D&&D.event_id===e?.id&&(Ze(V=>({...V,activeTimer:null})),ae(null),nr({}),console.log(" RunOfShow: All timers cleared via WebSocket"))},onTimerStarted:D=>{console.log(" Real-time: Timer started via WebSocket"),D&&D.item_id&&nr(V=>({...V,[D.item_id]:!0}))},onSubCueTimerStarted:D=>{console.log(" Real-time: Sub-cue timer started via WebSocket"),D&&D.event_id===e?.id&&(Ze(V=>({...V,secondaryTimer:D})),console.log(" RunOfShow: Sub-cue timer started via WebSocket:",D))},onSubCueTimerStopped:D=>{console.log(" Real-time: Sub-cue timer stopped via WebSocket"),D&&D.event_id===e?.id&&(Ze(V=>({...V,secondaryTimer:null})),console.log(" RunOfShow: Sub-cue timer stopped via WebSocket"))},onActiveTimersUpdated:D=>{console.log(" Real-time: Active timers updated via WebSocket");let V=D;if(Array.isArray(D)&&D.length>0&&(V=D[0],console.log(" RunOfShow: Processing first timer from array:",V)),console.log(" RunOfShow: Event ID check:",{received:V?.event_id,expected:e?.id,match:V?.event_id===e?.id}),V&&V.event_id===e?.id){const re=Ue?.activeTimer;if(re&&re.id===V.id&&re.timer_state===V.timer_state&&re.is_active===V.is_active&&re.is_running===V.is_running){console.log(" RunOfShow: Ignoring duplicate timer update:",V.id);return}if(V.timer_state==="stopped"||!V.is_active||V.is_running===!1&&V.is_active===!1)Ze(ue=>({...ue,activeTimer:null})),ae(null),nr({}),console.log(" RunOfShow: Timer stopped via WebSocket - cleared timer data and old state");else{const ue=Ue?.activeTimer;if(ue&&ue.id===V.id&&(ue.timer_state==="stopped"||!ue.is_active)){console.log(" RunOfShow: Ignoring stale timer data for stopped timer:",V.id);return}Ze(be=>({...be,activeTimer:V})),console.log(" RunOfShow: Active timer updated via WebSocket:",V)}}else console.log(" RunOfShow: Active timers update ignored - event ID mismatch or no data")},onConnectionChange:D=>{console.log(` WebSocket connection ${D?"established":"lost"} for event: ${e.id}`)},onInitialSync:async()=>{console.log(" WebSocket initial sync triggered - loading current state");try{const D=await fetch(`https://ros-50-production.up.railway.app/api/completed-cues/${e?.id}`);if(D.ok){const V=await D.json();console.log(" Initial sync: Loaded completed cues:",V);const re=V.reduce((ue,be)=>(ue[be.item_id]=!0,ue),{});Lr(re),console.log(" Initial sync: Converted completed cues to object format:",re)}}catch(D){console.error(" Initial sync failed to load completed cues:",D)}}};_r.connect(e.id,h);const C=()=>{!document.hidden&&_r.isConnected()&&(console.log(" Tab became visible - triggering resync"),h.onInitialSync?.())};return document.addEventListener("visibilitychange",C),()=>{console.log(" Disconnecting WebSocket connections for event:",e.id),_r.disconnect(e.id),document.removeEventListener("visibilitychange",C)}},[e?.id]),I.useEffect(()=>{if(Ue?.activeTimer?.is_running&&Ue?.activeTimer?.is_active){const h=Ue.activeTimer,C=new Date(h.started_at),D=h.duration_seconds||0,V=()=>{const be=Math.floor((new Date().getTime()-C.getTime())/1e3);et({elapsed:be,total:D})};V();const re=setInterval(V,1e3);return()=>clearInterval(re)}else if(Ue?.activeTimer&&!Ue?.activeTimer?.is_running){const h=Ue.activeTimer;et({elapsed:0,total:h.duration_seconds||0})}else Ue?.activeTimer||et({elapsed:0,total:0})},[Ue?.activeTimer?.is_running,Ue?.activeTimer?.is_active,Ue?.activeTimer?.started_at,Ue?.activeTimer?.duration_seconds,Ue?.activeTimer]),I.useEffect(()=>{console.log(" Schedule state changed:",{scheduleLength:S.length,firstItem:S[0]?{id:S[0].id,segmentName:S[0].segmentName,programType:S[0].programType}:"No items",eventId:e?.id})},[S,e?.id]);const Hu=async()=>{if(!e?.id){console.log(" No event ID available for loading backups");return}try{console.log(" Loading backups for event:",e.id),console.log(" Event details:",{id:e.id,name:e.name});const h=await Ql.testBackupTable(),C=await Ql.getBackupsForEvent(e.id);console.log(" Raw backup data received:",C),So(C),console.log(" Loading backup stats...");const D=await Ql.getBackupStats(e.id);console.log(" Backup stats:",D),pl(D),console.log(` Loaded ${C.length} backups successfully`)}catch(h){console.error(" Error loading backups:",h),console.error(" Error details:",{message:h.message,stack:h.stack,eventId:e?.id}),So([]),pl({totalBackups:0,lastBackup:null,autoBackups:0,manualBackups:0})}},d0=async()=>{if(e?.id)try{console.log(" Creating manual backup for event:",e.id);const h=new Date().toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),C=`${e.name}  ${h}`;await Ql.createBackup(e.id,S,W,e,"manual",C,i?.id,i?.full_name||i?.email,i?.role),console.log(" Manual backup created:",C);const D=await Ql.getBackupStats(e.id);pl(D),alert(` Manual backup created successfully!

Backup: ${C}
Schedule Items: ${S.length}
Custom Columns: ${W.length}`)}catch(h){console.error(" Error creating manual backup:",h),alert(` Error creating manual backup: ${h.message}`)}},Jn=h=>{Vn(h),jt(!0)},f0=async()=>{if(!(!e?.id||!Gn))try{console.log(" Restoring from backup:",Gn.id);const h=await Ql.restoreFromBackup(Gn.id);A(h.scheduleData),H(h.customColumnsData),localStorage.setItem(`runOfShowSchedule_${e.id}`,JSON.stringify(h.scheduleData)),localStorage.setItem(`customColumns_${e.id}`,JSON.stringify(h.customColumnsData)),await it.saveRunOfShowData({event_id:e.id,schedule_items:h.scheduleData,custom_columns:h.customColumnsData,event_data:h.eventData},{userId:i?.id||"unknown",userName:i?.full_name||i?.email||"Unknown User",userRole:i?.role||"VIEWER"}),console.log(" Restored from backup:",h.backupName),jt(!1),ji(!1),Vn(null),alert(` Data restored from backup!

Backup: ${h.backupName}
Date: ${new Date(h.backupTimestamp).toLocaleString()}

Schedule Items: ${h.scheduleData.length}
Custom Columns: ${h.customColumnsData.length}`)}catch(h){console.error(" Error restoring from backup:",h),alert(` Error restoring from backup: ${h.message}`)}},hp=async h=>{if(confirm("Are you sure you want to delete this backup?"))try{console.log(" Deleting backup:",h),await Ql.deleteBackup(h),console.log(" Backup deleted successfully"),alert("Backup deleted successfully"),await Hu()}catch(C){console.error(" Error deleting backup:",C),alert(`Error deleting backup: ${C.message}`)}};I.useEffect(()=>{if(!e?.id){console.log(" No event ID, skipping change detection");return}console.log(" Starting change detection for event:",e.id),Eo();const h=async()=>{try{if(Mt){console.log(" Skipping sync check - user just made a change"),rr(!1),Eo();return}if(Gt){console.log(" Skipping sync check - user is actively editing");return}console.log(" Running change check...");const D=await it.checkForChanges(e.id,Ce??void 0);D.hasChanges?(console.log(" Changes detected:",D),T(!0),P({show:!0,lastModifiedBy:D.lastModifiedBy,lastModifiedByName:D.lastModifiedByName}),Ca?(console.log(" Loading changes automatically..."),await Bu()):console.log(" Changes detected but page not visible - will load when page becomes visible")):console.log(" No changes detected")}catch(D){console.error(" Error checking for changes:",D)}};h();const C=setInterval(h,300*1e3);return()=>{clearInterval(C),gl()}},[e?.id,Ce,Ca,gl]),I.useEffect(()=>{Ca&&X&&(console.log(" Page became visible with pending changes - loading changes..."),Bu())},[Ca,X]),I.useEffect(()=>{Vi&&e?.id&&Hu()},[Vi,e?.id]),I.useEffect(()=>{const h=()=>{const C=!document.hidden;console.log(` Page visibility changed: ${C?"visible":"hidden"}`),ci(C),C?(console.log(" Page became visible, checking for changes..."),pp()):(un(new Date),console.log(" Page became hidden, recording last sync time"))};return document.addEventListener("visibilitychange",h),()=>document.removeEventListener("visibilitychange",h)},[]);const pp=async()=>{if(!e?.id||!vl){console.log(" No event ID or last sync time, skipping change check");return}try{console.log(" Checking for changes since last sync...");const h=await it.getRunOfShowData(e.id);if(h){const C=new Date(h.last_change_at||new Date);console.log(" Latest change time:",C),console.log(" Last sync time:",vl),C>vl?(console.log(" Changes detected since last sync, updating local data..."),A(h.schedule_items||[]),H(h.custom_columns||[]),localStorage.setItem(`runOfShowSchedule_${e.id}`,JSON.stringify(h.schedule_items||[])),localStorage.setItem(`customColumns_${e.id}`,JSON.stringify(h.custom_columns||[])),console.log(" Local data updated with latest changes")):console.log(" No changes detected since last sync")}}catch(h){console.error(" Error checking for changes on return:",h)}};I.useEffect(()=>{e?.id&&(localStorage.setItem(`runOfShowSchedule_${e.id}`,JSON.stringify(S)),window.dispatchEvent(new CustomEvent("scheduleUpdated",{detail:{eventId:e.id,schedule:S}})),console.log(" Schedule saved and event dispatched for event:",e.id),Gt?(console.log(" User-initiated schedule change detected - auto-saving"),ps()):console.log(" Schedule change from API/sync - skipping auto-save"))},[S,e?.id,ps,Gt]),I.useEffect(()=>{if(!e?.id)return;const h=()=>{console.log(" Updating graphics data for live JSON files..."),localStorage.setItem(`runOfShowSchedule_${e.id}`,JSON.stringify(S)),localStorage.setItem(`customColumns_${e.id}`,JSON.stringify(W)),localStorage.setItem(`eventName_${e.id}`,K),localStorage.setItem(`masterStartTime_${e.id}`,ye),localStorage.setItem(`dayStartTimes_${e.id}`,JSON.stringify(ve)),window.dispatchEvent(new CustomEvent("scheduleUpdated",{detail:{eventId:e.id,schedule:S}}))};h();const C=setInterval(h,30*1e3);return()=>clearInterval(C)},[e?.id,S,W,K,ye,ve]),I.useEffect(()=>{e?.id&&(localStorage.setItem(`customColumns_${e.id}`,JSON.stringify(W)),Gt?(console.log(" User-initiated custom columns change detected - auto-saving"),ps()):console.log(" Custom columns change from API/sync - skipping auto-save"))},[W,e?.id,ps,Gt]),I.useEffect(()=>{e?.id&&(localStorage.setItem(`eventName_${e.id}`,K),Gt?(console.log(" User-initiated event name change detected - auto-saving"),ps()):console.log(" Event name change from API/sync - skipping auto-save"))},[K,e?.id,ps,Gt]),I.useEffect(()=>{e?.id&&(localStorage.setItem(`masterStartTime_${e.id}`,ye),Gt?(console.log(" User-initiated master start time change detected - auto-saving"),ps()):console.log(" Master start time change from API/sync - skipping auto-save"))},[ye,e?.id,ps,Gt]),I.useEffect(()=>{e?.id&&(localStorage.setItem(`dayStartTimes_${e.id}`,JSON.stringify(ve)),Gt?(console.log(" User-initiated day start times change detected - auto-saving"),ps()):console.log(" Day start times change from API/sync - skipping auto-save"))},[ve,e?.id,ps,Gt]),I.useEffect(()=>{if(Fr&&!Fr.closed){const h=Object.keys(ct),C=h.length>0?S.find(V=>ct[V.id]):S.find(V=>V.id===Y),D={type:"TIMER_UPDATE",isRunning:h.length>0,elapsedTime:C&&se[C.id]?se[C.id].elapsed:0,totalDuration:C&&se[C.id]?se[C.id].total:C?C.durationHours*3600+C.durationMinutes*60+C.durationSeconds:0,eventId:e?.id,itemId:C?.id,mainTimer:C?{cue:C.customFields.cue||"CUE",segmentName:C.segmentName||""}:null,secondaryTimer:qt?{itemId:qt.itemId,remaining:qt.remaining,duration:qt.duration,cue:S.find(V=>V.id===qt.itemId)?.customFields.cue||"CUE",segmentName:S.find(V=>V.id===qt.itemId)?.segmentName||""}:null};Fr.postMessage(D,"*")}},[ct,se,Y,S,ye,K,Fr,qt]);const vp=h=>{const C=()=>{const re="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let ue="";for(let be=0;be<5;be++)ue+=re.charAt(Math.floor(Math.random()*re.length));return ue},D={...h,id:Date.now(),timerId:C(),isIndented:h.isIndented||!1,customFields:{cue:h.cue?`CUE${h.cue}`:"CUE"}};ze!==null?(A(re=>{const ue=[...re];return ue.splice(ze+1,0,D),ue}),oe(null)):A(re=>[...re,D]);const V=ze!==null?ze+2:S.length+1;Q("ADD_ITEM",`Added new schedule item: "${D.segmentName}"`,{changeType:"ADD",itemId:D.id,itemName:D.segmentName,rowNumber:V,cueNumber:D.customFields.cue?parseInt(D.customFields.cue,10):null,details:{day:D.day,programType:D.programType,shotType:D.shotType,position:`Row ${V}`,durationHours:D.durationHours,durationMinutes:D.durationMinutes,totalDurationMinutes:D.durationHours*60+D.durationMinutes,speakers:D.speakers||"None",speakersText:D.speakersText||"None",notes:D.notes||"",assets:D.assets||"None",hasPPT:D.hasPPT,hasQA:D.hasQA,timerId:D.timerId,isPublic:D.isPublic,isIndented:D.isIndented}}),de(!1),Sn(),an({cue:"",day:ie,programType:"PreShow/End",shotType:"",segmentName:"",durationHours:0,durationMinutes:0,durationSeconds:0,notes:"",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!1,timerId:"",isPublic:!1,isIndented:!1,customFields:{}})},m0=h=>{const C={name:h,id:Date.now().toString()};H(D=>[...D,C]),A(D=>D.map(V=>({...V,customFields:{...V.customFields,[h]:""}}))),Q("COLUMN_ADD",`Added custom column "${h}"`,{changeType:"COLUMN_ADD",columnName:h,details:{columnType:"text",affectedItems:S.length,defaultValue:""}}),ft(!1),Sn()},gp=h=>{const C=W.find(D=>D.id===h);C&&(H(D=>D.filter(V=>V.id!==h)),A(D=>D.map(V=>{const{[C.name]:re,...ue}=V.customFields;return{...V,customFields:ue}})),Q("COLUMN_REMOVE",`Removed custom column "${C.name}"`,{changeType:"COLUMN_REMOVE",columnName:C.name,details:{affectedItems:S.length,columnId:C.id}}))},Br=(h,C)=>{h.preventDefault(),h.stopPropagation();const D=h.clientX,V=zt[C]||256;document.body.style.cursor="col-resize",document.body.style.userSelect="none";const re=be=>{const ke=be.clientX-D,Fe=Math.max(100,V+ke);_u(qe=>({...qe,[C]:Fe}))},ue=()=>{document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",re),document.removeEventListener("mouseup",ue)};document.addEventListener("mousemove",re),document.addEventListener("mouseup",ue)},Dc=(h,C)=>{h.preventDefault(),h.stopPropagation();const D=h.clientX,V=ui[C]||256;document.body.style.cursor="col-resize",document.body.style.userSelect="none";const re=be=>{const ke=be.clientX-D,Fe=Math.max(100,V+ke);mc(qe=>({...qe,[C]:Fe}))},ue=()=>{document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",re),document.removeEventListener("mouseup",ue)};document.addEventListener("mousemove",re),document.addEventListener("mouseup",ue)},Sl=async h=>{if(!(!i||!e?.id))if(ct[h]){clearInterval(rn[h]);const C=`${h}_drift`;ct[C]&&clearInterval(rn[C]),nr(V=>{const re={...V};return delete re[h],delete re[C],re}),An(V=>{const re={...V};return delete re[h],delete re[C],re}),Re(V=>{const re=new Set(V);return re.delete(h),re}),Lr(V=>{const re={...V,[h]:!0};return console.log(" ToggleTimer: Updated completedCues for main item:",h,"new state:",re),re}),Nn(V=>new Set([...V,h]));try{const V=S.find(re=>re.id===h);await it.markCueCompleted(e.id,h,V?.customFields?.cue||"CUE",i.id,i.full_name||i.email||"Unknown User",c||"VIEWER")}catch(V){console.warn(" Failed to mark cue as completed in database:",V),console.log(" This means the completed_cues table needs to be created first")}const D=S.findIndex(V=>V.id===h);if(console.log(" ToggleTimer: Current index for item",h,":",D),D!==-1){console.log(" ToggleTimer: Looking for indented items after index",D);for(let V=D+1;V<S.length;V++)if(console.log(" ToggleTimer: Checking item at index",V,":",S[V].segmentName,"isIndented:",S[V].isIndented),S[V].isIndented){console.log(" ToggleTimer: Marking indented item as completed:",S[V].id,S[V].segmentName),Lr(re=>{const ue={...re,[S[V].id]:!0};return console.log(" ToggleTimer: Updated completedCues for indented item:",S[V].id,"new state:",ue),ue}),Nn(re=>new Set([...re,S[V].id]));try{await it.markCueCompleted(e.id,S[V].id,S[V].customFields?.cue||"CUE",i.id,i.full_name||i.email||"Unknown User",c||"VIEWER"),console.log(" ToggleTimer: Successfully marked indented item as completed in database:",S[V].id)}catch(re){console.error(" ToggleTimer: Failed to mark indented item as completed in database:",S[V].id,re)}}else{console.log(" ToggleTimer: Hit non-indented item, stopping search at index",V);break}}else console.log(" ToggleTimer: Could not find current item in schedule:",h);ir(V=>{const re={...V};return delete re[h],re}),Y===h&&ae(null),xe(V=>{const re={...V};return delete re[h],re}),qt&&(console.log(" Stopping sub-cue timer because main timer was stopped"),await Wi()),console.log(" Stopping timer in API for item:",h),await it.stopTimer(e.id,h,i.id,i.full_name||i.email||"Unknown User",c||"VIEWER"),console.log(" Timer stopped in API");try{await it.updateLastLoadedCue(e.id,h,"stopped"),console.log(" Last loaded CUE saved as stopped")}catch(V){console.log(" Could not save last loaded CUE as stopped (migration may not be run):",V)}await wo()}else{if(Object.keys(ct).length>0)return;const C=S.find(D=>D.id===h);if(C){const D=C.durationHours*3600+C.durationMinutes*60+C.durationSeconds;console.log(" Optimistic UI update - showing running state immediately");const V=new Date;xe(qe=>({...qe,[h]:{elapsed:0,total:D,startedAt:V}}));const re=setInterval(()=>{xe(qe=>{if(qe[h]){const nt=Date.now(),mt=qe[h].startedAt;let Pt;mt instanceof Date?Pt=mt.getTime():typeof mt=="string"?Pt=new Date(mt).getTime():(console.warn(" startedAt is not a Date or string:",mt),Pt=nt);const $t=Math.floor((nt-Pt)/1e3),Kr=D-$t;return $t<=10&&console.log(` Timer ${h}: Elapsed=${$t}s, Remaining=${Kr}s, Start=${new Date(Pt).toISOString()}, Now=${new Date(nt).toISOString()}`),{...qe,[h]:{...qe[h],elapsed:$t}}}return qe})},1e3);An(qe=>({...qe,[h]:re})),nr(qe=>({...qe,[h]:!0})),console.log(` Timer ${h} started - WebSocket will handle all synchronization`),console.log(` Timer ${h} will receive updates via WebSocket`);const be=S.findIndex(qe=>qe.id===h)+1,ke=nn(C.customFields.cue),Fe=C.timerId;console.log(" Starting timer in API for item:",h,"at:",V.toISOString(),"row:",be,"cue:",ke,"timerId:",Fe);try{const qe=await it.startTimer(e.id,h,i.id,D,V,be,ke,Fe);console.log(" Timer started in API:",qe),qe||console.error(" Start timer failed - check database connection and functions")}catch(qe){console.error(" Start timer error:",qe)}try{await it.updateLastLoadedCue(e.id,h,"running"),console.log(" Last loaded CUE saved as running")}catch(qe){console.log(" Could not save last loaded CUE as running (migration may not be run):",qe)}console.log(" Timer started locally with drift detection enabled"),await wo(),Nn(qe=>{const nt=new Set(qe);nt.delete(h);const mt=S.findIndex(Pt=>Pt.id===h);if(mt!==-1)for(let Pt=mt+1;Pt<S.length&&S[Pt].isIndented;Pt++)nt.delete(S[Pt].id);return nt})}}},xp=async h=>{if(!i||!e?.id)return;const C=S.find(D=>D.id===h);if(C&&Xr[h]){const D=C.durationHours*3600+C.durationMinutes*60+C.durationSeconds;console.log(" Starting secondary timer for item:",h,"Duration:",D,"s"),Se(re=>({...re,[h]:{elapsed:0,total:D,startedAt:new Date}}));const V=setInterval(()=>{Se(re=>{const ue=re[h];if(!ue)return re;const be=Math.floor((Date.now()-(ue.startedAt?.getTime()||Date.now()))/1e3);return Math.max(0,ue.total-be),{...re,[h]:{...ue,elapsed:be}}}),Ln(re=>{if(!re)return null;if(Oo)return re;const ue=re.startedAt?.getTime()||Date.now(),be=Math.floor((Date.now()-ue)/1e3),ke=Math.max(0,re.duration-be);if(ke===0){console.log(" Sub-cue timer reached 0 - holding for a beat");const Fe=e?.id;console.log(" Current event ID for database call:",Fe),setTimeout(()=>{console.log(" Sub-cue timer auto-stopping after hold - clearing local state"),xn&&(clearInterval(xn),cn(null)),Object.keys(Cr).forEach(qe=>{Cr[parseInt(qe)]&&clearInterval(Cr[parseInt(qe)])}),gn({}),Se({}),Ln(null),setTimeout(async()=>{try{if(Fe){console.log(" Clearing sub-cue timer from database after 3s delay with event ID:",Fe);const qe=await it.stopSubCueTimer(Fe);console.log(" Database stop result:",qe),console.log(" Sub-cue timer stopped in database (is_active = false)")}else console.error(" No event ID available for database call")}catch(qe){console.error(" Error stopping sub-cue timer in database:",qe),console.error(" Error details:",qe)}},3e3)},1e3)}return{...re,remaining:ke}})},1e3);gn(re=>({...re,[h]:V})),Ln({itemId:h,remaining:D,duration:D,isActive:!0,startedAt:new Date,timerState:"running"});try{console.log(" User ID:",i.id,"Event ID:",e.id);const re=S.find(Fe=>Fe.id===h),ue=S.findIndex(Fe=>Fe.id===h)+1,be=re?nn(re.customFields.cue):`CUE ${h}`,ke=re?.timerId||`SUB${h}`;try{console.log(" Starting sub-cue timer for item:",h,"(will auto-stop any existing timers)");const Fe=await it.startSubCueTimer(e.id,h,i.id,D,ue,be,ke,i.full_name||i.email||"Unknown User",c||"VIEWER");console.log(" Secondary timer started in Supabase for item:",h,"Result:",Fe),Fe?.error&&console.error(" Secondary timer database error:",Fe.error)}catch(Fe){console.error(" Secondary timer call failed:",Fe)}try{console.log(" Sub-cue timer started locally"),console.log(" Secondary timer action broadcasted")}catch(Fe){console.error(" Error broadcasting secondary timer action:",Fe)}await bl()}catch(re){console.error(" Error starting secondary timer:",re),clearInterval(V),gn(ue=>{const be={...ue};return delete be[h],be}),Se(ue=>{const be={...ue};return delete be[h],be})}}},Wi=async()=>{if(e?.id){console.log(" Stopping secondary timer..."),Ln(null),xn&&(clearInterval(xn),cn(null)),Object.keys(Cr).forEach(h=>{Cr[parseInt(h)]&&clearInterval(Cr[parseInt(h)])}),gn({}),Se({}),console.log(" Local secondary timer state cleared");try{console.log(" Stopping sub-cue timer in database with event ID:",e.id);const h=await it.stopSubCueTimer(e.id);console.log(" Database stop result:",h),console.log(" Secondary timer stopped in database (is_active = false)");try{console.log(" Broadcasting STOP_SECONDARY_TIMER action..."),console.log(" Sub-cue timer stopped locally"),console.log(" Secondary timer stop action broadcasted successfully")}catch(C){console.error(" Error broadcasting secondary timer stop action:",C)}}catch(h){console.error(" Error stopping sub-cue timer in database:",h),console.error(" Error details:",h)}try{await bl()}catch(h){console.error(" Error loading updated timer from Supabase:",h)}}},bp=h=>{if(!h)return"";let C=h.toString().trim();return C=C.replace(/^CUE\s*/i,""),C=C.trim(),C},Np=async h=>{try{console.log(" Processing Excel import:",h);const C=`This will add ${h.length} new items to your schedule. Continue?`;if(!window.confirm(C)){console.log(" Excel import cancelled by user");return}const D=h.map((V,re)=>{const ue=V.duration?V.duration.split(":"):["0","0","0"],be=parseInt(ue[0])||0,ke=parseInt(ue[1])||0,Fe=parseInt(ue[2])||0,qe=Math.max(...S.map(mt=>mt.id),0)+re+1;let nt=V.speakers||"";if(V.speakers)try{const mt=JSON.parse(V.speakers);if(Array.isArray(mt)){const Pt=mt.map($t=>({...$t,photoLink:$t.photoUrl||$t.photoLink||"",photoUrl:void 0}));nt=JSON.stringify(Pt)}}catch(mt){console.warn("Failed to transform speaker data:",mt)}return{id:qe,segmentName:V.segmentName||`Imported Item ${re+1}`,programType:V.programType||"",shotType:V.shotType||"",durationHours:be,durationMinutes:ke,durationSeconds:Fe,notes:V.notes||"",assets:V.assets||"",speakers:nt,speakersText:nt,hasPPT:V.hasPPT||!1,hasQA:V.hasQA||!1,timerId:V.timerId||"",isPublic:V.isPublic||!1,isIndented:V.isIndented||!1,day:V.day||ie,customFields:{cue:bp(V.cue)||`CUE ${re+1}`,...V.customFields}}});A(V=>[...V,...D]),console.log(" Imported items with assets:",D.filter(V=>V.assets).map(V=>({id:V.id,segmentName:V.segmentName,assets:V.assets}))),Q("IMPORT_EXCEL",`Imported ${D.length} items from Excel`,{changeType:"IMPORT",itemCount:D.length,source:"Excel"}),console.log(" Excel import completed successfully")}catch(C){console.error(" Error importing Excel data:",C),alert("Error importing Excel data. Please check the file format and try again.")}},Dp=()=>{try{const h=S.length;A([]),Q("DELETE_ALL",`Deleted all ${h} schedule items`,{changeType:"DELETE_ALL",itemCount:h,source:"Excel Import Modal"}),console.log(` Deleted all ${h} schedule items`)}catch(h){console.error(" Error deleting all schedule items:",h),alert("Error deleting schedule items. Please try again.")}},Wu=h=>{if(window.confirm("Delete this schedule item?")){const C=S.find(D=>D.id===h);if(A(D=>D.filter(V=>V.id!==h)),L(null),C){const D=S.findIndex(V=>V.id===h)+1;Q("REMOVE_ITEM",`Deleted schedule item: "${C.segmentName}"`,{changeType:"DELETE",itemId:C.id,itemName:C.segmentName,rowNumber:D,cueNumber:C.customFields.cue?parseInt(C.customFields.cue,10):null,details:{day:C.day,programType:C.programType,shotType:C.shotType,position:`Row ${D}`,durationHours:C.durationHours,durationMinutes:C.durationMinutes,totalDurationMinutes:C.durationHours*60+C.durationMinutes,speakers:C.speakers||"None",speakersText:C.speakersText||"None",notes:C.notes||"",assets:C.assets||"None",hasPPT:C.hasPPT,hasQA:C.hasQA,timerId:C.timerId,isPublic:C.isPublic,isIndented:C.isIndented}})}}},Sc=(h,C)=>{const D=S.findIndex(ke=>ke.id===h);if(D===-1)return;const V=C==="up"?D-1:D+1;if(V<0||V>=S.length)return;const re=S[D],ue=D+1,be=V+1;A(ke=>{const Fe=[...ke];return[Fe[D],Fe[V]]=[Fe[V],Fe[D]],Fe}),re&&Q("MOVE_ITEM",`Moved "${re.segmentName}" from row ${ue} to row ${be}`,{changeType:"MOVE",itemId:re.id,itemName:re.segmentName,details:{fromRow:ue,toRow:be,direction:C}}),L(null)},_o=(h,C)=>{const D=S.findIndex(ke=>ke.id===h);if(D===-1)return;const V=C-1;if(V<0||V>=S.length||V===D)return;const re=S[D],ue=D+1,be=C;A(ke=>{const Fe=[...ke],qe=Fe[D];return Fe.splice(D,1),Fe.splice(V,0,qe),Fe}),re&&Q("MOVE_ITEM",`Moved "${re.segmentName}" from row ${ue} to row ${be}`,{changeType:"MOVE",itemId:re.id,itemName:re.segmentName,details:{fromRow:ue,toRow:be,direction:"specific"}}),L(null)},fi=h=>{const C=S[h];if(!C||C.isIndented)return"";const D=C.day||1,V=ve[D]||ye;if(!V)return"";let re=0;for(let Pt=0;Pt<h;Pt++){const $t=S[Pt];($t.day||1)===D&&!$t.isIndented&&(re+=($t.durationHours||0)*3600+($t.durationMinutes||0)*60+($t.durationSeconds||0))}const[ue,be]=V.split(":").map(Number),Fe=ue*3600+be*60+re,qe=Math.floor(Fe/3600)%24,nt=Math.floor(Fe%3600/60),mt=new Date;return mt.setHours(qe,nt,0,0),mt.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},Qa=()=>{const h=S.filter(C=>(C.day||1)===ie);return S.filter(C=>C.isIndented),h.filter(C=>C.isIndented),h};return I.useEffect(()=>{const h=()=>{const C=window.pageYOffset||document.documentElement.scrollTop;Ts(C>100)};return window.addEventListener("scroll",h),()=>window.removeEventListener("scroll",h)},[]),I.useEffect(()=>{const h=document.getElementById("main-scroll-container");if(!h)return;let C=!1;const D=(be,ke)=>{C||(C=!0,ke.scrollLeft=be.scrollLeft,requestAnimationFrame(()=>{C=!1}))},V=()=>{const be=document.querySelector(".sticky-header-scroll-container");be&&D(h,be)},re=()=>{const be=document.querySelector(".sticky-header-scroll-container");be&&D(be,h)};h.addEventListener("scroll",V);const ue=new MutationObserver(()=>{const be=document.querySelector(".sticky-header-scroll-container");be&&be.addEventListener("scroll",re)});return ue.observe(document.body,{childList:!0,subtree:!0}),()=>{h.removeEventListener("scroll",V),ue.disconnect()}},[]),I.useEffect(()=>{Y!==null&&setTimeout(()=>{ep()},100)},[Y,Kn]),I.useEffect(()=>{if(Kn&&Object.keys(ct).length>0){const h=parseInt(Object.keys(ct)[0]),C=document.querySelector(`[data-item-id="${h}"]`);C&&setTimeout(()=>{const D=document.querySelector("#main-scroll-container .h-24");let V=100;if(D){const be=D.getBoundingClientRect(),ke=document.querySelector("#main-scroll-container")?.getBoundingClientRect();ke&&(V=be.bottom-ke.top-120)}const re=C.getBoundingClientRect(),ue=document.querySelector("#main-scroll-container")?.getBoundingClientRect();if(ue){const be=re.top-ue.top-V;window.scrollTo({top:be,behavior:"smooth"})}},100)}},[ct,Kn]),e?l.jsxDEV("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 text-slate-200",children:[!Ca&&l.jsxDEV("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 bg-yellow-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2",children:[l.jsxDEV("div",{className:"w-2 h-2 bg-yellow-300 rounded-full animate-pulse"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6687,columnNumber:11},void 0),l.jsxDEV("span",{className:"text-sm font-medium",children:"Tab Hidden - Syncing Paused"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6688,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6686,columnNumber:9},void 0),l.jsxDEV(ow,{isOpen:p,onClose:()=>g(!1),onRoleSelected:h=>{if(f(h),e?.id&&i?.id)try{const C=i.full_name||i.email||"Unknown";it.saveUserSession(e.id,i.id,C,h).then(D=>{D?console.log(" Role saved to API from RunOfShowPage:",h):console.log(" Failed to save role to API, using localStorage only")}),localStorage.setItem(`userRole_${e.id}`,h),console.log(" Saved role to localStorage from RunOfShowPage:",h)}catch(C){console.error(" Failed to save role to API from RunOfShowPage:",C),localStorage.setItem(`userRole_${e.id}`,h),console.log(" Saved role to localStorage as fallback:",h)}g(!1)},eventId:e?.id||""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6693,columnNumber:7},void 0),r0&&vc&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg p-6 max-w-md w-full mx-4 border-2 border-orange-500",children:l.jsxDEV("div",{className:"text-center",children:[l.jsxDEV("div",{className:"text-orange-400 text-2xl font-bold mb-4",children:" Timer Running"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6731,columnNumber:15},void 0),l.jsxDEV("div",{className:"text-white text-lg mb-2",children:l.jsxDEV("strong",{children:vc.cueName},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6735,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6734,columnNumber:15},void 0),l.jsxDEV("div",{className:"text-orange-300 text-xl font-mono mb-6",children:[vc.remainingTime," remaining"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6737,columnNumber:15},void 0),l.jsxDEV("div",{className:"flex gap-3 justify-center",children:[l.jsxDEV("button",{onClick:()=>xl(!1),className:"px-6 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded transition-colors",children:"Dismiss"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6741,columnNumber:17},void 0),l.jsxDEV("button",{onClick:()=>{xl(!1),js()},className:"px-6 py-2 bg-orange-600 hover:bg-orange-500 text-white rounded transition-colors",children:"Sync Timer"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6747,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6740,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6730,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6729,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6728,columnNumber:9},void 0),x&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden flex flex-col",children:[l.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[l.jsxDEV("div",{className:"flex items-center gap-4",children:[l.jsxDEV("h2",{className:"text-2xl font-bold text-white",children:"Change Log"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6768,columnNumber:15},void 0),l.jsxDEV("div",{className:"flex gap-2",children:[l.jsxDEV("button",{onClick:()=>q(!1),className:`px-3 py-1 rounded text-sm transition-colors ${U?"bg-slate-600 text-slate-300 hover:bg-slate-500":"bg-blue-600 text-white"}`,children:["Local (",E.length,")"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6770,columnNumber:19},void 0),l.jsxDEV("button",{onClick:()=>q(!0),className:`px-3 py-1 rounded text-sm transition-colors ${U?"bg-blue-600 text-white":"bg-slate-600 text-slate-300 hover:bg-slate-500"}`,children:["Master (",R.length,")"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6780,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6769,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6767,columnNumber:15},void 0),l.jsxDEV("div",{className:"flex items-center gap-2",children:[!U&&l.jsxDEV("div",{className:"flex gap-2",children:[l.jsxDEV("button",{onClick:ju,className:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white text-sm rounded transition-colors",title:"Sync changes to Supabase",children:" Sync"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6795,columnNumber:21},void 0),l.jsxDEV("button",{onClick:()=>{Bn.reloadLocalChanges();const h=Bn.getLocalChanges();w(h.slice(0,100)),console.log(" Manually reloaded local changes:",h.length)},className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",title:"Reload local changes",children:" Reload"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6802,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6794,columnNumber:19},void 0),U&&l.jsxDEV("button",{onClick:Co,className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",title:"Reload master change log",children:" Reload"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6817,columnNumber:19},void 0),l.jsxDEV("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-white text-2xl",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6825,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6792,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6766,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:U?R.length===0?l.jsxDEV("p",{className:"text-gray-400 text-center py-8",children:"No master changes found"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6838,columnNumber:19},void 0):l.jsxDEV("div",{className:"space-y-3",children:R.map(h=>l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-4",children:[l.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("span",{className:`text-white text-xs px-2 py-1 rounded ${h.action==="ADD_ITEM"?"bg-green-600":h.action==="REMOVE_ITEM"?"bg-red-600":h.action==="FIELD_UPDATE"?"bg-blue-600":h.action==="MOVE_ITEM"?"bg-yellow-600":h.action==="COLUMN_ADD"?"bg-purple-600":h.action==="COLUMN_REMOVE"?"bg-orange-600":"bg-blue-600"}`,children:h.action},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6845,columnNumber:29},void 0),l.jsxDEV("span",{className:"text-gray-300 text-sm",children:["by ",h.user_name]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6856,columnNumber:29},void 0),l.jsxDEV("span",{className:"text-gray-500 text-xs",children:["(",h.user_role,")"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6859,columnNumber:29},void 0),h.row_number&&l.jsxDEV("span",{className:"text-gray-400 text-xs bg-slate-600 px-2 py-1 rounded",children:["ROW ",h.row_number]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6863,columnNumber:31},void 0),h.cue_number&&h.cue_number!=="CUE"&&l.jsxDEV("span",{className:"text-gray-400 text-xs bg-slate-600 px-2 py-1 rounded",children:nn(h.cue_number)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6868,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6844,columnNumber:27},void 0),l.jsxDEV("div",{className:"text-gray-400 text-xs",children:new Date(h.timestamp||h.change_timestamp).toLocaleString()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6873,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6843,columnNumber:25},void 0),h.details&&l.jsxDEV("div",{className:"space-y-1 text-sm",children:[h.details.fieldName&&l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Field:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6884,columnNumber:33},void 0)," ",h.details.fieldName]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6883,columnNumber:31},void 0),h.details.oldValue!==void 0&&h.details.newValue!==void 0&&l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Changed from:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6891,columnNumber:33},void 0),l.jsxDEV("span",{className:"text-red-300 ml-1",children:['"',h.details.oldValue,'"']},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6892,columnNumber:33},void 0),l.jsxDEV("span",{className:"text-slate-400 mx-1",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6893,columnNumber:33},void 0),l.jsxDEV("span",{className:"text-green-300",children:['"',h.details.newValue,'"']},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6894,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6890,columnNumber:31},void 0),h.batch_id&&l.jsxDEV("div",{className:"text-gray-500 text-xs mt-2 pt-2 border-t border-slate-600",children:["Batch: ",h.batch_id.slice(0,8),"... | Synced: ",new Date(h.batch_created_at).toLocaleString()]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6900,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6880,columnNumber:27},void 0)]},h.id,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6842,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6840,columnNumber:19},void 0):E.length===0&&G.size===0?l.jsxDEV("p",{className:"text-gray-400 text-center py-8",children:"No local changes recorded yet"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6914,columnNumber:19},void 0):l.jsxDEV("div",{className:"space-y-3",children:[E.map(h=>l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-4",children:[l.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("span",{className:`text-white text-xs px-2 py-1 rounded ${h.action==="ADD_ITEM"?"bg-green-600":h.action==="REMOVE_ITEM"?"bg-red-600":h.action==="FIELD_UPDATE"?"bg-blue-600":h.action==="MOVE_ITEM"?"bg-yellow-600":h.action==="COLUMN_ADD"?"bg-purple-600":h.action==="COLUMN_REMOVE"?"bg-orange-600":h.action==="AUTO_SAVE"?"bg-gray-600":"bg-blue-600"}`,children:h.action},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6921,columnNumber:27},void 0),h.details?.processedBy&&l.jsxDEV("span",{className:`text-white text-xs px-2 py-1 rounded ${h.details.processedBy==="TIMEOUT"?"bg-orange-600":h.details.processedBy==="SAVE_BUTTON"?"bg-purple-600":"bg-gray-600"}`,children:h.details.processedBy},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6934,columnNumber:29},void 0),l.jsxDEV("span",{className:"text-gray-300 text-sm",children:["by ",h.userName]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6942,columnNumber:27},void 0),h.details?.itemId&&l.jsxDEV("span",{className:"text-gray-400 text-xs",children:["Item #",h.details.itemId]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6946,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6920,columnNumber:25},void 0),l.jsxDEV("div",{className:"text-gray-400 text-xs",children:h.timestamp.toLocaleString()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6951,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6919,columnNumber:23},void 0),h.details&&l.jsxDEV("div",{className:"space-y-1 text-sm",children:[(h.details?.rowNumber||h.details?.cueNumber)&&l.jsxDEV("div",{className:"text-gray-300",children:l.jsxDEV("strong",{children:["Row ",h.details?.rowNumber||"?"," | ",h.details?.cueNumber||"CUE"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6961,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6960,columnNumber:29},void 0),h.action==="ADD_ITEM"&&h.details.details&&l.jsxDEV("div",{className:"space-y-1",children:[l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Program Type:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6969,columnNumber:33},void 0)," ",h.details.details.programType]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6968,columnNumber:31},void 0),l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Shot Type:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6972,columnNumber:33},void 0)," ",h.details.details.shotType]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6971,columnNumber:31},void 0),l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Duration:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6975,columnNumber:33},void 0)," ",h.details.details.durationHours,"h ",h.details.details.durationMinutes,"m"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6974,columnNumber:31},void 0),l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Speakers:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6978,columnNumber:33},void 0)," ",h.details.details.speakers]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6977,columnNumber:31},void 0),h.details.details.notes&&l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Notes:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6982,columnNumber:35},void 0)," ",h.details.details.notes]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6981,columnNumber:33},void 0),l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Position:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6986,columnNumber:33},void 0)," ",h.details.details.position]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6985,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6967,columnNumber:29},void 0),h.action==="REMOVE_ITEM"&&h.details.details&&l.jsxDEV("div",{className:"space-y-1",children:[l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Program Type:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6995,columnNumber:33},void 0)," ",h.details.details.programType]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6994,columnNumber:31},void 0),l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Shot Type:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6998,columnNumber:33},void 0)," ",h.details.details.shotType]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6997,columnNumber:31},void 0),l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Duration:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7001,columnNumber:33},void 0)," ",h.details.details.durationHours,"h ",h.details.details.durationMinutes,"m"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7e3,columnNumber:31},void 0),l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Speakers:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7004,columnNumber:33},void 0)," ",h.details.details.speakers]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7003,columnNumber:31},void 0),h.details.details.notes&&l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Notes:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7008,columnNumber:35},void 0)," ",h.details.details.notes]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7007,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6993,columnNumber:29},void 0),h.action!=="ADD_ITEM"&&h.action!=="REMOVE_ITEM"&&h.details.fieldName&&l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Field:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7017,columnNumber:31},void 0)," ",h.details.fieldName]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7016,columnNumber:29},void 0),h.action!=="ADD_ITEM"&&h.action!=="REMOVE_ITEM"&&h.details.fieldName==="speakers"&&h.details.details&&l.jsxDEV("div",{className:"space-y-2",children:[l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Speaker Count:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7025,columnNumber:33},void 0)," ",h.details.details.speakerCount||0]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7024,columnNumber:31},void 0),h.details.newValue&&l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Speakers:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7029,columnNumber:35},void 0),l.jsxDEV("div",{className:"mt-1 text-sm text-blue-300",children:(()=>{try{const C=JSON.parse(h.details.newValue);if(Array.isArray(C))return C.sort((D,V)=>D.slot-V.slot).map(D=>`${D.slot}. ${D.fullName||D.name||"Unknown"} (${D.location||"Unknown"})`).join(", ")}catch{return"Unable to parse speakers"}return"No speakers"})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7030,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7028,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7023,columnNumber:29},void 0),h.action!=="ADD_ITEM"&&h.action!=="REMOVE_ITEM"&&h.details.fieldName==="assets"&&h.details.details&&l.jsxDEV("div",{className:"space-y-2",children:[l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Asset Count:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7055,columnNumber:33},void 0)," ",h.details.details.assetCount||0]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7054,columnNumber:31},void 0),h.details.newValue&&l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Assets:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7059,columnNumber:35},void 0),l.jsxDEV("div",{className:"mt-1 text-sm text-blue-300",children:h.details.newValue.split("||").filter(D=>D.trim()).map(D=>{if(D.includes("|")){const[V,re]=D.split("|");return`${V}${re?` (${re})`:""}`}return D}).join(", ")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7060,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7058,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7053,columnNumber:29},void 0),h.action==="MOVE_ITEM"&&h.details.details&&l.jsxDEV("div",{className:"space-y-1",children:[l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Moved from Row:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7081,columnNumber:33},void 0)," ",h.details.details.fromRow||"Unknown"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7080,columnNumber:31},void 0),l.jsxDEV("div",{className:"text-gray-300",children:[l.jsxDEV("strong",{children:"Moved to Row:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7084,columnNumber:33},void 0)," ",h.details.details.toRow||"Unknown"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7083,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7079,columnNumber:29},void 0),h.action!=="ADD_ITEM"&&h.action!=="REMOVE_ITEM"&&h.action!=="MOVE_ITEM"&&h.details.fieldName!=="speakers"&&h.details.fieldName!=="assets"&&h.details.oldValue!==void 0&&h.details.newValue!==void 0&&l.jsxDEV("div",{className:"text-gray-300",children:h.details.fieldName==="durationHours"||h.details.fieldName==="durationMinutes"||h.details.fieldName==="durationSeconds"?l.jsxDEV("span",{className:"text-green-300",children:h.details.newValue},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7096,columnNumber:33},void 0):l.jsxDEV(l.Fragment,{children:[l.jsxDEV("strong",{children:"Changed from:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7099,columnNumber:35},void 0),l.jsxDEV("span",{className:"text-red-300 ml-1",children:['"',h.details.oldValue,'"']},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7100,columnNumber:35},void 0),l.jsxDEV("span",{className:"text-gray-400 mx-1",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7101,columnNumber:35},void 0),l.jsxDEV("span",{className:"text-green-300",children:['"',h.details.newValue,'"']},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7102,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7098,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7093,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6958,columnNumber:25},void 0)]},h.id,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6918,columnNumber:21},void 0)),Array.from(G.entries()).map(([h,C])=>{const D=Date.now()-C.timestamp.getTime(),V=Math.max(0,1e4-D),re=Math.ceil(V/1e3);return l.jsxDEV("div",{className:"bg-slate-600 rounded-lg p-4 border-2 border-yellow-500 animate-pulse",children:[l.jsxDEV("div",{className:"flex justify-between items-start mb-2",children:[l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("span",{className:"bg-yellow-600 text-white text-xs px-2 py-1 rounded",children:["PENDING [",C.originalKey||"NO_KEY","]"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7122,columnNumber:29},void 0),l.jsxDEV("span",{className:"text-slate-300 text-sm",children:["by ",C.user]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7125,columnNumber:29},void 0),l.jsxDEV("span",{className:"text-yellow-300 text-xs",children:[" Will confirm in ",re,"s"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7128,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7121,columnNumber:27},void 0),l.jsxDEV("div",{className:"text-slate-400 text-xs",children:C.timestamp.toLocaleString()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7132,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7120,columnNumber:25},void 0),C.details&&l.jsxDEV("div",{className:"space-y-1 text-sm",children:[(C.details?.rowNumber||C.details?.cueNumber)&&l.jsxDEV("div",{className:"text-slate-300",children:l.jsxDEV("strong",{children:["Row ",C.details?.rowNumber||"?"," | ",C.details?.cueNumber||"CUE"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7142,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7141,columnNumber:31},void 0),C.details.fieldName&&l.jsxDEV("div",{className:"text-slate-300",children:[l.jsxDEV("strong",{children:"Field:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7147,columnNumber:33},void 0)," ",C.details.fieldName]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7146,columnNumber:31},void 0),C.details.oldValue!==void 0&&C.details.newValue!==void 0&&l.jsxDEV("div",{className:"text-slate-300",children:[l.jsxDEV("strong",{children:"Will change from:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7152,columnNumber:33},void 0),l.jsxDEV("span",{className:"text-red-300 ml-1",children:['"',C.details.oldValue,'"']},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7153,columnNumber:33},void 0),l.jsxDEV("span",{className:"text-slate-400 mx-1",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7154,columnNumber:33},void 0),l.jsxDEV("span",{className:"text-green-300",children:['"',C.details.newValue,'"']},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7155,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7151,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7139,columnNumber:27},void 0)]},h,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7119,columnNumber:23},void 0)})]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6916,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6834,columnNumber:13},void 0),l.jsxDEV("div",{className:"mt-4 pt-4 border-t border-slate-600",children:l.jsxDEV("div",{className:"flex justify-between items-center text-sm text-gray-400",children:[l.jsxDEV("div",{children:[l.jsxDEV("span",{children:["Total changes: ",E.length," (",G.size," pending)"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7171,columnNumber:19},void 0),G.size>0&&l.jsxDEV("span",{className:"ml-2 text-yellow-400",children:" Changes will be confirmed after 10s of inactivity"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7173,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7170,columnNumber:17},void 0),l.jsxDEV("div",{className:"flex gap-2",children:[G.size>0&&l.jsxDEV("button",{className:"px-3 py-1 bg-yellow-600 text-white rounded transition-colors animate-pulse cursor-not-allowed",disabled:!0,title:"Changes are pending and will auto-save after 5 seconds",children:[" Changes Pending (",G.size,")"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7180,columnNumber:17},void 0),l.jsxDEV("button",{onClick:Nl,className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",title:"Clear all change logs (password protected)",children:" Clear All Logs"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7188,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7178,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7169,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7168,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6765,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6764,columnNumber:9},void 0),l.jsxDEV("style",{children:`
          select {
            border: 2px solid #64748b !important;
            border-radius: 6px !important;
          }
          select:focus {
            border-color: #3b82f6 !important;
            outline: none !important;
          }
          select option {
            background-color: #1e293b !important;
            color: #ffffff !important;
            border-bottom: 1px solid #475569 !important;
            padding: 8px 12px !important;
            margin: 0 !important;
          }
          select option:hover {
            background-color: #334155 !important;
          }
          select option:checked {
            background-color: #3b82f6 !important;
          }
        `},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7202,columnNumber:7},void 0),l.jsxDEV("div",{className:"fixed top-16 left-0 right-0 z-40 bg-slate-900 shadow-lg border-b border-slate-600",style:{height:wa?"240px":"150px"},children:l.jsxDEV("div",{className:"py-2 pt-4",children:[l.jsxDEV("div",{className:"flex justify-between items-center mb-2 px-8",children:[l.jsxDEV("div",{className:"flex items-center gap-3",children:[l.jsxDEV("button",{onClick:()=>n("/"),className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:" Back to Events"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7232,columnNumber:15},void 0),l.jsxDEV("div",{className:"relative",children:[l.jsxDEV("button",{onClick:h=>{h.stopPropagation(),Ar(!Wr)},className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",title:"Menu",children:l.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7252,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7251,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7243,columnNumber:17},void 0),Wr&&l.jsxDEV("div",{className:"absolute top-full left-0 mt-1 w-48 bg-slate-800 border border-slate-600 rounded-lg shadow-lg z-50",children:l.jsxDEV("div",{className:"py-1",children:[l.jsxDEV("button",{onClick:()=>{Ar(!1),Do(!0)},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[l.jsxDEV("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7267,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7266,columnNumber:25},void 0),"Display Timer"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7259,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>{Ar(!1);const h=`/reports?eventId=${e?.id}&eventName=${encodeURIComponent(e?.name||"")}`;window.open(h,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[l.jsxDEV("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7281,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7280,columnNumber:25},void 0),"Reports and Printing"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7271,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>{Ar(!1);const h=`/graphics-links?eventId=${e?.id}&eventName=${encodeURIComponent(e?.name||"")}`;window.open(h,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[l.jsxDEV("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7295,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7294,columnNumber:25},void 0),"Graphic Links"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7285,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>{Ar(!1);const h=`/photo-view?eventId=${e?.id}&eventName=${encodeURIComponent(e?.name||"")}&eventDate=${encodeURIComponent(e?.date||"")}&eventLocation=${encodeURIComponent(e?.location||"")}`;window.open(h,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[l.jsxDEV("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7309,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7308,columnNumber:25},void 0),"PhotoView"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7299,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>{Ar(!1),console.log("=== CSV EXPORT ==="),console.log("Event:",e),console.log("Schedule length:",S.length),console.log("Full schedule:",S),console.log("Master start time:",ye);const h=["ROW","CUE","Program Type","Shot Type","Segment Name","Duration","Start Time","End Time","Notes","Assets","Speakers","Has PPT","Has QA","Timer ID","Is Public","Is Indented","Day"],C=W.map(qe=>qe.name),D=[...h,...C],re=S.filter(qe=>(qe.day||1)===ie).map((qe,nt)=>{const mt=S.findIndex($a=>$a.id===qe.id),Pt=fi(mt),$t=`${qe.durationHours}:${qe.durationMinutes.toString().padStart(2,"0")}:${qe.durationSeconds.toString().padStart(2,"0")}`,Kr=Pt?(()=>{const[$a,zu,Is]=Pt.split(":").map(Number),[yc,Oc,Xu]=$t.split(":").map(Number);let Gu=$a*3600+zu*60+Is+(yc*3600+Oc*60+Xu);const Yu=Math.floor(Gu/3600),Sp=Math.floor(Gu%3600/60),yp=Gu%60;return`${Yu.toString().padStart(2,"0")}:${Sp.toString().padStart(2,"0")}:${yp.toString().padStart(2,"0")}`})():"",Jr=[nt+1,qe.customFields?.cue||`CUE ${nt+1}`,qe.programType||"",qe.shotType||"",qe.segmentName||"",$t,Pt||"",Kr,qe.notes||"",qe.assets||"",qe.speakersText||"",qe.hasPPT?"Yes":"No",qe.hasQA?"Yes":"No",qe.timerId||"",qe.isPublic?"Yes":"No",qe.isIndented?"Yes":"No",qe.day||1],Za=W.map($a=>qe.customFields[$a.id]||"");return[...Jr,...Za]}),ue=[D.join(","),...re.map(qe=>qe.map(nt=>typeof nt=="string"&&(nt.includes(",")||nt.includes('"')||nt.includes(`
`))?`"${nt.replace(/"/g,'""')}"`:nt).join(","))].join(`
`);console.log("CSV Content:",ue);const be=new Blob([ue],{type:"text/csv;charset=utf-8;"}),ke=URL.createObjectURL(be),Fe=document.createElement("a");Fe.href=ke,Fe.download=`${e?.name||"RunOfShow"}_Day${ie}_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(Fe),Fe.click(),document.body.removeChild(Fe),URL.revokeObjectURL(ke),console.log("=== END CSV EXPORT ===")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[l.jsxDEV("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7428,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7427,columnNumber:25},void 0),"Export CSV"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7313,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>{Ar(!1),li(!0)},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[l.jsxDEV("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7440,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7439,columnNumber:19},void 0),"Import Excel"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7432,columnNumber:17},void 0),l.jsxDEV("button",{onClick:()=>{Ar(!1),ji(!0)},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[l.jsxDEV("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7452,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7451,columnNumber:25},void 0),"Backups"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7444,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>{Ar(!1);const h=`/green-room?eventId=${e?.id}&eventName=${encodeURIComponent(e?.name||"")}&eventDate=${e?.date||""}&eventLocation=${encodeURIComponent(e?.location||"")}`;window.open(h,"_blank")},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[l.jsxDEV("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7466,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7465,columnNumber:25},void 0),"Green Room"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7456,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>{Ar(!1),oi(!0)},className:"w-full px-4 py-2 text-left text-white hover:bg-slate-700 transition-colors flex items-center gap-3",children:[l.jsxDEV("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7478,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7477,columnNumber:25},void 0),"OSC Control"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7470,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7258,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7257,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7242,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7231,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex items-center gap-6",children:[l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("label",{className:"text-white font-semibold",children:"Event Name:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7491,columnNumber:17},void 0),l.jsxDEV("div",{className:"px-4 py-2 bg-slate-700 border-2 border-slate-600 rounded-lg text-white w-80 truncate",children:K||"No Event Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7492,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7490,columnNumber:15},void 0),l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("label",{className:"text-white font-semibold",children:"Start Time:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7498,columnNumber:17},void 0),l.jsxDEV("input",{type:"time",value:e?.numberOfDays&&e.numberOfDays>1?ve[ie]||"":ye,onChange:h=>{if(Pr(),c==="VIEWER"||c==="OPERATOR"){alert("Only EDITORs can change start time. Please change your role to EDITOR.");return}e?.numberOfDays&&e.numberOfDays>1?Ge(C=>({...C,[ie]:h.target.value})):Pe(h.target.value)},disabled:c==="VIEWER"||c==="OPERATOR",className:"px-4 py-2 border-2 rounded-lg focus:outline-none w-36 transition-colors bg-slate-700 border-slate-600 text-white focus:border-blue-500",style:{colorScheme:"dark"},title:c==="VIEWER"||c==="OPERATOR"?"Only EDITORs can change start time":`Set ${e?.numberOfDays&&e.numberOfDays>1?`Day ${ie}`:"master"} start time`},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7499,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7497,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7489,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex items-center gap-6",children:[l.jsxDEV("div",{className:"text-center",children:Ue?.activeTimer?l.jsxDEV("div",{className:`text-lg font-bold ${Ue.activeTimer.is_running&&Ue.activeTimer.is_active?"text-green-400":"text-yellow-400"}`,children:[Ue.activeTimer.is_running&&Ue.activeTimer.is_active?"RUNNING":"LOADED"," -                     ",(()=>{const h=Ue.activeTimer.item_id,C=S.find(D=>D.id===h||D.id===parseInt(h)||parseInt(D.id)===parseInt(h));return Math.random()<.01&&(console.log(" RunOfShow: Hybrid timer data:",Ue.activeTimer),console.log(" RunOfShow: Looking for item_id:",Ue.activeTimer.item_id,typeof Ue.activeTimer.item_id),console.log(" RunOfShow: Found schedule item:",C)),C?.customFields?.cue?nn(C.customFields.cue):(console.log(" RunOfShow: No schedule item found, using fallback"),`CUE ${h}`)})(),(Ue?.secondaryTimer||qt)&&l.jsxDEV("div",{className:"text-lg text-orange-400 mt-0.5 font-bold",children:(()=>{if(console.log(" RunOfShow: Sub-cue timer check:",{hasHybridSecondary:!!Ue?.secondaryTimer,hasOldSecondary:!!qt,hybridData:Ue?.secondaryTimer}),Ue?.secondaryTimer,Ue?.secondaryTimer){const C=S.find(ke=>ke.id===Ue.secondaryTimer.item_id||ke.id===parseInt(Ue.secondaryTimer.item_id))?.customFields?.cue||Ue.secondaryTimer.cue_display||Ue.secondaryTimer.cue||`CUE ${Ue.secondaryTimer.item_id}`,D=new Date,V=new Date(Ue.secondaryTimer.started_at||Ue.secondaryTimer.created_at),re=Math.floor((D.getTime()-V.getTime())/1e3),ue=Ue.secondaryTimer.duration_seconds||Ue.secondaryTimer.duration||60,be=Math.max(0,ue-re);return`${nn(C)} - ${Fu(be)}`}else return`${nn(S.find(h=>h.id===qt.itemId)?.customFields.cue)} - ${Fu(qt.remaining)}`})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7568,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7535,columnNumber:19},void 0):Object.keys(ct).length>0?l.jsxDEV("div",{className:"text-lg text-green-400 font-bold",children:["RUNNING - ",nn(S.find(h=>ct[h.id])?.customFields.cue),qt&&l.jsxDEV("div",{className:"text-lg text-orange-400 mt-0.5 font-bold",children:[nn(S.find(h=>h.id===qt.itemId)?.customFields.cue)," - ",Fu(qt.remaining)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7610,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7607,columnNumber:19},void 0):Y&&se[Y]?l.jsxDEV("div",{className:"text-lg text-yellow-400 font-bold",children:["LOADED - ",nn(S.find(h=>h.id===Y)?.customFields.cue)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7616,columnNumber:19},void 0):l.jsxDEV("div",{className:"text-lg text-slate-300 font-bold",children:"No CUE Selected"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7620,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7533,columnNumber:15},void 0),l.jsxDEV("div",{className:"relative",children:l.jsxDEV("div",{className:"text-3xl font-mono bg-slate-800 px-6 py-3 rounded-lg border border-slate-600",style:{color:Bi()},children:c0(lp())},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7628,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7627,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7532,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7230,columnNumber:11},void 0),l.jsxDEV("div",{className:"px-8 mb-2",children:l.jsxDEV("div",{className:"w-full h-2 bg-slate-700 rounded-full overflow-hidden border border-slate-600 relative",children:l.jsxDEV("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${cp()}%`,background:$u()}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7639,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7638,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7637,columnNumber:11},void 0),l.jsxDEV("div",{className:"px-8 pb-2",children:l.jsxDEV("div",{className:"flex items-center justify-between",children:[l.jsxDEV("div",{className:"flex items-center gap-3",children:[l.jsxDEV("div",{className:"text-sm text-slate-300",children:["Role: ",l.jsxDEV("span",{className:"font-semibold text-white",children:c},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7655,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7654,columnNumber:17},void 0),l.jsxDEV("button",{onClick:()=>g(!0),className:"px-3 py-1 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded transition-colors",title:"Change your role",children:"Change Role"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7657,columnNumber:17},void 0),l.jsxDEV("button",{onClick:d0,className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",title:"Create a manual backup of current data",children:" Create Backup"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7664,columnNumber:17},void 0),Gt&&l.jsxDEV("div",{className:"flex items-center space-x-2 px-3 py-1 bg-yellow-600 rounded text-sm",children:[l.jsxDEV("div",{className:"w-2 h-2 bg-yellow-200 rounded-full animate-pulse"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7673,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-yellow-100 font-medium",children:"Editing - Sync Paused"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7674,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7672,columnNumber:19},void 0),!Gt&&Ca&&l.jsxDEV("div",{className:"flex items-center space-x-2 px-3 py-1 bg-blue-600 rounded text-sm",children:[l.jsxDEV("div",{className:"w-2 h-2 bg-blue-200 rounded-full animate-pulse"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7681,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-blue-100 font-medium",children:Fi?"Syncing...":`Next sync in ${jr}s`},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7682,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7680,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7653,columnNumber:15},void 0),l.jsxDEV("div",{className:"flex items-center gap-4",children:[l.jsxDEV("button",{onClick:()=>ms(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white text-sm font-medium rounded transition-colors",title:"Open Filter View",children:"Filter View"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7694,columnNumber:15},void 0),l.jsxDEV("button",{onClick:()=>B(!As),className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${As?"bg-green-600 hover:bg-green-500":"bg-slate-600 hover:bg-slate-500"}`,title:As?"Disable Time Toast":"Enable Time Toast",children:" Time Toast"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7704,columnNumber:15},void 0),l.jsxDEV("button",{onClick:()=>Ii(!Kn),className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${Kn?"bg-purple-600 hover:bg-purple-500 ring-4 ring-inset ring-green-400":"bg-purple-600 hover:bg-purple-500"}`,title:Kn?"Disable auto-scroll to active row":"Enable auto-scroll to active row",children:" Follow"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7718,columnNumber:15},void 0),l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("span",{className:"text-white text-sm font-medium",children:"Duration:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7732,columnNumber:17},void 0),l.jsxDEV("button",{onClick:async()=>{if(c==="VIEWER"||c==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await Hi(-300)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${c==="VIEWER"||c==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-700 hover:bg-red-600"}`,disabled:c==="VIEWER"||c==="EDITOR",title:c==="VIEWER"||c==="EDITOR"?"Only OPERATORs can adjust timer duration":"Subtract 5 minutes",children:"-5"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7733,columnNumber:17},void 0),l.jsxDEV("button",{onClick:async()=>{if(c==="VIEWER"||c==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await Hi(-60)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${c==="VIEWER"||c==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-600 hover:bg-red-500"}`,disabled:c==="VIEWER"||c==="EDITOR",title:c==="VIEWER"||c==="EDITOR"?"Only OPERATORs can adjust timer duration":"Subtract 1 minute",children:"-1"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7751,columnNumber:17},void 0),l.jsxDEV("button",{onClick:async()=>{if(c==="VIEWER"||c==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await Hi(60)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${c==="VIEWER"||c==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500"}`,disabled:c==="VIEWER"||c==="EDITOR",title:c==="VIEWER"||c==="EDITOR"?"Only OPERATORs can adjust timer duration":"Add 1 minute",children:"+1"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7769,columnNumber:17},void 0),l.jsxDEV("button",{onClick:async()=>{if(c==="VIEWER"||c==="EDITOR"){alert("Only OPERATORs can adjust timer duration. Please change your role to OPERATOR.");return}await Hi(300)},className:`w-8 h-8 text-white text-sm font-bold rounded transition-colors ${c==="VIEWER"||c==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-700 hover:bg-blue-600"}`,disabled:c==="VIEWER"||c==="EDITOR",title:c==="VIEWER"||c==="EDITOR"?"Only OPERATORs can adjust timer duration":"Add 5 minutes",children:"+5"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7787,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7731,columnNumber:15},void 0),l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("button",{onClick:()=>{if(c==="VIEWER"||c==="EDITOR"){alert("Only OPERATORs can send messages. Please change your role to OPERATOR.");return}Ai(!0)},className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${c==="VIEWER"||c==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":xo?"bg-purple-600 hover:bg-purple-500 ring-4 ring-inset ring-green-500":"bg-purple-600 hover:bg-purple-500"}`,disabled:c==="VIEWER"||c==="EDITOR",title:c==="VIEWER"||c==="EDITOR"?"Only OPERATORs can send messages":"Send Messages to Full Screen Timer",children:"Messages"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7809,columnNumber:17},void 0),xo&&l.jsxDEV("button",{onClick:async()=>{if(c==="VIEWER"||c==="EDITOR"){alert("Only OPERATORs can control messages. Please change your role to OPERATOR.");return}try{if(e?.id){const C=(await it.getTimerMessagesForEvent(e.id)).find(D=>D.enabled);C&&(await it.disableTimerMessage(C.id),console.log(" Message disabled in Supabase via Turn Off button"))}}catch(h){console.error(" Error disabling message in Supabase:",h)}Ja(!1),Ps(""),Fr&&!Fr.closed&&Fr.postMessage({type:"MESSAGE_UPDATE",message:"",enabled:!1},"*")},className:`px-4 py-2 text-white text-sm font-medium rounded transition-colors ${c==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500 animate-pulse"}`,disabled:c==="VIEWER",title:c==="VIEWER"?"Viewers cannot control messages":"Turn Off Message",children:"Click to Turn Off"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7832,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7808,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7690,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7651,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7650,columnNumber:11},void 0),l.jsxDEV("div",{className:`px-8 transition-all duration-500 ease-in-out overflow-hidden ${wa?"max-h-80 opacity-100 -mb-6":"max-h-0 opacity-0 mb-0"}`,children:l.jsxDEV("div",{className:"bg-slate-800 rounded-xl p-4 shadow-2xl",style:{transform:"scale(0.75)",transformOrigin:"top center",width:"127.67%",marginLeft:"-13.83%"},children:l.jsxDEV("div",{className:"flex border-2 border-slate-600 rounded-lg overflow-hidden bg-slate-900",children:[l.jsxDEV("div",{className:"w-12 flex-shrink-0 bg-slate-900 border-r-2 border-slate-600",children:l.jsxDEV("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:l.jsxDEV("span",{className:"text-white font-bold text-xs",children:"#"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7887,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7886,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7885,columnNumber:17},void 0),l.jsxDEV("div",{className:"w-40 flex-shrink-0 bg-slate-900",style:{borderRight:"6px solid #475569"},children:l.jsxDEV("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:l.jsxDEV("span",{className:"text-white font-bold text-lg flex items-center gap-1",children:["CUE",c==="VIEWER"&&l.jsxDEV("span",{className:"text-yellow-400",title:"Viewers cannot edit CUE",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7897,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7894,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7893,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7892,columnNumber:17},void 0),l.jsxDEV("div",{className:"flex-1 overflow-x-auto sticky-header-scroll-container",style:{scrollbarWidth:"thin"},children:l.jsxDEV("div",{className:"min-w-max",children:l.jsxDEV("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex",children:[yt.start&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.start},children:[l.jsxDEV("span",{className:"text-white font-bold",children:"Start"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7912,columnNumber:27},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"start")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7913,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7908,columnNumber:25},void 0),yt.programType&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.programType},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Program Type",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7927,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7924,columnNumber:27},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"programType")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7930,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7920,columnNumber:25},void 0),yt.duration&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.duration},children:[l.jsxDEV("div",{className:"text-center",children:[l.jsxDEV("div",{className:"text-white font-bold flex items-center justify-center gap-1",children:["Duration",c==="VIEWER"&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7945,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7942,columnNumber:29},void 0),l.jsxDEV("div",{className:"text-xs text-slate-400",children:"HH MM SS"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7948,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7941,columnNumber:27},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"duration")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7950,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7937,columnNumber:25},void 0),yt.segmentName&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.segmentName},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Segment Name",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7964,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7961,columnNumber:27},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"segmentName")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7967,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7957,columnNumber:25},void 0),yt.shotType&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.shotType},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Shot Type",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7981,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7978,columnNumber:27},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"shotType")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7984,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7974,columnNumber:25},void 0),yt.pptQA&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.pptQA},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["PPT/Q&A",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7998,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7995,columnNumber:27},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"pptQA")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8001,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7991,columnNumber:25},void 0),yt.notes&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.notes},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Notes",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8015,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8012,columnNumber:27},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"notes")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8018,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8008,columnNumber:25},void 0),yt.assets&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.assets},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Assets",c==="VIEWER"&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for VIEWERs",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8032,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8029,columnNumber:27},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"assets")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8035,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8025,columnNumber:25},void 0),yt.participants&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.participants},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Participants",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8049,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8046,columnNumber:27},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"participants")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8052,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8042,columnNumber:25},void 0),yt.speakers&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.speakers},children:[l.jsxDEV("span",{className:"text-white font-bold",children:"Speakers"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8063,columnNumber:27},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"speakers")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8064,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8059,columnNumber:25},void 0),yt.public&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.public},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Public",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8078,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8075,columnNumber:27},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"public")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8081,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8071,columnNumber:25},void 0),W.map(h=>qn[h.id]!==!1&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center relative flex-shrink-0",style:{width:ui[h.id]||256},children:[l.jsxDEV("span",{className:"text-white font-bold",children:h.name},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8094,columnNumber:29},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:C=>Dc(C,h.id)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8095,columnNumber:29},void 0)]},h.id,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8089,columnNumber:27},void 0))]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7906,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7905,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7904,columnNumber:17},void 0),l.jsxDEV("div",{className:"w-32 flex-shrink-0 bg-slate-900",style:{borderLeft:"6px solid #475569"},children:l.jsxDEV("div",{className:"h-16 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:l.jsxDEV("span",{className:"text-white font-bold text-base flex items-center gap-1",children:["Timer",(c==="VIEWER"||c==="EDITOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Only OPERATORs can control timers",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8112,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8109,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8108,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8107,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7883,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7882,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7881,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7229,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:7228,columnNumber:7},void 0),l.jsxDEV("div",{className:"max-w-[95%] mx-auto px-6",style:{paddingTop:"250px"},children:l.jsxDEV("div",{className:"bg-slate-800 rounded-xl p-4 shadow-2xl",style:{transform:"scale(0.75)",transformOrigin:"top center",width:"133.33%",marginLeft:"-16.67%"},children:[l.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[l.jsxDEV("div",{children:[l.jsxDEV("h2",{className:"text-2xl font-bold text-white",children:["Schedule",e?.numberOfDays&&e.numberOfDays>1?` - Day ${ie}`:""," - TRT ",(()=>{const h=tp();return`${h.hours}h ${h.minutes}m ${h.seconds}s`})()]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8129,columnNumber:15},void 0),i&&l.jsxDEV("div",{className:"flex items-center gap-3 mt-1",children:[l.jsxDEV("button",{onClick:()=>b(!0),className:"text-xs bg-purple-600 hover:bg-purple-500 text-white px-2 py-1 rounded transition-colors",title:"View change history",children:[" Change Log (",E.length+G.size,")",Bn.getChangesCount().unsynced>0&&l.jsxDEV("span",{className:"ml-1 text-yellow-400",children:["(",Bn.getChangesCount().unsynced," unsynced)"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8144,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8137,columnNumber:19},void 0),me>0&&l.jsxDEV("button",{onClick:async()=>{await ce()},className:"text-xs bg-yellow-600 hover:bg-yellow-500 text-white px-2 py-1 rounded transition-colors animate-pulse",title:`${me} unsynced change${me!==1?"s":""} - Click to sync`,children:me},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8148,columnNumber:21},void 0),G.size>0&&l.jsxDEV("button",{className:"text-xs bg-yellow-600 text-white px-2 py-1 rounded transition-colors animate-pulse cursor-not-allowed",title:"Changes are pending and will auto-save after 5 seconds",disabled:!0,children:[" Changes Pending (",G.size,")"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8159,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8136,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8128,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex gap-3",children:[e?.numberOfDays&&e.numberOfDays>1&&l.jsxDEV("div",{className:"flex items-center gap-3 mr-4",children:[l.jsxDEV("label",{className:"text-white font-bold text-base",children:"Day:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8176,columnNumber:19},void 0),l.jsxDEV("select",{value:ie,onChange:h=>{Pr(),Ee(parseInt(h.target.value))},className:"px-4 py-2 bg-slate-700 border-2 border-slate-600 rounded-lg text-white focus:border-blue-500 focus:outline-none text-base font-semibold w-20",children:Array.from({length:e.numberOfDays},(h,C)=>l.jsxDEV("option",{value:C+1,children:C+1},C+1,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8186,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8177,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8175,columnNumber:17},void 0),l.jsxDEV("button",{onClick:()=>{if(c==="VIEWER"){alert("Viewers cannot add items. Please change your role to EDITOR or OPERATOR.");return}Dn(),de(!0),an({cue:"",day:ie,programType:"PreShow/End",shotType:"",segmentName:"",durationHours:0,durationMinutes:0,durationSeconds:0,notes:"",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!1,timerId:"",isPublic:!1,isIndented:!1,customFields:{}})},className:`px-4 py-2 font-medium rounded text-sm transition-colors ${c==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,disabled:c==="VIEWER",title:c==="VIEWER"?"Only EDITORs and OPERATORs can add items":"Add new item",children:"+ Item"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8192,columnNumber:15},void 0),l.jsxDEV("button",{onClick:()=>{if(c==="VIEWER"){alert("Viewers cannot add columns. Please change your role to EDITOR or OPERATOR.");return}Dn(),ft(!0)},className:`px-4 py-2 font-medium rounded text-sm transition-colors ${c==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,disabled:c==="VIEWER",title:c==="VIEWER"?"Viewers cannot add columns":"Add custom column",children:"+ Column"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8233,columnNumber:15},void 0),l.jsxDEV("button",{onClick:async()=>{if(c==="VIEWER"){alert("Viewers cannot reset the schedule. Please change your role to EDITOR or OPERATOR.");return}await To()},className:`px-4 py-2 font-medium rounded text-sm transition-colors ${c==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-600 hover:bg-red-700 text-white"}`,disabled:c==="VIEWER",title:c==="VIEWER"?"Viewers cannot reset the schedule":"Reset all states",children:"Reset"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8253,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8172,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8127,columnNumber:11},void 0),l.jsxDEV("div",{className:"flex border-2 border-slate-600 rounded-lg overflow-hidden bg-slate-900",children:[l.jsxDEV("div",{className:"w-12 flex-shrink-0 bg-slate-900 border-r-2 border-slate-600",children:[l.jsxDEV("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:l.jsxDEV("span",{className:"text-white font-bold text-xs",children:"#"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8280,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8279,columnNumber:15},void 0),Qa().length===0?l.jsxDEV("div",{className:"h-24 flex items-center justify-center text-slate-500",children:"-"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8285,columnNumber:17},void 0):Qa().map((h,C)=>l.jsxDEV("div",{className:`border-b-2 border-slate-600 flex items-center justify-center gap-1 ${(()=>{const D=Ue?.activeTimer?.item_id,V=D&&(parseInt(String(D))===h.id||D===h.id||String(D)===String(h.id)),re=V&&Ue?.activeTimer?.is_running&&Ue?.activeTimer?.is_active,ue=V&&Ue?.activeTimer?.is_active&&!Ue?.activeTimer?.is_running;if(re)return"bg-green-900 border-green-500";if(ue)return"bg-blue-900 border-blue-500";if(ii[h.id]||hc.has(h.id))return"bg-gray-900 border-gray-700 opacity-40";if(yo.has(h.id))return"bg-amber-800 border-amber-600";if(Xr[h.id]){const be=Xr[h.id].parentId,ke=Ue?.activeTimer?.item_id||Y,Fe=ke&&(parseInt(String(ke))===be||ke===be||String(ke)===String(be)),qe=ct[be]!==void 0;if(Fe||qe)return"bg-amber-950 border-amber-600"}return C%2===0?"bg-slate-800":"bg-slate-900"})()}`,style:{height:Fa(h.notes,h.speakersText,h.speakers,h.customFields,W)},children:l.jsxDEV("div",{className:"flex flex-col items-center gap-1",children:[l.jsxDEV("button",{onClick:()=>{if(c==="VIEWER"){alert("Viewers cannot jump to rows. Please change your role to EDITOR or OPERATOR.");return}console.log(" Row jump button clicked - pausing sync"),xr(!0),br&&clearTimeout(br),setTimeout(()=>{const D=prompt(`Move to row (1-${Qa().length}):`,(C+1).toString());console.log(" Row jump prompt closed - resuming sync in 5 seconds");const V=setTimeout(()=>{console.log(" User stopped editing - resuming sync"),xr(!1)},5e3);Kt(V),D&&!isNaN(Number(D))&&_o(h.id,Number(D))},0)},className:`w-5 h-5 text-white rounded flex items-center justify-center text-xs font-bold transition-colors ${c==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-purple-600 hover:bg-purple-500"}`,disabled:c==="VIEWER",title:c==="VIEWER"?"Viewers cannot jump to rows":"Jump to Row",children:"#"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8337,columnNumber:23},void 0),l.jsxDEV("span",{className:"text-white font-bold text-lg",children:C+1},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8380,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>{if(c==="VIEWER"){alert("Viewers cannot add rows. Please change your role to EDITOR or OPERATOR.");return}Dn(),oe(C),de(!0)},className:`w-5 h-5 text-white rounded flex items-center justify-center text-xs font-bold transition-colors ${c==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500"}`,disabled:c==="VIEWER",title:c==="VIEWER"?"Viewers cannot add rows":`Insert row after row ${C+1}`,children:"+"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8383,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8336,columnNumber:21},void 0)},`${h.id}-${h.notes?.length||0}-${h.speakers?.length||0}`,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8290,columnNumber:20},void 0))]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8277,columnNumber:13},void 0),l.jsxDEV("div",{className:"w-40 flex-shrink-0 bg-slate-900",style:{borderRight:"6px solid #475569"},children:[l.jsxDEV("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:l.jsxDEV("span",{className:"text-white font-bold text-lg flex items-center gap-1",children:["CUE",c==="VIEWER"&&l.jsxDEV("span",{className:"text-yellow-400",title:"Viewers cannot edit CUE",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8417,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8414,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8413,columnNumber:15},void 0),Qa().length===0?l.jsxDEV("div",{className:"h-24 flex items-center justify-center text-slate-500",children:"No items"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8424,columnNumber:18},void 0):Qa().map((h,C)=>l.jsxDEV("div",{className:`border-b-2 border-slate-600 flex flex-col items-center justify-center gap-1 ${C%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:Fa(h.notes,h.speakersText,h.speakers,h.customFields,W)},children:[l.jsxDEV("div",{className:"flex",children:[l.jsxDEV("div",{className:`flex items-center px-1 py-1 border border-slate-600 border-r-0 rounded-l text-white text-lg font-medium min-w-[40px] ${Mi===h.id?"bg-purple-600":"bg-slate-600"}`,children:"CUE"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8437,columnNumber:23},void 0),l.jsxDEV("input",{type:"text",value:h.customFields.cue?h.customFields.cue.replace(/^CUE\s*/,""):"",onChange:D=>{if(Pr(),c==="VIEWER"){alert("Viewers cannot edit cue names. Please change your role to EDITOR or OPERATOR.");return}const V=h.customFields.cue||"CUE ",re=D.target.value?`CUE ${D.target.value}`:"CUE ";A(ue=>ue.map(be=>be.id===h.id?{...be,customFields:{...be.customFields,cue:re}}:be)),z(`cue_${h.id}`,"FIELD_UPDATE",`Updated cue for "${h.segmentName}" from "${V}" to "${re}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"cue",oldValue:V,newValue:re,details:{fieldType:"text",characterChange:re.length-V.length}})},disabled:c==="VIEWER",className:"w-14 px-1 py-1 border border-slate-600 rounded-r text-center text-lg transition-colors bg-slate-700 text-white focus:outline-none focus:border-blue-500",title:c==="VIEWER"?"Viewers cannot edit cue names":"Edit cue number",maxLength:4},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8442,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8436,columnNumber:21},void 0),l.jsxDEV("div",{className:"flex gap-1",children:[l.jsxDEV("button",{onClick:()=>{if(Pr(),c==="VIEWER"){alert("Viewers cannot indent/unindent items. Please change your role to EDITOR or OPERATOR.");return}Zh(h.id)},className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${c==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":Xr[h.id]?"bg-orange-600 hover:bg-orange-500":"bg-slate-600 hover:bg-slate-500"}`,disabled:c==="VIEWER",title:c==="VIEWER"?"Viewers cannot indent/unindent items":Xr[h.id]?"Unindent (group with row above)":"Indent (group with row above)",children:Xr[h.id]?"":""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8493,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>{if(Pr(),c==="VIEWER"){alert("Viewers cannot move items. Please change your role to EDITOR or OPERATOR.");return}Sc(h.id,"up")},disabled:C===0||c==="VIEWER",className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${c==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500 disabled:opacity-30 disabled:cursor-not-allowed"}`,title:c==="VIEWER"?"Viewers cannot move items":"Move Up",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8519,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>{if(Pr(),c==="VIEWER"){alert("Viewers cannot move items. Please change your role to EDITOR or OPERATOR.");return}Sc(h.id,"down")},disabled:C===Qa().length-1||c==="VIEWER",className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${c==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-slate-600 hover:bg-slate-500 disabled:opacity-30 disabled:cursor-not-allowed"}`,title:c==="VIEWER"?"Viewers cannot move items":"Move Down",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8540,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>{if(Pr(),c==="VIEWER"){alert("Viewers cannot delete items. Please change your role to EDITOR or OPERATOR.");return}Wu(h.id)},className:`w-7 h-7 text-white flex items-center justify-center text-lg rounded font-bold transition-colors ${c==="VIEWER"?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-red-600 hover:bg-red-500"}`,disabled:c==="VIEWER",title:c==="VIEWER"?"Viewers cannot delete items":"Delete",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8561,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8492,columnNumber:21},void 0)]},`${h.id}-${h.notes?.length||0}-${h.speakers?.length||0}`,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8429,columnNumber:20},void 0))]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8411,columnNumber:13},void 0),l.jsxDEV("div",{id:"main-scroll-container",className:"flex-1 overflow-x-auto",style:{scrollbarWidth:"thin"},children:l.jsxDEV("div",{className:"min-w-max",children:[l.jsxDEV("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex",children:[yt.start&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.start},children:[l.jsxDEV("span",{className:"text-white font-bold",children:"Start"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8598,columnNumber:23},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"start")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8599,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8594,columnNumber:21},void 0),yt.programType&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.programType},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Program Type",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8613,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8610,columnNumber:23},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"programType")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8616,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8606,columnNumber:21},void 0),yt.duration&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.duration},children:[l.jsxDEV("div",{className:"text-center",children:[l.jsxDEV("div",{className:"text-white font-bold flex items-center justify-center gap-1",children:["Duration",c==="VIEWER"&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8631,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8628,columnNumber:25},void 0),l.jsxDEV("div",{className:"text-xs text-slate-400",children:"HH MM SS"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8634,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8627,columnNumber:23},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"duration")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8636,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8623,columnNumber:21},void 0),yt.segmentName&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.segmentName},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Segment Name",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8650,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8647,columnNumber:23},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"segmentName")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8653,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8643,columnNumber:21},void 0),yt.shotType&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.shotType},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Shot Type",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8667,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8664,columnNumber:23},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"shotType")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8670,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8660,columnNumber:21},void 0),yt.pptQA&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.pptQA},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["PPT/Q&A",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8684,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8681,columnNumber:23},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"pptQA")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8687,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8677,columnNumber:21},void 0),yt.notes&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.notes},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Notes",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8701,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8698,columnNumber:23},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"notes")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8704,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8694,columnNumber:21},void 0),yt.assets&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.assets},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Assets",c==="VIEWER"&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for VIEWERs",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8718,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8715,columnNumber:23},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"assets")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8721,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8711,columnNumber:21},void 0),yt.participants&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.participants},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Participants",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8735,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8732,columnNumber:23},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"participants")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8738,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8728,columnNumber:21},void 0),yt.speakers&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.speakers},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Speakers",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8752,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8749,columnNumber:23},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"speakers")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8755,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8745,columnNumber:21},void 0),yt.public&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 relative",style:{width:zt.public},children:[l.jsxDEV("span",{className:"text-white font-bold flex items-center gap-1",children:["Public",(c==="VIEWER"||c==="OPERATOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Read-only for your role",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8769,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8766,columnNumber:23},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:h=>Br(h,"public")},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8772,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8762,columnNumber:21},void 0),W.map(h=>qn[h.id]!==!1&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center relative flex-shrink-0",style:{width:ui[h.id]||256},children:[l.jsxDEV("span",{className:"text-white font-bold",children:h.name},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8785,columnNumber:25},void 0),l.jsxDEV("button",{onClick:()=>{window.confirm(`Are you sure you want to remove the "${h.name}" column? This will delete all data in this column.`)&&gp(h.id)},className:"absolute top-1 right-1 w-6 h-6 bg-red-600 hover:bg-red-700 text-white rounded-md text-base font-bold flex items-center justify-center transition-colors shadow-md hover:shadow-lg",title:`Remove "${h.name}" column`,children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8786,columnNumber:25},void 0),l.jsxDEV("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity",onMouseDown:C=>Dc(C,h.id)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8797,columnNumber:25},void 0)]},h.id,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8780,columnNumber:23},void 0))]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8592,columnNumber:17},void 0),Qa().length===0?l.jsxDEV("div",{className:"h-24 flex items-center justify-center text-slate-500 text-xl",children:["No schedule items for Day ",ie,'. Click "Add Schedule Item" to start!']},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8808,columnNumber:19},void 0):Qa().map((h,C)=>l.jsxDEV("div",{"data-item-id":h.id,className:`border-b-2 border-slate-600 flex ${(()=>{const D=Ue?.activeTimer?.item_id,V=D&&(parseInt(String(D))===h.id||D===h.id||String(D)===String(h.id)),re=V&&Ue?.activeTimer?.is_running&&Ue?.activeTimer?.is_active,ue=V&&Ue?.activeTimer?.is_active&&!Ue?.activeTimer?.is_running;if(re)return"bg-green-950";if(ue)return"bg-blue-950";if(ii[h.id]||hc.has(h.id))return"bg-gray-900 opacity-40";if(yo.has(h.id))return"bg-amber-950 border-amber-600";if(Xr[h.id]){const be=Xr[h.id].parentId,ke=Ue?.activeTimer?.item_id||Y,Fe=ke&&(parseInt(String(ke))===be||ke===be||String(ke)===String(be)),qe=ct[be]!==void 0;if(Fe||qe)return"bg-amber-950 border-amber-600"}return Mi===h.id?"bg-purple-950 border-purple-400":C%2===0?"bg-slate-800":"bg-slate-900"})()}`,style:{height:Fa(h.notes,h.speakersText,h.speakers,h.customFields,W)},children:[yt.start&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:zt.start},children:l.jsxDEV("span",{className:"text-white font-mono text-base font-bold",children:Xr[h.id]?"":fi(C)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8866,columnNumber:28},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8862,columnNumber:26},void 0),yt.programType&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:zt.programType},children:l.jsxDEV("select",{value:h.programType,onFocus:()=>{console.log(" Program Type dropdown focused - pausing sync"),Dn()},onChange:D=>{if(c==="VIEWER"||c==="OPERATOR"){alert("Only EDITORs can edit program type. Please change your role to EDITOR.");return}const V=h.programType;A(re=>re.map(ue=>ue.id===h.id?{...ue,programType:D.target.value}:ue)),z(`programType_${h.id}`,"FIELD_UPDATE",`Updated program type for "${h.segmentName}" from "${V}" to "${D.target.value}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"programType",oldValue:V,newValue:D.target.value,details:{fieldType:"select",optionChange:!0}}),Sn()},disabled:c==="VIEWER"||c==="OPERATOR",className:"w-full px-3 py-2 border-2 rounded text-base transition-colors bg-slate-700 border-slate-500 text-white focus:border-blue-500",style:{backgroundColor:xc[h.programType]||"#374151",color:h.programType==="Sub Cue"?"#000000":"#ffffff",opacity:1},title:c==="VIEWER"||c==="OPERATOR"?"Only EDITORs can edit program type":"Select program type",children:a0.map(D=>l.jsxDEV("option",{value:D,style:{backgroundColor:xc[D]||"#374151",color:D==="Sub Cue"?"#000000":"#ffffff"},children:D},D,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8926,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8876,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8872,columnNumber:26},void 0),yt.duration&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:zt.duration},children:l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("input",{type:"number",min:"0",max:"23",value:h.durationHours,onChange:D=>{if(Pr(),c==="VIEWER"){alert("Only EDITORs and OPERATORs can edit duration. Please change your role to EDITOR or OPERATOR.");return}const V=h.durationHours,re=parseInt(D.target.value)||0;A(ue=>ue.map(be=>be.id===h.id?{...be,durationHours:re}:be)),z(`durationHours_${h.id}`,"FIELD_UPDATE",`Updated duration hours for "${h.segmentName}" from ${V} to ${re}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"durationHours",oldValue:V,newValue:re,details:{fieldType:"number",timeChange:re-V}})},disabled:c==="VIEWER",className:"w-14 px-2 py-2 border border-slate-600 rounded text-center text-lg font-mono font-bold transition-colors bg-slate-700 text-white",style:{opacity:1},title:c==="VIEWER"?"Only EDITORs and OPERATORs can edit duration":"Edit hours"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8946,columnNumber:27},void 0),l.jsxDEV("span",{className:"text-slate-400 text-xl font-bold",children:":"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8991,columnNumber:27},void 0),l.jsxDEV("input",{type:"number",min:"0",max:"59",value:h.durationMinutes,onChange:D=>{if(Pr(),c==="VIEWER"){alert("Only EDITORs and OPERATORs can edit duration. Please change your role to EDITOR or OPERATOR.");return}const V=h.durationMinutes,re=parseInt(D.target.value)||0;A(ue=>ue.map(be=>be.id===h.id?{...be,durationMinutes:re}:be)),z(`durationMinutes_${h.id}`,"FIELD_UPDATE",`Updated duration minutes for "${h.segmentName}" from ${V} to ${re}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"durationMinutes",oldValue:V,newValue:re,details:{fieldType:"number",timeChange:re-V}})},disabled:c==="VIEWER",className:"w-14 px-2 py-2 border border-slate-600 rounded text-center text-lg font-mono font-bold transition-colors bg-slate-700 text-white",style:{opacity:1},title:c==="VIEWER"?"Only EDITORs and OPERATORs can edit duration":"Edit minutes"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8992,columnNumber:27},void 0),l.jsxDEV("span",{className:"text-slate-400 text-xl font-bold",children:":"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9037,columnNumber:27},void 0),l.jsxDEV("input",{type:"number",min:"0",max:"59",value:h.durationSeconds,onChange:D=>{if(Pr(),c==="VIEWER"){alert("Only EDITORs and OPERATORs can edit duration. Please change your role to EDITOR or OPERATOR.");return}const V=h.durationSeconds,re=parseInt(D.target.value)||0;A(ue=>ue.map(be=>be.id===h.id?{...be,durationSeconds:re}:be)),z(`durationSeconds_${h.id}`,"FIELD_UPDATE",`Updated duration seconds for "${h.segmentName}" from ${V} to ${re}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"durationSeconds",oldValue:V,newValue:re,details:{fieldType:"number",timeChange:re-V}})},disabled:c==="VIEWER",className:"w-14 px-2 py-2 border border-slate-600 rounded text-center text-lg font-mono font-bold transition-colors bg-slate-700 text-white",style:{opacity:1},title:c==="VIEWER"?"Only EDITORs and OPERATORs can edit duration":"Edit seconds"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9038,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8945,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8941,columnNumber:26},void 0),yt.segmentName&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:zt.segmentName},children:l.jsxDEV("input",{type:"text",value:h.segmentName,onChange:D=>{if(Pr(),c==="VIEWER"||c==="OPERATOR"){alert("Only EDITORs can edit segment names. Please change your role to EDITOR.");return}const V=h.segmentName;A(re=>re.map(ue=>ue.id===h.id?{...ue,segmentName:D.target.value}:ue)),z(`segmentName_${h.id}`,"FIELD_UPDATE",`Updated segment name for "${V}" to "${D.target.value}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:D.target.value,fieldName:"segmentName",oldValue:V,newValue:D.target.value,details:{fieldType:"text",characterChange:D.target.value.length-V.length}})},disabled:c==="VIEWER"||c==="OPERATOR",className:"w-full px-3 py-2 border border-slate-600 rounded text-base transition-colors bg-slate-700 text-white",placeholder:c==="VIEWER"||c==="OPERATOR"?"Only EDITORs can edit":"Enter segment name",title:c==="VIEWER"||c==="OPERATOR"?"Only EDITORs can edit segment names":"Edit segment name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9091,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9087,columnNumber:26},void 0),yt.shotType&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:zt.shotType},children:l.jsxDEV("select",{value:h.shotType,onFocus:()=>{console.log(" Shot Type dropdown focused - pausing sync"),Dn()},onChange:D=>{if(c==="VIEWER"||c==="OPERATOR"){alert("Only EDITORs can edit shot type. Please change your role to EDITOR.");return}const V=h.shotType;A(re=>re.map(ue=>ue.id===h.id?{...ue,shotType:D.target.value}:ue)),z(`shotType_${h.id}`,"FIELD_UPDATE",`Updated shot type for "${h.segmentName}" from "${V}" to "${D.target.value}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"shotType",oldValue:V,newValue:D.target.value,details:{fieldType:"select",optionChange:!0}}),Sn()},disabled:c==="VIEWER"||c==="OPERATOR",className:"w-full px-3 py-2 border border-slate-600 rounded text-base transition-colors bg-slate-700 text-white",style:{opacity:1},title:c==="VIEWER"||c==="OPERATOR"?"Only EDITORs can edit shot type":"Select shot type",children:[l.jsxDEV("option",{value:"",children:"Select Shot Type"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9189,columnNumber:27},void 0),l0.map(D=>l.jsxDEV("option",{value:D,children:D},D,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9191,columnNumber:29},void 0))]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9144,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9140,columnNumber:26},void 0),yt.pptQA&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:zt.pptQA},children:l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("label",{className:"flex items-center gap-1",children:[l.jsxDEV("input",{type:"checkbox",checked:h.hasPPT,onChange:D=>{if(Pr(),c==="VIEWER"||c==="OPERATOR"){alert("Only EDITORs can edit PPT settings. Please change your role to EDITOR.");return}const V=h.hasPPT;A(re=>re.map(ue=>ue.id===h.id?{...ue,hasPPT:D.target.checked}:ue)),z(`hasPPT_${h.id}`,"FIELD_UPDATE",`Updated PPT status for "${h.segmentName}" from ${V?"TRUE":"FALSE"} to ${D.target.checked?"TRUE":"FALSE"}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"hasPPT",oldValue:V?"TRUE":"FALSE",newValue:D.target.checked?"TRUE":"FALSE",details:{fieldType:"checkbox",booleanChange:!0}})},className:`w-6 h-6 rounded border-2 transition-colors ${c==="VIEWER"||c==="OPERATOR"?"border-slate-400 bg-slate-700 cursor-not-allowed":"border-slate-400 bg-slate-700 hover:border-blue-400 focus:ring-2 focus:ring-blue-500"}`,style:{opacity:1,filter:"none",WebkitFilter:"none"},title:c==="VIEWER"||c==="OPERATOR"?"Only EDITORs can edit PPT settings":"Toggle PPT"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9203,columnNumber:29},void 0),l.jsxDEV("span",{className:"text-base font-medium text-white",children:"PPT"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9252,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9202,columnNumber:27},void 0),l.jsxDEV("label",{className:"flex items-center gap-1",children:[l.jsxDEV("input",{type:"checkbox",checked:h.hasQA,onChange:D=>{if(Pr(),c==="VIEWER"||c==="OPERATOR"){alert("Only EDITORs can edit Q&A settings. Please change your role to EDITOR.");return}const V=h.hasQA;A(re=>re.map(ue=>ue.id===h.id?{...ue,hasQA:D.target.checked}:ue)),z(`hasQA_${h.id}`,"FIELD_UPDATE",`Updated Q&A status for "${h.segmentName}" from ${V?"TRUE":"FALSE"} to ${D.target.checked?"TRUE":"FALSE"}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"hasQA",oldValue:V?"TRUE":"FALSE",newValue:D.target.checked?"TRUE":"FALSE",details:{fieldType:"checkbox",booleanChange:!0}})},className:`w-6 h-6 rounded border-2 transition-colors ${c==="VIEWER"||c==="OPERATOR"?"border-slate-400 bg-slate-700 cursor-not-allowed":"border-slate-400 bg-slate-700 hover:border-blue-400 focus:ring-2 focus:ring-blue-500"}`,style:{opacity:1,filter:"none",WebkitFilter:"none"},title:c==="VIEWER"||c==="OPERATOR"?"Only EDITORs can edit Q&A settings":"Toggle Q&A"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9255,columnNumber:29},void 0),l.jsxDEV("span",{className:"text-base font-medium text-white",children:"Q&A"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9304,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9254,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9201,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9197,columnNumber:26},void 0),yt.notes&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:zt.notes,height:Fa(h.notes,h.speakersText,h.speakers,h.customFields,W)},children:l.jsxDEV("div",{onClick:()=>{if(c==="VIEWER"||c==="OPERATOR"){if(c==="OPERATOR"&&h.notes){alert(`Notes (View Only):

${h.notes.replace(/<[^>]*>/g,"")}`);return}alert("Only EDITORs can edit notes. Please change your role to EDITOR.");return}Dn(),er(h.id),Dt(!0)},className:"w-full px-3 py-2 border border-slate-600 rounded text-white text-base transition-colors bg-slate-700 cursor-pointer hover:bg-slate-600",style:{minHeight:"4rem",maxHeight:"none",wordWrap:"break-word",overflowWrap:"break-word",display:"flex",alignItems:"flex-start",justifyContent:"flex-start"},title:c==="VIEWER"?"Viewers cannot edit notes":c==="OPERATOR"?"Click to view notes (read-only)":"Click to edit notes",children:h.notes?l.jsxDEV("div",{className:"text-left w-full",style:{lineHeight:"1.4",overflow:"visible"},dangerouslySetInnerHTML:{__html:h.notes}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9341,columnNumber:29},void 0):l.jsxDEV("span",{className:"text-slate-400",children:"Click to edit notes..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9350,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9314,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9310,columnNumber:26},void 0),yt.assets&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:zt.assets},children:l.jsxDEV("div",{onClick:()=>{if(c==="VIEWER"||c==="OPERATOR"){if(c==="OPERATOR"&&h.assets){Ct(h.id),$e(!0);return}alert("Only EDITORs can edit assets. Please change your role to EDITOR.");return}Dn(),St(h.id),Qe(!0)},className:"w-full px-3 py-2 border border-slate-600 rounded text-white text-base transition-colors flex items-center justify-center bg-slate-700 cursor-pointer hover:bg-slate-600",title:c==="VIEWER"?"Viewers cannot edit assets":c==="OPERATOR"?"Click to view assets (read-only)":"Click to edit assets",children:h.assets?l.jsxDEV("div",{className:"text-center",children:l.jsxDEV("div",{className:"text-sm font-medium",children:[h.assets.split("||").length," Asset",h.assets.split("||").length!==1?"s":""]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9382,columnNumber:31},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9381,columnNumber:29},void 0):l.jsxDEV("span",{className:"text-slate-400",children:"Click to add assets..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9387,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9360,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9356,columnNumber:26},void 0),yt.participants&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-start justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:zt.participants,height:Fa(h.notes,h.speakersText,h.speakers,h.customFields,W)},children:l.jsxDEV("div",{onClick:()=>{if(c==="VIEWER"||c==="OPERATOR"){if(c==="OPERATOR"&&h.speakers){alert(`Participants (View Only):

${o0(h.speakers)}`);return}alert("Only EDITORs can edit participants. Please change your role to EDITOR.");return}Ft(h.id),Ot(!0)},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-base cursor-pointer hover:bg-slate-600",style:{height:`calc(${Fa(h.notes,h.speakersText,h.speakers,h.customFields,W)} - 2rem)`,maxHeight:`calc(${Fa(h.notes,h.speakersText,h.speakers,h.customFields,W)} - 2rem)`,overflow:"hidden",lineHeight:"1.6",wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"pre-wrap"},title:c==="VIEWER"?"Viewers cannot edit participants":c==="OPERATOR"?"Click to view participants (read-only)":"Click to edit participants",children:o0(h.speakers||"")||"Click to add participants..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9400,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9393,columnNumber:26},void 0),yt.speakers&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:zt.speakers,height:Fa(h.notes,h.speakersText,h.speakers,h.customFields,W)},children:l.jsxDEV("div",{onClick:()=>{if(c==="VIEWER"||c==="OPERATOR"){if(c==="OPERATOR"&&h.speakersText){alert(`Speakers (View Only):

${Nc(h.speakersText)}`);return}alert("Only EDITORs can edit speakers. Please change your role to EDITOR.");return}Dn(),Ve(h.id),ur(!0)},className:"w-full px-3 py-2 border border-slate-600 rounded text-white text-base transition-colors flex items-start justify-start bg-slate-700 cursor-pointer hover:bg-slate-600",style:{height:Iu(h.speakersText),minHeight:Iu(h.speakersText),wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden",paddingBottom:"1rem",lineHeight:"1.6",whiteSpace:"pre-wrap"},title:c==="VIEWER"?"Viewers cannot edit speakers":c==="OPERATOR"?"Click to view speakers (read-only)":"Click to edit speakers",children:l.jsxDEV("div",{className:"text-left w-full",children:Nc(h.speakersText||"")||"Click to add speakers..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9462,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9434,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9430,columnNumber:26},void 0),yt.public&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0",style:{width:zt.public},children:l.jsxDEV("input",{type:"checkbox",checked:h.isPublic||!1,onChange:D=>{if(c==="VIEWER"||c==="OPERATOR"){alert("Only EDITORs can change public status. Please change your role to EDITOR.");return}const V=h.isPublic;A(re=>re.map(ue=>ue.id===h.id?{...ue,isPublic:D.target.checked}:ue)),Q("FIELD_UPDATE",`Updated Public status for "${h.segmentName}" from ${V} to ${D.target.checked}`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:"isPublic",oldValue:V,newValue:D.target.checked,details:{fieldType:"checkbox",booleanChange:!0}})},className:`w-5 h-5 rounded border-2 focus:ring-2 transition-colors ${c==="VIEWER"||c==="OPERATOR"?"border-slate-500 bg-slate-700 text-blue-600 cursor-not-allowed":"border-slate-500 bg-slate-700 text-blue-600 focus:ring-blue-500"}`,style:{opacity:1,filter:"none",WebkitFilter:"none"},title:c==="VIEWER"||c==="OPERATOR"?"Only EDITORs can change public status":"Toggle public visibility"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9473,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9469,columnNumber:26},void 0),W.map(D=>qn[D.id]!==!1&&l.jsxDEV("div",{className:"px-4 py-2 border-r border-slate-600 flex items-center justify-center flex-shrink-0 transition-all duration-300 ease-in-out",style:{width:ui[D.id]||256,height:Fa(h.notes,h.speakersText,h.speakers,h.customFields,W)},children:l.jsxDEV("textarea",{value:h.customFields[D.name]||"",onFocus:()=>{console.log(" Custom column focused - pausing sync"),Pr()},onChange:V=>{Pr();const re=h.customFields[D.name]||"";A(ue=>ue.map(be=>be.id===h.id?{...be,customFields:{...be.customFields,[D.name]:V.target.value}}:be)),z(`custom_${D.name}_${h.id}`,"FIELD_UPDATE",`Updated custom field "${D.name}" for "${h.segmentName}" from "${re}" to "${V.target.value}"`,{changeType:"FIELD_CHANGE",itemId:h.id,itemName:h.segmentName,fieldName:`custom_${D.name}`,oldValue:re,newValue:V.target.value,details:{fieldType:"custom_field",columnName:D.name,characterChange:V.target.value.length-re.length}})},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-base resize-none",style:{height:`calc(${Fa(h.notes,h.speakersText,h.speakers,h.customFields,W)} - 2rem)`,maxHeight:`calc(${Fa(h.notes,h.speakersText,h.speakers,h.customFields,W)} - 2rem)`,overflow:"hidden",lineHeight:"1.6",wordWrap:"break-word",overflowWrap:"break-word"},rows:Math.max(2,(h.customFields[D.name]||"").split(`
`).length),placeholder:`${D.name}...`},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9526,columnNumber:27},void 0)},D.id,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9518,columnNumber:28},void 0))]},`${h.id}-${h.notes?.length||0}-${h.speakers?.length||0}`,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8813,columnNumber:22},void 0))]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8590,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8589,columnNumber:13},void 0),l.jsxDEV("div",{className:"w-32 flex-shrink-0 bg-slate-900",style:{borderLeft:"6px solid #475569"},children:[l.jsxDEV("div",{className:"h-24 bg-slate-700 border-b-3 border-slate-600 flex items-center justify-center",children:l.jsxDEV("span",{className:"text-white font-bold text-base flex items-center gap-1",children:["Timer",(c==="VIEWER"||c==="EDITOR")&&l.jsxDEV("span",{className:"text-yellow-400",title:"Only OPERATORs can control timers",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9597,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9594,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9593,columnNumber:15},void 0),Qa().length===0?l.jsxDEV("div",{className:"h-24 flex items-center justify-center text-slate-500",children:"-"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9604,columnNumber:17},void 0):Qa().map((h,C)=>l.jsxDEV("div",{className:`border-b-2 border-slate-600 flex flex-col items-center justify-center gap-1 ${C%2===0?"bg-slate-800":"bg-slate-900"}`,style:{height:Fa(h.notes,h.speakersText,h.speakers,h.customFields,W)},children:l.jsxDEV("div",{className:"flex flex-col items-center justify-center h-full gap-1",children:[l.jsxDEV("div",{className:"text-sm font-mono text-slate-300",children:h.timerId||"TIMER"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9617,columnNumber:23},void 0),l.jsxDEV("div",{className:"flex flex-col gap-1",children:Xr[h.id]?l.jsxDEV(l.Fragment,{children:[l.jsxDEV("button",{onClick:()=>{if(c==="VIEWER"||c==="EDITOR"){alert("Only OPERATORs can start secondary timers. Please change your role to OPERATOR.");return}xp(h.id)},disabled:qt?.itemId===h.id||c==="VIEWER"||c==="EDITOR"||!Dl(h.id),className:`px-3 py-1 rounded text-sm font-bold transition-colors ${c==="VIEWER"||c==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":Dl(h.id)?qt?.itemId===h.id?"bg-orange-600 text-white cursor-default":"bg-orange-500 hover:bg-orange-400 text-white":"bg-gray-500 text-gray-300 cursor-not-allowed"}`,title:c==="VIEWER"||c==="EDITOR"?"Only OPERATORs can start secondary timers":Dl(h.id)?"Start secondary timer":"Start the CUE above first before starting secondary timer",children:qt?.itemId===h.id?"PLAYING":"PLAY"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9687,columnNumber:29},void 0),l.jsxDEV("button",{onClick:()=>{if(c==="VIEWER"||c==="EDITOR"){alert("Only OPERATORs can stop secondary timers. Please change your role to OPERATOR.");return}Wi()},disabled:qt?.itemId!==h.id||c==="VIEWER"||c==="EDITOR"||!Dl(h.id),className:`px-3 py-1 rounded text-sm font-bold transition-colors ${c==="VIEWER"||c==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":Dl(h.id)?qt?.itemId===h.id?"bg-red-600 hover:bg-red-500 text-white":"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-gray-500 text-gray-300 cursor-not-allowed"}`,title:c==="VIEWER"||c==="EDITOR"?"Only OPERATORs can stop secondary timers":"Stop secondary timer",children:"STOP"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9715,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9685,columnNumber:27},void 0):l.jsxDEV(l.Fragment,{children:[l.jsxDEV("button",{onClick:async()=>{if(console.log(" LOAD BUTTON CLICKED!"),console.log(" currentUserRole:",c),console.log(" item.id:",h.id),console.log(" user:",i),console.log(" event:",e),c==="VIEWER"){alert("Viewers cannot load cues. Please change your role to EDITOR or OPERATOR.");return}if(c==="EDITOR"){alert("Editors cannot load cues. Please change your role to OPERATOR.");return}console.log(" Calling loadCue function...");try{await u0(h.id),console.log(" loadCue completed successfully")}catch(D){console.error(" loadCue failed:",D)}},disabled:Y===h.id||c==="VIEWER"||c==="EDITOR",className:`px-3 py-1 rounded text-sm font-bold transition-colors ${c==="VIEWER"||c==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":Y===h.id?"bg-blue-600 text-white cursor-default":"bg-slate-600 hover:bg-slate-500 text-white"}`,title:c==="VIEWER"?"Viewers cannot load cues":c==="EDITOR"?"Editors cannot load cues":"Load this cue",children:Y===h.id?"LOADED":"LOAD"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9623,columnNumber:29},void 0),l.jsxDEV("button",{onClick:async()=>{if(c==="VIEWER"||c==="EDITOR"){alert("Only OPERATORs can start/stop timers. Please change your role to OPERATOR.");return}await Sl(h.id)},disabled:Y!==h.id||(ct[h.id]?!1:Object.keys(ct).length>0)||c==="VIEWER"||c==="EDITOR",className:`px-3 py-1 rounded text-sm font-bold transition-colors ${c==="VIEWER"||c==="EDITOR"?"bg-gray-500 text-gray-300 cursor-not-allowed":ct[h.id]?"bg-red-600 hover:bg-red-500 text-white":Y===h.id&&Object.keys(ct).length===0?"bg-green-600 hover:bg-green-500 text-white":"bg-slate-600 text-slate-400 cursor-not-allowed"}`,title:c==="VIEWER"||c==="EDITOR"?"Only OPERATORs can start/stop timers":ct[h.id]?"Stop timer":"Start timer",children:ct[h.id]?"STOP":"START"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9661,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9622,columnNumber:27},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9620,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9616,columnNumber:21},void 0)},`${h.id}-${h.notes?.length||0}-${h.speakers?.length||0}`,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9609,columnNumber:20},void 0))]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9591,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8275,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8126,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:8125,columnNumber:7},void 0),F&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg max-w-lg w-full max-h-[90vh] flex flex-col",children:[l.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-slate-600",children:[l.jsxDEV("h2",{className:"text-lg font-bold text-white",children:"Add Schedule Item"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9755,columnNumber:15},void 0),l.jsxDEV("label",{className:"flex items-center gap-2",children:[l.jsxDEV("input",{type:"checkbox",checked:Er.isPublic,onChange:h=>an(C=>({...C,isPublic:h.target.checked})),className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9757,columnNumber:17},void 0),l.jsxDEV("span",{className:"text-slate-300 text-sm",children:"Public"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9763,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9756,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9754,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:[l.jsxDEV("div",{className:"space-y-3",children:[l.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Cue"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9772,columnNumber:19},void 0),l.jsxDEV("div",{className:"flex",children:[l.jsxDEV("div",{className:"flex items-center px-2 py-2 bg-slate-600 border border-slate-600 border-r-0 rounded-l text-white text-sm font-medium min-w-[40px]",children:"CUE"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9774,columnNumber:21},void 0),l.jsxDEV("input",{type:"text",value:Er.cue,onChange:h=>{Pr(),an(C=>({...C,cue:h.target.value}))},className:"flex-1 px-3 py-2 bg-slate-700 border border-slate-600 rounded-r text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm",placeholder:"1, 1.1, 1A, etc."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9777,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9773,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9771,columnNumber:17},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Program Type"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9790,columnNumber:19},void 0),l.jsxDEV("select",{value:Er.programType,onFocus:()=>{console.log(" Program Type modal dropdown focused - pausing sync"),Dn()},onChange:h=>{an(C=>({...C,programType:h.target.value})),Sn()},className:"w-full px-3 py-2 bg-slate-700 border-2 border-slate-500 rounded text-white focus:outline-none focus:border-blue-500 text-sm",style:{backgroundColor:xc[Er.programType]||"#374151",color:Er.programType==="Sub Cue"?"#000000":"#ffffff"},children:a0.map(h=>l.jsxDEV("option",{value:h,style:{backgroundColor:xc[h]||"#374151",color:h==="Sub Cue"?"#000000":"#ffffff"},children:h},h,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9810,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9791,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9789,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9770,columnNumber:15},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Segment Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9827,columnNumber:17},void 0),l.jsxDEV("input",{type:"text",value:Er.segmentName,onChange:h=>{Pr(),an(C=>({...C,segmentName:h.target.value}))},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm",placeholder:"Enter segment name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9828,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9826,columnNumber:15},void 0),l.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Shot Type"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9842,columnNumber:19},void 0),l.jsxDEV("select",{value:Er.shotType,onFocus:()=>{console.log(" Shot Type modal dropdown focused - pausing sync"),Dn()},onChange:h=>{an(C=>({...C,shotType:h.target.value})),Sn()},className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm",children:[l.jsxDEV("option",{value:"",children:"Select Shot Type"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9857,columnNumber:21},void 0),l0.map(h=>l.jsxDEV("option",{value:h,children:h},h,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9859,columnNumber:23},void 0))]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9843,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9841,columnNumber:17},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Duration"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9864,columnNumber:19},void 0),l.jsxDEV("div",{className:"flex gap-1",children:[l.jsxDEV("input",{type:"number",value:Er.durationHours,onChange:h=>{Pr(),an(C=>({...C,durationHours:parseInt(h.target.value)||0}))},className:"w-12 px-2 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm text-center",min:"0",placeholder:"H"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9866,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-slate-400 self-center text-sm",children:":"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9877,columnNumber:21},void 0),l.jsxDEV("input",{type:"number",value:Er.durationMinutes,onChange:h=>{Pr(),an(C=>({...C,durationMinutes:parseInt(h.target.value)||0}))},className:"w-12 px-2 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm text-center",min:"0",max:"59",placeholder:"M"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9878,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-slate-400 self-center text-sm",children:":"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9890,columnNumber:21},void 0),l.jsxDEV("input",{type:"number",value:Er.durationSeconds,onChange:h=>{Pr(),an(C=>({...C,durationSeconds:parseInt(h.target.value)||0}))},className:"w-12 px-2 py-2 bg-slate-700 border border-slate-600 rounded text-white focus:outline-none focus:border-blue-500 text-sm text-center",min:"0",max:"59",placeholder:"S"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9891,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9865,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9863,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9840,columnNumber:15},void 0),l.jsxDEV("div",{className:"flex items-center gap-4",children:[l.jsxDEV("label",{className:"flex items-center gap-2",children:[l.jsxDEV("input",{type:"checkbox",checked:Er.hasPPT,onChange:h=>{Pr(),an(C=>({...C,hasPPT:h.target.checked}))},className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9909,columnNumber:19},void 0),l.jsxDEV("span",{className:"text-slate-300 text-sm",children:"Has PPT"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9918,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9908,columnNumber:17},void 0),l.jsxDEV("label",{className:"flex items-center gap-2",children:[l.jsxDEV("input",{type:"checkbox",checked:Er.hasQA,onChange:h=>{Pr(),an(C=>({...C,hasQA:h.target.checked}))},className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9921,columnNumber:19},void 0),l.jsxDEV("span",{className:"text-slate-300 text-sm",children:"Has QA"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9930,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9920,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9907,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9769,columnNumber:15},void 0),l.jsxDEV("div",{className:"mt-3",children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Notes"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9936,columnNumber:15},void 0),l.jsxDEV("div",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm cursor-pointer hover:bg-slate-600 transition-colors min-h-[60px] flex items-center",onClick:()=>{Dn(),er(-1),Dt(!0)},children:Er.notes?l.jsxDEV("div",{className:"text-sm",style:{lineHeight:"1.4",overflow:"visible"},dangerouslySetInnerHTML:{__html:Er.notes}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9947,columnNumber:19},void 0):l.jsxDEV("span",{className:"text-slate-400",children:"Click to edit notes with rich formatting..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9956,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9937,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9935,columnNumber:13},void 0),l.jsxDEV("div",{className:"mt-3",children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Assets"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9962,columnNumber:15},void 0),l.jsxDEV("div",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm cursor-pointer hover:bg-slate-600 transition-colors min-h-[60px] flex items-center",onClick:()=>{Dn(),St(-1),Qe(!0)},children:Er.assets?l.jsxDEV("div",{className:"text-sm",dangerouslySetInnerHTML:{__html:Er.assets.replace(/\|\|/g,"<br>")}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9973,columnNumber:19},void 0):l.jsxDEV("span",{className:"text-slate-400",children:"Click to edit assets with advanced management..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9975,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9963,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9961,columnNumber:13},void 0),l.jsxDEV("div",{className:"mt-3",children:[l.jsxDEV("label",{className:"block text-slate-300 text-sm font-medium mb-1",children:"Speakers"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9981,columnNumber:15},void 0),l.jsxDEV("div",{className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm cursor-pointer hover:bg-slate-600 transition-colors min-h-[60px] flex items-start justify-start",onClick:()=>{Dn(),Ve(-1),ur(!0)},style:{wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.6",whiteSpace:"pre-wrap"},children:Er.speakersText?l.jsxDEV("div",{className:"text-sm text-left w-full",children:Nc(Er.speakersText)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9998,columnNumber:19},void 0):l.jsxDEV("span",{className:"text-slate-400",children:"Click to add speakers..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10002,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9982,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9980,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9768,columnNumber:13},void 0),l.jsxDEV("div",{className:"p-4 border-t border-slate-600",children:l.jsxDEV("div",{className:"flex gap-2",children:[l.jsxDEV("button",{onClick:()=>vp(Er),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded transition-colors text-sm",children:"Add Item"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10011,columnNumber:17},void 0),l.jsxDEV("button",{onClick:()=>{de(!1),Sn()},className:"flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors text-sm",children:"Cancel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10017,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10010,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10009,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9752,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:9751,columnNumber:9},void 0),Tt&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-xl p-8 max-w-md w-full",children:[l.jsxDEV("h2",{className:"text-2xl font-bold text-white mb-6",children:"Add Custom Column"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10036,columnNumber:14},void 0),l.jsxDEV("div",{className:"mb-4",children:[l.jsxDEV("label",{className:"block text-slate-300 font-semibold mb-2",children:"Column Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10039,columnNumber:16},void 0),l.jsxDEV("input",{type:"text",placeholder:"Enter column name",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:border-blue-500",onFocus:()=>{console.log(" Custom column input focused - pausing sync"),Pr()},onKeyPress:h=>{if(h.key==="Enter"){const C=h.target;C.value.trim()&&(m0(C.value.trim()),C.value="")}}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10040,columnNumber:16},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10038,columnNumber:14},void 0),l.jsxDEV("div",{className:"flex gap-3",children:[l.jsxDEV("button",{onClick:()=>{const h=document.querySelector('input[placeholder="Enter column name"]');h?.value.trim()&&(m0(h.value.trim()),h.value="")},className:"flex-1 px-4 py-3 bg-purple-600 hover:bg-purple-500 text-white font-semibold rounded-lg transition-colors",children:"Add Column"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10062,columnNumber:16},void 0),l.jsxDEV("button",{onClick:()=>{ft(!1),Sn()},className:"flex-1 px-4 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10074,columnNumber:16},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10061,columnNumber:14},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10035,columnNumber:12},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10034,columnNumber:10},void 0),xt&&Ke!==null&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-xl p-6 max-w-5xl w-full max-h-[90vh] flex flex-col",children:[l.jsxDEV("h2",{className:"text-2xl font-bold text-white mb-4",children:"Edit Notes"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10092,columnNumber:14},void 0),l.jsxDEV("div",{className:"mb-4 bg-slate-700 rounded-lg overflow-hidden",children:[l.jsxDEV("div",{className:"flex items-center justify-between gap-4 p-3 border-b border-slate-600",children:[l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("span",{className:"text-white text-sm font-semibold",children:"Format:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10099,columnNumber:20},void 0),l.jsxDEV("div",{className:"flex gap-1",children:[l.jsxDEV("button",{onClick:()=>Ur("undo"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Undo",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10101,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("redo"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Redo",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10108,columnNumber:22},void 0),l.jsxDEV("div",{className:"w-px h-6 bg-slate-500 mx-1"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10115,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("bold"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded font-bold flex items-center justify-center",title:"Bold",children:"B"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10116,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("italic"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded italic flex items-center justify-center",title:"Italic",children:"I"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10123,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("underline"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded underline flex items-center justify-center",title:"Underline",children:"U"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10130,columnNumber:22},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10100,columnNumber:20},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10098,columnNumber:18},void 0),l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("span",{className:"text-white text-sm font-semibold",children:"Size:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10141,columnNumber:20},void 0),l.jsxDEV("div",{className:"flex gap-1",children:[l.jsxDEV("button",{onClick:()=>Ur("fontSize","1"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Small",children:"S"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10143,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("fontSize","3"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded flex items-center justify-center",title:"Normal",children:"N"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10150,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("fontSize","5"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-base rounded flex items-center justify-center",title:"Large",children:"L"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10157,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("fontSize","7"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-lg rounded flex items-center justify-center",title:"X-Large",children:"XL"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10164,columnNumber:22},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10142,columnNumber:20},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10140,columnNumber:18},void 0),l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("span",{className:"text-white text-sm font-semibold",children:"Align:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10175,columnNumber:20},void 0),l.jsxDEV("div",{className:"flex gap-1",children:[l.jsxDEV("button",{onClick:()=>Ur("left"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Left Align",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10177,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("center"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Center Align",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10184,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("right"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded flex items-center justify-center",title:"Right Align",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10191,columnNumber:22},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10176,columnNumber:20},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10174,columnNumber:18},void 0),l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("span",{className:"text-white text-sm font-semibold",children:"Lists:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10202,columnNumber:20},void 0),l.jsxDEV("div",{className:"flex gap-1",children:[l.jsxDEV("button",{onClick:()=>Ur("bullet"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded flex items-center justify-center",title:"Bullet List",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10204,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("list"),className:"w-8 h-8 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded flex items-center justify-center",title:"Numbered List",children:"1."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10211,columnNumber:22},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10203,columnNumber:20},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10201,columnNumber:18},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10097,columnNumber:16},void 0),l.jsxDEV("div",{className:"flex items-center justify-center gap-6 p-3",children:[l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("span",{className:"text-white text-sm font-semibold",children:"Text Color:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10225,columnNumber:20},void 0),l.jsxDEV("div",{className:"flex gap-1",children:[l.jsxDEV("button",{onClick:()=>Ur("color","#ffffff"),className:"w-6 h-6 bg-white border border-slate-400 rounded",title:"White"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10227,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("color","#ef4444"),className:"w-6 h-6 bg-red-500 rounded",title:"Red"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10232,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("color","#3b82f6"),className:"w-6 h-6 bg-blue-500 rounded",title:"Blue"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10237,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("color","#22c55e"),className:"w-6 h-6 bg-green-500 rounded",title:"Green"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10242,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("color","#f97316"),className:"w-6 h-6 bg-orange-500 rounded",title:"Orange"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10247,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("color","#a855f7"),className:"w-6 h-6 bg-purple-500 rounded",title:"Purple"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10252,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("color","#000000"),className:"w-6 h-6 bg-black border border-slate-400 rounded",title:"Black"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10257,columnNumber:22},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10226,columnNumber:20},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10224,columnNumber:18},void 0),l.jsxDEV("div",{className:"flex items-center gap-2",children:[l.jsxDEV("span",{className:"text-white text-sm font-semibold",children:"Highlight:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10266,columnNumber:20},void 0),l.jsxDEV("div",{className:"flex gap-1",children:[l.jsxDEV("button",{onClick:()=>Ur("highlight","transparent"),className:"w-6 h-6 bg-slate-600 border border-slate-400 rounded flex items-center justify-center text-white text-xs",title:"No Highlight",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10268,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("highlight","#fbbf24"),className:"w-6 h-6 bg-yellow-400 rounded",title:"Yellow"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10275,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("highlight","#60a5fa"),className:"w-6 h-6 bg-blue-400 rounded",title:"Light Blue"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10280,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("highlight","#4ade80"),className:"w-6 h-6 bg-green-400 rounded",title:"Light Green"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10285,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("highlight","#f472b6"),className:"w-6 h-6 bg-pink-400 rounded",title:"Pink"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10290,columnNumber:22},void 0),l.jsxDEV("button",{onClick:()=>Ur("highlight","#fb923c"),className:"w-6 h-6 bg-orange-400 rounded",title:"Orange"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10295,columnNumber:22},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10267,columnNumber:20},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10265,columnNumber:18},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10223,columnNumber:16},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10095,columnNumber:14},void 0),l.jsxDEV("div",{className:"flex-1 min-h-[400px] mb-6",children:[l.jsxDEV("label",{className:"block text-white text-sm mb-2",children:"Notes:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10307,columnNumber:16},void 0),l.jsxDEV("div",{id:"notes-editor",contentEditable:!0,className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white text-base focus:outline-none focus:border-blue-500 overflow-auto",style:{height:"400px",lineHeight:"1.5",fontFamily:"system-ui, -apple-system, sans-serif"},"data-placeholder":"Start typing your notes here...",onInput:h=>{}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10308,columnNumber:16},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10306,columnNumber:14},void 0),l.jsxDEV("div",{className:"flex gap-3",children:[l.jsxDEV("button",{onClick:rp,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10326,columnNumber:16},void 0),l.jsxDEV("button",{onClick:()=>{Dt(!1),er(null),Sn()},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10332,columnNumber:16},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10325,columnNumber:14},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10091,columnNumber:12},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10090,columnNumber:10},void 0),wr&&ar!==null&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-xl max-w-5xl w-full max-h-[90vh] flex flex-col",children:[l.jsxDEV("div",{className:"flex justify-between items-center p-6 border-b border-slate-700",children:[l.jsxDEV("h2",{className:"text-xl font-bold text-white",children:["Edit Speakers (",Xe.length,"/7)"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10353,columnNumber:16},void 0),l.jsxDEV("button",{onClick:()=>{ur(!1),Ve(null),Sn()},className:"text-slate-400 hover:text-white text-xl",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10356,columnNumber:16},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10352,columnNumber:14},void 0),l.jsxDEV("div",{className:"flex-1 p-6 overflow-y-auto",children:[l.jsxDEV("div",{className:"mb-6",children:l.jsxDEV("button",{onClick:ap,disabled:Xe.length>=7,className:"px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors",children:["+ Add Speaker ",Xe.length<7&&`(${7-Xe.length} slots remaining)`]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10373,columnNumber:18},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10372,columnNumber:16},void 0),l.jsxDEV("div",{className:"space-y-4 mb-6",children:[Xe.sort((h,C)=>h.slot-C.slot).map(h=>l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:[l.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[l.jsxDEV("h3",{className:"text-lg font-semibold text-white",children:["Speaker ",h.slot]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10387,columnNumber:24},void 0),l.jsxDEV("button",{onClick:()=>sp(h.id),className:"w-8 h-8 bg-red-600 hover:bg-red-500 text-white rounded flex items-center justify-center transition-colors",title:"Remove Speaker",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10390,columnNumber:24},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10386,columnNumber:22},void 0),l.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Slot Number"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10402,columnNumber:26},void 0),l.jsxDEV("select",{value:h.slot,onChange:C=>ip(h.id,parseInt(C.target.value)),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[1,2,3,4,5,6,7].map(C=>{const D=Xe.some(V=>V.id!==h.id&&V.slot===C);return l.jsxDEV("option",{value:C,className:D?"bg-yellow-600 text-white":"bg-slate-600 text-white",children:[C," ",D?"(Used)":""]},C,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10413,columnNumber:32},void 0)})},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10405,columnNumber:26},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10401,columnNumber:24},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Location"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10423,columnNumber:26},void 0),l.jsxDEV("select",{value:h.location,onChange:C=>$i(h.id,"location",C.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[l.jsxDEV("option",{value:"Podium",children:"Podium"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10431,columnNumber:28},void 0),l.jsxDEV("option",{value:"Seat",children:"Seat"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10432,columnNumber:28},void 0),l.jsxDEV("option",{value:"Moderator",children:"Moderator"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10433,columnNumber:28},void 0),l.jsxDEV("option",{value:"Virtual",children:"Virtual"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10434,columnNumber:28},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10426,columnNumber:26},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10422,columnNumber:24},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Full Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10440,columnNumber:26},void 0),l.jsxDEV("input",{type:"text",value:h.fullName,onChange:C=>$i(h.id,"fullName",C.target.value),placeholder:"Enter full name",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10443,columnNumber:26},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10439,columnNumber:24},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Title (subtext line 1)"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10454,columnNumber:26},void 0),l.jsxDEV("input",{type:"text",value:h.title,onChange:C=>$i(h.id,"title",C.target.value),placeholder:"Enter title",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10457,columnNumber:26},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10453,columnNumber:24},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Organization (subtext line 2)"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10468,columnNumber:26},void 0),l.jsxDEV("input",{type:"text",value:h.org,onChange:C=>$i(h.id,"org",C.target.value),placeholder:"Enter organization",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10471,columnNumber:26},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10467,columnNumber:24},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Photo Link"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10482,columnNumber:26},void 0),l.jsxDEV("div",{className:"flex gap-2",children:[l.jsxDEV("input",{type:"url",value:h.photoLink,onChange:C=>$i(h.id,"photoLink",C.target.value),placeholder:"Enter photo URL",className:"flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10486,columnNumber:28},void 0),h.photoLink&&l.jsxDEV("div",{className:"flex-shrink-0",children:l.jsxDEV("img",{src:h.photoLink,alt:h.fullName,className:"w-12 h-12 rounded object-cover border-2 border-slate-500 -mt-2.5",onError:C=>{C.currentTarget.style.display="none"}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10495,columnNumber:32},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10494,columnNumber:30},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10485,columnNumber:26},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10481,columnNumber:24},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10399,columnNumber:22},void 0)]},h.id,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10385,columnNumber:20},void 0)),Xe.length===0&&l.jsxDEV("div",{className:"text-center py-8 text-slate-400",children:'No speakers added yet. Click "Add Speaker" to get started.'},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10512,columnNumber:20},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10383,columnNumber:16},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10369,columnNumber:14},void 0),l.jsxDEV("div",{className:"border-t border-slate-700 p-6",children:l.jsxDEV("div",{className:"flex gap-3",children:[l.jsxDEV("button",{onClick:s0,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10522,columnNumber:18},void 0),l.jsxDEV("button",{onClick:()=>{ur(!1),Ve(null),Sn()},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10528,columnNumber:18},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10521,columnNumber:16},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10520,columnNumber:14},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10350,columnNumber:12},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10349,columnNumber:10},void 0),Be&&vt!==null&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxDEV("h2",{className:"text-2xl font-bold text-white mb-6",children:"Edit Assets"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10548,columnNumber:14},void 0),l.jsxDEV("div",{className:"space-y-4",children:[l.jsxDEV("div",{className:"flex justify-between items-center",children:[l.jsxDEV("h3",{className:"text-lg font-semibold text-white",children:"Assets List"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10552,columnNumber:18},void 0),l.jsxDEV("button",{onClick:bc,className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:"+ Add Asset"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10553,columnNumber:18},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10551,columnNumber:16},void 0),l.jsxDEV("div",{id:"assets-list",className:"space-y-3"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10561,columnNumber:16},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10550,columnNumber:14},void 0),l.jsxDEV("div",{className:"flex gap-3 mt-6",children:[l.jsxDEV("button",{onClick:ko,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10567,columnNumber:16},void 0),l.jsxDEV("button",{onClick:()=>{Qe(!1),St(null),Sn()},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10573,columnNumber:16},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10566,columnNumber:14},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10547,columnNumber:12},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10546,columnNumber:10},void 0),tr&&tt!==null&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[l.jsxDEV("h2",{className:"text-2xl font-bold text-white",children:"Assets List"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10593,columnNumber:16},void 0),l.jsxDEV("button",{onClick:()=>{$e(!1),Ct(null)},className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:"Close"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10594,columnNumber:16},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10592,columnNumber:14},void 0),l.jsxDEV("div",{className:"space-y-4",children:(()=>{const h=S.find(D=>D.id===tt);if(!h||!h.assets)return l.jsxDEV("div",{className:"text-center py-8",children:l.jsxDEV("p",{className:"text-slate-400 text-lg",children:"No assets available for this item."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10611,columnNumber:24},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10610,columnNumber:22},void 0);let C=[];if(h.assets.includes("||"))C=h.assets.split("||").filter(V=>V.trim()).map(V=>{if(V.includes("|")){const[re,ue]=V.split("|").map(be=>be.trim());return{name:re||"Unnamed Asset",url:ue||""}}else return{name:V.trim(),url:""}});else if(h.assets.includes("|")){const[D,V]=h.assets.split("|").map(re=>re.trim());C=[{name:D||"Unnamed Asset",url:V||""}]}else try{const D=JSON.parse(h.assets);Array.isArray(D)?C=D.map(V=>({name:V.name||"Unnamed Asset",url:V.link||V.url||""})):C=[{name:D.name||"Unnamed Asset",url:D.link||D.url||""}]}catch{C=[{name:h.assets.trim(),url:""}]}return C.length===0?l.jsxDEV("div",{className:"text-center py-8",children:l.jsxDEV("p",{className:"text-slate-400 text-lg",children:"No assets available for this item."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10672,columnNumber:24},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10671,columnNumber:22},void 0):l.jsxDEV("div",{className:"space-y-4",children:l.jsxDEV("div",{className:"max-h-96 overflow-y-auto space-y-3 pr-2",children:C.map((D,V)=>l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:l.jsxDEV("div",{className:"space-y-2",children:[l.jsxDEV("div",{className:"text-white font-semibold text-lg",children:D.name},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10683,columnNumber:30},void 0),D.url&&l.jsxDEV("div",{children:l.jsxDEV("a",{href:D.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline break-all text-sm",children:D.url},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10688,columnNumber:34},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10687,columnNumber:32},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10682,columnNumber:28},void 0)},V,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10681,columnNumber:26},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10679,columnNumber:22},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10678,columnNumber:20},void 0)})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10605,columnNumber:14},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10591,columnNumber:12},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10590,columnNumber:10},void 0),Nt&&kt!==null&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-xl max-w-5xl w-full max-h-[90vh] flex flex-col",children:[l.jsxDEV("div",{className:"flex justify-between items-center p-6 border-b border-slate-700",children:[l.jsxDEV("h2",{className:"text-xl font-bold text-white",children:["Edit Participants (",Lt.length,"/7)"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10716,columnNumber:16},void 0),l.jsxDEV("button",{onClick:()=>{Ot(!1),Ft(null)},className:"text-slate-400 hover:text-white text-xl",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10719,columnNumber:16},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10715,columnNumber:14},void 0),l.jsxDEV("div",{className:"flex-1 p-6 overflow-y-auto",children:[l.jsxDEV("div",{className:"mb-6",children:l.jsxDEV("button",{onClick:Mu,disabled:Lt.length>=7,className:"px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors",children:["+ Add Speaker ",Lt.length<7&&`(${7-Lt.length} slots remaining)`]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10734,columnNumber:18},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10733,columnNumber:16},void 0),l.jsxDEV("div",{className:"space-y-4",children:[Lt.sort((h,C)=>h.slot-C.slot).map(h=>l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-4 border border-slate-600",children:[l.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[l.jsxDEV("h3",{className:"text-lg font-semibold text-white",children:["Speaker ",h.slot]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10748,columnNumber:24},void 0),l.jsxDEV("button",{onClick:()=>i0(h.id),className:"w-8 h-8 bg-red-600 hover:bg-red-500 text-white rounded flex items-center justify-center transition-colors",title:"Remove Speaker",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10751,columnNumber:24},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10747,columnNumber:22},void 0),l.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Slot Number"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10763,columnNumber:26},void 0),l.jsxDEV("select",{value:h.slot,onChange:C=>op(h.id,parseInt(C.target.value)),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[1,2,3,4,5,6,7].map(C=>{const D=Lt.some(V=>V.id!==h.id&&V.slot===C);return l.jsxDEV("option",{value:C,className:D?"bg-yellow-600 text-white":"bg-slate-600 text-white",children:[C," ",D?"(Used)":""]},C,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10774,columnNumber:32},void 0)})},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10766,columnNumber:26},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10762,columnNumber:24},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Location"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10784,columnNumber:26},void 0),l.jsxDEV("select",{value:h.location,onChange:C=>Ro(h.id,"location",C.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm focus:outline-none focus:border-blue-500",children:[l.jsxDEV("option",{value:"Podium",children:"Podium"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10792,columnNumber:28},void 0),l.jsxDEV("option",{value:"Seat",children:"Seat"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10793,columnNumber:28},void 0),l.jsxDEV("option",{value:"Moderator",children:"Moderator"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10794,columnNumber:28},void 0),l.jsxDEV("option",{value:"Virtual",children:"Virtual"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10795,columnNumber:28},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10787,columnNumber:26},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10783,columnNumber:24},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Full Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10801,columnNumber:26},void 0),l.jsxDEV("input",{type:"text",value:h.fullName,onChange:C=>Ro(h.id,"fullName",C.target.value),placeholder:"Enter full name",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10804,columnNumber:26},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10800,columnNumber:24},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Title"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10815,columnNumber:26},void 0),l.jsxDEV("input",{type:"text",value:h.title,onChange:C=>Ro(h.id,"title",C.target.value),placeholder:"Enter title/position",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10818,columnNumber:26},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10814,columnNumber:24},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Organization"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10829,columnNumber:26},void 0),l.jsxDEV("input",{type:"text",value:h.org,onChange:C=>Ro(h.id,"org",C.target.value),placeholder:"Enter organization",className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10832,columnNumber:26},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10828,columnNumber:24},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Speaker Photo Link"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10843,columnNumber:26},void 0),l.jsxDEV("div",{className:"flex items-center gap-3",children:[l.jsxDEV("input",{type:"url",value:h.photoLink,onChange:C=>Ro(h.id,"photoLink",C.target.value),placeholder:"Enter photo URL",className:"flex-1 px-3 py-2 bg-slate-600 border border-slate-500 rounded text-white text-sm placeholder-slate-400 focus:outline-none focus:border-blue-500"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10847,columnNumber:28},void 0),h.photoLink&&l.jsxDEV("div",{className:"flex-shrink-0",children:l.jsxDEV("img",{src:h.photoLink,alt:h.fullName,className:"w-12 h-12 rounded object-cover border-2 border-slate-500 -mt-2.5",onError:C=>{C.target.style.display="none"}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10856,columnNumber:32},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10855,columnNumber:30},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10846,columnNumber:26},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10842,columnNumber:24},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10760,columnNumber:22},void 0)]},h.id,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10746,columnNumber:20},void 0)),Lt.length===0&&l.jsxDEV("div",{className:"text-center py-8",children:[l.jsxDEV("div",{className:"text-slate-400 text-lg mb-4",children:"No speakers added yet"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10875,columnNumber:22},void 0),l.jsxDEV("button",{onClick:Mu,className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Add Your First Speaker"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10876,columnNumber:22},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10874,columnNumber:20},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10744,columnNumber:16},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10731,columnNumber:14},void 0),l.jsxDEV("div",{className:"border-t border-slate-700 p-6",children:l.jsxDEV("div",{className:"flex gap-3",children:[l.jsxDEV("button",{onClick:np,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-semibold rounded-lg transition-colors",children:"Save & Close"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10890,columnNumber:18},void 0),l.jsxDEV("button",{onClick:()=>{Ot(!1),Ft(null)},className:"flex-1 px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white font-semibold rounded-lg transition-colors",children:"Cancel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10896,columnNumber:18},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10889,columnNumber:16},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10888,columnNumber:14},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10713,columnNumber:12},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10712,columnNumber:10},void 0),Xn&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg p-6 max-w-md w-full",children:[l.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[l.jsxDEV("h3",{className:"text-xl font-bold text-white",children:"Send Message to Full Screen Timer"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10916,columnNumber:15},void 0),l.jsxDEV("button",{onClick:()=>Ai(!1),className:"text-slate-400 hover:text-white transition-colors",children:l.jsxDEV("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10922,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10921,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10917,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10915,columnNumber:13},void 0),l.jsxDEV("div",{className:"space-y-4",children:[l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Quick Presets"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10930,columnNumber:17},void 0),l.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:["Break in 5 minutes","Technical difficulties","Starting soon","Please wait","Break time","Resuming shortly","Stall / Stretch Time","Wrap Up Please"].map(h=>l.jsxDEV("button",{onClick:()=>Ps(h),className:"px-3 py-2 bg-slate-700 hover:bg-slate-600 border border-slate-600 rounded text-white text-sm transition-colors text-left",children:h},h,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10944,columnNumber:21},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10933,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10929,columnNumber:15},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-white text-sm font-medium mb-2",children:"Custom Message"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10957,columnNumber:17},void 0),l.jsxDEV("textarea",{value:fs,onChange:h=>Ps(h.target.value),placeholder:"Enter custom message to display on full screen timer...",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-sm h-24 resize-none"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10960,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10956,columnNumber:15},void 0),fs&&l.jsxDEV("div",{className:"p-3 bg-slate-700 rounded-lg",children:l.jsxDEV("div",{className:"text-slate-300 text-sm",children:[l.jsxDEV("strong",{children:"Message Preview:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10972,columnNumber:21},void 0)," ",fs]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10971,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10970,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10927,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex gap-3 mt-6",children:[l.jsxDEV("button",{onClick:async()=>{if(!(!fs.trim()||!e?.id))try{const C=(await it.getTimerMessagesForEvent(e.id)).filter(re=>re.enabled);for(const re of C)await it.disableTimerMessage(re.id),console.log(" Disabled existing message:",re.id);const D={event_id:e.id,message:fs.trim(),enabled:!0,sent_by:i?.id,sent_by_name:i?.full_name||i?.email||"Unknown User",sent_by_role:c||"VIEWER",message_type:"general",priority:2},V=await it.saveTimerMessage(D);if(!V){console.error(" Failed to save message to Supabase"),alert("Failed to save message. Please try again.");return}console.log(" New message created in Supabase:",V),Ja(!0),Fr&&!Fr.closed&&Fr.postMessage({type:"MESSAGE_UPDATE",message:fs,enabled:!0},"*"),Ps(""),Ai(!1)}catch(h){console.error(" Error saving message:",h),alert("Error saving message. Please try again.")}},className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded transition-colors",disabled:!fs.trim()||!e?.id,children:"Send & Activate Message"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10980,columnNumber:15},void 0),l.jsxDEV("button",{onClick:()=>Ai(!1),className:"flex-1 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors",children:"Cancel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11038,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10979,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10914,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:10913,columnNumber:9},void 0),Li&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg max-w-md w-full max-h-[80vh] flex flex-col",children:[l.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-slate-600",children:[l.jsxDEV("h2",{className:"text-lg font-bold text-white",children:"Filter Columns"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11055,columnNumber:15},void 0),l.jsxDEV("button",{onClick:()=>ms(!1),className:"text-slate-400 hover:text-white text-xl",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11056,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11054,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex-1 overflow-y-auto p-4",children:l.jsxDEV("div",{className:"space-y-3",children:[l.jsxDEV("p",{className:"text-slate-300 text-sm mb-4",children:"Select which columns to display in the schedule:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11067,columnNumber:17},void 0),l.jsxDEV("div",{className:"space-y-2",children:[l.jsxDEV("label",{className:"flex items-center gap-3",children:[l.jsxDEV("input",{type:"checkbox",checked:yt.start,onChange:h=>Yn(C=>({...C,start:h.target.checked})),className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11071,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-white",children:"Start Time"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11077,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11070,columnNumber:19},void 0),l.jsxDEV("label",{className:"flex items-center gap-3",children:[l.jsxDEV("input",{type:"checkbox",checked:yt.programType,onChange:h=>Yn(C=>({...C,programType:h.target.checked})),className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11081,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-white",children:"Program Type"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11087,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11080,columnNumber:19},void 0),l.jsxDEV("label",{className:"flex items-center gap-3",children:[l.jsxDEV("input",{type:"checkbox",checked:yt.duration,onChange:h=>Yn(C=>({...C,duration:h.target.checked})),className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11091,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-white",children:"Duration"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11097,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11090,columnNumber:19},void 0),l.jsxDEV("label",{className:"flex items-center gap-3",children:[l.jsxDEV("input",{type:"checkbox",checked:yt.segmentName,onChange:h=>Yn(C=>({...C,segmentName:h.target.checked})),className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11101,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-white",children:"Segment Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11107,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11100,columnNumber:19},void 0),l.jsxDEV("label",{className:"flex items-center gap-3",children:[l.jsxDEV("input",{type:"checkbox",checked:yt.shotType,onChange:h=>Yn(C=>({...C,shotType:h.target.checked})),className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11111,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-white",children:"Shot Type"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11117,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11110,columnNumber:19},void 0),l.jsxDEV("label",{className:"flex items-center gap-3",children:[l.jsxDEV("input",{type:"checkbox",checked:yt.pptQA,onChange:h=>Yn(C=>({...C,pptQA:h.target.checked})),className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11121,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-white",children:"PPT/Q&A"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11127,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11120,columnNumber:19},void 0),l.jsxDEV("label",{className:"flex items-center gap-3",children:[l.jsxDEV("input",{type:"checkbox",checked:yt.notes,onChange:h=>Yn(C=>({...C,notes:h.target.checked})),className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11131,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-white",children:"Notes"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11137,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11130,columnNumber:19},void 0),l.jsxDEV("label",{className:"flex items-center gap-3",children:[l.jsxDEV("input",{type:"checkbox",checked:yt.assets,onChange:h=>Yn(C=>({...C,assets:h.target.checked})),className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11141,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-white",children:"Assets"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11147,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11140,columnNumber:19},void 0),l.jsxDEV("label",{className:"flex items-center gap-3",children:[l.jsxDEV("input",{type:"checkbox",checked:yt.speakers,onChange:h=>Yn(C=>({...C,speakers:h.target.checked})),className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11162,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-white",children:"Speakers"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11168,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11161,columnNumber:19},void 0),l.jsxDEV("label",{className:"flex items-center gap-3",children:[l.jsxDEV("input",{type:"checkbox",checked:yt.public,onChange:h=>Yn(C=>({...C,public:h.target.checked})),className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11173,columnNumber:21},void 0),l.jsxDEV("span",{className:"text-white",children:"Public"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11179,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11172,columnNumber:19},void 0),W.map((h,C)=>l.jsxDEV("label",{className:"flex items-center gap-3",children:[l.jsxDEV("input",{type:"checkbox",checked:qn[h.id]!==!1,onChange:D=>bn(V=>({...V,[h.id]:D.target.checked})),className:"rounded"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11184,columnNumber:23},void 0),l.jsxDEV("span",{className:"text-white",children:[h.name,l.jsxDEV("span",{className:"text-slate-400 text-xs ml-2",children:"(Custom)"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11192,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11190,columnNumber:23},void 0)]},h.id,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11183,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11069,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11066,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11065,columnNumber:13},void 0),l.jsxDEV("div",{className:"p-4 border-t border-slate-600",children:l.jsxDEV("div",{className:"flex gap-2",children:[l.jsxDEV("button",{onClick:()=>{Yn({start:!0,programType:!0,duration:!0,segmentName:!0,shotType:!0,pptQA:!0,notes:!0,assets:!0,participants:!1,speakers:!0,public:!0,custom:!0});const h={};W.forEach(C=>{h[C.id]=!0}),bn(h)},className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors text-sm",children:"Show All"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11203,columnNumber:17},void 0),l.jsxDEV("button",{onClick:()=>{Yn({start:!1,programType:!1,duration:!1,segmentName:!1,shotType:!1,pptQA:!1,notes:!1,assets:!1,participants:!1,speakers:!1,public:!1,custom:!1});const h={};W.forEach(C=>{h[C.id]=!1}),bn(h)},className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded transition-colors text-sm",children:"Hide All"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11230,columnNumber:17},void 0),l.jsxDEV("button",{onClick:()=>ms(!1),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded transition-colors text-sm",children:"Apply Filters"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11257,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11202,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11201,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11052,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11051,columnNumber:9},void 0),pc&&As&&l.jsxDEV("div",{className:"fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50",children:l.jsxDEV("div",{className:`px-6 py-4 rounded-lg shadow-lg border-2 flex items-center gap-3 ${Me==="early"?"bg-yellow-600 border-yellow-500 text-yellow-100":Me==="late"?"bg-red-600 border-red-500 text-red-100":"bg-green-600 border-green-500 text-green-100"}`,children:[l.jsxDEV("div",{className:"text-3xl flex-shrink-0",children:Me==="early"?"":Me==="late"?"":""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11279,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex-1",children:[l.jsxDEV("div",{className:"font-bold text-lg mb-1",children:Me==="early"?"EARLY":Me==="late"?"RUNNING LATE":"ON TIME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11283,columnNumber:15},void 0),l.jsxDEV("div",{className:"text-base font-medium",children:[l.jsxDEV("span",{className:"text-2xl font-bold",children:_t>=60?`${Math.floor(_t/60)}h ${_t%60}m`:`${_t}m`},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11287,columnNumber:17},void 0),Me==="early"?` before ${Object.keys(ct).length>0?(S.find(h=>h.id===parseInt(Object.keys(ct)[0]))?.customFields.cue||"CUE").replace(/CUE(\d+)/,"CUE $1"):"CUE"} start`:Me==="late"?` after ${Object.keys(ct).length>0?(S.find(h=>h.id===parseInt(Object.keys(ct)[0]))?.customFields.cue||"CUE").replace(/CUE(\d+)/,"CUE $1"):"CUE"} start`:" - Timing is on track"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11286,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11282,columnNumber:13},void 0),l.jsxDEV("button",{onClick:()=>hs(!1),className:"ml-4 text-xl hover:opacity-70 transition-opacity",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11298,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11272,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11271,columnNumber:9},void 0),l.jsxDEV(tL,{isOpen:bo,onClose:()=>oi(!1),event:e},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11310,columnNumber:7},void 0),l.jsxDEV(rL,{isOpen:No,onClose:()=>Do(!1),onSelectFullscreenTimer:up,onSelectClock:dp},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11317,columnNumber:7},void 0),Vi&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg p-8 w-full max-w-7xl max-h-[95vh] overflow-hidden flex flex-col",children:[l.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[l.jsxDEV("h2",{className:"text-2xl font-bold text-white",children:"Backup Management"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11329,columnNumber:15},void 0),l.jsxDEV("button",{onClick:()=>ji(!1),className:"text-slate-400 hover:text-white text-2xl font-bold",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11330,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11328,columnNumber:13},void 0),l.jsxDEV("div",{className:"bg-blue-900 border border-blue-600 rounded-lg p-4 mb-6",children:l.jsxDEV("div",{className:"flex items-start",children:[l.jsxDEV("div",{className:"text-blue-400 text-xl mr-3",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11341,columnNumber:17},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"text-blue-200 font-semibold mb-1",children:"Neon Database Backups"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11343,columnNumber:19},void 0),l.jsxDEV("p",{className:"text-blue-100 text-sm",children:'Create and manage backups of your run of show data stored in Neon database. Use the " Create Backup" button to create manual backups when needed.'},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11344,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11342,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11340,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11339,columnNumber:13},void 0),l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-6 mb-6",children:[l.jsxDEV("h3",{className:"text-lg font-semibold text-white mb-4",children:"Filter & Search"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11354,columnNumber:15},void 0),l.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-base font-medium mb-3",children:"Search by Event Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11357,columnNumber:19},void 0),l.jsxDEV("input",{type:"text",placeholder:"Filter by event name...",className:"w-full px-4 py-3 bg-slate-600 border border-slate-500 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 text-base",onChange:h=>{}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11358,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11356,columnNumber:17},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-base font-medium mb-3",children:"Filter by Date"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11368,columnNumber:19},void 0),l.jsxDEV("input",{type:"date",className:"w-full px-4 py-3 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:border-blue-500 text-base",onChange:h=>{}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11369,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11367,columnNumber:17},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-slate-300 text-base font-medium mb-3",children:"Sort by"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11378,columnNumber:19},void 0),l.jsxDEV("select",{className:"w-full px-4 py-3 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:border-blue-500 text-base",children:[l.jsxDEV("option",{value:"newest",children:"Newest First"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11380,columnNumber:21},void 0),l.jsxDEV("option",{value:"oldest",children:"Oldest First"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11381,columnNumber:21},void 0),l.jsxDEV("option",{value:"event",children:"Event Name"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11382,columnNumber:21},void 0),l.jsxDEV("option",{value:"type",children:"Backup Type"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11383,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11379,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11377,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11355,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11353,columnNumber:13},void 0),l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-6 flex-1 overflow-hidden flex flex-col",children:[l.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[l.jsxDEV("h3",{className:"text-xl font-semibold text-white",children:"Available Backups"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11392,columnNumber:17},void 0),l.jsxDEV("button",{onClick:Hu,className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white text-base font-medium rounded-lg transition-colors",children:" Refresh"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11393,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11391,columnNumber:15},void 0),l.jsxDEV("div",{className:"flex-1 overflow-y-auto",children:hl.length===0?l.jsxDEV("div",{className:"text-slate-400 text-center py-12 text-lg",children:'No backups available. Use the " Create Backup" button in the main interface to create a manual backup.'},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11403,columnNumber:19},void 0):l.jsxDEV("div",{className:"space-y-4",children:hl.map(h=>l.jsxDEV("div",{className:"bg-slate-600 p-6 rounded-lg flex justify-between items-center hover:bg-slate-500 transition-colors",children:[l.jsxDEV("div",{className:"flex-1",children:[l.jsxDEV("div",{className:"text-white font-semibold text-xl mb-2 flex items-center gap-3",children:[h.backup_name,l.jsxDEV("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${h.backup_type==="auto"?"bg-blue-600 text-blue-100":"bg-green-600 text-green-100"}`,children:h.backup_type},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11413,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11411,columnNumber:27},void 0),l.jsxDEV("div",{className:"text-slate-400 text-sm",children:[l.jsxDEV("strong",{children:"Event Date:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11422,columnNumber:29},void 0)," ",h.event_data?.date?new Date(h.event_data.date).toLocaleDateString():"N/A"," ",l.jsxDEV("strong",{children:" Schedule Items:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11423,columnNumber:29},void 0)," ",h.schedule_data?.length||0," ",l.jsxDEV("strong",{children:" Custom Columns:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11424,columnNumber:29},void 0)," ",h.custom_columns_data?.length||0]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11421,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11410,columnNumber:25},void 0),l.jsxDEV("div",{className:"flex space-x-3",children:[l.jsxDEV("button",{onClick:()=>Jn(h),className:"px-6 py-3 bg-green-600 hover:bg-green-500 text-white text-base font-medium rounded-lg transition-colors",title:"Preview and load this backup",children:" Load/Overwrite"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11428,columnNumber:27},void 0),l.jsxDEV("button",{onClick:()=>hp(h.id),className:"px-5 py-3 bg-red-600 hover:bg-red-500 text-white text-base font-medium rounded-lg transition-colors",title:"Delete this backup",children:" Delete"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11435,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11427,columnNumber:25},void 0)]},h.id,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11409,columnNumber:23},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11407,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11401,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11390,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11327,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11326,columnNumber:9},void 0),Us&&Gn&&l.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-lg p-8 w-full max-w-2xl",children:[l.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[l.jsxDEV("h2",{className:"text-2xl font-bold text-white",children:"Confirm Backup Restore"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11458,columnNumber:15},void 0),l.jsxDEV("button",{onClick:()=>jt(!1),className:"text-slate-400 hover:text-white text-2xl font-bold",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11459,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11457,columnNumber:13},void 0),l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-6 mb-6",children:[l.jsxDEV("h3",{className:"text-lg font-semibold text-white mb-4",children:"Backup Details"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11468,columnNumber:15},void 0),l.jsxDEV("div",{className:"space-y-3",children:[l.jsxDEV("div",{className:"flex justify-between",children:[l.jsxDEV("span",{className:"text-slate-300",children:"Backup Name:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11471,columnNumber:19},void 0),l.jsxDEV("span",{className:"text-white font-medium",children:Gn.backup_name},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11472,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11470,columnNumber:17},void 0),l.jsxDEV("div",{className:"flex justify-between",children:[l.jsxDEV("span",{className:"text-slate-300",children:"Event:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11475,columnNumber:19},void 0),l.jsxDEV("span",{className:"text-white font-medium",children:Gn.event_data?.name||"Unknown"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11476,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11474,columnNumber:17},void 0),l.jsxDEV("div",{className:"flex justify-between",children:[l.jsxDEV("span",{className:"text-slate-300",children:"Date:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11479,columnNumber:19},void 0),l.jsxDEV("span",{className:"text-white font-medium",children:new Date(Gn.backup_timestamp).toLocaleString()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11480,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11478,columnNumber:17},void 0),l.jsxDEV("div",{className:"flex justify-between",children:[l.jsxDEV("span",{className:"text-slate-300",children:"Type:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11483,columnNumber:19},void 0),l.jsxDEV("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${Gn.backup_type==="auto"?"bg-blue-600 text-blue-100":"bg-green-600 text-green-100"}`,children:Gn.backup_type},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11484,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11482,columnNumber:17},void 0),l.jsxDEV("div",{className:"flex justify-between",children:[l.jsxDEV("span",{className:"text-slate-300",children:"Schedule Items:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11493,columnNumber:19},void 0),l.jsxDEV("span",{className:"text-white font-medium",children:Gn.schedule_data?.length||0},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11494,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11492,columnNumber:17},void 0),l.jsxDEV("div",{className:"flex justify-between",children:[l.jsxDEV("span",{className:"text-slate-300",children:"Custom Columns:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11497,columnNumber:19},void 0),l.jsxDEV("span",{className:"text-white font-medium",children:Gn.custom_columns_data?.length||0},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11498,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11496,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11469,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11467,columnNumber:13},void 0),l.jsxDEV("div",{className:"bg-yellow-900 border border-yellow-600 rounded-lg p-4 mb-6",children:l.jsxDEV("div",{className:"flex items-start",children:[l.jsxDEV("div",{className:"text-yellow-400 text-xl mr-3",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11505,columnNumber:17},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"text-yellow-200 font-semibold mb-2",children:"Warning"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11507,columnNumber:19},void 0),l.jsxDEV("p",{className:"text-yellow-100 text-sm",children:"This will completely overwrite your current run of show data with the backup data. This action cannot be undone. Make sure you want to proceed."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11508,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11506,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11504,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11503,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex justify-end space-x-4",children:[l.jsxDEV("button",{onClick:()=>jt(!1),className:"px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white text-base font-medium rounded-lg transition-colors",children:"Cancel"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11517,columnNumber:15},void 0),l.jsxDEV("button",{onClick:f0,className:"px-6 py-3 bg-green-600 hover:bg-green-500 text-white text-base font-medium rounded-lg transition-colors",children:" Confirm Restore"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11523,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11516,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11456,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11455,columnNumber:9},void 0),l.jsxDEV(a9,{isOpen:Tu,onClose:()=>li(!1),onImport:Np,onDeleteAll:Dp},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:11535,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6683,columnNumber:5},void 0):l.jsxDEV("div",{className:"min-h-screen bg-slate-900 text-white flex items-center justify-center",children:l.jsxDEV("div",{className:"text-center",children:[l.jsxDEV("h1",{className:"text-2xl font-bold mb-4",children:"No Event Selected"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6670,columnNumber:11},void 0),l.jsxDEV("button",{onClick:()=>n("/"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded",children:"Back to Event List"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6671,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6669,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/RunOfShowPage.tsx",lineNumber:6668,columnNumber:7},void 0)};class i9{constructor(n){this.activeTimers=new Map,this.checkInterval=null,this.syncCallbacks=new Map,this.isRunning=!1,this.config={checkInterval:3e4,maxDriftThreshold:30,forceSyncInterval:3e4,minTimerDuration:0,...n}}startMonitoring(n,e,s,i){if(console.log(` DriftDetector: Starting monitoring for timer ${n}`,{startedAt:e.toISOString(),duration:s,minDuration:this.config.minTimerDuration}),s<this.config.minTimerDuration){console.log(` DriftDetector: Skipping timer ${n} - duration too short (${s}s < ${this.config.minTimerDuration}s)`);return}const d={itemId:n,startedAt:e,duration:s,lastSyncAt:new Date,localElapsed:0,serverElapsed:0};this.activeTimers.set(n,d),this.syncCallbacks.set(n,i),this.isRunning||this.startMonitoringLoop()}stopMonitoring(n){console.log(` DriftDetector: Stopping monitoring for timer ${n}`),this.activeTimers.delete(n),this.syncCallbacks.delete(n),this.activeTimers.size===0&&this.isRunning&&this.stopMonitoringLoop()}updateLocalElapsed(n,e){const s=this.activeTimers.get(n);s&&(s.localElapsed=e)}async forceSync(n,e){const s=this.activeTimers.get(n);if(s)try{const i=await e(),d=Math.abs(i-s.localElapsed);console.log(` DriftDetector: Force sync for timer ${n}`,{localElapsed:s.localElapsed,serverElapsed:i,drift:d.toFixed(2)}),s.serverElapsed=i,s.lastSyncAt=new Date;const c=this.syncCallbacks.get(n);c&&c(i)}catch(i){console.error(` DriftDetector: Error during force sync for timer ${n}:`,i)}}startMonitoringLoop(){this.isRunning||(console.log(" DriftDetector: Starting monitoring loop"),this.isRunning=!0,this.checkInterval=setInterval(()=>{this.checkAllTimers()},this.config.checkInterval))}stopMonitoringLoop(){this.isRunning&&(console.log(" DriftDetector: Stopping monitoring loop"),this.isRunning=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null))}async checkAllTimers(){const n=new Date,e=[];for(const[s,i]of this.activeTimers)e.push(this.checkTimerDrift(s,i,n));await Promise.all(e)}async checkTimerDrift(n,e,s){try{const i=s.getTime()-e.lastSyncAt.getTime();if(i>=this.config.forceSyncInterval){console.log(` DriftDetector: Force sync needed for timer ${n} (${i}ms since last sync)`);return}const c=Math.floor((s.getTime()-e.startedAt.getTime())/1e3),f=Math.abs(c-e.localElapsed);f>this.config.maxDriftThreshold&&console.log(` DriftDetector: Significant drift detected for timer ${n}`,{localElapsed:e.localElapsed,expectedElapsed:c,drift:f.toFixed(2),threshold:this.config.maxDriftThreshold})}catch(i){console.error(` DriftDetector: Error checking drift for timer ${n}:`,i)}}getConfig(){return{...this.config}}updateConfig(n){this.config={...this.config,...n},console.log(" DriftDetector: Configuration updated",this.config)}getStatus(){const n=new Date;return Array.from(this.activeTimers.entries()).map(([e,s])=>{const i=Math.abs(s.serverElapsed-s.localElapsed),d=n.getTime()-s.lastSyncAt.getTime();return{itemId:e,drift:i,timeSinceLastSync:d}})}getStatusForTimer(n){const e=this.activeTimers.get(n);if(!e)return{itemId:n,drift:0,timeSinceLastSync:0};const s=new Date,i=Math.abs(e.serverElapsed-e.localElapsed),d=s.getTime()-e.lastSyncAt.getTime();return{itemId:n,drift:i,timeSinceLastSync:d}}destroy(){console.log(" DriftDetector: Destroying drift detector"),this.stopMonitoringLoop(),this.activeTimers.clear(),this.syncCallbacks.clear()}}const al=new i9,tk=({itemId:t,className:n=""})=>{const[e,s]=I.useState(null);if(I.useEffect(()=>{console.log(` DriftStatusIndicator: Starting for itemId ${t}`);const p=()=>{const x=al.getStatusForTimer(t);console.log(` DriftStatusIndicator: Status for itemId ${t}:`,x),x?(console.log(` DriftStatusIndicator: Found status for itemId ${t}:`,x),s({drift:x.drift,timeSinceLastSync:x.timeSinceLastSync})):(console.log(` DriftStatusIndicator: No status found for itemId ${t}`),s(null))};p();const g=setInterval(p,5e3);return()=>clearInterval(g)},[t]),!e)return console.log(` DriftStatusIndicator: No drift info for itemId ${t}, showing blue dot (starting up)`),l.jsxDEV("div",{className:`drift-status ${n}`,children:l.jsxDEV("div",{className:"w-2 h-2 rounded-full bg-blue-500",title:`Drift detection starting up for timer ${t}`},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DriftStatusIndicator.tsx",lineNumber:44,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DriftStatusIndicator.tsx",lineNumber:43,columnNumber:7},void 0);const{drift:i,timeSinceLastSync:d}=e,c=i>30,f=d>6e4;return l.jsxDEV("div",{className:`drift-status ${n}`,children:l.jsxDEV("div",{className:`w-2 h-2 rounded-full ${c?"bg-red-500":f?"bg-yellow-500":"bg-green-500"}`,title:`Drift: ${i.toFixed(1)}s, Last sync: ${Math.round(d/1e3)}s ago`},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DriftStatusIndicator.tsx",lineNumber:58,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/DriftStatusIndicator.tsx",lineNumber:57,columnNumber:5},void 0)},o9=({isRunning:t=!1,elapsedTime:n=0,totalDuration:e=0,onClose:s,message:i="",messageEnabled:d=!1,itemId:c,eventId:f,supabaseMessage:p=null,mainTimer:g=null,secondaryTimer:x=null,hybridTimerData:b=null})=>{const[E,w]=I.useState({elapsed:n,total:e}),[R,y]=I.useState(new Date),[U,q]=I.useState(!1),[G,_]=I.useState(!1),[ne,ee]=I.useState(!1),[Q,z]=I.useState(null),[ce,S]=I.useState(0),[A,W]=I.useState(null),[H,K]=I.useState(null),[Oe,ye]=I.useState(null),[Pe,ve]=I.useState(null),[Ge,ie]=I.useState(new Set);I.useEffect(()=>{x&&console.log(" Secondary timer prop updated:",{secondaryTimer:x,supabaseOnly:ne,hasSecondaryTimer:!!x})},[x,ne]),I.useEffect(()=>{if(ne&&b?.activeTimer){const O=b.activeTimer;if(O.is_running&&O.is_active){const P=new Date,F=new Date(O.started_at),de=Math.floor((P.getTime()-F.getTime())/1e3),fe=O.duration_seconds||0;w({elapsed:de,total:fe})}else w({elapsed:0,total:O.duration_seconds||0})}else if(!ne&&b?.activeTimer){const O=b.activeTimer;if(O.is_running&&O.is_active){const P=new Date,F=new Date(O.started_at),de=Math.floor((P.getTime()-F.getTime())/1e3),fe=O.duration_seconds||0;w({elapsed:de,total:fe})}else w({elapsed:0,total:O.duration_seconds||0})}else w({elapsed:n,total:e})},[n,e,ne,b]),I.useEffect(()=>{const O=setInterval(()=>{y(new Date)},1e3);return()=>clearInterval(O)},[]),I.useEffect(()=>{const O=()=>{q(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",O),()=>document.removeEventListener("fullscreenchange",O)},[]),I.useEffect(()=>{if(!ne||!f){if(Q&&(clearInterval(Q),z(null)),W(null),K(null),ye(null),A){const F=parseInt(A.split("_")[0]);al.stopMonitoring(F)}Pe&&(clearInterval(Pe),ve(null)),ie(new Set);return}const O=async()=>{try{console.log(" Fetching hybrid timer data from Supabase...");const F=await it.getHybridTimerData(f);if(setHybridTimerData(F),console.log(" Hybrid timer data updated:",F),F?.secondaryTimer?console.log(" Secondary timer data:",F.secondaryTimer):console.log(" No secondary timer data found"),F?.subCueTimers&&F.subCueTimers.length>0?(console.log(" Sub-cue timers data:",F.subCueTimers),console.log(" First sub-cue timer structure:",F.subCueTimers[0])):console.log(" No sub-cue timers data found"),F?.secondaryTimer&&console.log(" Secondary timer data (from sub-cue fallback):",F.secondaryTimer),F?.activeTimer&&console.log(" Active timer data for CUE display:",{cue_display:F.activeTimer.cue_display,cue:F.activeTimer.cue,item_id:F.activeTimer.item_id,allFields:Object.keys(F.activeTimer),fullData:F.activeTimer}),F?.lastLoadedCue&&console.log(" Last loaded cue data:",{cue:F.lastLoadedCue.cue,cue_display:F.lastLoadedCue.cue_display,segment_name:F.lastLoadedCue.segment_name,allFields:Object.keys(F.lastLoadedCue),fullData:F.lastLoadedCue}),F?.cueData?console.log(" CUE data from schedule/items table:",{allFields:Object.keys(F.cueData),fullData:F.cueData}):console.log(" No CUE data found from schedule/items tables"),F?.activeTimer&&console.log(" Full active timer data structure:",F.activeTimer),F?.activeTimer&&ne){const de=`${F.activeTimer.item_id}_${F.activeTimer.started_at}`,fe=F.activeTimer.item_id;A&&A!==de&&(console.log(" Active timer changed - stopping secondary timer"),console.log(" Previous timer:",A),console.log(" New timer:",de),setHybridTimerData(ze=>({...ze,secondaryTimer:null}))),H&&H!==fe&&(console.log(" New cue loaded - stopping secondary timer"),console.log(" Previous item_id:",H),console.log(" New item_id:",fe),setHybridTimerData(ze=>({...ze,secondaryTimer:null})));const ge=F.activeTimer.started_at;if(Oe&&Oe!==ge&&(console.log(" Timer start time changed - restarting local timer"),console.log(" Previous start time:",Oe),console.log(" New start time:",ge)),F.activeTimer.is_running&&F.activeTimer.is_active&&F.activeTimer.started_at){const ze=new Date(F.activeTimer.started_at),oe=F.activeTimer.duration_seconds;console.log(` Starting drift detection for timer ${fe} with duration ${oe}s`),al.stopMonitoring(fe),al.startMonitoring(fe,ze,oe,ft=>{console.log(` DriftDetector: Syncing timer ${fe} with server elapsed: ${ft}s`),ie(xt=>new Set(xt).add(fe))});const Tt=setInterval(async()=>{try{console.log(` DriftDetector: Starting periodic sync for timer ${fe}`),await al.forceSync(fe,async()=>{const xt=(await it.getActiveTimer(f))?.elapsed_seconds||0;return console.log(` DriftDetector: Server returned elapsed: ${xt}s for timer ${fe}`),xt})}catch(ft){console.warn(` DriftDetector: Failed to sync timer ${fe}:`,ft)}},3e4);ve(Tt)}W(de),K(fe),ye(ge)}else if(!F?.activeTimer&&A&&ne){if(console.log(" Active timer stopped - stopping secondary timer and drift detection"),setHybridTimerData(de=>({...de,secondaryTimer:null})),A){const de=parseInt(A.split("_")[0]);al.stopMonitoring(de),ie(fe=>{const ge=new Set(fe);return ge.delete(de),ge})}Pe&&(clearInterval(Pe),ve(null)),W(null),K(null),ye(null)}}catch(F){console.error(" Error fetching hybrid timer data:",F)}};O();const P=setInterval(O,3e3);return z(P),()=>{clearInterval(P),z(null)}},[ne,f]),I.useEffect(()=>{if(!ne&&!b?.secondaryTimer||ne&&!b?.secondaryTimer)return;const O=setInterval(()=>{S(P=>P+1)},1e3);return()=>clearInterval(O)},[ne,b?.secondaryTimer]),I.useEffect(()=>{if(!b?.activeTimer)return;const O=b.activeTimer,P=O.item_id;if(O.is_running&&O.is_active&&O.started_at){const F=new Date(O.started_at),de=O.duration_seconds;console.log(` Starting continuous local timer for ${P} with duration ${de}s, start time: ${F.toISOString()}`);const fe=setInterval(()=>{const ge=new Date,ze=Math.floor((ge.getTime()-F.getTime())/1e3);w(oe=>({...oe,elapsed:ze,total:de})),al.updateLocalElapsed(P,ze),ze<=10&&console.log(` Timer ${P}: Continuous elapsed=${ze}s, Start=${F.toISOString()}, Now=${ge.toISOString()}`)},1e3);return()=>{console.log(` Stopping continuous local timer for ${P}`),clearInterval(fe)}}},[b?.activeTimer,Oe]),I.useEffect(()=>()=>{console.log(" Cleaning up drift detector on component unmount"),al.destroy(),Pe&&clearInterval(Pe)},[]);const Ee=O=>{const P=O<0,F=Math.abs(O),de=Math.floor(F/3600),fe=Math.floor(F%3600/60),ge=Math.floor(F%60),ze=P?"-":"";return de===0?`${ze}${fe.toString().padStart(2,"0")}:${ge.toString().padStart(2,"0")}`:`${ze}${de.toString().padStart(2,"0")}:${fe.toString().padStart(2,"0")}:${ge.toString().padStart(2,"0")}`},Ce=O=>O.toLocaleTimeString("en-US",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}),j=()=>{const O=E,P=O.total-O.elapsed;if(b?.activeTimer){const F=b.activeTimer;if(!F.is_running||!F.is_active)return O.total}return P},X=()=>{const O=E,P=O.total-O.elapsed;if(b?.activeTimer){const F=b.activeTimer;if(!F.is_running||!F.is_active)return 100}return O.total>0?P/O.total*100:0},T=()=>{const O=E,P=O.total-O.elapsed;if(b?.activeTimer){const F=b.activeTimer;if(!F.is_running||!F.is_active)return"#6b7280"}return P>120?"#10b981":P>30?"#f59e0b":"#ef4444"};return l.jsxDEV("div",{className:"fixed inset-0 bg-black text-white overflow-hidden flex flex-col items-center justify-center",style:{padding:0,margin:0},children:[l.jsxDEV("div",{className:"absolute top-10 left-10 text-3xl font-mono text-white",children:[l.jsxDEV("div",{className:"text-slate-400 text-lg mb-1",children:"CURRENT TIME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:530,columnNumber:9},void 0),l.jsxDEV("div",{className:"text-white",children:Ce(R)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:531,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:529,columnNumber:7},void 0),l.jsxDEV("div",{className:"fixed top-10 right-10 text-3xl font-mono text-white z-50 w-80 text-right",children:[l.jsxDEV("div",{className:"text-slate-400 text-lg mb-1",children:"CURRENT CUE"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:538,columnNumber:9},void 0),l.jsxDEV("div",{className:"text-white flex items-center justify-end gap-3 whitespace-nowrap",children:[l.jsxDEV("span",{children:(()=>{if(b?.activeTimer){const O=b.activeTimer,P=b?.lastLoadedCue,F=b?.cueData;if(O.cue_is)return console.log(" Using CUE data from active timer cue_is:",O.cue_is),O.cue_is;if(F){console.log(" CUE data structure:",F),console.log(" CUE data fields:",Object.keys(F));const fe=F.customFields?.cue||F.cue||F.cue_display||F.name||F.title;if(F.segmentName||F.segment_name||F.segment,fe)return console.log(" Found CUE display:",fe),fe}const de=O.cue_display||O.cue;if(O.segment_name||O.segmentName,de)return de;if(P){const fe=P.cue_display||P.cue;if(P.segment_name||P.segmentName,fe)return fe}return O.item_id?`CUE ${O.item_id.toString().slice(-4)}`:"No CUE"}return g?g.cue.includes("CUE")?g.cue.replace(/CUE(\d+)/,"CUE $1"):`CUE ${g.cue}`:"No CUE"})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:540,columnNumber:11},void 0),c&&l.jsxDEV(tk,{itemId:c,className:"flex-shrink-0"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:599,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:539,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:537,columnNumber:7},void 0),!U&&b?.activeTimer&&l.jsxDEV("div",{className:"absolute bottom-10 left-10 text-center",children:l.jsxDEV("div",{className:`text-lg font-bold px-4 py-2 rounded-lg ${b.activeTimer.is_running&&b.activeTimer.is_active?"bg-green-600 text-white":"bg-gray-600 text-white"}`,children:b.activeTimer.is_running&&b.activeTimer.is_active?" TIMER RUNNING":" TIMER STOPPED"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:610,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:609,columnNumber:9},void 0),!U&&l.jsxDEV("div",{className:"absolute top-10 left-1/2 transform -translate-x-1/2 flex gap-3 z-50",children:[l.jsxDEV("button",{onClick:()=>{document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-bold text-lg transition-colors",children:"FULL SCREEN"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:626,columnNumber:9},void 0),!U&&l.jsxDEV("button",{onClick:()=>ee(!ne),className:`px-4 py-2 rounded-lg font-bold text-lg transition-colors ${ne?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-600 hover:bg-gray-700 text-white"}`,children:"NEON ONLY"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:637,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:625,columnNumber:9},void 0),(b?.timerMessage?b.timerMessage.enabled:d&&i||p&&p.enabled)&&l.jsxDEV("div",{className:"absolute inset-0 flex items-center justify-center",style:{transform:"translateY(-40px)"},children:l.jsxDEV("div",{className:"font-bold text-white bg-black bg-opacity-50 rounded-lg border-4 border-white text-center flex items-center justify-center",style:{width:"80vw",minHeight:"50vh",maxHeight:"70vh",lineHeight:"1.2",whiteSpace:"pre-line",overflow:"visible",padding:"30px",display:"flex",alignItems:"center",justifyContent:"center",wordWrap:"break-word"},children:(()=>{const O=b?.timerMessage?.message||p?.message||i,P=O.split(" ");let F;if(P.length<=3)F=O;else if(P.length<=6){const ge=Math.ceil(P.length/2);F=P.slice(0,ge).join(" ")+`
`+P.slice(ge).join(" ")}else if(P.length<=10){const ge=Math.ceil(P.length/3);F=P.slice(0,ge).join(" ")+`
`+P.slice(ge,ge*2).join(" ")+`
`+P.slice(ge*2).join(" ")}else{const ge=Math.ceil(P.length/4);F=P.slice(0,ge).join(" ")+`
`+P.slice(ge,ge*2).join(" ")+`
`+P.slice(ge*2,ge*3).join(" ")+`
`+P.slice(ge*3).join(" ")}let de;const fe=/[gjpqy]/.test(O.toLowerCase());return P.length<=3?de=fe?"clamp(3rem, 12vw, 16rem)":"clamp(3.5rem, 13.5vw, 18rem)":P.length<=6?de=fe?"clamp(1.9rem, 8vw, 12rem)":"clamp(2.25rem, 9vw, 13.5rem)":P.length<=10?de=fe?"clamp(1.4rem, 6vw, 9rem)":"clamp(1.6rem, 7vw, 10.5rem)":de=fe?"clamp(0.9rem, 4vw, 6rem)":"clamp(1.1rem, 5vw, 7rem)",l.jsxDEV("div",{style:{fontSize:de},children:F},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:726,columnNumber:17},void 0)})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:661,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:660,columnNumber:9},void 0),(()=>{const O=b?.secondaryTimer||x;if(!O)return!1;if(!O.is_running)return console.log(" Sub-cue timer not running - hiding"),!1;if(O.is_running&&O.is_active){const P=new Date,F=new Date(O.started_at||O.created_at),de=Math.floor((P.getTime()-F.getTime())/1e3),fe=O.duration_seconds||O.duration||0;if(Math.max(0,fe-de)<=0)return!1}return!0})()&&l.jsxDEV("div",{className:`absolute animate-in fade-in duration-500 ${(b?.timerMessage?b.timerMessage.enabled:d&&i||p&&p.enabled)?"bottom-20 right-1/3 transform translate-x-1/2 flex flex-col items-center":"inset-0 flex flex-col items-center justify-center"}`,style:{marginTop:(b?.timerMessage?b.timerMessage.enabled:d&&i||p&&p.enabled)?"0":"-80px"},children:[l.jsxDEV("div",{className:`absolute left-1/2 transform -translate-x-1/2 text-orange-400 font-bold animate-in slide-in-from-top duration-500 ${b?.timerMessage?b.timerMessage.enabled?"text-lg md:text-xl lg:text-2xl":"text-xl md:text-2xl lg:text-3xl":d&&i||p&&p.enabled?"text-lg md:text-xl lg:text-2xl":"text-xl md:text-2xl lg:text-3xl"} whitespace-nowrap ${(b?.timerMessage?b.timerMessage.enabled:d&&i||p&&p.enabled)?"bottom-20 left-1/2 transform -translate-x-1/2":""}`,style:{lineHeight:"1.2",...b?.timerMessage?b.timerMessage.enabled?{bottom:"calc(5rem - 25px)"}:{top:"calc(50% - 150px)"}:d&&i||p&&p.enabled?{bottom:"calc(5rem - 25px)"}:{top:"calc(50% - 150px)"}},children:(()=>{const O=b?.secondaryTimer||x;if(!O)return"";if(ne)return(O.cue_display||O.cue||O.cue_is||"").replace(/CUE(\d+)/,"CUE $1");{const P=O.cue||"";return P.includes("CUE")?P.replace(/CUE(\d+)/,"CUE $1"):`CUE ${P}`}})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:775,columnNumber:11},void 0),l.jsxDEV("div",{className:`text-orange-400 font-mono font-bold animate-in zoom-in duration-500 ${(()=>{const O=b?.secondaryTimer||x;if(!O)return"text-3xl md:text-4xl lg:text-5xl";let P=0;if(ne)if(O.is_running&&O.is_active){const de=new Date,fe=new Date(O.started_at||O.created_at),ge=Math.floor((de.getTime()-fe.getTime())/1e3),ze=O.duration_seconds||O.duration||0;P=Math.max(0,ze-ge)}else P=O.duration_seconds||O.duration||0;else P=O.remaining||0;const F=Math.floor(P/3600);if(b?.timerMessage){if(b.timerMessage.enabled)return"text-3xl md:text-4xl lg:text-5xl"}else if(d&&i||p&&p.enabled)return"text-3xl md:text-4xl lg:text-5xl";return F===0?"text-[15rem] md:text-[16.875rem] lg:text-[22.5rem]":"text-[12rem] md:text-[13.5rem] lg:text-[18rem]"})()}`,style:{lineHeight:"1"},children:(()=>{const O=b?.secondaryTimer||x;if(!O)return"00:00";let P=0;if(ne)if(O.is_running&&O.is_active){const ge=new Date,ze=new Date(O.started_at||O.created_at),oe=Math.floor((ge.getTime()-ze.getTime())/1e3),Tt=O.duration_seconds||O.duration||0;P=Math.max(0,Tt-oe)}else P=O.duration_seconds||O.duration||0;else P=O.remaining||0;const F=Math.floor(P/3600),de=Math.floor(P%3600/60),fe=P%60;return F===0?`${de.toString().padStart(2,"0")}:${fe.toString().padStart(2,"0")}`:`${F.toString().padStart(2,"0")}:${de.toString().padStart(2,"0")}:${fe.toString().padStart(2,"0")}`})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:813,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:761,columnNumber:9},void 0),(()=>{let O=!1;if(ne){const F=b?.secondaryTimer;if(F)if(F.is_running&&F.is_active){const de=new Date,fe=new Date(F.started_at||F.created_at),ge=Math.floor((de.getTime()-fe.getTime())/1e3),ze=F.duration_seconds||F.duration||0;O=Math.max(0,ze-ge)>0}else O=!0}else O=!!x;const P=ne?b?.timerMessage&&b.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled;return O&&P})()&&l.jsxDEV("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/3 transform -translate-x-1/2",children:[j()<0&&l.jsxDEV("div",{className:"mb-2",children:l.jsxDEV("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:933,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:932,columnNumber:13},void 0),l.jsxDEV("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:T()},children:Ee(j())},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:939,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:929,columnNumber:9},void 0),(()=>{let O=!1;if(ne){const F=b?.secondaryTimer;if(F)if(!F.is_running)O=!1;else if(F.is_running&&F.is_active){const de=new Date,fe=new Date(F.started_at||F.created_at),ge=Math.floor((de.getTime()-fe.getTime())/1e3),ze=F.duration_seconds||F.duration||0;O=Math.max(0,ze-ge)>0}else O=!0}else O=!!x;const P=ne?b?.timerMessage&&b.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled;return O&&P})()&&l.jsxDEV("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:l.jsxDEV("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:l.jsxDEV("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${Math.min(100,Math.max(0,j()/(e||1)*100))}%`,backgroundColor:T()}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:986,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:985,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:984,columnNumber:9},void 0),(()=>{let O=!1;if(ne){const F=b?.secondaryTimer;if(F)if(!F.is_running)O=!1;else if(F.is_running&&F.is_active){const de=new Date,fe=new Date(F.started_at||F.created_at),ge=Math.floor((de.getTime()-fe.getTime())/1e3),ze=F.duration_seconds||F.duration||0;O=Math.max(0,ze-ge)>0}else O=!0}else O=!!x;const P=ne?b?.timerMessage&&b.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled;return!O&&!P})()&&l.jsxDEV("div",{className:"flex-1 flex flex-col items-center justify-center",children:[j()<0&&l.jsxDEV("div",{className:"mb-[-50px]",children:l.jsxDEV("div",{className:"font-bold text-red-500 text-5xl",children:"OVER TIME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1037,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1036,columnNumber:13},void 0),l.jsxDEV("div",{className:"text-center",children:l.jsxDEV("div",{className:`font-mono font-bold ${(()=>{const O=j();return Math.floor(Math.abs(O)/3600)===0?"text-[15rem] md:text-[16.875rem] lg:text-[22.5rem]":"text-[12rem] md:text-[13.5rem] lg:text-[18rem]"})()}`,style:{color:T()},children:Ee(j())},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1045,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1044,columnNumber:11},void 0),l.jsxDEV("div",{className:"w-full max-w-5xl mt-0",children:l.jsxDEV("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-8",children:l.jsxDEV("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${X()}%`,background:T()}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1063,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1062,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1061,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1033,columnNumber:9},void 0),(()=>{let O=!1;if(ne){const F=b?.secondaryTimer;if(F)if(!F.is_running)O=!1;else if(F.is_running&&F.is_active){const de=new Date,fe=new Date(F.started_at||F.created_at),ge=Math.floor((de.getTime()-fe.getTime())/1e3),ze=F.duration_seconds||F.duration||0;O=Math.max(0,ze-ge)>0}else O=!0}else O=!!x;return(ne?b?.timerMessage&&b.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled)&&!O})()&&l.jsxDEV("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/2 transform -translate-x-1/2",children:[j()<0&&l.jsxDEV("div",{className:"mb-2",children:l.jsxDEV("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1115,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1114,columnNumber:13},void 0),l.jsxDEV("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:T()},children:Ee(j())},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1121,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1111,columnNumber:9},void 0),(()=>{let O=!1;if(ne){const F=b?.secondaryTimer;if(F)if(!F.is_running)O=!1;else if(F.is_running&&F.is_active){const de=new Date,fe=new Date(F.started_at||F.created_at),ge=Math.floor((de.getTime()-fe.getTime())/1e3),ze=F.duration_seconds||F.duration||0;O=Math.max(0,ze-ge)>0}else O=!0}else O=!!x;const P=ne?b?.timerMessage&&b.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled;return O&&!P})()&&l.jsxDEV("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/2 transform -translate-x-1/2",children:[j()<0&&l.jsxDEV("div",{className:"mb-2",children:l.jsxDEV("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1170,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1169,columnNumber:13},void 0),l.jsxDEV("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:T()},children:Ee(j())},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1176,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1166,columnNumber:9},void 0),(()=>{let O=!1;if(ne){const F=b?.secondaryTimer;if(F)if(!F.is_running)O=!1;else if(F.is_running&&F.is_active){const de=new Date,fe=new Date(F.started_at||F.created_at),ge=Math.floor((de.getTime()-fe.getTime())/1e3),ze=F.duration_seconds||F.duration||0;O=Math.max(0,ze-ge)>0}else O=!0}else O=!!x;return(ne?b?.timerMessage&&b.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled)&&!O})()&&l.jsxDEV("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:l.jsxDEV("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:l.jsxDEV("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${X()}%`,background:T()}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1223,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1222,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1221,columnNumber:9},void 0),(()=>{let O=!1;if(ne){const F=b?.secondaryTimer;if(F)if(!F.is_running)O=!1;else if(F.is_running&&F.is_active){const de=new Date,fe=new Date(F.started_at||F.created_at),ge=Math.floor((de.getTime()-fe.getTime())/1e3),ze=F.duration_seconds||F.duration||0;O=Math.max(0,ze-ge)>0}else O=!0}else O=!!x;const P=ne?b?.timerMessage&&b.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled;return O&&!P})()&&l.jsxDEV("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:l.jsxDEV("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:l.jsxDEV("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${X()}%`,background:T()}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1272,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1271,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:1270,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/FullScreenTimer.tsx",lineNumber:526,columnNumber:5},void 0)},l9=()=>{const t=Oa();fl();const n=t.state||{},[e,s]=I.useState(n.isRunning||!1),[i,d]=I.useState(n.elapsedTime||0),[c,f]=I.useState(n.totalDuration||0),[p,g]=I.useState(""),[x,b]=I.useState(!1),[E,w]=I.useState(null),[R,y]=I.useState(n.itemId||null),[U,q]=I.useState(n.eventId||null),[G,_]=I.useState(n.mainTimer||null),[ne,ee]=I.useState(n.secondaryTimer||null),[Q,z]=I.useState(null);I.useEffect(()=>{const S=A=>{switch(A.key){case"Escape":window.close();break;case" ":A.preventDefault(),s(!e);break;case"r":case"R":(A.ctrlKey||A.metaKey)&&(A.preventDefault(),d(0),s(!1));break;case"+":case"=":(A.ctrlKey||A.metaKey)&&A.preventDefault();break;case"-":(A.ctrlKey||A.metaKey)&&A.preventDefault();break}};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[e]);const ce=async()=>{if(U&&(x||E))try{const A=(await it.getTimerMessagesForEvent(U)).find(W=>W.enabled);A&&(await it.disableTimerMessage(A.id),console.log(" Message disabled in Supabase on close"))}catch(S){console.error(" Error clearing message on close:",S)}window.close()};return I.useEffect(()=>{if(!U)return;const S=async()=>{try{const W=await it.getTimerMessage(U);w(W),console.log(" Loaded timer message from API:",W)}catch(W){console.error(" Error loading timer message:",W)}};S();const A={onTimerMessageUpdated:W=>{console.log(" WebSocket: Timer message updated:",W),W&&W.event_id===U&&w(W)},onTimerUpdated:W=>{console.log(" FullScreenTimer: Timer updated via WebSocket from RunOfShowPage"),W&&W.event_id===U&&(z(H=>({...H,activeTimer:W})),console.log(" FullScreenTimer: Timer updated via WebSocket:",W))},onTimerStopped:W=>{console.log(" FullScreenTimer: Timer stopped via WebSocket from RunOfShowPage"),W&&W.event_id===U&&(z(H=>({...H,activeTimer:null})),console.log(" FullScreenTimer: Timer cleared via WebSocket"))},onTimersStopped:W=>{console.log(" FullScreenTimer: All timers stopped via WebSocket from RunOfShowPage"),W&&W.event_id===U&&(z(H=>({...H,activeTimer:null})),console.log(" FullScreenTimer: All timers cleared via WebSocket"))},onSubCueTimerStarted:W=>{console.log(" FullScreenTimer: Sub-cue timer started via WebSocket from RunOfShowPage"),W&&W.event_id===U&&(z(H=>({...H,secondaryTimer:W})),console.log(" FullScreenTimer: Sub-cue timer started via WebSocket:",W))},onSubCueTimerStopped:W=>{console.log(" FullScreenTimer: Sub-cue timer stopped via WebSocket from RunOfShowPage"),W&&W.event_id===U&&(z(H=>({...H,secondaryTimer:null})),console.log(" FullScreenTimer: Sub-cue timer stopped via WebSocket"))},onActiveTimersUpdated:W=>{console.log(" FullScreenTimer: Active timers updated via WebSocket from RunOfShowPage");let H=W;Array.isArray(W)&&W.length>0&&(H=W[0],console.log(" FullScreenTimer: Processing first timer from array:",H)),H&&H.event_id===U&&(H.timer_state==="stopped"||!H.is_active||H.is_running===!1&&H.is_active===!1?(z(K=>({...K,activeTimer:null})),console.log(" FullScreenTimer: Timer stopped via WebSocket - cleared timer data")):(z(K=>({...K,activeTimer:H})),console.log(" FullScreenTimer: Active timer updated via WebSocket:",H)))},onConnectionChange:W=>{console.log(" FullScreenTimer: WebSocket connection status:",W),W&&S()}};return _r.connect(U,A),()=>{console.log(" Cleaning up FullScreenTimer WebSocket connection"),_r.disconnect(U)}},[U]),I.useEffect(()=>{const S=A=>{if(A.data.type==="TIMER_UPDATE"){const{isRunning:W,elapsedTime:H,totalDuration:K,eventId:Oe,itemId:ye,mainTimer:Pe,secondaryTimer:ve}=A.data;W!==void 0&&s(W),H!==void 0&&d(H),K!==void 0&&f(K),Oe!==void 0&&q(Oe),ye!==void 0&&y(ye),Pe!==void 0&&_(Pe),ve!==void 0&&ee(ve)}else if(A.data.type==="MESSAGE_UPDATE"){const{message:W,enabled:H}=A.data;W!==void 0&&g(W),H!==void 0&&b(H)}};return window.addEventListener("message",S),()=>window.removeEventListener("message",S)},[]),l.jsxDEV(o9,{isRunning:e,elapsedTime:i,totalDuration:c,onClose:ce,message:p,messageEnabled:x,itemId:R,eventId:U,supabaseMessage:E,mainTimer:G,secondaryTimer:ne,hybridTimerData:Q},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/FullScreenTimerPage.tsx",lineNumber:235,columnNumber:5},void 0)},c9=({isRunning:t=!1,elapsedTime:n=0,totalDuration:e=0,onClose:s,message:i="",messageEnabled:d=!1,itemId:c,eventId:f,supabaseMessage:p=null,mainTimer:g=null,secondaryTimer:x=null})=>{const[b,E]=I.useState({elapsed:n,total:e}),[w,R]=I.useState(new Date),[y,U]=I.useState(!1),[q,G]=I.useState(!1),[_,ne]=I.useState(!0),[ee,Q]=I.useState({activeTimer:null}),[z,ce]=I.useState(0),[S,A]=I.useState(null),[W,H]=I.useState(null),[K,Oe]=I.useState(null),[ye,Pe]=I.useState(null),[ve,Ge]=I.useState(!1);I.useEffect(()=>{_||E({elapsed:n,total:e})},[n,e,_]),I.useEffect(()=>{if(_&&ee?.activeTimer?.is_running&&ee?.activeTimer?.is_active){const T=ee.activeTimer,O=new Date(T.started_at),P=T.duration_seconds||0,F=()=>{const ge=Math.floor((new Date().getTime()-O.getTime())/1e3);E({elapsed:ge,total:P})};F();const de=setInterval(F,1e3);return()=>clearInterval(de)}else if(_&&ee?.activeTimer&&!ee?.activeTimer?.is_running){const T=ee.activeTimer;E({elapsed:0,total:T.duration_seconds||0})}else _&&!ee?.activeTimer&&E({elapsed:0,total:0})},[ee?.activeTimer?.is_running,ee?.activeTimer?.is_active,ee?.activeTimer?.started_at,ee?.activeTimer?.duration_seconds,ee?.activeTimer,_]),I.useEffect(()=>{const T=setInterval(()=>{R(new Date)},1e3);return()=>clearInterval(T)},[]),I.useEffect(()=>{if(!t)return;const T=setInterval(()=>{E(O=>({...O,elapsed:O.elapsed+1}))},1e3);return()=>clearInterval(T)},[t]),I.useEffect(()=>{const T=()=>{U(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",T),()=>document.removeEventListener("fullscreenchange",T)},[]),I.useEffect(()=>{if(!_||!f){H(null),Oe(null),Pe(null);return}console.log(" Clock: Setting up WebSocket connection for eventId:",f);const T=async()=>{if(ve){console.log(" Already loading active timer, skipping...");return}try{Ge(!0),console.log(" Loading active timer from API...");const P=await it.getActiveTimer(f);P&&P.timer_state!=="stopped"&&P.is_active?(Q(F=>({...F,activeTimer:P})),console.log(" Active timer updated:",P)):(Q(F=>({...F,activeTimer:null})),console.log(" No active timer found or timer is stopped"));try{console.log(" Clock: Loading sub-cue timers and messages on initial load...");const F=await it.getActiveSubCueTimers(f);if(F&&F.data&&F.data.length>0){const fe=F.data.find(ge=>ge.timer_state==="running"||ge.is_running===!0);fe&&(Q(ge=>({...ge,secondaryTimer:fe})),console.log(" Clock: Initial load - sub-cue timer loaded:",fe))}const de=await it.getTimerMessage(f);de&&(Q(fe=>({...fe,timerMessage:de})),console.log(" Clock: Initial load - timer message loaded:",de))}catch(F){console.error(" Clock: Initial load failed to load sub-cue timers and messages:",F)}if(P&&P.timer_state!=="stopped"&&P.is_active&&_){const F=`${P.item_id}_${P.started_at}`,de=P.item_id;W&&W!==F&&(console.log(" Active timer changed - stopping secondary timer"),console.log(" Previous timer:",W),console.log(" New timer:",F),Q(ge=>({...ge,secondaryTimer:null}))),K&&K!==de&&(console.log(" New cue loaded - stopping secondary timer"),console.log(" Previous item_id:",K),console.log(" New item_id:",de),Q(ge=>({...ge,secondaryTimer:null})));const fe=P.started_at;ye&&ye!==fe&&(console.log(" Timer start time changed - restarting local timer"),console.log(" Previous start time:",ye),console.log(" New start time:",fe)),H(F),Oe(de),Pe(fe)}else!P&&W&&_&&(console.log(" Active timer stopped - stopping secondary timer and drift detection"),Q(F=>({...F,secondaryTimer:null})),H(null),Oe(null),Pe(null))}catch(P){console.error(" Error loading active timer:",P)}finally{Ge(!1)}};T();const O={onTimerUpdated:P=>{console.log(" Clock: WebSocket timer update received:",P),console.log(" Clock: Event ID check:",{received:P?.event_id,expected:f,match:P?.event_id===f}),P&&P.event_id===f?(Q(F=>({...F,activeTimer:P})),console.log(" Clock: Timer updated via WebSocket:",P)):console.log(" Clock: Timer update ignored - event ID mismatch or no data")},onActiveTimersUpdated:P=>{console.log(" Clock: WebSocket active timers update received:",P);let F=P;Array.isArray(P)&&P.length>0&&(F=P[0],console.log(" Clock: Processing first timer from array:",F)),console.log(" Clock: Event ID check:",{received:F?.event_id,expected:f,match:F?.event_id===f}),F&&F.event_id===f?F.timer_state==="stopped"||!F.is_active?(Q(de=>({...de,activeTimer:null})),console.log(" Clock: Timer stopped via WebSocket - cleared timer data")):(Q(de=>({...de,activeTimer:F})),console.log(" Clock: Active timer updated via WebSocket:",F)):console.log(" Clock: Active timers update ignored - event ID mismatch or no data")},onTimerStopped:P=>{console.log(" Clock: WebSocket timer stopped:",P),P&&P.event_id===f&&(Q(F=>({...F,activeTimer:null})),console.log(" Clock: Timer cleared via WebSocket"))},onTimersStopped:P=>{console.log(" Clock: WebSocket all timers stopped:",P),P&&P.event_id===f&&(Q(F=>({...F,activeTimer:null})),console.log(" Clock: All timers cleared via WebSocket"))},onSubCueTimerStarted:P=>{console.log(" Clock: WebSocket sub-cue timer started:",P),P&&P.event_id===f&&(Q(F=>({...F,secondaryTimer:P})),console.log(" Clock: Sub-cue timer started via WebSocket:",P))},onSubCueTimerStopped:P=>{console.log(" Clock: WebSocket sub-cue timer stopped:",P),P&&P.event_id===f&&(Q(F=>({...F,secondaryTimer:null})),console.log(" Clock: Sub-cue timer stopped via WebSocket"))},onTimerMessageUpdated:P=>{console.log(" Clock: WebSocket timer message updated:",P),P&&P.event_id===f&&(Q(F=>({...F,timerMessage:P})),console.log(" Clock: Timer message updated via WebSocket:",P))},onInitialSync:async()=>{console.log(" Clock: Performing initial sync for sub-cue timers and messages");try{const P=await it.getActiveSubCueTimers(f);if(P&&P.data&&P.data.length>0){const de=P.data.find(fe=>fe.timer_state==="running"||fe.is_running===!0);de&&(Q(fe=>({...fe,secondaryTimer:de})),console.log(" Clock: Initial sync - sub-cue timer loaded:",de))}const F=await it.getTimerMessage(f);F&&(Q(de=>({...de,timerMessage:F})),console.log(" Clock: Initial sync - timer message loaded:",F))}catch(P){console.error(" Clock: Initial sync failed to load sub-cue timers and messages:",P)}},onConnectionChange:P=>{console.log(" Clock: WebSocket connection status:",P),P&&T()}};return _r.connect(f,O),()=>{console.log(" Clock: Cleaning up WebSocket connection"),_r.disconnect(f)}},[f]),I.useEffect(()=>{if(!_||!ee?.secondaryTimer)return;const T=setInterval(()=>{ce(O=>O+1)},1e3);return()=>clearInterval(T)},[_,ee?.secondaryTimer]),I.useEffect(()=>{if(!_||!ee?.activeTimer)return;const T=ee.activeTimer,O=T.item_id;if(T.is_running&&T.is_active&&T.started_at){const P=new Date(T.started_at),F=T.duration_seconds;console.log(` Starting continuous local timer for ${O} with duration ${F}s, start time: ${P.toISOString()}`);const de=setInterval(()=>{const fe=new Date,ge=Math.floor((fe.getTime()-P.getTime())/1e3);E(ze=>({...ze,elapsed:ge,total:F})),ge<=10&&console.log(` Timer ${O}: Continuous elapsed=${ge}s, Start=${P.toISOString()}, Now=${fe.toISOString()}`)},1e3);return()=>{console.log(` Stopping continuous local timer for ${O}`),clearInterval(de)}}},[_,ye]);const ie=T=>{const O=T<0,P=Math.abs(T),F=Math.floor(P/3600),de=Math.floor(P%3600/60),fe=Math.floor(P%60),ge=O?"-":"";return F===0?`${ge}${de.toString().padStart(2,"0")}:${fe.toString().padStart(2,"0")}`:`${ge}${F.toString().padStart(2,"0")}:${de.toString().padStart(2,"0")}:${fe.toString().padStart(2,"0")}`},Ee=T=>T.toLocaleTimeString("en-US",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}),Ce=()=>{const T=b,O=T.total-T.elapsed;if(_&&ee?.activeTimer){const P=ee.activeTimer;if(!P.is_running||!P.is_active)return T.total}return O},j=()=>{const T=b,O=T.total-T.elapsed;if(_&&ee?.activeTimer){const P=ee.activeTimer;if(!P.is_running||!P.is_active)return 100}return T.total>0?O/T.total*100:0},X=()=>{const T=b,O=T.total-T.elapsed;if(_&&ee?.activeTimer){const P=ee.activeTimer;if(!P.is_running||!P.is_active)return"#6b7280"}return O>120?"#10b981":O>30?"#f59e0b":"#ef4444"};return l.jsxDEV("div",{className:"fixed inset-0 bg-black text-white overflow-hidden flex flex-col items-center justify-center",style:{padding:0,margin:0},children:[l.jsxDEV("div",{className:"absolute top-10 left-10 text-3xl font-mono text-white",children:[l.jsxDEV("div",{className:"text-slate-400 text-lg mb-1",children:"CURRENT TIME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:583,columnNumber:9},void 0),l.jsxDEV("div",{className:"text-white",children:Ee(w)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:584,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:582,columnNumber:7},void 0),l.jsxDEV("div",{className:"fixed top-10 right-10 text-3xl font-mono text-white z-50 w-80 text-right",children:[l.jsxDEV("div",{className:"text-slate-400 text-lg mb-1",children:"CURRENT CUE"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:591,columnNumber:9},void 0),l.jsxDEV("div",{className:"text-white flex items-center justify-end gap-3 whitespace-nowrap",children:[l.jsxDEV("span",{children:(()=>{if(_)if(ee?.activeTimer){const T=ee.activeTimer,O=ee?.lastLoadedCue,P=ee?.cueData;if(T.cue_is)return T.cue_is;if(P){console.log(" CUE data structure:",P),console.log(" CUE data fields:",Object.keys(P));const de=P.customFields?.cue||P.cue||P.cue_display||P.name||P.title;if(P.segmentName||P.segment_name||P.segment,de)return console.log(" Found CUE display:",de),de}const F=T.cue_display||T.cue;if(T.segment_name||T.segmentName,F)return F;if(O){const de=O.cue_display||O.cue;if(O.segment_name||O.segmentName,de)return de}return T.item_id?`CUE ${T.item_id.toString().slice(-4)}`:"No CUE"}else return"No Cue";else return"No CUE"})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:593,columnNumber:11},void 0),c&&l.jsxDEV(tk,{itemId:c,className:"flex-shrink-0"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:658,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:592,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:590,columnNumber:7},void 0),!y&&_&&ee?.activeTimer&&l.jsxDEV("div",{className:"absolute bottom-10 left-10 text-center",children:l.jsxDEV("div",{className:`text-lg font-bold px-4 py-2 rounded-lg ${ee.activeTimer.is_running&&ee.activeTimer.is_active?"bg-green-600 text-white":"bg-gray-600 text-white"}`,children:ee.activeTimer.is_running&&ee.activeTimer.is_active?" TIMER RUNNING":" TIMER LOADED"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:669,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:668,columnNumber:9},void 0),!y&&l.jsxDEV("div",{className:"absolute top-10 left-1/2 transform -translate-x-1/2 flex gap-3 z-50",children:[l.jsxDEV("button",{onClick:()=>{document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-bold text-lg transition-colors",children:"FULL SCREEN"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:685,columnNumber:9},void 0),!y&&l.jsxDEV("button",{className:"px-4 py-2 rounded-lg font-bold text-lg bg-purple-600 text-white cursor-default",disabled:!0,children:"WEBSOCKET ONLY"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:696,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:684,columnNumber:9},void 0),(()=>{if(_){const T=ee?.timerMessage||p;return T&&T.enabled}return d&&i||p&&p.enabled})()&&l.jsxDEV("div",{className:"absolute inset-0 flex items-center justify-center",style:{transform:"translateY(-40px)"},children:l.jsxDEV("div",{className:"font-bold text-white bg-black bg-opacity-50 rounded-lg border-4 border-white text-center flex items-center justify-center",style:{width:"80vw",minHeight:"50vh",maxHeight:"70vh",lineHeight:"1.2",whiteSpace:"pre-line",overflow:"visible",padding:"30px",display:"flex",alignItems:"center",justifyContent:"center",wordWrap:"break-word"},children:(()=>{const T=_?ee?.timerMessage?.message||p?.message||"":p?.message||i,O=T.split(" ");let P;if(O.length<=3)P=T;else if(O.length<=6){const fe=Math.ceil(O.length/2);P=O.slice(0,fe).join(" ")+`
`+O.slice(fe).join(" ")}else if(O.length<=10){const fe=Math.ceil(O.length/3);P=O.slice(0,fe).join(" ")+`
`+O.slice(fe,fe*2).join(" ")+`
`+O.slice(fe*2).join(" ")}else{const fe=Math.ceil(O.length/4);P=O.slice(0,fe).join(" ")+`
`+O.slice(fe,fe*2).join(" ")+`
`+O.slice(fe*2,fe*3).join(" ")+`
`+O.slice(fe*3).join(" ")}let F;const de=/[gjpqy]/.test(T.toLowerCase());return O.length<=3?F=de?"clamp(3rem, 12vw, 16rem)":"clamp(3.5rem, 13.5vw, 18rem)":O.length<=6?F=de?"clamp(1.9rem, 8vw, 12rem)":"clamp(2.25rem, 9vw, 13.5rem)":O.length<=10?F=de?"clamp(1.4rem, 6vw, 9rem)":"clamp(1.6rem, 7vw, 10.5rem)":F=de?"clamp(0.9rem, 4vw, 6rem)":"clamp(1.1rem, 5vw, 7rem)",l.jsxDEV("div",{style:{fontSize:F},children:P},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:787,columnNumber:17},void 0)})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:719,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:718,columnNumber:9},void 0),(()=>{if(_){const T=ee?.secondaryTimer;if(!T||ee?.timerMessage&&ee.timerMessage.enabled||p&&p.enabled)return!1;if(console.log(" Clock: Secondary timer data:",{is_running:T.is_running,is_active:T.is_active,remaining_seconds:T.remaining_seconds,duration_seconds:T.duration_seconds}),!T.is_running)return console.log(" Sub-cue timer not running - hiding"),!1;if(T.is_running&&T.is_active){const P=new Date,F=new Date(T.started_at||T.created_at),de=Math.floor((P.getTime()-F.getTime())/1e3),fe=T.duration_seconds||T.duration||0;if(Math.max(0,fe-de)<=0)return!1}return!0}else return!1})()&&l.jsxDEV("div",{className:`absolute animate-in fade-in duration-500 ${(_?p&&p.enabled:d&&i||p&&p.enabled)?"bottom-20 right-1/3 transform translate-x-1/2 flex flex-col items-center":"inset-0 flex flex-col items-center justify-center"}`,style:{marginTop:(_?p&&p.enabled:d&&i||p&&p.enabled)?"0":"-80px"},children:[l.jsxDEV("div",{className:`absolute left-1/2 transform -translate-x-1/2 text-orange-400 font-bold animate-in slide-in-from-top duration-500 ${_?p&&p.enabled?"text-lg md:text-xl lg:text-2xl":"text-xl md:text-2xl lg:text-3xl":d&&i||p&&p.enabled?"text-lg md:text-xl lg:text-2xl":"text-xl md:text-2xl lg:text-3xl"} whitespace-nowrap ${(_?p&&p.enabled:d&&i||p&&p.enabled)?"bottom-20 left-1/2 transform -translate-x-1/2":""}`,style:{lineHeight:"1.2",..._?p&&p.enabled?{bottom:"calc(5rem - 25px)"}:{top:"calc(50% - 150px)"}:d&&i||p&&p.enabled?{bottom:"calc(5rem - 25px)"}:{top:"calc(50% - 150px)"}},children:(()=>{const T=_?ee?.secondaryTimer:x;if(!T)return"";if(_){const O=T.cue_display||T.cue||T.cue_is||"",P=T.segment_name||T.segmentName||"",F=O.replace(/CUE(\d+)/,"CUE $1");return P?`${F} - ${P}`:F}else return"No CUE"})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:854,columnNumber:11},void 0),l.jsxDEV("div",{className:`text-orange-400 font-mono font-bold animate-in zoom-in duration-500 ${(()=>{const T=_?ee?.secondaryTimer:x;if(!T)return"text-3xl md:text-4xl lg:text-5xl";let O=0;if(_)if(T.is_running&&T.is_active){const F=new Date,de=new Date(T.started_at||T.created_at),fe=Math.floor((F.getTime()-de.getTime())/1e3),ge=T.duration_seconds||T.duration||0;O=Math.max(0,ge-fe)}else O=T.duration_seconds||T.duration||0;else O=T.remaining||0;const P=Math.floor(O/3600);if(_){const F=ee?.timerMessage||p;if(F&&F.enabled)return"text-3xl md:text-4xl lg:text-5xl"}else if(d&&i||p&&p.enabled)return"text-3xl md:text-4xl lg:text-5xl";return P===0?"text-[15rem] md:text-[16.875rem] lg:text-[22.5rem]":"text-[12rem] md:text-[13.5rem] lg:text-[18rem]"})()}`,style:{lineHeight:"1"},children:(()=>{const T=_?ee?.secondaryTimer:x;if(!T)return"00:00";let O=0;if(_)if(T.is_running&&T.is_active){const fe=new Date,ge=new Date(T.started_at||T.created_at),ze=Math.floor((fe.getTime()-ge.getTime())/1e3),oe=T.duration_seconds||T.duration||0;O=Math.max(0,oe-ze)}else O=T.duration_seconds||T.duration||0;else O=0;const P=Math.floor(O/3600),F=Math.floor(O%3600/60),de=O%60;return P===0?`${F.toString().padStart(2,"0")}:${de.toString().padStart(2,"0")}`:`${P.toString().padStart(2,"0")}:${F.toString().padStart(2,"0")}:${de.toString().padStart(2,"0")}`})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:894,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:838,columnNumber:9},void 0),(()=>{let T=!1;if(_){const P=ee?.secondaryTimer;if(P)if(P.is_running&&P.is_active){const F=new Date,de=new Date(P.started_at||P.created_at),fe=Math.floor((F.getTime()-de.getTime())/1e3),ge=P.duration_seconds||P.duration||0;T=Math.max(0,ge-fe)>0}else T=!0}else T=!!x;const O=_?ee?.timerMessage&&ee.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled;return T&&O})()&&l.jsxDEV("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-10",children:[Ce()<0&&l.jsxDEV("div",{className:"mb-2",children:l.jsxDEV("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1018,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1017,columnNumber:13},void 0),l.jsxDEV("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:X()},children:ie(Ce())},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1024,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1014,columnNumber:9},void 0),(()=>{let T=!1;if(_){const P=ee?.secondaryTimer;if(P)if(P.is_running&&P.is_active){const F=new Date,de=new Date(P.started_at||P.created_at),fe=Math.floor((F.getTime()-de.getTime())/1e3),ge=P.duration_seconds||P.duration||0;T=Math.max(0,ge-fe)>0}else T=!0}else T=!!x;const O=_?ee?.timerMessage&&ee.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled;return T&&O})()&&l.jsxDEV("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 right-10 text-orange-400",children:[l.jsxDEV("div",{className:"text-lg mb-2 font-bold",children:(()=>{const T=ee?.secondaryTimer,O=T.cue_display||T.cue||`CUE ${T.item_id}`,P=T.segment_name||T.segmentName||"Segment";return`${O} - ${P}`})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1066,columnNumber:11},void 0),l.jsxDEV("div",{className:"font-mono text-3xl font-bold",children:(()=>{const T=ee?.secondaryTimer,O=new Date,P=new Date(T.started_at||T.created_at),F=Math.floor((O.getTime()-P.getTime())/1e3),de=T.duration_seconds||T.duration||0,fe=Math.max(0,de-F),ge=Math.floor(fe/3600),ze=Math.floor(fe%3600/60),oe=fe%60;return ge>0?`${ge.toString().padStart(2,"0")}:${ze.toString().padStart(2,"0")}:${oe.toString().padStart(2,"0")}`:`${ze.toString().padStart(2,"0")}:${oe.toString().padStart(2,"0")}`})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1076,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1064,columnNumber:9},void 0),(()=>{let T=!1;if(_){const P=ee?.secondaryTimer;if(P)if(!P.is_running)T=!1;else if(P.is_running&&P.is_active){const F=new Date,de=new Date(P.started_at||P.created_at),fe=Math.floor((F.getTime()-de.getTime())/1e3),ge=P.duration_seconds||P.duration||0;T=Math.max(0,ge-fe)>0}else T=!0}else T=!!x;const O=_?ee?.timerMessage&&ee.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled;return T&&O})()&&l.jsxDEV("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:l.jsxDEV("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:l.jsxDEV("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${Math.min(100,Math.max(0,Ce()/(e||1)*100))}%`,backgroundColor:X()}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1137,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1136,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1135,columnNumber:9},void 0),(()=>{let T=!1;if(_){const P=ee?.secondaryTimer;if(P)if(!P.is_running)T=!1;else if(P.is_running&&P.is_active){const F=new Date,de=new Date(P.started_at||P.created_at),fe=Math.floor((F.getTime()-de.getTime())/1e3),ge=P.duration_seconds||P.duration||0;T=Math.max(0,ge-fe)>0}else T=!0}else T=!!x;const O=_?ee?.timerMessage&&ee.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled;return!T&&!O})()&&l.jsxDEV("div",{className:"flex-1 flex flex-col items-center justify-center",children:[Ce()<0&&l.jsxDEV("div",{className:"mb-[-50px]",children:l.jsxDEV("div",{className:"font-bold text-red-500 text-5xl",children:"OVER TIME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1188,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1187,columnNumber:13},void 0),l.jsxDEV("div",{className:"text-center",children:l.jsxDEV("div",{className:`font-mono font-bold ${(()=>{const T=Ce();return Math.floor(Math.abs(T)/3600)===0?"text-[15rem] md:text-[16.875rem] lg:text-[22.5rem]":"text-[12rem] md:text-[13.5rem] lg:text-[18rem]"})()}`,style:{color:X()},children:ie(Ce())},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1196,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1195,columnNumber:11},void 0),l.jsxDEV("div",{className:"w-full max-w-5xl mt-0",children:l.jsxDEV("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-8",children:l.jsxDEV("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${j()}%`,background:X()}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1214,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1213,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1212,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1184,columnNumber:9},void 0),(()=>{let T=!1;if(_){const P=ee?.secondaryTimer;if(P)if(!P.is_running)T=!1;else if(P.is_running&&P.is_active){const F=new Date,de=new Date(P.started_at||P.created_at),fe=Math.floor((F.getTime()-de.getTime())/1e3),ge=P.duration_seconds||P.duration||0;T=Math.max(0,ge-fe)>0}else T=!0}else T=!!x;return(_?ee?.timerMessage&&ee.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled)&&!T})()&&l.jsxDEV("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/2 transform -translate-x-1/2",children:[Ce()<0&&l.jsxDEV("div",{className:"mb-2",children:l.jsxDEV("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1266,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1265,columnNumber:13},void 0),l.jsxDEV("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:X()},children:ie(Ce())},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1272,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1262,columnNumber:9},void 0),(()=>{let T=!1;if(_){const P=ee?.secondaryTimer;if(P)if(!P.is_running)T=!1;else if(P.is_running&&P.is_active){const F=new Date,de=new Date(P.started_at||P.created_at),fe=Math.floor((F.getTime()-de.getTime())/1e3),ge=P.duration_seconds||P.duration||0;T=Math.max(0,ge-fe)>0}else T=!0}else T=!!x;const O=_?ee?.timerMessage&&ee.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled;return T&&!O})()&&l.jsxDEV("div",{className:"text-center transition-all duration-500 ease-in-out absolute bottom-20 left-1/2 transform -translate-x-1/2",children:[Ce()<0&&l.jsxDEV("div",{className:"mb-2",children:l.jsxDEV("div",{className:"font-bold text-red-500 text-lg md:text-xl lg:text-2xl",children:"OVER TIME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1321,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1320,columnNumber:13},void 0),l.jsxDEV("div",{className:"font-mono font-bold transition-all duration-500 ease-in-out text-3xl md:text-4xl lg:text-5xl",style:{color:X()},children:ie(Ce())},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1327,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1317,columnNumber:9},void 0),(()=>{let T=!1;if(_){const P=ee?.secondaryTimer;if(P)if(!P.is_running)T=!1;else if(P.is_running&&P.is_active){const F=new Date,de=new Date(P.started_at||P.created_at),fe=Math.floor((F.getTime()-de.getTime())/1e3),ge=P.duration_seconds||P.duration||0;T=Math.max(0,ge-fe)>0}else T=!0}else T=!!x;return(_?ee?.timerMessage&&ee.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled)&&!T})()&&l.jsxDEV("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:l.jsxDEV("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:l.jsxDEV("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${j()}%`,background:X()}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1374,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1373,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1372,columnNumber:9},void 0),(()=>{let T=!1;if(_){const P=ee?.secondaryTimer;if(P)if(!P.is_running)T=!1;else if(P.is_running&&P.is_active){const F=new Date,de=new Date(P.started_at||P.created_at),fe=Math.floor((F.getTime()-de.getTime())/1e3),ge=P.duration_seconds||P.duration||0;T=Math.max(0,ge-fe)>0}else T=!0}else T=!!x;const O=_?ee?.timerMessage&&ee.timerMessage.enabled||p&&p.enabled:d&&i||p&&p.enabled;return T&&!O})()&&l.jsxDEV("div",{className:"w-full transition-all duration-500 ease-in-out absolute bottom-8 left-1/2 transform -translate-x-1/2 max-w-2xl",children:l.jsxDEV("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border-3 border-slate-600 relative h-2",children:l.jsxDEV("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${j()}%`,background:X()}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1423,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1422,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:1421,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/components/Clock.tsx",lineNumber:579,columnNumber:5},void 0)},u9=()=>{const t=Oa();fl();const[n]=qf(),e=n.get("eventId"),s=t.state||{},[i,d]=I.useState(s.isRunning||!1),[c,f]=I.useState(s.elapsedTime||0),[p,g]=I.useState(s.totalDuration||0),[x,b]=I.useState(""),[E,w]=I.useState(!1),[R,y]=I.useState(null),[U,q]=I.useState(s.itemId||null),[G,_]=I.useState(e||s.eventId||null),[ne,ee]=I.useState(!0),[Q,z]=I.useState(s.mainTimer||null),[ce,S]=I.useState(s.secondaryTimer||null);I.useEffect(()=>{const W=H=>{switch(H.key){case"Escape":window.close();break;case" ":H.preventDefault(),d(!i);break;case"r":case"R":(H.ctrlKey||H.metaKey)&&(H.preventDefault(),f(0),d(!1));break;case"+":case"=":(H.ctrlKey||H.metaKey)&&H.preventDefault();break;case"-":(H.ctrlKey||H.metaKey)&&H.preventDefault();break}};return window.addEventListener("keydown",W),()=>window.removeEventListener("keydown",W)},[i]);const A=async()=>{if(G&&(E||R))try{const H=(await it.getTimerMessagesForEvent(G)).find(K=>K.enabled);H&&(await it.disableTimerMessage(H.id),console.log(" Message disabled in Supabase on close"))}catch(W){console.error(" Error clearing message on close:",W)}window.close()};return I.useEffect(()=>{if(!G)return;const W=async()=>{try{const K=await it.getTimerMessage(G);y(K),console.log(" Loaded timer message from API:",K)}catch(K){console.error(" Error loading timer message:",K)}};W();const H={onTimerMessageUpdated:K=>{console.log(" WebSocket: Timer message updated:",K),K&&K.event_id===G&&y(K)},onConnectionChange:K=>{console.log(" Clock: WebSocket connection status:",K),K&&W()}};return _r.connect(G,H),()=>{console.log(" Cleaning up Clock WebSocket connection"),_r.disconnect(G)}},[G]),I.useEffect(()=>{const W=H=>{if(H.data.type==="TIMER_UPDATE"){const{isRunning:K,elapsedTime:Oe,totalDuration:ye,eventId:Pe,itemId:ve,mainTimer:Ge,secondaryTimer:ie}=H.data;K!==void 0&&d(K),Oe!==void 0&&f(Oe),ye!==void 0&&g(ye),Pe!==void 0&&_(Pe),ve!==void 0&&q(ve),Ge!==void 0&&z(Ge),ie!==void 0&&S(ie)}else if(H.data.type==="MESSAGE_UPDATE"){const{message:K,enabled:Oe}=H.data;K!==void 0&&b(K),Oe!==void 0&&w(Oe)}};return window.addEventListener("message",W),()=>window.removeEventListener("message",W)},[]),l.jsxDEV(c9,{isRunning:i,elapsedTime:c,totalDuration:p,onClose:A,message:x,messageEnabled:E,itemId:U,eventId:G,supabaseMessage:R,mainTimer:Q,secondaryTimer:ce},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ClockPage.tsx",lineNumber:156,columnNumber:5},void 0)},d9=()=>{const[t]=qf(),n=t.get("eventId"),[e,s]=I.useState([]),[i,d]=I.useState(!0),[c,f]=I.useState(null),[p,g]=I.useState(null),[x,b]=I.useState("preview"),E=()=>window.location.hostname.includes("netlify.app")||window.location.hostname.includes("netlify.com")||window.location.hostname!=="localhost",w=()=>E()?`${window.location.origin}/.netlify/functions`:"http://localhost:3002/api",R=async S=>{try{await navigator.clipboard.writeText(S),console.log("Copied to clipboard:",S)}catch(A){console.error("Failed to copy to clipboard:",A);const W=document.createElement("textarea");W.value=S,document.body.appendChild(W),W.select(),document.execCommand("copy"),document.body.removeChild(W)}},[y,U]=I.useState(10),q=S=>{const A='<?xml version="1.0" encoding="UTF-8"?>',W=`
<data>
  <timestamp>${new Date().toISOString()}</timestamp>
  <event_id>${n||"unknown"}</event_id>
  <lower_thirds>
    ${S.map(H=>{const K=new Array(21).fill("");return H.speakers&&H.speakers.length>0&&H.speakers.forEach((Oe,ye)=>{if(ye<7){const Pe=ye*3;K[Pe]=Oe.title||"",K[Pe+1]=Oe.subtitle||"",K[Pe+2]=Oe.photo||""}}),`
    <item>
      <id>${H.id}</id>
      <row>${S.indexOf(H)+1}</row>
      <cue><![CDATA[${H.cue||""}]]></cue>
      <program><![CDATA[${H.program||""}]]></program>
      <segment_name><![CDATA[${H.segmentName||""}]]></segment_name>
      <speaker_1_name><![CDATA[${K[0]}]]></speaker_1_name>
      <speaker_1_title_org><![CDATA[${K[1]}]]></speaker_1_title_org>
      <speaker_1_photo><![CDATA[${K[2]}]]></speaker_1_photo>
      <speaker_2_name><![CDATA[${K[3]}]]></speaker_2_name>
      <speaker_2_title_org><![CDATA[${K[4]}]]></speaker_2_title_org>
      <speaker_2_photo><![CDATA[${K[5]}]]></speaker_2_photo>
      <speaker_3_name><![CDATA[${K[6]}]]></speaker_3_name>
      <speaker_3_title_org><![CDATA[${K[7]}]]></speaker_3_title_org>
      <speaker_3_photo><![CDATA[${K[8]}]]></speaker_3_photo>
      <speaker_4_name><![CDATA[${K[9]}]]></speaker_4_name>
      <speaker_4_title_org><![CDATA[${K[10]}]]></speaker_4_title_org>
      <speaker_4_photo><![CDATA[${K[11]}]]></speaker_4_photo>
      <speaker_5_name><![CDATA[${K[12]}]]></speaker_5_name>
      <speaker_5_title_org><![CDATA[${K[13]}]]></speaker_5_title_org>
      <speaker_5_photo><![CDATA[${K[14]}]]></speaker_5_photo>
      <speaker_6_name><![CDATA[${K[15]}]]></speaker_6_name>
      <speaker_6_title_org><![CDATA[${K[16]}]]></speaker_6_title_org>
      <speaker_6_photo><![CDATA[${K[17]}]]></speaker_6_photo>
      <speaker_7_name><![CDATA[${K[18]}]]></speaker_7_name>
      <speaker_7_title_org><![CDATA[${K[19]}]]></speaker_7_title_org>
      <speaker_7_photo><![CDATA[${K[20]}]]></speaker_7_photo>
    </item>`}).join("")}
  </lower_thirds>
</data>`;return A+W},G=async()=>{try{if(d(!0),f(null),!n)throw new Error("Event ID is required");console.log(" Fetching lower thirds data for event:",n);const S=await it.getRunOfShowData(n);if(!S||!S.schedule_items){s([]),g(new Date);return}const A=S.schedule_items,W=[];A.forEach((H,K)=>{const Oe={id:`${H.id}-row`,title:"",subtitle:"",is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),segmentName:H.segmentName||"",cue:H.customFields?.cue||"",program:H.programType||"",speakers:[]};if(H.speakersText&&H.speakersText.trim())try{const Pe=JSON.parse(H.speakersText).sort((ve,Ge)=>ve.slot-Ge.slot);Oe.speakers=Pe.map(ve=>({title:ve.fullName||"",subtitle:ve.title&&ve.org?`${ve.title}
${ve.org}`:ve.title||ve.org||"",photo:ve.photoLink||""}))}catch(ye){console.log("Error parsing speakers JSON for item:",H.id,ye)}W.push(Oe)}),s(W),g(new Date)}catch(S){console.error("Error fetching lower thirds:",S),f(S instanceof Error?S.message:"Unknown error occurred")}finally{d(!1)}};I.useEffect(()=>{if(!n){console.log(" No event ID, skipping WebSocket connection");return}console.log(" Setting up WebSocket connection for Lower Thirds XML page"),G();const S={onRunOfShowDataUpdated:A=>{if(console.log(" Lower Thirds XML: WebSocket data update received:",A),A&&A.schedule_items){const W=A.schedule_items,H=[];W.forEach((K,Oe)=>{const ye={id:`${K.id}-row`,title:"",subtitle:"",is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),segmentName:K.segmentName||"",cue:K.customFields?.cue||"",program:K.programType||"",speakers:[]};if(K.speakersText&&K.speakersText.trim())try{const ve=JSON.parse(K.speakersText).sort((Ge,ie)=>Ge.slot-ie.slot);ye.speakers=ve.map(Ge=>({title:Ge.fullName||"",subtitle:Ge.title&&Ge.org?`${Ge.title}
${Ge.org}`:Ge.title||Ge.org||"",photo:Ge.photoLink||""}))}catch(Pe){console.log("Error parsing speakers JSON for item:",K.id,Pe)}H.push(ye)}),s(H),g(new Date),console.log(" Lower Thirds XML: Data updated via WebSocket")}},onConnectionChange:A=>{console.log(" Lower Thirds XML: WebSocket connection status:",A),A&&G()}};return _r.connect(n,S),()=>{console.log(" Lower Thirds XML: Cleaning up WebSocket connection"),_r.disconnect(n)}},[n]);const _=()=>{G()},ne=()=>{const S=q(e),A=new Blob([S],{type:"application/xml"}),W=URL.createObjectURL(A),H=document.createElement("a");H.href=W,H.download=`lower_thirds_${n||"unknown"}_${Date.now()}.xml`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(W)},ee=()=>{const S=q(e);navigator.clipboard.writeText(S).then(()=>{alert("XML content copied to clipboard!")}).catch(A=>{console.error("Failed to copy to clipboard:",A),alert("Failed to copy to clipboard")})},Q=S=>{let A="Row,Cue,Program,Segment Name,";return A+="Speaker 1 Name,Speaker 1 Title/Org,Speaker 1 Photo,",A+="Speaker 2 Name,Speaker 2 Title/Org,Speaker 2 Photo,",A+="Speaker 3 Name,Speaker 3 Title/Org,Speaker 3 Photo,",A+="Speaker 4 Name,Speaker 4 Title/Org,Speaker 4 Photo,",A+="Speaker 5 Name,Speaker 5 Title/Org,Speaker 5 Photo,",A+="Speaker 6 Name,Speaker 6 Title/Org,Speaker 6 Photo,",A+=`Speaker 7 Name,Speaker 7 Title/Org,Speaker 7 Photo
`,S.forEach((W,H)=>{const K=H+1,Oe=W.cue||"",ye=W.program||"",Pe=W.segmentName||"",ve=new Array(21).fill("");W.speakers&&W.speakers.length>0&&W.speakers.forEach((ie,Ee)=>{if(Ee<7){const Ce=Ee*3;ve[Ce]=ie.title||"",ve[Ce+1]=ie.subtitle||"",ve[Ce+2]=ie.photo||""}});const Ge=[K,`"${Oe.replace(/"/g,'""')}"`,`"${ye.replace(/"/g,'""')}"`,`"${Pe.replace(/"/g,'""')}"`,`"${ve[0].replace(/"/g,'""')}"`,`"${ve[1].replace(/"/g,'""')}"`,`"${ve[2].replace(/"/g,'""')}"`,`"${ve[3].replace(/"/g,'""')}"`,`"${ve[4].replace(/"/g,'""')}"`,`"${ve[5].replace(/"/g,'""')}"`,`"${ve[6].replace(/"/g,'""')}"`,`"${ve[7].replace(/"/g,'""')}"`,`"${ve[8].replace(/"/g,'""')}"`,`"${ve[9].replace(/"/g,'""')}"`,`"${ve[10].replace(/"/g,'""')}"`,`"${ve[11].replace(/"/g,'""')}"`,`"${ve[12].replace(/"/g,'""')}"`,`"${ve[13].replace(/"/g,'""')}"`,`"${ve[14].replace(/"/g,'""')}"`,`"${ve[15].replace(/"/g,'""')}"`,`"${ve[16].replace(/"/g,'""')}"`,`"${ve[17].replace(/"/g,'""')}"`,`"${ve[18].replace(/"/g,'""')}"`,`"${ve[19].replace(/"/g,'""')}"`,`"${ve[20].replace(/"/g,'""')}"`].join(",");A+=Ge+`
`}),A},z=()=>{const S=Q(e),A=new Blob([S],{type:"text/csv"}),W=URL.createObjectURL(A),H=document.createElement("a");H.href=W,H.download=`lower_thirds_${n||"unknown"}_${Date.now()}.csv`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(W)},ce=()=>{const S=Q(e);navigator.clipboard.writeText(S).then(()=>{alert("CSV content copied to clipboard!")}).catch(A=>{console.error("Failed to copy to clipboard:",A),alert("Failed to copy to clipboard")})};return l.jsxDEV("div",{className:"min-h-screen bg-gray-900 text-white p-6",children:l.jsxDEV("div",{className:"max-w-6xl mx-auto",children:[l.jsxDEV("div",{className:"mb-8",children:[l.jsxDEV("h1",{className:"text-3xl font-bold mb-2",children:"Lower Thirds XML Feed"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:417,columnNumber:11},void 0),l.jsxDEV("p",{className:"text-gray-400",children:"Live XML data feed for VMIX integration with Supabase backend"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:418,columnNumber:11},void 0),n&&l.jsxDEV("p",{className:"text-sm text-blue-400 mt-2",children:["Event ID: ",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:422,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:416,columnNumber:9},void 0),l.jsxDEV("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:l.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxDEV("div",{className:"space-y-3",children:[l.jsxDEV("label",{className:"block text-sm font-medium",children:"Refresh Interval (seconds)"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:432,columnNumber:15},void 0),l.jsxDEV("select",{value:y,onChange:S=>U(Number(S.target.value)),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2",children:[l.jsxDEV("option",{value:5,children:"5 seconds"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:440,columnNumber:17},void 0),l.jsxDEV("option",{value:10,children:"10 seconds"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:441,columnNumber:17},void 0),l.jsxDEV("option",{value:30,children:"30 seconds"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:442,columnNumber:17},void 0),l.jsxDEV("option",{value:60,children:"1 minute"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:443,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:435,columnNumber:15},void 0),l.jsxDEV("button",{onClick:_,disabled:i,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 px-4 py-2 rounded font-medium",children:i?"Loading...":"Refresh Now"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:445,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:431,columnNumber:13},void 0),l.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxDEV("button",{onClick:ne,className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded font-medium",children:"Download XML"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:455,columnNumber:15},void 0),l.jsxDEV("button",{onClick:ee,className:"bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded font-medium",children:"Copy XML"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:461,columnNumber:15},void 0),l.jsxDEV("button",{onClick:z,className:"bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded font-medium",children:"Download CSV"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:467,columnNumber:15},void 0),l.jsxDEV("button",{onClick:ce,className:"bg-orange-600 hover:bg-orange-700 px-4 py-2 rounded font-medium",children:"Copy CSV"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:473,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:454,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:430,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:429,columnNumber:9},void 0),l.jsxDEV("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[l.jsxDEV("div",{className:"flex items-center justify-between",children:[l.jsxDEV("div",{className:"flex items-center gap-4",children:[l.jsxDEV("div",{className:`w-3 h-3 rounded-full ${i?"bg-yellow-500":c?"bg-red-500":"bg-green-500"}`},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:487,columnNumber:15},void 0),l.jsxDEV("span",{className:"font-medium",children:i?"Loading...":c?"Error":"Connected"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:488,columnNumber:15},void 0),p&&l.jsxDEV("span",{className:"text-sm text-gray-400",children:["Last updated: ",p.toLocaleTimeString()]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:492,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:486,columnNumber:13},void 0),l.jsxDEV("div",{className:"text-sm text-gray-400",children:["Auto-refresh: ",y,"s"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:497,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:485,columnNumber:11},void 0),c&&l.jsxDEV("div",{className:"mt-2 text-red-400 text-sm",children:c},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:502,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:484,columnNumber:9},void 0),l.jsxDEV("div",{className:"bg-gray-800 rounded-lg",children:[l.jsxDEV("div",{className:"flex border-b border-gray-600",children:[l.jsxDEV("button",{onClick:()=>b("preview"),className:`px-6 py-3 font-medium text-sm transition-colors ${x==="preview"?"text-blue-400 border-b-2 border-blue-400 bg-gray-700":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:" XML Preview"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:511,columnNumber:13},void 0),l.jsxDEV("button",{onClick:()=>b("instructions"),className:`px-6 py-3 font-medium text-sm transition-colors ${x==="instructions"?"text-blue-400 border-b-2 border-blue-400 bg-gray-700":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:" VMIX Instructions"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:521,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:510,columnNumber:11},void 0),l.jsxDEV("div",{className:"p-6",children:[x==="preview"&&l.jsxDEV("div",{children:[l.jsxDEV("h2",{className:"text-xl font-bold mb-4",children:"XML Preview"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:537,columnNumber:17},void 0),l.jsxDEV("div",{className:"bg-gray-900 rounded p-4 overflow-auto max-h-96",children:l.jsxDEV("pre",{className:"text-sm text-green-400 whitespace-pre-wrap",children:q(e)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:539,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:538,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:536,columnNumber:15},void 0),x==="instructions"&&l.jsxDEV("div",{children:[l.jsxDEV("h3",{className:"text-lg font-bold mb-4 text-blue-400",children:"VMIX Integration Instructions"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:548,columnNumber:17},void 0),l.jsxDEV("div",{className:"space-y-4 text-sm",children:[l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"font-semibold text-blue-300 mb-2",children:"1. XML Data Source URL:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:551,columnNumber:21},void 0),l.jsxDEV("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-green-400 break-all flex-1",children:[w(),"/lower-thirds.xml?eventId=",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:553,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>R(`${w()}/lower-thirds.xml?eventId=${n}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:556,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:552,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:550,columnNumber:19},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"font-semibold text-blue-300 mb-2",children:"2. CSV Data Source URL:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:565,columnNumber:21},void 0),l.jsxDEV("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-green-400 break-all flex-1",children:[w(),"/lower-thirds.csv?eventId=",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:567,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>R(`${w()}/lower-thirds.csv?eventId=${n}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:570,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:566,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:564,columnNumber:19},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"font-semibold text-blue-300 mb-2",children:"3. Alternative: Direct Links (Netlify Only):"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:579,columnNumber:21},void 0),l.jsxDEV("div",{className:"space-y-2",children:[l.jsxDEV("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-green-400 break-all flex-1",children:[window.location.origin,"/.netlify/functions/lower-thirds-xml?eventId=",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:582,columnNumber:25},void 0),l.jsxDEV("button",{onClick:()=>R(`${window.location.origin}/.netlify/functions/lower-thirds-xml?eventId=${n}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:585,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:581,columnNumber:23},void 0),l.jsxDEV("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-green-400 break-all flex-1",children:[window.location.origin,"/.netlify/functions/lower-thirds-csv?eventId=",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:593,columnNumber:25},void 0),l.jsxDEV("button",{onClick:()=>R(`${window.location.origin}/.netlify/functions/lower-thirds-csv?eventId=${n}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:596,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:592,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:580,columnNumber:21},void 0),l.jsxDEV("p",{className:"text-xs text-gray-400 mt-2",children:[" ",l.jsxDEV("strong",{children:"Tip:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:605,columnNumber:26},void 0)," These direct Netlify Function URLs work immediately without any server setup!"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:604,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:578,columnNumber:19},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"font-semibold text-blue-300 mb-2",children:"4. VMIX Setup:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:609,columnNumber:21},void 0),l.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-gray-300",children:[l.jsxDEV("li",{children:"Open VMIX and go to Data Sources"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:611,columnNumber:23},void 0),l.jsxDEV("li",{children:"Add a new Data Source"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:612,columnNumber:23},void 0),l.jsxDEV("li",{children:'Choose "XML" or "CSV" as the data type'},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:613,columnNumber:23},void 0),l.jsxDEV("li",{children:"Paste one of the URLs above"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:614,columnNumber:23},void 0),l.jsxDEV("li",{children:"Set refresh interval to 10 seconds"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:615,columnNumber:23},void 0),l.jsxDEV("li",{children:'Click "Add" to create the data source'},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:616,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:610,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:608,columnNumber:19},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"font-semibold text-blue-300 mb-2",children:"5. XPath for XML (if needed):"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:620,columnNumber:21},void 0),l.jsxDEV("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-green-400",children:"/data/lower_thirds/item"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:622,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>R("/data/lower_thirds/item"),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:623,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:621,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:619,columnNumber:19},void 0),l.jsxDEV("div",{className:"mt-4 p-3 bg-yellow-900/20 border border-yellow-500/30 rounded",children:l.jsxDEV("p",{className:"text-yellow-300 text-xs",children:[l.jsxDEV("strong",{children:"Environment:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:633,columnNumber:23},void 0)," ",E()?"Netlify (Production)":"Local Development"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:632,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:631,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:549,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:547,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:534,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:509,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:414,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/LowerThirdsXMLPage.tsx",lineNumber:413,columnNumber:5},void 0)},f9=()=>{const[t]=qf(),n=t.get("eventId"),[e,s]=I.useState(""),[i,d]=I.useState(""),[c,f]=I.useState(!0),[p,g]=I.useState(null),[x,b]=I.useState(null),[E,w]=I.useState("xml"),R="https://ros-50-production.up.railway.app/api",y=async _=>{try{await navigator.clipboard.writeText(_),alert("Copied to clipboard!")}catch(ne){console.error("Failed to copy:",ne)}},U=_=>{const ne='<?xml version="1.0" encoding="UTF-8"?>',ee=`
<data>
  <timestamp>${new Date().toISOString()}</timestamp>
  <event_id>${n||"unknown"}</event_id>
  <lower_thirds>
    ${_.map(Q=>{const z=new Array(21).fill("");return Q.speakers&&Q.speakers.length>0&&Q.speakers.forEach((ce,S)=>{if(S<7){const A=S*3;z[A]=ce.title||"",z[A+1]=ce.subtitle||"",z[A+2]=ce.photo||""}}),`
    <item>
      <id>${Q.id}</id>
      <cue><![CDATA[${Q.cue||""}]]></cue>
      <program><![CDATA[${Q.program||""}]]></program>
      <segment_name><![CDATA[${Q.segmentName||""}]]></segment_name>
      <speaker_1_name><![CDATA[${z[0]}]]></speaker_1_name>
      <speaker_1_title_org><![CDATA[${z[1]}]]></speaker_1_title_org>
      <speaker_1_photo><![CDATA[${z[2]}]]></speaker_1_photo>
      <speaker_2_name><![CDATA[${z[3]}]]></speaker_2_name>
      <speaker_2_title_org><![CDATA[${z[4]}]]></speaker_2_title_org>
      <speaker_2_photo><![CDATA[${z[5]}]]></speaker_2_photo>
      <speaker_3_name><![CDATA[${z[6]}]]></speaker_3_name>
      <speaker_3_title_org><![CDATA[${z[7]}]]></speaker_3_title_org>
      <speaker_3_photo><![CDATA[${z[8]}]]></speaker_3_photo>
      <speaker_4_name><![CDATA[${z[9]}]]></speaker_4_name>
      <speaker_4_title_org><![CDATA[${z[10]}]]></speaker_4_title_org>
      <speaker_4_photo><![CDATA[${z[11]}]]></speaker_4_photo>
      <speaker_5_name><![CDATA[${z[12]}]]></speaker_5_name>
      <speaker_5_title_org><![CDATA[${z[13]}]]></speaker_5_title_org>
      <speaker_5_photo><![CDATA[${z[14]}]]></speaker_5_photo>
      <speaker_6_name><![CDATA[${z[15]}]]></speaker_6_name>
      <speaker_6_title_org><![CDATA[${z[16]}]]></speaker_6_title_org>
      <speaker_6_photo><![CDATA[${z[17]}]]></speaker_6_photo>
      <speaker_7_name><![CDATA[${z[18]}]]></speaker_7_name>
      <speaker_7_title_org><![CDATA[${z[19]}]]></speaker_7_title_org>
      <speaker_7_photo><![CDATA[${z[20]}]]></speaker_7_photo>
    </item>`}).join("")}
  </lower_thirds>
</data>`;return ne+ee},q=_=>{let ne=`Row,Cue,Program,Segment Name,Speaker 1 Name,Speaker 1 Title/Org,Speaker 1 Photo,Speaker 2 Name,Speaker 2 Title/Org,Speaker 2 Photo,Speaker 3 Name,Speaker 3 Title/Org,Speaker 3 Photo,Speaker 4 Name,Speaker 4 Title/Org,Speaker 4 Photo,Speaker 5 Name,Speaker 5 Title/Org,Speaker 5 Photo,Speaker 6 Name,Speaker 6 Title/Org,Speaker 6 Photo,Speaker 7 Name,Speaker 7 Title/Org,Speaker 7 Photo
`;return _.forEach((ee,Q)=>{const z=new Array(21).fill("");ee.speakers&&ee.speakers.length>0&&ee.speakers.forEach((S,A)=>{if(A<7){const W=A*3;z[W]=S.title||"",z[W+1]=S.subtitle||"",z[W+2]=S.photo||""}});const ce=S=>`"${S.replace(/"/g,'""')}"`;ne+=`${Q+1},${ce(ee.cue||"")},${ce(ee.program||"")},${ce(ee.segmentName||"")}`;for(let S=0;S<21;S++)ne+=`,${ce(z[S])}`;ne+=`
`}),ne},G=async()=>{if(!n){g("Event ID is required"),f(!1);return}try{f(!0),g(null);const _=await fetch(`${R}/run-of-show-data/${n}`);if(!_.ok)throw new Error("Failed to fetch data from Railway");const ne=await _.json();if(!ne||!ne.schedule_items)throw new Error("No schedule items found");const ee=ne.schedule_items,Q=[];ee.forEach(z=>{const ce=[];if(z.speakersText)try{const S=typeof z.speakersText=="string"?JSON.parse(z.speakersText):z.speakersText;Array.isArray(S)&&S.forEach(A=>{ce.push({title:A.fullName||A.name||"",subtitle:[A.title,A.org].filter(Boolean).join(", "),photo:A.photoLink||""})})}catch(S){console.error("Error parsing speakers:",S)}Q.push({id:String(z.id),cue:z.customFields?.cue||"",program:z.programType||"",segmentName:z.segmentName||"",title:"",subtitle:"",is_active:!1,created_at:"",updated_at:"",speakers:ce})}),s(U(Q)),d(q(Q)),b(new Date),f(!1)}catch(_){console.error("Error fetching data:",_),g(_ instanceof Error?_.message:"Failed to fetch data"),f(!1)}};return I.useEffect(()=>{G();const _=setInterval(G,1e4);return()=>clearInterval(_)},[n]),n?l.jsxDEV("div",{className:"min-h-screen bg-gray-900 text-white p-8",children:l.jsxDEV("div",{className:"max-w-6xl mx-auto",children:[l.jsxDEV("div",{className:"mb-6",children:[l.jsxDEV("h1",{className:"text-3xl font-bold mb-2",children:" Lower Thirds - Netlify Edition"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:216,columnNumber:11},void 0),l.jsxDEV("p",{className:"text-gray-400",children:["Event ID: ",l.jsxDEV("span",{className:"text-blue-400",children:n},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:218,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:217,columnNumber:11},void 0),x&&l.jsxDEV("p",{className:"text-sm text-gray-500",children:["Last updated: ",x.toLocaleTimeString()]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:221,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:215,columnNumber:9},void 0),l.jsxDEV("div",{className:"flex space-x-2 mb-6",children:[l.jsxDEV("button",{onClick:()=>w("xml"),className:`px-4 py-2 rounded-t ${E==="xml"?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:"XML Preview"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:229,columnNumber:11},void 0),l.jsxDEV("button",{onClick:()=>w("csv"),className:`px-4 py-2 rounded-t ${E==="csv"?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:"CSV Preview"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:239,columnNumber:11},void 0),l.jsxDEV("button",{onClick:()=>w("instructions"),className:`px-4 py-2 rounded-t ${E==="instructions"?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:"VMIX Instructions"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:249,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:228,columnNumber:9},void 0),l.jsxDEV("div",{className:"bg-gray-800 rounded-lg p-6",children:[c&&l.jsxDEV("div",{className:"text-center py-8",children:[l.jsxDEV("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:265,columnNumber:15},void 0),l.jsxDEV("p",{className:"mt-4 text-gray-400",children:"Loading data..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:266,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:264,columnNumber:13},void 0),p&&l.jsxDEV("div",{className:"bg-red-900/50 border border-red-500 rounded p-4 mb-4",children:l.jsxDEV("p",{className:"text-red-200",children:[" Error: ",p]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:272,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:271,columnNumber:13},void 0),!c&&!p&&l.jsxDEV(l.Fragment,{children:[E==="xml"&&l.jsxDEV("div",{children:[l.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[l.jsxDEV("h2",{className:"text-xl font-semibold",children:"XML Data"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:281,columnNumber:21},void 0),l.jsxDEV("button",{onClick:()=>y(e),className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded transition-colors",children:"Copy XML"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:282,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:280,columnNumber:19},void 0),l.jsxDEV("pre",{className:"bg-gray-900 p-4 rounded overflow-auto max-h-96 text-sm",children:l.jsxDEV("code",{className:"text-green-400",children:e},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:290,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:289,columnNumber:19},void 0),l.jsxDEV("p",{className:"mt-2 text-sm text-gray-400",children:["Data length: ",e.length," characters"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:292,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:279,columnNumber:17},void 0),E==="csv"&&l.jsxDEV("div",{children:[l.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[l.jsxDEV("h2",{className:"text-xl font-semibold",children:"CSV Data"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:301,columnNumber:21},void 0),l.jsxDEV("button",{onClick:()=>y(i),className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded transition-colors",children:"Copy CSV"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:302,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:300,columnNumber:19},void 0),l.jsxDEV("pre",{className:"bg-gray-900 p-4 rounded overflow-auto max-h-96 text-sm",children:l.jsxDEV("code",{className:"text-green-400",children:i},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:310,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:309,columnNumber:19},void 0),l.jsxDEV("p",{className:"mt-2 text-sm text-gray-400",children:["Data length: ",i.length," characters"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:312,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:299,columnNumber:17},void 0),E==="instructions"&&l.jsxDEV("div",{className:"space-y-6",children:[l.jsxDEV("div",{children:[l.jsxDEV("h2",{className:"text-2xl font-bold mb-4 text-blue-300",children:" VMIX Integration Instructions"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:321,columnNumber:21},void 0),l.jsxDEV("p",{className:"text-gray-300 mb-4",children:"Use these URLs in VMIX to display live lower thirds data from Railway API."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:324,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:320,columnNumber:19},void 0),l.jsxDEV("div",{className:"space-y-4",children:[l.jsxDEV("div",{className:"bg-green-900/30 border border-green-500/50 rounded p-4 mb-4",children:[l.jsxDEV("h3",{className:"font-semibold text-green-300 mb-2",children:" Best for VMIX - Low Egress Static Pages:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:331,columnNumber:23},void 0),l.jsxDEV("p",{className:"text-sm text-gray-300",children:"Use these static HTML pages for VMIX. They use WebSocket for updates (low egress) and are hosted on Netlify (free bandwidth)!"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:332,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:330,columnNumber:21},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h3",{className:"font-semibold text-purple-300 mb-2",children:" VMIX XML URL (Low Egress - RECOMMENDED):"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:338,columnNumber:13},void 0),l.jsxDEV("div",{className:"bg-gray-900 p-3 rounded border border-purple-500 flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-purple-400 break-all flex-1 text-sm",children:[window.location.origin,"/vmix-data-endpoint.html?eventId=",n,"&format=xml"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:340,columnNumber:15},void 0),l.jsxDEV("button",{onClick:()=>y(`${window.location.origin}/vmix-data-endpoint.html?eventId=${n}&format=xml`),className:"ml-2 px-3 py-1 bg-purple-600 hover:bg-purple-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:343,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:339,columnNumber:13},void 0),l.jsxDEV("p",{className:"text-xs text-green-400 mt-1",children:" BEST OPTION: Pure XML output  Netlify bandwidth  Low Railway egress"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:350,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:337,columnNumber:11},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h3",{className:"font-semibold text-purple-300 mb-2",children:" VMIX CSV URL (Low Egress - RECOMMENDED):"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:356,columnNumber:13},void 0),l.jsxDEV("div",{className:"bg-gray-900 p-3 rounded border border-purple-500 flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-purple-400 break-all flex-1 text-sm",children:[window.location.origin,"/vmix-data-endpoint.html?eventId=",n,"&format=csv"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:358,columnNumber:15},void 0),l.jsxDEV("button",{onClick:()=>y(`${window.location.origin}/vmix-data-endpoint.html?eventId=${n}&format=csv`),className:"ml-2 px-3 py-1 bg-purple-600 hover:bg-purple-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:361,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:357,columnNumber:13},void 0),l.jsxDEV("p",{className:"text-xs text-green-400 mt-1",children:" BEST OPTION: Pure CSV output  Netlify bandwidth  Low Railway egress"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:368,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:355,columnNumber:11},void 0),l.jsxDEV("div",{className:"bg-yellow-900/30 border border-yellow-500/50 rounded p-4 mt-4",children:[l.jsxDEV("h3",{className:"font-semibold text-yellow-300 mb-2",children:" Alternative: Direct Railway API (Higher Egress)"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:374,columnNumber:23},void 0),l.jsxDEV("p",{className:"text-xs text-gray-400 mb-2",children:"These URLs work but use more Railway bandwidth. Only use if the static pages don't work."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:375,columnNumber:23},void 0),l.jsxDEV("div",{className:"space-y-3 mt-3",children:[l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"font-semibold text-blue-300 mb-2 text-sm",children:"XML Data Source URL (Railway):"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:381,columnNumber:27},void 0),l.jsxDEV("div",{className:"bg-gray-900 p-3 rounded border border-gray-700 flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-green-400 break-all flex-1 text-sm",children:[R,"/lower-thirds.xml?eventId=",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:383,columnNumber:25},void 0),l.jsxDEV("button",{onClick:()=>y(`${R}/lower-thirds.xml?eventId=${n}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:386,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:382,columnNumber:23},void 0),l.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:" Works from anywhere  Always online  Production ready"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:393,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:380,columnNumber:25},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h3",{className:"font-semibold text-blue-300 mb-2",children:"CSV Data Source URL (Railway):"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:399,columnNumber:23},void 0),l.jsxDEV("div",{className:"bg-gray-900 p-3 rounded border border-gray-700 flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-green-400 break-all flex-1 text-sm",children:[R,"/lower-thirds.csv?eventId=",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:401,columnNumber:25},void 0),l.jsxDEV("button",{onClick:()=>y(`${R}/lower-thirds.csv?eventId=${n}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:404,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:400,columnNumber:23},void 0),l.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"Higher egress cost"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:411,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:398,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:379,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:373,columnNumber:21},void 0),l.jsxDEV("div",{className:"bg-gray-700/50 border border-gray-600 rounded p-4 mt-4",children:[l.jsxDEV("h3",{className:"font-semibold text-gray-300 mb-2",children:"Alternative: Local Development"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:419,columnNumber:23},void 0),l.jsxDEV("div",{className:"space-y-2 text-sm",children:[l.jsxDEV("div",{children:[l.jsxDEV("p",{className:"text-gray-400 mb-1",children:"XML:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:422,columnNumber:27},void 0),l.jsxDEV("code",{className:"text-gray-500 text-xs",children:["http://localhost:3002/api/lower-thirds.xml?eventId=",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:423,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:421,columnNumber:25},void 0),l.jsxDEV("div",{children:[l.jsxDEV("p",{className:"text-gray-400 mb-1",children:"CSV:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:426,columnNumber:27},void 0),l.jsxDEV("code",{className:"text-gray-500 text-xs",children:["http://localhost:3002/api/lower-thirds.csv?eventId=",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:427,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:425,columnNumber:25},void 0),l.jsxDEV("p",{className:"text-xs text-gray-500 mt-2",children:"(Only works when local server is running)"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:429,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:420,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:418,columnNumber:21},void 0),l.jsxDEV("div",{className:"bg-blue-900/30 border border-blue-500/50 rounded p-4 mt-6",children:[l.jsxDEV("h3",{className:"font-semibold text-blue-300 mb-2",children:" How to use in VMIX:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:436,columnNumber:23},void 0),l.jsxDEV("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-300",children:[l.jsxDEV("li",{children:["Open VMIX and go to ",l.jsxDEV("strong",{children:"Settings  Data Sources"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:438,columnNumber:49},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:438,columnNumber:25},void 0),l.jsxDEV("li",{children:["Click ",l.jsxDEV("strong",{children:"Add"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:439,columnNumber:35},void 0)," to create a new data source"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:439,columnNumber:25},void 0),l.jsxDEV("li",{children:["Choose ",l.jsxDEV("strong",{children:"XML"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:440,columnNumber:36},void 0)," or ",l.jsxDEV("strong",{children:"CSV"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:440,columnNumber:60},void 0)," as the type"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:440,columnNumber:25},void 0),l.jsxDEV("li",{children:"Paste one of the URLs above"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:441,columnNumber:25},void 0),l.jsxDEV("li",{children:["Set refresh interval to ",l.jsxDEV("strong",{children:"10 seconds"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:442,columnNumber:53},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:442,columnNumber:25},void 0),l.jsxDEV("li",{children:["Click ",l.jsxDEV("strong",{children:"OK"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:443,columnNumber:35},void 0)," to save"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:443,columnNumber:25},void 0),l.jsxDEV("li",{children:"Use the data fields in your VMIX titles/overlays"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:444,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:437,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:435,columnNumber:21},void 0),l.jsxDEV("div",{className:"bg-green-900/30 border border-green-500/50 rounded p-4",children:[l.jsxDEV("h3",{className:"font-semibold text-green-300 mb-2",children:" Benefits of Railway API:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:449,columnNumber:23},void 0),l.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-300",children:[l.jsxDEV("li",{children:"Always running (not serverless)"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:451,columnNumber:25},void 0),l.jsxDEV("li",{children:"Reliable and fast"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:452,columnNumber:25},void 0),l.jsxDEV("li",{children:"Direct database connection"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:453,columnNumber:25},void 0),l.jsxDEV("li",{children:"Real-time updates"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:454,columnNumber:25},void 0),l.jsxDEV("li",{children:"Works from anywhere (not just localhost)"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:455,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:450,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:448,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:329,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:319,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:277,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:262,columnNumber:9},void 0),l.jsxDEV("div",{className:"mt-6 text-center",children:[l.jsxDEV("button",{onClick:G,disabled:c,className:"px-6 py-3 bg-green-600 hover:bg-green-500 disabled:bg-gray-600 text-white rounded-lg transition-colors",children:c?"Refreshing...":" Refresh Data"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:467,columnNumber:11},void 0),l.jsxDEV("p",{className:"mt-2 text-sm text-gray-500",children:"Data auto-refreshes every 10 seconds"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:474,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:466,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:213,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:212,columnNumber:5},void 0):l.jsxDEV("div",{className:"min-h-screen bg-gray-900 text-white p-8",children:l.jsxDEV("div",{className:"max-w-4xl mx-auto",children:[l.jsxDEV("h1",{className:"text-3xl font-bold mb-4",children:" Event ID Required"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:203,columnNumber:11},void 0),l.jsxDEV("p",{children:"Please provide an eventId parameter in the URL."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:204,columnNumber:11},void 0),l.jsxDEV("p",{className:"mt-2 text-gray-400",children:"Example: ?eventId=your-event-id"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:205,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:202,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/NetlifyLowerThirdsXMLPage.tsx",lineNumber:201,columnNumber:7},void 0)},m9=()=>{const[t]=qf(),n=t.get("eventId"),[e,s]=I.useState([]),[i,d]=I.useState(!0),[c,f]=I.useState(null),[p,g]=I.useState(null),[x,b]=I.useState("preview"),E=(z,ce,S)=>{if(!S)return"";try{const A=z.indexOf(ce);if(ce.isIndented)return"";let W=0;for(let ie=0;ie<A;ie++){const Ee=z[ie];Ee.isIndented||(W+=Ee.durationHours*3600+Ee.durationMinutes*60+Ee.durationSeconds)}const[H,K]=S.split(":").map(Number),ye=H*3600+K*60+W,Pe=ye/3600%24,ve=ye%3600/60,Ge=new Date;return Ge.setHours(Pe,ve,0,0),Ge.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return""}},w=()=>window.location.hostname.includes("netlify.app")||window.location.hostname.includes("netlify.com")||window.location.hostname!=="localhost",R=()=>w()?`${window.location.origin}/.netlify/functions`:"http://localhost:3002/api",y=async z=>{try{await navigator.clipboard.writeText(z),console.log("Copied to clipboard:",z)}catch(ce){console.error("Failed to copy to clipboard:",ce);const S=document.createElement("textarea");S.value=z,document.body.appendChild(S),S.select(),document.execCommand("copy"),document.body.removeChild(S)}},U=async()=>{try{if(d(!0),f(null),!n)throw new Error("Event ID is required");console.log(" Fetching schedule data for event:",n);const z=await it.getRunOfShowData(n);if(!z||!z.schedule_items){s([]),g(new Date);return}const ce=[],S=z.schedule_items,A=z.settings?.masterStartTime||"";S.filter(H=>H.isPublic).forEach((H,K)=>{const Oe=E(S,H,A),ye={id:`${H.id}-schedule`,title:H.segmentName||"Untitled Segment",subtitle:"",is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),segmentName:H.segmentName||"Untitled Segment",startTime:Oe||"No Start Time",speakers:[]};ce.push(ye)}),s(ce),g(new Date)}catch(z){console.error("Error fetching schedule data:",z),f(z instanceof Error?z.message:"Unknown error occurred")}finally{d(!1)}};I.useEffect(()=>{if(!n){console.log(" No event ID, skipping WebSocket connection");return}console.log(" Setting up WebSocket connection for Schedule XML page"),U();const z={onRunOfShowDataUpdated:ce=>{if(console.log(" Schedule XML: WebSocket data update received:",ce),ce&&ce.schedule_items){const S=[],A=ce.schedule_items,W=ce.settings?.masterStartTime||"";A.filter(K=>K.isPublic).forEach((K,Oe)=>{const ye=E(A,K,W),Pe={id:`${K.id}-schedule`,title:K.segmentName||"Untitled Segment",subtitle:"",is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),segmentName:K.segmentName||"Untitled Segment",startTime:ye||"No Start Time",speakers:[]};S.push(Pe)}),s(S),g(new Date),console.log(" Schedule XML: Data updated via WebSocket")}},onConnectionChange:ce=>{console.log(" Schedule XML: WebSocket connection status:",ce),ce&&U()}};return _r.connect(n,z),()=>{console.log(" Schedule XML: Cleaning up WebSocket connection"),_r.disconnect(n)}},[n]);const q=z=>{const ce='<?xml version="1.0" encoding="UTF-8"?>',S=`
<data>
  <timestamp>${new Date().toISOString()}</timestamp>
  <event_id>${n||"unknown"}</event_id>
  <schedule>
    ${z.map(A=>`
    <item>
      <id>${A.id}</id>
      <row>${z.indexOf(A)+1}</row>
      <segment_name><![CDATA[${A.segmentName||""}]]></segment_name>
      <start_time><![CDATA[${A.startTime||""}]]></start_time>
    </item>`).join("")}
  </schedule>
</data>`;return ce+S},G=z=>{let ce=`Segment Name,Start Time
`;return z.forEach(S=>{const A=S.segmentName||"",W=S.startTime||"",H=[`"${A.replace(/"/g,'""')}"`,`"${W.replace(/"/g,'""')}"`].join(",");ce+=H+`
`}),ce},_=()=>{const z=q(e),ce=new Blob([z],{type:"application/xml"}),S=URL.createObjectURL(ce),A=document.createElement("a");A.href=S,A.download=`schedule-${n||"data"}.xml`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(S)},ne=()=>{const z=G(e),ce=new Blob([z],{type:"text/csv"}),S=URL.createObjectURL(ce),A=document.createElement("a");A.href=S,A.download=`schedule-${n||"data"}.csv`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(S)},ee=()=>{const z=q(e);y(z)},Q=()=>{const z=G(e);y(z)};return i?l.jsxDEV("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:l.jsxDEV("div",{className:"text-center",children:[l.jsxDEV("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:312,columnNumber:11},void 0),l.jsxDEV("p",{className:"text-gray-400",children:"Loading schedule data..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:313,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:311,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:310,columnNumber:7},void 0):l.jsxDEV("div",{className:"min-h-screen bg-gray-900 text-white",children:l.jsxDEV("div",{className:"container mx-auto px-4 py-8",children:l.jsxDEV("div",{className:"max-w-6xl mx-auto",children:[l.jsxDEV("div",{className:"mb-8",children:[l.jsxDEV("h1",{className:"text-3xl font-bold mb-2",children:"Schedule XML Feed"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:324,columnNumber:13},void 0),l.jsxDEV("p",{className:"text-gray-400",children:["Live schedule data for VMIX integration",n&&l.jsxDEV("span",{className:"ml-2 text-blue-400",children:["(Event: ",n.slice(0,8),"...)"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:328,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:325,columnNumber:13},void 0),p&&l.jsxDEV("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",p.toLocaleTimeString()]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:334,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:323,columnNumber:11},void 0),c&&l.jsxDEV("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-500/30 rounded-lg",children:l.jsxDEV("p",{className:"text-red-400",children:c},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:342,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:341,columnNumber:13},void 0),l.jsxDEV("div",{className:"mb-8 flex flex-wrap gap-4",children:[l.jsxDEV("button",{onClick:_,className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:" Download XML"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:350,columnNumber:13},void 0),l.jsxDEV("button",{onClick:ee,className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:" Copy XML"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:356,columnNumber:13},void 0),l.jsxDEV("button",{onClick:ne,className:"px-4 py-2 bg-purple-600 hover:bg-purple-500 text-white rounded-lg transition-colors",children:" Download CSV"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:362,columnNumber:13},void 0),l.jsxDEV("button",{onClick:Q,className:"px-4 py-2 bg-orange-600 hover:bg-orange-500 text-white rounded-lg transition-colors",children:" Copy CSV"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:368,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:349,columnNumber:11},void 0),l.jsxDEV("div",{className:"bg-gray-800 rounded-lg",children:[l.jsxDEV("div",{className:"flex border-b border-gray-600",children:[l.jsxDEV("button",{onClick:()=>b("preview"),className:`px-6 py-3 font-medium text-sm transition-colors ${x==="preview"?"text-blue-400 border-b-2 border-blue-400 bg-gray-700":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:" XML Preview"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:379,columnNumber:15},void 0),l.jsxDEV("button",{onClick:()=>b("instructions"),className:`px-6 py-3 font-medium text-sm transition-colors ${x==="instructions"?"text-blue-400 border-b-2 border-blue-400 bg-gray-700":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:" VMIX Instructions"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:389,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:378,columnNumber:13},void 0),l.jsxDEV("div",{className:"p-6",children:[x==="preview"&&l.jsxDEV("div",{children:[l.jsxDEV("h2",{className:"text-xl font-bold mb-4",children:"XML Preview"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:405,columnNumber:19},void 0),l.jsxDEV("div",{className:"bg-gray-900 rounded p-4 overflow-auto max-h-96",children:l.jsxDEV("pre",{className:"text-sm text-green-400 whitespace-pre-wrap",children:q(e)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:407,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:406,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:404,columnNumber:17},void 0),x==="instructions"&&l.jsxDEV("div",{children:[l.jsxDEV("h3",{className:"text-lg font-bold mb-4 text-blue-400",children:"VMIX Integration Instructions"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:416,columnNumber:19},void 0),l.jsxDEV("div",{className:"space-y-4 text-sm",children:[l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"font-semibold text-blue-300 mb-2",children:"1. XML Data Source URL:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:419,columnNumber:23},void 0),l.jsxDEV("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-green-400 break-all flex-1",children:[R(),"/schedule.xml?eventId=",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:421,columnNumber:25},void 0),l.jsxDEV("button",{onClick:()=>y(`${R()}/schedule.xml?eventId=${n}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:424,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:420,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:418,columnNumber:21},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"font-semibold text-blue-300 mb-2",children:"2. CSV Data Source URL:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:433,columnNumber:23},void 0),l.jsxDEV("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-green-400 break-all flex-1",children:[R(),"/schedule.csv?eventId=",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:435,columnNumber:25},void 0),l.jsxDEV("button",{onClick:()=>y(`${R()}/schedule.csv?eventId=${n}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:438,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:434,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:432,columnNumber:21},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"font-semibold text-blue-300 mb-2",children:"3. Alternative: Direct Links (Netlify Only):"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:447,columnNumber:23},void 0),l.jsxDEV("div",{className:"space-y-2",children:[l.jsxDEV("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-green-400 break-all flex-1",children:[window.location.origin,"/.netlify/functions/schedule-xml?eventId=",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:450,columnNumber:27},void 0),l.jsxDEV("button",{onClick:()=>y(`${window.location.origin}/.netlify/functions/schedule-xml?eventId=${n}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:453,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:449,columnNumber:25},void 0),l.jsxDEV("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-green-400 break-all flex-1",children:[window.location.origin,"/.netlify/functions/schedule-csv?eventId=",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:461,columnNumber:27},void 0),l.jsxDEV("button",{onClick:()=>y(`${window.location.origin}/.netlify/functions/schedule-csv?eventId=${n}`),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:464,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:460,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:448,columnNumber:23},void 0),l.jsxDEV("p",{className:"text-xs text-gray-400 mt-2",children:[" ",l.jsxDEV("strong",{children:"Tip:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:473,columnNumber:28},void 0)," These direct Netlify Function URLs work immediately without any server setup!"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:472,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:446,columnNumber:21},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"font-semibold text-blue-300 mb-2",children:"4. VMIX Setup:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:477,columnNumber:23},void 0),l.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-gray-300",children:[l.jsxDEV("li",{children:"Open VMIX and go to Data Sources"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:479,columnNumber:25},void 0),l.jsxDEV("li",{children:"Add a new Data Source"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:480,columnNumber:25},void 0),l.jsxDEV("li",{children:'Choose "XML" or "CSV" as the data type'},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:481,columnNumber:25},void 0),l.jsxDEV("li",{children:"Paste the URL above"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:482,columnNumber:25},void 0),l.jsxDEV("li",{children:"Set refresh interval to 10 seconds"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:483,columnNumber:25},void 0),l.jsxDEV("li",{children:'Click "Add" to create the data source'},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:484,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:478,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:476,columnNumber:21},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"font-semibold text-blue-300 mb-2",children:"4. XPath for XML (if needed):"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:488,columnNumber:23},void 0),l.jsxDEV("div",{className:"bg-gray-800 p-3 rounded border flex items-center justify-between",children:[l.jsxDEV("code",{className:"text-green-400",children:"/data/schedule/item"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:490,columnNumber:25},void 0),l.jsxDEV("button",{onClick:()=>y("/data/schedule/item"),className:"ml-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-xs rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:491,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:489,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:487,columnNumber:21},void 0),l.jsxDEV("div",{className:"mt-4 p-3 bg-yellow-900/20 border border-yellow-500/30 rounded",children:l.jsxDEV("p",{className:"text-yellow-300 text-xs",children:[l.jsxDEV("strong",{children:"Environment:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:501,columnNumber:25},void 0)," ",w()?"Netlify (Production)":"Local Development"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:500,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:499,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:417,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:415,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:402,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:377,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:322,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:321,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ScheduleXMLPage.tsx",lineNumber:320,columnNumber:5},void 0)},rk=()=>window.location.hostname.includes("netlify.app")||window.location.hostname.includes("netlify.com")||window.location.hostname!=="localhost",Sh=()=>rk()?`${window.location.origin}/.netlify/functions`:"http://localhost:3002/api",pu=async t=>{try{await navigator.clipboard.writeText(t),console.log("Copied to clipboard:",t)}catch(n){console.error("Failed to copy to clipboard:",n);const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}},h9=()=>{const[t]=qf(),n=t.get("eventId"),[e,s]=I.useState([]),[i,d]=I.useState(!0),[c,f]=I.useState(null),[p,g]=I.useState(null),[x,b]=I.useState("preview"),E=async()=>{try{if(d(!0),f(null),!n)throw new Error("Event ID is required");console.log(" Fetching custom columns data for event:",n);const _=await it.getRunOfShowData(n);if(!_||!_.schedule_items){s([]),g(new Date);return}const ne=_.schedule_items,ee=_.custom_columns||[],Q=[],z=ne.filter(S=>S.isPublic),ce=ee.filter(S=>S.name).map(S=>S.name);z.forEach((S,A)=>{const W={id:`${S.id}-custom`,row:A+1,cue:S.customFields?.cue||"CUE##",customFields:S.customFields||{}};Q.push(W)}),s(Q),g(new Date)}catch(_){console.error("Error fetching custom columns:",_),f(_ instanceof Error?_.message:"Unknown error occurred")}finally{d(!1)}};I.useEffect(()=>{if(!n){console.log(" No event ID, skipping WebSocket connection");return}console.log(" Setting up WebSocket connection for Custom Columns XML page"),E();const _={onRunOfShowDataUpdated:ne=>{if(console.log(" Custom Columns XML: WebSocket data update received:",ne),ne&&ne.schedule_items){const ee=ne.schedule_items,Q=ne.custom_columns||[],z=[],ce=ee.filter(S=>S.isPublic);Q.filter(S=>S.name).map(S=>S.name),ce.forEach((S,A)=>{const W={id:`${S.id}-custom`,row:A+1,cue:S.customFields?.cue||"CUE##",customFields:S.customFields||{}};z.push(W)}),s(z),g(new Date),console.log(" Custom Columns XML: Data updated via WebSocket")}},onConnectionChange:ne=>{console.log(" Custom Columns XML: WebSocket connection status:",ne),ne&&E()}};return _r.connect(n,_),()=>{console.log(" Custom Columns XML: Cleaning up WebSocket connection"),_r.disconnect(n)}},[n]);const w=_=>{const ne='<?xml version="1.0" encoding="UTF-8"?>',ee=`
<data>
  <timestamp>${new Date().toISOString()}</timestamp>
  <event_id>${n||"unknown"}</event_id>
  <custom_columns>
    ${_.map(Q=>{const z=Q.customFields?Object.entries(Q.customFields).map(([ce,S])=>`<${ce}><![CDATA[${S||""}]]></${ce}>`).join(""):"";return`
    <item>
      <id>${Q.id}</id>
      <row>${Q.row||_.indexOf(Q)+1}</row>
      <cue><![CDATA[${Q.cue||""}]]></cue>
      ${z}
    </item>`}).join("")}
  </custom_columns>
</data>`;return ne+ee},R=_=>{let ne="Row,Cue,";const ee=new Set;return _.forEach(Q=>{Q.customFields&&Object.keys(Q.customFields).forEach(z=>ee.add(z))}),ee.forEach(Q=>{ne+=`${Q},`}),ne=ne.slice(0,-1)+`
`,_.forEach(Q=>{const z=Q.row||_.indexOf(Q)+1,ce=Q.cue||"",S=[z,`"${ce.replace(/"/g,'""')}"`,...Array.from(ee).map(A=>`"${(Q.customFields?.[A]||"").replace(/"/g,'""')}"`)].join(",");ne+=S+`
`}),ne},y=()=>{const _=w(e),ne=new Blob([_],{type:"application/xml"}),ee=URL.createObjectURL(ne),Q=document.createElement("a");Q.href=ee,Q.download=`custom-columns-${n||"data"}.xml`,document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),URL.revokeObjectURL(ee)},U=()=>{const _=w(e);pu(_)},q=()=>{const _=R(e),ne=new Blob([_],{type:"text/csv"}),ee=URL.createObjectURL(ne),Q=document.createElement("a");Q.href=ee,Q.download=`custom-columns-${n||"data"}.csv`,document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),URL.revokeObjectURL(ee)},G=()=>{const _=R(e);pu(_)};return i?l.jsxDEV("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:l.jsxDEV("div",{className:"text-center",children:[l.jsxDEV("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:311,columnNumber:11},void 0),l.jsxDEV("p",{className:"text-lg",children:"Loading Custom Columns Data..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:312,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:310,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:309,columnNumber:7},void 0):c?l.jsxDEV("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:l.jsxDEV("div",{className:"text-center",children:[l.jsxDEV("div",{className:"text-red-500 text-6xl mb-4",children:""},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:322,columnNumber:11},void 0),l.jsxDEV("h1",{className:"text-2xl font-bold mb-4",children:"Error Loading Data"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:323,columnNumber:11},void 0),l.jsxDEV("p",{className:"text-gray-300 mb-6",children:c},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:324,columnNumber:11},void 0),l.jsxDEV("button",{onClick:E,className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:"Try Again"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:325,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:321,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:320,columnNumber:7},void 0):l.jsxDEV("div",{className:"min-h-screen bg-gray-900 text-white",children:l.jsxDEV("div",{className:"container mx-auto px-4 py-8",children:l.jsxDEV("div",{className:"max-w-6xl mx-auto",children:[l.jsxDEV("div",{className:"text-center mb-8",children:[l.jsxDEV("h1",{className:"text-4xl font-bold mb-4",children:"Custom Columns XML Feed"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:341,columnNumber:13},void 0),l.jsxDEV("p",{className:"text-gray-300 text-lg",children:"Live XML and CSV data for VMIX integration with custom fields"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:342,columnNumber:13},void 0),n&&l.jsxDEV("p",{className:"text-blue-400 mt-2",children:["Event ID: ",n]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:346,columnNumber:15},void 0),p&&l.jsxDEV("p",{className:"text-gray-400 text-sm mt-2",children:["Last updated: ",p.toLocaleString()]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:349,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:340,columnNumber:11},void 0),l.jsxDEV("div",{className:"flex space-x-4 mb-6",children:[l.jsxDEV("button",{className:`px-6 py-3 rounded-lg font-semibold transition-colors ${x==="preview"?"bg-blue-600 text-white shadow-lg":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,onClick:()=>b("preview"),children:" XML Preview"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:357,columnNumber:13},void 0),l.jsxDEV("button",{className:`px-6 py-3 rounded-lg font-semibold transition-colors ${x==="instructions"?"bg-blue-600 text-white shadow-lg":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,onClick:()=>b("instructions"),children:" VMIX Instructions"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:367,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:356,columnNumber:11},void 0),x==="preview"&&l.jsxDEV("div",{className:"bg-gray-800 rounded-lg p-6",children:[l.jsxDEV("h2",{className:"text-xl font-bold mb-4",children:"XML Preview"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:381,columnNumber:15},void 0),l.jsxDEV("div",{className:"bg-gray-900 rounded p-4 overflow-auto max-h-96",children:l.jsxDEV("pre",{className:"text-sm text-green-400 whitespace-pre-wrap",children:w(e)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:383,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:382,columnNumber:15},void 0),l.jsxDEV("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxDEV("div",{className:"space-y-3",children:[l.jsxDEV("h3",{className:"text-lg font-semibold",children:"XML Actions"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:390,columnNumber:19},void 0),l.jsxDEV("button",{onClick:y,className:"w-full px-4 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors",children:" Download XML"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:391,columnNumber:19},void 0),l.jsxDEV("button",{onClick:U,className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:" Copy XML"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:397,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:389,columnNumber:17},void 0),l.jsxDEV("div",{className:"space-y-3",children:[l.jsxDEV("h3",{className:"text-lg font-semibold",children:"CSV Actions"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:406,columnNumber:19},void 0),l.jsxDEV("button",{onClick:q,className:"w-full px-4 py-3 bg-yellow-600 hover:bg-yellow-500 text-white font-medium rounded-lg transition-colors",children:" Download CSV"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:407,columnNumber:19},void 0),l.jsxDEV("button",{onClick:G,className:"w-full px-4 py-3 bg-purple-600 hover:bg-purple-500 text-white font-medium rounded-lg transition-colors",children:" Copy CSV"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:413,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:405,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:388,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:380,columnNumber:13},void 0),x==="instructions"&&l.jsxDEV("div",{className:"bg-blue-900/20 border border-blue-500/30 rounded-lg p-6",children:[l.jsxDEV("h3",{className:"text-lg font-bold mb-4 text-blue-400",children:"VMIX Integration Instructions"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:426,columnNumber:15},void 0),l.jsxDEV("div",{className:"space-y-6",children:[l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"text-md font-semibold mb-2 text-blue-300",children:"XML Data Source URL:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:430,columnNumber:19},void 0),l.jsxDEV("div",{className:"bg-gray-800 rounded p-3 flex items-center space-x-2",children:[l.jsxDEV("code",{className:"text-green-400 flex-1 text-sm",children:[Sh(),"/custom-columns.xml?eventId=",n||"YOUR_EVENT_ID"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:432,columnNumber:21},void 0),l.jsxDEV("button",{onClick:()=>pu(`${Sh()}/custom-columns.xml?eventId=${n||"YOUR_EVENT_ID"}`),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:435,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:431,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:429,columnNumber:17},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"text-md font-semibold mb-2 text-blue-300",children:"CSV Data Source URL:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:445,columnNumber:19},void 0),l.jsxDEV("div",{className:"bg-gray-800 rounded p-3 flex items-center space-x-2",children:[l.jsxDEV("code",{className:"text-green-400 flex-1 text-sm",children:[Sh(),"/custom-columns.csv?eventId=",n||"YOUR_EVENT_ID"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:447,columnNumber:21},void 0),l.jsxDEV("button",{onClick:()=>pu(`${Sh()}/custom-columns.csv?eventId=${n||"YOUR_EVENT_ID"}`),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:450,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:446,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:444,columnNumber:17},void 0),l.jsxDEV("div",{children:[l.jsxDEV("h4",{className:"text-md font-semibold mb-2 text-blue-300",children:"Alternative: Direct Links (Netlify Only):"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:460,columnNumber:19},void 0),l.jsxDEV("div",{className:"space-y-2",children:[l.jsxDEV("div",{className:"bg-gray-800 rounded p-3 flex items-center space-x-2",children:[l.jsxDEV("code",{className:"text-green-400 flex-1 text-sm",children:[window.location.origin,"/.netlify/functions/custom-columns-xml?eventId=",n||"YOUR_EVENT_ID"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:463,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>pu(`${window.location.origin}/.netlify/functions/custom-columns-xml?eventId=${n||"YOUR_EVENT_ID"}`),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:466,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:462,columnNumber:21},void 0),l.jsxDEV("div",{className:"bg-gray-800 rounded p-3 flex items-center space-x-2",children:[l.jsxDEV("code",{className:"text-green-400 flex-1 text-sm",children:[window.location.origin,"/.netlify/functions/custom-columns-csv?eventId=",n||"YOUR_EVENT_ID"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:474,columnNumber:23},void 0),l.jsxDEV("button",{onClick:()=>pu(`${window.location.origin}/.netlify/functions/custom-columns-csv?eventId=${n||"YOUR_EVENT_ID"}`),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white text-sm rounded transition-colors",children:"Copy"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:477,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:473,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:461,columnNumber:19},void 0),l.jsxDEV("p",{className:"text-xs text-gray-400 mt-2",children:[" ",l.jsxDEV("strong",{children:"Tip:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:486,columnNumber:24},void 0)," These direct Netlify Function URLs work immediately without any server setup!"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:485,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:459,columnNumber:17},void 0),l.jsxDEV("div",{className:"bg-yellow-900/20 border border-yellow-500/30 rounded p-4",children:[l.jsxDEV("h4",{className:"text-md font-semibold mb-2 text-yellow-300",children:"Environment:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:491,columnNumber:19},void 0),l.jsxDEV("p",{className:"text-yellow-200 text-sm",children:rk()?" Netlify Hosted":" Local Development"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:492,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:490,columnNumber:17},void 0),l.jsxDEV("div",{className:"bg-gray-800 rounded p-4",children:[l.jsxDEV("h4",{className:"text-md font-semibold mb-2 text-gray-300",children:"VMIX Setup Steps:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:498,columnNumber:19},void 0),l.jsxDEV("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-300",children:[l.jsxDEV("li",{children:"Open VMIX and go to Data Sources"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:500,columnNumber:21},void 0),l.jsxDEV("li",{children:'Click "Add Data Source" and select "XML" or "CSV"'},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:501,columnNumber:21},void 0),l.jsxDEV("li",{children:'Paste the URL above into the "URL" field'},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:502,columnNumber:21},void 0),l.jsxDEV("li",{children:"Set refresh interval to 10 seconds for live updates"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:503,columnNumber:21},void 0),l.jsxDEV("li",{children:"Configure your graphics to use the data fields"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:504,columnNumber:21},void 0),l.jsxDEV("li",{children:"Custom fields will be available as separate columns"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:505,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:499,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:497,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:428,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:425,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:339,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:338,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/CustomColumnsXMLPage.tsx",lineNumber:337,columnNumber:5},void 0)},p9=()=>{const t=Oa();fl();const n=new URLSearchParams(t.search),e=n.get("eventId"),s=n.get("eventName"),i=t.state?.event||{id:e||"",name:s||"Current Event",date:"",location:"",schedule:[]},[d,c]=I.useState([]),[f,p]=I.useState(null),[g,x]=I.useState(!0),[b,E]=I.useState(null),[w,R]=I.useState(!1);I.useEffect(()=>{(async()=>{console.log("=== GRAPHICS LINKS PAGE INITIALIZATION ==="),console.log("Event from location.state:",t.state?.event),console.log("Event from URL params:",{eventId:e,eventName:s}),console.log("Final event object:",i);try{console.log(" Loading from localStorage first...");let A=null;if(i?.id){const W=`runOfShowSchedule_${i.id}`;A=localStorage.getItem(W)}if(!A&&e){const W=`runOfShowSchedule_${e}`;A=localStorage.getItem(W)}if(!A){const H=Object.keys(localStorage).filter(K=>K.startsWith("runOfShowSchedule_"));if(H.length>0){const K=H[H.length-1];A=localStorage.getItem(K)}}if(A){const W=JSON.parse(A);console.log(" Loaded from localStorage:",W),c(W),x(!1);return}if(i?.id){console.log(" No localStorage data, loading from API for event:",i.id);const W=await it.getRunOfShowData(i.id);W&&(console.log(" Loaded from API:",W),c(W.schedule_items||[]),p(W.updated_at||null))}}catch(A){console.error(" Error loading initial data:",A)}finally{x(!1)}})()},[i?.id,e]),I.useEffect(()=>{if(!i?.id){console.log(" No event ID, skipping WebSocket connection");return}console.log(" Setting up WebSocket connection for Graphics Links page");const S={onRunOfShowDataUpdated:A=>{console.log(" Graphics Links: WebSocket data update received:",A),A&&A.schedule_items&&(c(A.schedule_items),p(A.updated_at||null),E(new Date),console.log(" Graphics Links: Schedule updated via WebSocket"))},onConnectionChange:A=>{console.log(" Graphics Links: WebSocket connection status:",A),A&&(async()=>{try{const H=await it.getRunOfShowData(i.id);H&&(c(H.schedule_items||[]),p(H.updated_at||null),console.log(" Graphics Links: Data reloaded on reconnection"))}catch(H){console.error(" Graphics Links: Error reloading data on reconnection:",H)}})()}};return _r.connect(i.id,S),()=>{console.log(" Graphics Links: Cleaning up WebSocket connection"),_r.disconnect(i.id)}},[i?.id]);const y=S=>{if(typeof S=="string"){let A=S.replace(/&/g,"\\u0026");return A=A.replace(/\n/g," ").replace(/\r/g," "),A=A.replace(/[\x00-\x1F\x7F]/g," "),A}else{if(Array.isArray(S))return S.map(A=>y(A));if(S!==null&&typeof S=="object"){const A={};for(const[W,H]of Object.entries(S))A[W]=y(H);return A}}return S},U=async()=>{console.log("=== GRAPHICS LINKS JSON GENERATION ===");let S=d;try{if(i?.id){const Ee=await it.getRunOfShowData(i.id);Ee?.schedule_items&&(S=Ee.schedule_items,console.log(" Loaded fresh schedule data for JSON generation"))}}catch(Ee){console.log(" Using cached schedule data:",Ee)}console.log("Using schedule data:",S);let A="";const H=Object.keys(localStorage).filter(Ee=>Ee.startsWith("masterStartTime_"));if(H.length>0){const Ee=H[H.length-1],Ce=localStorage.getItem(Ee);Ce&&(A=Ce,console.log("Master start time from localStorage:",A))}if(!A&&i?.id)try{const Ee=await it.getRunOfShowData(i.id);Ee?.settings?.masterStartTime&&(A=Ee.settings.masterStartTime,console.log("Master start time from API:",A))}catch(Ee){console.log("Error getting master start time from API:",Ee)}const K=Ee=>{const Ce=S[Ee];if(!Ce||Ce.isIndented||!A)return"";let j=0;for(let ge=0;ge<Ee;ge++){const ze=S[ge];ze.isIndented||(j+=(ze.durationHours||0)*3600+(ze.durationMinutes||0)*60+(ze.durationSeconds||0))}const[X,T]=A.split(":").map(Number),P=X*3600+T*60+j,F=Math.floor(P/3600)%24,de=Math.floor(P%3600/60),fe=new Date;return fe.setHours(F,de,0,0),fe.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})};console.log("=== FINAL DATA SUMMARY ==="),console.log("Schedule data:",S),console.log("Master start time:",A),console.log("=== END FINAL DATA SUMMARY ===");const Oe=S.filter(Ee=>Ee.isPublic===!0).map(Ee=>{const Ce=S.findIndex(X=>X.id===Ee.id),j=K(Ce);return{segmentName:Ee.segmentName||"Untitled Segment",startTime:j||"No Start Time"}});console.log("Public items found:",Oe);const ye={event:i?.name||"Current Event",generated:new Date().toISOString(),schedule:Oe},Pe=y(ye),ve=JSON.stringify(Pe,null,2),Ge=new Blob([ve],{type:"application/json;charset=utf-8;"}),ie=URL.createObjectURL(Ge);window.open(ie,"_blank")},q=async()=>{console.log("=== GENERATING LOWER THIRDS JSON ==="),console.log("Event ID from URL:",e),console.log("Event object:",i);let S=d;try{if(i?.id){const ie=await it.getRunOfShowData(i.id);ie?.schedule_items&&(S=ie.schedule_items,console.log(" Loaded fresh schedule data for Lower Thirds JSON"))}}catch(ie){console.log(" Using cached schedule data for Lower Thirds:",ie)}console.log("Using schedule data:",S),console.log("Schedule length:",S.length),console.log("First few items:",S.slice(0,3));const A=S.filter(ie=>ie.speakersText&&ie.speakersText.trim());console.log("Items with speakers data:",A.length),console.log("Items with speakers:",A.map(ie=>({segmentName:ie.segmentName,speakersText:ie.speakersText,speakersLength:ie.speakersText?.length||0}))),S.length===0&&(console.log(" NO SCHEDULE DATA FOUND!"),console.log("Available localStorage keys:",Object.keys(localStorage)),console.log("Looking for keys with event ID:",e));const H=Object.keys(localStorage).filter(ie=>ie.startsWith("masterStartTime_"));if(H.length>0){const ie=H[H.length-1];localStorage.getItem(ie)}const K=[];S.forEach((ie,Ee)=>{console.log("Processing item:",ie.segmentName,"Speakers:",ie.speakersText),console.log("Item details:",{id:ie.id,segmentName:ie.segmentName,speakersText:ie.speakersText,speakersTextLength:ie.speakersText?.length||0,speakersTextType:typeof ie.speakersText});const Ce={row:Ee+1,cue:ie.customFields.cue||"",program:ie.programType||"",segmentName:ie.segmentName||"",speaker1Name:"",speaker1TitleOrg:"",speaker1Photo:"",speaker2Name:"",speaker2TitleOrg:"",speaker2Photo:"",speaker3Name:"",speaker3TitleOrg:"",speaker3Photo:"",speaker4Name:"",speaker4TitleOrg:"",speaker4Photo:"",speaker5Name:"",speaker5TitleOrg:"",speaker5Photo:"",speaker6Name:"",speaker6TitleOrg:"",speaker6Photo:"",speaker7Name:"",speaker7TitleOrg:"",speaker7Photo:""};if(ie.speakersText&&ie.speakersText.trim())try{const j=JSON.parse(ie.speakersText);console.log("Parsed speakers array:",j),console.log("Speakers array length:",j?.length||0);const X=j.sort((T,O)=>T.slot-O.slot);console.log("Sorted speakers by slot:",X),X.forEach(T=>{const O=T.slot;if(O>=1&&O<=7){const P=T.fullName||"",F=T.title&&T.org?`${T.title}
${T.org}`:T.title||T.org||"",de=T.photoLink||"";Ce[`speaker${O}Name`]=P,Ce[`speaker${O}TitleOrg`]=F,Ce[`speaker${O}Photo`]=de,console.log(`Set speaker ${O} (${P}) in row ${Ee+1}`)}else console.log(`Speaker slot ${O} (${T.fullName}) is outside range 1-7, skipping`)})}catch(j){console.log("Error parsing speakers JSON:",j),console.log("Raw speakers data:",ie.speakersText)}else console.log("No speakers found in row:",ie.segmentName);K.push(Ce)}),console.log("CUE rows with all speakers:",K);const Oe={event:i?.name||"Current Event",generated:new Date().toISOString(),lowerThirds:{cueRows:K,totalRows:K.length,totalSpeakers:K.reduce((ie,Ee)=>ie+[1,2,3,4,5,6,7].filter(Ce=>Ee[`speaker${Ce}Name`].trim()).length,0)}},ye=y(Oe),Pe=JSON.stringify(ye,null,2),ve=new Blob([Pe],{type:"application/json;charset=utf-8;"}),Ge=URL.createObjectURL(ve);window.open(Ge,"_blank"),console.log("=== END GENERATING LOWER THIRDS JSON ===")},G=()=>{const A=`${window.location.origin}/lower-thirds-live.html?eventId=${e||i?.id}`;navigator.clipboard.writeText(A).then(()=>{alert(`Live JSON URL copied to clipboard:
${A}

Use this URL in VMIX Data Sources  JSON/XML

This URL will automatically update every 10 seconds!`)}).catch(()=>{const W=document.createElement("textarea");W.value=A,document.body.appendChild(W),W.select(),document.execCommand("copy"),document.body.removeChild(W),alert(`Live JSON URL copied to clipboard:
${A}

Use this URL in VMIX Data Sources  JSON/XML

This URL will automatically update every 10 seconds!`)})},_=()=>{const A=`${window.location.origin}/schedule-live.html?eventId=${e||i?.id}`;navigator.clipboard.writeText(A).then(()=>{alert(`Live Schedule URL copied to clipboard:
${A}

Use this URL in VMIX Data Sources  JSON/XML

This URL will automatically update every 10 seconds!`)}).catch(()=>{const W=document.createElement("textarea");W.value=A,document.body.appendChild(W),W.select(),document.execCommand("copy"),document.body.removeChild(W),alert(`Live Schedule URL copied to clipboard:
${A}

Use this URL in VMIX Data Sources  JSON/XML

This URL will automatically update every 10 seconds!`)})},ne=()=>{const A=`${window.location.origin}/custom-graphics-live.html?eventId=${e||i?.id}`;navigator.clipboard.writeText(A).then(()=>{alert(`Live Custom Graphics JSON URL copied to clipboard:
${A}

Use this URL in VMIX Data Sources  JSON

This URL will automatically update every 10 seconds!`)}).catch(()=>{const W=document.createElement("textarea");W.value=A,document.body.appendChild(W),W.select(),document.execCommand("copy"),document.body.removeChild(W),alert(`Live Custom Graphics JSON URL copied to clipboard:
${A}

Use this URL in VMIX Data Sources  JSON

This URL will automatically update every 10 seconds!`)})},ee=()=>{const A=`${window.location.origin}/custom-graphics-live-csv.html?eventId=${e||i?.id}`;navigator.clipboard.writeText(A).then(()=>{alert(`Live Custom Graphics CSV URL copied to clipboard:
${A}

Use this URL in VMIX Data Sources  CSV

This URL will automatically update every 10 seconds!`)}).catch(()=>{const W=document.createElement("textarea");W.value=A,document.body.appendChild(W),W.select(),document.execCommand("copy"),document.body.removeChild(W),alert(`Live Custom Graphics CSV URL copied to clipboard:
${A}

Use this URL in VMIX Data Sources  CSV

This URL will automatically update every 10 seconds!`)})},Q=()=>{const A=`${window.location.origin}/lower-thirds-live-csv.html?eventId=${e||i?.id}`;navigator.clipboard.writeText(A).then(()=>{alert(`Live CSV URL copied to clipboard:
${A}

Use this URL in VMIX Data Sources  CSV

This URL will automatically update every 10 seconds!`)}).catch(()=>{const W=document.createElement("textarea");W.value=A,document.body.appendChild(W),W.select(),document.execCommand("copy"),document.body.removeChild(W),alert(`Live CSV URL copied to clipboard:
${A}

Use this URL in VMIX Data Sources  CSV

This URL will automatically update every 10 seconds!`)})},z=()=>{const A=`${window.location.origin}/schedule-live-csv.html?eventId=${e||i?.id}`;navigator.clipboard.writeText(A).then(()=>{alert(`Live Schedule CSV URL copied to clipboard:
${A}

Use this URL in VMIX Data Sources  CSV

This URL will automatically update every 10 seconds!`)}).catch(()=>{const W=document.createElement("textarea");W.value=A,document.body.appendChild(W),W.select(),document.execCommand("copy"),document.body.removeChild(W),alert(`Live Schedule CSV URL copied to clipboard:
${A}

Use this URL in VMIX Data Sources  CSV

This URL will automatically update every 10 seconds!`)})},ce=async()=>{console.log(" Starting generateCustomGraphicsJSON");let S=d;try{if(i?.id){const Ce=await it.getRunOfShowData(i.id);Ce?.schedule_items&&(S=Ce.schedule_items,console.log(" Loaded fresh schedule data for Custom Graphics JSON"))}}catch(Ce){console.log(" Using cached schedule data for Custom Graphics:",Ce)}console.log(" Current schedule data:",S),console.log(" Schedule length:",S.length);let A="";const H=Object.keys(localStorage).filter(Ce=>Ce.startsWith("masterStartTime_"));if(H.length>0){const Ce=H[H.length-1],j=localStorage.getItem(Ce);j&&(A=j)}const K=Ce=>{if(!A)return"";let j=0;for(let P=0;P<Ce;P++){const F=S[P];j+=F.durationHours*60+F.durationMinutes}const[X,T]=A.split(":").map(Number),O=new Date;return O.setHours(X,T+j,0,0),O.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})};let Oe=[];if(i?.id){const Ce=localStorage.getItem(`customColumns_${i.id}`);Ce&&(Oe=JSON.parse(Ce),console.log(" Custom columns from localStorage:",Oe))}if(Oe.length===0&&i?.id)try{Oe=(await it.getRunOfShowData(i.id))?.custom_columns||[],console.log(" Custom columns from API:",Oe)}catch(Ce){console.log("Error getting custom columns from API:",Ce)}console.log(" Final custom columns for graphics:",Oe),console.log(" Schedule data for graphics:",S),console.log(" Schedule length:",S.length),console.log(" Public items:",S.filter(Ce=>Ce.isPublic).length);const ye=S.filter(Ce=>Ce.isPublic).map(Ce=>{const j={type:Ce.segmentName||"Segment",text:Ce.segmentName||"Custom Graphic",duration:`${Ce.durationHours.toString().padStart(2,"0")}:${Ce.durationMinutes.toString().padStart(2,"0")}:${Ce.durationSeconds.toString().padStart(2,"0")}`,cue:Ce.customFields.cue||"CUE##",startTime:K(S.findIndex(T=>T.id===Ce.id)),notes:Ce.notes||""},X={};return Oe.forEach(T=>{const O=Ce.customFields[T.name];O&&O.trim()!==""&&(X[T.name]=O)}),{...j,...X}});console.log(" Generated custom graphics:",ye),console.log(" Custom graphics length:",ye.length);const Pe={event:i?.name||"Current Event",generated:new Date().toISOString(),customGraphics:ye.length>0?ye:[{type:"Title",text:"Welcome to Event",duration:"00:00:10",cue:"CUE01",startTime:"00:00:00",notes:"Opening title"},{type:"Break",text:"Commercial Break",duration:"00:02:00",cue:"CUE02",startTime:"00:15:00",notes:"Commercial break"}]},ve=y(Pe),Ge=JSON.stringify(ve,null,2),ie=new Blob([Ge],{type:"application/json;charset=utf-8;"}),Ee=URL.createObjectURL(ie);window.open(Ee,"_blank")};return l.jsxDEV("div",{className:"min-h-screen bg-slate-900 text-white pt-16",children:[l.jsxDEV("div",{className:"bg-slate-800 border-b border-slate-700",children:l.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxDEV("div",{className:"flex items-center justify-between h-16",children:[l.jsxDEV("div",{className:"flex items-center",children:[l.jsxDEV("button",{onClick:()=>{window.close()},className:"text-slate-300 hover:text-white transition-colors mr-6",children:" Back to Run of Show"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:780,columnNumber:15},void 0),l.jsxDEV("h1",{className:"text-xl font-semibold",children:"Graphics Links"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:789,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:779,columnNumber:13},void 0),l.jsxDEV("div",{className:"text-slate-400",children:i?.name||"Event"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:791,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:778,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:777,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:776,columnNumber:7},void 0),l.jsxDEV("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:l.jsxDEV("div",{className:"bg-blue-900 rounded-xl p-6 shadow-2xl border border-blue-700",children:l.jsxDEV("div",{className:"flex items-center justify-between",children:[l.jsxDEV("div",{children:[l.jsxDEV("h2",{className:"text-xl font-bold text-white",children:" Event ID for Desktop App"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:803,columnNumber:15},void 0),l.jsxDEV("p",{className:"text-blue-200 text-sm mt-1",children:"Copy this Event ID to use in the Python desktop application"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:804,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:802,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex items-center space-x-4",children:[l.jsxDEV("div",{className:"bg-slate-700 px-4 py-2 rounded-lg",children:l.jsxDEV("code",{className:"text-green-400 font-mono text-lg",children:e||i?.id||"No Event ID"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:808,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:807,columnNumber:15},void 0),l.jsxDEV("button",{onClick:()=>{const S=e||i?.id;S?navigator.clipboard.writeText(S).then(()=>{alert("Event ID copied to clipboard!")}).catch(()=>{const A=document.createElement("textarea");A.value=S,document.body.appendChild(A),A.select(),document.execCommand("copy"),document.body.removeChild(A),alert("Event ID copied to clipboard!")}):alert("No Event ID available")},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:" Copy Event ID"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:810,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:806,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:801,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:800,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:799,columnNumber:7},void 0),l.jsxDEV("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:l.jsxDEV("div",{className:"bg-green-900 rounded-xl p-6 shadow-2xl border border-green-700",children:[l.jsxDEV("div",{className:"flex items-center justify-between",children:[l.jsxDEV("div",{children:[l.jsxDEV("h2",{className:"text-xl font-bold text-white",children:" Python Desktop App"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:844,columnNumber:15},void 0),l.jsxDEV("p",{className:"text-green-200 text-sm mt-1",children:"Download the Python application for generating live graphics files"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:845,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:843,columnNumber:13},void 0),l.jsxDEV("div",{className:"flex items-center space-x-4",children:l.jsxDEV("a",{href:"/LiveGraphicsGenerator-Python.zip",download:"LiveGraphicsGenerator-Python.zip",className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg transition-colors font-semibold",children:" Download Python App"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:848,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:847,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:842,columnNumber:11},void 0),l.jsxDEV("div",{className:"mt-4 text-green-200 text-sm",children:[l.jsxDEV("p",{children:" Generates CSV files every 10 seconds"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:858,columnNumber:13},void 0),l.jsxDEV("p",{children:" No browser required - runs as desktop application"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:859,columnNumber:13},void 0),l.jsxDEV("p",{children:" Easy setup with GUI interface"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:860,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:857,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:841,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:840,columnNumber:7},void 0),l.jsxDEV("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-xl p-8 shadow-2xl",children:[l.jsxDEV("div",{className:"flex items-center justify-between mb-6",children:[l.jsxDEV("div",{children:[l.jsxDEV("h2",{className:"text-2xl font-bold text-white",children:"Generate JSON Files"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:870,columnNumber:15},void 0),g&&l.jsxDEV("p",{className:"text-blue-400 text-sm mt-1",children:" Loading data..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:872,columnNumber:17},void 0),b&&!g&&l.jsxDEV("p",{className:"text-green-400 text-sm mt-1",children:[" Last updated: ",b.toLocaleTimeString()]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:875,columnNumber:17},void 0),w&&l.jsxDEV("p",{className:"text-blue-400 text-sm mt-1",children:" Updating data..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:880,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:869,columnNumber:13},void 0),l.jsxDEV("button",{onClick:async()=>{console.log(" Manual refresh triggered"),x(!0);try{let S=null;if(i?.id){const A=`runOfShowSchedule_${i.id}`;S=localStorage.getItem(A)}if(!S&&e){const A=`runOfShowSchedule_${e}`;S=localStorage.getItem(A)}if(!S){const W=Object.keys(localStorage).filter(H=>H.startsWith("runOfShowSchedule_"));if(W.length>0){const H=W[W.length-1];S=localStorage.getItem(H)}}if(S){const A=JSON.parse(S);console.log(" Refreshed from localStorage:",A),c(A),E(new Date),alert("Data refreshed from local storage!");return}if(i?.id){const A=await it.getRunOfShowData(i.id);A?(c(A.schedule_items||[]),p(A.updated_at||null),E(new Date),console.log(" Refreshed from API"),alert("Data refreshed from database!")):alert("No schedule data found")}else alert("No schedule data found")}catch(S){console.error(" Error refreshing data:",S),alert("Error refreshing data")}finally{x(!1)}},className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:" Refresh Data"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:883,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:868,columnNumber:11},void 0),l.jsxDEV("p",{className:"text-slate-300 mb-8",children:["Click the buttons below to generate url links that VMIX can use as data sources for graphics.",l.jsxDEV("span",{className:"text-green-400 font-medium",children:"  Live pages updates automatically when content changes! "},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:949,columnNumber:13},void 0),l.jsxDEV("span",{className:"text-blue-400 font-medium",children:"  Optimized for minimal data usage with WebSocket updates! "},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:950,columnNumber:13},void 0),`Use "Refresh Data" if changes don't appear automatically.`]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:947,columnNumber:11},void 0),l.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-6 flex flex-col",children:[l.jsxDEV("h3",{className:"text-xl font-semibold text-white mb-4 text-center",children:"Lower Thirds"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:958,columnNumber:15},void 0),l.jsxDEV("div",{className:"space-y-3 mt-auto",children:[l.jsxDEV("button",{onClick:async()=>{try{await q()}catch(S){console.error("Error generating lower thirds JSON:",S),alert("Error generating lower thirds JSON")}},className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:" Generate Static JSON"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:960,columnNumber:17},void 0),l.jsxDEV("button",{onClick:G,className:"w-full px-4 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors",children:" Generate Live JSON URL"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:973,columnNumber:17},void 0),l.jsxDEV("button",{onClick:Q,className:"w-full px-4 py-3 bg-yellow-600 hover:bg-yellow-500 text-white font-medium rounded-lg transition-colors",children:" Generate Live CSV URL"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:979,columnNumber:17},void 0),l.jsxDEV("button",{onClick:()=>{const S=`/lower-thirds-xml?eventId=${i.id}`;window.open(S,"_blank")},className:"w-full px-4 py-3 bg-purple-600 hover:bg-purple-500 text-white font-medium rounded-lg transition-colors",children:" Open XML Feed Page (Local)"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:985,columnNumber:17},void 0),l.jsxDEV("button",{onClick:()=>{const S=`/netlify-lower-thirds-xml?eventId=${i.id}`;window.open(S,"_blank")},className:"w-full px-4 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-lg transition-colors",children:" Open XML Feed Page (Netlify/Railway)"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:994,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:959,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:957,columnNumber:13},void 0),l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-6 flex flex-col",children:[l.jsxDEV("h3",{className:"text-xl font-semibold text-white mb-4 text-center",children:"Schedule"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1008,columnNumber:15},void 0),l.jsxDEV("div",{className:"space-y-3 mt-auto",children:[l.jsxDEV("button",{onClick:async()=>{try{await U()}catch(S){console.error("Error generating schedule JSON:",S),alert("Error generating schedule JSON")}},className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:" Generate Static JSON"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1010,columnNumber:17},void 0),l.jsxDEV("button",{onClick:_,className:"w-full px-4 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors",children:" Generate Live JSON URL"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1023,columnNumber:17},void 0),l.jsxDEV("button",{onClick:z,className:"w-full px-4 py-3 bg-yellow-600 hover:bg-yellow-500 text-white font-medium rounded-lg transition-colors",children:" Generate Live CSV URL"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1029,columnNumber:17},void 0),l.jsxDEV("button",{onClick:()=>{const S=`/schedule-xml?eventId=${i.id}`;window.open(S,"_blank")},className:"w-full px-4 py-3 bg-purple-600 hover:bg-purple-500 text-white font-medium rounded-lg transition-colors",children:" Open Schedule XML Feed"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1035,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1009,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1007,columnNumber:13},void 0),l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-6 flex flex-col",children:[l.jsxDEV("h3",{className:"text-xl font-semibold text-white mb-4 text-center",children:"Custom Graphics"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1049,columnNumber:15},void 0),l.jsxDEV("div",{className:"space-y-3 mt-auto",children:[l.jsxDEV("button",{onClick:async()=>{try{await ce()}catch(S){console.error("Error generating custom graphics JSON:",S),alert("Error generating custom graphics JSON")}},className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors",children:" Generate Static JSON"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1051,columnNumber:17},void 0),l.jsxDEV("button",{onClick:ne,className:"w-full px-4 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors",children:" Generate Live JSON URL"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1064,columnNumber:17},void 0),l.jsxDEV("button",{onClick:ee,className:"w-full px-4 py-3 bg-yellow-600 hover:bg-yellow-500 text-white font-medium rounded-lg transition-colors",children:" Generate Live CSV URL"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1070,columnNumber:17},void 0),l.jsxDEV("button",{onClick:()=>{const S=`/custom-columns-xml?eventId=${i.id}`;window.open(S,"_blank")},className:"w-full px-4 py-3 bg-purple-600 hover:bg-purple-500 text-white font-medium rounded-lg transition-colors",children:" Open Custom Columns XML Feed"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1076,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1050,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1048,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:954,columnNumber:11},void 0),l.jsxDEV("div",{className:"mt-8 p-4 bg-slate-600 rounded-lg",children:[l.jsxDEV("h4",{className:"text-white font-semibold mb-2",children:"VMIX Data Source Information"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1092,columnNumber:13},void 0),l.jsxDEV("p",{className:"text-slate-300 text-sm",children:'These data sources are designed for VMIX and will include only items marked as "Public":'},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1093,columnNumber:13},void 0),l.jsxDEV("ul",{className:"text-slate-300 text-sm mt-2 ml-4 list-disc",children:[l.jsxDEV("li",{children:[l.jsxDEV("strong",{children:"Schedule:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1097,columnNumber:19},void 0)," Segment Name, Start Time (sorted by time)"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1097,columnNumber:15},void 0),l.jsxDEV("li",{children:[l.jsxDEV("strong",{children:"Lower Thirds:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1098,columnNumber:19},void 0)," Speaker Names, Titles, Organizations, Segments, CUEs (up to 7 speakers per segment)"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1098,columnNumber:15},void 0),l.jsxDEV("li",{children:[l.jsxDEV("strong",{children:"Custom Graphics:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1099,columnNumber:19},void 0)," Type, Text, Duration, CUE, Start Time, Notes, plus custom columns (if data exists)"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1099,columnNumber:15},void 0),l.jsxDEV("li",{children:[l.jsxDEV("strong",{children:"VMIX XML:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1100,columnNumber:19},void 0)," Native VMIX XML format with auto-refresh every 10 seconds, includes segment details and timing"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1100,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1096,columnNumber:13},void 0),l.jsxDEV("div",{className:"mt-4 p-3 bg-green-900 rounded-lg",children:l.jsxDEV("p",{className:"text-green-200 text-sm",children:[l.jsxDEV("strong",{children:" Live Updates:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1104,columnNumber:17},void 0),' Use the "Live" URLs for real-time data that automatically updates every 10 seconds in VMIX']},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1103,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1102,columnNumber:13},void 0),l.jsxDEV("div",{className:"mt-4 p-3 bg-blue-900 rounded-lg",children:l.jsxDEV("p",{className:"text-blue-200 text-sm",children:[l.jsxDEV("strong",{children:"VMIX Setup:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1109,columnNumber:17},void 0)," Copy the Live URLs and add them in VMIX Data Sources  JSON/XML/CSV. No need to save files manually!"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1108,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1107,columnNumber:13},void 0),l.jsxDEV("div",{className:"mt-2 p-3 bg-yellow-900 rounded-lg",children:l.jsxDEV("p",{className:"text-yellow-200 text-sm",children:[l.jsxDEV("strong",{children:"Format Options:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1114,columnNumber:17},void 0)," JSON (recommended), XML, or CSV - choose what works best with your VMIX setup"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1113,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1112,columnNumber:13},void 0),l.jsxDEV("div",{className:"mt-2 p-3 bg-purple-900 rounded-lg",children:l.jsxDEV("p",{className:"text-purple-200 text-sm",children:[l.jsxDEV("strong",{children:" Performance Optimized:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1119,columnNumber:17},void 0)," This page now uses WebSocket for real-time updates and localStorage caching to minimize data usage and improve performance"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1118,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1117,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:1091,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:867,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:866,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GraphicsLinksPage.tsx",lineNumber:774,columnNumber:5},void 0)},v9=()=>{const t=Oa();fl();const n=new URLSearchParams(t.search),e=n.get("eventId"),s=n.get("eventName"),i=t.state?.event||{id:e||"",name:s||"Current Event",date:"",location:"",schedule:[]};console.log("ReportsPage event data:",{fromState:!!t.state?.event,eventId:e,eventName:s,finalEvent:i,userRole:localStorage.getItem("currentUserRole")});const[d,c]=I.useState([]),[f,p]=I.useState(""),[g,x]=I.useState("showfile"),[b,E]=I.useState(1),[w,R]=I.useState("landscape");I.useEffect(()=>{console.log("=== REPORTS PAGE INITIALIZATION ==="),console.log("Event:",i);let ce=null;if(i?.id){const H=`runOfShowSchedule_${i.id}`;ce=localStorage.getItem(H)}if(!ce&&e){const H=`runOfShowSchedule_${e}`;ce=localStorage.getItem(H)}if(!ce){const K=Object.keys(localStorage).filter(Oe=>Oe.startsWith("runOfShowSchedule_"));if(K.length>0){const Oe=K[K.length-1];ce=localStorage.getItem(Oe)}}if(ce)try{const H=JSON.parse(ce);c(H),console.log("Schedule loaded:",H),console.log("First schedule item:",H[0]),console.log("Schedule item duration fields:",H[0]?{durationHours:H[0].durationHours,durationMinutes:H[0].durationMinutes,durationSeconds:H[0].durationSeconds}:"No items")}catch(H){console.log("Error parsing schedule:",H)}const A=Object.keys(localStorage).filter(H=>H.startsWith("masterStartTime_"));console.log("Master time keys found:",A);let W=null;if(i?.id&&(W=localStorage.getItem(`masterStartTime_${i.id}`),console.log(`Master time for event ${i.id}:`,W)),!W&&A.length>0){const H=A[A.length-1];W=localStorage.getItem(H),console.log("Latest master time key:",H,"Value:",W)}W?(p(W),console.log("Master start time set to:",W)):(console.log("No master start time found in localStorage"),p("09:00"),console.log("Set default master start time to 09:00"))},[i?.id,e]);const y=ce=>{if(!ce)return"Not set";const[S,A]=ce.split(":").map(Number),W=new Date;return W.setHours(S,A,0,0),W.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},U=(ce,S=20)=>ce?ce.length<=S?ce:ce.substring(0,S-3)+"...":"",q=ce=>{if(ce.trim().length===0)return{html:"",needsSmallText:!1};const S=ce.trim(),A=S.split(/\s+/);if(A.length<=1)return{html:S,needsSmallText:!1};const W=["Dr","Dr.","Prof","Prof.","Mr","Mr.","Mrs","Mrs.","Ms","Ms.","Hon","Hon.","Honorable","Sen","Sen.","Senator","Rep","Rep.","Representative","Gov","Gov.","Governor","Mayor","Judge","Ambassador","Amb","Amb.","General","Gen","Gen.","Admiral","Adm","Adm.","Colonel","Col","Col.","Major","Maj","Maj.","Captain","Capt","Capt.","Lieutenant","Lt","Lt.","Sergeant","Sgt","Sgt.","Chief","Commander","Comm"],H=["Jr","Jr.","Sr","Sr.","III","IV","V","Ph.D","PhD","MD","DDS","DVM","Esq","Esq.","CPA","PE","RN","LPN"];let K="",Oe="",ye="",Pe="",ve="";W.includes(A[0])&&(K=A[0],A.shift());const Ge=S.match(/\([DR]\)/i);if(Ge){ve=Ge[0];const X=A.findIndex(T=>T.match(/\([DR]\)/i));X!==-1&&A.splice(X,1)}if(A.length>0&&H.includes(A[A.length-1])&&(Pe=A[A.length-1],A.pop()),A.length===0)return{html:S,needsSmallText:!1};if(A.length===1)Oe=A[0];else{const X=A.length-1;ye=A[X],Oe=A.slice(0,X).join(" ")}const ie=9;let Ee=[K,Oe].filter(Boolean).join(" "),Ce=[ye,Pe,ve].filter(Boolean).join(" ");if(Ee.length>ie&&Oe.includes(" ")){const X=Oe.split(" ");if(X.length>1){const T=X.pop(),O=X.join(" ");Ee=[K,O].filter(Boolean).join(" "),Ce=[T,ye,Pe,ve].filter(Boolean).join(" ")}}if(Ee.length>ie&&Oe.includes(" ")){const X=Oe.split(" ");if(X.length>2){const T=X.splice(-2),O=X.join(" ");Ee=[K,O].filter(Boolean).join(" "),Ce=[T.join(" "),ye,Pe,ve].filter(Boolean).join(" ")}}const j=Ee.length>ie||Ce.length>ie;return{html:`${Ee}<br/>${Ce}`,needsSmallText:j}},G=ce=>{if(console.log(`calculateStartTime called with index: ${ce}, masterStartTime: ${f}`),!f)return console.log("No master start time, returning empty string"),"";let S=0;for(let Oe=0;Oe<ce;Oe++){const ye=d[Oe];S+=ye.durationHours*60+ye.durationMinutes}console.log(`Total minutes for index ${ce}: ${S}`);const[A,W]=f.split(":").map(Number),H=new Date;H.setHours(A,W+S,0,0);const K=H.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return console.log(`Calculated start time for index ${ce}: ${K}`),K},_=ce=>({"PreShow/End":"#8B5CF6","Podium Transition":"#8B4513","Panel Transition":"#404040","Sub Cue":"#F3F4F6","No Transition":"#059669",Video:"#F59E0B","Panel+Remote":"#1E40AF","Remote Only":"#60A5FA",Break:"#EC4899",TBD:"#6B7280",KILLED:"#DC2626",Podium:"#FFFFFF",Panel:"#FFFFFF"})[ce]||"#D3D3D3",ne=ce=>ce==="Panel Transition"||ce==="Podium Transition"||ce==="Panel"||ce==="Podium"?"#FFFFFF":_(ce),ee=()=>{const ce=g==="showfile",S=g==="speakers",A=w,W=d.filter(H=>(H.day||1)===b);if(console.log("=== GENERATING REPORT ==="),console.log("Report type:",g),console.log("Selected day:",b),console.log("Total schedule items:",d.length),console.log("Filtered schedule items:",W.length),console.log("Sample item:",W[0]),console.log("Master start time:",f),W.length>0){const H=d.findIndex(Oe=>Oe.id===W[0].id),K=G(H);console.log("Test start time calculation:",{testIndex:H,testStartTime:K,item:W[0].segmentName})}if(ce){let H=`
        <!DOCTYPE html>
        <html>
        <head>
          <title>ROS Show File - ${i?.name||"Event"}</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 0; 
              padding: 15px;
              font-size: 11px;
              line-height: 1.3;
              background: white;
            }
            @media print {
              body { 
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
              * {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
            }
            .header { 
              text-align: center; 
              margin-bottom: 15px; 
            }
            .header h1 { 
              font-size: 16px; 
              margin: 0; 
              color: #000;
              font-weight: normal;
            }
            .header h2 { 
              font-size: 12px; 
              margin: 3px 0 0 0; 
              color: #333; 
              font-weight: normal;
            }
            .event-info { 
              background: #f5f5f5; 
              padding: 8px; 
              margin-bottom: 12px; 
              font-size: 10px;
              border: 1px solid #ddd;
            }
            .section { 
              margin-bottom: 8px; 
              border: 1px solid #000;
              page-break-inside: avoid;
            }
            .section-header { 
              padding: 6px 8px; 
              font-weight: normal; 
              font-size: 11px;
              color: white;
              background: #366092;
              border-bottom: 1px solid #000;
            }
            .section-content { 
              padding: 0; 
              background: white;
            }
            .modal-table { 
              width: 100%;
              border-collapse: collapse;
              border: 2px solid #000;
              background: white;
            }
            .modal-table td { 
              border: 1px solid #000; 
              padding: 6px 8px; 
              background: white;
              vertical-align: top;
            }
            .modal-table .header-cell { 
              background: #d9d9d9; 
              font-weight: normal; 
              text-align: center;
              font-size: 10px;
              width: 70px;
              min-width: 70px;
            }
            .modal-table .segment-cell { 
              min-width: 180px;
              max-width: 250px;
              word-wrap: break-word;
              font-size: 11px;
            }
            .modal-table .notes-cell { 
              background: #f0f0f0; 
              min-height: 35px;
              min-width: 200px;
              font-size: 10px;
            }
            .modal-table         .participants-cell { 
          background: #f0f0f0; 
          min-height: 60px;
          min-width: 600px;
          width: 600px;
          max-width: 600px;
        }
            .modal-table .start-time-cell { 
              background: #e7f3ff; 
              font-weight: normal;
              font-size: 12px;
            }
            .times-cell {
              background: #e7f3ff;
              font-weight: normal;
              text-align: center;
              vertical-align: middle;
              width: 80px;
              min-width: 80px;
            }
            .times-content {
              display: flex;
              flex-direction: column;
              gap: 2px;
            }
            .start-time {
              font-size: 11px;
              font-weight: normal;
              color: #000;
            }
            .duration {
              font-size: 11px;
              font-weight: normal;
              color: #000;
            }
            .time-label {
              font-size: 9px;
              font-weight: normal;
              color: #333;
              margin-right: 4px;
            }
            .simple-table { 
              width: 100%;
              border-collapse: collapse;
              border: 1px solid #000;
              background: white;
            }
            .simple-table td { 
              border: 1px solid #000; 
              padding: 8px; 
              background: white;
              vertical-align: top;
              font-size: 11px;
            }
        .simple-table .header-cell { 
          background: #d9d9d9; 
          font-weight: normal; 
          text-align: center;
          font-size: 10px;
        }
        .stacked-header {
          width: 300px;
        }
        .stacked-cell {
          width: 300px;
          max-width: 300px;
          vertical-align: top;
          padding: 8px;
        }
        .stacked-item {
          margin-bottom: 8px;
          padding-bottom: 6px;
          border-bottom: 1px solid #e0e0e0;
          display: flex;
          flex-direction: column;
        }
        .stacked-item:last-child {
          border-bottom: none;
          margin-bottom: 0;
          padding-bottom: 0;
        }
        .stacked-label {
          font-weight: normal;
          font-size: 9px;
          color: #333;
          margin-bottom: 3px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        .stacked-value {
          font-size: 10px;
          line-height: 1.3;
          word-wrap: break-word;
          color: #000;
          padding-left: 4px;
        }
        .slot-cell {
          width: 75px;
          height: 155px;
          vertical-align: top;
          min-width: 75px;
          max-width: 75px;
        }
        .slot-container {
          height: 155px;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          padding: 4px;
        }
        .slot-top {
          display: flex;
          flex-direction: column;
          align-items: center;
        }
        .slot-name {
          font-weight: normal;
          font-size: 11px;
          line-height: 1.2;
        }
        .slot-title {
          font-size: 10px;
          line-height: 1.1;
          color: #666;
        }
        .slot-org {
          font-size: 10px;
          line-height: 1.1;
          color: #666;
        }
        .slot-photo {
          display: flex;
          align-items: center;
          justify-content: center;
          margin-top: 8px;
        }
        .slot-photo-img {
          width: 50px;
          height: 65px;
          object-fit: cover;
          border-radius: 4px;
          border: 1px solid #ccc;
          margin: 0 auto;
        }
        .slot-text {
          margin-top: 4px;
          text-align: center;
          font-size: 9px;
          line-height: 1.2;
          color: #000;
          max-height: 90px;
          overflow: hidden;
        }
        .slot-name {
          font-weight: bold;
          font-size: 8px;
          margin-bottom: 2px;
          white-space: normal;
          word-wrap: break-word;
          text-align: center;
          line-height: 1.0;
          max-height: 18px;
          overflow: hidden;
        }
        .slot-name-small {
          font-weight: bold;
          font-size: 7px;
          margin-bottom: 2px;
          white-space: normal;
          word-wrap: break-word;
          text-align: center;
          line-height: 1.0;
          max-height: 16px;
          overflow: hidden;
        }
        .slot-title {
          font-size: 8px;
          color: #333;
          margin-bottom: 2px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .slot-org {
          font-size: 8px;
          color: #666;
          margin-bottom: 2px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .slot-role {
          font-size: 8px;
          color: #000;
          font-weight: bold;
          background-color: #f0f0f0;
          border: 1px solid #ccc;
          border-radius: 3px;
          padding: 1px 3px;
          margin-top: 2px;
          white-space: normal;
          word-wrap: break-word;
          text-align: center;
          min-height: 10px;
        }
        .notes-header-row {
          background: #e0e0e0;
        }
        .notes-header-cell {
          padding: 6px 8px;
          font-size: 10px;
          font-weight: normal;
          text-align: center;
          border-top: 2px solid #ddd;
          background: #e0e0e0;
        }
        .notes-content-row {
          background: #f9f9f9;
        }
        .notes-content-cell {
          padding: 8px;
          font-size: 10px;
          line-height: 1.3;
          background: #f9f9f9;
        }
            .modal-cell .field-label { 
              font-weight: normal; 
              font-size: 11px; 
              color: #333; 
              margin-bottom: 4px;
            }
            .modal-cell .field-value { 
              font-size: 12px; 
              color: #000;
              line-height: 1.3;
            }
            .speaker-item { 
              display: flex; 
              align-items: center; 
              margin-bottom: 6px;
              padding: 6px;
              background: white;
              border: 1px solid #ddd;
              border-radius: 4px;
              box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            }
            .speaker-photo { 
              width: 40px; 
              height: 40px; 
              border-radius: 4px; 
              object-fit: cover; 
              border: 2px solid #007acc;
              margin-right: 10px;
              flex-shrink: 0;
            }
            .speaker-info { 
              flex: 1;
            }
            .speaker-badges { 
              display: flex; 
              gap: 4px;
              margin-bottom: 3px;
            }
            .speaker-name { 
              font-weight: normal; 
              font-size: 11px; 
              color: #000;
              margin-bottom: 2px;
            }
            .slot-badge { 
              background: #007acc; 
              color: white; 
              padding: 2px 6px; 
              border-radius: 6px; 
              font-size: 8px; 
              font-weight: normal;
            }
            .location-badge { 
              background: #28a745; 
              color: white; 
              padding: 2px 6px; 
              border-radius: 6px; 
              font-size: 8px; 
              font-weight: normal;
            }
            .speaker-title { 
              color: #666; 
              font-size: 10px;
              margin-bottom: 1px;
            }
            .speaker-org { 
              color: #888; 
              font-size: 9px;
            }
            .footer { 
              margin-top: 40px; 
              text-align: center; 
              color: #666; 
              font-size: 12px;
              border-top: 1px solid #ddd;
              padding-top: 20px;
            }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
              @page { 
                size: A4 ${A}; 
                margin: 0.2in; 
              }
              .section { 
                page-break-inside: avoid;
              }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>ROS SHOW FILE</h1>
            <h2>${i?.name||"Event"}${i?.numberOfDays&&i.numberOfDays>1?` - Day ${b}`:""}</h2>
          </div>
          
      `;return W.forEach((K,Oe)=>{const ye=d.findIndex(j=>j.id===K.id),Pe=G(ye),ve=`${K.durationHours.toString().padStart(2,"0")}:${K.durationMinutes.toString().padStart(2,"0")}:${K.durationSeconds.toString().padStart(2,"0")}`,Ge=_(K.programType||"");console.log(`SHOW FILE - Item ${Oe} (${K.segmentName}):`,{originalIndex:ye,startTime:Pe,duration:ve,masterStartTime:f,itemId:K.id});let ie=[];if(K.speakersText)try{ie=JSON.parse(K.speakersText),console.log(`Speakers parsed for item ${Oe} (${K.segmentName}):`,ie),ie.forEach((j,X)=>{console.log(`  Speaker ${X+1}:`,{fullName:j.fullName,photoLink:j.photoLink,photoUrl:j.photoUrl,hasPhoto:!!(j.photoLink||j.photoUrl)})})}catch(j){console.log(`Error parsing speakers for item ${Oe}:`,j),ie=[{fullName:K.speakersText,title:"",org:"",photoLink:""}]}else console.log(`No speakersText for item ${Oe}:`,K.segmentName);let Ee="";K.hasPPT&&K.hasQA?Ee="PPT + Q&A":K.hasPPT?Ee="PPT":K.hasQA?Ee="Q&A":Ee="None",H+=`
          <div class="section">
            <div class="section-content">
              <table class="simple-table">
                <tr>
                  <td class="header-cell">CUE</td>
                  <td class="header-cell">TIME</td>
                  <td class="header-cell stacked-header">SEGMENT INFO</td>
                  <td class="header-cell">SLOT 1</td>
                  <td class="header-cell">SLOT 2</td>
                  <td class="header-cell">SLOT 3</td>
                  <td class="header-cell">SLOT 4</td>
                  <td class="header-cell">SLOT 5</td>
                  <td class="header-cell">SLOT 6</td>
                  <td class="header-cell">SLOT 7</td>
                </tr>
                <tr>
                  <td>
                    <div style="margin-bottom: 4px;">${K.customFields.cue||`CUE ${Oe+1}`}</div>
                    <div style="background-color: ${Ge}; color: ${K.programType==="Sub Cue"?"black":"white"}; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: normal; display: inline-block; ${K.programType==="Sub Cue"?"border: 1px solid #000000;":""}">${K.programType||"Unknown"}</div>
                  </td>
                  <td class="times-cell">
                    <div class="times-content">
                      <div class="start-time">
                        <span class="time-label">Start:</span> ${Pe}
                      </div>
                      <div class="duration">
                        <span class="time-label">Dur:</span> ${ve}
                      </div>
                    </div>
                  </td>
                  <td class="stacked-cell">
                    <div class="stacked-item">
                      <div class="stacked-label">SEGMENT:</div>
                      <div class="stacked-value">${K.segmentName||"Untitled Segment"}</div>
                    </div>
                    <div class="stacked-item">
                      <div class="stacked-label">SHOT:</div>
                      <div class="stacked-value">${K.shotType||"Not specified"}</div>
                    </div>
                    <div class="stacked-item">
                      <div class="stacked-label">PPT/Q&A:</div>
                      <div class="stacked-value">${Ee}</div>
                    </div>
                  </td>
        `;const Ce=["","","","","","",""];ie.length>0&&ie.forEach((j,X)=>{const T=j.fullName||j.name||"Unknown",O=j.title||"",P=j.org||"",F=j.slot||1,de=j.location||"Podium",fe=j.photoLink||j.photoUrl||"",ge=U(O,15),ze=U(P,15);console.log(`    Processing speaker ${X+1} (${T}): photoLink="${fe}"`);const oe=q(T),Tt=oe.needsSmallText?"slot-name-small":"slot-name";let ft=`
              <div class="slot-container">
                <div class="slot-top">
                  <div class="slot-photo">${fe?`<img src="${fe}" alt="${T}" class="slot-photo-img" />`:""}</div>
                  <div class="slot-text">
                    <div class="${Tt}">${oe.html}</div>
                    <div class="slot-title">${ge}...</div>
                    <div class="slot-org">${ze}...</div>
                  </div>
                </div>
                <div class="slot-role">${de}</div>
              </div>
            `;const xt=Math.min(F-1,6);xt>=0&&xt<7&&(Ce[xt]=ft)});for(let j=0;j<7;j++)H+=`<td class="slot-cell">${Ce[j]||""}</td>`;H+=`
                </tr>
                <tr class="notes-header-row">
                  <td colspan="11" class="notes-header-cell">NOTES</td>
                </tr>
                <tr class="notes-content-row">
                  <td colspan="11" class="notes-content-cell">${K.notes||"None"}</td>
                </tr>
              </table>
            </div>
          </div>
        `}),H+=`
          <div class="footer">
            <p>Generated: ${new Date().toLocaleString()} | Run of Show Application</p>
          </div>
        </body>
        </html>
      `,H}else if(S){let H=`
        <!DOCTYPE html>
        <html>
        <head>
          <title>ROS Show File - ${i?.name||"Event"}</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 0; 
              padding: 15px;
              font-size: 11px;
              line-height: 1.3;
              background: white;
            }
            @media print {
              body { 
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
              * {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
            }
            .header { 
              text-align: center; 
              margin-bottom: 15px; 
            }
            .header h1 { 
              font-size: 16px; 
              margin: 0; 
              color: #000;
              font-weight: normal;
            }
            .header h2 { 
              font-size: 12px; 
              margin: 3px 0 0 0; 
              color: #333; 
              font-weight: normal;
            }
            .event-info { 
              background: #f5f5f5; 
              padding: 8px; 
              margin-bottom: 12px; 
              font-size: 10px;
              border: 1px solid #ddd;
            }
            .section { 
              margin-bottom: 8px; 
              border: 1px solid #000;
              page-break-inside: avoid;
            }
            .section-header { 
              padding: 6px 8px; 
              font-weight: normal; 
              font-size: 11px;
              color: white;
              background: #366092;
              border-bottom: 1px solid #000;
            }
            .section-content { 
              padding: 0; 
              background: white;
            }
            .modal-table { 
              width: 100%;
              border-collapse: collapse;
              border: 2px solid #000;
              background: white;
            }
            .modal-table td { 
              border: 1px solid #000; 
              padding: 6px 8px; 
              background: white;
              vertical-align: top;
            }
            .modal-table .header-cell { 
              background: #d9d9d9; 
              font-weight: normal; 
              text-align: center;
              font-size: 10px;
              width: 70px;
              min-width: 70px;
            }
            .modal-table .segment-cell { 
              min-width: 180px;
              max-width: 250px;
              word-wrap: break-word;
              font-size: 11px;
            }
            .modal-table .notes-cell { 
              background: #f0f0f0; 
              min-height: 35px;
              min-width: 200px;
              font-size: 10px;
            }
            .modal-table         .participants-cell { 
          background: #f0f0f0; 
          min-height: 60px;
          min-width: 600px;
          width: 600px;
          max-width: 600px;
        }
            .modal-table .start-time-cell { 
              background: #e7f3ff; 
              font-weight: normal;
              font-size: 12px;
            }
            .times-cell {
              background: #e7f3ff;
              font-weight: normal;
              text-align: center;
              vertical-align: middle;
              width: 80px;
              min-width: 80px;
            }
            .times-content {
              display: flex;
              flex-direction: column;
              gap: 2px;
            }
            .start-time {
              font-size: 11px;
              font-weight: normal;
              color: #000;
            }
            .duration {
              font-size: 11px;
              font-weight: normal;
              color: #000;
            }
            .time-label {
              font-size: 9px;
              font-weight: normal;
              color: #333;
              margin-right: 4px;
            }
            .simple-table { 
              width: 100%;
              border-collapse: collapse;
              border: 1px solid #000;
              background: white;
            }
            .simple-table td { 
              border: 1px solid #000; 
              padding: 8px; 
              background: white;
              vertical-align: top;
              font-size: 11px;
            }
        .simple-table .header-cell { 
          background: #d9d9d9; 
          font-weight: normal; 
          text-align: center;
          font-size: 10px;
        }
        .stacked-header {
          width: 300px;
        }
        .stacked-cell {
          width: 300px;
          max-width: 300px;
          vertical-align: top;
          padding: 8px;
        }
        .stacked-item {
          margin-bottom: 8px;
          padding-bottom: 6px;
          border-bottom: 1px solid #e0e0e0;
          display: flex;
          flex-direction: column;
        }
        .stacked-item:last-child {
          border-bottom: none;
          margin-bottom: 0;
          padding-bottom: 0;
        }
        .stacked-label {
          font-weight: normal;
          font-size: 9px;
          color: #333;
          margin-bottom: 3px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        .stacked-value {
          font-size: 10px;
          line-height: 1.3;
          word-wrap: break-word;
          color: #000;
          padding-left: 4px;
        }
        .slot-cell {
          width: 75px;
          height: 155px;
          vertical-align: top;
          min-width: 75px;
          max-width: 75px;
        }
        .slot-container {
          height: 155px;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          padding: 4px;
        }
        .slot-top {
          display: flex;
          flex-direction: column;
          align-items: center;
        }
        .slot-name {
          font-weight: normal;
          font-size: 11px;
          line-height: 1.2;
        }
        .slot-title {
          font-size: 10px;
          line-height: 1.1;
          color: #666;
        }
        .slot-org {
          font-size: 10px;
          line-height: 1.1;
          color: #666;
        }
        .slot-photo {
          display: flex;
          align-items: center;
          justify-content: center;
          margin-top: 8px;
        }
        .slot-photo-img {
          width: 50px;
          height: 65px;
          object-fit: cover;
          border-radius: 4px;
          border: 1px solid #ccc;
          margin: 0 auto;
        }
        .slot-text {
          margin-top: 4px;
          text-align: center;
          font-size: 9px;
          line-height: 1.2;
          color: #000;
          max-height: 90px;
          overflow: hidden;
        }
        .slot-name {
          font-weight: bold;
          font-size: 8px;
          margin-bottom: 2px;
          white-space: normal;
          word-wrap: break-word;
          text-align: center;
          line-height: 1.0;
          max-height: 18px;
          overflow: hidden;
        }
        .slot-name-small {
          font-weight: bold;
          font-size: 7px;
          margin-bottom: 2px;
          white-space: normal;
          word-wrap: break-word;
          text-align: center;
          line-height: 1.0;
          max-height: 16px;
          overflow: hidden;
        }
        .slot-title {
          font-size: 8px;
          color: #333;
          margin-bottom: 2px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .slot-org {
          font-size: 8px;
          color: #666;
          margin-bottom: 2px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .slot-role {
          font-size: 8px;
          color: #000;
          font-weight: bold;
          background-color: #f0f0f0;
          border: 1px solid #ccc;
          border-radius: 3px;
          padding: 1px 3px;
          margin-top: 2px;
          white-space: normal;
          word-wrap: break-word;
          text-align: center;
          min-height: 10px;
        }
        .notes-header-row {
          background: #e0e0e0;
        }
        .notes-header-cell {
          padding: 6px 8px;
          font-size: 10px;
          font-weight: normal;
          text-align: center;
          border-top: 2px solid #ddd;
          background: #e0e0e0;
        }
        .notes-content-row {
          background: #f9f9f9;
        }
        .notes-content-cell {
          padding: 8px;
          font-size: 10px;
          line-height: 1.3;
          background: #f9f9f9;
        }
            .modal-cell .field-label { 
              font-weight: normal; 
              font-size: 11px; 
              color: #333; 
              margin-bottom: 4px;
            }
            .modal-cell .field-value { 
              font-size: 12px; 
              color: #000;
              line-height: 1.3;
            }
            .speaker-item { 
              display: flex; 
              align-items: center; 
              margin-bottom: 6px;
              padding: 6px;
              background: white;
              border: 1px solid #ddd;
              border-radius: 4px;
              box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            }
            .speaker-photo { 
              width: 40px; 
              height: 40px; 
              border-radius: 4px; 
              object-fit: cover; 
              border: 2px solid #007acc;
              margin-right: 10px;
              flex-shrink: 0;
            }
            .speaker-info { 
              flex: 1;
            }
            .speaker-badges { 
              display: flex; 
              gap: 4px;
              margin-bottom: 3px;
            }
            .speaker-name { 
              font-weight: normal; 
              font-size: 11px; 
              color: #000;
              margin-bottom: 2px;
            }
            .slot-badge { 
              background: #007acc; 
              color: white; 
              padding: 2px 6px; 
              border-radius: 6px; 
              font-size: 8px; 
              font-weight: normal;
            }
            .location-badge { 
              background: #28a745; 
              color: white; 
              padding: 2px 6px; 
              border-radius: 6px; 
              font-size: 8px; 
              font-weight: normal;
            }
            .speaker-title { 
              color: #666; 
              font-size: 10px;
              margin-bottom: 1px;
            }
            .speaker-org { 
              color: #888; 
              font-size: 9px;
            }
            .footer { 
              margin-top: 40px; 
              text-align: center; 
              color: #666; 
              font-size: 12px;
              border-top: 1px solid #ddd;
              padding-top: 20px;
            }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
              @page { 
                size: A4 ${A}; 
                margin: 0.2in; 
              }
              .section { 
                page-break-inside: avoid;
              }
            }
            /* Speaker subtext styling - smaller font for titles and organizations */
            .speaker-subtext {
              font-size: 10px;
              color: #000;
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>ROS SPEAKERS</h1>
            <h2>${i?.name||"Event"}${i?.numberOfDays&&i.numberOfDays>1?` - Day ${b}`:""}</h2>
          </div>
          
      `;return W.forEach((K,Oe)=>{const ye=d.findIndex(X=>X.id===K.id),Pe=G(ye),ve=`${K.durationHours.toString().padStart(2,"0")}:${K.durationMinutes.toString().padStart(2,"0")}:${K.durationSeconds.toString().padStart(2,"0")}`,Ge=_(K.programType||"");console.log(`SPEAKERS - Item ${Oe} (${K.segmentName}):`,{originalIndex:ye,startTime:Pe,duration:ve,masterStartTime:f,itemId:K.id});let ie=[];if(K.speakersText)try{ie=JSON.parse(K.speakersText),console.log(`Speakers parsed for item ${Oe}:`,ie)}catch(X){console.log(`Error parsing speakers for item ${Oe}:`,X),ie=[{fullName:K.speakersText,title:"",org:"",photoLink:""}]}else console.log(`No speakersText for item ${Oe}:`,K.segmentName);let Ee="";K.hasPPT&&K.hasQA?Ee="PPT + Q&A":K.hasPPT?Ee="PPT":K.hasQA?Ee="Q&A":Ee="None",H+=`
          <div class="section">
            <div class="section-content">
              <table class="simple-table">
                <tr>
                  <td class="header-cell">CUE & TIME</td>
                  <td class="header-cell stacked-header">SEGMENT INFO</td>
                  <td class="header-cell">PARTICIPANTS</td>
                  <td class="header-cell">SLOT 1</td>
                  <td class="header-cell">SLOT 2</td>
                  <td class="header-cell">SLOT 3</td>
                  <td class="header-cell">SLOT 4</td>
                  <td class="header-cell">SLOT 5</td>
                  <td class="header-cell">SLOT 6</td>
                  <td class="header-cell">SLOT 7</td>
                </tr>
                <tr>
                  <td class="times-cell">
                    <div style="margin-bottom: 4px; font-weight: bold;">${K.customFields.cue||`CUE ${Oe+1}`}</div>
                    <div style="background-color: ${Ge}; color: ${K.programType==="Sub Cue"?"black":"white"}; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: normal; display: inline-block; ${K.programType==="Sub Cue"?"border: 1px solid #000000;":""}">${K.programType||"Unknown"}</div>
                    <div class="times-content" style="margin-top: 6px;">
                      <div class="start-time">
                        <span class="time-label">Start:</span> ${Pe}
                      </div>
                      <div class="duration">
                        <span class="time-label">Dur:</span> ${ve}
                      </div>
                    </div>
                  </td>
                  <td class="stacked-cell">
                    <div class="stacked-item">
                      <div class="stacked-label">SEGMENT:</div>
                      <div class="stacked-value">${K.segmentName||"Untitled Segment"}</div>
                    </div>
                    <div class="stacked-item">
                      <div class="stacked-label">SHOT:</div>
                      <div class="stacked-value">${K.shotType||"Not specified"}</div>
                    </div>
                    <div class="stacked-item">
                      <div class="stacked-label">PPT/Q&A:</div>
                      <div class="stacked-value">${Ee}</div>
                    </div>
                  </td>
                  <td class="participants-cell">
        `;let Ce="";ie.length>0&&(Ce=ie.map(X=>{const T=X.fullName||X.name||X,O=X.title||"",P=X.org||"",F=X.location||"Podium",de=X.slot||1;let ge=`<strong>${F==="Podium"?"P":F==="Seat"?"S":"V"}${de} - ${T}</strong>`;if(O||P){const ze=[O,P].filter(Boolean).join(", ");ge+=`<br><span class="speaker-subtext">${ze}</span>`}return ge}).join("<br><br>")),H+=Ce||"No speakers assigned",H+=`
                  </td>
        `;const j=["","","","","","",""];ie.length>0&&ie.forEach((X,T)=>{const O=X.fullName||X.name||"Unknown",P=X.title||"",F=X.org||"",de=X.slot||1,fe=X.location||"Podium",ge=X.photoLink||X.photoUrl||"";U(P,15),U(F,15),console.log(`    Processing speaker ${T+1} (${O}): photoLink="${ge}"`);let ze=`
              <div class="slot-container">
                <div class="slot-top">
                  <div class="slot-photo">${ge?`<img src="${ge}" alt="${O}" class="slot-photo-img" />`:""}</div>
                </div>
                <div class="slot-role">${fe}</div>
              </div>
            `;const oe=Math.min(de-1,6);oe>=0&&oe<7&&(j[oe]=ze)});for(let X=0;X<7;X++)H+=`<td class="slot-cell">${j[X]||""}</td>`;H+=`
                </tr>
                <tr class="notes-header-row">
                  <td colspan="11" class="notes-header-cell">NOTES</td>
                </tr>
                <tr class="notes-content-row">
                  <td colspan="11" class="notes-content-cell">${K.notes||"None"}</td>
                </tr>
              </table>
            </div>
          </div>
        `}),H+=`
          <div class="footer">
            <p>Generated: ${new Date().toLocaleString()} | Run of Show Application</p>
          </div>
        </body>
        </html>
      `,H}else{let H=`
        <!DOCTYPE html>
        <html>
        <head>
          <title>Run of Show Report - ${i?.name||"Event"}</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 20px; 
              font-size: 14px;
            }
            .header { 
              text-align: center; 
              margin-bottom: 30px; 
            }
            .header h1 { 
              font-size: 24px; 
              margin: 0; 
            }
            .header h2 { 
              font-size: 18px; 
              margin: 5px 0 0 0; 
              color: #666; 
            }
            .event-info { 
              background: #f5f5f5; 
              padding: 15px; 
              border-radius: 5px; 
              margin-bottom: 20px; 
              font-size: 12px;
            }
            table { 
              width: 100%; 
              border-collapse: collapse; 
              margin-top: 20px; 
            }
            th, td { 
              border: 1px solid #ddd; 
              padding: 8px; 
              text-align: left; 
              font-size: 12px;
            }
            /* Column width specifications */
            th:nth-child(1), td:nth-child(1) { width: 8%; }  /* CUE */
            th:nth-child(2), td:nth-child(2) { width: 8%; } /* START */
            th:nth-child(3), td:nth-child(3) { width: 8%; } /* DURATION */
            th:nth-child(4), td:nth-child(4) { width: 20%; } /* SEGMENT */
            th:nth-child(5), td:nth-child(5) { width: 10%; } /* SHOT/PPT */
            th:nth-child(6), td:nth-child(6) { width: 26%; } /* PARTICIPANTS */
            th:nth-child(7), td:nth-child(7) { width: 20%; } /* NOTES */
            
            /* Speaker subtext styling - smaller font for titles and organizations */
            .speaker-subtext {
              font-size: 10px;
              color: #000;
            }
            th { 
              background-color: #f2f2f2; 
              font-weight: normal; 
            }
            tr { 
              -webkit-print-color-adjust: exact !important;
              color-adjust: exact !important;
              print-color-adjust: exact !important;
            }
            .footer { 
              margin-top: 30px; 
              text-align: center; 
              color: #666; 
              font-size: 12px;
            }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
              @page { 
                size: A4 ${A}; 
                margin: 0.2in; 
              }
              tr { 
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
              }
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>RUN OF SHOW REPORT</h1>
            <h2>${i?.name||"Event"}${i?.numberOfDays&&i.numberOfDays>1?` - Day ${b}`:""}</h2>
            <h3>ROS CONDENSED</h3>
          </div>
          
          <div class="event-info">
            <p><strong>Event:</strong> ${i?.name||"Current Event"} | 
               <strong>Date:</strong> ${i?.date||"Not specified"} | 
               <strong>Location:</strong> ${i?.location||"Not specified"} | 
               <strong>Start Time:</strong> ${f||"Not set"} | 
               <strong>Total Items:</strong> ${d.length}</p>
          </div>
          
          <table>
            <thead>
              <tr>
                <th>CUE</th>
                <th>START</th>
                <th>DURATION</th>
                <th>SEGMENT</th>
                <th>SHOT/PPT</th>
                <th>PARTICIPANTS</th>
                <th>NOTES</th>
              </tr>
            </thead>
            <tbody>
      `;return W.forEach((K,Oe)=>{const ye=d.findIndex(X=>X.id===K.id),Pe=G(ye),ve=`${K.durationHours.toString().padStart(2,"0")}:${K.durationMinutes.toString().padStart(2,"0")}:${K.durationSeconds.toString().padStart(2,"0")}`;_(K.programType||"");let Ge="";if(K.speakersText)try{Ge=JSON.parse(K.speakersText).map(T=>{const O=T.fullName||T.name||T,P=T.title||"",F=T.org||"",de=T.location||"Podium",fe=T.slot||1;let ze=`<strong>${de==="Podium"?"P":de==="Seat"?"S":"V"}${fe} - ${O}</strong>`;if(P||F){const oe=[P,F].filter(Boolean).join(", ");ze+=`<br><span class="speaker-subtext">${oe}</span>`}return ze}).join("<br><br>")}catch{Ge=K.speakersText}let ie="";const Ee=K.shotType||"";let Ce="";K.hasPPT&&K.hasQA?Ce="PPT + Q&A":K.hasPPT?Ce="PPT":K.hasQA?Ce="Q&A":Ce="",Ee&&Ce?ie=`${Ee} | ${Ce}`:Ee?ie=Ee:Ce?ie=Ce:ie="";let j="";if(K.notes){const X=K.notes.replace(/<[^>]*>/g,"").trim();X&&X.length>0&&X!=="None"&&X!=="null"&&X!=="undefined"&&(j=X)}H+=`
          <tr style="background-color: ${ne(K.programType)};">
            <td>${K.programType==="Sub Cue"?`<span style="background-color: #9CA3AF; color: white; padding: 2px 6px; border-radius: 4px; font-weight: bold;">${K.customFields?.cue||""}</span>`:K.programType==="Podium"||K.programType==="Podium Transition"?`<span style="background-color: #8B4513; color: white; padding: 2px 6px; border-radius: 4px; font-weight: bold;">${K.customFields?.cue||""}</span>`:K.programType==="Panel"||K.programType==="Panel Transition"?`<span style="background-color: #404040; color: white; padding: 2px 6px; border-radius: 4px; font-weight: bold;">${K.customFields?.cue||""}</span>`:K.customFields?.cue||""}</td>
            <td>${Pe}</td>
            <td>${ve}</td>
            <td>${K.segmentName||"Untitled Segment"}</td>
            <td>${ie}</td>
            <td style="white-space: pre-line;">${Ge}</td>
            <td style="white-space: pre-line; font-size: 12px;">${j}</td>
          </tr>
        `}),H+=`
            </tbody>
          </table>
          
          <div class="footer">
            <p>Generated: ${new Date().toLocaleString()} | Run of Show Application</p>
          </div>
        </body>
        </html>
      `,H}},Q=()=>{const ce=ee(),S=window.open("","_blank");S&&(S.document.write(ce),S.document.close(),S.focus(),S.print())},z=()=>{const ce=ee(),S=new Blob([ce],{type:"text/html"}),A=URL.createObjectURL(S),W=document.createElement("a");W.href=A,W.download=`ros-${g==="showfile"?"show-file":g==="speakers"?"speakers":"condensed"}${i?.numberOfDays&&i.numberOfDays>1?`-day-${b}`:""}-${i?.name?.replace(/\s+/g,"-")||"event"}-${new Date().toISOString().split("T")[0]}.html`,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(A)};return l.jsxDEV("div",{className:"min-h-screen bg-slate-900 text-white pt-16",children:[l.jsxDEV("div",{className:"bg-slate-800 border-b border-slate-700",children:l.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxDEV("div",{className:"flex items-center justify-between h-16",children:[l.jsxDEV("div",{className:"flex items-center",children:[l.jsxDEV("button",{onClick:()=>{window.close()},className:"text-slate-300 hover:text-white transition-colors mr-6",children:" Back to Run of Show"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1788,columnNumber:15},void 0),l.jsxDEV("h1",{className:"text-xl font-semibold",children:"Reports and Printing"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1797,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1787,columnNumber:13},void 0),l.jsxDEV("div",{className:"text-slate-400",children:i?.name||"Event"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1799,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1786,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1785,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1784,columnNumber:7},void 0),l.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxDEV("div",{className:"bg-slate-800 rounded-xl p-8 shadow-2xl",children:[l.jsxDEV("h2",{className:"text-2xl font-bold text-white mb-6",children:"Generate Reports"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1809,columnNumber:11},void 0),l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-6 mb-8",children:[l.jsxDEV("h3",{className:"text-lg font-semibold text-white mb-4",children:"Report Options"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1813,columnNumber:13},void 0),l.jsxDEV("div",{className:"relative",children:l.jsxDEV("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[l.jsxDEV("div",{className:"space-y-6",children:[l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Report Type"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1820,columnNumber:21},void 0),l.jsxDEV("select",{value:g,onChange:ce=>x(ce.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsxDEV("option",{value:"showfile",children:"ROS Show File"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1828,columnNumber:23},void 0),l.jsxDEV("option",{value:"condensed",children:"ROS CONDENSED"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1829,columnNumber:23},void 0),l.jsxDEV("option",{value:"speakers",children:"ROS Speakers"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1830,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1823,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1819,columnNumber:19},void 0),l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Print Orientation"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1836,columnNumber:21},void 0),l.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxDEV("label",{className:`flex items-center justify-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${w==="portrait"?"border-blue-500 bg-blue-500/20 text-blue-300":"border-slate-500 bg-slate-600/50 text-slate-300 hover:border-slate-400 hover:bg-slate-600/70"}`,children:[l.jsxDEV("input",{type:"radio",name:"orientation",value:"portrait",checked:w==="portrait",onChange:ce=>R(ce.target.value),className:"sr-only"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1845,columnNumber:25},void 0),l.jsxDEV("div",{className:"flex flex-col items-center",children:[l.jsxDEV("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsxDEV("rect",{x:"3",y:"3",width:"18",height:"24",rx:"2",strokeWidth:"2"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1855,columnNumber:29},void 0),l.jsxDEV("path",{d:"M8 7h8M8 11h8M8 15h4",strokeWidth:"1.5"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1856,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1854,columnNumber:27},void 0),l.jsxDEV("span",{className:"text-sm font-medium",children:"Portrait"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1858,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1853,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1840,columnNumber:23},void 0),l.jsxDEV("label",{className:`flex items-center justify-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${w==="landscape"?"border-blue-500 bg-blue-500/20 text-blue-300":"border-slate-500 bg-slate-600/50 text-slate-300 hover:border-slate-400 hover:bg-slate-600/70"}`,children:[l.jsxDEV("input",{type:"radio",name:"orientation",value:"landscape",checked:w==="landscape",onChange:ce=>R(ce.target.value),className:"sr-only"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1867,columnNumber:25},void 0),l.jsxDEV("div",{className:"flex flex-col items-center",children:[l.jsxDEV("svg",{className:"w-6 h-6 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsxDEV("rect",{x:"3",y:"3",width:"24",height:"18",rx:"2",strokeWidth:"2"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1877,columnNumber:29},void 0),l.jsxDEV("path",{d:"M7 8h10M7 12h10M7 16h6",strokeWidth:"1.5"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1878,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1876,columnNumber:27},void 0),l.jsxDEV("span",{className:"text-sm font-medium",children:"Landscape"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1880,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1875,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1862,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1839,columnNumber:21},void 0),l.jsxDEV("p",{className:"text-xs text-slate-400 mt-2",children:w==="landscape"?"Recommended for tables and wide content":"Better for text-heavy documents"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1884,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1835,columnNumber:19},void 0),i?.numberOfDays&&i.numberOfDays>1&&l.jsxDEV("div",{children:[l.jsxDEV("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Select Day"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1894,columnNumber:23},void 0),l.jsxDEV("select",{value:b,onChange:ce=>E(parseInt(ce.target.value)),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:Array.from({length:i.numberOfDays},(ce,S)=>l.jsxDEV("option",{value:S+1,children:["Day ",S+1]},S+1,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1903,columnNumber:27},void 0))},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1897,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1893,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1818,columnNumber:17},void 0),l.jsxDEV("div",{className:"flex items-center justify-center h-full",children:l.jsxDEV("div",{className:"bg-slate-600/30 rounded-lg p-4 border border-slate-500 w-full max-w-md",children:[l.jsxDEV("h4",{className:"text-lg font-semibold text-white mb-3 text-center",children:"Report Format Information"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1913,columnNumber:21},void 0),l.jsxDEV("div",{className:"space-y-2 text-sm",children:[l.jsxDEV("p",{children:[l.jsxDEV("span",{className:"text-blue-300 text-base",children:" ROS Show File:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1915,columnNumber:26},void 0)," Section-based format with speaker photos"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1915,columnNumber:23},void 0),l.jsxDEV("p",{children:[l.jsxDEV("span",{className:"text-green-300 text-base",children:" ROS CONDENSED:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1916,columnNumber:26},void 0)," Table format with all information"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1916,columnNumber:23},void 0),l.jsxDEV("p",{children:[l.jsxDEV("span",{className:"text-orange-300 text-base",children:" ROS Speakers:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1917,columnNumber:26},void 0)," Table format with dedicated speaker column"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1917,columnNumber:23},void 0),l.jsxDEV("p",{children:[l.jsxDEV("span",{className:"text-purple-300 text-base",children:" Color Coding:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1918,columnNumber:26},void 0)," Sections colored by program type"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1918,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1914,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1912,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1911,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1816,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1815,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1812,columnNumber:11},void 0),l.jsxDEV("div",{className:"flex flex-wrap gap-4",children:[l.jsxDEV("button",{onClick:Q,className:"px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:[l.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1934,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1933,columnNumber:15},void 0),"Print Report"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1929,columnNumber:13},void 0),l.jsxDEV("button",{onClick:z,className:"px-6 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:[l.jsxDEV("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1944,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1943,columnNumber:15},void 0),"Download Report"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1939,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1928,columnNumber:11},void 0),l.jsxDEV("div",{className:"mt-8",children:[l.jsxDEV("h3",{className:"text-lg font-semibold text-white mb-4",children:"Report Preview"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1952,columnNumber:13},void 0),l.jsxDEV("div",{className:"bg-slate-700 rounded-lg p-4 max-h-96 overflow-y-auto",children:l.jsxDEV("div",{className:"text-slate-300 text-sm",children:[l.jsxDEV("p",{children:[l.jsxDEV("strong",{children:"Event:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1955,columnNumber:20},void 0)," ",i?.name||"Current Event"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1955,columnNumber:17},void 0),l.jsxDEV("p",{children:[l.jsxDEV("strong",{children:"Total Items:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1956,columnNumber:20},void 0)," ",d.length,i?.numberOfDays&&i.numberOfDays>1?` | <strong>Day ${b} Items:</strong> ${d.filter(ce=>(ce.day||1)===b).length}`:""]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1956,columnNumber:17},void 0),l.jsxDEV("p",{children:[l.jsxDEV("strong",{children:"Master Start Time:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1957,columnNumber:20},void 0)," ",y(f)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1957,columnNumber:17},void 0),l.jsxDEV("p",{children:[l.jsxDEV("strong",{children:"Report Type:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1958,columnNumber:20},void 0)," ",g==="showfile"?"ROS Show File":g==="speakers"?"ROS Speakers":"ROS CONDENSED"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1958,columnNumber:17},void 0),l.jsxDEV("p",{children:[l.jsxDEV("strong",{children:"Format:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1959,columnNumber:20},void 0)," ",g==="showfile"?"Section-based with speaker photos":g==="speakers"?"Table format with dedicated speaker column":"Table format"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1959,columnNumber:17},void 0),l.jsxDEV("p",{children:[l.jsxDEV("strong",{children:"Orientation:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1960,columnNumber:20},void 0)," ",w==="landscape"?"Landscape (recommended for tables)":"Portrait"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1960,columnNumber:17},void 0),l.jsxDEV("p",{children:[l.jsxDEV("strong",{children:"Color Coding:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1961,columnNumber:20},void 0)," Sections colored by program type"]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1961,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1954,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1953,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1951,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1808,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1807,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/ReportsPage.tsx",lineNumber:1782,columnNumber:5},void 0)},g9=()=>{const t=Oa(),n=new URLSearchParams(t.search),e=n.get("eventId"),s=n.get("eventName"),i=n.get("eventDate"),d=n.get("eventLocation"),c=t.state?.event||{id:e||"",name:s||"Current Event",date:i||"",location:d||"",numberOfDays:1},[f,p]=I.useState([]),[g,x]=I.useState(new Date),[b,E]=I.useState(!0),[w,R]=I.useState(null),[y,U]=I.useState(null),[q,G]=I.useState({}),[_,ne]=I.useState(null),[ee,Q]=I.useState({}),[z,ce]=I.useState("09:00"),[S,A]=I.useState({}),[W,H]=I.useState(null),[K,Oe]=I.useState(new Set),ye=X=>{if(console.log(` calculateStartTime called for index ${X}:`,{masterStartTime:z,scheduleLength:f.length}),!z)return console.log(" No master start time, returning empty string"),"";let T=0;for(let ft=0;ft<X;ft++){const xt=f[ft];if(!xt){console.log(`  Item ${ft}: undefined/null item, skipping`);continue}const Dt=xt.durationHours||0,Ke=xt.durationMinutes||0,er=Dt*60+Ke;T+=er,console.log(`  Item ${ft} (${xt.segmentName||"Unknown"}): ${Dt}h ${Ke}m = ${er} total minutes`)}const[O,P]=z.split(":").map(Number),F=O*60+P,de=F+T,fe=Math.floor(de/60),ge=de%60,ze=fe>=12?"PM":"AM";let oe=fe;fe>12&&(oe=fe-12),fe===0&&(oe=12);const Tt=`${oe}:${ge.toString().padStart(2,"0")} ${ze}`;return console.log(` calculateStartTime result for index ${X}:`,{masterStartTime:z,totalMinutes:T,totalStartMinutes:F,finalMinutes:de,hours:fe,minutes:ge,period:ze,displayHours:oe,result:Tt}),Tt};I.useEffect(()=>{if(c?.id){console.log(" Loading master start time for event ID:",c.id);const X=localStorage.getItem(`masterStartTime_${c.id}`),T=localStorage.getItem(`dayStartTimes_${c.id}`);if(console.log(" Raw localStorage values:",{masterStartTime:X,dayStartTimes:T,eventId:c.id}),X)ce(X),console.log(" Loaded master start time from localStorage:",X);else{console.log(" No master start time found in localStorage for event:",c.id),console.log(" Available localStorage keys:",Object.keys(localStorage).filter(de=>de.includes("masterStartTime"))),console.log(" All localStorage keys:",Object.keys(localStorage));const O=Object.keys(localStorage).filter(de=>de.includes("masterStartTime")).map(de=>({key:de,value:localStorage.getItem(de)}));console.log(" All master start times in localStorage:",O);let P=null;const F=O.find(de=>de.value&&de.value!=="09:00");F?(P=F,console.log(" Found non-default master start time:",F.value)):(P=O.find(de=>de.value),console.log(" Using first available master start time:",P?.value)),P&&P.value?(console.log(" Setting master start time to:",P.value),ce(P.value)):(console.log(" No suitable master start time found in localStorage"),console.log(" Will try to get master start time from API data..."))}T?(A(JSON.parse(T)),console.log(" Loaded day start times from localStorage:",JSON.parse(T))):console.log(" No day start times found in localStorage for event:",c.id)}},[c?.id]),I.useEffect(()=>{const X=setInterval(()=>{x(new Date)},1e3);return()=>clearInterval(X)},[]);const Pe=async()=>{if(c?.id)try{console.log(" Loading active timer for Green Room...");const X=await it.getActiveTimer(c.id);X?(console.log(" Active timer found:",X),console.log(" Timer state:",X.timer_state),console.log(" Item ID:",X.item_id),U(parseInt(X.item_id)),ne(X.timer_state),Q({[parseInt(X.item_id)]:!0}),console.log(" Set loaded items:",{[parseInt(X.item_id)]:!0}),X.timer_state==="running"&&X.started_at&&console.log(` Green Room: Timer ${X.item_id} is running - WebSocket will handle updates`),G({[parseInt(X.item_id)]:{elapsed:X.elapsed_seconds||0,total:X.duration_seconds||0,startedAt:X.started_at?new Date(X.started_at):null}})):(console.log(" No active timer found"),U(null),ne(null),Q({}),G({}),W&&(clearInterval(W),H(null)))}catch(X){console.error(" Error loading active timer:",X)}};I.useEffect(()=>{if(!c?.id)return;Pe(),console.log(" Setting up WebSocket connection for Green Room timer updates");const X={onTimerUpdated:O=>{console.log(" Green Room: Timer updated via WebSocket"),O&&O.item_id&&G(P=>({...P,[O.item_id]:{elapsed:O.elapsed_seconds||0,total:O.duration_seconds||300,startedAt:O.started_at?new Date(O.started_at):null}}))},onTimerStopped:O=>{console.log(" Green Room: Timer stopped via WebSocket"),O&&O.item_id&&(U(null),G(P=>{const F={...P};return delete F[O.item_id],F}))},onTimersStopped:O=>{console.log(" Green Room: All timers stopped via WebSocket"),U(null),G({})},onTimerStarted:O=>{console.log(" Green Room: Timer started via WebSocket"),O&&O.item_id&&U(O.item_id)},onActiveTimersUpdated:O=>{console.log(" Green Room: Active timers updated via WebSocket",O),O&&O.item_id&&(O.timer_state==="running"||O.timer_state==="loaded"?(U(parseInt(O.item_id)),ne(O.timer_state),Q(P=>({...P,[O.item_id]:!0})),console.log(" Green Room: Updated active item and timer state:",{itemId:O.item_id,timerState:O.timer_state,activeItemId:O.item_id})):(Q(P=>{const F={...P};return delete F[O.item_id],F}),String(y)===String(O.item_id)&&(U(null),ne(null)),console.log(" Green Room: Cleared timer state for item:",O.item_id)))},onResetAllStates:O=>{console.log(" Green Room: Reset all states triggered via WebSocket",O),U(null),ne(null),Q({}),G({}),console.log(" Green Room: All states cleared via reset")},onConnectionChange:O=>{console.log(` Green Room WebSocket connection ${O?"established":"lost"} for event: ${c.id}`)},onInitialSync:async()=>{console.log(" Green Room: WebSocket initial sync triggered - loading current state");try{const O=await fetch(`https://ros-50-production.up.railway.app/api/active-timers/${c?.id}`);if(O.ok){const P=await O.json();if(console.log(" Green Room initial sync: Loaded active timers:",P),P&&P.length>0){const F=P[0];U(parseInt(F.item_id)),ne(F.timer_state),Q({[parseInt(F.item_id)]:!0}),G({[parseInt(F.item_id)]:{elapsed:F.elapsed_seconds||0,total:F.duration_seconds||300,startedAt:F.started_at?new Date(F.started_at):null}}),console.log(" Green Room: Initial sync completed - timer state restored")}else U(null),ne(null),Q({}),G({}),console.log(" Green Room: Initial sync completed - no active timer")}}catch(O){console.error(" Green Room: Initial sync failed to load active timer:",O)}}};_r.connect(c.id,X);const T=()=>{!document.hidden&&_r.isConnected()&&(console.log(" Green Room: Tab became visible - triggering resync"),X.onInitialSync?.())};return document.addEventListener("visibilitychange",T),()=>{console.log(" Cleaning up Green Room WebSocket connection"),_r.disconnect(c.id),document.removeEventListener("visibilitychange",T)}},[c?.id]),I.useEffect(()=>{if(!y||!q[y])return;const X=q[y];if(X.startedAt&&_==="running"){const T=X.startedAt,O=X.total;console.log(` Green Room: Starting continuous local timer for ${y} with duration ${O}s, start time: ${T.toISOString()}`);const P=setInterval(()=>{const F=new Date,de=Math.floor((F.getTime()-T.getTime())/1e3);G(fe=>({...fe,[y]:{...fe[y],elapsed:de}})),de<=10&&console.log(` Green Room Timer ${y}: Continuous elapsed=${de}s, Start=${T.toISOString()}, Now=${F.toISOString()}`)},1e3);return()=>{console.log(` Green Room: Stopping continuous local timer for ${y}`),clearInterval(P)}}},[y,_]),I.useEffect(()=>()=>{console.log(" Green Room: Cleaning up on component unmount"),W&&clearInterval(W)},[]);const ve=async()=>{console.log(" Green Room loadSchedule called"),console.log(" Event object:",c),console.log(" Event ID from URL params:",e),console.log(" Event ID from event object:",c?.id);const X=c?.id||e;if(!X){console.log(" No event ID found in event object or URL params"),R("No event selected"),E(!1);return}console.log(" Using event ID:",X);try{console.log(" Loading schedule for Green Room..."),console.log(" Event details:",{id:X,name:c.name,location:c.location});const T=await it.getRunOfShowData(X);if(console.log(" Raw data received:",T),T&&T.settings&&T.settings.masterStartTime&&z==="09:00"&&(console.log(" Found master start time in API data:",T.settings.masterStartTime),ce(T.settings.masterStartTime)),T?.schedule_items){console.log(" Total schedule items found:",T.schedule_items.length);const P=T.schedule_items.map((F,de)=>{if(!F)return console.log(` Item at index ${de} is null/undefined, skipping`),null;const fe=F.durationHours||0,ge=F.durationMinutes||0,ze=F.durationSeconds||0,oe=fe*60+ge+ze/60,Tt=oe>0?`${Math.round(oe)} min`:"0 min",ft=ye(de);let xt=null;if(console.log(` Calculated start time for ${F.segmentName} (index ${de}):`,{index:de,startTime:ft,masterStartTime:z,duration:oe,itemDurationHours:F.durationHours,itemDurationMinutes:F.durationMinutes,itemDurationSeconds:F.durationSeconds}),ft&&oe>0){const Dt=new Date(`1970-01-01 ${ft}`);xt=new Date(Dt.getTime()+oe*6e4).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0})}else xt="TBD";return{...F,startTime:ft,endTime:xt,duration:Tt,isPublic:F.isPublic||!1}}).filter(F=>F!==null).filter(F=>F&&F.isPublic===!0);console.log(" Public items found after time calculation:",P.length),P.sort((F,de)=>{if(F.startTime&&F.startTime!=="TBD"&&de.startTime&&de.startTime!=="TBD"){const fe=new Date(`1970-01-01 ${F.startTime}`),ge=new Date(`1970-01-01 ${de.startTime}`);return fe.getTime()-ge.getTime()}return(!F.startTime||F.startTime==="TBD")&&de.startTime&&de.startTime!=="TBD"?1:F.startTime&&F.startTime!=="TBD"&&(!de.startTime||de.startTime==="TBD")?-1:0}),p(P),console.log(" Schedule loaded for Green Room:",P)}else R("No schedule data found")}catch(T){console.error(" Error loading schedule:",T),console.error(" Error details:",{message:T.message,stack:T.stack,eventId:c?.id,eventName:c?.name}),R(`Failed to load schedule data: ${T.message}`)}finally{E(!1)}};I.useEffect(()=>{ve()},[c?.id]),I.useEffect(()=>{if(!c?.id)return;console.log(" Setting up WebSocket connection for Green Room schedule updates");const X={onRunOfShowDataUpdated:O=>{console.log(" Green Room: Run of show data updated via WebSocket"),O&&O.schedule_items&&p(O.schedule_items),O&&O.settings&&O.settings.masterStartTime&&ce(O.settings.masterStartTime)},onConnectionChange:O=>{console.log(` Green Room schedule WebSocket connection ${O?"established":"lost"} for event: ${c.id}`)},onInitialSync:async()=>{console.log(" Green Room: Schedule WebSocket initial sync triggered");try{const O=await fetch(`https://ros-50-production.up.railway.app/api/run-of-show-data/${c?.id}`);if(O.ok){const P=await O.json();console.log(" Green Room schedule initial sync: Loaded schedule data"),P&&P.schedule_items&&p(P.schedule_items),P&&P.settings&&P.settings.masterStartTime&&ce(P.settings.masterStartTime),console.log(" Green Room: Schedule initial sync completed")}}catch(O){console.error(" Green Room: Schedule initial sync failed:",O)}}};_r.connect(c.id,X);const T=()=>{!document.hidden&&_r.isConnected()&&(console.log(" Green Room: Schedule tab became visible - triggering resync"),X.onInitialSync?.())};return document.addEventListener("visibilitychange",T),()=>{console.log(" Cleaning up Green Room schedule WebSocket connection"),_r.disconnect(c.id),document.removeEventListener("visibilitychange",T)}},[c?.id]);const Ge=(()=>{const X=y?f.findIndex(P=>String(P.id)===String(y)):-1;console.log(" Modifying schedule visibility:",{totalScheduleItems:f.length,currentIndex:X,activeItemId:y,activeItemIdType:typeof y,scheduleItemIds:f.map(P=>({id:P.id,idType:typeof P.id,name:P.segmentName})),originalSchedule:f.map(P=>({id:P.id,name:P.segmentName,isPublic:P.isPublic}))});const T=f.map((P,F)=>X>=0&&F<X?{...P,isPublic:!1}:P),O=T.filter(P=>P.isPublic===!0);return console.log(" Modified schedule:",{modifiedSchedule:T.map(P=>({id:P.id,name:P.segmentName,isPublic:P.isPublic})),visibleItems:O.map(P=>({id:P.id,name:P.segmentName}))}),O})(),ie=()=>{if(!y||!q[y])return"No Timer";if(_!=="running")return"Timer Stopped";const X=q[y];return X.startedAt?new Date(X.startedAt.getTime()+X.total*1e3).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0}):"Not Started"},Ee=X=>{const T=X<0,O=Math.abs(X),P=Math.floor(O/3600),F=Math.floor(O%3600/60),de=Math.floor(O%60),fe=T?"-":"";return P===0?`${fe}${F.toString().padStart(2,"0")}:${de.toString().padStart(2,"0")}`:`${fe}${P.toString().padStart(2,"0")}:${F.toString().padStart(2,"0")}:${de.toString().padStart(2,"0")}`},Ce=()=>{if(!y||!q[y]||_!=="running")return"00:00";const X=q[y],T=X.total-X.elapsed;return Ee(T)},j=()=>{if(!y||!q[y]||_!=="running")return!1;const X=q[y];return X.total-X.elapsed<0};return b?l.jsxDEV("div",{className:"w-full h-screen flex items-center justify-center relative",style:{aspectRatio:"9/16"},children:[l.jsxDEV("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover",style:{objectFit:"cover"},children:[l.jsxDEV("source",{src:"/pointed_crop_loop.webm",type:"video/webm"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:749,columnNumber:11},void 0),"Your browser does not support the video tag."]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:739,columnNumber:9},void 0),l.jsxDEV("div",{className:"text-white text-xl relative z-10 bg-black/50 px-4 py-2 rounded",children:"Loading Green Room..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:752,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:737,columnNumber:7},void 0):w?l.jsxDEV("div",{className:"w-full h-screen flex items-center justify-center relative",style:{aspectRatio:"9/16"},children:[l.jsxDEV("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover",style:{objectFit:"cover"},children:[l.jsxDEV("source",{src:"/pointed_crop_loop.webm",type:"video/webm"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:771,columnNumber:11},void 0),"Your browser does not support the video tag."]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:761,columnNumber:9},void 0),l.jsxDEV("div",{className:"text-red-400 text-xl relative z-10 bg-black/50 px-4 py-2 rounded",children:w},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:774,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:759,columnNumber:7},void 0):l.jsxDEV("div",{className:"w-full h-screen text-white overflow-hidden relative",style:{aspectRatio:"9/16"},children:[l.jsxDEV("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover",style:{objectFit:"cover"},children:[l.jsxDEV("source",{src:"/pointed_crop_loop.webm",type:"video/webm"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:792,columnNumber:9},void 0),"Your browser does not support the video tag."]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:782,columnNumber:7},void 0),l.jsxDEV("div",{className:"relative z-10",children:[l.jsxDEV("div",{className:"p-6 flex items-center",children:[l.jsxDEV("div",{className:"text-white font-bold flex-1 text-center",style:{fontSize:"clamp(2rem, 6vw, 4rem)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"1.1",marginRight:"20px"},children:c?.name||"Current Event"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:803,columnNumber:11},void 0),l.jsxDEV("div",{className:`rounded-lg p-4 text-center flex-shrink-0 ${j()?"bg-red-800":"bg-red-600"}`,children:[l.jsxDEV("div",{className:"text-white text-xl font-semibold mb-2",children:j()?"OVER TIME":"Stage Timer"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:819,columnNumber:11},void 0),l.jsxDEV("div",{className:`text-5xl font-bold mb-2 ${j()?"text-red-200":"text-white"}`,children:Ce()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:822,columnNumber:11},void 0),l.jsxDEV("div",{className:"text-white text-base",children:["Expected Finish: ",ie()]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:825,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:818,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:801,columnNumber:9},void 0),l.jsxDEV("div",{className:"flex-1 overflow-y-auto p-6 max-h-[calc(100vh-200px)] [&::-webkit-scrollbar]:hidden",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:l.jsxDEV("div",{className:"space-y-4",children:Ge.length===0?l.jsxDEV("div",{className:"text-center text-gray-400 text-lg py-12",children:"No public schedule items available"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:840,columnNumber:11},void 0):l.jsxDEV(l.Fragment,{children:Ge.slice(0,8).map((X,T)=>{const O=ee[X.id],P=_==="running"&&String(y)===String(X.id),F=String(y)===String(X.id);return console.log(` Item ${X.id} (${X.segmentName}):`,{isLoaded:O,isRunning:P,isActive:F,timerState:_,activeItemId:y,loadedItems:ee}),l.jsxDEV("div",{className:`p-4 rounded-lg transition-all duration-300 ${O?P?"bg-red-600 text-white":"bg-green-600 text-white":"bg-gray-300 text-gray-700"}`,children:[l.jsxDEV("div",{className:"font-bold text-xl mb-2 uppercase",children:X.segmentName},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:870,columnNumber:15},void 0),l.jsxDEV("div",{className:"text-sm space-y-1",children:[l.jsxDEV("div",{children:["Start: ",X.startTime]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:872,columnNumber:17},void 0),l.jsxDEV("div",{children:["End: ",X.endTime]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:873,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:871,columnNumber:15},void 0)]},X.id,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:860,columnNumber:13},void 0)})},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:844,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:838,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:832,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:797,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/GreenRoomPage.tsx",lineNumber:780,columnNumber:5},void 0)},x9=()=>{const t=Oa(),n=new URLSearchParams(t.search),e=n.get("eventId"),s=n.get("eventName"),i=n.get("eventDate"),d=n.get("eventLocation"),c=t.state?.event||{id:e||"",name:s||"Current Event",date:i||"",location:d||"",numberOfDays:1},[f,p]=I.useState([]),[g,x]=I.useState(new Date),[b,E]=I.useState(!0),[w,R]=I.useState(null),[y,U]=I.useState(null),[q,G]=I.useState({}),[_,ne]=I.useState(null),[ee,Q]=I.useState({}),[z,ce]=I.useState("09:00"),[S,A]=I.useState(20),[W,H]=I.useState(!1),[K,Oe]=I.useState(!1),[ye,Pe]=I.useState({}),[ve,Ge]=I.useState({}),[ie,Ee]=I.useState({}),[Ce,j]=I.useState({}),[X,T]=I.useState(!0),[O,P]=I.useState(null),F=async()=>{if(console.log(" PhotoView: Resetting all states from RunOfShow reset..."),U(null),ne(null),Q({}),G({}),Ee({}),Pe({}),Ge({}),P(null),p(Ve=>Ve.map(Xe=>({...Xe,isIndented:!1}))),c?.id)try{console.log(" PhotoView: Reloading schedule data after reset...");const Ve=await it.getRunOfShowData(c.id);if(Ve?.schedule_items){const Xe=Ve.schedule_items.map(he=>({...he,isPublic:he.isPublic||!1,isIndented:!1}));p(Xe),console.log(" PhotoView: Schedule data reloaded and indented state cleared")}}catch(Ve){console.warn(" PhotoView: Failed to reload schedule data:",Ve),console.log(" PhotoView: Using local fallback to clear indented state")}console.log(" PhotoView: All states and highlights reset successfully")},de=Ve=>Ve?Ve.includes("CUE ")?Ve:Ve.replace(/^CUE(\d+)$/,"CUE $1"):"CUE",fe=(Ve,Xe)=>!Ve||Ve.length<=Xe?Ve:Ve.substring(0,Xe)+"...",ge=Ve=>{if(Ve.trim().length===0)return{html:"",needsSmallText:!1};const Xe=Ve.trim(),he=Xe.split(/\s+/);if(he.length<=1)return{html:Xe,needsSmallText:!1};const Be=["Dr","Dr.","Prof","Prof.","Mr","Mr.","Mrs","Mrs.","Ms","Ms.","Hon","Hon.","Honorable","Sen","Sen.","Senator","Rep","Rep.","Representative","Gov","Gov.","Governor","Mayor","Judge","Ambassador","Amb","Amb.","General","Gen","Gen.","Admiral","Adm","Adm.","Colonel","Col","Col.","Major","Maj","Maj.","Captain","Capt","Capt.","Lieutenant","Lt","Lt.","Sergeant","Sgt","Sgt.","Chief","Commander","Comm"],Qe=["Jr","Jr.","Sr","Sr.","III","IV","V","Ph.D","PhD","MD","DDS","DVM","Esq","Esq.","CPA","PE","RN","LPN"];let vt="",St="",tr="",$e="",tt="";Be.includes(he[0])&&(vt=he[0],he.shift());const Ct=Xe.match(/\([DR]\)/i);if(Ct){tt=Ct[0];const Lt=he.findIndex(Yt=>Yt.match(/\([DR]\)/i));Lt!==-1&&he.splice(Lt,1)}if(he.length>0&&Qe.includes(he[he.length-1])&&($e=he[he.length-1],he.pop()),he.length===0)return{html:Xe,needsSmallText:!1};if(he.length===1)St=he[0];else{const Lt=he.length-1;tr=he[Lt],St=he.slice(0,Lt).join(" ")}const Nt=12;let Ot=[vt,St].filter(Boolean).join(" "),kt=[tr,$e,tt].filter(Boolean).join(" ");if(Ot.length>Nt&&St.includes(" ")){const Lt=St.split(" ");if(Lt.length>1){const Yt=Lt.pop(),ct=Lt.join(" ");Ot=[vt,ct].filter(Boolean).join(" "),kt=[Yt,tr,$e,tt].filter(Boolean).join(" ")}}if(Ot.length>Nt&&St.includes(" ")){const Lt=St.split(" ");if(Lt.length>2){const Yt=Lt.splice(-2),ct=Lt.join(" ");Ot=[vt,ct].filter(Boolean).join(" "),kt=[Yt.join(" "),tr,$e,tt].filter(Boolean).join(" ")}}const Ft=Ot.length>Nt||kt.length>Nt;return{html:`${Ot}<br/>${kt}`,needsSmallText:Ft}},ze=Ve=>{if(isNaN(Ve)||Ve===void 0||Ve===null)return console.warn(" formatTime received invalid value:",Ve),"00:00:00";const Xe=Ve<0,he=Math.abs(Ve),Be=Math.floor(he/3600),Qe=Math.floor(he%3600/60),vt=Math.floor(he%60);return`${Xe?"-":""}${Be.toString().padStart(2,"0")}:${Qe.toString().padStart(2,"0")}:${vt.toString().padStart(2,"0")}`},oe=()=>{if(_==="stopped")return 0;const Ve=Object.keys(ie);if(Ve.length>0){const Xe=parseInt(Ve[0]);if(q[Xe]){const he=q[Xe];return he.total-he.elapsed}}if(y&&q[y]){const Xe=q[y];return Xe.total-Xe.elapsed}return 0},Tt=()=>{if(_==="stopped")return 0;const Ve=Object.keys(ie);if(Ve.length>0){const Xe=parseInt(Ve[0]);if(q[Xe]){const he=q[Xe],Be=he.total-he.elapsed;return he.total>0?Be/he.total*100:0}}if(y&&q[y]){const Xe=q[y],he=Xe.total-Xe.elapsed;return Xe.total>0?he/Xe.total*100:0}return 0},ft=()=>{const Ve=Object.keys(ie);if(Ve.length>0){const Xe=parseInt(Ve[0]);if(q[Xe]){const he=q[Xe],Be=he.total-he.elapsed;return Be>120?"#10b981":Be>30?"#f59e0b":"#ef4444"}}if(y&&q[y]){const Xe=q[y],he=Xe.total-Xe.elapsed;return he>120?"#10b981":he>30?"#f59e0b":"#ef4444"}return"#10b981"},xt=()=>{if(!y||_==="stopped"||_===null)return"#ffffff";const Ve=Object.keys(ie);if(Ve.length>0){const Xe=parseInt(Ve[0]);if(q[Xe]){const he=q[Xe],Be=he.total-he.elapsed;return Be>120?"#10b981":Be>30?"#f59e0b":"#ef4444"}}if(y&&q[y]){const Xe=q[y],he=Xe.total-Xe.elapsed;return he>120?"#10b981":he>30?"#f59e0b":"#ef4444"}return"#10b981"};console.log(" PhotoView Status Debug:",{activeTimersKeys:Object.keys(ie),activeTimers:ie,activeItemId:y,timerProgress:y?q[y]:null,scheduleLength:f.length,runningItem:Object.keys(ie).length>0?f.find(Ve=>ie[Ve.id]):null,loadedItem:y?f.find(Ve=>Ve.id===y):null,loadedItemCue:y?f.find(Ve=>Ve.id===y)?.customFields?.cue:null,allItemsCues:f.map(Ve=>({id:Ve.id,cue:Ve.customFields?.cue})),secondaryTimer:O,secondaryTimerActive:O?.isActive,secondaryTimerCue:O?.cue});const Dt=Ve=>{if(isNaN(Ve)||Ve===void 0||Ve===null)return"00:00";const Xe=Ve<0,he=Math.abs(Ve),Be=Math.floor(he/3600),Qe=Math.floor(he%3600/60),vt=he%60,St=Xe?"-":"";return Be>0?`${St}${Be.toString().padStart(2,"0")}:${Qe.toString().padStart(2,"0")}:${vt.toString().padStart(2,"0")}`:`${St}${Qe.toString().padStart(2,"0")}:${vt.toString().padStart(2,"0")}`},Ke=Ve=>{if(!z)return"";let Xe=0;for(let Nt=0;Nt<Ve;Nt++){const Ot=f[Nt],kt=Ot.durationHours*60+Ot.durationMinutes;Xe+=kt}const[he,Be]=z.split(":").map(Number),vt=he*60+Be+Xe,St=Math.floor(vt/60),tr=vt%60,$e=St>=12?"PM":"AM";let tt=St;return St>12&&(tt=St-12),St===0&&(tt=12),`${tt}:${tr.toString().padStart(2,"0")} ${$e}`};I.useEffect(()=>{if(c?.id){const Ve=localStorage.getItem(`masterStartTime_${c.id}`);Ve&&ce(Ve)}},[c?.id]),I.useEffect(()=>{const Ve=setInterval(()=>{x(new Date)},1e3);return()=>clearInterval(Ve)},[]),I.useEffect(()=>{if(K||W)return;const Ve=setInterval(()=>{A(Xe=>Xe<=1?(H(!0),setTimeout(()=>{H(!1),A(20)},3e3),0):Xe-1)},1e3);return()=>clearInterval(Ve)},[K,W]),I.useEffect(()=>{if(!c?.id)return;(async()=>{try{console.log(" PhotoView: Loading active timer state on mount...");const Xe=await fetch(`https://ros-50-production.up.railway.app/api/active-timers/${c.id}`);if(Xe.ok){const he=await Xe.json();console.log(" PhotoView: Loaded active timer on mount:",he);let Be;Array.isArray(he)?Be=he.length>0?he[0]:null:he.value&&Array.isArray(he.value)?Be=he.value.length>0?he.value[0]:null:Be=he,console.log(" PhotoView: Processed active timer data:",Be),Be&&Be.item_id?(U(parseInt(Be.item_id)),ne(Be.timer_state),Q({[parseInt(Be.item_id)]:!0}),G({[parseInt(Be.item_id)]:{elapsed:Be.elapsed_seconds||0,total:Be.duration_seconds||300,startedAt:Be.started_at?new Date(Be.started_at):null}}),console.log(" PhotoView: Active timer state loaded on mount")):(U(null),ne(null),Q({}),G({}),console.log(" PhotoView: No active timer found on mount"))}}catch(Xe){console.error(" PhotoView: Error loading active timer on mount:",Xe)}})()},[c?.id]),I.useEffect(()=>{if(!c?.id)return;console.log(" Setting up WebSocket connection for PhotoView timer updates");const Ve={onTimerUpdated:he=>{console.log(" PhotoView: Timer updated via WebSocket",he),he&&he.item_id&&(G(Be=>({...Be,[he.item_id]:{elapsed:he.elapsed_seconds||0,total:he.duration_seconds||300,startedAt:he.started_at?new Date(he.started_at):null}})),he.timer_state==="running"?(ne("running"),U(parseInt(he.item_id)),Q(Be=>({...Be,[parseInt(he.item_id)]:!0}))):he.timer_state==="loaded"&&(ne("loaded"),U(parseInt(he.item_id)),Q(Be=>({...Be,[parseInt(he.item_id)]:!0}))))},onTimerStopped:he=>{console.log(" PhotoView: Timer stopped via WebSocket",he),he&&he.item_id&&(U(null),ne(null),Q(Be=>{const Qe={...Be};return delete Qe[parseInt(he.item_id)],Qe}),G(Be=>{const Qe={...Be};return delete Qe[parseInt(he.item_id)],Qe}))},onTimersStopped:he=>{console.log(" PhotoView: All timers stopped via WebSocket",he),U(null),ne(null),Q({}),G({})},onTimerStarted:he=>{console.log(" PhotoView: Timer started via WebSocket",he),he&&he.item_id&&(U(parseInt(he.item_id)),ne("running"),Q(Be=>({...Be,[parseInt(he.item_id)]:!0})),G(Be=>({...Be,[parseInt(he.item_id)]:{elapsed:0,total:he.duration_seconds||300,startedAt:he.started_at?new Date(he.started_at):new Date}})))},onSubCueTimerStarted:he=>{if(console.log(" PhotoView: Sub-cue timer started via WebSocket",he),he&&he.item_id){const Be=parseInt(he.item_id),Qe=f.find(vt=>vt.id===Be);Ge(vt=>({...vt,[Be]:{elapsed:he.elapsed_seconds||0,total:he.duration_seconds||60,startedAt:he.started_at?new Date(he.started_at):new Date}})),P({itemId:Be,duration:he.duration_seconds||60,remaining:Math.max(0,(he.duration_seconds||60)-(he.elapsed_seconds||0)),isActive:!0,startedAt:he.started_at?new Date(he.started_at):new Date,timerState:"running",cue:Qe?.customFields?.cue||`CUE ${he.item_id}`,segmentName:Qe?.segmentName||"Segment"})}},onSubCueTimerStopped:he=>{if(console.log(" PhotoView: Sub-cue timer stopped via WebSocket",he),he&&he.item_id){const Be=parseInt(he.item_id);Ge(Qe=>{const vt={...Qe};return delete vt[Be],vt})}P(null)},onActiveTimersUpdated:he=>{console.log(" PhotoView: Active timers updated via WebSocket",he),he&&he.item_id&&(he.timer_state==="running"||he.timer_state==="loaded"?(U(parseInt(he.item_id)),ne(he.timer_state),Q({[parseInt(he.item_id)]:!0}),G({[parseInt(he.item_id)]:{elapsed:he.elapsed_seconds||0,total:he.duration_seconds||300,startedAt:he.started_at?new Date(he.started_at):null}})):he.timer_state==="stopped"&&(U(null),ne(null),Q({}),G({})))},onRunOfShowDataUpdated:he=>{if(console.log(" PhotoView: Run of show data updated via WebSocket",he),he&&he.schedule_items){const Be=he.schedule_items.map(Qe=>({...Qe,startTime:Qe.start_time||"09:00",durationHours:Math.floor((Qe.duration_seconds||300)/3600),durationMinutes:Math.floor((Qe.duration_seconds||300)%3600/60),durationSeconds:(Qe.duration_seconds||300)%60}));p(Be)}},onConnectionChange:he=>{console.log(` PhotoView WebSocket connection ${he?"established":"lost"} for event: ${c.id}`)},onResetAllStates:he=>{console.log(" PhotoView: Reset all states triggered via WebSocket",he),console.log(" PhotoView: About to call resetAllStates function"),F(),console.log(" PhotoView: resetAllStates function called")},onInitialSync:async()=>{console.log(" PhotoView: WebSocket initial sync triggered - loading current state");try{const he=await fetch(`https://ros-50-production.up.railway.app/api/active-timers/${c?.id}`);if(he.ok){const Be=await he.json();console.log(" PhotoView initial sync: Loaded active timer:",Be);let Qe;Array.isArray(Be)?Qe=Be.length>0?Be[0]:null:Be.value&&Array.isArray(Be.value)?Qe=Be.value.length>0?Be.value[0]:null:Qe=Be,console.log(" PhotoView initial sync: Processed active timer data:",Qe),Qe&&Qe.item_id?(U(parseInt(Qe.item_id)),ne(Qe.timer_state),Q({[parseInt(Qe.item_id)]:!0}),G({[parseInt(Qe.item_id)]:{elapsed:Qe.elapsed_seconds||0,total:Qe.duration_seconds||300,startedAt:Qe.started_at?new Date(Qe.started_at):null}}),console.log(" PhotoView: Initial sync completed - timer state restored")):(U(null),ne(null),Q({}),G({}),console.log(" PhotoView: Initial sync completed - no active timer"))}}catch(he){console.error(" PhotoView: Initial sync failed to load active timer:",he)}try{const{data:he,error:Be}=await it.getActiveSubCueTimers(c?.id);if(Be){console.error(" PhotoView: Error loading sub-cue timers:",Be),P(null);return}if(he&&he.length>0){console.log(" PhotoView initial sync: Loaded sub-cue timers:",he),console.log(" PhotoView: Sub-cue timer data structure:",he[0]),console.log(" PhotoView: Available fields:",Object.keys(he[0])),console.log(' PhotoView: Looking for timer_state === "running"'),console.log(" PhotoView: All timer states:",he.map(vt=>({id:vt.item_id,state:vt.timer_state,is_running:vt.is_running})));const Qe=he.find(vt=>vt.timer_state==="running"||vt.is_running===!0);if(console.log(" PhotoView: Found running timer:",Qe),Qe){const vt=parseInt(Qe.item_id),St=f.find(tr=>tr.id===vt);Ge(tr=>({...tr,[vt]:{elapsed:Qe.elapsed_seconds||0,total:Qe.duration_seconds||60,startedAt:Qe.started_at?new Date(Qe.started_at):new Date}})),P({itemId:vt,duration:Qe.duration_seconds||60,remaining:Math.max(0,(Qe.duration_seconds||60)-(Qe.elapsed_seconds||0)),isActive:!0,startedAt:Qe.started_at?new Date(Qe.started_at):new Date,timerState:"running",cue:St?.customFields?.cue||`CUE ${Qe.item_id}`,segmentName:St?.segmentName||"Segment"}),console.log(" PhotoView: Initial sync completed - sub-cue timer restored")}else P(null),console.log(" PhotoView: Initial sync completed - no running sub-cue timer")}else P(null),console.log(" PhotoView: Initial sync completed - no active sub-cue timers")}catch(he){console.error(" PhotoView: Initial sync failed to load sub-cue timers:",he),P(null)}}};_r.connect(c.id,Ve);const Xe=()=>{!document.hidden&&_r.isConnected()&&(console.log(" PhotoView: Tab became visible - triggering resync"),Ve.onInitialSync?.())};return document.addEventListener("visibilitychange",Xe),()=>{console.log(" Cleaning up PhotoView WebSocket connection"),_r.disconnect(c.id),document.removeEventListener("visibilitychange",Xe)}},[c?.id,f]),I.useEffect(()=>{if(!y||!q[y])return;const Ve=q[y];if(Ve.startedAt&&_==="running"){const Xe=Ve.startedAt,he=Ve.total;console.log(` PhotoView: Starting continuous local timer for ${y} with duration ${he}s, start time: ${Xe.toISOString()}`);const Be=setInterval(()=>{const Qe=new Date,vt=Math.floor((Qe.getTime()-Xe.getTime())/1e3);G(St=>({...St,[y]:{...St[y],elapsed:vt}})),vt<=10&&console.log(` PhotoView Timer ${y}: Continuous elapsed=${vt}s, Start=${Xe.toISOString()}, Now=${Qe.toISOString()}`)},1e3);return()=>{console.log(` PhotoView: Stopping continuous local timer for ${y}`),clearInterval(Be)}}},[y,_]),I.useEffect(()=>{const Ve=Object.keys(ve);if(Ve.length===0)return;const Xe=[];return Ve.forEach(he=>{const Be=parseInt(he),Qe=ve[Be];if(Qe&&Qe.startedAt){const vt=setInterval(()=>{Ge(St=>{if(St[Be]&&St[Be].startedAt){const tr=St[Be].startedAt,tt=Math.floor((new Date().getTime()-tr.getTime())/1e3);return{...St,[Be]:{...St[Be],elapsed:tt}}}return St}),P(St=>{if(St&&St.itemId===Be){const tr=ve[Be];if(tr){const $e=Math.max(0,tr.total-tr.elapsed);return{...St,remaining:$e}}}return St})},100);Xe.push(vt)}}),()=>{Xe.forEach(he=>clearInterval(he))}},[ve]),I.useEffect(()=>()=>{console.log(" PhotoView: Cleaning up on component unmount")},[]);const er=async()=>{if(c?.id)try{console.log(" PhotoView: Loading indented cues from API for event:",c.id);const Ve=await it.getIndentedCues(c.id);if(Ve&&Ve.length>0){console.log(" PhotoView: Found indented cues:",Ve);const Xe={};Ve.forEach(he=>{he.item_id&&he.parent_item_id&&(Xe[he.item_id]={parentId:he.parent_item_id,userId:he.user_id||"",userName:he.user_name||""})}),j(Xe),console.log(" PhotoView: Set indentedCues state:",Xe)}else console.log(" PhotoView: No indented cues found"),j({})}catch(Ve){console.error(" PhotoView: Error loading indented cues from API:",Ve)}};I.useEffect(()=>{c?.id&&er()},[c?.id]),I.useEffect(()=>{if(!O)return;const Ve=setInterval(()=>{P(Xe=>{if(!Xe)return null;const he=Xe.startedAt?.getTime()||Date.now(),Be=Math.floor((Date.now()-he)/1e3),Qe=Math.max(0,Xe.duration-Be);return{...Xe,remaining:Qe}})},1e3);return()=>clearInterval(Ve)},[O]),I.useEffect(()=>{(async()=>{if(console.log("=== PHOTO VIEW PAGE INITIALIZATION ==="),!c?.id&&!e){R("No event selected"),E(!1);return}try{if(c?.id||e){console.log(" Loading from API for event:",c?.id||e);const he=await it.getRunOfShowData(c?.id||e);if(he?.schedule_items){console.log(" Loaded from API:",he);const Be=he.schedule_items.map(Qe=>({...Qe,isPublic:Qe.isPublic||!1}));p(Be),E(!1);return}}console.log(" Falling back to localStorage...");let Xe=null;if(c?.id||e){const he=`runOfShowSchedule_${c?.id||e}`;Xe=localStorage.getItem(he)}if(!Xe){const Be=Object.keys(localStorage).filter(Qe=>Qe.startsWith("runOfShowSchedule_"));if(Be.length>0){const Qe=Be[Be.length-1];Xe=localStorage.getItem(Qe)}}if(Xe){const he=JSON.parse(Xe);console.log(" Loaded from localStorage:",he),p(he)}else console.log(" No schedule data found, creating sample data for testing"),p([{id:1,day:1,programType:"PreShow/End",shotType:"Wide",segmentName:"Welcome & Opening",durationHours:0,durationMinutes:5,durationSeconds:0,notes:"Welcome everyone to the event",assets:"",speakers:"",speakersText:"",hasPPT:!0,hasQA:!1,timerId:"",customFields:{cue:"CUE1"},isPublic:!0},{id:2,day:1,programType:"Podium Transition",shotType:"Medium",segmentName:"Keynote Speaker",durationHours:0,durationMinutes:15,durationSeconds:0,notes:"Main keynote presentation",assets:"",speakers:"",speakersText:"",hasPPT:!0,hasQA:!0,timerId:"",customFields:{cue:"CUE2"},isPublic:!0},{id:3,day:1,programType:"Panel Transition",shotType:"Two Shot",segmentName:"Panel Discussion",durationHours:0,durationMinutes:30,durationSeconds:0,notes:"Interactive panel discussion",assets:"",speakers:"",speakersText:"",hasPPT:!1,hasQA:!0,timerId:"",customFields:{cue:"CUE3"},isPublic:!0}]),console.log(" Using sample data for testing")}catch(Xe){console.error(" Error loading schedule:",Xe),R("Failed to load schedule data")}finally{E(!1)}})()},[c?.id,e]);const ur=(()=>{if(console.log(" getPreviewItems called"),console.log("Schedule length:",f.length),console.log("Active item ID:",y),console.log("Active item ID type:",typeof y),f.length===0)return console.log("No schedule items available"),[];const Ve=y?f.findIndex(Be=>String(Be.id)===String(y)):-1;if(console.log("Current index:",Ve),Ve===-1)return console.log("No active item or not found, showing first 3 items"),f.slice(0,3);const Xe=Math.min(Ve+3,f.length),he=f.slice(Ve,Xe);return console.log("Showing items from index",Ve,"to",Xe-1,":",he.length,"items"),console.log("Items:",he.map(Be=>({id:Be.id,name:Be.segmentName}))),he})();console.log("Preview items:",ur);const ar={"Podium Transition":"#8B4513","Panel Transition":"#404040","Sub Cue":"#F3F4F6","No Transition":"#059669",Video:"#F59E0B","Panel+Remote":"#1E40AF","Remote Only":"#60A5FA",Break:"#EC4899",TBD:"#6B7280",KILLED:"#DC2626",Podium:"#8B4513",Panel:"#404040","PreShow/End":"#8B5CF6"};return b?l.jsxDEV("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:l.jsxDEV("div",{className:"text-white text-xl",children:"Loading PhotoView..."},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1197,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1196,columnNumber:7},void 0):w?l.jsxDEV("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:l.jsxDEV("div",{className:"text-red-400 text-xl",children:w},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1205,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1204,columnNumber:7},void 0):l.jsxDEV("div",{className:"min-h-screen bg-slate-900 text-white p-6",children:[l.jsxDEV("div",{className:"mb-8",children:[l.jsxDEV("div",{className:"flex justify-between items-start mb-6",children:[l.jsxDEV("div",{children:[l.jsxDEV("h1",{className:"text-2xl font-bold",children:c?.name||"Current Event"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1220,columnNumber:11},void 0),l.jsxDEV("div",{className:"text-sm text-gray-300 mt-1",children:g.toLocaleTimeString()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1221,columnNumber:11},void 0),l.jsxDEV("button",{onClick:()=>T(!X),className:`mt-2 px-2 py-1 text-xs rounded border transition-colors ${X?"bg-blue-600 border-blue-500 text-white":"bg-slate-700 border-slate-600 text-gray-300 hover:bg-slate-600"}`,children:X?"Hide Notes":"Show Notes"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1225,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1219,columnNumber:9},void 0),l.jsxDEV("div",{className:"flex items-center space-x-6",children:[l.jsxDEV("div",{className:"text-center",children:_==="running"&&y?l.jsxDEV("div",{className:"text-lg text-green-400 font-bold",children:["RUNNING - ",de(f.find(Ve=>Ve.id===y)?.customFields?.cue),O&&O.isActive&&l.jsxDEV("div",{className:"text-lg text-orange-400 mt-0.5 font-bold",children:[de(O.cue)," - ",Dt(O.remaining)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1243,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1240,columnNumber:17},void 0):_==="loaded"&&y?l.jsxDEV("div",{className:"text-lg text-yellow-400 font-bold",children:["LOADED - ",de(f.find(Ve=>Ve.id===y)?.customFields?.cue)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1249,columnNumber:17},void 0):l.jsxDEV("div",{className:"text-lg text-slate-300 font-bold",children:"NO CUE SELECTED"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1253,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1238,columnNumber:13},void 0),l.jsxDEV("div",{className:"relative",children:l.jsxDEV("div",{className:"text-3xl font-mono bg-slate-800 px-6 py-3 rounded-lg border border-slate-600",style:{color:xt()},children:ze(oe())},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1262,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1261,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1236,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1218,columnNumber:7},void 0),y&&q[y]&&l.jsxDEV("div",{className:"w-full bg-slate-700 rounded-full overflow-hidden border border-slate-600 relative h-2",children:l.jsxDEV("div",{className:"h-full transition-all duration-1000 absolute top-0 right-0",style:{width:`${Tt()}%`,background:ft()}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1273,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1272,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1217,columnNumber:5},void 0),l.jsxDEV("div",{className:"max-w-7xl mx-auto",children:[l.jsxDEV("div",{className:"bg-slate-700 border border-slate-600",children:l.jsxDEV("div",{className:"grid grid-cols-11 gap-0",children:[l.jsxDEV("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"CUE"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1289,columnNumber:13},void 0),l.jsxDEV("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"TIME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1292,columnNumber:13},void 0),l.jsxDEV("div",{className:"col-span-2 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SEGMENT INFO"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1295,columnNumber:13},void 0),l.jsxDEV("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 1"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1298,columnNumber:13},void 0),l.jsxDEV("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 2"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1301,columnNumber:13},void 0),l.jsxDEV("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 3"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1304,columnNumber:13},void 0),l.jsxDEV("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 4"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1307,columnNumber:13},void 0),l.jsxDEV("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 5"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1310,columnNumber:13},void 0),l.jsxDEV("div",{className:"col-span-1 bg-slate-600 border-r border-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 6"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1313,columnNumber:13},void 0),l.jsxDEV("div",{className:"col-span-1 bg-slate-600 p-3 text-center font-bold text-sm",children:"SLOT 7"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1316,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1288,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1287,columnNumber:9},void 0),ur.length===0?l.jsxDEV("div",{className:"text-center text-gray-400 text-xl py-12 bg-slate-800 border border-slate-600 border-t-0",children:"No schedule items available"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1324,columnNumber:11},void 0):ur.map((Ve,Xe)=>{const he=String(y)===String(Ve.id);ee[Ve.id];const Be=_==="running"&&he,Qe=Ce[Ve.id]||!1;let vt=!1;if(Qe){const Ot=Ce[Ve.id].parentId,kt=ee[Ot]||!1,Ft=ie[Ot]||!1;vt=kt||Ft}const St=f.findIndex(Ot=>Ot.id===Ve.id),tr=Ke(St),$e=`${Ve.durationHours.toString().padStart(2,"0")}:${Ve.durationMinutes.toString().padStart(2,"0")}:${Ve.durationSeconds.toString().padStart(2,"0")}`,tt=[];Ve.hasPPT&&tt.push("PPT"),Ve.hasQA&&tt.push("Q&A");const Ct=tt.length>0?tt.join("/"):"None";let Nt="";return vt?Nt="border-4 border-orange-400":he?Nt=Be?"border-4 border-green-400":"border-4 border-blue-400":Nt="border border-slate-600",l.jsxDEV("div",{className:Nt,children:[l.jsxDEV("div",{className:`grid grid-cols-11 gap-0 ${vt?"bg-amber-950":he?Be?"bg-green-950":"bg-blue-950":"bg-slate-900"}`,style:{minHeight:"200px"},children:[l.jsxDEV("div",{className:"col-span-1 border-r border-slate-600 p-3 flex flex-col justify-center",children:l.jsxDEV("div",{className:"text-center",children:[l.jsxDEV("div",{className:"text-lg font-bold mb-3 text-white",children:Ve.customFields?.cue||`CUE ${St+1}`},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1379,columnNumber:23},void 0),l.jsxDEV("div",{className:"inline-block px-2 py-1 rounded text-xs font-medium text-white border shadow-lg",style:{backgroundColor:ar[Ve.programType]||"#6B7280",color:Ve.programType==="Sub Cue"?"black":"white",borderColor:Ve.programType==="Sub Cue"?"black":"transparent"},children:Ve.programType||"Unknown"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1382,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1378,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1377,columnNumber:19},void 0),l.jsxDEV("div",{className:"col-span-1 border-r border-slate-600 p-3 flex flex-col justify-center",children:l.jsxDEV("div",{className:"text-center",children:[l.jsxDEV("div",{className:"mb-4",children:[l.jsxDEV("div",{className:"text-gray-400 text-xs mb-1",children:"START TIME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1399,columnNumber:25},void 0),l.jsxDEV("div",{className:"text-lg font-bold text-white",children:tr||"No Time"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1400,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1398,columnNumber:23},void 0),l.jsxDEV("div",{children:[l.jsxDEV("div",{className:"text-gray-400 text-xs mb-1",children:"DURATION"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1403,columnNumber:25},void 0),l.jsxDEV("div",{className:"text-base font-bold text-white",children:$e},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1404,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1402,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1397,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1396,columnNumber:19},void 0),l.jsxDEV("div",{className:"col-span-2 border-r border-slate-600 p-3 flex flex-col justify-center",children:l.jsxDEV("div",{className:"space-y-3",children:[l.jsxDEV("div",{children:[l.jsxDEV("div",{className:"text-gray-400 text-xs mb-1",children:"SEGMENT NAME"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1413,columnNumber:25},void 0),l.jsxDEV("div",{className:"text-lg font-bold text-white",children:Ve.segmentName||"Untitled Segment"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1414,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1412,columnNumber:23},void 0),l.jsxDEV("div",{children:[l.jsxDEV("div",{className:"text-gray-400 text-xs mb-1",children:"SHOT TYPE"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1417,columnNumber:25},void 0),l.jsxDEV("div",{className:"text-sm font-bold text-white",children:Ve.shotType||"Not specified"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1418,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1416,columnNumber:23},void 0),l.jsxDEV("div",{children:[l.jsxDEV("div",{className:"text-gray-400 text-xs mb-1",children:"PPT/Q&A"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1421,columnNumber:25},void 0),l.jsxDEV("div",{className:"text-sm font-bold text-white",children:Ct},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1422,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1420,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1411,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1410,columnNumber:19},void 0),[1,2,3,4,5,6,7].map(Ot=>{let kt=null;if(Ve.speakersText)try{const Ft=JSON.parse(Ve.speakersText);Array.isArray(Ft)&&(kt=Ft.find(Lt=>Lt.slot===Ot))}catch(Ft){console.log("Error parsing speakers:",Ft)}return l.jsxDEV("div",{className:`col-span-1 ${Ot<7?"border-r border-slate-600":""} p-3 flex flex-col justify-center`,children:kt?l.jsxDEV("div",{className:"text-center h-full flex flex-col justify-center",children:[kt.photoLink&&l.jsxDEV("div",{className:"mb-3 flex justify-center",children:l.jsxDEV("img",{src:kt.photoLink,alt:kt.fullName,className:"w-24 h-32 rounded-lg object-cover border-2 border-slate-400 shadow-lg",style:{objectFit:"cover",objectPosition:"center top"},onError:Ft=>{Ft.currentTarget.style.display="none"}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1449,columnNumber:33},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1448,columnNumber:31},void 0),(()=>{const Ft=ge(kt.fullName||"Unnamed");return l.jsxDEV("div",{className:`font-bold text-white mb-2 leading-tight ${Ft.needsSmallText?"text-sm":"text-base"}`,dangerouslySetInnerHTML:{__html:Ft.html}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1467,columnNumber:33},void 0)})(),(kt.title||kt.org)&&l.jsxDEV("div",{className:"text-xs text-gray-300 mb-1 leading-tight",children:(()=>{const Ft=kt.title||"",Lt=kt.org||"",Yt=Ft&&Lt?`${Ft}, ${Lt}`:Ft||Lt;return fe(Yt,20)})()},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1477,columnNumber:31},void 0),l.jsxDEV("div",{className:"text-xs text-gray-300 font-medium bg-slate-700 px-2 py-1 rounded",children:kt.location==="Podium"?"Podium":kt.location==="Seat"?"Seat":kt.location==="Virtual"?"Virtual":kt.location==="Moderator"?"Moderator":kt.location||"Unknown"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1487,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1445,columnNumber:27},void 0):l.jsxDEV("div",{className:"text-center text-xs text-gray-500 h-full flex items-center justify-center",children:l.jsxDEV("div",{className:"text-gray-600",children:"Empty"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1498,columnNumber:29},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1496,columnNumber:27},void 0)},Ot,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1443,columnNumber:23},void 0)})]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1369,columnNumber:25},void 0),X&&(()=>{const Ot=Ve.notes?Ve.notes.replace(/<[^>]*>/g,"").trim():"";return console.log("Notes debug for item:",{hasNotes:!!Ve.notes,notesValue:Ve.notes,cleanNotes:Ot,cleanLength:Ot.length,willShow:Ot&&Ot.length>0}),Ot&&Ot.length>0&&Ot!=="None"&&Ot!=="null"&&Ot!=="undefined"})()&&l.jsxDEV("div",{className:`border-t border-slate-600 p-4 ${Qe?"bg-amber-950":he?Be?"bg-green-950":"bg-blue-950":"bg-slate-800"}`,children:[l.jsxDEV("div",{className:"text-gray-400 text-sm mb-2 font-bold",children:"NOTES:"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1533,columnNumber:29},void 0),l.jsxDEV("div",{className:"text-sm text-white break-words leading-relaxed",style:{whiteSpace:"pre-line"},dangerouslySetInnerHTML:{__html:Ve.notes.replace(/\n/g,"<br>").replace(/\r\n/g,"<br>").replace(/\r/g,"<br>").replace(/<(?!\/?(?:br|b|strong|i|em|u|font|span|div|p|h[1-6])\b)[^>]*>/g,"")}},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1534,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1528,columnNumber:27},void 0),Xe<ur.length-1&&l.jsxDEV("div",{className:"border-t-2 border-slate-500"},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1550,columnNumber:19},void 0)]},Ve.id,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1367,columnNumber:15},void 0)})]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1285,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/pages/PhotoViewPage.tsx",lineNumber:1215,columnNumber:5},void 0)};function b9(){const t=Oa(),n=t.pathname==="/fullscreen-timer",e=t.pathname==="/clock",s=t.pathname==="/green-room",i=t.pathname==="/photo-view";return l.jsxDEV("div",{className:`App ${e?"clock-page":""}`,children:[!n&&!s&&!i&&l.jsxDEV(Pb,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:30,columnNumber:62},this),l.jsxDEV(tA,{children:l.jsxDEV(TO,{children:[l.jsxDEV(ls,{path:"/",element:l.jsxDEV(aA,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:34,columnNumber:36},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:34,columnNumber:11},this),l.jsxDEV(ls,{path:"/run-of-show",element:l.jsxDEV(s9,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:35,columnNumber:47},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:35,columnNumber:11},this),l.jsxDEV(ls,{path:"/fullscreen-timer",element:l.jsxDEV(l9,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:36,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:36,columnNumber:11},this),l.jsxDEV(ls,{path:"/graphics-links",element:l.jsxDEV(p9,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:37,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:37,columnNumber:11},this),l.jsxDEV(ls,{path:"/reports",element:l.jsxDEV(v9,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:38,columnNumber:43},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:38,columnNumber:11},this),l.jsxDEV(ls,{path:"/green-room",element:l.jsxDEV(g9,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:39,columnNumber:46},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:39,columnNumber:11},this),l.jsxDEV(ls,{path:"/photo-view",element:l.jsxDEV(x9,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:40,columnNumber:46},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:40,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:33,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:32,columnNumber:7},this),l.jsxDEV(TO,{children:[l.jsxDEV(ls,{path:"/clock",element:l.jsxDEV(u9,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:46,columnNumber:39},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:46,columnNumber:9},this),l.jsxDEV(ls,{path:"/lower-thirds-xml",element:l.jsxDEV(d9,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:47,columnNumber:50},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:47,columnNumber:9},this),l.jsxDEV(ls,{path:"/netlify-lower-thirds-xml",element:l.jsxDEV(f9,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:48,columnNumber:58},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:48,columnNumber:9},this),l.jsxDEV(ls,{path:"/schedule-xml",element:l.jsxDEV(m9,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:49,columnNumber:46},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:49,columnNumber:9},this),l.jsxDEV(ls,{path:"/custom-columns-xml",element:l.jsxDEV(h9,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:50,columnNumber:52},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:50,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:45,columnNumber:7},this)]},void 0,!0,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:28,columnNumber:5},this)}function N9(){return l.jsxDEV(Q4,{children:l.jsxDEV(B4,{children:l.jsxDEV(b9,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:60,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:59,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/App.tsx",lineNumber:58,columnNumber:5},this)}const D9=RU.createRoot(document.getElementById("root"));D9.render(l.jsxDEV(Rh.StrictMode,{children:l.jsxDEV(N9,{},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/index.tsx",lineNumber:11,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/audre/OneDrive/Desktop/ROS-5.0/src/index.tsx",lineNumber:10,columnNumber:3},void 0));
